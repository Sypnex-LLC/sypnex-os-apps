{
  "app_metadata": {
    "id": "text_editor",
    "name": "Text Editor",
    "description": "A simple text editor for creating and editing text files in the virtual file system",
    "icon": "fas fa-edit",
    "keywords": [
      "text_editor",
      "editor",
      "file",
      "edit",
      "write"
    ],
    "author": "Sypnex OS",
    "version": "1.0.6",
    "type": "user_app",
    "scripts": [
      "js/utils.js",
      "js/settings-manager.js",
      "js/file-manager.js",
      "js/editor-manager.js",
      "js/syntax-highlighting.js",
      "js/code-validation.js",
      "js/ui-manager.js",
      "js/main.js"
    ],
    "settings": [
      {
        "key": "AUTO_SAVE_INTERVAL",
        "name": "Auto Save Interval (s)",
        "type": "number",
        "value": 30,
        "description": "Auto save content every N seconds (0 = disabled)"
      },
      {
        "key": "FONT_SIZE",
        "name": "Font Size",
        "type": "number",
        "value": 14,
        "description": "Text editor font size in pixels"
      },
      {
        "key": "TAB_SIZE",
        "name": "Tab Size",
        "type": "number",
        "value": 4,
        "description": "Number of spaces for tab indentation"
      }
    ]
  },
  "files": {
    "text_editor.app": "ew0KICAgICJpZCI6ICJ0ZXh0X2VkaXRvciIsDQogICAgIm5hbWUiOiAiVGV4dCBFZGl0b3IiLA0KICAgICJkZXNjcmlwdGlvbiI6ICJBIHNpbXBsZSB0ZXh0IGVkaXRvciBmb3IgY3JlYXRpbmcgYW5kIGVkaXRpbmcgdGV4dCBmaWxlcyBpbiB0aGUgdmlydHVhbCBmaWxlIHN5c3RlbSIsDQogICAgImljb24iOiAiZmFzIGZhLWVkaXQiLA0KICAgICJrZXl3b3JkcyI6IFsidGV4dF9lZGl0b3IiLCAiZWRpdG9yIiwgImZpbGUiLCAiZWRpdCIsICJ3cml0ZSJdLA0KICAgICJhdXRob3IiOiAiU3lwbmV4IE9TIiwNCiAgICAidmVyc2lvbiI6ICIxLjAuNiIsDQogICAgInR5cGUiOiAidXNlcl9hcHAiLA0KICAgICJzY3JpcHRzIjogWw0KICAgICAgICAianMvdXRpbHMuanMiLA0KICAgICAgICAianMvc2V0dGluZ3MtbWFuYWdlci5qcyIsDQogICAgICAgICJqcy9maWxlLW1hbmFnZXIuanMiLA0KICAgICAgICAianMvZWRpdG9yLW1hbmFnZXIuanMiLA0KICAgICAgICAianMvc3ludGF4LWhpZ2hsaWdodGluZy5qcyIsDQogICAgICAgICJqcy9jb2RlLXZhbGlkYXRpb24uanMiLCANCiAgICAgICAgImpzL3VpLW1hbmFnZXIuanMiLA0KICAgICAgICAianMvbWFpbi5qcyINCiAgICBdLA0KICAgICJzZXR0aW5ncyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICAgImtleSI6ICJBVVRPX1NBVkVfSU5URVJWQUwiLA0KICAgICAgICAgICAgIm5hbWUiOiAiQXV0byBTYXZlIEludGVydmFsIChzKSIsDQogICAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICAgInZhbHVlIjogMzAsDQogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiQXV0byBzYXZlIGNvbnRlbnQgZXZlcnkgTiBzZWNvbmRzICgwID0gZGlzYWJsZWQpIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAia2V5IjogIkZPTlRfU0laRSIsDQogICAgICAgICAgICAibmFtZSI6ICJGb250IFNpemUiLA0KICAgICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAgICJ2YWx1ZSI6IDE0LA0KICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlRleHQgZWRpdG9yIGZvbnQgc2l6ZSBpbiBwaXhlbHMiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJrZXkiOiAiVEFCX1NJWkUiLA0KICAgICAgICAgICAgIm5hbWUiOiAiVGFiIFNpemUiLA0KICAgICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAgICJ2YWx1ZSI6IDQsDQogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIHNwYWNlcyBmb3IgdGFiIGluZGVudGF0aW9uIg0KICAgICAgICB9DQogICAgXQ0KfSA=",
    "text_editor.html": "PGRpdiBjbGFzcz0iYXBwLWNvbnRhaW5lciI+DQogICAgPGRpdiBjbGFzcz0iYXBwLWNvbnRlbnQiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtdG9vbGJhciI+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtYnRuLWdyb3VwIj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJuZXctZmlsZSIgY2xhc3M9ImFwcC1idG4gcHJpbWFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZmlsZSI+PC9pPiBOZXcNCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJsb2FkLWZpbGUiIGNsYXNzPSJhcHAtYnRuIHNlY29uZGFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZm9sZGVyLW9wZW4iPjwvaT4gTG9hZA0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InNhdmUtZmlsZSIgY2xhc3M9ImFwcC1idG4gcHJpbWFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2F2ZSI+PC9pPiBTYXZlDQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ic2F2ZS1hcy1maWxlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXNhdmUiPjwvaT4gU2F2ZSBBcw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICANCg0KICAgICAgICAgICAgDQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtYnRuLWdyb3VwIj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ3b3JkLXdyYXAtdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRleHQtd2lkdGgiPjwvaT4gV29yZCBXcmFwDQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ibGluZS1udW1iZXJzLXRvZ2dsZSIgY2xhc3M9ImFwcC1idG4gc2Vjb25kYXJ5Ij4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1saXN0LW9sIj48L2k+IExpbmUgTnVtYmVycw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InN5bnRheC1oaWdobGlnaHRpbmctdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWNvZGUiPjwvaT4gU3ludGF4IEhpZ2hsaWdodGluZw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InZhbGlkYXRpb24tdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWNoZWNrLWNpcmNsZSI+PC9pPiBDb2RlIFZhbGlkYXRpb24NCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCg0KICAgICAgICA8ZGl2IGNsYXNzPSJlZGl0b3ItY29udGFpbmVyIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImVkaXRvci13cmFwcGVyIj4NCiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJsaW5lLW51bWJlcnMiIGNsYXNzPSJsaW5lLW51bWJlcnMiPjwvZGl2Pg0KICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBpZD0idGV4dC1lZGl0b3IiIGNsYXNzPSJhcHAtdGV4dGFyZWEiIHBsYWNlaG9sZGVyPSJTdGFydCB0eXBpbmcgeW91ciB0ZXh0IGhlcmUuLi4iPjwvdGV4dGFyZWE+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgPGRpdiBjbGFzcz0iZWRpdG9yLXN0YXR1cyI+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0dXMtbGVmdCI+DQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InN0YXR1cy1pdGVtIj5GaWxlOiA8c3BhbiBpZD0iY3VycmVudC1maWxlbmFtZSI+dW50aXRsZWQudHh0PC9zcGFuPjwvc3Bhbj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3RhdHVzLWl0ZW0iPk1vZGlmaWVkOiA8c3BhbiBpZD0ibW9kaWZpZWQtc3RhdHVzIj5Obzwvc3Bhbj48L3NwYW4+DQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InN0YXR1cy1pdGVtIj5FcnJvcnM6IDxzcGFuIGlkPSJlcnJvci1jb3VudCI+MDwvc3Bhbj48L3NwYW4+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQo8L2Rpdj4gDQo8c3R5bGU+LyogPT09PT0gU3R5bGU6IHN0eWxlLmNzcyA9PT09PSAqLw0KLyogVGV4dCBFZGl0b3IgQXBwIFN0eWxlcyAqLw0KDQovKiBBcHAgQ29udGFpbmVyICovDQouYXBwLWNvbnRhaW5lciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGhlaWdodDogMTAwJTsNCiAgICBtaW4taGVpZ2h0OiAwOw0KfQ0KDQouYXBwLWNvbnRlbnQgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBmbGV4OiAxOw0KICAgIG1pbi1oZWlnaHQ6IDA7DQp9DQoNCi8qIEVkaXRvciBDb250YWluZXIgKi8NCi5lZGl0b3ItY29udGFpbmVyIHsNCiAgICBmbGV4OiAxOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgbWFyZ2luOiAxNXB4IDA7DQogICAgbWluLWhlaWdodDogMjAwcHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KfQ0KDQouZWRpdG9yLXdyYXBwZXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleDogMTsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgaGVpZ2h0OiAxMDAlOw0KfQ0KDQovKiBMaW5lIE51bWJlcnMgKi8NCi5saW5lLW51bWJlcnMgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIHBhZGRpbmc6IDEwcHggOHB4Ow0KICAgIGZvbnQtZmFtaWx5OiAnU0YgTW9ubycsIE1vbmFjbywgJ0Nhc2NhZGlhIENvZGUnLCBtb25vc3BhY2U7DQogICAgZm9udC1zaXplOiAxNHB4OyAvKiBNYXRjaCBlZGl0b3IgZm9udCBzaXplICovDQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtYWxpZ246IHJpZ2h0Ow0KICAgIG1pbi13aWR0aDogNTBweDsNCiAgICB1c2VyLXNlbGVjdDogbm9uZTsNCiAgICBvdmVyZmxvdy15OiBoaWRkZW47DQogICAgbGluZS1oZWlnaHQ6IDEuNjsgLyogTWF0Y2ggZWRpdG9yIGxpbmUgaGVpZ2h0ICovDQogICAgZmxleC1zaHJpbms6IDA7DQp9DQoNCi5saW5lLW51bWJlcnMuaGlkZGVuIHsNCiAgICBkaXNwbGF5OiBub25lOw0KfQ0KDQoubGluZS1udW1iZXIgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgIHBhZGRpbmc6IDAgNHB4Ow0KfQ0KDQovKiBUZXh0IEVkaXRvciAqLw0KI3RleHQtZWRpdG9yIHsNCiAgICBmbGV4OiAxOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpOw0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsNCiAgICBmb250LWZhbWlseTogJ1NGIE1vbm8nLCBNb25hY28sICdDYXNjYWRpYSBDb2RlJywgbW9ub3NwYWNlOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBsaW5lLWhlaWdodDogMS42Ow0KICAgIHBhZGRpbmc6IDEwcHggMTVweDsNCiAgICByZXNpemU6IG5vbmU7DQogICAgb3V0bGluZTogbm9uZTsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIG92ZXJmbG93LXg6IGF1dG87DQogICAgd2hpdGUtc3BhY2U6IHByZTsNCiAgICB0YWItc2l6ZTogNDsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCn0NCg0KI3RleHQtZWRpdG9yLndvcmQtd3JhcCB7DQogICAgd2hpdGUtc3BhY2U6IHByZS13cmFwOw0KICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsNCn0NCg0KI3RleHQtZWRpdG9yOjpwbGFjZWhvbGRlciB7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KfQ0KDQovKiBTeW50YXggSGlnaGxpZ2h0aW5nIEVkaXRvciAqLw0KLmhpZ2hsaWdodGVkLWVkaXRvciB7DQogICAgZmxleDogMTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWJnKTsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7DQogICAgZm9udC1mYW1pbHk6ICdTRiBNb25vJywgTW9uYWNvLCAnQ2FzY2FkaWEgQ29kZScsIG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgbGluZS1oZWlnaHQ6IDEuNjsNCiAgICBwYWRkaW5nOiAxMHB4IDE1cHg7DQogICAgb3V0bGluZTogbm9uZTsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIG92ZXJmbG93LXg6IGF1dG87DQogICAgd2hpdGUtc3BhY2U6IHByZTsNCiAgICB0YWItc2l6ZTogNDsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3I6Zm9jdXMgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpOw0KfQ0KDQovKiBQcmlzbS5qcyBUaGVtZSBPdmVycmlkZXMgZm9yIGJldHRlciBpbnRlZ3JhdGlvbiAqLw0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uY29tbWVudCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnByb2xvZywNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmRvY3R5cGUsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jZGF0YSB7DQogICAgY29sb3I6ICM2YTczN2Q7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnB1bmN0dWF0aW9uIHsNCiAgICBjb2xvcjogI2UxZTRlODsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucHJvcGVydHksDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi50YWcsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5ib29sZWFuLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ubnVtYmVyLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uY29uc3RhbnQsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5zeW1ib2wsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5kZWxldGVkIHsNCiAgICBjb2xvcjogIzc5YjhmZjsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uc2VsZWN0b3IsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5hdHRyLW5hbWUsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5zdHJpbmcsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jaGFyLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uYnVpbHRpbiwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmluc2VydGVkIHsNCiAgICBjb2xvcjogIzg1ZTg5ZDsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ub3BlcmF0b3IsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5lbnRpdHksDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi51cmwsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC5sYW5ndWFnZS1jc3MgLnRva2VuLnN0cmluZywNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnN0eWxlIC50b2tlbi5zdHJpbmcgew0KICAgIGNvbG9yOiAjZjk3NTgzOw0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5hdHJ1bGUsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5hdHRyLXZhbHVlLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ua2V5d29yZCB7DQogICAgY29sb3I6ICNmOTc1ODM7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmZ1bmN0aW9uLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uY2xhc3MtbmFtZSB7DQogICAgY29sb3I6ICNiMzkyZjA7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnJlZ2V4LA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uaW1wb3J0YW50LA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4udmFyaWFibGUgew0KICAgIGNvbG9yOiAjZmZhYjcwOw0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5pbXBvcnRhbnQsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5ib2xkIHsNCiAgICBmb250LXdlaWdodDogYm9sZDsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uaXRhbGljIHsNCiAgICBmb250LXN0eWxlOiBpdGFsaWM7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmVudGl0eSB7DQogICAgY3Vyc29yOiBoZWxwOw0KfQ0KDQovKiBFZGl0b3IgU3RhdHVzIEJhciAqLw0KLmVkaXRvci1zdGF0dXMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIHBhZGRpbmc6IDRweCAxNXB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtc2Vjb25kYXJ5KTsNCiAgICBmbGV4LXNocmluazogMDsNCiAgICBoZWlnaHQ6IDIycHg7DQogICAgbWluLWhlaWdodDogMjJweDsNCn0NCg0KLnN0YXR1cy1sZWZ0IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGdhcDogMjBweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KfQ0KDQovKiBPdmVycmlkZSB0aGUgbWFpbiBPUyAuc3RhdHVzLWl0ZW0gc3R5bGVzIHRvIGJlIGZsYXQgKi8NCi5lZGl0b3Itc3RhdHVzIC5zdGF0dXMtaXRlbSB7DQogICAgYmFja2dyb3VuZDogbm9uZSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlcjogbm9uZSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlci1yYWRpdXM6IDAgIWltcG9ydGFudDsNCiAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7DQogICAgdGV4dC1hbGlnbjogbGVmdCAhaW1wb3J0YW50Ow0KICAgIGRpc3BsYXk6IGlubGluZSAhaW1wb3J0YW50Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXNlY29uZGFyeSk7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxOw0KfQ0KDQouZWRpdG9yLXN0YXR1cyAuc3RhdHVzLWl0ZW0gc3BhbiB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCn0NCg0KLyogRmlsZSBQYXRoIERpc3BsYXkgKi8NCi5maWxlLXBhdGgtZGlzcGxheSB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICAgIHBhZGRpbmc6IDEwcHggMTVweDsNCiAgICBtaW4td2lkdGg6IDIwMHB4Ow0KICAgIGZvbnQtZmFtaWx5OiAnU0YgTW9ubycsIE1vbmFjbywgJ0Nhc2NhZGlhIENvZGUnLCBtb25vc3BhY2U7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDsNCn0NCg0KLyogUmVzcG9uc2l2ZSBEZXNpZ24gKi8NCkBtZWRpYSAobWF4LXdpZHRoOiA3NjhweCkgew0KICAgIC5hcHAtdG9vbGJhciB7DQogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICAgIGdhcDogMTBweDsNCiAgICB9DQogICAgDQogICAgLmFwcC1idG4tZ3JvdXAgew0KICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICB9DQogICAgDQogICAgLmVkaXRvci1zdGF0dXMgew0KICAgICAgICBmbGV4LXdyYXA6IHdyYXA7DQogICAgICAgIGdhcDogMTBweDsNCiAgICB9DQogICAgDQogICAgLmxpbmUtbnVtYmVycyB7DQogICAgICAgIG1pbi13aWR0aDogNDBweDsNCiAgICAgICAgZm9udC1zaXplOiAxM3B4OyAvKiBNYXRjaCBlZGl0b3IgZm9udCBzaXplICovDQogICAgfQ0KICAgIA0KICAgICN0ZXh0LWVkaXRvciwNCiAgICAuaGlnaGxpZ2h0ZWQtZWRpdG9yIHsNCiAgICAgICAgZm9udC1zaXplOiAxM3B4Ow0KICAgIH0NCn0NCg0KLyogRm9jdXMgU3RhdGVzICovDQojdGV4dC1lZGl0b3I6Zm9jdXMgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpOw0KfQ0KDQovKiBTY3JvbGxiYXIgU3R5bGluZyAqLw0KI3RleHQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhciwNCi5saW5lLW51bWJlcnM6Oi13ZWJraXQtc2Nyb2xsYmFyLA0KLmhpZ2hsaWdodGVkLWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXIgew0KICAgIHdpZHRoOiA4cHg7DQogICAgaGVpZ2h0OiA4cHg7DQp9DQoNCiN0ZXh0LWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2ssDQoubGluZS1udW1iZXJzOjotd2Via2l0LXNjcm9sbGJhci10cmFjaywNCi5oaWdobGlnaHRlZC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQp9DQoNCiN0ZXh0LWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIsDQoubGluZS1udW1iZXJzOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiwNCi5oaWdobGlnaHRlZC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCn0NCg0KI3RleHQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhci10aHVtYjpob3ZlciwNCi5saW5lLW51bWJlcnM6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyLA0KLmhpZ2hsaWdodGVkLWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1jb2xvcik7DQp9DQoNCi8qIEFwcCBUb29sYmFyICovDQouYXBwLXRvb2xiYXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgZmxleC1zaHJpbms6IDA7DQp9DQoNCi5hcHAtYnRuLWdyb3VwIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGdhcDogMTBweDsNCn0NCg0KLyogQW5pbWF0aW9uIGZvciBzdGF0dXMgY2hhbmdlcyAqLw0KLnN0YXR1cy12YWx1ZSB7DQogICAgdHJhbnNpdGlvbjogY29sb3IgMC4ycyBlYXNlOw0KfQ0KDQovKiBNb2RpZmllZCBzdGF0dXMgaW5kaWNhdG9yICovDQouc3RhdHVzLXZhbHVlLm1vZGlmaWVkIHsNCiAgICBjb2xvcjogI2ZmOTgwMDsNCiAgICBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlOw0KfQ0KDQpAa2V5ZnJhbWVzIHB1bHNlIHsNCiAgICAwJSB7IG9wYWNpdHk6IDE7IH0NCiAgICA1MCUgeyBvcGFjaXR5OiAwLjc7IH0NCiAgICAxMDAlIHsgb3BhY2l0eTogMTsgfQ0KfQ0KDQovKiBDb2RlIFZhbGlkYXRpb24gRXJyb3IgU3R5bGVzICovDQoubGluZS1lcnJvciB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsIDEwNywgMTA3LCAwLjIpICFpbXBvcnRhbnQ7DQogICAgY29sb3I6ICNmZjZiNmIgIWltcG9ydGFudDsNCiAgICBib3JkZXItbGVmdDogM3B4IHNvbGlkICNmZjZiNmIgIWltcG9ydGFudDsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQp9DQoNCi5saW5lLWVycm9yOjpiZWZvcmUgew0KICAgIGNvbnRlbnQ6ICLimqAiOw0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICBsZWZ0OiAycHg7DQogICAgdG9wOiA1MCU7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOw0KICAgIGNvbG9yOiAjZmY2YjZiOw0KICAgIGZvbnQtc2l6ZTogMTBweDsNCiAgICB6LWluZGV4OiAxOw0KfQ0KDQovKiBFcnJvciBjb3VudCBpbiBzdGF0dXMgYmFyICovDQouc3RhdHVzLXZhbHVlIHsNCiAgICB0cmFuc2l0aW9uOiBjb2xvciAwLjNzIGVhc2U7DQp9DQoNCi8qIEFjdGl2ZSB2YWxpZGF0aW9uIHRvZ2dsZSBidXR0b24gKi8NCi5hcHAtYnRuLmFjdGl2ZSB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LXByaW1hcnkpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCn0gPC9zdHlsZT4NCjxzY3JpcHQ+Ly8gPT09PT0gU2NyaXB0OiBqcy91dGlscy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvc2V0dGluZ3MtbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvZmlsZS1tYW5hZ2VyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9lZGl0b3ItbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvc3ludGF4LWhpZ2hsaWdodGluZy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvY29kZS12YWxpZGF0aW9uLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy91aS1tYW5hZ2VyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9tYWluLmpzID09PT09DQoNCg0KLy8gQ2hlY2sgaWYgZmlsZSBpcyBzdXBwb3J0ZWQgZm9yIHN5bnRheCBoaWdobGlnaHRpbmcNCmZ1bmN0aW9uIGdldEZpbGVMYW5ndWFnZShmaWxlUGF0aCkgew0KICAgIGlmICghZmlsZVBhdGgpIHJldHVybiBudWxsOw0KICAgIA0KICAgIGNvbnN0IGV4dGVuc2lvbiA9IGZpbGVQYXRoLnRvTG93ZXJDYXNlKCkuc3Vic3RyaW5nKGZpbGVQYXRoLmxhc3RJbmRleE9mKCcuJykpOw0KICAgIA0KICAgIGNvbnN0IGxhbmd1YWdlTWFwID0gew0KICAgICAgICAnLnB5JzogJ3B5dGhvbicsDQogICAgICAgICcucHl3JzogJ3B5dGhvbicsIA0KICAgICAgICAnLnB5eCc6ICdweXRob24nLA0KICAgICAgICAnLnB5aSc6ICdweXRob24nLA0KICAgICAgICAnLnB5ZCc6ICdweXRob24nLA0KICAgICAgICAnLmpzJzogJ2phdmFzY3JpcHQnLA0KICAgICAgICAnLmpzb24nOiAnanNvbicsDQogICAgICAgICcuaHRtbCc6ICdodG1sJywNCiAgICAgICAgJy5odG0nOiAnaHRtbCcsDQogICAgICAgICcuY3NzJzogJ2NzcycNCiAgICB9Ow0KICAgIA0KICAgIHJldHVybiBsYW5ndWFnZU1hcFtleHRlbnNpb25dIHx8IG51bGw7DQp9DQoNCi8vIENoZWNrIGlmIGZpbGUgaXMgUHl0aG9uIChmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSkNCmZ1bmN0aW9uIGlzUHl0aG9uRmlsZShmaWxlUGF0aCkgew0KICAgIHJldHVybiBnZXRGaWxlTGFuZ3VhZ2UoZmlsZVBhdGgpID09PSAncHl0aG9uJzsNCn0NCg0KLy8gU2ltcGxlIGhlbHBlciBmdW5jdGlvbnMgKGtlZXBpbmcgdGhlc2UgZm9yIHBvdGVudGlhbCBmdXR1cmUgdXNlKQ0KZnVuY3Rpb24gZ2V0U2ltcGxlVGV4dENvbnRlbnQoKSB7DQogICAgcmV0dXJuIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWU7DQp9DQoNCi8vIExvYWQgYXBwIHNldHRpbmdzDQphc3luYyBmdW5jdGlvbiBsb2FkU2V0dGluZ3MoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgdGV4dEVkaXRvci5zZXR0aW5ncyA9IHsNCiAgICAgICAgICAgIGF1dG9TYXZlSW50ZXJ2YWw6IGF3YWl0IHN5cG5leEFQSS5nZXRTZXR0aW5nKCdBVVRPX1NBVkVfSU5URVJWQUwnLCAzMCksDQogICAgICAgICAgICBmb250U2l6ZTogYXdhaXQgc3lwbmV4QVBJLmdldFNldHRpbmcoJ0ZPTlRfU0laRScsIDE0KSwNCiAgICAgICAgICAgIHRhYlNpemU6IGF3YWl0IHN5cG5leEFQSS5nZXRTZXR0aW5nKCdUQUJfU0laRScsIDQpLA0KICAgICAgICAgICAgc3ludGF4SGlnaGxpZ2h0aW5nOiBhd2FpdCBzeXBuZXhBUEkuZ2V0U2V0dGluZygnU1lOVEFYX0hJR0hMSUdIVElORycsIHRydWUpLA0KICAgICAgICAgICAgY29kZVZhbGlkYXRpb246IGF3YWl0IHN5cG5leEFQSS5nZXRTZXR0aW5nKCdDT0RFX1ZBTElEQVRJT04nLCB0cnVlKQ0KICAgICAgICB9Ow0KICAgICAgICANCiAgICAgICAgLy8gQXBwbHkgc2V0dGluZ3MNCiAgICAgICAgdGV4dEVkaXRvci50ZXh0YXJlYS5zdHlsZS5mb250U2l6ZSA9IHRleHRFZGl0b3Iuc2V0dGluZ3MuZm9udFNpemUgKyAncHgnOw0KICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnN0eWxlLnRhYlNpemUgPSB0ZXh0RWRpdG9yLnNldHRpbmdzLnRhYlNpemU7DQogICAgICAgIHRleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQgPSB0ZXh0RWRpdG9yLnNldHRpbmdzLmNvZGVWYWxpZGF0aW9uOw0KICAgICAgICANCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBzZXR0aW5nczonLCBlcnJvcik7DQogICAgICAgIC8vIFVzZSBkZWZhdWx0cw0KICAgICAgICB0ZXh0RWRpdG9yLnNldHRpbmdzID0gew0KICAgICAgICAgICAgYXV0b1NhdmVJbnRlcnZhbDogMzAsDQogICAgICAgICAgICBmb250U2l6ZTogMTQsDQogICAgICAgICAgICB0YWJTaXplOiA0LA0KICAgICAgICAgICAgc3ludGF4SGlnaGxpZ2h0aW5nOiB0cnVlLA0KICAgICAgICAgICAgY29kZVZhbGlkYXRpb246IHRydWUNCiAgICAgICAgfTsNCiAgICAgICAgdGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZCA9IHRydWU7DQogICAgfQ0KfQ0KDQoNCg0KDQovLyBDcmVhdGUgbmV3IGZpbGUNCmZ1bmN0aW9uIGNyZWF0ZU5ld0ZpbGUoKSB7DQogICAgaWYgKHRleHRFZGl0b3IuaXNNb2RpZmllZCkgew0KICAgICAgICBpZiAoY29uZmlybSgnWW91IGhhdmUgdW5zYXZlZCBjaGFuZ2VzLiBDcmVhdGUgbmV3IGZpbGUgYW55d2F5PycpKSB7DQogICAgICAgICAgICBjbGVhckVkaXRvcigpOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgY2xlYXJFZGl0b3IoKTsNCiAgICB9DQp9DQoNCi8vIExvYWQgZmlsZSBmcm9tIFZGUw0KYXN5bmMgZnVuY3Rpb24gbG9hZEZpbGUoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0ZpbGVFeHBsb3Jlcih7DQogICAgICAgICAgICBtb2RlOiAnb3BlbicsDQogICAgICAgICAgICB0aXRsZTogJ09wZW4gVGV4dCBGaWxlJywNCiAgICAgICAgICAgIGluaXRpYWxQYXRoOiAnLycsDQogICAgICAgICAgICBvblNlbGVjdDogKHNlbGVjdGVkUGF0aCkgPT4gew0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBjYW5jZWxsZWQNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFVzZSB0aGUgaGVscGVyIGZ1bmN0aW9uIHRvIGxvYWQgdGhlIGZpbGUNCiAgICAgICAgYXdhaXQgbG9hZEZpbGVCeVBhdGgoZmlsZVBhdGgpOw0KDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgZmlsZTonLCBlcnJvcik7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGYWlsZWQgdG8gbG9hZCBmaWxlOiAke2Vycm9yLm1lc3NhZ2V9YCwgJ2Vycm9yJyk7DQogICAgfQ0KfQ0KDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gbG9hZCBhIGZpbGUgYnkgcGF0aCAodXNlZCBieSBib3RoIGludGVyYWN0aXZlIGxvYWQgYW5kIGludGVudCBzeXN0ZW0pDQphc3luYyBmdW5jdGlvbiBsb2FkRmlsZUJ5UGF0aChmaWxlUGF0aCkgew0KICAgIHRyeSB7DQogICAgICAgIC8vIENoZWNrIGlmIGZpbGUgZXhpc3RzIGFuZCBsb2FkIGl0DQogICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlVGV4dChmaWxlUGF0aCk7DQoNCiAgICAgICAgLy8gTG9hZCBjb250ZW50IGludG8gZWRpdG9yDQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUgPSBjb250ZW50Ow0KICAgICAgICB0ZXh0RWRpdG9yLmZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgIHRleHRFZGl0b3Iub3JpZ2luYWxDb250ZW50ID0gY29udGVudDsNCg0KICAgICAgICAvLyBVcGRhdGUgVUkNCiAgICAgICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgIHVwZGF0ZUxpbmVOdW1iZXJzKCk7DQogICAgICAgIHVwZGF0ZVN0YXR1cygpOw0KICAgICAgICBtYXJrQXNTYXZlZCgpOw0KDQogICAgICAgIC8vIEVuYWJsZSBzeW50YXggaGlnaGxpZ2h0aW5nIGZvciBsb2FkZWQgZmlsZQ0KICAgICAgICBhd2FpdCBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCg0KICAgICAgICAvLyBGb3JjZSB1cGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudCBpZiBoaWdobGlnaHRpbmcgaXMgZW5hYmxlZA0KICAgICAgICBpZiAodGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkICYmIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU2NoZWR1bGUgdmFsaWRhdGlvbiBmb3IgUHl0aG9uIGZpbGVzDQogICAgICAgIHNjaGVkdWxlVmFsaWRhdGlvbigpOw0KDQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGaWxlIGxvYWRlZDogJHtmaWxlUGF0aH1gLCAnc3VjY2VzcycpOw0KDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgZmlsZSBieSBwYXRoOicsIGVycm9yKTsNCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZhaWxlZCB0byBsb2FkIGZpbGU6ICR7ZXJyb3IubWVzc2FnZX1gLCAnZXJyb3InKTsNCiAgICAgICAgdGhyb3cgZXJyb3I7DQogICAgfQ0KfQ0KDQoNCi8vIFNhdmUgZmlsZSB0byBWRlMNCmFzeW5jIGZ1bmN0aW9uIHNhdmVGaWxlKCkgew0KICAgIGNvbnN0IGNvbnRlbnQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlOw0KDQogICAgdHJ5IHsNCiAgICAgICAgbGV0IGZpbGVQYXRoID0gdGV4dEVkaXRvci5maWxlUGF0aDsNCg0KICAgICAgICAvLyBJZiBpdCdzIGEgbmV3IGZpbGUgKHVudGl0bGVkKSBvciB3ZSB3YW50IHRvIHNhdmUgYXMsIHNob3cgZmlsZSBleHBsb3Jlcg0KICAgICAgICBpZiAodGV4dEVkaXRvci5maWxlUGF0aCA9PT0gJy91bnRpdGxlZC50eHQnKSB7DQogICAgICAgICAgICBmaWxlUGF0aCA9IGF3YWl0IHN5cG5leEFQSS5zaG93RmlsZUV4cGxvcmVyKHsNCiAgICAgICAgICAgICAgICBtb2RlOiAnc2F2ZScsDQogICAgICAgICAgICAgICAgdGl0bGU6ICdTYXZlIFRleHQgRmlsZScsDQogICAgICAgICAgICAgICAgaW5pdGlhbFBhdGg6ICcvJywNCiAgICAgICAgICAgICAgICBmaWxlTmFtZTogJ3VudGl0bGVkLnR4dCcsDQogICAgICAgICAgICAgICAgb25TZWxlY3Q6IChzZWxlY3RlZFBhdGgpID0+IHsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgICAgICByZXR1cm47IC8vIFVzZXIgY2FuY2VsbGVkDQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZShmaWxlUGF0aCwgY29udGVudCk7DQoNCiAgICAgICAgdGV4dEVkaXRvci5maWxlUGF0aCA9IGZpbGVQYXRoOw0KICAgICAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgbWFya0FzU2F2ZWQoKTsNCg0KICAgICAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBmb3Igc2F2ZWQgZmlsZQ0KICAgICAgICBhd2FpdCBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCg0KICAgICAgICAvLyBGb3JjZSB1cGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudCBpZiBoaWdobGlnaHRpbmcgaXMgZW5hYmxlZA0KICAgICAgICBpZiAodGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkICYmIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgICAgICB9DQoNCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZpbGUgc2F2ZWQ6ICR7ZmlsZVBhdGh9YCwgJ3N1Y2Nlc3MnKTsNCg0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIGZpbGU6JywgZXJyb3IpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmFpbGVkIHRvIHNhdmUgZmlsZTogJHtlcnJvci5tZXNzYWdlfWAsICdlcnJvcicpOw0KICAgIH0NCn0NCg0KLy8gU2F2ZSBmaWxlIGFzIChhbHdheXMgc2hvdyBmaWxlIGV4cGxvcmVyKQ0KYXN5bmMgZnVuY3Rpb24gc2F2ZUFzRmlsZSgpIHsNCiAgICBjb25zdCBjb250ZW50ID0gdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZTsNCg0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IGZpbGVQYXRoID0gYXdhaXQgc3lwbmV4QVBJLnNob3dGaWxlRXhwbG9yZXIoew0KICAgICAgICAgICAgbW9kZTogJ3NhdmUnLA0KICAgICAgICAgICAgdGl0bGU6ICdTYXZlIFRleHQgRmlsZSBBcycsDQogICAgICAgICAgICBpbml0aWFsUGF0aDogJy8nLA0KICAgICAgICAgICAgZmlsZU5hbWU6IHRleHRFZGl0b3IuZmlsZVBhdGggPT09ICcvdW50aXRsZWQudHh0JyA/ICd1bnRpdGxlZC50eHQnIDogdGV4dEVkaXRvci5maWxlUGF0aC5zcGxpdCgnLycpLnBvcCgpLA0KICAgICAgICAgICAgb25TZWxlY3Q6IChzZWxlY3RlZFBhdGgpID0+IHsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4gew0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCg0KICAgICAgICBpZiAoIWZpbGVQYXRoKSB7DQogICAgICAgICAgICByZXR1cm47IC8vIFVzZXIgY2FuY2VsbGVkDQogICAgICAgIH0NCg0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZShmaWxlUGF0aCwgY29udGVudCk7DQoNCiAgICAgICAgdGV4dEVkaXRvci5maWxlUGF0aCA9IGZpbGVQYXRoOw0KICAgICAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgbWFya0FzU2F2ZWQoKTsNCg0KICAgICAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBmb3Igc2F2ZWQgZmlsZQ0KICAgICAgICBhd2FpdCBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCg0KICAgICAgICAvLyBGb3JjZSB1cGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudCBpZiBoaWdobGlnaHRpbmcgaXMgZW5hYmxlZA0KICAgICAgICBpZiAodGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkICYmIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgICAgICB9DQoNCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZpbGUgc2F2ZWQgYXM6ICR7ZmlsZVBhdGh9YCwgJ3N1Y2Nlc3MnKTsNCg0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIGZpbGUgYXM6JywgZXJyb3IpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmFpbGVkIHRvIHNhdmUgZmlsZSBhczogJHtlcnJvci5tZXNzYWdlfWAsICdlcnJvcicpOw0KICAgIH0NCn0NCg0KDQovLyBVcGRhdGUgbGluZSBudW1iZXJzDQpmdW5jdGlvbiB1cGRhdGVMaW5lTnVtYmVycygpIHsNCiAgICBpZiAoIXRleHRFZGl0b3IubGluZU51bWJlcnMgfHwgIXRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkKSByZXR1cm47DQogICAgDQogICAgY29uc3QgbGluZXMgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlLnNwbGl0KCdcbicpOw0KICAgIGNvbnN0IGxpbmVDb3VudCA9IGxpbmVzLmxlbmd0aDsNCiAgICANCiAgICAvLyBHZW5lcmF0ZSBsaW5lIG51bWJlcnMgSFRNTA0KICAgIGxldCBsaW5lTnVtYmVyc0hUTUwgPSAnJzsNCiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBsaW5lQ291bnQ7IGkrKykgew0KICAgICAgICBsaW5lTnVtYmVyc0hUTUwgKz0gYDxzcGFuIGNsYXNzPSJsaW5lLW51bWJlciI+JHtpfTwvc3Bhbj5cbmA7DQogICAgfQ0KICAgIA0KICAgIHRleHRFZGl0b3IubGluZU51bWJlcnMuaW5uZXJIVE1MID0gbGluZU51bWJlcnNIVE1MOw0KfQ0KDQovLyBTeW5jIHNjcm9sbCBiZXR3ZWVuIHRleHRhcmVhIGFuZCBsaW5lIG51bWJlcnMNCmZ1bmN0aW9uIHN5bmNTY3JvbGwoKSB7DQogICAgaWYgKHRleHRFZGl0b3IubGluZU51bWJlcnMgJiYgdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQpIHsNCiAgICAgICAgdGV4dEVkaXRvci5saW5lTnVtYmVycy5zY3JvbGxUb3AgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnNjcm9sbFRvcDsNCiAgICB9DQogICAgDQogICAgLy8gQWxzbyBzeW5jIHRoZSBiYWNrZHJvcCBpZiBpdCBleGlzdHMNCiAgICBzeW5jQmFja2Ryb3BTY3JvbGwoKTsNCn0NCg0KDQovLyBIYW5kbGUgdGV4dCBjaGFuZ2VzDQpmdW5jdGlvbiBoYW5kbGVUZXh0Q2hhbmdlKCkgew0KICAgIHVwZGF0ZUxpbmVOdW1iZXJzKCk7DQogICAgdXBkYXRlU3RhdHVzKCk7DQogICAgbWFya0FzTW9kaWZpZWQoKTsNCiAgICANCiAgICAvLyBTY2hlZHVsZSB2YWxpZGF0aW9uIGZvciBQeXRob24gZmlsZXMNCiAgICBzY2hlZHVsZVZhbGlkYXRpb24oKTsNCn0NCg0KLy8gRm9jdXMgYXBwcm9wcmlhdGUgZWRpdG9yDQpmdW5jdGlvbiBmb2N1c0VkaXRvcigpIHsNCiAgICBpZiAodGV4dEVkaXRvci50ZXh0YXJlYSkgew0KICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLmZvY3VzKCk7DQogICAgfQ0KfQ0KDQoNCi8vIFVwZGF0ZSBmaWxlbmFtZSBkaXNwbGF5DQpmdW5jdGlvbiB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKSB7DQogICAgaWYgKGN1cnJlbnRGaWxlbmFtZUVsKSB7DQogICAgICAgIGNvbnN0IGZpbGVuYW1lID0gdGV4dEVkaXRvci5maWxlUGF0aCA/IHRleHRFZGl0b3IuZmlsZVBhdGguc3BsaXQoJy8nKS5wb3AoKSA6ICd1bnRpdGxlZC50eHQnOw0KICAgICAgICBjdXJyZW50RmlsZW5hbWVFbC50ZXh0Q29udGVudCA9IGZpbGVuYW1lOw0KICAgIH0NCn0NCg0KLy8gSW5pdGlhbGl6ZSBlZGl0b3Igc3RhdGUNCmZ1bmN0aW9uIGluaXRpYWxpemVFZGl0b3IoKSB7DQogICAgLy8gU2V0IGluaXRpYWwgZmlsZSBwYXRoDQogICAgdGV4dEVkaXRvci5maWxlUGF0aCA9ICcvdW50aXRsZWQudHh0JzsNCiAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICANCiAgICAvLyBVcGRhdGUgbGluZSBudW1iZXJzDQogICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICANCiAgICAvLyBVcGRhdGUgc3RhdHVzDQogICAgdXBkYXRlU3RhdHVzKCk7DQogICAgDQogICAgLy8gRW5hYmxlIHN5bnRheCBoaWdobGlnaHRpbmcgaWYgbmVlZGVkDQogICAgZW5hYmxlU3ludGF4SGlnaGxpZ2h0aW5nKCk7DQogICAgDQogICAgLy8gU3RhcnQgYXV0by1zYXZlIGlmIGVuYWJsZWQNCiAgICBpZiAodGV4dEVkaXRvci5zZXR0aW5ncy5hdXRvU2F2ZUludGVydmFsID4gMCkgew0KICAgICAgICBzdGFydEF1dG9TYXZlKCk7DQogICAgfQ0KfQ0KDQoNCg0KLy8gVXBkYXRlIHN0YXR1cyBiYXINCmZ1bmN0aW9uIHVwZGF0ZVN0YXR1cygpIHsNCiAgICAvLyBTdGF0dXMgYmFyIG5vdyBvbmx5IHNob3dzIG1vZGlmaWVkIHN0YXR1cywgd2hpY2ggaXMgaGFuZGxlZCBieSBtYXJrQXNNb2RpZmllZC9tYXJrQXNTYXZlZA0KICAgIC8vIFRoaXMgZnVuY3Rpb24gaXMga2VwdCBmb3IgcG90ZW50aWFsIGZ1dHVyZSB1c2UNCn0NCg0KLy8gTWFyayBmaWxlIGFzIG1vZGlmaWVkDQpmdW5jdGlvbiBtYXJrQXNNb2RpZmllZCgpIHsNCiAgICBpZiAoIXRleHRFZGl0b3IuaXNNb2RpZmllZCkgew0KICAgICAgICB0ZXh0RWRpdG9yLmlzTW9kaWZpZWQgPSB0cnVlOw0KICAgICAgICBpZiAobW9kaWZpZWRTdGF0dXNFbCkgew0KICAgICAgICAgICAgbW9kaWZpZWRTdGF0dXNFbC50ZXh0Q29udGVudCA9ICdZZXMnOw0KICAgICAgICAgICAgbW9kaWZpZWRTdGF0dXNFbC5jbGFzc0xpc3QuYWRkKCdtb2RpZmllZCcpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBNYXJrIGZpbGUgYXMgc2F2ZWQNCmZ1bmN0aW9uIG1hcmtBc1NhdmVkKCkgew0KICAgIHRleHRFZGl0b3IuaXNNb2RpZmllZCA9IGZhbHNlOw0KICAgIHRleHRFZGl0b3Iub3JpZ2luYWxDb250ZW50ID0gdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZTsNCiAgICBpZiAobW9kaWZpZWRTdGF0dXNFbCkgew0KICAgICAgICBtb2RpZmllZFN0YXR1c0VsLnRleHRDb250ZW50ID0gJ05vJzsNCiAgICAgICAgbW9kaWZpZWRTdGF0dXNFbC5jbGFzc0xpc3QucmVtb3ZlKCdtb2RpZmllZCcpOw0KICAgIH0NCn0NCg0KDQovLyBDbGVhciBlZGl0b3INCmZ1bmN0aW9uIGNsZWFyRWRpdG9yKCkgew0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUgPSAnJzsNCiAgICB0ZXh0RWRpdG9yLmZpbGVQYXRoID0gJy91bnRpdGxlZC50eHQnOw0KICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgIHRleHRFZGl0b3Iub3JpZ2luYWxDb250ZW50ID0gJyc7DQogICAgbWFya0FzU2F2ZWQoKTsNCiAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgIHVwZGF0ZVN0YXR1cygpOw0KICAgIA0KICAgIC8vIEVuYWJsZSBzeW50YXggaGlnaGxpZ2h0aW5nIGZvciBuZXcgZmlsZQ0KICAgIGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpOw0KICAgIA0KICAgIC8vIEZvcmNlIHVwZGF0ZSBoaWdobGlnaHRlZCBjb250ZW50IGlmIGhpZ2hsaWdodGluZyBpcyBlbmFibGVkDQogICAgaWYgKHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCAmJiB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgIH0NCiAgICANCiAgICAvLyBDbGVhciBhbnkgZXhpc3RpbmcgZXJyb3JzDQogICAgY2xlYXJFcnJvck1hcmtlcnMoKTsNCiAgICB1cGRhdGVFcnJvckNvdW50KDApOw0KICAgIA0KICAgIC8vIEZvY3VzIHRoZSB0ZXh0YXJlYSAobm90IHRoZSBiYWNrZHJvcCkNCiAgICBmb2N1c0VkaXRvcigpOw0KfQ0KDQovLyBTdGFydCBhdXRvLXNhdmUNCmZ1bmN0aW9uIHN0YXJ0QXV0b1NhdmUoKSB7DQogICAgaWYgKHRleHRFZGl0b3IuYXV0b1NhdmVJbnRlcnZhbCkgew0KICAgICAgICBjbGVhckludGVydmFsKHRleHRFZGl0b3IuYXV0b1NhdmVJbnRlcnZhbCk7DQogICAgfQ0KICAgIA0KICAgIHRleHRFZGl0b3IuYXV0b1NhdmVJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgaWYgKHRleHRFZGl0b3IuaXNNb2RpZmllZCAmJiB0ZXh0RWRpdG9yLmZpbGVQYXRoICYmIHRleHRFZGl0b3IuZmlsZVBhdGggIT09ICcvdW50aXRsZWQudHh0Jykgew0KICAgICAgICAgICAgc2F2ZUZpbGUoKTsNCiAgICAgICAgfQ0KICAgIH0sIHRleHRFZGl0b3Iuc2V0dGluZ3MuYXV0b1NhdmVJbnRlcnZhbCAqIDEwMDApOw0KICAgIA0KfQ0KDQovLyBTdG9wIGF1dG8tc2F2ZQ0KZnVuY3Rpb24gc3RvcEF1dG9TYXZlKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLmF1dG9TYXZlSW50ZXJ2YWwpIHsNCiAgICAgICAgY2xlYXJJbnRlcnZhbCh0ZXh0RWRpdG9yLmF1dG9TYXZlSW50ZXJ2YWwpOw0KICAgICAgICB0ZXh0RWRpdG9yLmF1dG9TYXZlSW50ZXJ2YWwgPSBudWxsOw0KICAgIH0NCn0NCg0KDQovLyBMb2FkIFByaXNtLmpzIGZvciBzeW50YXggaGlnaGxpZ2h0aW5nDQphc3luYyBmdW5jdGlvbiBsb2FkUHJpc21KUygpIHsNCiAgICBpZiAodGV4dEVkaXRvci5wcmlzbUxvYWRlZCkgcmV0dXJuOw0KICAgIA0KICAgIHRyeSB7DQogICAgICAgIA0KICAgICAgICAvLyBMb2FkIFByaXNtLmpzIGxpYnJhcnkNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLmxvYWRMaWJyYXJ5KCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wcmlzbS8xLjI5LjAvcHJpc20ubWluLmpzJywgew0KICAgICAgICAgICAgbG9jYWxOYW1lOiAnUHJpc20nDQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgLy8gTG9hZCBsYW5ndWFnZSBjb21wb25lbnRzDQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL2NvbXBvbmVudHMvcHJpc20tcHl0aG9uLm1pbi5qcycpOw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC9jb21wb25lbnRzL3ByaXNtLWphdmFzY3JpcHQubWluLmpzJyk7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL2NvbXBvbmVudHMvcHJpc20tanNvbi5taW4uanMnKTsNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLmxvYWRMaWJyYXJ5KCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wcmlzbS8xLjI5LjAvY29tcG9uZW50cy9wcmlzbS1tYXJrdXAubWluLmpzJyk7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL2NvbXBvbmVudHMvcHJpc20tY3NzLm1pbi5qcycpOw0KICAgICAgICANCiAgICAgICAgLy8gTG9hZCBQcmlzbSBDU1MNCiAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTsNCiAgICAgICAgbGluay5yZWwgPSAnc3R5bGVzaGVldCc7DQogICAgICAgIGxpbmsuaHJlZiA9ICdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wcmlzbS8xLjI5LjAvdGhlbWVzL3ByaXNtLXRvbW9ycm93Lm1pbi5jc3MnOw0KICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGxpbmspOw0KICAgICAgICANCiAgICAgICAgLy8gQWRkIGN1c3RvbSBDU1MgdG8gZml4IHN0eWxpbmcgaXNzdWVzDQogICAgICAgIGNvbnN0IGN1c3RvbVN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsNCiAgICAgICAgY3VzdG9tU3R5bGUudGV4dENvbnRlbnQgPSBgDQogICAgICAgICAgICAuaGlnaGxpZ2h0ZWQtYmFja2Ryb3AgKiB7DQogICAgICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uLWxpbmU6IG5vbmUgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICB0ZXh0LWRlY29yYXRpb24tc3R5bGU6IG5vbmUgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICB0ZXh0LWRlY29yYXRpb24tY29sb3I6IHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogbm9uZSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgIHRleHQtdW5kZXJsaW5lLW9mZnNldDogMCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLmhpZ2hsaWdodGVkLWJhY2tkcm9wIC50b2tlbi5zdHJpbmcgew0KICAgICAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgfQ0KICAgICAgICBgOw0KICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGN1c3RvbVN0eWxlKTsNCiAgICAgICAgDQogICAgICAgIHRleHRFZGl0b3IucHJpc21Mb2FkZWQgPSB0cnVlOw0KICAgICAgICANCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBQcmlzbS5qczonLCBlcnJvcik7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdGYWlsZWQgdG8gbG9hZCBzeW50YXggaGlnaGxpZ2h0aW5nJywgJ2Vycm9yJyk7DQogICAgfQ0KfQ0KDQovLyBDcmVhdGUgaGlnaGxpZ2h0ZWQgZWRpdG9yDQpmdW5jdGlvbiBjcmVhdGVIaWdobGlnaHRlZEVkaXRvcigpIHsNCiAgICBpZiAoIXRleHRFZGl0b3IucHJpc21Mb2FkZWQpIHJldHVybjsNCiAgICANCiAgICAvLyBDbGVhbiB1cCBhbnkgZXhpc3RpbmcgaGlnaGxpZ2h0ZWQgc2V0dXANCiAgICBjbGVhbnVwSGlnaGxpZ2h0ZWRFZGl0b3IoKTsNCiAgICANCiAgICBjb25zdCBlZGl0b3JXcmFwcGVyID0gdGV4dEVkaXRvci50ZXh0YXJlYS5wYXJlbnRFbGVtZW50Ow0KICAgIGNvbnN0IHRleHRhcmVhID0gdGV4dEVkaXRvci50ZXh0YXJlYTsNCiAgICANCiAgICAvLyBTdG9yZSBvcmlnaW5hbCB0ZXh0YXJlYSBzdHlsZXMNCiAgICBjb25zdCBvcmlnaW5hbFN0eWxlcyA9IHsNCiAgICAgICAgcG9zaXRpb246IHRleHRhcmVhLnN0eWxlLnBvc2l0aW9uLA0KICAgICAgICBiYWNrZ3JvdW5kOiB0ZXh0YXJlYS5zdHlsZS5iYWNrZ3JvdW5kLA0KICAgICAgICBjb2xvcjogdGV4dGFyZWEuc3R5bGUuY29sb3IsDQogICAgICAgIHpJbmRleDogdGV4dGFyZWEuc3R5bGUuekluZGV4LA0KICAgICAgICBjYXJldENvbG9yOiB0ZXh0YXJlYS5zdHlsZS5jYXJldENvbG9yLA0KICAgICAgICBzcGVsbGNoZWNrOiB0ZXh0YXJlYS5nZXRBdHRyaWJ1dGUoJ3NwZWxsY2hlY2snKSwNCiAgICAgICAgYXV0b2NvbXBsZXRlOiB0ZXh0YXJlYS5nZXRBdHRyaWJ1dGUoJ2F1dG9jb21wbGV0ZScpLA0KICAgICAgICBhdXRvY29ycmVjdDogdGV4dGFyZWEuZ2V0QXR0cmlidXRlKCdhdXRvY29ycmVjdCcpLA0KICAgICAgICBhdXRvY2FwaXRhbGl6ZTogdGV4dGFyZWEuZ2V0QXR0cmlidXRlKCdhdXRvY2FwaXRhbGl6ZScpDQogICAgfTsNCiAgICANCiAgICAvLyBDcmVhdGUgYSBjb250YWluZXIgZm9yIHRoZSBvdmVybGF5IGFwcHJvYWNoDQogICAgY29uc3QgaGlnaGxpZ2h0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgaGlnaGxpZ2h0Q29udGFpbmVyLmNsYXNzTmFtZSA9ICdoaWdobGlnaHQtY29udGFpbmVyJzsNCiAgICBoaWdobGlnaHRDb250YWluZXIuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnOw0KICAgIGhpZ2hsaWdodENvbnRhaW5lci5zdHlsZS53aWR0aCA9ICcxMDAlJzsNCiAgICBoaWdobGlnaHRDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gJzEwMCUnOw0KICAgIA0KICAgIC8vIENyZWF0ZSBoaWdobGlnaHRlZCBiYWNrZHJvcA0KICAgIGNvbnN0IGhpZ2hsaWdodGVkQmFja2Ryb3AgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLmlkID0gJ2hpZ2hsaWdodGVkLWJhY2tkcm9wJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLmNsYXNzTmFtZSA9ICdoaWdobGlnaHRlZC1iYWNrZHJvcCc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS50b3AgPSAnMCc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5sZWZ0ID0gJzAnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUud2lkdGggPSAnMTAwJSc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUuZm9udEZhbWlseSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRleHRhcmVhKS5mb250RmFtaWx5Ow0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUuZm9udFNpemUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0ZXh0YXJlYSkuZm9udFNpemU7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5saW5lSGVpZ2h0ID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGV4dGFyZWEpLmxpbmVIZWlnaHQ7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5wYWRkaW5nID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGV4dGFyZWEpLnBhZGRpbmc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5tYXJnaW4gPSAnMCc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5ib3JkZXIgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0ZXh0YXJlYSkuYm9yZGVyOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUud2hpdGVTcGFjZSA9ICdwcmUtd3JhcCc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS53b3JkV3JhcCA9ICdicmVhay13b3JkJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS56SW5kZXggPSAnMSc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5yZXNpemUgPSAnbm9uZSc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5jb2xvciA9ICcjZmZmZmZmJzsgLy8gRGVmYXVsdCB0ZXh0IGNvbG9yIGZvciBoaWdobGlnaHRpbmcNCiAgICANCiAgICAvLyBNYWtlIHN1cmUgdGV4dGFyZWEgaXMgb24gdG9wIGFuZCBoYXMgdHJhbnNwYXJlbnQgYmFja2dyb3VuZCBhbmQgdGV4dA0KICAgIHRleHRhcmVhLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJzsNCiAgICB0ZXh0YXJlYS5zdHlsZS56SW5kZXggPSAnMic7DQogICAgdGV4dGFyZWEuc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7DQogICAgdGV4dGFyZWEuc3R5bGUuY29sb3IgPSAndHJhbnNwYXJlbnQnOw0KICAgIHRleHRhcmVhLnN0eWxlLmNhcmV0Q29sb3IgPSAnI2ZmZmZmZic7DQogICAgDQogICAgLy8gRGlzYWJsZSBicm93c2VyIHNwZWxsIGNoZWNraW5nIGZvciBjb2RlDQogICAgdGV4dGFyZWEuc2V0QXR0cmlidXRlKCdzcGVsbGNoZWNrJywgJ2ZhbHNlJyk7DQogICAgdGV4dGFyZWEuc2V0QXR0cmlidXRlKCdhdXRvY29tcGxldGUnLCAnb2ZmJyk7DQogICAgdGV4dGFyZWEuc2V0QXR0cmlidXRlKCdhdXRvY29ycmVjdCcsICdvZmYnKTsNCiAgICB0ZXh0YXJlYS5zZXRBdHRyaWJ1dGUoJ2F1dG9jYXBpdGFsaXplJywgJ29mZicpOw0KICAgIA0KICAgIC8vIFdyYXAgdGV4dGFyZWEgaW4gY29udGFpbmVyDQogICAgZWRpdG9yV3JhcHBlci5pbnNlcnRCZWZvcmUoaGlnaGxpZ2h0Q29udGFpbmVyLCB0ZXh0YXJlYSk7DQogICAgaGlnaGxpZ2h0Q29udGFpbmVyLmFwcGVuZENoaWxkKGhpZ2hsaWdodGVkQmFja2Ryb3ApOw0KICAgIGhpZ2hsaWdodENvbnRhaW5lci5hcHBlbmRDaGlsZCh0ZXh0YXJlYSk7DQogICAgDQogICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvciA9IGhpZ2hsaWdodGVkQmFja2Ryb3A7DQogICAgdGV4dEVkaXRvci5oaWdobGlnaHRDb250YWluZXIgPSBoaWdobGlnaHRDb250YWluZXI7DQogICAgdGV4dEVkaXRvci5vcmlnaW5hbFRleHRhcmVhU3R5bGVzID0gb3JpZ2luYWxTdHlsZXM7DQogICAgdGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkID0gdHJ1ZTsNCiAgICANCiAgICAvLyBTZXQgaW5pdGlhbCBjb250ZW50DQogICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgDQogICAgLy8gU2V0IHVwIHNpbXBsZSBldmVudCBoYW5kbGVycyBmb3IgdGhlIHRleHRhcmVhIChub3QgdGhlIGJhY2tkcm9wKQ0KICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgaGFuZGxlU2ltcGxlSW5wdXQpOw0KICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHN5bmNCYWNrZHJvcFNjcm9sbCk7DQogICAgdGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUhpZ2hsaWdodEtleURvd24pOw0KICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlSGlnaGxpZ2h0Q2xpY2spOw0KICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgaGFuZGxlSGlnaGxpZ2h0Rm9jdXMpOw0KICAgIA0KfQ0KDQoNCi8vIFVwZGF0ZSBoaWdobGlnaHRlZCBjb250ZW50DQpmdW5jdGlvbiB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKSB7DQogICAgaWYgKCF0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yIHx8ICF0ZXh0RWRpdG9yLnByaXNtTG9hZGVkKSByZXR1cm47DQogICAgDQogICAgY29uc3QgY29udGVudCA9IHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWU7DQogICAgY29uc3QgbGFuZ3VhZ2UgPSBnZXRGaWxlTGFuZ3VhZ2UodGV4dEVkaXRvci5maWxlUGF0aCk7DQogICAgDQogICAgaWYgKCFsYW5ndWFnZSkgew0KICAgICAgICAvLyBObyBsYW5ndWFnZSBkZXRlY3RlZCwgdXNlIHBsYWluIHRleHQNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci50ZXh0Q29udGVudCA9IGNvbnRlbnQ7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gQXBwbHkgc3ludGF4IGhpZ2hsaWdodGluZyB0byBiYWNrZHJvcA0KICAgIGNvbnN0IGhpZ2hsaWdodGVkQ29udGVudCA9IFByaXNtLmhpZ2hsaWdodChjb250ZW50LCBQcmlzbS5sYW5ndWFnZXNbbGFuZ3VhZ2VdLCBsYW5ndWFnZSk7DQogICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5pbm5lckhUTUwgPSBoaWdobGlnaHRlZENvbnRlbnQ7DQogICAgDQogICAgLy8gU3luYyBzY3JvbGwgcG9zaXRpb24NCiAgICBzeW5jQmFja2Ryb3BTY3JvbGwoKTsNCiAgICANCn0NCg0KLy8gRW5hYmxlIHN5bnRheCBoaWdobGlnaHRpbmcgZm9yIHN1cHBvcnRlZCBmaWxlcw0KYXN5bmMgZnVuY3Rpb24gZW5hYmxlU3ludGF4SGlnaGxpZ2h0aW5nKCkgew0KICAgIGlmICghdGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmcpIHsNCiAgICAgICAgY2xlYW51cEhpZ2hsaWdodGVkRWRpdG9yKCk7DQogICAgICAgIHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCA9IGZhbHNlOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGxhbmd1YWdlID0gZ2V0RmlsZUxhbmd1YWdlKHRleHRFZGl0b3IuZmlsZVBhdGgpOw0KICAgIA0KICAgIGlmIChsYW5ndWFnZSkgew0KICAgICAgICBpZiAoIXRleHRFZGl0b3IucHJpc21Mb2FkZWQpIHsNCiAgICAgICAgICAgIGF3YWl0IGxvYWRQcmlzbUpTKCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGlmICghdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICAgICAgY3JlYXRlSGlnaGxpZ2h0ZWRFZGl0b3IoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgdGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkID0gdHJ1ZTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBEaXNhYmxlIGhpZ2hsaWdodGluZyBmb3IgdW5zdXBwb3J0ZWQgZmlsZXMNCiAgICAgICAgY2xlYW51cEhpZ2hsaWdodGVkRWRpdG9yKCk7DQogICAgICAgIHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCA9IGZhbHNlOw0KICAgIH0NCn0NCg0KLy8gSGFuZGxlIHNpbXBsZSBpbnB1dCBmb3IgYmFja2Ryb3AgYXBwcm9hY2gNCmZ1bmN0aW9uIGhhbmRsZVNpbXBsZUlucHV0KCkgew0KICAgIC8vIFVwZGF0ZSBsaW5lIG51bWJlcnMgYW5kIHN0YXR1cyBpbW1lZGlhdGVseQ0KICAgIHVwZGF0ZUxpbmVOdW1iZXJzKCk7DQogICAgdXBkYXRlU3RhdHVzKCk7DQogICAgbWFya0FzTW9kaWZpZWQoKTsNCiAgICANCiAgICAvLyBJbW1lZGlhdGUgaGlnaGxpZ2h0aW5nIHVwZGF0ZSBmb3IgcmVzcG9uc2l2ZSBmZWVsDQogICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgDQogICAgLy8gU2NoZWR1bGUgdmFsaWRhdGlvbiBmb3IgUHl0aG9uIGZpbGVzDQogICAgc2NoZWR1bGVWYWxpZGF0aW9uKCk7DQp9DQoNCi8vIEhhbmRsZSBrZXkgZXZlbnRzIHRoYXQgbWlnaHQgY2hhbmdlIGNvbnRlbnQNCmZ1bmN0aW9uIGhhbmRsZUhpZ2hsaWdodEtleURvd24oZSkgew0KICAgIC8vIEZvciBrZXlzIHRoYXQgbW9kaWZ5IGNvbnRlbnQsIHVwZGF0ZSBoaWdobGlnaHRpbmcgaW1tZWRpYXRlbHkgYWZ0ZXIgdGhlIGV2ZW50DQogICAgaWYgKGUua2V5ID09PSAnVGFiJyB8fCBlLmtleSA9PT0gJ0VudGVyJyB8fCBlLmtleSA9PT0gJ0JhY2tzcGFjZScgfHwgZS5rZXkgPT09ICdEZWxldGUnKSB7DQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgICAgIH0sIDApOyAvLyBVcGRhdGUgb24gbmV4dCB0aWNrIGFmdGVyIHRoZSBrZXkgZXZlbnQgaXMgcHJvY2Vzc2VkDQogICAgfQ0KfQ0KDQovLyBIYW5kbGUgY2xpY2sgZXZlbnRzIChjdXJzb3IgcG9zaXRpb24gY2hhbmdlcykNCmZ1bmN0aW9uIGhhbmRsZUhpZ2hsaWdodENsaWNrKCkgew0KICAgIC8vIFN5bmMgc2Nyb2xsIHBvc2l0aW9uIHdoZW4gdXNlciBjbGlja3MNCiAgICBzeW5jQmFja2Ryb3BTY3JvbGwoKTsNCn0NCg0KLy8gSGFuZGxlIGZvY3VzIGV2ZW50cw0KZnVuY3Rpb24gaGFuZGxlSGlnaGxpZ2h0Rm9jdXMoKSB7DQogICAgLy8gRW5zdXJlIGhpZ2hsaWdodGluZyBpcyBpbiBzeW5jIHdoZW4gdGV4dGFyZWEgZ2V0cyBmb2N1cw0KICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgIHN5bmNCYWNrZHJvcFNjcm9sbCgpOw0KfQ0KDQovLyBTeW5jIGJhY2tkcm9wIHNjcm9sbCB3aXRoIHRleHRhcmVhDQpmdW5jdGlvbiBzeW5jQmFja2Ryb3BTY3JvbGwoKSB7DQogICAgaWYgKHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5zY3JvbGxUb3AgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnNjcm9sbFRvcDsNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5zY3JvbGxMZWZ0ID0gdGV4dEVkaXRvci50ZXh0YXJlYS5zY3JvbGxMZWZ0Ow0KICAgIH0NCn0NCg0KLy8gQ2xlYW4gdXAgaGlnaGxpZ2h0ZWQgZWRpdG9yDQpmdW5jdGlvbiBjbGVhbnVwSGlnaGxpZ2h0ZWRFZGl0b3IoKSB7DQogICAgaWYgKHRleHRFZGl0b3IuaGlnaGxpZ2h0Q29udGFpbmVyKSB7DQogICAgICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgdGV4dGFyZWEgc3R5bGVzDQogICAgICAgIGlmICh0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMpIHsNCiAgICAgICAgICAgIGNvbnN0IHRleHRhcmVhID0gdGV4dEVkaXRvci50ZXh0YXJlYTsNCiAgICAgICAgICAgIHRleHRhcmVhLnN0eWxlLnBvc2l0aW9uID0gdGV4dEVkaXRvci5vcmlnaW5hbFRleHRhcmVhU3R5bGVzLnBvc2l0aW9uOw0KICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuYmFja2dyb3VuZCA9IHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcy5iYWNrZ3JvdW5kOw0KICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuY29sb3IgPSB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMuY29sb3I7DQogICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS56SW5kZXggPSB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMuekluZGV4Ow0KICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuY2FyZXRDb2xvciA9IHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcy5jYXJldENvbG9yOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBSZW1vdmUgdGhlIGNvbnRhaW5lciBhbmQgcmVzdG9yZSB0ZXh0YXJlYSB0byBpdHMgb3JpZ2luYWwgcGFyZW50DQogICAgICAgIGNvbnN0IGVkaXRvcldyYXBwZXIgPSB0ZXh0RWRpdG9yLmhpZ2hsaWdodENvbnRhaW5lci5wYXJlbnRFbGVtZW50Ow0KICAgICAgICBjb25zdCB0ZXh0YXJlYSA9IHRleHRFZGl0b3IudGV4dGFyZWE7DQogICAgICAgIA0KICAgICAgICAvLyBNb3ZlIHRleHRhcmVhIGJhY2sgdG8gaXRzIG9yaWdpbmFsIGxvY2F0aW9uDQogICAgICAgIGVkaXRvcldyYXBwZXIuaW5zZXJ0QmVmb3JlKHRleHRhcmVhLCB0ZXh0RWRpdG9yLmhpZ2hsaWdodENvbnRhaW5lcik7DQogICAgICAgIA0KICAgICAgICAvLyBSZW1vdmUgdGhlIGhpZ2hsaWdodCBjb250YWluZXINCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRDb250YWluZXIucmVtb3ZlKCk7DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciByZWZlcmVuY2VzDQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0Q29udGFpbmVyID0gbnVsbDsNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvciA9IG51bGw7DQogICAgICAgIHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcyA9IG51bGw7DQogICAgfQ0KfQ0KDQovLyBUb2dnbGUgc3ludGF4IGhpZ2hsaWdodGluZw0KYXN5bmMgZnVuY3Rpb24gdG9nZ2xlU3ludGF4SGlnaGxpZ2h0aW5nKCkgew0KICAgIHRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nID0gIXRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nOw0KICAgIA0KICAgIC8vIFNhdmUgc2V0dGluZw0KICAgIHRyeSB7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5zZXRTZXR0aW5nKCdTWU5UQVhfSElHSExJR0hUSU5HJywgdGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmcpOw0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIHN5bnRheCBoaWdobGlnaHRpbmcgc2V0dGluZzonLCBlcnJvcik7DQogICAgfQ0KICAgIA0KICAgIC8vIFVwZGF0ZSBVSQ0KICAgIGlmIChzeW50YXhIaWdobGlnaHRpbmdUb2dnbGUpIHsNCiAgICAgICAgc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIHRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nKTsNCiAgICB9DQogICAgDQogICAgLy8gQXBwbHkgb3IgZGlzYWJsZSBoaWdobGlnaHRpbmcNCiAgICBpZiAodGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmcpIHsNCiAgICAgICAgYXdhaXQgZW5hYmxlU3ludGF4SGlnaGxpZ2h0aW5nKCk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gRGlzYWJsZSBoaWdobGlnaHRpbmcNCiAgICAgICAgY2xlYW51cEhpZ2hsaWdodGVkRWRpdG9yKCk7DQogICAgICAgIHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCA9IGZhbHNlOw0KICAgIH0NCiAgICANCiAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbigNCiAgICAgICAgYFN5bnRheCBoaWdobGlnaHRpbmcgJHt0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZyA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCd9YCwNCiAgICAgICAgJ2luZm8nDQogICAgKTsNCn0NCg0KDQovLyBMb2FkIFB5b2RpZGUgZm9yIFB5dGhvbiBzeW50YXggdmFsaWRhdGlvbg0KYXN5bmMgZnVuY3Rpb24gbG9hZFB5b2RpZGUoKSB7DQogICAgDQogICAgaWYgKHRleHRFZGl0b3IucHlvZGlkZUxvYWRlZCAmJiB3aW5kb3cucHlvZGlkZSkgew0KICAgICAgICByZXR1cm4gd2luZG93LnB5b2RpZGU7DQogICAgfQ0KICAgIA0KICAgIHRyeSB7DQogICAgICAgIA0KICAgICAgICAvLyBMb2FkIFB5b2RpZGUgc2NyaXB0DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L3B5b2RpZGUvdjAuMjQuMS9mdWxsL3B5b2RpZGUuanMnLCB7DQogICAgICAgICAgICBsb2NhbE5hbWU6ICdsb2FkUHlvZGlkZScNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICANCiAgICAgICAgLy8gSW5pdGlhbGl6ZSBQeW9kaWRlIC0gdXNlIHRoZSBnbG9iYWwgbG9hZFB5b2RpZGUgZnVuY3Rpb24NCiAgICAgICAgd2luZG93LnB5b2RpZGUgPSBhd2FpdCB3aW5kb3cubG9hZFB5b2RpZGUoew0KICAgICAgICAgICAgaW5kZXhVUkw6ICJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvcHlvZGlkZS92MC4yNC4xL2Z1bGwvIg0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIA0KICAgICAgICAvLyBJbnN0YWxsIHZhbGlkYXRpb24gZnVuY3Rpb24NCiAgICAgICAgd2luZG93LnB5b2RpZGUucnVuUHl0aG9uKGANCmltcG9ydCBhc3QNCg0KZGVmIHZhbGlkYXRlX3B5dGhvbl9zeW50YXgoY29kZSk6DQogICAgIiIiVmFsaWRhdGUgUHl0aG9uIHN5bnRheCBhbmQgcmV0dXJuIGVycm9ycyIiIg0KICAgIHRyeToNCiAgICAgICAgIyBUcnkgdG8gcGFyc2UgdGhlIGNvZGUgYXMgYW4gQVNUDQogICAgICAgIGFzdC5wYXJzZShjb2RlKQ0KICAgICAgICByZXR1cm4geyJ2YWxpZCI6IFRydWUsICJlcnJvcnMiOiBbXX0NCiAgICBleGNlcHQgU3ludGF4RXJyb3IgYXMgZToNCiAgICAgICAgZXJyb3JfaW5mbyA9IHsNCiAgICAgICAgICAgICJsaW5lIjogZS5saW5lbm8gb3IgMSwNCiAgICAgICAgICAgICJjb2x1bW4iOiBlLm9mZnNldCBvciAxLCANCiAgICAgICAgICAgICJtZXNzYWdlIjogZS5tc2cgb3IgIlN5bnRheCBlcnJvciIsDQogICAgICAgICAgICAidHlwZSI6ICJzeW50YXgiDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHsidmFsaWQiOiBGYWxzZSwgImVycm9ycyI6IFtlcnJvcl9pbmZvXX0NCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgIGVycm9yX2luZm8gPSB7DQogICAgICAgICAgICAibGluZSI6IDEsDQogICAgICAgICAgICAiY29sdW1uIjogMSwNCiAgICAgICAgICAgICJtZXNzYWdlIjogc3RyKGUpLA0KICAgICAgICAgICAgInR5cGUiOiAiZ2VuZXJhbCINCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4geyJ2YWxpZCI6IEZhbHNlLCAiZXJyb3JzIjogW2Vycm9yX2luZm9dfQ0KICAgICAgICBgKTsNCiAgICAgICAgDQogICAgICAgIHRleHRFZGl0b3IucHlvZGlkZUxvYWRlZCA9IHRydWU7DQogICAgICAgIA0KICAgICAgICAvLyBTaG93IG5vdGlmaWNhdGlvbg0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignUHl0aG9uIHZhbGlkYXRpb24gcmVhZHkhJywgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiB3aW5kb3cucHlvZGlkZTsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBsb2FkIFB5b2RpZGU6JywgZXJyb3IpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignRmFpbGVkIHRvIGxvYWQgUHl0aG9uIHZhbGlkYXRpb246ICcgKyBlcnJvci5tZXNzYWdlLCAnZXJyb3InKTsNCiAgICAgICAgdGhyb3cgZXJyb3I7DQogICAgfQ0KfQ0KDQovLyBWYWxpZGF0ZSBQeXRob24gc3ludGF4IHVzaW5nIFB5b2RpZGUNCmFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlUHl0aG9uU3ludGF4KGNvZGUpIHsNCiAgICANCiAgICBpZiAoIXRleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQpIHsNCiAgICAgICAgcmV0dXJuIHsidmFsaWQiOiB0cnVlLCAiZXJyb3JzIjogW119Ow0KICAgIH0NCiAgICANCiAgICB0cnkgew0KICAgICAgICBjb25zdCBweW9kaWRlID0gYXdhaXQgbG9hZFB5b2RpZGUoKTsNCiAgICAgICAgDQogICAgICAgIC8vIENhbGwgdGhlIFB5dGhvbiB2YWxpZGF0aW9uIGZ1bmN0aW9uDQogICAgICAgIHB5b2RpZGUuZ2xvYmFscy5zZXQoImNvZGVfdG9fdmFsaWRhdGUiLCBjb2RlKTsNCiAgICAgICAgY29uc3QgcmVzdWx0ID0gcHlvZGlkZS5ydW5QeXRob24oInZhbGlkYXRlX3B5dGhvbl9zeW50YXgoY29kZV90b192YWxpZGF0ZSkiKTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IGpzUmVzdWx0ID0gcmVzdWx0LnRvSnMoe2RpY3RfY29udmVydGVyOiBPYmplY3QuZnJvbUVudHJpZXN9KTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiBqc1Jlc3VsdDsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFB5b2RpZGUgdmFsaWRhdGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIA0KICAgICAgICAvLyBGYWxsYmFjayB0byBiYXNpYyBjbGllbnQtc2lkZSB2YWxpZGF0aW9uDQogICAgICAgIHJldHVybiB2YWxpZGF0ZVB5dGhvbkJhc2ljKGNvZGUpOw0KICAgIH0NCn0NCg0KLy8gQmFzaWMgUHl0aG9uIHN5bnRheCB2YWxpZGF0aW9uIChmYWxsYmFjaykNCmZ1bmN0aW9uIHZhbGlkYXRlUHl0aG9uQmFzaWMoY29kZSkgew0KICAgIGNvbnN0IGVycm9ycyA9IFtdOw0KICAgIGNvbnN0IGxpbmVzID0gY29kZS5zcGxpdCgnXG4nKTsNCiAgICANCiAgICBsaW5lcy5mb3JFYWNoKChsaW5lLCBpbmRleCkgPT4gew0KICAgICAgICBjb25zdCBsaW5lTnVtID0gaW5kZXggKyAxOw0KICAgICAgICBjb25zdCB0cmltbWVkID0gbGluZS50cmltKCk7DQogICAgICAgIA0KICAgICAgICAvLyBTa2lwIGVtcHR5IGxpbmVzIGFuZCBjb21tZW50cw0KICAgICAgICBpZiAoIXRyaW1tZWQgfHwgdHJpbW1lZC5zdGFydHNXaXRoKCcjJykpIHJldHVybjsNCiAgICAgICAgDQogICAgICAgIC8vIENoZWNrIGZvciB1bnRlcm1pbmF0ZWQgc3RyaW5ncyAobW9yZSBhY2N1cmF0ZSkNCiAgICAgICAgbGV0IGluU3RyaW5nID0gZmFsc2U7DQogICAgICAgIGxldCBzdHJpbmdDaGFyID0gbnVsbDsNCiAgICAgICAgbGV0IGVzY2FwZWQgPSBmYWxzZTsNCiAgICAgICAgDQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJpbW1lZC5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgY29uc3QgY2hhciA9IHRyaW1tZWRbaV07DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChlc2NhcGVkKSB7DQogICAgICAgICAgICAgICAgZXNjYXBlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoY2hhciA9PT0gJ1xcJykgew0KICAgICAgICAgICAgICAgIGVzY2FwZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoIWluU3RyaW5nICYmIChjaGFyID09PSAnIicgfHwgY2hhciA9PT0gIiciKSkgew0KICAgICAgICAgICAgICAgIGluU3RyaW5nID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBzdHJpbmdDaGFyID0gY2hhcjsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5TdHJpbmcgJiYgY2hhciA9PT0gc3RyaW5nQ2hhcikgew0KICAgICAgICAgICAgICAgIGluU3RyaW5nID0gZmFsc2U7DQogICAgICAgICAgICAgICAgc3RyaW5nQ2hhciA9IG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGlmIChpblN0cmluZykgew0KICAgICAgICAgICAgZXJyb3JzLnB1c2goew0KICAgICAgICAgICAgICAgIGxpbmU6IGxpbmVOdW0sDQogICAgICAgICAgICAgICAgY29sdW1uOiAxLA0KICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJVbnRlcm1pbmF0ZWQgc3RyaW5nIGxpdGVyYWwiLA0KICAgICAgICAgICAgICAgIHR5cGU6ICJzeW50YXgiDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQ2hlY2sgZm9yIG1pc3NpbmcgY29sb25zIGFmdGVyIGNvbnRyb2wgc3RydWN0dXJlcyAobW9yZSBwcmVjaXNlKQ0KICAgICAgICBjb25zdCBjb250cm9sU3RydWN0dXJlcyA9IC9eKGlmfGVsaWZ8ZWxzZXxmb3J8d2hpbGV8ZGVmfGNsYXNzfHRyeXxleGNlcHR8ZmluYWxseXx3aXRofGFzeW5jXHMrZGVmKVxzLzsNCiAgICAgICAgaWYgKGNvbnRyb2xTdHJ1Y3R1cmVzLnRlc3QodHJpbW1lZCkgJiYgIXRyaW1tZWQuZW5kc1dpdGgoJzonKSAmJiAhdHJpbW1lZC5pbmNsdWRlcygnIycpKSB7DQogICAgICAgICAgICBlcnJvcnMucHVzaCh7DQogICAgICAgICAgICAgICAgbGluZTogbGluZU51bSwNCiAgICAgICAgICAgICAgICBjb2x1bW46IHRyaW1tZWQubGVuZ3RoLA0KICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJNaXNzaW5nIGNvbG9uIiwNCiAgICAgICAgICAgICAgICB0eXBlOiAic3ludGF4Ig0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIENoZWNrIGZvciBiYXNpYyBpbmRlbnRhdGlvbiBlcnJvcnMgKHZlcnkgYmFzaWMpDQogICAgICAgIGlmICh0cmltbWVkLm1hdGNoKC9eKHJldHVybnxicmVha3xjb250aW51ZXxwYXNzfHJhaXNlfHlpZWxkKVxzLykgJiYgbGluZSAhPT0gdHJpbW1lZCkgew0KICAgICAgICAgICAgLy8gVGhlc2Uga2V5d29yZHMgc2hvdWxkIHR5cGljYWxseSBiZSBhdCBwcm9wZXIgaW5kZW50YXRpb24gbGV2ZWxzDQogICAgICAgICAgICAvLyBCdXQgdGhpcyBpcyB0b28gY29tcGxleCBmb3IgYmFzaWMgdmFsaWRhdGlvbiwgc28gc2tpcCBpdA0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBPbmx5IGNoZWNrIHBhcmVudGhlc2VzIG9uIGxpbmVzIHRoYXQgc2VlbSB0byBoYXZlIGZ1bmN0aW9uIGNhbGxzIG9yIGRlZmluaXRpb25zDQogICAgICAgIGlmICh0cmltbWVkLmluY2x1ZGVzKCcoJykgfHwgdHJpbW1lZC5pbmNsdWRlcygnKScpKSB7DQogICAgICAgICAgICBjb25zdCBvcGVuUGFyZW5zID0gKHRyaW1tZWQubWF0Y2goL1woL2cpIHx8IFtdKS5sZW5ndGg7DQogICAgICAgICAgICBjb25zdCBjbG9zZVBhcmVucyA9ICh0cmltbWVkLm1hdGNoKC9cKS9nKSB8fCBbXSkubGVuZ3RoOw0KICAgICAgICAgICAgaWYgKG9wZW5QYXJlbnMgIT09IGNsb3NlUGFyZW5zKSB7DQogICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goew0KICAgICAgICAgICAgICAgICAgICBsaW5lOiBsaW5lTnVtLA0KICAgICAgICAgICAgICAgICAgICBjb2x1bW46IDEsDQogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJVbm1hdGNoZWQgcGFyZW50aGVzZXMiLA0KICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3ludGF4Ig0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgcmV0dXJuIHsNCiAgICAgICAgdmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsDQogICAgICAgIGVycm9yczogZXJyb3JzDQogICAgfTsNCn0NCg0KDQovLyBTY2hlZHVsZSB2YWxpZGF0aW9uIHdpdGggZGVib3VuY2luZw0KZnVuY3Rpb24gc2NoZWR1bGVWYWxpZGF0aW9uKCkgew0KICAgIA0KICAgIC8vIENsZWFyIGV4aXN0aW5nIHRpbWVyDQogICAgaWYgKHRleHRFZGl0b3IudmFsaWRhdGlvbkRlYm91bmNlVGltZXIpIHsNCiAgICAgICAgY2xlYXJUaW1lb3V0KHRleHRFZGl0b3IudmFsaWRhdGlvbkRlYm91bmNlVGltZXIpOw0KICAgIH0NCiAgICANCiAgICAvLyBPbmx5IHZhbGlkYXRlIFB5dGhvbiBmaWxlcw0KICAgIGlmICghaXNQeXRob25GaWxlKHRleHRFZGl0b3IuZmlsZVBhdGgpIHx8ICF0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkKSB7DQogICAgICAgIGNsZWFyRXJyb3JNYXJrZXJzKCk7DQogICAgICAgIHVwZGF0ZUVycm9yQ291bnQoMCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgDQogICAgLy8gRGVib3VuY2UgdmFsaWRhdGlvbiB0byBhdm9pZCB0b28gZnJlcXVlbnQgY2FsbHMgYW5kIGludGVyZmVyZW5jZSB3aXRoIHR5cGluZw0KICAgIHRleHRFZGl0b3IudmFsaWRhdGlvbkRlYm91bmNlVGltZXIgPSBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsNCiAgICAgICAgY29uc3QgY29kZSA9IHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWU7DQogICAgICAgIA0KICAgICAgICAvLyBEb24ndCB2YWxpZGF0ZSBlbXB0eSBmaWxlcw0KICAgICAgICBpZiAoIWNvZGUudHJpbSgpKSB7DQogICAgICAgICAgICBjbGVhckVycm9yTWFya2VycygpOw0KICAgICAgICAgICAgdXBkYXRlRXJyb3JDb3VudCgwKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHZhbGlkYXRlUHl0aG9uU3ludGF4KGNvZGUpOw0KICAgICAgICAgICAgZGlzcGxheVZhbGlkYXRpb25FcnJvcnMocmVzdWx0LmVycm9ycyB8fCBbXSk7DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgVmFsaWRhdGlvbiBzY2hlZHVsaW5nIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgfQ0KICAgIH0sIDEwMDApOyAvLyAxMDAwbXMgZGVsYXkgLSBtdWNoIGxvbmdlciB0byBhdm9pZCBpbnRlcmZlcmluZyB3aXRoIGZhc3QgdHlwaW5nDQp9DQoNCi8vIERpc3BsYXkgdmFsaWRhdGlvbiBlcnJvcnMgaW4gdGhlIGVkaXRvcg0KZnVuY3Rpb24gZGlzcGxheVZhbGlkYXRpb25FcnJvcnMoZXJyb3JzKSB7DQogICAgLy8gQ2xlYXIgcHJldmlvdXMgZXJyb3JzDQogICAgY2xlYXJFcnJvck1hcmtlcnMoKTsNCiAgICANCiAgICAvLyBTdG9yZSBjdXJyZW50IGVycm9ycw0KICAgIHRleHRFZGl0b3IuY3VycmVudEVycm9ycyA9IGVycm9yczsNCiAgICANCiAgICAvLyBVcGRhdGUgZXJyb3IgY291bnQNCiAgICB1cGRhdGVFcnJvckNvdW50KGVycm9ycy5sZW5ndGgpOw0KICAgIA0KICAgIC8vIEFkZCBlcnJvciBtYXJrZXJzDQogICAgZXJyb3JzLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBhZGRFcnJvck1hcmtlcihlcnJvci5saW5lLCBlcnJvci5tZXNzYWdlLCBlcnJvci50eXBlKTsNCiAgICB9KTsNCiAgICANCn0NCg0KDQovLyBBZGQgZXJyb3IgbWFya2VyIHRvIGEgc3BlY2lmaWMgbGluZQ0KZnVuY3Rpb24gYWRkRXJyb3JNYXJrZXIobGluZU51bWJlciwgbWVzc2FnZSwgdHlwZSA9ICdzeW50YXgnKSB7DQogICAgaWYgKCF0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzIHx8IGxpbmVOdW1iZXIgPCAxKSByZXR1cm47DQogICAgDQogICAgLy8gRmluZCB0aGUgbGluZSBudW1iZXIgZWxlbWVudA0KICAgIGNvbnN0IGxpbmVOdW1iZXJFbGVtZW50cyA9IHRleHRFZGl0b3IubGluZU51bWJlcnMuY2hpbGRyZW47DQogICAgY29uc3QgbGluZUluZGV4ID0gbGluZU51bWJlciAtIDE7IC8vIENvbnZlcnQgdG8gMC1iYXNlZCBpbmRleA0KICAgIA0KICAgIGlmIChsaW5lSW5kZXggPCBsaW5lTnVtYmVyRWxlbWVudHMubGVuZ3RoKSB7DQogICAgICAgIGNvbnN0IGxpbmVFbCA9IGxpbmVOdW1iZXJFbGVtZW50c1tsaW5lSW5kZXhdOw0KICAgICAgICANCiAgICAgICAgLy8gQWRkIGVycm9yIGNsYXNzDQogICAgICAgIGxpbmVFbC5jbGFzc0xpc3QuYWRkKCdsaW5lLWVycm9yJyk7DQogICAgICAgIGxpbmVFbC50aXRsZSA9IGBMaW5lICR7bGluZU51bWJlcn06ICR7bWVzc2FnZX1gOw0KICAgICAgICANCiAgICAgICAgLy8gU3RvcmUgZXJyb3IgaW5mbyBmb3IgY2xlYW51cA0KICAgICAgICB0ZXh0RWRpdG9yLmVycm9yTWFya2Vycy5wdXNoKGxpbmVFbCk7DQogICAgfQ0KICAgIA0KICAgIC8vIEFsc28gdHJ5IHRvIGFkZCB1bmRlcmxpbmUgdG8gdGhlIHRleHQgaWYgdXNpbmcgaGlnaGxpZ2h0ZWQgZWRpdG9yDQogICAgaWYgKHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgYWRkRXJyb3JVbmRlcmxpbmUobGluZU51bWJlciwgbWVzc2FnZSk7DQogICAgfQ0KfQ0KDQovLyBBZGQgZXJyb3IgdW5kZXJsaW5lIHRvIGhpZ2hsaWdodGVkIGVkaXRvciAoYmFzaWMgaW1wbGVtZW50YXRpb24pDQpmdW5jdGlvbiBhZGRFcnJvclVuZGVybGluZShsaW5lTnVtYmVyLCBtZXNzYWdlKSB7DQogICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiAtIHdlIGNvdWxkIG1ha2UgaXQgbW9yZSBzb3BoaXN0aWNhdGVkDQogICAgLy8gRm9yIG5vdywgd2UnbGwgcmVseSBvbiB0aGUgbGluZSBudW1iZXIgaGlnaGxpZ2h0aW5nDQp9DQoNCi8vIENsZWFyIGFsbCBlcnJvciBtYXJrZXJzDQpmdW5jdGlvbiBjbGVhckVycm9yTWFya2VycygpIHsNCiAgICAvLyBDbGVhciBsaW5lIG51bWJlciBlcnJvciBjbGFzc2VzDQogICAgdGV4dEVkaXRvci5lcnJvck1hcmtlcnMuZm9yRWFjaChsaW5lRWwgPT4gew0KICAgICAgICBsaW5lRWwuY2xhc3NMaXN0LnJlbW92ZSgnbGluZS1lcnJvcicpOw0KICAgICAgICBsaW5lRWwucmVtb3ZlQXR0cmlidXRlKCd0aXRsZScpOw0KICAgIH0pOw0KICAgIA0KICAgIHRleHRFZGl0b3IuZXJyb3JNYXJrZXJzID0gW107DQogICAgdGV4dEVkaXRvci5jdXJyZW50RXJyb3JzID0gW107DQp9DQoNCi8vIFVwZGF0ZSBlcnJvciBjb3VudCBpbiBzdGF0dXMgYmFyDQpmdW5jdGlvbiB1cGRhdGVFcnJvckNvdW50KGNvdW50KSB7DQogICAgaWYgKGVycm9yQ291bnRFbCkgew0KICAgICAgICBlcnJvckNvdW50RWwudGV4dENvbnRlbnQgPSBjb3VudC50b1N0cmluZygpOw0KICAgICAgICBlcnJvckNvdW50RWwuc3R5bGUuY29sb3IgPSBjb3VudCA+IDAgPyAnI2ZmNmI2YicgOiAnIzUxY2Y2Nic7DQogICAgfQ0KfQ0KDQovLyBTZXQgdXAgZXZlbnQgaGFuZGxlcnMNCmZ1bmN0aW9uIHNldHVwRXZlbnRIYW5kbGVycygpIHsNCiAgICAvLyBCdXR0b24gZXZlbnRzDQogICAgbmV3RmlsZUJ0bj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjcmVhdGVOZXdGaWxlKTsNCiAgICBsb2FkRmlsZUJ0bj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBsb2FkRmlsZSk7DQogICAgc2F2ZUZpbGVCdG4/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2F2ZUZpbGUpOw0KICAgIHNhdmVBc0ZpbGVCdG4/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2F2ZUFzRmlsZSk7DQogICAgd29yZFdyYXBUb2dnbGU/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlV29yZFdyYXApOw0KICAgIGxpbmVOdW1iZXJzVG9nZ2xlPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZUxpbmVOdW1iZXJzKTsNCiAgICBzeW50YXhIaWdobGlnaHRpbmdUb2dnbGU/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlU3ludGF4SGlnaGxpZ2h0aW5nKTsNCiAgICB2YWxpZGF0aW9uVG9nZ2xlPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVZhbGlkYXRpb24pOw0KICAgIA0KICAgIC8vIFRleHRhcmVhIGV2ZW50cw0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBoYW5kbGVUZXh0Q2hhbmdlKTsNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHN5bmNTY3JvbGwpOw0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUtleURvd24pOw0KICAgIA0KDQogICAgDQogICAgLy8gV2luZG93IGV2ZW50cw0KICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCBoYW5kbGVCZWZvcmVVbmxvYWQpOw0KfQ0KDQoNCg0KLy8gSGFuZGxlIGtleWJvYXJkIHNob3J0Y3V0cw0KZnVuY3Rpb24gaGFuZGxlS2V5RG93bihlKSB7DQogICAgLy8gQ3RybC9DbWQgKyBTOiBTYXZlDQogICAgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJ3MnICYmICFlLnNoaWZ0S2V5KSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgc2F2ZUZpbGUoKTsNCiAgICB9DQogICAgDQogICAgLy8gQ3RybC9DbWQgKyBTaGlmdCArIFM6IFNhdmUgQXMNCiAgICBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS5rZXkgPT09ICdTJykgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHNhdmVBc0ZpbGUoKTsNCiAgICB9DQogICAgDQogICAgLy8gQ3RybC9DbWQgKyBOOiBOZXcgZmlsZQ0KICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkgPT09ICduJykgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGNyZWF0ZU5ld0ZpbGUoKTsNCiAgICB9DQogICAgDQogICAgLy8gQ3RybC9DbWQgKyBPOiBMb2FkIGZpbGUNCiAgICBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5ID09PSAnbycpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBsb2FkRmlsZSgpOw0KICAgIH0NCiAgICANCiAgICAvLyBDdHJsL0NtZCArIFNoaWZ0ICsgVjogRm9yY2UgdmFsaWRhdGlvbg0KICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLmtleSA9PT0gJ1YnKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgaWYgKGlzUHl0aG9uRmlsZSh0ZXh0RWRpdG9yLmZpbGVQYXRoKSkgew0KICAgICAgICAgICAgc2NoZWR1bGVWYWxpZGF0aW9uKCk7DQogICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignVmFsaWRhdGlvbiB0cmlnZ2VyZWQgbWFudWFsbHknLCAnaW5mbycpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ05vdCBhIFB5dGhvbiBmaWxlJywgJ3dhcm5pbmcnKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBUYWIgaGFuZGxpbmcNCiAgICBpZiAoZS5rZXkgPT09ICdUYWInKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgY29uc3Qgc3RhcnQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnNlbGVjdGlvblN0YXJ0Ow0KICAgICAgICBjb25zdCBlbmQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnNlbGVjdGlvbkVuZDsNCiAgICAgICAgY29uc3Qgc3BhY2VzID0gJyAnLnJlcGVhdCh0ZXh0RWRpdG9yLnNldHRpbmdzLnRhYlNpemUpOw0KICAgICAgICANCiAgICAgICAgdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZSA9IA0KICAgICAgICAgICAgdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZS5zdWJzdHJpbmcoMCwgc3RhcnQpICsgDQogICAgICAgICAgICBzcGFjZXMgKyANCiAgICAgICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUuc3Vic3RyaW5nKGVuZCk7DQogICAgICAgIA0KICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnNlbGVjdGlvblN0YXJ0ID0gdGV4dEVkaXRvci50ZXh0YXJlYS5zZWxlY3Rpb25FbmQgPSBzdGFydCArIHNwYWNlcy5sZW5ndGg7DQogICAgICAgIA0KICAgICAgICAvLyBNYW51YWxseSB0cmlnZ2VyIGNvbnRlbnQgdXBkYXRlIHNpbmNlIHdlIHByZXZlbnRlZCB0aGUgZGVmYXVsdA0KICAgICAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgICAgICBtYXJrQXNNb2RpZmllZCgpOw0KICAgICAgICBpZiAodGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkKSB7DQogICAgICAgICAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICAgICAgfQ0KICAgICAgICBzY2hlZHVsZVZhbGlkYXRpb24oKTsNCiAgICB9DQp9DQoNCg0KLy8gVG9nZ2xlIHdvcmQgd3JhcA0KZnVuY3Rpb24gdG9nZ2xlV29yZFdyYXAoKSB7DQogICAgdGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQgPSAhdGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQ7DQogICAgdGV4dEVkaXRvci50ZXh0YXJlYS5jbGFzc0xpc3QudG9nZ2xlKCd3b3JkLXdyYXAnLCB0ZXh0RWRpdG9yLndvcmRXcmFwRW5hYmxlZCk7DQogICAgDQogICAgLy8gVXBkYXRlIGhpZ2hsaWdodGVkIGVkaXRvciBpZiBpdCBleGlzdHMNCiAgICBpZiAodGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yLnN0eWxlLndvcmRXcmFwID0gdGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQgPyAnYnJlYWstd29yZCcgOiAnbm9ybWFsJzsNCiAgICB9DQogICAgDQogICAgaWYgKHdvcmRXcmFwVG9nZ2xlKSB7DQogICAgICAgIHdvcmRXcmFwVG9nZ2xlLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIHRleHRFZGl0b3Iud29yZFdyYXBFbmFibGVkKTsNCiAgICB9DQogICAgDQogICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oDQogICAgICAgIGBXb3JkIHdyYXAgJHt0ZXh0RWRpdG9yLndvcmRXcmFwRW5hYmxlZCA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCd9YCwNCiAgICAgICAgJ2luZm8nDQogICAgKTsNCn0NCg0KLy8gVG9nZ2xlIGxpbmUgbnVtYmVycw0KZnVuY3Rpb24gdG9nZ2xlTGluZU51bWJlcnMoKSB7DQogICAgdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQgPSAhdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQ7DQogICAgdGV4dEVkaXRvci5saW5lTnVtYmVycy5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nLCAhdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQpOw0KICAgIA0KICAgIGlmIChsaW5lTnVtYmVyc1RvZ2dsZSkgew0KICAgICAgICBsaW5lTnVtYmVyc1RvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzRW5hYmxlZCk7DQogICAgfQ0KICAgIA0KICAgIGlmICh0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzRW5hYmxlZCkgew0KICAgICAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgIH0NCiAgICANCiAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbigNCiAgICAgICAgYExpbmUgbnVtYmVycyAke3RleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJ31gLA0KICAgICAgICAnaW5mbycNCiAgICApOw0KfQ0KDQoNCi8vIFRvZ2dsZSBjb2RlIHZhbGlkYXRpb24NCmFzeW5jIGZ1bmN0aW9uIHRvZ2dsZVZhbGlkYXRpb24oKSB7DQogICAgdGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZCA9ICF0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkOw0KICAgIA0KICAgIC8vIFNhdmUgc2V0dGluZw0KICAgIHRyeSB7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5zZXRTZXR0aW5nKCdDT0RFX1ZBTElEQVRJT04nLCB0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkKTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSB2YWxpZGF0aW9uIHNldHRpbmc6JywgZXJyb3IpOw0KICAgIH0NCiAgICANCiAgICAvLyBVcGRhdGUgVUkNCiAgICBpZiAodmFsaWRhdGlvblRvZ2dsZSkgew0KICAgICAgICB2YWxpZGF0aW9uVG9nZ2xlLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIHRleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQpOw0KICAgIH0NCiAgICANCiAgICAvLyBBcHBseSB2YWxpZGF0aW9uIGlmIGVuYWJsZWQsIG90aGVyd2lzZSBjbGVhciBlcnJvcnMNCiAgICBpZiAodGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZCkgew0KICAgICAgICBzY2hlZHVsZVZhbGlkYXRpb24oKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBjbGVhckVycm9yTWFya2VycygpOw0KICAgICAgICB1cGRhdGVFcnJvckNvdW50KDApOw0KICAgIH0NCiAgICANCiAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbigNCiAgICAgICAgYENvZGUgdmFsaWRhdGlvbiAke3RleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWAsDQogICAgICAgICdpbmZvJw0KICAgICk7DQp9DQoNCg0KLy8gSGFuZGxlIGJlZm9yZSB1bmxvYWQNCmZ1bmN0aW9uIGhhbmRsZUJlZm9yZVVubG9hZChlKSB7DQogICAgaWYgKHRleHRFZGl0b3IuaXNNb2RpZmllZCkgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGUucmV0dXJuVmFsdWUgPSAnWW91IGhhdmUgdW5zYXZlZCBjaGFuZ2VzLiBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gbGVhdmU/JzsNCiAgICAgICAgcmV0dXJuIGUucmV0dXJuVmFsdWU7DQogICAgfQ0KfQ0KDQoNCi8vIFRleHQgRWRpdG9yIEFwcA0KDQovLyBHbG9iYWwgdmFyaWFibGVzDQpsZXQgdGV4dEVkaXRvciA9IHsNCiAgICB0ZXh0YXJlYTogbnVsbCwNCiAgICBsaW5lTnVtYmVyczogbnVsbCwNCiAgICBmaWxlUGF0aDogbnVsbCwNCiAgICBvcmlnaW5hbENvbnRlbnQ6ICcnLA0KICAgIGlzTW9kaWZpZWQ6IGZhbHNlLA0KICAgIGF1dG9TYXZlSW50ZXJ2YWw6IG51bGwsDQogICAgd29yZFdyYXBFbmFibGVkOiBmYWxzZSwNCiAgICBsaW5lTnVtYmVyc0VuYWJsZWQ6IHRydWUsDQogICAgc2V0dGluZ3M6IHt9LA0KICAgIC8vIFN5bnRheCBoaWdobGlnaHRpbmcNCiAgICBwcmlzbUxvYWRlZDogZmFsc2UsDQogICAgc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZDogZmFsc2UsDQogICAgaGlnaGxpZ2h0ZWRFZGl0b3I6IG51bGwsDQogICAgaGlnaGxpZ2h0Q29udGFpbmVyOiBudWxsLA0KICAgIG9yaWdpbmFsVGV4dGFyZWFTdHlsZXM6IG51bGwsDQogICAgZGVib3VuY2VUaW1lcjogbnVsbCwNCiAgICAvLyBDdXJzb3IgcG9zaXRpb24gdHJhY2tpbmcNCiAgICBjdXJzb3JQb3NpdGlvbjogMCwNCiAgICAvLyBDb2RlIHZhbGlkYXRpb24NCiAgICBweW9kaWRlTG9hZGVkOiBmYWxzZSwNCiAgICB2YWxpZGF0aW9uRW5hYmxlZDogdHJ1ZSwNCiAgICB2YWxpZGF0aW9uRGVib3VuY2VUaW1lcjogbnVsbCwNCiAgICBjdXJyZW50RXJyb3JzOiBbXSwNCiAgICBlcnJvck1hcmtlcnM6IFtdDQp9Ow0KDQovLyBET00gZWxlbWVudHMNCmxldCBuZXdGaWxlQnRuLCBsb2FkRmlsZUJ0biwgc2F2ZUZpbGVCdG4sIHNhdmVBc0ZpbGVCdG47DQpsZXQgY3VycmVudEZpbGVuYW1lRWwsIHdvcmRXcmFwVG9nZ2xlLCBsaW5lTnVtYmVyc1RvZ2dsZSwgc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlLCB2YWxpZGF0aW9uVG9nZ2xlOw0KbGV0IG1vZGlmaWVkU3RhdHVzRWwsIGVycm9yQ291bnRFbDsNCg0KLy8gSW5pdGlhbGl6ZSB3aGVuIERPTSBpcyByZWFkeQ0KYXN5bmMgZnVuY3Rpb24gaW5pdFRleHRFZGl0b3IoKSB7DQogICAgDQogICAgLy8gQ2hlY2sgaWYgU3lwbmV4QVBJIGlzIGF2YWlsYWJsZQ0KICAgIGlmICh0eXBlb2Ygc3lwbmV4QVBJID09PSAndW5kZWZpbmVkJyB8fCAhc3lwbmV4QVBJKSB7DQogICAgICAgIGNvbnNvbGUud2FybignU3lwbmV4QVBJIG5vdCBhdmFpbGFibGUgLSBydW5uaW5nIGluIHN0YW5kYWxvbmUgbW9kZScpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgDQogICAgLy8gVGVzdCBpZiBhcHAgY29udGFpbmVyIGV4aXN0cw0KICAgIGNvbnN0IGFwcENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcHAtY29udGFpbmVyJyk7DQogICAgaWYgKGFwcENvbnRhaW5lcikgew0KICAgIH0NCiAgICANCiAgICAvLyBHZXQgRE9NIGVsZW1lbnRzDQogICAgdGV4dEVkaXRvci50ZXh0YXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZXh0LWVkaXRvcicpOw0KICAgIHRleHRFZGl0b3IubGluZU51bWJlcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluZS1udW1iZXJzJyk7DQogICAgDQogICAgbmV3RmlsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXctZmlsZScpOw0KICAgIGxvYWRGaWxlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWQtZmlsZScpOw0KICAgIHNhdmVGaWxlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmUtZmlsZScpOw0KICAgIHNhdmVBc0ZpbGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZS1hcy1maWxlJyk7DQogICAgY3VycmVudEZpbGVuYW1lRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VycmVudC1maWxlbmFtZScpOw0KICAgIHdvcmRXcmFwVG9nZ2xlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dvcmQtd3JhcC10b2dnbGUnKTsNCiAgICBsaW5lTnVtYmVyc1RvZ2dsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5lLW51bWJlcnMtdG9nZ2xlJyk7DQogICAgc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N5bnRheC1oaWdobGlnaHRpbmctdG9nZ2xlJyk7DQogICAgdmFsaWRhdGlvblRvZ2dsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2YWxpZGF0aW9uLXRvZ2dsZScpOw0KICAgIA0KICAgIG1vZGlmaWVkU3RhdHVzRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kaWZpZWQtc3RhdHVzJyk7DQogICAgZXJyb3JDb3VudEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yLWNvdW50Jyk7DQogICAgDQogICAgLy8gQ3JpdGljYWwgZWxlbWVudCBjaGVja3MNCiAgICBpZiAoIXRleHRFZGl0b3IudGV4dGFyZWEpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVGV4dCBlZGl0b3IgdGV4dGFyZWEgbm90IGZvdW5kJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgaWYgKCF0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0xpbmUgbnVtYmVycyBlbGVtZW50IG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIA0KICAgIC8vIExvYWQgc2V0dGluZ3MgKFdBSVQgZm9yIHRoZW0gdG8gY29tcGxldGUpDQogICAgYXdhaXQgbG9hZFNldHRpbmdzKCk7DQogICAgDQogICAgLy8gU2V0IHVwIGV2ZW50IGhhbmRsZXJzDQogICAgc2V0dXBFdmVudEhhbmRsZXJzKCk7DQogICAgDQogICAgLy8gSW5pdGlhbGl6ZSBlZGl0b3Igc3RhdGUNCiAgICBpbml0aWFsaXplRWRpdG9yKCk7DQogICAgDQogICAgLy8gU2V0IGluaXRpYWwgYnV0dG9uIHN0YXRlcw0KICAgIGlmIChzeW50YXhIaWdobGlnaHRpbmdUb2dnbGUpIHsNCiAgICAgICAgc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIHRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nKTsNCiAgICB9DQogICAgaWYgKHZhbGlkYXRpb25Ub2dnbGUpIHsNCiAgICAgICAgdmFsaWRhdGlvblRvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkKTsNCiAgICB9DQogICAgDQogICAgLy8gVGV4dCBFZGl0b3IgbG9hZGVkIHN1Y2Nlc3NmdWxseSAobm8gbm90aWZpY2F0aW9uIG5lZWRlZCkNCiAgICANCiAgICAvLyBDaGVjayBmb3IgcGVuZGluZyBpbnRlbnRzIEFGVEVSIGV2ZXJ5dGhpbmcgaXMgZnVsbHkgaW5pdGlhbGl6ZWQNCiAgICBjaGVja0ZvckFwcEludGVudCgpOw0KICAgIA0KfQ0KDQovLyBDaGVjayBmb3IgYXBwIGludGVudHMgKGUuZy4sIGZpbGUgdG8gb3BlbiBmcm9tIFZGUykNCmFzeW5jIGZ1bmN0aW9uIGNoZWNrRm9yQXBwSW50ZW50KCkgew0KICAgIHRyeSB7DQogICAgICAgIGNvbnNvbGUubG9nKCdUZXh0IEVkaXRvcjogQ2hlY2tpbmcgZm9yIGFwcCBpbnRlbnQuLi4nKTsNCiAgICAgICAgDQogICAgICAgIC8vIFJlYWQgaW50ZW50IGZyb20gdXNlciBwcmVmZXJlbmNlcyAod2hlcmUgaXQncyBzdG9yZWQpDQogICAgICAgIGNvbnN0IGludGVudERhdGEgPSBhd2FpdCBzeXBuZXhBUEkuZ2V0UHJlZmVyZW5jZSgndGV4dF9lZGl0b3InLCAnX3BlbmRpbmdfaW50ZW50JywgbnVsbCk7DQogICAgICAgIGNvbnNvbGUubG9nKCdUZXh0IEVkaXRvcjogSW50ZW50IGRhdGEgZnJvbSBwcmVmZXJlbmNlczonLCBpbnRlbnREYXRhKTsNCiAgICAgICAgDQogICAgICAgIGlmIChpbnRlbnREYXRhICYmIGludGVudERhdGEuYWN0aW9uID09PSAnb3Blbl9maWxlJykgew0KICAgICAgICAgICAgY29uc29sZS5sb2coJ1RleHQgRWRpdG9yOiBQcm9jZXNzaW5nIGZpbGUgb3BlbiBpbnRlbnQ6JywgaW50ZW50RGF0YSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IGZpbGVEYXRhID0gaW50ZW50RGF0YS5kYXRhOw0KICAgICAgICAgICAgaWYgKGZpbGVEYXRhICYmIGZpbGVEYXRhLmZpbGVQYXRoKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1RleHQgRWRpdG9yOiBMb2FkaW5nIGZpbGU6JywgZmlsZURhdGEuZmlsZVBhdGgpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIFVzZSBleGlzdGluZyBmaWxlIGxvYWRpbmcgbG9naWMgaW5zdGVhZCBvZiBkdXBsaWNhdGluZyBpdA0KICAgICAgICAgICAgICAgIGF3YWl0IGxvYWRGaWxlQnlQYXRoKGZpbGVEYXRhLmZpbGVQYXRoKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBDbGVhciB0aGUgaW50ZW50IHNpbmNlIHdlIGNvbnN1bWVkIGl0IChzZXQgdG8gbnVsbCkNCiAgICAgICAgICAgICAgICBhd2FpdCBzeXBuZXhBUEkuc2V0UHJlZmVyZW5jZSgndGV4dF9lZGl0b3InLCAnX3BlbmRpbmdfaW50ZW50JywgbnVsbCk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1RleHQgRWRpdG9yOiBTdWNjZXNzZnVsbHkgb3BlbmVkIGZpbGUgZnJvbSBpbnRlbnQnKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdUZXh0IEVkaXRvcjogSW52YWxpZCBmaWxlIGRhdGEgaW4gaW50ZW50OicsIGZpbGVEYXRhKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdUZXh0IEVkaXRvcjogTm8gaW50ZW50IGZvdW5kIG9yIHdyb25nIGFjdGlvbiB0eXBlJyk7DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdUZXh0IEVkaXRvcjogRXJyb3IgY2hlY2tpbmcgZm9yIGFwcCBpbnRlbnQ6JywgZXJyb3IpOw0KICAgIH0NCn0NCg0KDQoNCg0KDQoNCi8vIFJlcGxhY2UgdGhlIG9yaWdpbmFsIGluaXRUZXh0RWRpdG9yIGNhbGwNCmlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnbG9hZGluZycpIHsNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdFRleHRFZGl0b3IpOw0KfSBlbHNlIHsNCiAgICAvLyBET00gaXMgYWxyZWFkeSBsb2FkZWQNCiAgICBpbml0VGV4dEVkaXRvcigpOw0KfSA8L3NjcmlwdD4="
  },
  "package_info": {
    "format_version": "1.0",
    "created_at": "2025-07-24T04:20:51.271568",
    "packaged_by": "Sypnex OS App Packager",
    "source_directory": ".\\text_editor"
  }
}