{
  "app_metadata": {
    "id": "text_editor",
    "name": "Text Editor",
    "description": "A simple text editor for creating and editing text files in the virtual file system",
    "icon": "fas fa-edit",
    "keywords": [
      "text_editor",
      "editor",
      "file",
      "edit",
      "write"
    ],
    "author": "Sypnex OS",
    "version": "1.0.9",
    "type": "user_app",
    "scripts": [
      "js/utils.js",
      "js/settings-manager.js",
      "js/file-manager.js",
      "js/editor-manager.js",
      "js/syntax-highlighting.js",
      "js/code-validation.js",
      "js/ui-manager.js",
      "js/main.js"
    ],
    "settings": [
      {
        "key": "FONT_SIZE",
        "name": "Font Size",
        "type": "number",
        "value": 14,
        "description": "Text editor font size in pixels"
      },
      {
        "key": "TAB_SIZE",
        "name": "Tab Size",
        "type": "number",
        "value": 4,
        "description": "Number of spaces for tab indentation"
      }
    ]
  },
  "files": {
    "text_editor.app": "ew0KICAgICJpZCI6ICJ0ZXh0X2VkaXRvciIsDQogICAgIm5hbWUiOiAiVGV4dCBFZGl0b3IiLA0KICAgICJkZXNjcmlwdGlvbiI6ICJBIHNpbXBsZSB0ZXh0IGVkaXRvciBmb3IgY3JlYXRpbmcgYW5kIGVkaXRpbmcgdGV4dCBmaWxlcyBpbiB0aGUgdmlydHVhbCBmaWxlIHN5c3RlbSIsDQogICAgImljb24iOiAiZmFzIGZhLWVkaXQiLA0KICAgICJrZXl3b3JkcyI6IFsidGV4dF9lZGl0b3IiLCAiZWRpdG9yIiwgImZpbGUiLCAiZWRpdCIsICJ3cml0ZSJdLA0KICAgICJhdXRob3IiOiAiU3lwbmV4IE9TIiwNCiAgICAidmVyc2lvbiI6ICIxLjAuOSIsDQogICAgInR5cGUiOiAidXNlcl9hcHAiLA0KICAgICJzY3JpcHRzIjogWw0KICAgICAgICAianMvdXRpbHMuanMiLA0KICAgICAgICAianMvc2V0dGluZ3MtbWFuYWdlci5qcyIsDQogICAgICAgICJqcy9maWxlLW1hbmFnZXIuanMiLA0KICAgICAgICAianMvZWRpdG9yLW1hbmFnZXIuanMiLA0KICAgICAgICAianMvc3ludGF4LWhpZ2hsaWdodGluZy5qcyIsDQogICAgICAgICJqcy9jb2RlLXZhbGlkYXRpb24uanMiLCANCiAgICAgICAgImpzL3VpLW1hbmFnZXIuanMiLA0KICAgICAgICAianMvbWFpbi5qcyINCiAgICBdLA0KICAgICJzZXR0aW5ncyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICAgImtleSI6ICJGT05UX1NJWkUiLA0KICAgICAgICAgICAgIm5hbWUiOiAiRm9udCBTaXplIiwNCiAgICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgICAidmFsdWUiOiAxNCwNCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJUZXh0IGVkaXRvciBmb250IHNpemUgaW4gcGl4ZWxzIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAia2V5IjogIlRBQl9TSVpFIiwNCiAgICAgICAgICAgICJuYW1lIjogIlRhYiBTaXplIiwNCiAgICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgICAidmFsdWUiOiA0LA0KICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIk51bWJlciBvZiBzcGFjZXMgZm9yIHRhYiBpbmRlbnRhdGlvbiINCiAgICAgICAgfQ0KICAgIF0NCn0g",
    "text_editor.html": "PHN0eWxlIHR5cGU9InRleHQvY3NzIj4vKiA9PT09PSBTdHlsZTogc3R5bGUuY3NzID09PT09ICovDQovKiBUZXh0IEVkaXRvciBBcHAgU3R5bGVzICovDQovKiBBcHAgQ29udGFpbmVyICovDQpbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuYXBwLWNvbnRhaW5lciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGhlaWdodDogMTAwJTsNCiAgICBtaW4taGVpZ2h0OiAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmFwcC1jb250ZW50IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgZmxleDogMTsNCiAgICBtaW4taGVpZ2h0OiAwDQogICAgfQ0KLyogRWRpdG9yIENvbnRhaW5lciAqLw0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmVkaXRvci1jb250YWluZXIgew0KICAgIGZsZXg6IDE7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBtYXJnaW46IDE1cHggMDsNCiAgICBtaW4taGVpZ2h0OiAyMDBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW4NCiAgICB9DQpbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuZWRpdG9yLXdyYXBwZXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleDogMTsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgaGVpZ2h0OiAxMDAlDQogICAgfQ0KLyogTGluZSBOdW1iZXJzICovDQpbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAubGluZS1udW1iZXJzIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBwYWRkaW5nOiAxMHB4IDhweDsNCiAgICBmb250LWZhbWlseTogIlNGIE1vbm8iLCBNb25hY28sICJDYXNjYWRpYSBDb2RlIiwgbW9ub3NwYWNlOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICAvKiBNYXRjaCBlZGl0b3IgZm9udCBzaXplICovDQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtYWxpZ246IHJpZ2h0Ow0KICAgIG1pbi13aWR0aDogNTBweDsNCiAgICB1c2VyLXNlbGVjdDogbm9uZTsNCiAgICBvdmVyZmxvdy15OiBoaWRkZW47DQogICAgbGluZS1oZWlnaHQ6IDEuNjsNCiAgICAvKiBNYXRjaCBlZGl0b3IgbGluZSBoZWlnaHQgKi8NCiAgICBmbGV4LXNocmluazogMA0KICAgIH0NCltkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5saW5lLW51bWJlcnMuaGlkZGVuIHsNCiAgICBkaXNwbGF5OiBub25lDQogICAgfQ0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmxpbmUtbnVtYmVyIHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICBwYWRkaW5nOiAwIDRweA0KICAgIH0NCi8qIFRleHQgRWRpdG9yICovDQpbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAjdGV4dC1lZGl0b3Igew0KICAgIGZsZXg6IDE7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOw0KICAgIGZvbnQtZmFtaWx5OiAiU0YgTW9ubyIsIE1vbmFjbywgIkNhc2NhZGlhIENvZGUiLCBtb25vc3BhY2U7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjY7DQogICAgcGFkZGluZzogMTBweCAxNXB4Ow0KICAgIHJlc2l6ZTogbm9uZTsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgb3ZlcmZsb3cteDogYXV0bzsNCiAgICB3aGl0ZS1zcGFjZTogcHJlOw0KICAgIHRhYi1zaXplOiA0Ow0KICAgIGhlaWdodDogMTAwJTsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94DQogICAgfQ0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gI3RleHQtZWRpdG9yLndvcmQtd3JhcCB7DQogICAgd2hpdGUtc3BhY2U6IHByZS13cmFwOw0KICAgIHdvcmQtd3JhcDogYnJlYWstd29yZA0KICAgIH0NCltkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdICN0ZXh0LWVkaXRvcjo6cGxhY2Vob2xkZXIgew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKQ0KICAgIH0NCi8qIFN5bnRheCBIaWdobGlnaHRpbmcgRWRpdG9yICovDQpbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuaGlnaGxpZ2h0ZWQtZWRpdG9yIHsNCiAgICBmbGV4OiAxOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpOw0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsNCiAgICBmb250LWZhbWlseTogIlNGIE1vbm8iLCBNb25hY28sICJDYXNjYWRpYSBDb2RlIiwgbW9ub3NwYWNlOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBsaW5lLWhlaWdodDogMS42Ow0KICAgIHBhZGRpbmc6IDEwcHggMTVweDsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgb3ZlcmZsb3cteDogYXV0bzsNCiAgICB3aGl0ZS1zcGFjZTogcHJlOw0KICAgIHRhYi1zaXplOiA0Ow0KICAgIGhlaWdodDogMTAwJTsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5oaWdobGlnaHRlZC1lZGl0b3I6Zm9jdXMgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpDQogICAgfQ0KLyogUHJpc20uanMgVGhlbWUgT3ZlcnJpZGVzIGZvciBiZXR0ZXIgaW50ZWdyYXRpb24gKi8NCltkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmNvbW1lbnQsIFtkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnByb2xvZywgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uZG9jdHlwZSwgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uY2RhdGEgew0KICAgIGNvbG9yOiAjNmE3MzdkDQogICAgfQ0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucHVuY3R1YXRpb24gew0KICAgIGNvbG9yOiAjZTFlNGU4DQogICAgfQ0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucHJvcGVydHksIFtkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnRhZywgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uYm9vbGVhbiwgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ubnVtYmVyLCBbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jb25zdGFudCwgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uc3ltYm9sLCBbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5kZWxldGVkIHsNCiAgICBjb2xvcjogIzc5YjhmZg0KICAgIH0NCltkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnNlbGVjdG9yLCBbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5hdHRyLW5hbWUsIFtkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnN0cmluZywgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uY2hhciwgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uYnVpbHRpbiwgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uaW5zZXJ0ZWQgew0KICAgIGNvbG9yOiAjODVlODlkDQogICAgfQ0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ub3BlcmF0b3IsIFtkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmVudGl0eSwgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4udXJsLCBbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuaGlnaGxpZ2h0ZWQtZWRpdG9yIC5sYW5ndWFnZS1jc3MgLnRva2VuLnN0cmluZywgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAuc3R5bGUgLnRva2VuLnN0cmluZyB7DQogICAgY29sb3I6ICNmOTc1ODMNCiAgICB9DQpbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5hdHJ1bGUsIFtkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmF0dHItdmFsdWUsIFtkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmtleXdvcmQgew0KICAgIGNvbG9yOiAjZjk3NTgzDQogICAgfQ0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uZnVuY3Rpb24sIFtkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmNsYXNzLW5hbWUgew0KICAgIGNvbG9yOiAjYjM5MmYwDQogICAgfQ0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucmVnZXgsIFtkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmltcG9ydGFudCwgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4udmFyaWFibGUgew0KICAgIGNvbG9yOiAjZmZhYjcwDQogICAgfQ0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uaW1wb3J0YW50LCBbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5ib2xkIHsNCiAgICBmb250LXdlaWdodDogYm9sZA0KICAgIH0NCltkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLml0YWxpYyB7DQogICAgZm9udC1zdHlsZTogaXRhbGljDQogICAgfQ0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uZW50aXR5IHsNCiAgICBjdXJzb3I6IGhlbHANCiAgICB9DQovKiBFZGl0b3IgU3RhdHVzIEJhciAqLw0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmVkaXRvci1zdGF0dXMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIHBhZGRpbmc6IDhweCAyMHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtc2Vjb25kYXJ5KTsNCiAgICBmbGV4LXNocmluazogMDsNCiAgICBoZWlnaHQ6IDMycHg7DQogICAgbWluLWhlaWdodDogMzJweA0KICAgIH0NCltkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5zdGF0dXMtbGVmdCB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDIwcHg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcg0KICAgIH0NCi8qIE92ZXJyaWRlIHRoZSBtYWluIE9TIC5zdGF0dXMtaXRlbSBzdHlsZXMgdG8gYmUgZmxhdCAqLw0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmVkaXRvci1zdGF0dXMgLnN0YXR1cy1pdGVtIHsNCiAgICBiYWNrZ3JvdW5kOiBub25lICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyOiBub25lICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyLXJhZGl1czogMCAhaW1wb3J0YW50Ow0KICAgIHBhZGRpbmc6IDAgIWltcG9ydGFudDsNCiAgICB0ZXh0LWFsaWduOiBsZWZ0ICFpbXBvcnRhbnQ7DQogICAgZGlzcGxheTogaW5saW5lICFpbXBvcnRhbnQ7DQogICAgY29sb3I6IHZhcigtLXRleHQtc2Vjb25kYXJ5KTsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgbGluZS1oZWlnaHQ6IDEuNDsNCiAgICBmb250LXdlaWdodDogNTAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmVkaXRvci1zdGF0dXMgLnN0YXR1cy1pdGVtIHNwYW4gew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDANCiAgICB9DQovKiBGaWxlIFBhdGggRGlzcGxheSAqLw0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmZpbGUtcGF0aC1kaXNwbGF5IHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgcGFkZGluZzogMTBweCAxNXB4Ow0KICAgIG1pbi13aWR0aDogMjAwcHg7DQogICAgZm9udC1mYW1pbHk6ICJTRiBNb25vIiwgTW9uYWNvLCAiQ2FzY2FkaWEgQ29kZSIsIG1vbm9zcGFjZTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgd29yZC1icmVhazogYnJlYWstYWxsDQogICAgfQ0KLyogUmVzcG9uc2l2ZSBEZXNpZ24gKi8NCkBtZWRpYSAobWF4LXdpZHRoOiA3NjhweCkgew0KICAgIC5hcHAtdG9vbGJhciB7DQogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICAgIGdhcDogMTBweA0KICAgICAgICB9DQogICAgLmFwcC1idG4tZ3JvdXAgew0KICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcg0KICAgICAgICB9DQogICAgLmVkaXRvci1zdGF0dXMgew0KICAgICAgICBmbGV4LXdyYXA6IHdyYXA7DQogICAgICAgIGdhcDogMTVweDsNCiAgICAgICAgcGFkZGluZzogOHB4IDE1cHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTNweA0KICAgICAgICB9DQogICAgLmxpbmUtbnVtYmVycyB7DQogICAgICAgIG1pbi13aWR0aDogNDBweDsNCiAgICAgICAgZm9udC1zaXplOiAxM3B4Ow0KICAgICAgICAvKiBNYXRjaCBlZGl0b3IgZm9udCBzaXplICovDQogICAgICAgIH0NCiAgICAjdGV4dC1lZGl0b3IsIC5oaWdobGlnaHRlZC1lZGl0b3Igew0KICAgICAgICBmb250LXNpemU6IDEzcHgNCiAgICAgICAgfQ0KICAgIH0NCi8qIEZvY3VzIFN0YXRlcyAqLw0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gI3RleHQtZWRpdG9yOmZvY3VzIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWJnKQ0KICAgIH0NCi8qIFNjcm9sbGJhciBTdHlsaW5nIC0gSW1wcm92ZWQgVVggKi8NCltkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdICN0ZXh0LWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXIsIFtkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5saW5lLW51bWJlcnM6Oi13ZWJraXQtc2Nyb2xsYmFyLCBbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuaGlnaGxpZ2h0ZWQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhciB7DQogICAgd2lkdGg6IDE2cHg7DQogICAgLyogSW5jcmVhc2VkIGZyb20gOHB4IGZvciBiZXR0ZXIgdXNhYmlsaXR5ICovDQogICAgaGVpZ2h0OiAxNnB4Ow0KICAgIC8qIEluY3JlYXNlZCBmcm9tIDhweCBmb3IgYmV0dGVyIHVzYWJpbGl0eSAqLw0KICAgIH0NCltkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdICN0ZXh0LWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2ssIFtkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5saW5lLW51bWJlcnM6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrLCBbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuaGlnaGxpZ2h0ZWQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhci10cmFjayB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSkNCiAgICB9DQpbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAjdGV4dC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iLCBbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAubGluZS1udW1iZXJzOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiwgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWdsYXNzLWJnKTsNCiAgICAvKiBBZGRzIHBhZGRpbmcgYXJvdW5kIHRoZSB0aHVtYiBmb3IgZWFzaWVyIGNsaWNraW5nICovDQogICAgbWluLWhlaWdodDogMzBweDsNCiAgICAvKiBFbnN1cmVzIG1pbmltdW0gdGh1bWIgc2l6ZSBmb3IgZWFzaWVyIGdyYWJiaW5nICovDQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZQ0KICAgIH0NCi8qIENvcm5lciB3aGVyZSBob3Jpem9udGFsIGFuZCB2ZXJ0aWNhbCBzY3JvbGxiYXJzIG1lZXQgKi8NCltkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdICN0ZXh0LWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItY29ybmVyLCBbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAubGluZS1udW1iZXJzOjotd2Via2l0LXNjcm9sbGJhci1jb3JuZXIsIFtkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdIC5oaWdobGlnaHRlZC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLWNvcm5lciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpDQogICAgfQ0KLyogRmlyZWZveCBzY3JvbGxiYXIgc3R5bGluZyAqLw0KW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gI3RleHQtZWRpdG9yLCBbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAubGluZS1udW1iZXJzLCBbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuaGlnaGxpZ2h0ZWQtZWRpdG9yIHsNCiAgICBzY3JvbGxiYXItd2lkdGg6IGF1dG87DQogICAgLyogVXNlIHN0YW5kYXJkIHdpZHRoLCBub3QgdGhpbiAqLw0KICAgIHNjcm9sbGJhci1jb2xvcjogdmFyKC0tYm9yZGVyLWNvbG9yKSB2YXIoLS1nbGFzcy1iZykNCiAgICB9DQovKiBGb3IgYmV0dGVyIHNjcm9sbGJhciBpbnRlcmFjdGlvbiBvbiBhbGwgYnJvd3NlcnMgKi8NCltkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciJdICN0ZXh0LWVkaXRvciwgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmxpbmUtbnVtYmVycywgW2RhdGEtYXBwaWQ9InRleHRfZWRpdG9yIl0gLmhpZ2hsaWdodGVkLWVkaXRvciB7DQogICAgLyogRW5zdXJlIHNjcm9sbGJhcnMgYXJlIGFsd2F5cyB2aXNpYmxlIHdoZW4gY29udGVudCBvdmVyZmxvd3MgKi8NCiAgICBvdmVyZmxvdzogYXV0bw0KICAgIH0NCi8qIEFwcCBUb29sYmFyICovDQpbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuYXBwLXRvb2xiYXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgZmxleC1zaHJpbms6IDANCiAgICB9DQpbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuYXBwLWJ0bi1ncm91cCB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDEwcHgNCiAgICB9DQovKiBBbmltYXRpb24gZm9yIHN0YXR1cyBjaGFuZ2VzICovDQpbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuc3RhdHVzLXZhbHVlIHsNCiAgICB0cmFuc2l0aW9uOiBjb2xvciAwLjJzIGVhc2UNCiAgICB9DQovKiBNb2RpZmllZCBzdGF0dXMgaW5kaWNhdG9yICovDQpbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuc3RhdHVzLXZhbHVlLm1vZGlmaWVkIHsNCiAgICBjb2xvcjogI2ZmOTgwMDsNCiAgICBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlDQogICAgfQ0KQGtleWZyYW1lcyBwdWxzZSB7DQogICAgMCUgew0KICAgICAgICBvcGFjaXR5OiAxOw0KICAgICAgICB9IDUwJSB7DQogICAgICAgIG9wYWNpdHk6IDAuNzsNCiAgICAgICAgfSAxMDAlIHsNCiAgICAgICAgb3BhY2l0eTogMTsNCiAgICAgICAgfQ0KICAgIH0NCi8qIEFjdGl2ZSB0b2dnbGUgYnV0dG9uICovDQpbZGF0YS1hcHBpZD0idGV4dF9lZGl0b3IiXSAuYXBwLWJ0bi5hY3RpdmUgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1wcmltYXJ5KTsNCiAgICBjb2xvcjogd2hpdGUNCiAgICB9PC9zdHlsZT48ZGl2IGNsYXNzPSJhcHAtY29udGFpbmVyIiBkYXRhLWFwcGlkPSJ0ZXh0X2VkaXRvciI+DQo8ZGl2IGNsYXNzPSJhcHAtY29udGVudCI+DQo8ZGl2IGNsYXNzPSJhcHAtdG9vbGJhciI+DQo8ZGl2IGNsYXNzPSJhcHAtYnRuLWdyb3VwIj4NCjxidXR0b24gY2xhc3M9ImFwcC1idG4gcHJpbWFyeSIgaWQ9Im5ldy1maWxlIj4NCjxpIGNsYXNzPSJmYXMgZmEtZmlsZSI+PC9pPiBOZXcNCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCjxidXR0b24gY2xhc3M9ImFwcC1idG4gc2Vjb25kYXJ5IiBpZD0ibG9hZC1maWxlIj4NCjxpIGNsYXNzPSJmYXMgZmEtZm9sZGVyLW9wZW4iPjwvaT4gTG9hZA0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPGJ1dHRvbiBjbGFzcz0iYXBwLWJ0biBwcmltYXJ5IiBpZD0ic2F2ZS1maWxlIj4NCjxpIGNsYXNzPSJmYXMgZmEtc2F2ZSI+PC9pPiBTYXZlDQogICAgICAgICAgICAgICAgPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJhcHAtYnRuIHNlY29uZGFyeSIgaWQ9InNhdmUtYXMtZmlsZSI+DQo8aSBjbGFzcz0iZmFzIGZhLXNhdmUiPjwvaT4gU2F2ZSBBcw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJhcHAtYnRuLWdyb3VwIj4NCjxidXR0b24gY2xhc3M9ImFwcC1idG4gc2Vjb25kYXJ5IiBpZD0id29yZC13cmFwLXRvZ2dsZSI+DQo8aSBjbGFzcz0iZmFzIGZhLXRleHQtd2lkdGgiPjwvaT4gV29yZCBXcmFwDQogICAgICAgICAgICAgICAgPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJhcHAtYnRuIHNlY29uZGFyeSIgaWQ9ImxpbmUtbnVtYmVycy10b2dnbGUiPg0KPGkgY2xhc3M9ImZhcyBmYS1saXN0LW9sIj48L2k+IExpbmUgTnVtYmVycw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPGJ1dHRvbiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiIGlkPSJzeW50YXgtaGlnaGxpZ2h0aW5nLXRvZ2dsZSI+DQo8aSBjbGFzcz0iZmFzIGZhLWNvZGUiPjwvaT4gU3ludGF4IEhpZ2hsaWdodGluZw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPC9kaXY+DQo8L2Rpdj4NCjxkaXYgY2xhc3M9ImVkaXRvci1jb250YWluZXIiPg0KPGRpdiBjbGFzcz0iZWRpdG9yLXdyYXBwZXIiPg0KPGRpdiBjbGFzcz0ibGluZS1udW1iZXJzIiBpZD0ibGluZS1udW1iZXJzIj48L2Rpdj4NCjx0ZXh0YXJlYSBjbGFzcz0iYXBwLXRleHRhcmVhIiBpZD0idGV4dC1lZGl0b3IiIHBsYWNlaG9sZGVyPSJTdGFydCB0eXBpbmcgeW91ciB0ZXh0IGhlcmUuLi4iPjwvdGV4dGFyZWE+DQo8L2Rpdj4NCjwvZGl2Pg0KPGRpdiBjbGFzcz0iZWRpdG9yLXN0YXR1cyI+DQo8ZGl2IGNsYXNzPSJzdGF0dXMtbGVmdCI+DQo8c3BhbiBjbGFzcz0ic3RhdHVzLWl0ZW0iPkZpbGU6IDxzcGFuIGlkPSJjdXJyZW50LWZpbGVuYW1lIj51bnRpdGxlZC50eHQ8L3NwYW4+PC9zcGFuPg0KPHNwYW4gY2xhc3M9InN0YXR1cy1pdGVtIj5Nb2RpZmllZDogPHNwYW4gaWQ9Im1vZGlmaWVkLXN0YXR1cyI+Tm88L3NwYW4+PC9zcGFuPg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQoNCjxzY3JpcHQ+Ly8gPT09PT0gU2NyaXB0OiBqcy91dGlscy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvc2V0dGluZ3MtbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvZmlsZS1tYW5hZ2VyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9lZGl0b3ItbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvc3ludGF4LWhpZ2hsaWdodGluZy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvY29kZS12YWxpZGF0aW9uLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy91aS1tYW5hZ2VyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9tYWluLmpzID09PT09DQoNCg0KLy8gQ2hlY2sgaWYgZmlsZSBpcyBzdXBwb3J0ZWQgZm9yIHN5bnRheCBoaWdobGlnaHRpbmcNCmZ1bmN0aW9uIGdldEZpbGVMYW5ndWFnZShmaWxlUGF0aCkgew0KICAgIGlmICghZmlsZVBhdGgpIHJldHVybiBudWxsOw0KICAgIA0KICAgIGNvbnN0IGV4dGVuc2lvbiA9IGZpbGVQYXRoLnRvTG93ZXJDYXNlKCkuc3Vic3RyaW5nKGZpbGVQYXRoLmxhc3RJbmRleE9mKCcuJykpOw0KICAgIA0KICAgIGNvbnN0IGxhbmd1YWdlTWFwID0gew0KICAgICAgICAnLnB5JzogJ3B5dGhvbicsDQogICAgICAgICcucHl3JzogJ3B5dGhvbicsIA0KICAgICAgICAnLnB5eCc6ICdweXRob24nLA0KICAgICAgICAnLnB5aSc6ICdweXRob24nLA0KICAgICAgICAnLnB5ZCc6ICdweXRob24nLA0KICAgICAgICAnLmpzJzogJ2phdmFzY3JpcHQnLA0KICAgICAgICAnLmpzb24nOiAnanNvbicsDQogICAgICAgICcuaHRtbCc6ICdodG1sJywNCiAgICAgICAgJy5odG0nOiAnaHRtbCcsDQogICAgICAgICcuY3NzJzogJ2NzcycNCiAgICB9Ow0KICAgIA0KICAgIHJldHVybiBsYW5ndWFnZU1hcFtleHRlbnNpb25dIHx8IG51bGw7DQp9DQoNCi8vIENoZWNrIGlmIGZpbGUgaXMgUHl0aG9uIChmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSkNCmZ1bmN0aW9uIGlzUHl0aG9uRmlsZShmaWxlUGF0aCkgew0KICAgIHJldHVybiBnZXRGaWxlTGFuZ3VhZ2UoZmlsZVBhdGgpID09PSAncHl0aG9uJzsNCn0NCg0KLy8gU2ltcGxlIGhlbHBlciBmdW5jdGlvbnMgKGtlZXBpbmcgdGhlc2UgZm9yIHBvdGVudGlhbCBmdXR1cmUgdXNlKQ0KZnVuY3Rpb24gZ2V0U2ltcGxlVGV4dENvbnRlbnQoKSB7DQogICAgcmV0dXJuIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWU7DQp9DQoNCi8vIExvYWQgYXBwIHNldHRpbmdzDQphc3luYyBmdW5jdGlvbiBsb2FkU2V0dGluZ3MoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgdGV4dEVkaXRvci5zZXR0aW5ncyA9IHsNCiAgICAgICAgICAgIGZvbnRTaXplOiBhd2FpdCBzeXBuZXhBUEkuZ2V0U2V0dGluZygnRk9OVF9TSVpFJywgMTQpLA0KICAgICAgICAgICAgdGFiU2l6ZTogYXdhaXQgc3lwbmV4QVBJLmdldFNldHRpbmcoJ1RBQl9TSVpFJywgNCksDQogICAgICAgICAgICBzeW50YXhIaWdobGlnaHRpbmc6IGF3YWl0IHN5cG5leEFQSS5nZXRTZXR0aW5nKCdTWU5UQVhfSElHSExJR0hUSU5HJywgdHJ1ZSkNCiAgICAgICAgfTsNCiAgICAgICAgDQogICAgICAgIC8vIEFwcGx5IHNldHRpbmdzDQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEuc3R5bGUuZm9udFNpemUgPSB0ZXh0RWRpdG9yLnNldHRpbmdzLmZvbnRTaXplICsgJ3B4JzsNCiAgICAgICAgdGV4dEVkaXRvci50ZXh0YXJlYS5zdHlsZS50YWJTaXplID0gdGV4dEVkaXRvci5zZXR0aW5ncy50YWJTaXplOw0KICAgICAgICANCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBzZXR0aW5nczonLCBlcnJvcik7DQogICAgICAgIC8vIFVzZSBkZWZhdWx0cw0KICAgICAgICB0ZXh0RWRpdG9yLnNldHRpbmdzID0gew0KICAgICAgICAgICAgZm9udFNpemU6IDE0LA0KICAgICAgICAgICAgdGFiU2l6ZTogNCwNCiAgICAgICAgICAgIHN5bnRheEhpZ2hsaWdodGluZzogdHJ1ZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KDQoNCg0KLy8gQ3JlYXRlIG5ldyBmaWxlDQphc3luYyBmdW5jdGlvbiBjcmVhdGVOZXdGaWxlKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLmlzTW9kaWZpZWQpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGNvbnN0IGNvbmZpcm1lZCA9IGF3YWl0IHN5cG5leEFQSS5zaG93Q29uZmlybWF0aW9uKA0KICAgICAgICAgICAgICAgICdVbnNhdmVkIENoYW5nZXMnLA0KICAgICAgICAgICAgICAgICdZb3UgaGF2ZSB1bnNhdmVkIGNoYW5nZXMgdGhhdCB3aWxsIGJlIGxvc3QuJywNCiAgICAgICAgICAgICAgICAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNyZWF0ZSBhIG5ldyBmaWxlPycsDQogICAgICAgICAgICAgICAgJ0NyZWF0ZSBOZXcgRmlsZScsDQogICAgICAgICAgICAgICAgJ3dhcm5pbmcnDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoY29uZmlybWVkKSB7DQogICAgICAgICAgICAgICAgY2xlYXJFZGl0b3IoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNob3dpbmcgY29uZmlybWF0aW9uOicsIGVycm9yKTsNCiAgICAgICAgICAgIC8vIEZhbGxiYWNrIHRvIG5hdGl2ZSBjb25maXJtIGlmIFN5cG5leEFQSSBmYWlscw0KICAgICAgICAgICAgaWYgKGNvbmZpcm0oJ1lvdSBoYXZlIHVuc2F2ZWQgY2hhbmdlcy4gQ3JlYXRlIG5ldyBmaWxlIGFueXdheT8nKSkgew0KICAgICAgICAgICAgICAgIGNsZWFyRWRpdG9yKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICBjbGVhckVkaXRvcigpOw0KICAgIH0NCn0NCg0KLy8gTG9hZCBmaWxlIGZyb20gVkZTDQphc3luYyBmdW5jdGlvbiBsb2FkRmlsZSgpIHsNCiAgICAvLyBDaGVjayBmb3IgdW5zYXZlZCBjaGFuZ2VzIGZpcnN0DQogICAgaWYgKHRleHRFZGl0b3IuaXNNb2RpZmllZCkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgY29uc3QgY29uZmlybWVkID0gYXdhaXQgc3lwbmV4QVBJLnNob3dDb25maXJtYXRpb24oDQogICAgICAgICAgICAgICAgJ1Vuc2F2ZWQgQ2hhbmdlcycsDQogICAgICAgICAgICAgICAgJ1lvdSBoYXZlIHVuc2F2ZWQgY2hhbmdlcyB0aGF0IHdpbGwgYmUgbG9zdC4nLA0KICAgICAgICAgICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gbG9hZCBhIG5ldyBmaWxlPycsDQogICAgICAgICAgICAgICAgJ0xvYWQgRmlsZScsDQogICAgICAgICAgICAgICAgJ3dhcm5pbmcnDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoIWNvbmZpcm1lZCkgew0KICAgICAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBjYW5jZWxsZWQNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNob3dpbmcgY29uZmlybWF0aW9uOicsIGVycm9yKTsNCiAgICAgICAgICAgIC8vIEZhbGxiYWNrIHRvIG5hdGl2ZSBjb25maXJtIGlmIFN5cG5leEFQSSBmYWlscw0KICAgICAgICAgICAgaWYgKCFjb25maXJtKCdZb3UgaGF2ZSB1bnNhdmVkIGNoYW5nZXMuIExvYWQgbmV3IGZpbGUgYW55d2F5PycpKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0ZpbGVFeHBsb3Jlcih7DQogICAgICAgICAgICBtb2RlOiAnb3BlbicsDQogICAgICAgICAgICB0aXRsZTogJ09wZW4gVGV4dCBGaWxlJywNCiAgICAgICAgICAgIGluaXRpYWxQYXRoOiAnLycsDQogICAgICAgICAgICBvblNlbGVjdDogKHNlbGVjdGVkUGF0aCkgPT4gew0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBjYW5jZWxsZWQNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFVzZSB0aGUgaGVscGVyIGZ1bmN0aW9uIHRvIGxvYWQgdGhlIGZpbGUNCiAgICAgICAgYXdhaXQgbG9hZEZpbGVCeVBhdGgoZmlsZVBhdGgpOw0KDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgZmlsZTonLCBlcnJvcik7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGYWlsZWQgdG8gbG9hZCBmaWxlOiAke2Vycm9yLm1lc3NhZ2V9YCwgJ2Vycm9yJyk7DQogICAgfQ0KfQ0KDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gbG9hZCBhIGZpbGUgYnkgcGF0aCAodXNlZCBieSBib3RoIGludGVyYWN0aXZlIGxvYWQgYW5kIGludGVudCBzeXN0ZW0pDQphc3luYyBmdW5jdGlvbiBsb2FkRmlsZUJ5UGF0aChmaWxlUGF0aCkgew0KICAgIHRyeSB7DQogICAgICAgIC8vIENoZWNrIGlmIGZpbGUgZXhpc3RzIGFuZCBsb2FkIGl0DQogICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlVGV4dChmaWxlUGF0aCk7DQoNCiAgICAgICAgLy8gTG9hZCBjb250ZW50IGludG8gZWRpdG9yDQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUgPSBjb250ZW50Ow0KICAgICAgICB0ZXh0RWRpdG9yLmZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgIHRleHRFZGl0b3Iub3JpZ2luYWxDb250ZW50ID0gY29udGVudDsNCg0KICAgICAgICAvLyBVcGRhdGUgVUkNCiAgICAgICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgIHVwZGF0ZUxpbmVOdW1iZXJzKCk7DQogICAgICAgIHVwZGF0ZVN0YXR1cygpOw0KICAgICAgICBtYXJrQXNTYXZlZCgpOw0KDQogICAgICAgIC8vIEVuYWJsZSBzeW50YXggaGlnaGxpZ2h0aW5nIGZvciBsb2FkZWQgZmlsZQ0KICAgICAgICBhd2FpdCBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCg0KICAgICAgICAvLyBGb3JjZSB1cGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudCBpZiBoaWdobGlnaHRpbmcgaXMgZW5hYmxlZA0KICAgICAgICBpZiAodGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkICYmIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgICAgICB9DQoNCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZpbGUgbG9hZGVkOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQoNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBmaWxlIGJ5IHBhdGg6JywgZXJyb3IpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmFpbGVkIHRvIGxvYWQgZmlsZTogJHtlcnJvci5tZXNzYWdlfWAsICdlcnJvcicpOw0KICAgICAgICB0aHJvdyBlcnJvcjsNCiAgICB9DQp9DQoNCg0KLy8gU2F2ZSBmaWxlIHRvIFZGUw0KYXN5bmMgZnVuY3Rpb24gc2F2ZUZpbGUoKSB7DQogICAgY29uc3QgY29udGVudCA9IHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWU7DQoNCiAgICB0cnkgew0KICAgICAgICBsZXQgZmlsZVBhdGggPSB0ZXh0RWRpdG9yLmZpbGVQYXRoOw0KDQogICAgICAgIC8vIElmIGl0J3MgYSBuZXcgZmlsZSAodW50aXRsZWQpIG9yIHdlIHdhbnQgdG8gc2F2ZSBhcywgc2hvdyBmaWxlIGV4cGxvcmVyDQogICAgICAgIGlmICh0ZXh0RWRpdG9yLmZpbGVQYXRoID09PSAnL3VudGl0bGVkLnR4dCcpIHsNCiAgICAgICAgICAgIGZpbGVQYXRoID0gYXdhaXQgc3lwbmV4QVBJLnNob3dGaWxlRXhwbG9yZXIoew0KICAgICAgICAgICAgICAgIG1vZGU6ICdzYXZlJywNCiAgICAgICAgICAgICAgICB0aXRsZTogJ1NhdmUgVGV4dCBGaWxlJywNCiAgICAgICAgICAgICAgICBpbml0aWFsUGF0aDogJy8nLA0KICAgICAgICAgICAgICAgIGZpbGVOYW1lOiAndW50aXRsZWQudHh0JywNCiAgICAgICAgICAgICAgICBvblNlbGVjdDogKHNlbGVjdGVkUGF0aCkgPT4gew0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgb25DYW5jZWw6ICgpID0+IHsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgaWYgKCFmaWxlUGF0aCkgew0KICAgICAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBjYW5jZWxsZWQNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlKGZpbGVQYXRoLCBjb250ZW50KTsNCg0KICAgICAgICB0ZXh0RWRpdG9yLmZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgICAgICBtYXJrQXNTYXZlZCgpOw0KDQogICAgICAgIC8vIEVuYWJsZSBzeW50YXggaGlnaGxpZ2h0aW5nIGZvciBzYXZlZCBmaWxlDQogICAgICAgIGF3YWl0IGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpOw0KDQogICAgICAgIC8vIEZvcmNlIHVwZGF0ZSBoaWdobGlnaHRlZCBjb250ZW50IGlmIGhpZ2hsaWdodGluZyBpcyBlbmFibGVkDQogICAgICAgIGlmICh0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgJiYgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICAgICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgICAgIH0NCg0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmlsZSBzYXZlZDogJHtmaWxlUGF0aH1gLCAnc3VjY2VzcycpOw0KDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNhdmUgZmlsZTonLCBlcnJvcik7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGYWlsZWQgdG8gc2F2ZSBmaWxlOiAke2Vycm9yLm1lc3NhZ2V9YCwgJ2Vycm9yJyk7DQogICAgfQ0KfQ0KDQovLyBTYXZlIGZpbGUgYXMgKGFsd2F5cyBzaG93IGZpbGUgZXhwbG9yZXIpDQphc3luYyBmdW5jdGlvbiBzYXZlQXNGaWxlKCkgew0KICAgIGNvbnN0IGNvbnRlbnQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlOw0KDQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0ZpbGVFeHBsb3Jlcih7DQogICAgICAgICAgICBtb2RlOiAnc2F2ZScsDQogICAgICAgICAgICB0aXRsZTogJ1NhdmUgVGV4dCBGaWxlIEFzJywNCiAgICAgICAgICAgIGluaXRpYWxQYXRoOiAnLycsDQogICAgICAgICAgICBmaWxlTmFtZTogdGV4dEVkaXRvci5maWxlUGF0aCA9PT0gJy91bnRpdGxlZC50eHQnID8gJ3VudGl0bGVkLnR4dCcgOiB0ZXh0RWRpdG9yLmZpbGVQYXRoLnNwbGl0KCcvJykucG9wKCksDQogICAgICAgICAgICBvblNlbGVjdDogKHNlbGVjdGVkUGF0aCkgPT4gew0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBjYW5jZWxsZWQNCiAgICAgICAgfQ0KDQogICAgICAgIGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlKGZpbGVQYXRoLCBjb250ZW50KTsNCg0KICAgICAgICB0ZXh0RWRpdG9yLmZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgICAgICBtYXJrQXNTYXZlZCgpOw0KDQogICAgICAgIC8vIEVuYWJsZSBzeW50YXggaGlnaGxpZ2h0aW5nIGZvciBzYXZlZCBmaWxlDQogICAgICAgIGF3YWl0IGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpOw0KDQogICAgICAgIC8vIEZvcmNlIHVwZGF0ZSBoaWdobGlnaHRlZCBjb250ZW50IGlmIGhpZ2hsaWdodGluZyBpcyBlbmFibGVkDQogICAgICAgIGlmICh0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgJiYgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICAgICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgICAgIH0NCg0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmlsZSBzYXZlZCBhczogJHtmaWxlUGF0aH1gLCAnc3VjY2VzcycpOw0KDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNhdmUgZmlsZSBhczonLCBlcnJvcik7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGYWlsZWQgdG8gc2F2ZSBmaWxlIGFzOiAke2Vycm9yLm1lc3NhZ2V9YCwgJ2Vycm9yJyk7DQogICAgfQ0KfQ0KDQoNCi8vIFVwZGF0ZSBsaW5lIG51bWJlcnMNCmZ1bmN0aW9uIHVwZGF0ZUxpbmVOdW1iZXJzKCkgew0KICAgIGlmICghdGV4dEVkaXRvci5saW5lTnVtYmVycyB8fCAhdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQpIHJldHVybjsNCiAgICANCiAgICBjb25zdCBsaW5lcyA9IHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUuc3BsaXQoJ1xuJyk7DQogICAgY29uc3QgbGluZUNvdW50ID0gbGluZXMubGVuZ3RoOw0KICAgIA0KICAgIC8vIEdlbmVyYXRlIGxpbmUgbnVtYmVycyBIVE1MDQogICAgbGV0IGxpbmVOdW1iZXJzSFRNTCA9ICcnOw0KICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IGxpbmVDb3VudDsgaSsrKSB7DQogICAgICAgIGxpbmVOdW1iZXJzSFRNTCArPSBgPHNwYW4gY2xhc3M9ImxpbmUtbnVtYmVyIj4ke2l9PC9zcGFuPlxuYDsNCiAgICB9DQogICAgDQogICAgdGV4dEVkaXRvci5saW5lTnVtYmVycy5pbm5lckhUTUwgPSBsaW5lTnVtYmVyc0hUTUw7DQp9DQoNCi8vIFN5bmMgc2Nyb2xsIGJldHdlZW4gdGV4dGFyZWEgYW5kIGxpbmUgbnVtYmVycw0KZnVuY3Rpb24gc3luY1Njcm9sbCgpIHsNCiAgICBpZiAodGV4dEVkaXRvci5saW5lTnVtYmVycyAmJiB0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzRW5hYmxlZCkgew0KICAgICAgICB0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzLnNjcm9sbFRvcCA9IHRleHRFZGl0b3IudGV4dGFyZWEuc2Nyb2xsVG9wOw0KICAgIH0NCiAgICANCiAgICAvLyBBbHNvIHN5bmMgdGhlIGJhY2tkcm9wIGlmIGl0IGV4aXN0cw0KICAgIHN5bmNCYWNrZHJvcFNjcm9sbCgpOw0KfQ0KDQoNCi8vIEhhbmRsZSB0ZXh0IGNoYW5nZXMNCmZ1bmN0aW9uIGhhbmRsZVRleHRDaGFuZ2UoKSB7DQogICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICB1cGRhdGVTdGF0dXMoKTsNCiAgICBtYXJrQXNNb2RpZmllZCgpOw0KfQ0KDQovLyBGb2N1cyBhcHByb3ByaWF0ZSBlZGl0b3INCmZ1bmN0aW9uIGZvY3VzRWRpdG9yKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLnRleHRhcmVhKSB7DQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEuZm9jdXMoKTsNCiAgICB9DQp9DQoNCg0KLy8gVXBkYXRlIGZpbGVuYW1lIGRpc3BsYXkNCmZ1bmN0aW9uIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpIHsNCiAgICBpZiAoY3VycmVudEZpbGVuYW1lRWwpIHsNCiAgICAgICAgY29uc3QgZmlsZW5hbWUgPSB0ZXh0RWRpdG9yLmZpbGVQYXRoID8gdGV4dEVkaXRvci5maWxlUGF0aC5zcGxpdCgnLycpLnBvcCgpIDogJ3VudGl0bGVkLnR4dCc7DQogICAgICAgIGN1cnJlbnRGaWxlbmFtZUVsLnRleHRDb250ZW50ID0gZmlsZW5hbWU7DQogICAgfQ0KfQ0KDQovLyBJbml0aWFsaXplIGVkaXRvciBzdGF0ZQ0KZnVuY3Rpb24gaW5pdGlhbGl6ZUVkaXRvcigpIHsNCiAgICAvLyBTZXQgaW5pdGlhbCBmaWxlIHBhdGgNCiAgICB0ZXh0RWRpdG9yLmZpbGVQYXRoID0gJy91bnRpdGxlZC50eHQnOw0KICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgIA0KICAgIC8vIFVwZGF0ZSBsaW5lIG51bWJlcnMNCiAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgIA0KICAgIC8vIFVwZGF0ZSBzdGF0dXMNCiAgICB1cGRhdGVTdGF0dXMoKTsNCiAgICANCiAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBpZiBuZWVkZWQNCiAgICBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCn0NCg0KDQoNCi8vIFVwZGF0ZSBzdGF0dXMgYmFyDQpmdW5jdGlvbiB1cGRhdGVTdGF0dXMoKSB7DQogICAgLy8gU3RhdHVzIGJhciBub3cgb25seSBzaG93cyBtb2RpZmllZCBzdGF0dXMsIHdoaWNoIGlzIGhhbmRsZWQgYnkgbWFya0FzTW9kaWZpZWQvbWFya0FzU2F2ZWQNCiAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIGtlcHQgZm9yIHBvdGVudGlhbCBmdXR1cmUgdXNlDQp9DQoNCi8vIE1hcmsgZmlsZSBhcyBtb2RpZmllZA0KZnVuY3Rpb24gbWFya0FzTW9kaWZpZWQoKSB7DQogICAgaWYgKCF0ZXh0RWRpdG9yLmlzTW9kaWZpZWQpIHsNCiAgICAgICAgdGV4dEVkaXRvci5pc01vZGlmaWVkID0gdHJ1ZTsNCiAgICAgICAgaWYgKG1vZGlmaWVkU3RhdHVzRWwpIHsNCiAgICAgICAgICAgIG1vZGlmaWVkU3RhdHVzRWwudGV4dENvbnRlbnQgPSAnWWVzJzsNCiAgICAgICAgICAgIG1vZGlmaWVkU3RhdHVzRWwuY2xhc3NMaXN0LmFkZCgnbW9kaWZpZWQnKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gTWFyayBmaWxlIGFzIHNhdmVkDQpmdW5jdGlvbiBtYXJrQXNTYXZlZCgpIHsNCiAgICB0ZXh0RWRpdG9yLmlzTW9kaWZpZWQgPSBmYWxzZTsNCiAgICB0ZXh0RWRpdG9yLm9yaWdpbmFsQ29udGVudCA9IHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWU7DQogICAgaWYgKG1vZGlmaWVkU3RhdHVzRWwpIHsNCiAgICAgICAgbW9kaWZpZWRTdGF0dXNFbC50ZXh0Q29udGVudCA9ICdObyc7DQogICAgICAgIG1vZGlmaWVkU3RhdHVzRWwuY2xhc3NMaXN0LnJlbW92ZSgnbW9kaWZpZWQnKTsNCiAgICB9DQp9DQoNCg0KLy8gQ2xlYXIgZWRpdG9yDQpmdW5jdGlvbiBjbGVhckVkaXRvcigpIHsNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlID0gJyc7DQogICAgdGV4dEVkaXRvci5maWxlUGF0aCA9ICcvdW50aXRsZWQudHh0JzsNCiAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICB0ZXh0RWRpdG9yLm9yaWdpbmFsQ29udGVudCA9ICcnOw0KICAgIG1hcmtBc1NhdmVkKCk7DQogICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICB1cGRhdGVTdGF0dXMoKTsNCiAgICANCiAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBmb3IgbmV3IGZpbGUNCiAgICBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCiAgICANCiAgICAvLyBGb3JjZSB1cGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudCBpZiBoaWdobGlnaHRpbmcgaXMgZW5hYmxlZA0KICAgIGlmICh0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgJiYgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICB9DQogICAgDQogICAgLy8gRm9jdXMgdGhlIHRleHRhcmVhIChub3QgdGhlIGJhY2tkcm9wKQ0KICAgIGZvY3VzRWRpdG9yKCk7DQp9DQoNCg0KLy8gTG9hZCBQcmlzbS5qcyBmb3Igc3ludGF4IGhpZ2hsaWdodGluZw0KYXN5bmMgZnVuY3Rpb24gbG9hZFByaXNtSlMoKSB7DQogICAgaWYgKHRleHRFZGl0b3IucHJpc21Mb2FkZWQpIHJldHVybjsNCiAgICANCiAgICB0cnkgew0KICAgICAgICANCiAgICAgICAgLy8gTG9hZCBQcmlzbS5qcyBsaWJyYXJ5DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL3ByaXNtLm1pbi5qcycsIHsNCiAgICAgICAgICAgIGxvY2FsTmFtZTogJ1ByaXNtJw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIC8vIExvYWQgbGFuZ3VhZ2UgY29tcG9uZW50cw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC9jb21wb25lbnRzL3ByaXNtLXB5dGhvbi5taW4uanMnKTsNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLmxvYWRMaWJyYXJ5KCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wcmlzbS8xLjI5LjAvY29tcG9uZW50cy9wcmlzbS1qYXZhc2NyaXB0Lm1pbi5qcycpOw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC9jb21wb25lbnRzL3ByaXNtLWpzb24ubWluLmpzJyk7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL2NvbXBvbmVudHMvcHJpc20tbWFya3VwLm1pbi5qcycpOw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC9jb21wb25lbnRzL3ByaXNtLWNzcy5taW4uanMnKTsNCiAgICAgICAgDQogICAgICAgIC8vIExvYWQgUHJpc20gQ1NTDQogICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJyk7DQogICAgICAgIGxpbmsucmVsID0gJ3N0eWxlc2hlZXQnOw0KICAgICAgICBsaW5rLmhyZWYgPSAnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL3RoZW1lcy9wcmlzbS10b21vcnJvdy5taW4uY3NzJzsNCiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChsaW5rKTsNCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBjdXN0b20gQ1NTIHRvIGZpeCBzdHlsaW5nIGlzc3Vlcw0KICAgICAgICBjb25zdCBjdXN0b21TdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7DQogICAgICAgIGN1c3RvbVN0eWxlLnRleHRDb250ZW50ID0gYA0KICAgICAgICAgICAgLmhpZ2hsaWdodGVkLWJhY2tkcm9wICogew0KICAgICAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbi1saW5lOiBub25lICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uLXN0eWxlOiBub25lICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uLWNvbG9yOiB0cmFuc3BhcmVudCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgIGJvcmRlci1ib3R0b206IG5vbmUgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICB0ZXh0LXVuZGVybGluZS1vZmZzZXQ6IDAgIWltcG9ydGFudDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC5oaWdobGlnaHRlZC1iYWNrZHJvcCAudG9rZW4uc3RyaW5nIHsNCiAgICAgICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IG5vbmUgIWltcG9ydGFudDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgYDsNCiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChjdXN0b21TdHlsZSk7DQogICAgICAgIA0KICAgICAgICB0ZXh0RWRpdG9yLnByaXNtTG9hZGVkID0gdHJ1ZTsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgUHJpc20uanM6JywgZXJyb3IpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignRmFpbGVkIHRvIGxvYWQgc3ludGF4IGhpZ2hsaWdodGluZycsICdlcnJvcicpOw0KICAgIH0NCn0NCg0KLy8gQ3JlYXRlIGhpZ2hsaWdodGVkIGVkaXRvcg0KZnVuY3Rpb24gY3JlYXRlSGlnaGxpZ2h0ZWRFZGl0b3IoKSB7DQogICAgaWYgKCF0ZXh0RWRpdG9yLnByaXNtTG9hZGVkKSByZXR1cm47DQogICAgDQogICAgLy8gQ2xlYW4gdXAgYW55IGV4aXN0aW5nIGhpZ2hsaWdodGVkIHNldHVwDQogICAgY2xlYW51cEhpZ2hsaWdodGVkRWRpdG9yKCk7DQogICAgDQogICAgY29uc3QgZWRpdG9yV3JhcHBlciA9IHRleHRFZGl0b3IudGV4dGFyZWEucGFyZW50RWxlbWVudDsNCiAgICBjb25zdCB0ZXh0YXJlYSA9IHRleHRFZGl0b3IudGV4dGFyZWE7DQogICAgDQogICAgLy8gU3RvcmUgb3JpZ2luYWwgdGV4dGFyZWEgc3R5bGVzDQogICAgY29uc3Qgb3JpZ2luYWxTdHlsZXMgPSB7DQogICAgICAgIHBvc2l0aW9uOiB0ZXh0YXJlYS5zdHlsZS5wb3NpdGlvbiwNCiAgICAgICAgYmFja2dyb3VuZDogdGV4dGFyZWEuc3R5bGUuYmFja2dyb3VuZCwNCiAgICAgICAgY29sb3I6IHRleHRhcmVhLnN0eWxlLmNvbG9yLA0KICAgICAgICB6SW5kZXg6IHRleHRhcmVhLnN0eWxlLnpJbmRleCwNCiAgICAgICAgY2FyZXRDb2xvcjogdGV4dGFyZWEuc3R5bGUuY2FyZXRDb2xvciwNCiAgICAgICAgc3BlbGxjaGVjazogdGV4dGFyZWEuZ2V0QXR0cmlidXRlKCdzcGVsbGNoZWNrJyksDQogICAgICAgIGF1dG9jb21wbGV0ZTogdGV4dGFyZWEuZ2V0QXR0cmlidXRlKCdhdXRvY29tcGxldGUnKSwNCiAgICAgICAgYXV0b2NvcnJlY3Q6IHRleHRhcmVhLmdldEF0dHJpYnV0ZSgnYXV0b2NvcnJlY3QnKSwNCiAgICAgICAgYXV0b2NhcGl0YWxpemU6IHRleHRhcmVhLmdldEF0dHJpYnV0ZSgnYXV0b2NhcGl0YWxpemUnKQ0KICAgIH07DQogICAgDQogICAgLy8gQ3JlYXRlIGEgY29udGFpbmVyIGZvciB0aGUgb3ZlcmxheSBhcHByb2FjaA0KICAgIGNvbnN0IGhpZ2hsaWdodENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIGhpZ2hsaWdodENvbnRhaW5lci5jbGFzc05hbWUgPSAnaGlnaGxpZ2h0LWNvbnRhaW5lcic7DQogICAgaGlnaGxpZ2h0Q29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJzsNCiAgICBoaWdobGlnaHRDb250YWluZXIuc3R5bGUud2lkdGggPSAnMTAwJSc7DQogICAgaGlnaGxpZ2h0Q29udGFpbmVyLnN0eWxlLmhlaWdodCA9ICcxMDAlJzsNCiAgICANCiAgICAvLyBDcmVhdGUgaGlnaGxpZ2h0ZWQgYmFja2Ryb3ANCiAgICBjb25zdCBoaWdobGlnaHRlZEJhY2tkcm9wID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5pZCA9ICdoaWdobGlnaHRlZC1iYWNrZHJvcCc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5jbGFzc05hbWUgPSAnaGlnaGxpZ2h0ZWQtYmFja2Ryb3AnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUudG9wID0gJzAnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUubGVmdCA9ICcwJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLndpZHRoID0gJzEwMCUnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUuaGVpZ2h0ID0gJzEwMCUnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLmZvbnRGYW1pbHkgPSBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZ2V0Q29tcHV0ZWRTdHlsZSh0ZXh0YXJlYSkuZm9udEZhbWlseTsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLmZvbnRTaXplID0gc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmdldENvbXB1dGVkU3R5bGUodGV4dGFyZWEpLmZvbnRTaXplOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUubGluZUhlaWdodCA9IHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5nZXRDb21wdXRlZFN0eWxlKHRleHRhcmVhKS5saW5lSGVpZ2h0Ow0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUucGFkZGluZyA9IHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5nZXRDb21wdXRlZFN0eWxlKHRleHRhcmVhKS5wYWRkaW5nOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUubWFyZ2luID0gJzAnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUuYm9yZGVyID0gc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmdldENvbXB1dGVkU3R5bGUodGV4dGFyZWEpLmJvcmRlcjsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLndoaXRlU3BhY2UgPSAncHJlLXdyYXAnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUud29yZFdyYXAgPSAnYnJlYWstd29yZCc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUuekluZGV4ID0gJzEnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUucmVzaXplID0gJ25vbmUnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUuY29sb3IgPSAnI2ZmZmZmZic7IC8vIERlZmF1bHQgdGV4dCBjb2xvciBmb3IgaGlnaGxpZ2h0aW5nDQogICAgDQogICAgLy8gTWFrZSBzdXJlIHRleHRhcmVhIGlzIG9uIHRvcCBhbmQgaGFzIHRyYW5zcGFyZW50IGJhY2tncm91bmQgYW5kIHRleHQNCiAgICB0ZXh0YXJlYS5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7DQogICAgdGV4dGFyZWEuc3R5bGUuekluZGV4ID0gJzInOw0KICAgIHRleHRhcmVhLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnOw0KICAgIHRleHRhcmVhLnN0eWxlLmNvbG9yID0gJ3RyYW5zcGFyZW50JzsNCiAgICB0ZXh0YXJlYS5zdHlsZS5jYXJldENvbG9yID0gJyNmZmZmZmYnOw0KICAgIA0KICAgIC8vIERpc2FibGUgYnJvd3NlciBzcGVsbCBjaGVja2luZyBmb3IgY29kZQ0KICAgIHRleHRhcmVhLnNldEF0dHJpYnV0ZSgnc3BlbGxjaGVjaycsICdmYWxzZScpOw0KICAgIHRleHRhcmVhLnNldEF0dHJpYnV0ZSgnYXV0b2NvbXBsZXRlJywgJ29mZicpOw0KICAgIHRleHRhcmVhLnNldEF0dHJpYnV0ZSgnYXV0b2NvcnJlY3QnLCAnb2ZmJyk7DQogICAgdGV4dGFyZWEuc2V0QXR0cmlidXRlKCdhdXRvY2FwaXRhbGl6ZScsICdvZmYnKTsNCiAgICANCiAgICAvLyBXcmFwIHRleHRhcmVhIGluIGNvbnRhaW5lcg0KICAgIGVkaXRvcldyYXBwZXIuaW5zZXJ0QmVmb3JlKGhpZ2hsaWdodENvbnRhaW5lciwgdGV4dGFyZWEpOw0KICAgIGhpZ2hsaWdodENvbnRhaW5lci5hcHBlbmRDaGlsZChoaWdobGlnaHRlZEJhY2tkcm9wKTsNCiAgICBoaWdobGlnaHRDb250YWluZXIuYXBwZW5kQ2hpbGQodGV4dGFyZWEpOw0KICAgIA0KICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IgPSBoaWdobGlnaHRlZEJhY2tkcm9wOw0KICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0Q29udGFpbmVyID0gaGlnaGxpZ2h0Q29udGFpbmVyOw0KICAgIHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcyA9IG9yaWdpbmFsU3R5bGVzOw0KICAgIHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCA9IHRydWU7DQogICAgDQogICAgLy8gU2V0IGluaXRpYWwgY29udGVudA0KICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgIA0KICAgIC8vIFNldCB1cCBzaW1wbGUgZXZlbnQgaGFuZGxlcnMgZm9yIHRoZSB0ZXh0YXJlYSAobm90IHRoZSBiYWNrZHJvcCkNCiAgICB0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGhhbmRsZVNpbXBsZUlucHV0KTsNCiAgICB0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBzeW5jQmFja2Ryb3BTY3JvbGwpOw0KICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVIaWdobGlnaHRLZXlEb3duKTsNCiAgICB0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUhpZ2hsaWdodENsaWNrKTsNCiAgICB0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIGhhbmRsZUhpZ2hsaWdodEZvY3VzKTsNCiAgICANCn0NCg0KDQovLyBVcGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudA0KZnVuY3Rpb24gdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCkgew0KICAgIGlmICghdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvciB8fCAhdGV4dEVkaXRvci5wcmlzbUxvYWRlZCkgcmV0dXJuOw0KICAgIA0KICAgIGNvbnN0IGNvbnRlbnQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlOw0KICAgIGNvbnN0IGxhbmd1YWdlID0gZ2V0RmlsZUxhbmd1YWdlKHRleHRFZGl0b3IuZmlsZVBhdGgpOw0KICAgIA0KICAgIGlmICghbGFuZ3VhZ2UpIHsNCiAgICAgICAgLy8gTm8gbGFuZ3VhZ2UgZGV0ZWN0ZWQsIHVzZSBwbGFpbiB0ZXh0DQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IudGV4dENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIEFwcGx5IHN5bnRheCBoaWdobGlnaHRpbmcgdG8gYmFja2Ryb3ANCiAgICBjb25zdCBoaWdobGlnaHRlZENvbnRlbnQgPSBQcmlzbS5oaWdobGlnaHQoY29udGVudCwgUHJpc20ubGFuZ3VhZ2VzW2xhbmd1YWdlXSwgbGFuZ3VhZ2UpOw0KICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IuaW5uZXJIVE1MID0gaGlnaGxpZ2h0ZWRDb250ZW50Ow0KICAgIA0KICAgIC8vIFN5bmMgc2Nyb2xsIHBvc2l0aW9uDQogICAgc3luY0JhY2tkcm9wU2Nyb2xsKCk7DQogICAgDQp9DQoNCi8vIEVuYWJsZSBzeW50YXggaGlnaGxpZ2h0aW5nIGZvciBzdXBwb3J0ZWQgZmlsZXMNCmFzeW5jIGZ1bmN0aW9uIGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpIHsNCiAgICBpZiAoIXRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nKSB7DQogICAgICAgIGNsZWFudXBIaWdobGlnaHRlZEVkaXRvcigpOw0KICAgICAgICB0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgPSBmYWxzZTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBsYW5ndWFnZSA9IGdldEZpbGVMYW5ndWFnZSh0ZXh0RWRpdG9yLmZpbGVQYXRoKTsNCiAgICANCiAgICBpZiAobGFuZ3VhZ2UpIHsNCiAgICAgICAgaWYgKCF0ZXh0RWRpdG9yLnByaXNtTG9hZGVkKSB7DQogICAgICAgICAgICBhd2FpdCBsb2FkUHJpc21KUygpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBpZiAoIXRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgICAgIGNyZWF0ZUhpZ2hsaWdodGVkRWRpdG9yKCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCA9IHRydWU7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gRGlzYWJsZSBoaWdobGlnaHRpbmcgZm9yIHVuc3VwcG9ydGVkIGZpbGVzDQogICAgICAgIGNsZWFudXBIaWdobGlnaHRlZEVkaXRvcigpOw0KICAgICAgICB0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgPSBmYWxzZTsNCiAgICB9DQp9DQoNCi8vIEhhbmRsZSBzaW1wbGUgaW5wdXQgZm9yIGJhY2tkcm9wIGFwcHJvYWNoDQpmdW5jdGlvbiBoYW5kbGVTaW1wbGVJbnB1dCgpIHsNCiAgICAvLyBVcGRhdGUgbGluZSBudW1iZXJzIGFuZCBzdGF0dXMgaW1tZWRpYXRlbHkNCiAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgIHVwZGF0ZVN0YXR1cygpOw0KICAgIG1hcmtBc01vZGlmaWVkKCk7DQogICAgDQogICAgLy8gSW1tZWRpYXRlIGhpZ2hsaWdodGluZyB1cGRhdGUgZm9yIHJlc3BvbnNpdmUgZmVlbA0KICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KfQ0KDQovLyBIYW5kbGUga2V5IGV2ZW50cyB0aGF0IG1pZ2h0IGNoYW5nZSBjb250ZW50DQpmdW5jdGlvbiBoYW5kbGVIaWdobGlnaHRLZXlEb3duKGUpIHsNCiAgICAvLyBGb3Iga2V5cyB0aGF0IG1vZGlmeSBjb250ZW50LCB1cGRhdGUgaGlnaGxpZ2h0aW5nIGltbWVkaWF0ZWx5IGFmdGVyIHRoZSBldmVudA0KICAgIGlmIChlLmtleSA9PT0gJ1RhYicgfHwgZS5rZXkgPT09ICdFbnRlcicgfHwgZS5rZXkgPT09ICdCYWNrc3BhY2UnIHx8IGUua2V5ID09PSAnRGVsZXRlJykgew0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgICAgICB9LCAwKTsgLy8gVXBkYXRlIG9uIG5leHQgdGljayBhZnRlciB0aGUga2V5IGV2ZW50IGlzIHByb2Nlc3NlZA0KICAgIH0NCn0NCg0KLy8gSGFuZGxlIGNsaWNrIGV2ZW50cyAoY3Vyc29yIHBvc2l0aW9uIGNoYW5nZXMpDQpmdW5jdGlvbiBoYW5kbGVIaWdobGlnaHRDbGljaygpIHsNCiAgICAvLyBTeW5jIHNjcm9sbCBwb3NpdGlvbiB3aGVuIHVzZXIgY2xpY2tzDQogICAgc3luY0JhY2tkcm9wU2Nyb2xsKCk7DQp9DQoNCi8vIEhhbmRsZSBmb2N1cyBldmVudHMNCmZ1bmN0aW9uIGhhbmRsZUhpZ2hsaWdodEZvY3VzKCkgew0KICAgIC8vIEVuc3VyZSBoaWdobGlnaHRpbmcgaXMgaW4gc3luYyB3aGVuIHRleHRhcmVhIGdldHMgZm9jdXMNCiAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICBzeW5jQmFja2Ryb3BTY3JvbGwoKTsNCn0NCg0KLy8gU3luYyBiYWNrZHJvcCBzY3JvbGwgd2l0aCB0ZXh0YXJlYQ0KZnVuY3Rpb24gc3luY0JhY2tkcm9wU2Nyb2xsKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3Iuc2Nyb2xsVG9wID0gdGV4dEVkaXRvci50ZXh0YXJlYS5zY3JvbGxUb3A7DQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3Iuc2Nyb2xsTGVmdCA9IHRleHRFZGl0b3IudGV4dGFyZWEuc2Nyb2xsTGVmdDsNCiAgICB9DQp9DQoNCi8vIENsZWFuIHVwIGhpZ2hsaWdodGVkIGVkaXRvcg0KZnVuY3Rpb24gY2xlYW51cEhpZ2hsaWdodGVkRWRpdG9yKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLmhpZ2hsaWdodENvbnRhaW5lcikgew0KICAgICAgICAvLyBSZXN0b3JlIG9yaWdpbmFsIHRleHRhcmVhIHN0eWxlcw0KICAgICAgICBpZiAodGV4dEVkaXRvci5vcmlnaW5hbFRleHRhcmVhU3R5bGVzKSB7DQogICAgICAgICAgICBjb25zdCB0ZXh0YXJlYSA9IHRleHRFZGl0b3IudGV4dGFyZWE7DQogICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS5wb3NpdGlvbiA9IHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcy5wb3NpdGlvbjsNCiAgICAgICAgICAgIHRleHRhcmVhLnN0eWxlLmJhY2tncm91bmQgPSB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMuYmFja2dyb3VuZDsNCiAgICAgICAgICAgIHRleHRhcmVhLnN0eWxlLmNvbG9yID0gdGV4dEVkaXRvci5vcmlnaW5hbFRleHRhcmVhU3R5bGVzLmNvbG9yOw0KICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuekluZGV4ID0gdGV4dEVkaXRvci5vcmlnaW5hbFRleHRhcmVhU3R5bGVzLnpJbmRleDsNCiAgICAgICAgICAgIHRleHRhcmVhLnN0eWxlLmNhcmV0Q29sb3IgPSB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMuY2FyZXRDb2xvcjsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gUmVtb3ZlIHRoZSBjb250YWluZXIgYW5kIHJlc3RvcmUgdGV4dGFyZWEgdG8gaXRzIG9yaWdpbmFsIHBhcmVudA0KICAgICAgICBjb25zdCBlZGl0b3JXcmFwcGVyID0gdGV4dEVkaXRvci5oaWdobGlnaHRDb250YWluZXIucGFyZW50RWxlbWVudDsNCiAgICAgICAgY29uc3QgdGV4dGFyZWEgPSB0ZXh0RWRpdG9yLnRleHRhcmVhOw0KICAgICAgICANCiAgICAgICAgLy8gTW92ZSB0ZXh0YXJlYSBiYWNrIHRvIGl0cyBvcmlnaW5hbCBsb2NhdGlvbg0KICAgICAgICBlZGl0b3JXcmFwcGVyLmluc2VydEJlZm9yZSh0ZXh0YXJlYSwgdGV4dEVkaXRvci5oaWdobGlnaHRDb250YWluZXIpOw0KICAgICAgICANCiAgICAgICAgLy8gUmVtb3ZlIHRoZSBoaWdobGlnaHQgY29udGFpbmVyDQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0Q29udGFpbmVyLnJlbW92ZSgpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgcmVmZXJlbmNlcw0KICAgICAgICB0ZXh0RWRpdG9yLmhpZ2hsaWdodENvbnRhaW5lciA9IG51bGw7DQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IgPSBudWxsOw0KICAgICAgICB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMgPSBudWxsOw0KICAgIH0NCn0NCg0KLy8gVG9nZ2xlIHN5bnRheCBoaWdobGlnaHRpbmcNCmFzeW5jIGZ1bmN0aW9uIHRvZ2dsZVN5bnRheEhpZ2hsaWdodGluZygpIHsNCiAgICB0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZyA9ICF0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZzsNCiAgICANCiAgICAvLyBTYXZlIHNldHRpbmcNCiAgICB0cnkgew0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkuc2V0U2V0dGluZygnU1lOVEFYX0hJR0hMSUdIVElORycsIHRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nKTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBzeW50YXggaGlnaGxpZ2h0aW5nIHNldHRpbmc6JywgZXJyb3IpOw0KICAgIH0NCiAgICANCiAgICAvLyBVcGRhdGUgVUkNCiAgICBpZiAoc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlKSB7DQogICAgICAgIHN5bnRheEhpZ2hsaWdodGluZ1RvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZyk7DQogICAgfQ0KICAgIA0KICAgIC8vIEFwcGx5IG9yIGRpc2FibGUgaGlnaGxpZ2h0aW5nDQogICAgaWYgKHRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nKSB7DQogICAgICAgIGF3YWl0IGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIERpc2FibGUgaGlnaGxpZ2h0aW5nDQogICAgICAgIGNsZWFudXBIaWdobGlnaHRlZEVkaXRvcigpOw0KICAgICAgICB0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgPSBmYWxzZTsNCiAgICB9DQogICAgDQogICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oDQogICAgICAgIGBTeW50YXggaGlnaGxpZ2h0aW5nICR7dGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmcgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWAsDQogICAgICAgICdpbmZvJw0KICAgICk7DQp9DQoNCg0KLy8gU2V0IHVwIGV2ZW50IGhhbmRsZXJzDQpmdW5jdGlvbiBzZXR1cEV2ZW50SGFuZGxlcnMoKSB7DQogICAgLy8gQnV0dG9uIGV2ZW50cw0KICAgIG5ld0ZpbGVCdG4/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY3JlYXRlTmV3RmlsZSk7DQogICAgbG9hZEZpbGVCdG4/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbG9hZEZpbGUpOw0KICAgIHNhdmVGaWxlQnRuPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhdmVGaWxlKTsNCiAgICBzYXZlQXNGaWxlQnRuPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhdmVBc0ZpbGUpOw0KICAgIHdvcmRXcmFwVG9nZ2xlPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVdvcmRXcmFwKTsNCiAgICBsaW5lTnVtYmVyc1RvZ2dsZT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVMaW5lTnVtYmVycyk7DQogICAgc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVN5bnRheEhpZ2hsaWdodGluZyk7DQogICAgDQogICAgLy8gVGV4dGFyZWEgZXZlbnRzDQogICAgdGV4dEVkaXRvci50ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGhhbmRsZVRleHRDaGFuZ2UpOw0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgc3luY1Njcm9sbCk7DQogICAgdGV4dEVkaXRvci50ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlS2V5RG93bik7DQogICAgDQoNCiAgICANCiAgICAvLyBXaW5kb3cgZXZlbnRzDQogICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIGhhbmRsZUJlZm9yZVVubG9hZCk7DQp9DQoNCg0KDQovLyBIYW5kbGUga2V5Ym9hcmQgc2hvcnRjdXRzDQpmdW5jdGlvbiBoYW5kbGVLZXlEb3duKGUpIHsNCiAgICAvLyBDdHJsL0NtZCArIFM6IFNhdmUNCiAgICBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5ID09PSAncycgJiYgIWUuc2hpZnRLZXkpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBzYXZlRmlsZSgpOw0KICAgIH0NCiAgICANCiAgICAvLyBDdHJsL0NtZCArIFNoaWZ0ICsgUzogU2F2ZSBBcw0KICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLmtleSA9PT0gJ1MnKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgc2F2ZUFzRmlsZSgpOw0KICAgIH0NCiAgICANCiAgICAvLyBDdHJsL0NtZCArIE46IE5ldyBmaWxlDQogICAgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJ24nKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgY3JlYXRlTmV3RmlsZSgpOw0KICAgIH0NCiAgICANCiAgICAvLyBDdHJsL0NtZCArIE86IExvYWQgZmlsZQ0KICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkgPT09ICdvJykgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGxvYWRGaWxlKCk7DQogICAgfQ0KICAgIA0KICAgIC8vIFRhYiBoYW5kbGluZw0KICAgIGlmIChlLmtleSA9PT0gJ1RhYicpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBjb25zdCBzdGFydCA9IHRleHRFZGl0b3IudGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQ7DQogICAgICAgIGNvbnN0IGVuZCA9IHRleHRFZGl0b3IudGV4dGFyZWEuc2VsZWN0aW9uRW5kOw0KICAgICAgICBjb25zdCBzcGFjZXMgPSAnICcucmVwZWF0KHRleHRFZGl0b3Iuc2V0dGluZ3MudGFiU2l6ZSk7DQogICAgICAgIA0KICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlID0gDQogICAgICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlLnN1YnN0cmluZygwLCBzdGFydCkgKyANCiAgICAgICAgICAgIHNwYWNlcyArIA0KICAgICAgICAgICAgdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZS5zdWJzdHJpbmcoZW5kKTsNCiAgICAgICAgDQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnNlbGVjdGlvbkVuZCA9IHN0YXJ0ICsgc3BhY2VzLmxlbmd0aDsNCiAgICAgICAgDQogICAgICAgIC8vIE1hbnVhbGx5IHRyaWdnZXIgY29udGVudCB1cGRhdGUgc2luY2Ugd2UgcHJldmVudGVkIHRoZSBkZWZhdWx0DQogICAgICAgIHVwZGF0ZUxpbmVOdW1iZXJzKCk7DQogICAgICAgIG1hcmtBc01vZGlmaWVkKCk7DQogICAgICAgIGlmICh0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQpIHsNCiAgICAgICAgICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQoNCi8vIFRvZ2dsZSB3b3JkIHdyYXANCmZ1bmN0aW9uIHRvZ2dsZVdvcmRXcmFwKCkgew0KICAgIHRleHRFZGl0b3Iud29yZFdyYXBFbmFibGVkID0gIXRleHRFZGl0b3Iud29yZFdyYXBFbmFibGVkOw0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEuY2xhc3NMaXN0LnRvZ2dsZSgnd29yZC13cmFwJywgdGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQpOw0KICAgIA0KICAgIC8vIFVwZGF0ZSBoaWdobGlnaHRlZCBlZGl0b3IgaWYgaXQgZXhpc3RzDQogICAgaWYgKHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5zdHlsZS53b3JkV3JhcCA9IHRleHRFZGl0b3Iud29yZFdyYXBFbmFibGVkID8gJ2JyZWFrLXdvcmQnIDogJ25vcm1hbCc7DQogICAgfQ0KICAgIA0KICAgIGlmICh3b3JkV3JhcFRvZ2dsZSkgew0KICAgICAgICB3b3JkV3JhcFRvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLndvcmRXcmFwRW5hYmxlZCk7DQogICAgfQ0KICAgIA0KICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKA0KICAgICAgICBgV29yZCB3cmFwICR7dGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWAsDQogICAgICAgICdpbmZvJw0KICAgICk7DQp9DQoNCi8vIFRvZ2dsZSBsaW5lIG51bWJlcnMNCmZ1bmN0aW9uIHRvZ2dsZUxpbmVOdW1iZXJzKCkgew0KICAgIHRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkID0gIXRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkOw0KICAgIHRleHRFZGl0b3IubGluZU51bWJlcnMuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJywgIXRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkKTsNCiAgICANCiAgICBpZiAobGluZU51bWJlcnNUb2dnbGUpIHsNCiAgICAgICAgbGluZU51bWJlcnNUb2dnbGUuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywgdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQpOw0KICAgIH0NCiAgICANCiAgICBpZiAodGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQpIHsNCiAgICAgICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICB9DQogICAgDQogICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oDQogICAgICAgIGBMaW5lIG51bWJlcnMgJHt0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzRW5hYmxlZCA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCd9YCwNCiAgICAgICAgJ2luZm8nDQogICAgKTsNCn0NCg0KDQovLyBIYW5kbGUgYmVmb3JlIHVubG9hZA0KZnVuY3Rpb24gaGFuZGxlQmVmb3JlVW5sb2FkKGUpIHsNCiAgICBpZiAodGV4dEVkaXRvci5pc01vZGlmaWVkKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgZS5yZXR1cm5WYWx1ZSA9ICdZb3UgaGF2ZSB1bnNhdmVkIGNoYW5nZXMuIEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBsZWF2ZT8nOw0KICAgICAgICByZXR1cm4gZS5yZXR1cm5WYWx1ZTsNCiAgICB9DQp9DQoNCg0KLy8gVGV4dCBFZGl0b3IgQXBwDQoNCi8vIEdsb2JhbCB2YXJpYWJsZXMNCmxldCB0ZXh0RWRpdG9yID0gew0KICAgIHRleHRhcmVhOiBudWxsLA0KICAgIGxpbmVOdW1iZXJzOiBudWxsLA0KICAgIGZpbGVQYXRoOiBudWxsLA0KICAgIG9yaWdpbmFsQ29udGVudDogJycsDQogICAgaXNNb2RpZmllZDogZmFsc2UsDQogICAgd29yZFdyYXBFbmFibGVkOiBmYWxzZSwNCiAgICBsaW5lTnVtYmVyc0VuYWJsZWQ6IHRydWUsDQogICAgc2V0dGluZ3M6IHt9LA0KICAgIC8vIFN5bnRheCBoaWdobGlnaHRpbmcNCiAgICBwcmlzbUxvYWRlZDogZmFsc2UsDQogICAgc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZDogZmFsc2UsDQogICAgaGlnaGxpZ2h0ZWRFZGl0b3I6IG51bGwsDQogICAgaGlnaGxpZ2h0Q29udGFpbmVyOiBudWxsLA0KICAgIG9yaWdpbmFsVGV4dGFyZWFTdHlsZXM6IG51bGwsDQogICAgZGVib3VuY2VUaW1lcjogbnVsbCwNCiAgICAvLyBDdXJzb3IgcG9zaXRpb24gdHJhY2tpbmcNCiAgICBjdXJzb3JQb3NpdGlvbjogMA0KfTsNCg0KLy8gRE9NIGVsZW1lbnRzDQpsZXQgbmV3RmlsZUJ0biwgbG9hZEZpbGVCdG4sIHNhdmVGaWxlQnRuLCBzYXZlQXNGaWxlQnRuOw0KbGV0IGN1cnJlbnRGaWxlbmFtZUVsLCB3b3JkV3JhcFRvZ2dsZSwgbGluZU51bWJlcnNUb2dnbGUsIHN5bnRheEhpZ2hsaWdodGluZ1RvZ2dsZTsNCmxldCBtb2RpZmllZFN0YXR1c0VsOw0KDQovLyBJbml0aWFsaXplIHdoZW4gRE9NIGlzIHJlYWR5DQphc3luYyBmdW5jdGlvbiBpbml0VGV4dEVkaXRvcigpIHsNCiAgICANCiAgICAvLyBDaGVjayBpZiBTeXBuZXhBUEkgaXMgYXZhaWxhYmxlDQogICAgaWYgKHR5cGVvZiBzeXBuZXhBUEkgPT09ICd1bmRlZmluZWQnIHx8ICFzeXBuZXhBUEkpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCdTeXBuZXhBUEkgbm90IGF2YWlsYWJsZSAtIHJ1bm5pbmcgaW4gc3RhbmRhbG9uZSBtb2RlJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICANCiAgICAvLyBUZXN0IGlmIGFwcCBjb250YWluZXIgZXhpc3RzDQogICAgY29uc3QgYXBwQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFwcC1jb250YWluZXInKTsNCiAgICBpZiAoYXBwQ29udGFpbmVyKSB7DQogICAgfQ0KICAgIA0KICAgIC8vIEdldCBET00gZWxlbWVudHMNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RleHQtZWRpdG9yJyk7DQogICAgdGV4dEVkaXRvci5saW5lTnVtYmVycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5lLW51bWJlcnMnKTsNCiAgICANCiAgICBuZXdGaWxlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25ldy1maWxlJyk7DQogICAgbG9hZEZpbGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZC1maWxlJyk7DQogICAgc2F2ZUZpbGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZS1maWxlJyk7DQogICAgc2F2ZUFzRmlsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlLWFzLWZpbGUnKTsNCiAgICBjdXJyZW50RmlsZW5hbWVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXJyZW50LWZpbGVuYW1lJyk7DQogICAgd29yZFdyYXBUb2dnbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd29yZC13cmFwLXRvZ2dsZScpOw0KICAgIGxpbmVOdW1iZXJzVG9nZ2xlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmUtbnVtYmVycy10b2dnbGUnKTsNCiAgICBzeW50YXhIaWdobGlnaHRpbmdUb2dnbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3ludGF4LWhpZ2hsaWdodGluZy10b2dnbGUnKTsNCiAgICANCiAgICBtb2RpZmllZFN0YXR1c0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGlmaWVkLXN0YXR1cycpOw0KICAgIA0KICAgIC8vIENyaXRpY2FsIGVsZW1lbnQgY2hlY2tzDQogICAgaWYgKCF0ZXh0RWRpdG9yLnRleHRhcmVhKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RleHQgZWRpdG9yIHRleHRhcmVhIG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGlmICghdGV4dEVkaXRvci5saW5lTnVtYmVycykgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdMaW5lIG51bWJlcnMgZWxlbWVudCBub3QgZm91bmQnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICANCiAgICAvLyBMb2FkIHNldHRpbmdzIChXQUlUIGZvciB0aGVtIHRvIGNvbXBsZXRlKQ0KICAgIGF3YWl0IGxvYWRTZXR0aW5ncygpOw0KICAgIA0KICAgIC8vIFNldCB1cCBldmVudCBoYW5kbGVycw0KICAgIHNldHVwRXZlbnRIYW5kbGVycygpOw0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgZWRpdG9yIHN0YXRlDQogICAgaW5pdGlhbGl6ZUVkaXRvcigpOw0KICAgIA0KICAgIC8vIFNldCBpbml0aWFsIGJ1dHRvbiBzdGF0ZXMNCiAgICBpZiAoc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlKSB7DQogICAgICAgIHN5bnRheEhpZ2hsaWdodGluZ1RvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZyk7DQogICAgfQ0KICAgIA0KICAgIC8vIFRleHQgRWRpdG9yIGxvYWRlZCBzdWNjZXNzZnVsbHkgKG5vIG5vdGlmaWNhdGlvbiBuZWVkZWQpDQogICAgDQogICAgLy8gQ2hlY2sgZm9yIHBlbmRpbmcgaW50ZW50cyBBRlRFUiBldmVyeXRoaW5nIGlzIGZ1bGx5IGluaXRpYWxpemVkDQogICAgY2hlY2tGb3JBcHBJbnRlbnQoKTsNCiAgICANCn0NCg0KLy8gQ2hlY2sgZm9yIGFwcCBpbnRlbnRzIChlLmcuLCBmaWxlIHRvIG9wZW4gZnJvbSBWRlMpDQphc3luYyBmdW5jdGlvbiBjaGVja0ZvckFwcEludGVudCgpIHsNCiAgICB0cnkgew0KICAgICAgICANCiAgICAgICAgLy8gUmVhZCBpbnRlbnQgZnJvbSB1c2VyIHByZWZlcmVuY2VzICh3aGVyZSBpdCdzIHN0b3JlZCkNCiAgICAgICAgY29uc3QgaW50ZW50RGF0YSA9IGF3YWl0IHN5cG5leEFQSS5nZXRQcmVmZXJlbmNlKCd0ZXh0X2VkaXRvcicsICdfcGVuZGluZ19pbnRlbnQnLCBudWxsKTsNCiAgICAgICAgDQogICAgICAgIGlmIChpbnRlbnREYXRhICYmIGludGVudERhdGEuYWN0aW9uID09PSAnb3Blbl9maWxlJykgew0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDbGVhciB0aGUgaW50ZW50IGltbWVkaWF0ZWx5IGFmdGVyIHJlYWRpbmcgaXQsIHJlZ2FyZGxlc3Mgb2Ygc3VjY2Vzcy9mYWlsdXJlDQogICAgICAgICAgICBhd2FpdCBzeXBuZXhBUEkuc2V0UHJlZmVyZW5jZSgndGV4dF9lZGl0b3InLCAnX3BlbmRpbmdfaW50ZW50JywgbnVsbCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IGZpbGVEYXRhID0gaW50ZW50RGF0YS5kYXRhOw0KICAgICAgICAgICAgaWYgKGZpbGVEYXRhICYmIGZpbGVEYXRhLmZpbGVQYXRoKSB7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gVXNlIGV4aXN0aW5nIGZpbGUgbG9hZGluZyBsb2dpYyBpbnN0ZWFkIG9mIGR1cGxpY2F0aW5nIGl0DQogICAgICAgICAgICAgICAgYXdhaXQgbG9hZEZpbGVCeVBhdGgoZmlsZURhdGEuZmlsZVBhdGgpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1RleHQgRWRpdG9yOiBJbnZhbGlkIGZpbGUgZGF0YSBpbiBpbnRlbnQ6JywgZmlsZURhdGEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVGV4dCBFZGl0b3I6IEVycm9yIGNoZWNraW5nIGZvciBhcHAgaW50ZW50OicsIGVycm9yKTsNCiAgICB9DQp9DQoNCg0KDQoNCg0KDQovLyBSZXBsYWNlIHRoZSBvcmlnaW5hbCBpbml0VGV4dEVkaXRvciBjYWxsDQppZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXRUZXh0RWRpdG9yKTsNCn0gZWxzZSB7DQogICAgLy8gRE9NIGlzIGFscmVhZHkgbG9hZGVkDQogICAgaW5pdFRleHRFZGl0b3IoKTsNCn0gPC9zY3JpcHQ+"
  },
  "package_info": {
    "format_version": "1.0",
    "created_at": "2025-08-15T09:26:26.354907",
    "packaged_by": "Sypnex OS App Packager",
    "source_directory": ".\\text_editor"
  }
}