{
  "app_metadata": {
    "id": "text_editor",
    "name": "Text Editor",
    "description": "A simple text editor for creating and editing text files in the virtual file system",
    "icon": "fas fa-edit",
    "keywords": [
      "text",
      "editor",
      "file",
      "edit",
      "write"
    ],
    "author": "Sypnex OS",
    "version": "1.0.4",
    "type": "user_app",
    "scripts": [
      "js/utils.js",
      "js/settings-manager.js",
      "js/file-manager.js",
      "js/editor-manager.js",
      "js/syntax-highlighting.js",
      "js/code-validation.js",
      "js/terminal-manager.js",
      "js/ui-manager.js",
      "js/main.js"
    ],
    "settings": [
      {
        "key": "AUTO_SAVE_INTERVAL",
        "name": "Auto Save Interval (s)",
        "type": "number",
        "value": 30,
        "description": "Auto save content every N seconds (0 = disabled)"
      },
      {
        "key": "FONT_SIZE",
        "name": "Font Size",
        "type": "number",
        "value": 14,
        "description": "Text editor font size in pixels"
      },
      {
        "key": "TAB_SIZE",
        "name": "Tab Size",
        "type": "number",
        "value": 4,
        "description": "Number of spaces for tab indentation"
      },
      {
        "key": "TERMINAL_ENABLED",
        "name": "Integrated Terminal",
        "type": "boolean",
        "value": false,
        "description": "Show integrated terminal by default"
      }
    ]
  },
  "files": {
    "text_editor.app": "ew0KICAgICJpZCI6ICJ0ZXh0X2VkaXRvciIsDQogICAgIm5hbWUiOiAiVGV4dCBFZGl0b3IiLA0KICAgICJkZXNjcmlwdGlvbiI6ICJBIHNpbXBsZSB0ZXh0IGVkaXRvciBmb3IgY3JlYXRpbmcgYW5kIGVkaXRpbmcgdGV4dCBmaWxlcyBpbiB0aGUgdmlydHVhbCBmaWxlIHN5c3RlbSIsDQogICAgImljb24iOiAiZmFzIGZhLWVkaXQiLA0KICAgICJrZXl3b3JkcyI6IFsidGV4dCIsICJlZGl0b3IiLCAiZmlsZSIsICJlZGl0IiwgIndyaXRlIl0sDQogICAgImF1dGhvciI6ICJTeXBuZXggT1MiLA0KICAgICJ2ZXJzaW9uIjogIjEuMC40IiwNCiAgICAidHlwZSI6ICJ1c2VyX2FwcCIsDQogICAgInNjcmlwdHMiOiBbDQogICAgICAgICJqcy91dGlscy5qcyIsDQogICAgICAgICJqcy9zZXR0aW5ncy1tYW5hZ2VyLmpzIiwNCiAgICAgICAgImpzL2ZpbGUtbWFuYWdlci5qcyIsDQogICAgICAgICJqcy9lZGl0b3ItbWFuYWdlci5qcyIsDQogICAgICAgICJqcy9zeW50YXgtaGlnaGxpZ2h0aW5nLmpzIiwNCiAgICAgICAgImpzL2NvZGUtdmFsaWRhdGlvbi5qcyIsIA0KICAgICAgICAianMvdGVybWluYWwtbWFuYWdlci5qcyIsDQogICAgICAgICJqcy91aS1tYW5hZ2VyLmpzIiwNCiAgICAgICAgImpzL21haW4uanMiDQogICAgXSwNCiAgICAic2V0dGluZ3MiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAgICJrZXkiOiAiQVVUT19TQVZFX0lOVEVSVkFMIiwNCiAgICAgICAgICAgICJuYW1lIjogIkF1dG8gU2F2ZSBJbnRlcnZhbCAocykiLA0KICAgICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAgICJ2YWx1ZSI6IDMwLA0KICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIkF1dG8gc2F2ZSBjb250ZW50IGV2ZXJ5IE4gc2Vjb25kcyAoMCA9IGRpc2FibGVkKSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgImtleSI6ICJGT05UX1NJWkUiLA0KICAgICAgICAgICAgIm5hbWUiOiAiRm9udCBTaXplIiwNCiAgICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgICAidmFsdWUiOiAxNCwNCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJUZXh0IGVkaXRvciBmb250IHNpemUgaW4gcGl4ZWxzIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAia2V5IjogIlRBQl9TSVpFIiwNCiAgICAgICAgICAgICJuYW1lIjogIlRhYiBTaXplIiwNCiAgICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgICAidmFsdWUiOiA0LA0KICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIk51bWJlciBvZiBzcGFjZXMgZm9yIHRhYiBpbmRlbnRhdGlvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgImtleSI6ICJURVJNSU5BTF9FTkFCTEVEIiwNCiAgICAgICAgICAgICJuYW1lIjogIkludGVncmF0ZWQgVGVybWluYWwiLA0KICAgICAgICAgICAgInR5cGUiOiAiYm9vbGVhbiIsDQogICAgICAgICAgICAidmFsdWUiOiBmYWxzZSwNCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJTaG93IGludGVncmF0ZWQgdGVybWluYWwgYnkgZGVmYXVsdCINCiAgICAgICAgfQ0KICAgIF0NCn0g",
    "text_editor.html": "PGRpdiBjbGFzcz0iYXBwLWNvbnRhaW5lciI+DQogICAgPGRpdiBjbGFzcz0iYXBwLWhlYWRlciI+DQogICAgICAgIDxoMj48aSBjbGFzcz0iZmFzIGZhLWVkaXQiPjwvaT4gVGV4dCBFZGl0b3IgLSA8c3BhbiBpZD0iY3VycmVudC1maWxlbmFtZSI+dW50aXRsZWQudHh0PC9zcGFuPjwvaDI+DQogICAgICAgIDxwPkNyZWF0ZSBhbmQgZWRpdCB0ZXh0IGZpbGVzIGluIHRoZSB2aXJ0dWFsIGZpbGUgc3lzdGVtPC9wPg0KICAgIDwvZGl2Pg0KDQogICAgPGRpdiBjbGFzcz0iYXBwLWNvbnRlbnQiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtdG9vbGJhciI+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtYnRuLWdyb3VwIj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJuZXctZmlsZSIgY2xhc3M9ImFwcC1idG4gcHJpbWFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZmlsZSI+PC9pPiBOZXcNCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJsb2FkLWZpbGUiIGNsYXNzPSJhcHAtYnRuIHNlY29uZGFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZm9sZGVyLW9wZW4iPjwvaT4gTG9hZA0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InNhdmUtZmlsZSIgY2xhc3M9ImFwcC1idG4gcHJpbWFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2F2ZSI+PC9pPiBTYXZlDQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ic2F2ZS1hcy1maWxlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXNhdmUiPjwvaT4gU2F2ZSBBcw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICANCg0KICAgICAgICAgICAgDQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtYnRuLWdyb3VwIj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ3b3JkLXdyYXAtdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRleHQtd2lkdGgiPjwvaT4gV29yZCBXcmFwDQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ibGluZS1udW1iZXJzLXRvZ2dsZSIgY2xhc3M9ImFwcC1idG4gc2Vjb25kYXJ5Ij4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1saXN0LW9sIj48L2k+IExpbmUgTnVtYmVycw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InN5bnRheC1oaWdobGlnaHRpbmctdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWNvZGUiPjwvaT4gU3ludGF4IEhpZ2hsaWdodGluZw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InZhbGlkYXRpb24tdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWNoZWNrLWNpcmNsZSI+PC9pPiBDb2RlIFZhbGlkYXRpb24NCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ0ZXJtaW5hbC10b2dnbGUiIGNsYXNzPSJhcHAtYnRuIHNlY29uZGFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtdGVybWluYWwiPjwvaT4gVGVybWluYWwNCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCg0KICAgICAgICA8ZGl2IGNsYXNzPSJlZGl0b3ItY29udGFpbmVyIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImVkaXRvci13cmFwcGVyIj4NCiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJsaW5lLW51bWJlcnMiIGNsYXNzPSJsaW5lLW51bWJlcnMiPjwvZGl2Pg0KICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBpZD0idGV4dC1lZGl0b3IiIGNsYXNzPSJhcHAtdGV4dGFyZWEiIHBsYWNlaG9sZGVyPSJTdGFydCB0eXBpbmcgeW91ciB0ZXh0IGhlcmUuLi4iPjwvdGV4dGFyZWE+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgPCEtLSBJbnRlZ3JhdGVkIFRlcm1pbmFsIC0tPg0KICAgICAgICA8ZGl2IGlkPSJpbnRlZ3JhdGVkLXRlcm1pbmFsIiBjbGFzcz0iaW50ZWdyYXRlZC10ZXJtaW5hbCBoaWRkZW4iPg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0idGVybWluYWwtaGVhZGVyIj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idGVybWluYWwtdGl0bGUiPkludGVncmF0ZWQgVGVybWluYWw8L3NwYW4+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0idGVybWluYWwtcmVzaXplIiBjbGFzcz0idGVybWluYWwtcmVzaXplLWJ0biI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZ3JpcC1saW5lcyI+PC9pPg0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0ZXJtaW5hbC1vdXRwdXQiIGlkPSJ0ZXJtaW5hbE91dHB1dCI+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGVybWluYWwtbGluZSB0ZXJtaW5hbC1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgSW50ZWdyYXRlZCBUZXJtaW5hbCAtIFR5cGUgY29tbWFuZHMgdG8gZXhlY3V0ZQ0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRlcm1pbmFsLWxpbmUiPjwvZGl2Pg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0ZXJtaW5hbC1pbnB1dC1jb250YWluZXIiPg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRlcm1pbmFsLWlucHV0LWxpbmUiPg0KICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idGVybWluYWwtcHJvbXB0Ij4kPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9InRlcm1pbmFsLWlucHV0IiBpZD0idGVybWluYWxJbnB1dCIgcGxhY2Vob2xkZXI9IkVudGVyIGNvbW1hbmQuLi4iIGF1dG9jb21wbGV0ZT0ib2ZmIj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCg0KICAgICAgICA8ZGl2IGNsYXNzPSJlZGl0b3Itc3RhdHVzIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXR1cy1pdGVtIj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3RhdHVzLWxhYmVsIj5Nb2RpZmllZDo8L3NwYW4+DQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InN0YXR1cy12YWx1ZSIgaWQ9Im1vZGlmaWVkLXN0YXR1cyI+Tm88L3NwYW4+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXR1cy1pdGVtIj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3RhdHVzLWxhYmVsIj5FcnJvcnM6PC9zcGFuPg0KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzdGF0dXMtdmFsdWUiIGlkPSJlcnJvci1jb3VudCI+MDwvc3Bhbj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICA8L2Rpdj4NCjwvZGl2PiANCjxzdHlsZT4vKiA9PT09PSBTdHlsZTogc3R5bGUuY3NzID09PT09ICovDQovKiBUZXh0IEVkaXRvciBBcHAgU3R5bGVzICovDQoNCi8qIEFwcCBDb250YWluZXIgKi8NCi5hcHAtY29udGFpbmVyIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIG1pbi1oZWlnaHQ6IDA7DQp9DQoNCi5hcHAtY29udGVudCB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGZsZXg6IDE7DQogICAgbWluLWhlaWdodDogMDsNCn0NCg0KLyogRWRpdG9yIENvbnRhaW5lciAqLw0KLmVkaXRvci1jb250YWluZXIgew0KICAgIGZsZXg6IDE7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBtYXJnaW46IDE1cHggMDsNCiAgICBtaW4taGVpZ2h0OiAyMDBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQp9DQoNCi5lZGl0b3Itd3JhcHBlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4OiAxOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICBoZWlnaHQ6IDEwMCU7DQp9DQoNCi8qIExpbmUgTnVtYmVycyAqLw0KLmxpbmUtbnVtYmVycyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlci1yaWdodDogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgcGFkZGluZzogMTBweCA4cHg7DQogICAgZm9udC1mYW1pbHk6ICdTRiBNb25vJywgTW9uYWNvLCAnQ2FzY2FkaWEgQ29kZScsIG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDE0cHg7IC8qIE1hdGNoIGVkaXRvciBmb250IHNpemUgKi8NCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgdGV4dC1hbGlnbjogcmlnaHQ7DQogICAgbWluLXdpZHRoOiA1MHB4Ow0KICAgIHVzZXItc2VsZWN0OiBub25lOw0KICAgIG92ZXJmbG93LXk6IGhpZGRlbjsNCiAgICBsaW5lLWhlaWdodDogMS42OyAvKiBNYXRjaCBlZGl0b3IgbGluZSBoZWlnaHQgKi8NCiAgICBmbGV4LXNocmluazogMDsNCn0NCg0KLmxpbmUtbnVtYmVycy5oaWRkZW4gew0KICAgIGRpc3BsYXk6IG5vbmU7DQp9DQoNCi5saW5lLW51bWJlciB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgcGFkZGluZzogMCA0cHg7DQp9DQoNCi8qIFRleHQgRWRpdG9yICovDQojdGV4dC1lZGl0b3Igew0KICAgIGZsZXg6IDE7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOw0KICAgIGZvbnQtZmFtaWx5OiAnU0YgTW9ubycsIE1vbmFjbywgJ0Nhc2NhZGlhIENvZGUnLCBtb25vc3BhY2U7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjY7DQogICAgcGFkZGluZzogMTBweCAxNXB4Ow0KICAgIHJlc2l6ZTogbm9uZTsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgb3ZlcmZsb3cteDogYXV0bzsNCiAgICB3aGl0ZS1zcGFjZTogcHJlOw0KICAgIHRhYi1zaXplOiA0Ow0KICAgIGhlaWdodDogMTAwJTsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KfQ0KDQojdGV4dC1lZGl0b3Iud29yZC13cmFwIHsNCiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7DQogICAgd29yZC13cmFwOiBicmVhay13b3JkOw0KfQ0KDQojdGV4dC1lZGl0b3I6OnBsYWNlaG9sZGVyIHsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQp9DQoNCi8qIFN5bnRheCBIaWdobGlnaHRpbmcgRWRpdG9yICovDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIHsNCiAgICBmbGV4OiAxOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpOw0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsNCiAgICBmb250LWZhbWlseTogJ1NGIE1vbm8nLCBNb25hY28sICdDYXNjYWRpYSBDb2RlJywgbW9ub3NwYWNlOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBsaW5lLWhlaWdodDogMS42Ow0KICAgIHBhZGRpbmc6IDEwcHggMTVweDsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgb3ZlcmZsb3cteDogYXV0bzsNCiAgICB3aGl0ZS1zcGFjZTogcHJlOw0KICAgIHRhYi1zaXplOiA0Ow0KICAgIGhlaWdodDogMTAwJTsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvcjpmb2N1cyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQp9DQoNCi8qIFByaXNtLmpzIFRoZW1lIE92ZXJyaWRlcyBmb3IgYmV0dGVyIGludGVncmF0aW9uICovDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jb21tZW50LA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucHJvbG9nLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uZG9jdHlwZSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmNkYXRhIHsNCiAgICBjb2xvcjogIzZhNzM3ZDsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucHVuY3R1YXRpb24gew0KICAgIGNvbG9yOiAjZTFlNGU4Ow0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5wcm9wZXJ0eSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnRhZywNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmJvb2xlYW4sDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5udW1iZXIsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jb25zdGFudCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnN5bWJvbCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmRlbGV0ZWQgew0KICAgIGNvbG9yOiAjNzliOGZmOw0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5zZWxlY3RvciwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmF0dHItbmFtZSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnN0cmluZywNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmNoYXIsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5idWlsdGluLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uaW5zZXJ0ZWQgew0KICAgIGNvbG9yOiAjODVlODlkOw0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5vcGVyYXRvciwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmVudGl0eSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnVybCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLmxhbmd1YWdlLWNzcyAudG9rZW4uc3RyaW5nLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAuc3R5bGUgLnRva2VuLnN0cmluZyB7DQogICAgY29sb3I6ICNmOTc1ODM7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmF0cnVsZSwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmF0dHItdmFsdWUsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5rZXl3b3JkIHsNCiAgICBjb2xvcjogI2Y5NzU4MzsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uZnVuY3Rpb24sDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jbGFzcy1uYW1lIHsNCiAgICBjb2xvcjogI2IzOTJmMDsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucmVnZXgsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5pbXBvcnRhbnQsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi52YXJpYWJsZSB7DQogICAgY29sb3I6ICNmZmFiNzA7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmltcG9ydGFudCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmJvbGQgew0KICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5pdGFsaWMgew0KICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uZW50aXR5IHsNCiAgICBjdXJzb3I6IGhlbHA7DQp9DQoNCi8qIEVkaXRvciBTdGF0dXMgQmFyICovDQouZWRpdG9yLXN0YXR1cyB7DQogICAgZGlzcGxheTogZmxleDsgLyogQ2hhbmdlZCBmcm9tIG5vbmUgdG8gZmxleCB0byBzaG93IHN0YXR1cyBiYXIgKi8NCiAgICBnYXA6IDIwcHg7DQogICAgcGFkZGluZzogMTBweCAxNXB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtc2Vjb25kYXJ5KTsNCiAgICBmbGV4LXNocmluazogMDsNCn0NCg0KLnN0YXR1cy1pdGVtIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGdhcDogNXB4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQp9DQoNCi5zdGF0dXMtbGFiZWwgew0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQp9DQoNCi5zdGF0dXMtdmFsdWUgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQp9DQoNCi8qIEZpbGUgUGF0aCBEaXNwbGF5ICovDQouZmlsZS1wYXRoLWRpc3BsYXkgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBwYWRkaW5nOiAxMHB4IDE1cHg7DQogICAgbWluLXdpZHRoOiAyMDBweDsNCiAgICBmb250LWZhbWlseTogJ1NGIE1vbm8nLCBNb25hY28sICdDYXNjYWRpYSBDb2RlJywgbW9ub3NwYWNlOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7DQp9DQoNCi8qIEludGVncmF0ZWQgVGVybWluYWwgU3R5bGVzICovDQouaW50ZWdyYXRlZC10ZXJtaW5hbCB7DQogICAgYmFja2dyb3VuZDogIzFlMWUxZTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweCA2cHggMCAwOyAvKiBSb3VuZGVkIHRvcCBjb3JuZXJzIG9ubHkgKi8NCiAgICBtYXJnaW46IDEwcHggMCAwIDA7IC8qIE5vIGJvdHRvbSBtYXJnaW4gdG8gc2l0IGZsdXNoICovDQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIG1pbi1oZWlnaHQ6IDIwMHB4Ow0KICAgIG1heC1oZWlnaHQ6IDQwMHB4Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQp9DQoNCi5pbnRlZ3JhdGVkLXRlcm1pbmFsLmhpZGRlbiB7DQogICAgZGlzcGxheTogbm9uZTsNCn0NCg0KLnRlcm1pbmFsLWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBiYWNrZ3JvdW5kOiAjMmQyZDJkOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjNDQ0Ow0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBjb2xvcjogI2ZmZmZmZjsNCn0NCg0KLnRlcm1pbmFsLXRpdGxlIHsNCiAgICBmb250LXdlaWdodDogNTAwOw0KfQ0KDQoudGVybWluYWwtcmVzaXplLWJ0biB7DQogICAgYmFja2dyb3VuZDogbm9uZTsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgY29sb3I6ICM4ODg7DQogICAgY3Vyc29yOiBucy1yZXNpemU7DQogICAgcGFkZGluZzogNHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCn0NCg0KLnRlcm1pbmFsLXJlc2l6ZS1idG46aG92ZXIgew0KICAgIGJhY2tncm91bmQ6ICM0NDQ7DQogICAgY29sb3I6ICNmZmZmZmY7DQp9DQoNCi50ZXJtaW5hbC1vdXRwdXQgew0KICAgIGZsZXg6IDE7DQogICAgYmFja2dyb3VuZC1jb2xvcjogIzFlMWUxZTsNCiAgICBjb2xvcjogI2ZmZmZmZjsNCiAgICBmb250LWZhbWlseTogJ0NvdXJpZXIgTmV3JywgbW9ub3NwYWNlOw0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgbWluLWhlaWdodDogMTAwcHg7DQogICAgbWF4LWhlaWdodDogMjAwcHg7DQp9DQoNCi50ZXJtaW5hbC1saW5lIHsNCiAgICBtYXJnaW46IDFweCAwOw0KICAgIGxpbmUtaGVpZ2h0OiAxLjM7DQogICAgdXNlci1zZWxlY3Q6IHRleHQ7DQogICAgLXdlYmtpdC11c2VyLXNlbGVjdDogdGV4dDsNCiAgICAtbW96LXVzZXItc2VsZWN0OiB0ZXh0Ow0KICAgIC1tcy11c2VyLXNlbGVjdDogdGV4dDsNCiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7DQogICAgd29yZC13cmFwOiBicmVhay13b3JkOw0KfQ0KDQoudGVybWluYWwtZXJyb3Igew0KICAgIGNvbG9yOiAjZmY2YjZiOw0KfQ0KDQoudGVybWluYWwtc3VjY2VzcyB7DQogICAgY29sb3I6ICM1MWNmNjY7DQp9DQoNCi50ZXJtaW5hbC1pbmZvIHsNCiAgICBjb2xvcjogIzc0YzBmYzsNCn0NCg0KLnRlcm1pbmFsLWlucHV0LWNvbnRhaW5lciB7DQogICAgYmFja2dyb3VuZDogIzFlMWUxZTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgIzQ0NDsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCn0NCg0KLnRlcm1pbmFsLWlucHV0LWxpbmUgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgY29sb3I6ICNmZmZmZmY7DQogICAgZm9udC1mYW1pbHk6ICdDb3VyaWVyIE5ldycsIG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgb3V0bGluZTogbm9uZTsNCiAgICB3aWR0aDogMTAwJTsNCn0NCg0KLnRlcm1pbmFsLXByb21wdCB7DQogICAgY29sb3I6ICMwMGZmMDA7DQogICAgbWFyZ2luLXJpZ2h0OiA4cHg7DQogICAgdXNlci1zZWxlY3Q6IG5vbmU7DQp9DQoNCi50ZXJtaW5hbC1pbnB1dCB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGNvbG9yOiAjZmZmZmZmOw0KICAgIGZvbnQtZmFtaWx5OiAnQ291cmllciBOZXcnLCBtb25vc3BhY2U7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIG91dGxpbmU6IG5vbmU7DQogICAgZmxleDogMTsNCn0NCg0KLnRlcm1pbmFsLWlucHV0OjpwbGFjZWhvbGRlciB7DQogICAgY29sb3I6ICM2NjY7DQp9DQoNCi8qIFRlcm1pbmFsIHNlbGVjdGlvbiBzdHlsaW5nICovDQoudGVybWluYWwtb3V0cHV0OjpzZWxlY3Rpb24gew0KICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDY2Y2M7DQogICAgY29sb3I6ICNmZmZmZmY7DQp9DQoNCi50ZXJtaW5hbC1vdXRwdXQ6Oi1tb3otc2VsZWN0aW9uIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDA2NmNjOw0KICAgIGNvbG9yOiAjZmZmZmZmOw0KfQ0KDQoudGVybWluYWwtbGluZTo6c2VsZWN0aW9uIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDA2NmNjOw0KICAgIGNvbG9yOiAjZmZmZmZmOw0KfQ0KDQoudGVybWluYWwtbGluZTo6LW1vei1zZWxlY3Rpb24gew0KICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDY2Y2M7DQogICAgY29sb3I6ICNmZmZmZmY7DQp9DQoNCi8qIFJlc3BvbnNpdmUgRGVzaWduICovDQpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsNCiAgICAuYXBwLXRvb2xiYXIgew0KICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgICAgICBnYXA6IDEwcHg7DQogICAgfQ0KICAgIA0KICAgIC5hcHAtYnRuLWdyb3VwIHsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgfQ0KICAgIA0KICAgIC5lZGl0b3Itc3RhdHVzIHsNCiAgICAgICAgZmxleC13cmFwOiB3cmFwOw0KICAgICAgICBnYXA6IDEwcHg7DQogICAgfQ0KICAgIA0KICAgIC5saW5lLW51bWJlcnMgew0KICAgICAgICBtaW4td2lkdGg6IDQwcHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTNweDsgLyogTWF0Y2ggZWRpdG9yIGZvbnQgc2l6ZSAqLw0KICAgIH0NCiAgICANCiAgICAjdGV4dC1lZGl0b3IsDQogICAgLmhpZ2hsaWdodGVkLWVkaXRvciB7DQogICAgICAgIGZvbnQtc2l6ZTogMTNweDsNCiAgICB9DQogICAgDQogICAgLmludGVncmF0ZWQtdGVybWluYWwgew0KICAgICAgICBtaW4taGVpZ2h0OiAxNTBweDsNCiAgICAgICAgbWF4LWhlaWdodDogMzAwcHg7DQogICAgfQ0KICAgIA0KICAgIC50ZXJtaW5hbC1vdXRwdXQgew0KICAgICAgICBmb250LXNpemU6IDExcHg7DQogICAgICAgIG1pbi1oZWlnaHQ6IDgwcHg7DQogICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4Ow0KICAgIH0NCiAgICANCiAgICAudGVybWluYWwtaW5wdXQgew0KICAgICAgICBmb250LXNpemU6IDExcHg7DQogICAgfQ0KfQ0KDQovKiBGb2N1cyBTdGF0ZXMgKi8NCiN0ZXh0LWVkaXRvcjpmb2N1cyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQp9DQoNCi8qIFNjcm9sbGJhciBTdHlsaW5nICovDQojdGV4dC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLA0KLmxpbmUtbnVtYmVyczo6LXdlYmtpdC1zY3JvbGxiYXIsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhciB7DQogICAgd2lkdGg6IDhweDsNCiAgICBoZWlnaHQ6IDhweDsNCn0NCg0KI3RleHQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhci10cmFjaywNCi5saW5lLW51bWJlcnM6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrLA0KLmhpZ2hsaWdodGVkLWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2sgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCn0NCg0KI3RleHQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiwNCi5saW5lLW51bWJlcnM6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iLA0KLmhpZ2hsaWdodGVkLWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KfQ0KDQojdGV4dC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyLA0KLmxpbmUtbnVtYmVyczo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXIsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhci10aHVtYjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWNvbG9yKTsNCn0NCg0KLyogQXBwIFRvb2xiYXIgKi8NCi5hcHAtdG9vbGJhciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAxNXB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBmbGV4LXNocmluazogMDsNCn0NCg0KLmFwcC1idG4tZ3JvdXAgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZ2FwOiAxMHB4Ow0KfQ0KDQovKiBBbmltYXRpb24gZm9yIHN0YXR1cyBjaGFuZ2VzICovDQouc3RhdHVzLXZhbHVlIHsNCiAgICB0cmFuc2l0aW9uOiBjb2xvciAwLjJzIGVhc2U7DQp9DQoNCi8qIE1vZGlmaWVkIHN0YXR1cyBpbmRpY2F0b3IgKi8NCi5zdGF0dXMtdmFsdWUubW9kaWZpZWQgew0KICAgIGNvbG9yOiAjZmY5ODAwOw0KICAgIGFuaW1hdGlvbjogcHVsc2UgMnMgaW5maW5pdGU7DQp9DQoNCkBrZXlmcmFtZXMgcHVsc2Ugew0KICAgIDAlIHsgb3BhY2l0eTogMTsgfQ0KICAgIDUwJSB7IG9wYWNpdHk6IDAuNzsgfQ0KICAgIDEwMCUgeyBvcGFjaXR5OiAxOyB9DQp9DQoNCi8qIENvZGUgVmFsaWRhdGlvbiBFcnJvciBTdHlsZXMgKi8NCi5saW5lLWVycm9yIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMTA3LCAxMDcsIDAuMikgIWltcG9ydGFudDsNCiAgICBjb2xvcjogI2ZmNmI2YiAhaW1wb3J0YW50Ow0KICAgIGJvcmRlci1sZWZ0OiAzcHggc29saWQgI2ZmNmI2YiAhaW1wb3J0YW50Ow0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCn0NCg0KLmxpbmUtZXJyb3I6OmJlZm9yZSB7DQogICAgY29udGVudDogIuKaoCI7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIGxlZnQ6IDJweDsNCiAgICB0b3A6IDUwJTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7DQogICAgY29sb3I6ICNmZjZiNmI7DQogICAgZm9udC1zaXplOiAxMHB4Ow0KICAgIHotaW5kZXg6IDE7DQp9DQoNCi8qIEVycm9yIGNvdW50IGluIHN0YXR1cyBiYXIgKi8NCi5zdGF0dXMtdmFsdWUgew0KICAgIHRyYW5zaXRpb246IGNvbG9yIDAuM3MgZWFzZTsNCn0NCg0KLyogQWN0aXZlIHZhbGlkYXRpb24gdG9nZ2xlIGJ1dHRvbiAqLw0KLmFwcC1idG4uYWN0aXZlIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtcHJpbWFyeSk7DQogICAgY29sb3I6IHdoaXRlOw0KfSA8L3N0eWxlPg0KPHNjcmlwdD4vLyA9PT09PSBTY3JpcHQ6IGpzL3V0aWxzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9zZXR0aW5ncy1tYW5hZ2VyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9maWxlLW1hbmFnZXIuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2VkaXRvci1tYW5hZ2VyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9zeW50YXgtaGlnaGxpZ2h0aW5nLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9jb2RlLXZhbGlkYXRpb24uanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL3Rlcm1pbmFsLW1hbmFnZXIuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL3VpLW1hbmFnZXIuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL21haW4uanMgPT09PT0NCg0KDQovLyBDaGVjayBpZiBmaWxlIGlzIHN1cHBvcnRlZCBmb3Igc3ludGF4IGhpZ2hsaWdodGluZw0KZnVuY3Rpb24gZ2V0RmlsZUxhbmd1YWdlKGZpbGVQYXRoKSB7DQogICAgaWYgKCFmaWxlUGF0aCkgcmV0dXJuIG51bGw7DQogICAgDQogICAgY29uc3QgZXh0ZW5zaW9uID0gZmlsZVBhdGgudG9Mb3dlckNhc2UoKS5zdWJzdHJpbmcoZmlsZVBhdGgubGFzdEluZGV4T2YoJy4nKSk7DQogICAgDQogICAgY29uc3QgbGFuZ3VhZ2VNYXAgPSB7DQogICAgICAgICcucHknOiAncHl0aG9uJywNCiAgICAgICAgJy5weXcnOiAncHl0aG9uJywgDQogICAgICAgICcucHl4JzogJ3B5dGhvbicsDQogICAgICAgICcucHlpJzogJ3B5dGhvbicsDQogICAgICAgICcucHlkJzogJ3B5dGhvbicsDQogICAgICAgICcuanMnOiAnamF2YXNjcmlwdCcsDQogICAgICAgICcuanNvbic6ICdqc29uJywNCiAgICAgICAgJy5odG1sJzogJ2h0bWwnLA0KICAgICAgICAnLmh0bSc6ICdodG1sJywNCiAgICAgICAgJy5jc3MnOiAnY3NzJw0KICAgIH07DQogICAgDQogICAgcmV0dXJuIGxhbmd1YWdlTWFwW2V4dGVuc2lvbl0gfHwgbnVsbDsNCn0NCg0KLy8gQ2hlY2sgaWYgZmlsZSBpcyBQeXRob24gKGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5KQ0KZnVuY3Rpb24gaXNQeXRob25GaWxlKGZpbGVQYXRoKSB7DQogICAgcmV0dXJuIGdldEZpbGVMYW5ndWFnZShmaWxlUGF0aCkgPT09ICdweXRob24nOw0KfQ0KDQovLyBTaW1wbGUgaGVscGVyIGZ1bmN0aW9ucyAoa2VlcGluZyB0aGVzZSBmb3IgcG90ZW50aWFsIGZ1dHVyZSB1c2UpDQpmdW5jdGlvbiBnZXRTaW1wbGVUZXh0Q29udGVudCgpIHsNCiAgICByZXR1cm4gdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZTsNCn0NCg0KLy8gTG9hZCBhcHAgc2V0dGluZ3MNCmFzeW5jIGZ1bmN0aW9uIGxvYWRTZXR0aW5ncygpIHsNCiAgICB0cnkgew0KICAgICAgICB0ZXh0RWRpdG9yLnNldHRpbmdzID0gew0KICAgICAgICAgICAgYXV0b1NhdmVJbnRlcnZhbDogYXdhaXQgc3lwbmV4QVBJLmdldFNldHRpbmcoJ0FVVE9fU0FWRV9JTlRFUlZBTCcsIDMwKSwNCiAgICAgICAgICAgIGZvbnRTaXplOiBhd2FpdCBzeXBuZXhBUEkuZ2V0U2V0dGluZygnRk9OVF9TSVpFJywgMTQpLA0KICAgICAgICAgICAgdGFiU2l6ZTogYXdhaXQgc3lwbmV4QVBJLmdldFNldHRpbmcoJ1RBQl9TSVpFJywgNCksDQogICAgICAgICAgICBzeW50YXhIaWdobGlnaHRpbmc6IGF3YWl0IHN5cG5leEFQSS5nZXRTZXR0aW5nKCdTWU5UQVhfSElHSExJR0hUSU5HJywgdHJ1ZSksDQogICAgICAgICAgICBjb2RlVmFsaWRhdGlvbjogYXdhaXQgc3lwbmV4QVBJLmdldFNldHRpbmcoJ0NPREVfVkFMSURBVElPTicsIHRydWUpDQogICAgICAgIH07DQogICAgICAgIA0KICAgICAgICAvLyBBcHBseSBzZXR0aW5ncw0KICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnN0eWxlLmZvbnRTaXplID0gdGV4dEVkaXRvci5zZXR0aW5ncy5mb250U2l6ZSArICdweCc7DQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEuc3R5bGUudGFiU2l6ZSA9IHRleHRFZGl0b3Iuc2V0dGluZ3MudGFiU2l6ZTsNCiAgICAgICAgdGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZCA9IHRleHRFZGl0b3Iuc2V0dGluZ3MuY29kZVZhbGlkYXRpb247DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIHNldHRpbmdzOicsIGVycm9yKTsNCiAgICAgICAgLy8gVXNlIGRlZmF1bHRzDQogICAgICAgIHRleHRFZGl0b3Iuc2V0dGluZ3MgPSB7DQogICAgICAgICAgICBhdXRvU2F2ZUludGVydmFsOiAzMCwNCiAgICAgICAgICAgIGZvbnRTaXplOiAxNCwNCiAgICAgICAgICAgIHRhYlNpemU6IDQsDQogICAgICAgICAgICBzeW50YXhIaWdobGlnaHRpbmc6IHRydWUsDQogICAgICAgICAgICBjb2RlVmFsaWRhdGlvbjogdHJ1ZQ0KICAgICAgICB9Ow0KICAgICAgICB0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkID0gdHJ1ZTsNCiAgICB9DQp9DQoNCg0KDQovLyBMb2FkIHRlcm1pbmFsIHN0YXRlDQphc3luYyBmdW5jdGlvbiBsb2FkVGVybWluYWxTdGF0ZSgpIHsNCiAgICB0cnkgew0KICAgICAgICBjb25zdCB0ZXJtaW5hbEVuYWJsZWQgPSBhd2FpdCBzeXBuZXhBUEkuZ2V0U2V0dGluZygnVEVSTUlOQUxfRU5BQkxFRCcsIGZhbHNlKTsNCiAgICAgICAgaWYgKHRlcm1pbmFsRW5hYmxlZCAmJiBpbnRlZ3JhdGVkVGVybWluYWwpIHsNCiAgICAgICAgICAgIGludGVncmF0ZWRUZXJtaW5hbC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsNCiAgICAgICAgICAgIGlmICh0ZXJtaW5hbFRvZ2dsZSkgew0KICAgICAgICAgICAgICAgIHRlcm1pbmFsVG9nZ2xlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgdGVybWluYWwgc3RhdGU6JywgZXJyb3IpOw0KICAgIH0NCn0NCg0KDQovLyBDcmVhdGUgbmV3IGZpbGUNCmZ1bmN0aW9uIGNyZWF0ZU5ld0ZpbGUoKSB7DQogICAgaWYgKHRleHRFZGl0b3IuaXNNb2RpZmllZCkgew0KICAgICAgICBpZiAoY29uZmlybSgnWW91IGhhdmUgdW5zYXZlZCBjaGFuZ2VzLiBDcmVhdGUgbmV3IGZpbGUgYW55d2F5PycpKSB7DQogICAgICAgICAgICBjbGVhckVkaXRvcigpOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgY2xlYXJFZGl0b3IoKTsNCiAgICB9DQp9DQoNCi8vIExvYWQgZmlsZSBmcm9tIFZGUw0KYXN5bmMgZnVuY3Rpb24gbG9hZEZpbGUoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0ZpbGVFeHBsb3Jlcih7DQogICAgICAgICAgICBtb2RlOiAnb3BlbicsDQogICAgICAgICAgICB0aXRsZTogJ09wZW4gVGV4dCBGaWxlJywNCiAgICAgICAgICAgIGluaXRpYWxQYXRoOiAnLycsDQogICAgICAgICAgICBvblNlbGVjdDogKHNlbGVjdGVkUGF0aCkgPT4gew0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgaWYgKCFmaWxlUGF0aCkgew0KICAgICAgICAgICAgcmV0dXJuOyAvLyBVc2VyIGNhbmNlbGxlZA0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBDaGVjayBpZiBmaWxlIGV4aXN0cyBhbmQgbG9hZCBpdA0KICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZVRleHQoZmlsZVBhdGgpOw0KICAgICAgICANCiAgICAgICAgLy8gTG9hZCBjb250ZW50IGludG8gZWRpdG9yDQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUgPSBjb250ZW50Ow0KICAgICAgICB0ZXh0RWRpdG9yLmZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgIHRleHRFZGl0b3Iub3JpZ2luYWxDb250ZW50ID0gY29udGVudDsNCiAgICAgICAgDQogICAgICAgIC8vIFVwZGF0ZSBVSQ0KICAgICAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICAgICAgdXBkYXRlU3RhdHVzKCk7DQogICAgICAgIG1hcmtBc1NhdmVkKCk7DQogICAgICAgIA0KICAgICAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBmb3IgbG9hZGVkIGZpbGUNCiAgICAgICAgYXdhaXQgZW5hYmxlU3ludGF4SGlnaGxpZ2h0aW5nKCk7DQogICAgICAgIA0KICAgICAgICAvLyBGb3JjZSB1cGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudCBpZiBoaWdobGlnaHRpbmcgaXMgZW5hYmxlZA0KICAgICAgICBpZiAodGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkICYmIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBTY2hlZHVsZSB2YWxpZGF0aW9uIGZvciBQeXRob24gZmlsZXMNCiAgICAgICAgc2NoZWR1bGVWYWxpZGF0aW9uKCk7DQogICAgICAgIA0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmlsZSBsb2FkZWQ6ICR7ZmlsZVBhdGh9YCwgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgZmlsZTonLCBlcnJvcik7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGYWlsZWQgdG8gbG9hZCBmaWxlOiAke2Vycm9yLm1lc3NhZ2V9YCwgJ2Vycm9yJyk7DQogICAgfQ0KfQ0KDQoNCi8vIFNhdmUgZmlsZSB0byBWRlMNCmFzeW5jIGZ1bmN0aW9uIHNhdmVGaWxlKCkgew0KICAgIGNvbnN0IGNvbnRlbnQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlOw0KICAgIA0KICAgIHRyeSB7DQogICAgICAgIGxldCBmaWxlUGF0aCA9IHRleHRFZGl0b3IuZmlsZVBhdGg7DQogICAgICAgIA0KICAgICAgICAvLyBJZiBpdCdzIGEgbmV3IGZpbGUgKHVudGl0bGVkKSBvciB3ZSB3YW50IHRvIHNhdmUgYXMsIHNob3cgZmlsZSBleHBsb3Jlcg0KICAgICAgICBpZiAodGV4dEVkaXRvci5maWxlUGF0aCA9PT0gJy91bnRpdGxlZC50eHQnKSB7DQogICAgICAgICAgICBmaWxlUGF0aCA9IGF3YWl0IHN5cG5leEFQSS5zaG93RmlsZUV4cGxvcmVyKHsNCiAgICAgICAgICAgICAgICBtb2RlOiAnc2F2ZScsDQogICAgICAgICAgICAgICAgdGl0bGU6ICdTYXZlIFRleHQgRmlsZScsDQogICAgICAgICAgICAgICAgaW5pdGlhbFBhdGg6ICcvJywNCiAgICAgICAgICAgICAgICBmaWxlTmFtZTogJ3VudGl0bGVkLnR4dCcsDQogICAgICAgICAgICAgICAgb25TZWxlY3Q6IChzZWxlY3RlZFBhdGgpID0+IHsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgICAgICByZXR1cm47IC8vIFVzZXIgY2FuY2VsbGVkDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlKGZpbGVQYXRoLCBjb250ZW50KTsNCiAgICAgICAgDQogICAgICAgIHRleHRFZGl0b3IuZmlsZVBhdGggPSBmaWxlUGF0aDsNCiAgICAgICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgIG1hcmtBc1NhdmVkKCk7DQogICAgICAgIA0KICAgICAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBmb3Igc2F2ZWQgZmlsZQ0KICAgICAgICBhd2FpdCBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCiAgICAgICAgDQogICAgICAgIC8vIEZvcmNlIHVwZGF0ZSBoaWdobGlnaHRlZCBjb250ZW50IGlmIGhpZ2hsaWdodGluZyBpcyBlbmFibGVkDQogICAgICAgIGlmICh0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgJiYgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICAgICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGaWxlIHNhdmVkOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIGZpbGU6JywgZXJyb3IpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmFpbGVkIHRvIHNhdmUgZmlsZTogJHtlcnJvci5tZXNzYWdlfWAsICdlcnJvcicpOw0KICAgIH0NCn0NCg0KLy8gU2F2ZSBmaWxlIGFzIChhbHdheXMgc2hvdyBmaWxlIGV4cGxvcmVyKQ0KYXN5bmMgZnVuY3Rpb24gc2F2ZUFzRmlsZSgpIHsNCiAgICBjb25zdCBjb250ZW50ID0gdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZTsNCiAgICANCiAgICB0cnkgew0KICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGF3YWl0IHN5cG5leEFQSS5zaG93RmlsZUV4cGxvcmVyKHsNCiAgICAgICAgICAgIG1vZGU6ICdzYXZlJywNCiAgICAgICAgICAgIHRpdGxlOiAnU2F2ZSBUZXh0IEZpbGUgQXMnLA0KICAgICAgICAgICAgaW5pdGlhbFBhdGg6ICcvJywNCiAgICAgICAgICAgIGZpbGVOYW1lOiB0ZXh0RWRpdG9yLmZpbGVQYXRoID09PSAnL3VudGl0bGVkLnR4dCcgPyAndW50aXRsZWQudHh0JyA6IHRleHRFZGl0b3IuZmlsZVBhdGguc3BsaXQoJy8nKS5wb3AoKSwNCiAgICAgICAgICAgIG9uU2VsZWN0OiAoc2VsZWN0ZWRQYXRoKSA9PiB7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgb25DYW5jZWw6ICgpID0+IHsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICBpZiAoIWZpbGVQYXRoKSB7DQogICAgICAgICAgICByZXR1cm47IC8vIFVzZXIgY2FuY2VsbGVkDQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlKGZpbGVQYXRoLCBjb250ZW50KTsNCiAgICAgICAgDQogICAgICAgIHRleHRFZGl0b3IuZmlsZVBhdGggPSBmaWxlUGF0aDsNCiAgICAgICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgIG1hcmtBc1NhdmVkKCk7DQogICAgICAgIA0KICAgICAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBmb3Igc2F2ZWQgZmlsZQ0KICAgICAgICBhd2FpdCBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCiAgICAgICAgDQogICAgICAgIC8vIEZvcmNlIHVwZGF0ZSBoaWdobGlnaHRlZCBjb250ZW50IGlmIGhpZ2hsaWdodGluZyBpcyBlbmFibGVkDQogICAgICAgIGlmICh0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgJiYgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICAgICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGaWxlIHNhdmVkIGFzOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIGZpbGUgYXM6JywgZXJyb3IpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmFpbGVkIHRvIHNhdmUgZmlsZSBhczogJHtlcnJvci5tZXNzYWdlfWAsICdlcnJvcicpOw0KICAgIH0NCn0NCg0KDQovLyBVcGRhdGUgbGluZSBudW1iZXJzDQpmdW5jdGlvbiB1cGRhdGVMaW5lTnVtYmVycygpIHsNCiAgICBpZiAoIXRleHRFZGl0b3IubGluZU51bWJlcnMgfHwgIXRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkKSByZXR1cm47DQogICAgDQogICAgY29uc3QgbGluZXMgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlLnNwbGl0KCdcbicpOw0KICAgIGNvbnN0IGxpbmVDb3VudCA9IGxpbmVzLmxlbmd0aDsNCiAgICANCiAgICAvLyBHZW5lcmF0ZSBsaW5lIG51bWJlcnMgSFRNTA0KICAgIGxldCBsaW5lTnVtYmVyc0hUTUwgPSAnJzsNCiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBsaW5lQ291bnQ7IGkrKykgew0KICAgICAgICBsaW5lTnVtYmVyc0hUTUwgKz0gYDxzcGFuIGNsYXNzPSJsaW5lLW51bWJlciI+JHtpfTwvc3Bhbj5cbmA7DQogICAgfQ0KICAgIA0KICAgIHRleHRFZGl0b3IubGluZU51bWJlcnMuaW5uZXJIVE1MID0gbGluZU51bWJlcnNIVE1MOw0KfQ0KDQovLyBTeW5jIHNjcm9sbCBiZXR3ZWVuIHRleHRhcmVhIGFuZCBsaW5lIG51bWJlcnMNCmZ1bmN0aW9uIHN5bmNTY3JvbGwoKSB7DQogICAgaWYgKHRleHRFZGl0b3IubGluZU51bWJlcnMgJiYgdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQpIHsNCiAgICAgICAgdGV4dEVkaXRvci5saW5lTnVtYmVycy5zY3JvbGxUb3AgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnNjcm9sbFRvcDsNCiAgICB9DQogICAgDQogICAgLy8gQWxzbyBzeW5jIHRoZSBiYWNrZHJvcCBpZiBpdCBleGlzdHMNCiAgICBzeW5jQmFja2Ryb3BTY3JvbGwoKTsNCn0NCg0KDQovLyBIYW5kbGUgdGV4dCBjaGFuZ2VzDQpmdW5jdGlvbiBoYW5kbGVUZXh0Q2hhbmdlKCkgew0KICAgIHVwZGF0ZUxpbmVOdW1iZXJzKCk7DQogICAgdXBkYXRlU3RhdHVzKCk7DQogICAgbWFya0FzTW9kaWZpZWQoKTsNCiAgICANCiAgICAvLyBTY2hlZHVsZSB2YWxpZGF0aW9uIGZvciBQeXRob24gZmlsZXMNCiAgICBzY2hlZHVsZVZhbGlkYXRpb24oKTsNCn0NCg0KLy8gRm9jdXMgYXBwcm9wcmlhdGUgZWRpdG9yDQpmdW5jdGlvbiBmb2N1c0VkaXRvcigpIHsNCiAgICBpZiAodGV4dEVkaXRvci50ZXh0YXJlYSkgew0KICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLmZvY3VzKCk7DQogICAgfQ0KfQ0KDQoNCi8vIFVwZGF0ZSBmaWxlbmFtZSBkaXNwbGF5DQpmdW5jdGlvbiB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKSB7DQogICAgaWYgKGN1cnJlbnRGaWxlbmFtZUVsKSB7DQogICAgICAgIGNvbnN0IGZpbGVuYW1lID0gdGV4dEVkaXRvci5maWxlUGF0aCA/IHRleHRFZGl0b3IuZmlsZVBhdGguc3BsaXQoJy8nKS5wb3AoKSA6ICd1bnRpdGxlZC50eHQnOw0KICAgICAgICBjdXJyZW50RmlsZW5hbWVFbC50ZXh0Q29udGVudCA9IGZpbGVuYW1lOw0KICAgIH0NCn0NCg0KLy8gSW5pdGlhbGl6ZSBlZGl0b3Igc3RhdGUNCmZ1bmN0aW9uIGluaXRpYWxpemVFZGl0b3IoKSB7DQogICAgLy8gU2V0IGluaXRpYWwgZmlsZSBwYXRoDQogICAgdGV4dEVkaXRvci5maWxlUGF0aCA9ICcvdW50aXRsZWQudHh0JzsNCiAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICANCiAgICAvLyBVcGRhdGUgbGluZSBudW1iZXJzDQogICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICANCiAgICAvLyBVcGRhdGUgc3RhdHVzDQogICAgdXBkYXRlU3RhdHVzKCk7DQogICAgDQogICAgLy8gRW5hYmxlIHN5bnRheCBoaWdobGlnaHRpbmcgaWYgbmVlZGVkDQogICAgZW5hYmxlU3ludGF4SGlnaGxpZ2h0aW5nKCk7DQogICAgDQogICAgLy8gU3RhcnQgYXV0by1zYXZlIGlmIGVuYWJsZWQNCiAgICBpZiAodGV4dEVkaXRvci5zZXR0aW5ncy5hdXRvU2F2ZUludGVydmFsID4gMCkgew0KICAgICAgICBzdGFydEF1dG9TYXZlKCk7DQogICAgfQ0KfQ0KDQoNCg0KLy8gVXBkYXRlIHN0YXR1cyBiYXINCmZ1bmN0aW9uIHVwZGF0ZVN0YXR1cygpIHsNCiAgICAvLyBTdGF0dXMgYmFyIG5vdyBvbmx5IHNob3dzIG1vZGlmaWVkIHN0YXR1cywgd2hpY2ggaXMgaGFuZGxlZCBieSBtYXJrQXNNb2RpZmllZC9tYXJrQXNTYXZlZA0KICAgIC8vIFRoaXMgZnVuY3Rpb24gaXMga2VwdCBmb3IgcG90ZW50aWFsIGZ1dHVyZSB1c2UNCn0NCg0KLy8gTWFyayBmaWxlIGFzIG1vZGlmaWVkDQpmdW5jdGlvbiBtYXJrQXNNb2RpZmllZCgpIHsNCiAgICBpZiAoIXRleHRFZGl0b3IuaXNNb2RpZmllZCkgew0KICAgICAgICB0ZXh0RWRpdG9yLmlzTW9kaWZpZWQgPSB0cnVlOw0KICAgICAgICBpZiAobW9kaWZpZWRTdGF0dXNFbCkgew0KICAgICAgICAgICAgbW9kaWZpZWRTdGF0dXNFbC50ZXh0Q29udGVudCA9ICdZZXMnOw0KICAgICAgICAgICAgbW9kaWZpZWRTdGF0dXNFbC5jbGFzc0xpc3QuYWRkKCdtb2RpZmllZCcpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBNYXJrIGZpbGUgYXMgc2F2ZWQNCmZ1bmN0aW9uIG1hcmtBc1NhdmVkKCkgew0KICAgIHRleHRFZGl0b3IuaXNNb2RpZmllZCA9IGZhbHNlOw0KICAgIHRleHRFZGl0b3Iub3JpZ2luYWxDb250ZW50ID0gdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZTsNCiAgICBpZiAobW9kaWZpZWRTdGF0dXNFbCkgew0KICAgICAgICBtb2RpZmllZFN0YXR1c0VsLnRleHRDb250ZW50ID0gJ05vJzsNCiAgICAgICAgbW9kaWZpZWRTdGF0dXNFbC5jbGFzc0xpc3QucmVtb3ZlKCdtb2RpZmllZCcpOw0KICAgIH0NCn0NCg0KDQovLyBDbGVhciBlZGl0b3INCmZ1bmN0aW9uIGNsZWFyRWRpdG9yKCkgew0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUgPSAnJzsNCiAgICB0ZXh0RWRpdG9yLmZpbGVQYXRoID0gJy91bnRpdGxlZC50eHQnOw0KICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgIHRleHRFZGl0b3Iub3JpZ2luYWxDb250ZW50ID0gJyc7DQogICAgbWFya0FzU2F2ZWQoKTsNCiAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgIHVwZGF0ZVN0YXR1cygpOw0KICAgIA0KICAgIC8vIEVuYWJsZSBzeW50YXggaGlnaGxpZ2h0aW5nIGZvciBuZXcgZmlsZQ0KICAgIGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpOw0KICAgIA0KICAgIC8vIEZvcmNlIHVwZGF0ZSBoaWdobGlnaHRlZCBjb250ZW50IGlmIGhpZ2hsaWdodGluZyBpcyBlbmFibGVkDQogICAgaWYgKHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCAmJiB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgIH0NCiAgICANCiAgICAvLyBDbGVhciBhbnkgZXhpc3RpbmcgZXJyb3JzDQogICAgY2xlYXJFcnJvck1hcmtlcnMoKTsNCiAgICB1cGRhdGVFcnJvckNvdW50KDApOw0KICAgIA0KICAgIC8vIEZvY3VzIHRoZSB0ZXh0YXJlYSAobm90IHRoZSBiYWNrZHJvcCkNCiAgICBmb2N1c0VkaXRvcigpOw0KfQ0KDQovLyBTdGFydCBhdXRvLXNhdmUNCmZ1bmN0aW9uIHN0YXJ0QXV0b1NhdmUoKSB7DQogICAgaWYgKHRleHRFZGl0b3IuYXV0b1NhdmVJbnRlcnZhbCkgew0KICAgICAgICBjbGVhckludGVydmFsKHRleHRFZGl0b3IuYXV0b1NhdmVJbnRlcnZhbCk7DQogICAgfQ0KICAgIA0KICAgIHRleHRFZGl0b3IuYXV0b1NhdmVJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgaWYgKHRleHRFZGl0b3IuaXNNb2RpZmllZCAmJiB0ZXh0RWRpdG9yLmZpbGVQYXRoICYmIHRleHRFZGl0b3IuZmlsZVBhdGggIT09ICcvdW50aXRsZWQudHh0Jykgew0KICAgICAgICAgICAgc2F2ZUZpbGUoKTsNCiAgICAgICAgfQ0KICAgIH0sIHRleHRFZGl0b3Iuc2V0dGluZ3MuYXV0b1NhdmVJbnRlcnZhbCAqIDEwMDApOw0KICAgIA0KfQ0KDQovLyBTdG9wIGF1dG8tc2F2ZQ0KZnVuY3Rpb24gc3RvcEF1dG9TYXZlKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLmF1dG9TYXZlSW50ZXJ2YWwpIHsNCiAgICAgICAgY2xlYXJJbnRlcnZhbCh0ZXh0RWRpdG9yLmF1dG9TYXZlSW50ZXJ2YWwpOw0KICAgICAgICB0ZXh0RWRpdG9yLmF1dG9TYXZlSW50ZXJ2YWwgPSBudWxsOw0KICAgIH0NCn0NCg0KDQovLyBMb2FkIFByaXNtLmpzIGZvciBzeW50YXggaGlnaGxpZ2h0aW5nDQphc3luYyBmdW5jdGlvbiBsb2FkUHJpc21KUygpIHsNCiAgICBpZiAodGV4dEVkaXRvci5wcmlzbUxvYWRlZCkgcmV0dXJuOw0KICAgIA0KICAgIHRyeSB7DQogICAgICAgIA0KICAgICAgICAvLyBMb2FkIFByaXNtLmpzIGxpYnJhcnkNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLmxvYWRMaWJyYXJ5KCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wcmlzbS8xLjI5LjAvcHJpc20ubWluLmpzJywgew0KICAgICAgICAgICAgbG9jYWxOYW1lOiAnUHJpc20nDQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgLy8gTG9hZCBsYW5ndWFnZSBjb21wb25lbnRzDQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL2NvbXBvbmVudHMvcHJpc20tcHl0aG9uLm1pbi5qcycpOw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC9jb21wb25lbnRzL3ByaXNtLWphdmFzY3JpcHQubWluLmpzJyk7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL2NvbXBvbmVudHMvcHJpc20tanNvbi5taW4uanMnKTsNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLmxvYWRMaWJyYXJ5KCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wcmlzbS8xLjI5LjAvY29tcG9uZW50cy9wcmlzbS1tYXJrdXAubWluLmpzJyk7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL2NvbXBvbmVudHMvcHJpc20tY3NzLm1pbi5qcycpOw0KICAgICAgICANCiAgICAgICAgLy8gTG9hZCBQcmlzbSBDU1MNCiAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTsNCiAgICAgICAgbGluay5yZWwgPSAnc3R5bGVzaGVldCc7DQogICAgICAgIGxpbmsuaHJlZiA9ICdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wcmlzbS8xLjI5LjAvdGhlbWVzL3ByaXNtLXRvbW9ycm93Lm1pbi5jc3MnOw0KICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGxpbmspOw0KICAgICAgICANCiAgICAgICAgLy8gQWRkIGN1c3RvbSBDU1MgdG8gZml4IHN0eWxpbmcgaXNzdWVzDQogICAgICAgIGNvbnN0IGN1c3RvbVN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsNCiAgICAgICAgY3VzdG9tU3R5bGUudGV4dENvbnRlbnQgPSBgDQogICAgICAgICAgICAuaGlnaGxpZ2h0ZWQtYmFja2Ryb3AgKiB7DQogICAgICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uLWxpbmU6IG5vbmUgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICB0ZXh0LWRlY29yYXRpb24tc3R5bGU6IG5vbmUgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICB0ZXh0LWRlY29yYXRpb24tY29sb3I6IHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogbm9uZSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgIHRleHQtdW5kZXJsaW5lLW9mZnNldDogMCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLmhpZ2hsaWdodGVkLWJhY2tkcm9wIC50b2tlbi5zdHJpbmcgew0KICAgICAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgfQ0KICAgICAgICBgOw0KICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGN1c3RvbVN0eWxlKTsNCiAgICAgICAgDQogICAgICAgIHRleHRFZGl0b3IucHJpc21Mb2FkZWQgPSB0cnVlOw0KICAgICAgICANCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBQcmlzbS5qczonLCBlcnJvcik7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdGYWlsZWQgdG8gbG9hZCBzeW50YXggaGlnaGxpZ2h0aW5nJywgJ2Vycm9yJyk7DQogICAgfQ0KfQ0KDQovLyBDcmVhdGUgaGlnaGxpZ2h0ZWQgZWRpdG9yDQpmdW5jdGlvbiBjcmVhdGVIaWdobGlnaHRlZEVkaXRvcigpIHsNCiAgICBpZiAoIXRleHRFZGl0b3IucHJpc21Mb2FkZWQpIHJldHVybjsNCiAgICANCiAgICAvLyBDbGVhbiB1cCBhbnkgZXhpc3RpbmcgaGlnaGxpZ2h0ZWQgc2V0dXANCiAgICBjbGVhbnVwSGlnaGxpZ2h0ZWRFZGl0b3IoKTsNCiAgICANCiAgICBjb25zdCBlZGl0b3JXcmFwcGVyID0gdGV4dEVkaXRvci50ZXh0YXJlYS5wYXJlbnRFbGVtZW50Ow0KICAgIGNvbnN0IHRleHRhcmVhID0gdGV4dEVkaXRvci50ZXh0YXJlYTsNCiAgICANCiAgICAvLyBTdG9yZSBvcmlnaW5hbCB0ZXh0YXJlYSBzdHlsZXMNCiAgICBjb25zdCBvcmlnaW5hbFN0eWxlcyA9IHsNCiAgICAgICAgcG9zaXRpb246IHRleHRhcmVhLnN0eWxlLnBvc2l0aW9uLA0KICAgICAgICBiYWNrZ3JvdW5kOiB0ZXh0YXJlYS5zdHlsZS5iYWNrZ3JvdW5kLA0KICAgICAgICBjb2xvcjogdGV4dGFyZWEuc3R5bGUuY29sb3IsDQogICAgICAgIHpJbmRleDogdGV4dGFyZWEuc3R5bGUuekluZGV4LA0KICAgICAgICBjYXJldENvbG9yOiB0ZXh0YXJlYS5zdHlsZS5jYXJldENvbG9yLA0KICAgICAgICBzcGVsbGNoZWNrOiB0ZXh0YXJlYS5nZXRBdHRyaWJ1dGUoJ3NwZWxsY2hlY2snKSwNCiAgICAgICAgYXV0b2NvbXBsZXRlOiB0ZXh0YXJlYS5nZXRBdHRyaWJ1dGUoJ2F1dG9jb21wbGV0ZScpLA0KICAgICAgICBhdXRvY29ycmVjdDogdGV4dGFyZWEuZ2V0QXR0cmlidXRlKCdhdXRvY29ycmVjdCcpLA0KICAgICAgICBhdXRvY2FwaXRhbGl6ZTogdGV4dGFyZWEuZ2V0QXR0cmlidXRlKCdhdXRvY2FwaXRhbGl6ZScpDQogICAgfTsNCiAgICANCiAgICAvLyBDcmVhdGUgYSBjb250YWluZXIgZm9yIHRoZSBvdmVybGF5IGFwcHJvYWNoDQogICAgY29uc3QgaGlnaGxpZ2h0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgaGlnaGxpZ2h0Q29udGFpbmVyLmNsYXNzTmFtZSA9ICdoaWdobGlnaHQtY29udGFpbmVyJzsNCiAgICBoaWdobGlnaHRDb250YWluZXIuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnOw0KICAgIGhpZ2hsaWdodENvbnRhaW5lci5zdHlsZS53aWR0aCA9ICcxMDAlJzsNCiAgICBoaWdobGlnaHRDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gJzEwMCUnOw0KICAgIA0KICAgIC8vIENyZWF0ZSBoaWdobGlnaHRlZCBiYWNrZHJvcA0KICAgIGNvbnN0IGhpZ2hsaWdodGVkQmFja2Ryb3AgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLmlkID0gJ2hpZ2hsaWdodGVkLWJhY2tkcm9wJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLmNsYXNzTmFtZSA9ICdoaWdobGlnaHRlZC1iYWNrZHJvcCc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS50b3AgPSAnMCc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5sZWZ0ID0gJzAnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUud2lkdGggPSAnMTAwJSc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUuZm9udEZhbWlseSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRleHRhcmVhKS5mb250RmFtaWx5Ow0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUuZm9udFNpemUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0ZXh0YXJlYSkuZm9udFNpemU7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5saW5lSGVpZ2h0ID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGV4dGFyZWEpLmxpbmVIZWlnaHQ7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5wYWRkaW5nID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGV4dGFyZWEpLnBhZGRpbmc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5tYXJnaW4gPSAnMCc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5ib3JkZXIgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0ZXh0YXJlYSkuYm9yZGVyOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUud2hpdGVTcGFjZSA9ICdwcmUtd3JhcCc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS53b3JkV3JhcCA9ICdicmVhay13b3JkJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS56SW5kZXggPSAnMSc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5yZXNpemUgPSAnbm9uZSc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5jb2xvciA9ICcjZmZmZmZmJzsgLy8gRGVmYXVsdCB0ZXh0IGNvbG9yIGZvciBoaWdobGlnaHRpbmcNCiAgICANCiAgICAvLyBNYWtlIHN1cmUgdGV4dGFyZWEgaXMgb24gdG9wIGFuZCBoYXMgdHJhbnNwYXJlbnQgYmFja2dyb3VuZCBhbmQgdGV4dA0KICAgIHRleHRhcmVhLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJzsNCiAgICB0ZXh0YXJlYS5zdHlsZS56SW5kZXggPSAnMic7DQogICAgdGV4dGFyZWEuc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7DQogICAgdGV4dGFyZWEuc3R5bGUuY29sb3IgPSAndHJhbnNwYXJlbnQnOw0KICAgIHRleHRhcmVhLnN0eWxlLmNhcmV0Q29sb3IgPSAnI2ZmZmZmZic7DQogICAgDQogICAgLy8gRGlzYWJsZSBicm93c2VyIHNwZWxsIGNoZWNraW5nIGZvciBjb2RlDQogICAgdGV4dGFyZWEuc2V0QXR0cmlidXRlKCdzcGVsbGNoZWNrJywgJ2ZhbHNlJyk7DQogICAgdGV4dGFyZWEuc2V0QXR0cmlidXRlKCdhdXRvY29tcGxldGUnLCAnb2ZmJyk7DQogICAgdGV4dGFyZWEuc2V0QXR0cmlidXRlKCdhdXRvY29ycmVjdCcsICdvZmYnKTsNCiAgICB0ZXh0YXJlYS5zZXRBdHRyaWJ1dGUoJ2F1dG9jYXBpdGFsaXplJywgJ29mZicpOw0KICAgIA0KICAgIC8vIFdyYXAgdGV4dGFyZWEgaW4gY29udGFpbmVyDQogICAgZWRpdG9yV3JhcHBlci5pbnNlcnRCZWZvcmUoaGlnaGxpZ2h0Q29udGFpbmVyLCB0ZXh0YXJlYSk7DQogICAgaGlnaGxpZ2h0Q29udGFpbmVyLmFwcGVuZENoaWxkKGhpZ2hsaWdodGVkQmFja2Ryb3ApOw0KICAgIGhpZ2hsaWdodENvbnRhaW5lci5hcHBlbmRDaGlsZCh0ZXh0YXJlYSk7DQogICAgDQogICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvciA9IGhpZ2hsaWdodGVkQmFja2Ryb3A7DQogICAgdGV4dEVkaXRvci5oaWdobGlnaHRDb250YWluZXIgPSBoaWdobGlnaHRDb250YWluZXI7DQogICAgdGV4dEVkaXRvci5vcmlnaW5hbFRleHRhcmVhU3R5bGVzID0gb3JpZ2luYWxTdHlsZXM7DQogICAgdGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkID0gdHJ1ZTsNCiAgICANCiAgICAvLyBTZXQgaW5pdGlhbCBjb250ZW50DQogICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgDQogICAgLy8gU2V0IHVwIHNpbXBsZSBldmVudCBoYW5kbGVycyBmb3IgdGhlIHRleHRhcmVhIChub3QgdGhlIGJhY2tkcm9wKQ0KICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgaGFuZGxlU2ltcGxlSW5wdXQpOw0KICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHN5bmNCYWNrZHJvcFNjcm9sbCk7DQogICAgdGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUhpZ2hsaWdodEtleURvd24pOw0KICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlSGlnaGxpZ2h0Q2xpY2spOw0KICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgaGFuZGxlSGlnaGxpZ2h0Rm9jdXMpOw0KICAgIA0KfQ0KDQoNCi8vIFVwZGF0ZSBoaWdobGlnaHRlZCBjb250ZW50DQpmdW5jdGlvbiB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKSB7DQogICAgaWYgKCF0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yIHx8ICF0ZXh0RWRpdG9yLnByaXNtTG9hZGVkKSByZXR1cm47DQogICAgDQogICAgY29uc3QgY29udGVudCA9IHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWU7DQogICAgY29uc3QgbGFuZ3VhZ2UgPSBnZXRGaWxlTGFuZ3VhZ2UodGV4dEVkaXRvci5maWxlUGF0aCk7DQogICAgDQogICAgaWYgKCFsYW5ndWFnZSkgew0KICAgICAgICAvLyBObyBsYW5ndWFnZSBkZXRlY3RlZCwgdXNlIHBsYWluIHRleHQNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci50ZXh0Q29udGVudCA9IGNvbnRlbnQ7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gQXBwbHkgc3ludGF4IGhpZ2hsaWdodGluZyB0byBiYWNrZHJvcA0KICAgIGNvbnN0IGhpZ2hsaWdodGVkQ29udGVudCA9IFByaXNtLmhpZ2hsaWdodChjb250ZW50LCBQcmlzbS5sYW5ndWFnZXNbbGFuZ3VhZ2VdLCBsYW5ndWFnZSk7DQogICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5pbm5lckhUTUwgPSBoaWdobGlnaHRlZENvbnRlbnQ7DQogICAgDQogICAgLy8gU3luYyBzY3JvbGwgcG9zaXRpb24NCiAgICBzeW5jQmFja2Ryb3BTY3JvbGwoKTsNCiAgICANCn0NCg0KLy8gRW5hYmxlIHN5bnRheCBoaWdobGlnaHRpbmcgZm9yIHN1cHBvcnRlZCBmaWxlcw0KYXN5bmMgZnVuY3Rpb24gZW5hYmxlU3ludGF4SGlnaGxpZ2h0aW5nKCkgew0KICAgIGlmICghdGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmcpIHsNCiAgICAgICAgY2xlYW51cEhpZ2hsaWdodGVkRWRpdG9yKCk7DQogICAgICAgIHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCA9IGZhbHNlOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGxhbmd1YWdlID0gZ2V0RmlsZUxhbmd1YWdlKHRleHRFZGl0b3IuZmlsZVBhdGgpOw0KICAgIA0KICAgIGlmIChsYW5ndWFnZSkgew0KICAgICAgICBpZiAoIXRleHRFZGl0b3IucHJpc21Mb2FkZWQpIHsNCiAgICAgICAgICAgIGF3YWl0IGxvYWRQcmlzbUpTKCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGlmICghdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICAgICAgY3JlYXRlSGlnaGxpZ2h0ZWRFZGl0b3IoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgdGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkID0gdHJ1ZTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBEaXNhYmxlIGhpZ2hsaWdodGluZyBmb3IgdW5zdXBwb3J0ZWQgZmlsZXMNCiAgICAgICAgY2xlYW51cEhpZ2hsaWdodGVkRWRpdG9yKCk7DQogICAgICAgIHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCA9IGZhbHNlOw0KICAgIH0NCn0NCg0KLy8gSGFuZGxlIHNpbXBsZSBpbnB1dCBmb3IgYmFja2Ryb3AgYXBwcm9hY2gNCmZ1bmN0aW9uIGhhbmRsZVNpbXBsZUlucHV0KCkgew0KICAgIC8vIFVwZGF0ZSBsaW5lIG51bWJlcnMgYW5kIHN0YXR1cyBpbW1lZGlhdGVseQ0KICAgIHVwZGF0ZUxpbmVOdW1iZXJzKCk7DQogICAgdXBkYXRlU3RhdHVzKCk7DQogICAgbWFya0FzTW9kaWZpZWQoKTsNCiAgICANCiAgICAvLyBJbW1lZGlhdGUgaGlnaGxpZ2h0aW5nIHVwZGF0ZSBmb3IgcmVzcG9uc2l2ZSBmZWVsDQogICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgDQogICAgLy8gU2NoZWR1bGUgdmFsaWRhdGlvbiBmb3IgUHl0aG9uIGZpbGVzDQogICAgc2NoZWR1bGVWYWxpZGF0aW9uKCk7DQp9DQoNCi8vIEhhbmRsZSBrZXkgZXZlbnRzIHRoYXQgbWlnaHQgY2hhbmdlIGNvbnRlbnQNCmZ1bmN0aW9uIGhhbmRsZUhpZ2hsaWdodEtleURvd24oZSkgew0KICAgIC8vIEZvciBrZXlzIHRoYXQgbW9kaWZ5IGNvbnRlbnQsIHVwZGF0ZSBoaWdobGlnaHRpbmcgaW1tZWRpYXRlbHkgYWZ0ZXIgdGhlIGV2ZW50DQogICAgaWYgKGUua2V5ID09PSAnVGFiJyB8fCBlLmtleSA9PT0gJ0VudGVyJyB8fCBlLmtleSA9PT0gJ0JhY2tzcGFjZScgfHwgZS5rZXkgPT09ICdEZWxldGUnKSB7DQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgICAgIH0sIDApOyAvLyBVcGRhdGUgb24gbmV4dCB0aWNrIGFmdGVyIHRoZSBrZXkgZXZlbnQgaXMgcHJvY2Vzc2VkDQogICAgfQ0KfQ0KDQovLyBIYW5kbGUgY2xpY2sgZXZlbnRzIChjdXJzb3IgcG9zaXRpb24gY2hhbmdlcykNCmZ1bmN0aW9uIGhhbmRsZUhpZ2hsaWdodENsaWNrKCkgew0KICAgIC8vIFN5bmMgc2Nyb2xsIHBvc2l0aW9uIHdoZW4gdXNlciBjbGlja3MNCiAgICBzeW5jQmFja2Ryb3BTY3JvbGwoKTsNCn0NCg0KLy8gSGFuZGxlIGZvY3VzIGV2ZW50cw0KZnVuY3Rpb24gaGFuZGxlSGlnaGxpZ2h0Rm9jdXMoKSB7DQogICAgLy8gRW5zdXJlIGhpZ2hsaWdodGluZyBpcyBpbiBzeW5jIHdoZW4gdGV4dGFyZWEgZ2V0cyBmb2N1cw0KICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgIHN5bmNCYWNrZHJvcFNjcm9sbCgpOw0KfQ0KDQovLyBTeW5jIGJhY2tkcm9wIHNjcm9sbCB3aXRoIHRleHRhcmVhDQpmdW5jdGlvbiBzeW5jQmFja2Ryb3BTY3JvbGwoKSB7DQogICAgaWYgKHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5zY3JvbGxUb3AgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnNjcm9sbFRvcDsNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5zY3JvbGxMZWZ0ID0gdGV4dEVkaXRvci50ZXh0YXJlYS5zY3JvbGxMZWZ0Ow0KICAgIH0NCn0NCg0KLy8gQ2xlYW4gdXAgaGlnaGxpZ2h0ZWQgZWRpdG9yDQpmdW5jdGlvbiBjbGVhbnVwSGlnaGxpZ2h0ZWRFZGl0b3IoKSB7DQogICAgaWYgKHRleHRFZGl0b3IuaGlnaGxpZ2h0Q29udGFpbmVyKSB7DQogICAgICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgdGV4dGFyZWEgc3R5bGVzDQogICAgICAgIGlmICh0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMpIHsNCiAgICAgICAgICAgIGNvbnN0IHRleHRhcmVhID0gdGV4dEVkaXRvci50ZXh0YXJlYTsNCiAgICAgICAgICAgIHRleHRhcmVhLnN0eWxlLnBvc2l0aW9uID0gdGV4dEVkaXRvci5vcmlnaW5hbFRleHRhcmVhU3R5bGVzLnBvc2l0aW9uOw0KICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuYmFja2dyb3VuZCA9IHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcy5iYWNrZ3JvdW5kOw0KICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuY29sb3IgPSB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMuY29sb3I7DQogICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS56SW5kZXggPSB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMuekluZGV4Ow0KICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuY2FyZXRDb2xvciA9IHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcy5jYXJldENvbG9yOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBSZW1vdmUgdGhlIGNvbnRhaW5lciBhbmQgcmVzdG9yZSB0ZXh0YXJlYSB0byBpdHMgb3JpZ2luYWwgcGFyZW50DQogICAgICAgIGNvbnN0IGVkaXRvcldyYXBwZXIgPSB0ZXh0RWRpdG9yLmhpZ2hsaWdodENvbnRhaW5lci5wYXJlbnRFbGVtZW50Ow0KICAgICAgICBjb25zdCB0ZXh0YXJlYSA9IHRleHRFZGl0b3IudGV4dGFyZWE7DQogICAgICAgIA0KICAgICAgICAvLyBNb3ZlIHRleHRhcmVhIGJhY2sgdG8gaXRzIG9yaWdpbmFsIGxvY2F0aW9uDQogICAgICAgIGVkaXRvcldyYXBwZXIuaW5zZXJ0QmVmb3JlKHRleHRhcmVhLCB0ZXh0RWRpdG9yLmhpZ2hsaWdodENvbnRhaW5lcik7DQogICAgICAgIA0KICAgICAgICAvLyBSZW1vdmUgdGhlIGhpZ2hsaWdodCBjb250YWluZXINCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRDb250YWluZXIucmVtb3ZlKCk7DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciByZWZlcmVuY2VzDQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0Q29udGFpbmVyID0gbnVsbDsNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvciA9IG51bGw7DQogICAgICAgIHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcyA9IG51bGw7DQogICAgfQ0KfQ0KDQovLyBUb2dnbGUgc3ludGF4IGhpZ2hsaWdodGluZw0KYXN5bmMgZnVuY3Rpb24gdG9nZ2xlU3ludGF4SGlnaGxpZ2h0aW5nKCkgew0KICAgIHRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nID0gIXRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nOw0KICAgIA0KICAgIC8vIFNhdmUgc2V0dGluZw0KICAgIHRyeSB7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5zZXRTZXR0aW5nKCdTWU5UQVhfSElHSExJR0hUSU5HJywgdGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmcpOw0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIHN5bnRheCBoaWdobGlnaHRpbmcgc2V0dGluZzonLCBlcnJvcik7DQogICAgfQ0KICAgIA0KICAgIC8vIFVwZGF0ZSBVSQ0KICAgIGlmIChzeW50YXhIaWdobGlnaHRpbmdUb2dnbGUpIHsNCiAgICAgICAgc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIHRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nKTsNCiAgICB9DQogICAgDQogICAgLy8gQXBwbHkgb3IgZGlzYWJsZSBoaWdobGlnaHRpbmcNCiAgICBpZiAodGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmcpIHsNCiAgICAgICAgYXdhaXQgZW5hYmxlU3ludGF4SGlnaGxpZ2h0aW5nKCk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gRGlzYWJsZSBoaWdobGlnaHRpbmcNCiAgICAgICAgY2xlYW51cEhpZ2hsaWdodGVkRWRpdG9yKCk7DQogICAgICAgIHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCA9IGZhbHNlOw0KICAgIH0NCiAgICANCiAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbigNCiAgICAgICAgYFN5bnRheCBoaWdobGlnaHRpbmcgJHt0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZyA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCd9YCwNCiAgICAgICAgJ2luZm8nDQogICAgKTsNCn0NCg0KDQovLyBMb2FkIFB5b2RpZGUgZm9yIFB5dGhvbiBzeW50YXggdmFsaWRhdGlvbg0KYXN5bmMgZnVuY3Rpb24gbG9hZFB5b2RpZGUoKSB7DQogICAgDQogICAgaWYgKHRleHRFZGl0b3IucHlvZGlkZUxvYWRlZCAmJiB3aW5kb3cucHlvZGlkZSkgew0KICAgICAgICByZXR1cm4gd2luZG93LnB5b2RpZGU7DQogICAgfQ0KICAgIA0KICAgIHRyeSB7DQogICAgICAgIA0KICAgICAgICAvLyBMb2FkIFB5b2RpZGUgc2NyaXB0DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L3B5b2RpZGUvdjAuMjQuMS9mdWxsL3B5b2RpZGUuanMnLCB7DQogICAgICAgICAgICBsb2NhbE5hbWU6ICdsb2FkUHlvZGlkZScNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICANCiAgICAgICAgLy8gSW5pdGlhbGl6ZSBQeW9kaWRlIC0gdXNlIHRoZSBnbG9iYWwgbG9hZFB5b2RpZGUgZnVuY3Rpb24NCiAgICAgICAgd2luZG93LnB5b2RpZGUgPSBhd2FpdCB3aW5kb3cubG9hZFB5b2RpZGUoew0KICAgICAgICAgICAgaW5kZXhVUkw6ICJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvcHlvZGlkZS92MC4yNC4xL2Z1bGwvIg0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIA0KICAgICAgICAvLyBJbnN0YWxsIHZhbGlkYXRpb24gZnVuY3Rpb24NCiAgICAgICAgd2luZG93LnB5b2RpZGUucnVuUHl0aG9uKGANCmltcG9ydCBhc3QNCg0KZGVmIHZhbGlkYXRlX3B5dGhvbl9zeW50YXgoY29kZSk6DQogICAgIiIiVmFsaWRhdGUgUHl0aG9uIHN5bnRheCBhbmQgcmV0dXJuIGVycm9ycyIiIg0KICAgIHRyeToNCiAgICAgICAgIyBUcnkgdG8gcGFyc2UgdGhlIGNvZGUgYXMgYW4gQVNUDQogICAgICAgIGFzdC5wYXJzZShjb2RlKQ0KICAgICAgICByZXR1cm4geyJ2YWxpZCI6IFRydWUsICJlcnJvcnMiOiBbXX0NCiAgICBleGNlcHQgU3ludGF4RXJyb3IgYXMgZToNCiAgICAgICAgZXJyb3JfaW5mbyA9IHsNCiAgICAgICAgICAgICJsaW5lIjogZS5saW5lbm8gb3IgMSwNCiAgICAgICAgICAgICJjb2x1bW4iOiBlLm9mZnNldCBvciAxLCANCiAgICAgICAgICAgICJtZXNzYWdlIjogZS5tc2cgb3IgIlN5bnRheCBlcnJvciIsDQogICAgICAgICAgICAidHlwZSI6ICJzeW50YXgiDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHsidmFsaWQiOiBGYWxzZSwgImVycm9ycyI6IFtlcnJvcl9pbmZvXX0NCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgIGVycm9yX2luZm8gPSB7DQogICAgICAgICAgICAibGluZSI6IDEsDQogICAgICAgICAgICAiY29sdW1uIjogMSwNCiAgICAgICAgICAgICJtZXNzYWdlIjogc3RyKGUpLA0KICAgICAgICAgICAgInR5cGUiOiAiZ2VuZXJhbCINCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4geyJ2YWxpZCI6IEZhbHNlLCAiZXJyb3JzIjogW2Vycm9yX2luZm9dfQ0KICAgICAgICBgKTsNCiAgICAgICAgDQogICAgICAgIHRleHRFZGl0b3IucHlvZGlkZUxvYWRlZCA9IHRydWU7DQogICAgICAgIA0KICAgICAgICAvLyBTaG93IG5vdGlmaWNhdGlvbg0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignUHl0aG9uIHZhbGlkYXRpb24gcmVhZHkhJywgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiB3aW5kb3cucHlvZGlkZTsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBsb2FkIFB5b2RpZGU6JywgZXJyb3IpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignRmFpbGVkIHRvIGxvYWQgUHl0aG9uIHZhbGlkYXRpb246ICcgKyBlcnJvci5tZXNzYWdlLCAnZXJyb3InKTsNCiAgICAgICAgdGhyb3cgZXJyb3I7DQogICAgfQ0KfQ0KDQovLyBWYWxpZGF0ZSBQeXRob24gc3ludGF4IHVzaW5nIFB5b2RpZGUNCmFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlUHl0aG9uU3ludGF4KGNvZGUpIHsNCiAgICANCiAgICBpZiAoIXRleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQpIHsNCiAgICAgICAgcmV0dXJuIHsidmFsaWQiOiB0cnVlLCAiZXJyb3JzIjogW119Ow0KICAgIH0NCiAgICANCiAgICB0cnkgew0KICAgICAgICBjb25zdCBweW9kaWRlID0gYXdhaXQgbG9hZFB5b2RpZGUoKTsNCiAgICAgICAgDQogICAgICAgIC8vIENhbGwgdGhlIFB5dGhvbiB2YWxpZGF0aW9uIGZ1bmN0aW9uDQogICAgICAgIHB5b2RpZGUuZ2xvYmFscy5zZXQoImNvZGVfdG9fdmFsaWRhdGUiLCBjb2RlKTsNCiAgICAgICAgY29uc3QgcmVzdWx0ID0gcHlvZGlkZS5ydW5QeXRob24oInZhbGlkYXRlX3B5dGhvbl9zeW50YXgoY29kZV90b192YWxpZGF0ZSkiKTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IGpzUmVzdWx0ID0gcmVzdWx0LnRvSnMoe2RpY3RfY29udmVydGVyOiBPYmplY3QuZnJvbUVudHJpZXN9KTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiBqc1Jlc3VsdDsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFB5b2RpZGUgdmFsaWRhdGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIA0KICAgICAgICAvLyBGYWxsYmFjayB0byBiYXNpYyBjbGllbnQtc2lkZSB2YWxpZGF0aW9uDQogICAgICAgIHJldHVybiB2YWxpZGF0ZVB5dGhvbkJhc2ljKGNvZGUpOw0KICAgIH0NCn0NCg0KLy8gQmFzaWMgUHl0aG9uIHN5bnRheCB2YWxpZGF0aW9uIChmYWxsYmFjaykNCmZ1bmN0aW9uIHZhbGlkYXRlUHl0aG9uQmFzaWMoY29kZSkgew0KICAgIGNvbnN0IGVycm9ycyA9IFtdOw0KICAgIGNvbnN0IGxpbmVzID0gY29kZS5zcGxpdCgnXG4nKTsNCiAgICANCiAgICBsaW5lcy5mb3JFYWNoKChsaW5lLCBpbmRleCkgPT4gew0KICAgICAgICBjb25zdCBsaW5lTnVtID0gaW5kZXggKyAxOw0KICAgICAgICBjb25zdCB0cmltbWVkID0gbGluZS50cmltKCk7DQogICAgICAgIA0KICAgICAgICAvLyBTa2lwIGVtcHR5IGxpbmVzIGFuZCBjb21tZW50cw0KICAgICAgICBpZiAoIXRyaW1tZWQgfHwgdHJpbW1lZC5zdGFydHNXaXRoKCcjJykpIHJldHVybjsNCiAgICAgICAgDQogICAgICAgIC8vIENoZWNrIGZvciB1bnRlcm1pbmF0ZWQgc3RyaW5ncyAobW9yZSBhY2N1cmF0ZSkNCiAgICAgICAgbGV0IGluU3RyaW5nID0gZmFsc2U7DQogICAgICAgIGxldCBzdHJpbmdDaGFyID0gbnVsbDsNCiAgICAgICAgbGV0IGVzY2FwZWQgPSBmYWxzZTsNCiAgICAgICAgDQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJpbW1lZC5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgY29uc3QgY2hhciA9IHRyaW1tZWRbaV07DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChlc2NhcGVkKSB7DQogICAgICAgICAgICAgICAgZXNjYXBlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoY2hhciA9PT0gJ1xcJykgew0KICAgICAgICAgICAgICAgIGVzY2FwZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoIWluU3RyaW5nICYmIChjaGFyID09PSAnIicgfHwgY2hhciA9PT0gIiciKSkgew0KICAgICAgICAgICAgICAgIGluU3RyaW5nID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBzdHJpbmdDaGFyID0gY2hhcjsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5TdHJpbmcgJiYgY2hhciA9PT0gc3RyaW5nQ2hhcikgew0KICAgICAgICAgICAgICAgIGluU3RyaW5nID0gZmFsc2U7DQogICAgICAgICAgICAgICAgc3RyaW5nQ2hhciA9IG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGlmIChpblN0cmluZykgew0KICAgICAgICAgICAgZXJyb3JzLnB1c2goew0KICAgICAgICAgICAgICAgIGxpbmU6IGxpbmVOdW0sDQogICAgICAgICAgICAgICAgY29sdW1uOiAxLA0KICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJVbnRlcm1pbmF0ZWQgc3RyaW5nIGxpdGVyYWwiLA0KICAgICAgICAgICAgICAgIHR5cGU6ICJzeW50YXgiDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQ2hlY2sgZm9yIG1pc3NpbmcgY29sb25zIGFmdGVyIGNvbnRyb2wgc3RydWN0dXJlcyAobW9yZSBwcmVjaXNlKQ0KICAgICAgICBjb25zdCBjb250cm9sU3RydWN0dXJlcyA9IC9eKGlmfGVsaWZ8ZWxzZXxmb3J8d2hpbGV8ZGVmfGNsYXNzfHRyeXxleGNlcHR8ZmluYWxseXx3aXRofGFzeW5jXHMrZGVmKVxzLzsNCiAgICAgICAgaWYgKGNvbnRyb2xTdHJ1Y3R1cmVzLnRlc3QodHJpbW1lZCkgJiYgIXRyaW1tZWQuZW5kc1dpdGgoJzonKSAmJiAhdHJpbW1lZC5pbmNsdWRlcygnIycpKSB7DQogICAgICAgICAgICBlcnJvcnMucHVzaCh7DQogICAgICAgICAgICAgICAgbGluZTogbGluZU51bSwNCiAgICAgICAgICAgICAgICBjb2x1bW46IHRyaW1tZWQubGVuZ3RoLA0KICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJNaXNzaW5nIGNvbG9uIiwNCiAgICAgICAgICAgICAgICB0eXBlOiAic3ludGF4Ig0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIENoZWNrIGZvciBiYXNpYyBpbmRlbnRhdGlvbiBlcnJvcnMgKHZlcnkgYmFzaWMpDQogICAgICAgIGlmICh0cmltbWVkLm1hdGNoKC9eKHJldHVybnxicmVha3xjb250aW51ZXxwYXNzfHJhaXNlfHlpZWxkKVxzLykgJiYgbGluZSAhPT0gdHJpbW1lZCkgew0KICAgICAgICAgICAgLy8gVGhlc2Uga2V5d29yZHMgc2hvdWxkIHR5cGljYWxseSBiZSBhdCBwcm9wZXIgaW5kZW50YXRpb24gbGV2ZWxzDQogICAgICAgICAgICAvLyBCdXQgdGhpcyBpcyB0b28gY29tcGxleCBmb3IgYmFzaWMgdmFsaWRhdGlvbiwgc28gc2tpcCBpdA0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBPbmx5IGNoZWNrIHBhcmVudGhlc2VzIG9uIGxpbmVzIHRoYXQgc2VlbSB0byBoYXZlIGZ1bmN0aW9uIGNhbGxzIG9yIGRlZmluaXRpb25zDQogICAgICAgIGlmICh0cmltbWVkLmluY2x1ZGVzKCcoJykgfHwgdHJpbW1lZC5pbmNsdWRlcygnKScpKSB7DQogICAgICAgICAgICBjb25zdCBvcGVuUGFyZW5zID0gKHRyaW1tZWQubWF0Y2goL1woL2cpIHx8IFtdKS5sZW5ndGg7DQogICAgICAgICAgICBjb25zdCBjbG9zZVBhcmVucyA9ICh0cmltbWVkLm1hdGNoKC9cKS9nKSB8fCBbXSkubGVuZ3RoOw0KICAgICAgICAgICAgaWYgKG9wZW5QYXJlbnMgIT09IGNsb3NlUGFyZW5zKSB7DQogICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goew0KICAgICAgICAgICAgICAgICAgICBsaW5lOiBsaW5lTnVtLA0KICAgICAgICAgICAgICAgICAgICBjb2x1bW46IDEsDQogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJVbm1hdGNoZWQgcGFyZW50aGVzZXMiLA0KICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3ludGF4Ig0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgcmV0dXJuIHsNCiAgICAgICAgdmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsDQogICAgICAgIGVycm9yczogZXJyb3JzDQogICAgfTsNCn0NCg0KDQovLyBTY2hlZHVsZSB2YWxpZGF0aW9uIHdpdGggZGVib3VuY2luZw0KZnVuY3Rpb24gc2NoZWR1bGVWYWxpZGF0aW9uKCkgew0KICAgIA0KICAgIC8vIENsZWFyIGV4aXN0aW5nIHRpbWVyDQogICAgaWYgKHRleHRFZGl0b3IudmFsaWRhdGlvbkRlYm91bmNlVGltZXIpIHsNCiAgICAgICAgY2xlYXJUaW1lb3V0KHRleHRFZGl0b3IudmFsaWRhdGlvbkRlYm91bmNlVGltZXIpOw0KICAgIH0NCiAgICANCiAgICAvLyBPbmx5IHZhbGlkYXRlIFB5dGhvbiBmaWxlcw0KICAgIGlmICghaXNQeXRob25GaWxlKHRleHRFZGl0b3IuZmlsZVBhdGgpIHx8ICF0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkKSB7DQogICAgICAgIGNsZWFyRXJyb3JNYXJrZXJzKCk7DQogICAgICAgIHVwZGF0ZUVycm9yQ291bnQoMCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgDQogICAgLy8gRGVib3VuY2UgdmFsaWRhdGlvbiB0byBhdm9pZCB0b28gZnJlcXVlbnQgY2FsbHMgYW5kIGludGVyZmVyZW5jZSB3aXRoIHR5cGluZw0KICAgIHRleHRFZGl0b3IudmFsaWRhdGlvbkRlYm91bmNlVGltZXIgPSBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsNCiAgICAgICAgY29uc3QgY29kZSA9IHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWU7DQogICAgICAgIA0KICAgICAgICAvLyBEb24ndCB2YWxpZGF0ZSBlbXB0eSBmaWxlcw0KICAgICAgICBpZiAoIWNvZGUudHJpbSgpKSB7DQogICAgICAgICAgICBjbGVhckVycm9yTWFya2VycygpOw0KICAgICAgICAgICAgdXBkYXRlRXJyb3JDb3VudCgwKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHZhbGlkYXRlUHl0aG9uU3ludGF4KGNvZGUpOw0KICAgICAgICAgICAgZGlzcGxheVZhbGlkYXRpb25FcnJvcnMocmVzdWx0LmVycm9ycyB8fCBbXSk7DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgVmFsaWRhdGlvbiBzY2hlZHVsaW5nIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgfQ0KICAgIH0sIDEwMDApOyAvLyAxMDAwbXMgZGVsYXkgLSBtdWNoIGxvbmdlciB0byBhdm9pZCBpbnRlcmZlcmluZyB3aXRoIGZhc3QgdHlwaW5nDQp9DQoNCi8vIERpc3BsYXkgdmFsaWRhdGlvbiBlcnJvcnMgaW4gdGhlIGVkaXRvcg0KZnVuY3Rpb24gZGlzcGxheVZhbGlkYXRpb25FcnJvcnMoZXJyb3JzKSB7DQogICAgLy8gQ2xlYXIgcHJldmlvdXMgZXJyb3JzDQogICAgY2xlYXJFcnJvck1hcmtlcnMoKTsNCiAgICANCiAgICAvLyBTdG9yZSBjdXJyZW50IGVycm9ycw0KICAgIHRleHRFZGl0b3IuY3VycmVudEVycm9ycyA9IGVycm9yczsNCiAgICANCiAgICAvLyBVcGRhdGUgZXJyb3IgY291bnQNCiAgICB1cGRhdGVFcnJvckNvdW50KGVycm9ycy5sZW5ndGgpOw0KICAgIA0KICAgIC8vIEFkZCBlcnJvciBtYXJrZXJzDQogICAgZXJyb3JzLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBhZGRFcnJvck1hcmtlcihlcnJvci5saW5lLCBlcnJvci5tZXNzYWdlLCBlcnJvci50eXBlKTsNCiAgICB9KTsNCiAgICANCn0NCg0KDQovLyBBZGQgZXJyb3IgbWFya2VyIHRvIGEgc3BlY2lmaWMgbGluZQ0KZnVuY3Rpb24gYWRkRXJyb3JNYXJrZXIobGluZU51bWJlciwgbWVzc2FnZSwgdHlwZSA9ICdzeW50YXgnKSB7DQogICAgaWYgKCF0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzIHx8IGxpbmVOdW1iZXIgPCAxKSByZXR1cm47DQogICAgDQogICAgLy8gRmluZCB0aGUgbGluZSBudW1iZXIgZWxlbWVudA0KICAgIGNvbnN0IGxpbmVOdW1iZXJFbGVtZW50cyA9IHRleHRFZGl0b3IubGluZU51bWJlcnMuY2hpbGRyZW47DQogICAgY29uc3QgbGluZUluZGV4ID0gbGluZU51bWJlciAtIDE7IC8vIENvbnZlcnQgdG8gMC1iYXNlZCBpbmRleA0KICAgIA0KICAgIGlmIChsaW5lSW5kZXggPCBsaW5lTnVtYmVyRWxlbWVudHMubGVuZ3RoKSB7DQogICAgICAgIGNvbnN0IGxpbmVFbCA9IGxpbmVOdW1iZXJFbGVtZW50c1tsaW5lSW5kZXhdOw0KICAgICAgICANCiAgICAgICAgLy8gQWRkIGVycm9yIGNsYXNzDQogICAgICAgIGxpbmVFbC5jbGFzc0xpc3QuYWRkKCdsaW5lLWVycm9yJyk7DQogICAgICAgIGxpbmVFbC50aXRsZSA9IGBMaW5lICR7bGluZU51bWJlcn06ICR7bWVzc2FnZX1gOw0KICAgICAgICANCiAgICAgICAgLy8gU3RvcmUgZXJyb3IgaW5mbyBmb3IgY2xlYW51cA0KICAgICAgICB0ZXh0RWRpdG9yLmVycm9yTWFya2Vycy5wdXNoKGxpbmVFbCk7DQogICAgfQ0KICAgIA0KICAgIC8vIEFsc28gdHJ5IHRvIGFkZCB1bmRlcmxpbmUgdG8gdGhlIHRleHQgaWYgdXNpbmcgaGlnaGxpZ2h0ZWQgZWRpdG9yDQogICAgaWYgKHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgYWRkRXJyb3JVbmRlcmxpbmUobGluZU51bWJlciwgbWVzc2FnZSk7DQogICAgfQ0KfQ0KDQovLyBBZGQgZXJyb3IgdW5kZXJsaW5lIHRvIGhpZ2hsaWdodGVkIGVkaXRvciAoYmFzaWMgaW1wbGVtZW50YXRpb24pDQpmdW5jdGlvbiBhZGRFcnJvclVuZGVybGluZShsaW5lTnVtYmVyLCBtZXNzYWdlKSB7DQogICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiAtIHdlIGNvdWxkIG1ha2UgaXQgbW9yZSBzb3BoaXN0aWNhdGVkDQogICAgLy8gRm9yIG5vdywgd2UnbGwgcmVseSBvbiB0aGUgbGluZSBudW1iZXIgaGlnaGxpZ2h0aW5nDQp9DQoNCi8vIENsZWFyIGFsbCBlcnJvciBtYXJrZXJzDQpmdW5jdGlvbiBjbGVhckVycm9yTWFya2VycygpIHsNCiAgICAvLyBDbGVhciBsaW5lIG51bWJlciBlcnJvciBjbGFzc2VzDQogICAgdGV4dEVkaXRvci5lcnJvck1hcmtlcnMuZm9yRWFjaChsaW5lRWwgPT4gew0KICAgICAgICBsaW5lRWwuY2xhc3NMaXN0LnJlbW92ZSgnbGluZS1lcnJvcicpOw0KICAgICAgICBsaW5lRWwucmVtb3ZlQXR0cmlidXRlKCd0aXRsZScpOw0KICAgIH0pOw0KICAgIA0KICAgIHRleHRFZGl0b3IuZXJyb3JNYXJrZXJzID0gW107DQogICAgdGV4dEVkaXRvci5jdXJyZW50RXJyb3JzID0gW107DQp9DQoNCi8vIFVwZGF0ZSBlcnJvciBjb3VudCBpbiBzdGF0dXMgYmFyDQpmdW5jdGlvbiB1cGRhdGVFcnJvckNvdW50KGNvdW50KSB7DQogICAgaWYgKGVycm9yQ291bnRFbCkgew0KICAgICAgICBlcnJvckNvdW50RWwudGV4dENvbnRlbnQgPSBjb3VudC50b1N0cmluZygpOw0KICAgICAgICBlcnJvckNvdW50RWwuc3R5bGUuY29sb3IgPSBjb3VudCA+IDAgPyAnI2ZmNmI2YicgOiAnIzUxY2Y2Nic7DQogICAgfQ0KfQ0KDQovLyA9PT09PSBJTlRFR1JBVEVEIFRFUk1JTkFMIEZVTkNUSU9OQUxJVFkgPT09PT0NCg0KLy8gVGVybWluYWwgdmFyaWFibGVzDQpsZXQgdGVybWluYWxUb2dnbGUsIGludGVncmF0ZWRUZXJtaW5hbCwgdGVybWluYWxPdXRwdXQsIHRlcm1pbmFsSW5wdXQsIHRlcm1pbmFsUmVzaXplOw0KbGV0IHRlcm1pbmFsSGlzdG9yeSA9IFtdOw0KbGV0IHRlcm1pbmFsSGlzdG9yeUluZGV4ID0gLTE7DQpsZXQgdGVybWluYWxTb2NrZXQgPSBudWxsOw0KDQovLyBJbml0aWFsaXplIHRlcm1pbmFsIGZ1bmN0aW9uYWxpdHkNCmZ1bmN0aW9uIGluaXRJbnRlZ3JhdGVkVGVybWluYWwoKSB7DQogICAgDQogICAgLy8gR2V0IHRlcm1pbmFsIERPTSBlbGVtZW50cw0KICAgIHRlcm1pbmFsVG9nZ2xlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlcm1pbmFsLXRvZ2dsZScpOw0KICAgIGludGVncmF0ZWRUZXJtaW5hbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnRlZ3JhdGVkLXRlcm1pbmFsJyk7DQogICAgdGVybWluYWxPdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVybWluYWxPdXRwdXQnKTsNCiAgICB0ZXJtaW5hbElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlcm1pbmFsSW5wdXQnKTsNCiAgICB0ZXJtaW5hbFJlc2l6ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZXJtaW5hbC1yZXNpemUnKTsNCiAgICANCiAgICBpZiAoIXRlcm1pbmFsVG9nZ2xlIHx8ICFpbnRlZ3JhdGVkVGVybWluYWwgfHwgIXRlcm1pbmFsT3V0cHV0IHx8ICF0ZXJtaW5hbElucHV0KSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Rlcm1pbmFsIGVsZW1lbnRzIG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIFNldCB1cCB0ZXJtaW5hbCBldmVudCBoYW5kbGVycw0KICAgIHNldHVwVGVybWluYWxFdmVudEhhbmRsZXJzKCk7DQogICAgDQogICAgLy8gQ29ubmVjdCB0byBXZWJTb2NrZXQgZm9yIHJlYWwtdGltZSBvdXRwdXQNCiAgICBjb25uZWN0VGVybWluYWxXZWJTb2NrZXQoKTsNCiAgICANCn0NCg0KLy8gU2V0IHVwIHRlcm1pbmFsIGV2ZW50IGhhbmRsZXJzDQpmdW5jdGlvbiBzZXR1cFRlcm1pbmFsRXZlbnRIYW5kbGVycygpIHsNCiAgICAvLyBUZXJtaW5hbCB0b2dnbGUgYnV0dG9uDQogICAgdGVybWluYWxUb2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVUZXJtaW5hbCk7DQogICAgDQogICAgLy8gVGVybWluYWwgaW5wdXQgaGFuZGxpbmcNCiAgICB0ZXJtaW5hbElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVUZXJtaW5hbEtleURvd24pOw0KICAgIA0KICAgIC8vIFRlcm1pbmFsIHJlc2l6ZSBmdW5jdGlvbmFsaXR5DQogICAgaWYgKHRlcm1pbmFsUmVzaXplKSB7DQogICAgICAgIHRlcm1pbmFsUmVzaXplLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHN0YXJ0VGVybWluYWxSZXNpemUpOw0KICAgIH0NCiAgICANCiAgICAvLyBNYWtlIHRlcm1pbmFsIG91dHB1dCBmb2N1c2FibGUgZm9yIGNvcHkvcGFzdGUNCiAgICB0ZXJtaW5hbE91dHB1dC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJzAnKTsNCiAgICB0ZXJtaW5hbE91dHB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlVGVybWluYWxPdXRwdXRLZXlEb3duKTsNCn0NCg0KLy8gVG9nZ2xlIHRlcm1pbmFsIHZpc2liaWxpdHkNCmFzeW5jIGZ1bmN0aW9uIHRvZ2dsZVRlcm1pbmFsKCkgew0KICAgIGNvbnN0IGlzVmlzaWJsZSA9ICFpbnRlZ3JhdGVkVGVybWluYWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKTsNCiAgICANCiAgICBpZiAoaXNWaXNpYmxlKSB7DQogICAgICAgIGludGVncmF0ZWRUZXJtaW5hbC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsNCiAgICAgICAgdGVybWluYWxUb2dnbGUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5zZXRTZXR0aW5nKCdURVJNSU5BTF9FTkFCTEVEJywgZmFsc2UpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignVGVybWluYWwgaGlkZGVuJywgJ2luZm8nKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBpbnRlZ3JhdGVkVGVybWluYWwuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7DQogICAgICAgIHRlcm1pbmFsVG9nZ2xlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkuc2V0U2V0dGluZygnVEVSTUlOQUxfRU5BQkxFRCcsIHRydWUpOw0KICAgICAgICB0ZXJtaW5hbElucHV0LmZvY3VzKCk7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdUZXJtaW5hbCBzaG93bicsICdpbmZvJyk7DQogICAgfQ0KfQ0KDQovLyBIYW5kbGUgdGVybWluYWwgaW5wdXQga2V5IGV2ZW50cw0KYXN5bmMgZnVuY3Rpb24gaGFuZGxlVGVybWluYWxLZXlEb3duKGUpIHsNCiAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBhd2FpdCBleGVjdXRlVGVybWluYWxDb21tYW5kKCk7DQogICAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ0Fycm93VXAnKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgbmF2aWdhdGVUZXJtaW5hbEhpc3RvcnkoLTEpOw0KICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09ICdBcnJvd0Rvd24nKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgbmF2aWdhdGVUZXJtaW5hbEhpc3RvcnkoMSk7DQogICAgfQ0KfQ0KDQovLyBFeGVjdXRlIHRlcm1pbmFsIGNvbW1hbmQNCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVUZXJtaW5hbENvbW1hbmQoKSB7DQogICAgY29uc3QgY29tbWFuZCA9IHRlcm1pbmFsSW5wdXQudmFsdWUudHJpbSgpOw0KICAgIGlmICghY29tbWFuZCkgcmV0dXJuOw0KICAgIA0KICAgIC8vIEFkZCBjb21tYW5kIHRvIG91dHB1dA0KICAgIGFwcGVuZFRlcm1pbmFsT3V0cHV0KGAkICR7Y29tbWFuZH1gLCAndGVybWluYWwtc3VjY2VzcycpOw0KICAgIA0KICAgIC8vIEFkZCB0byBoaXN0b3J5DQogICAgYWRkVG9UZXJtaW5hbEhpc3RvcnkoY29tbWFuZCk7DQogICAgDQogICAgLy8gQ2xlYXIgaW5wdXQNCiAgICB0ZXJtaW5hbElucHV0LnZhbHVlID0gJyc7DQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgLy8gRXhlY3V0ZSBjb21tYW5kIHZpYSBTeXBuZXhBUEkNCiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc3lwbmV4QVBJLmV4ZWN1dGVUZXJtaW5hbENvbW1hbmQoY29tbWFuZCk7DQogICAgICAgIA0KICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHsNCiAgICAgICAgICAgIGlmIChyZXN1bHQub3V0cHV0KSB7DQogICAgICAgICAgICAgICAgYXBwZW5kVGVybWluYWxPdXRwdXQocmVzdWx0Lm91dHB1dCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGFwcGVuZFRlcm1pbmFsT3V0cHV0KCdDb21tYW5kIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseSAobm8gb3V0cHV0KScsICd0ZXJtaW5hbC1pbmZvJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBhcHBlbmRUZXJtaW5hbE91dHB1dChgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsICd0ZXJtaW5hbC1lcnJvcicpOw0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgYXBwZW5kVGVybWluYWxPdXRwdXQoYEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCwgJ3Rlcm1pbmFsLWVycm9yJyk7DQogICAgfQ0KICAgIA0KICAgIC8vIEFkZCBlbXB0eSBsaW5lDQogICAgYXBwZW5kVGVybWluYWxPdXRwdXQoJycpOw0KICAgIA0KICAgIC8vIEZvY3VzIGlucHV0IGZvciBuZXh0IGNvbW1hbmQNCiAgICB0ZXJtaW5hbElucHV0LmZvY3VzKCk7DQp9DQoNCi8vIEFwcGVuZCBvdXRwdXQgdG8gdGVybWluYWwNCmZ1bmN0aW9uIGFwcGVuZFRlcm1pbmFsT3V0cHV0KHRleHQsIGNsYXNzTmFtZSA9ICcnKSB7DQogICAgY29uc3QgbGluZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIGxpbmUuY2xhc3NOYW1lID0gYHRlcm1pbmFsLWxpbmUgJHtjbGFzc05hbWV9YDsNCiAgICBsaW5lLnRleHRDb250ZW50ID0gdGV4dDsNCiAgICB0ZXJtaW5hbE91dHB1dC5hcHBlbmRDaGlsZChsaW5lKTsNCiAgICANCiAgICAvLyBTY3JvbGwgdG8gYm90dG9tDQogICAgdGVybWluYWxPdXRwdXQuc2Nyb2xsVG9wID0gdGVybWluYWxPdXRwdXQuc2Nyb2xsSGVpZ2h0Ow0KfQ0KDQovLyBBZGQgY29tbWFuZCB0byBoaXN0b3J5DQpmdW5jdGlvbiBhZGRUb1Rlcm1pbmFsSGlzdG9yeShjb21tYW5kKSB7DQogICAgLy8gRG9uJ3QgYWRkIGVtcHR5IGNvbW1hbmRzIG9yIGR1cGxpY2F0ZXMNCiAgICBpZiAoIWNvbW1hbmQudHJpbSgpIHx8ICh0ZXJtaW5hbEhpc3RvcnkubGVuZ3RoID4gMCAmJiB0ZXJtaW5hbEhpc3RvcnlbdGVybWluYWxIaXN0b3J5Lmxlbmd0aCAtIDFdID09PSBjb21tYW5kKSkgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIHRlcm1pbmFsSGlzdG9yeS5wdXNoKGNvbW1hbmQpOw0KICAgIHRlcm1pbmFsSGlzdG9yeUluZGV4ID0gdGVybWluYWxIaXN0b3J5Lmxlbmd0aDsNCiAgICANCiAgICAvLyBLZWVwIGhpc3Rvcnkgc2l6ZSByZWFzb25hYmxlDQogICAgaWYgKHRlcm1pbmFsSGlzdG9yeS5sZW5ndGggPiA1MCkgew0KICAgICAgICB0ZXJtaW5hbEhpc3Rvcnkuc2hpZnQoKTsNCiAgICAgICAgdGVybWluYWxIaXN0b3J5SW5kZXgtLTsNCiAgICB9DQp9DQoNCi8vIE5hdmlnYXRlIHRlcm1pbmFsIGhpc3RvcnkNCmZ1bmN0aW9uIG5hdmlnYXRlVGVybWluYWxIaXN0b3J5KGRpcmVjdGlvbikgew0KICAgIGlmICh0ZXJtaW5hbEhpc3RvcnkubGVuZ3RoID09PSAwKSByZXR1cm47DQogICAgDQogICAgaWYgKGRpcmVjdGlvbiA9PT0gLTEpIHsNCiAgICAgICAgLy8gR28gdXAgaW4gaGlzdG9yeQ0KICAgICAgICBpZiAodGVybWluYWxIaXN0b3J5SW5kZXggPiAwKSB7DQogICAgICAgICAgICB0ZXJtaW5hbEhpc3RvcnlJbmRleC0tOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gR28gZG93biBpbiBoaXN0b3J5DQogICAgICAgIGlmICh0ZXJtaW5hbEhpc3RvcnlJbmRleCA8IHRlcm1pbmFsSGlzdG9yeS5sZW5ndGggLSAxKSB7DQogICAgICAgICAgICB0ZXJtaW5hbEhpc3RvcnlJbmRleCsrOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGVybWluYWxIaXN0b3J5SW5kZXggPSB0ZXJtaW5hbEhpc3RvcnkubGVuZ3RoOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGlmICh0ZXJtaW5hbEhpc3RvcnlJbmRleCA+PSAwICYmIHRlcm1pbmFsSGlzdG9yeUluZGV4IDwgdGVybWluYWxIaXN0b3J5Lmxlbmd0aCkgew0KICAgICAgICB0ZXJtaW5hbElucHV0LnZhbHVlID0gdGVybWluYWxIaXN0b3J5W3Rlcm1pbmFsSGlzdG9yeUluZGV4XTsNCiAgICB9IGVsc2Ugew0KICAgICAgICB0ZXJtaW5hbElucHV0LnZhbHVlID0gJyc7DQogICAgfQ0KICAgIA0KICAgIC8vIE1vdmUgY3Vyc29yIHRvIGVuZA0KICAgIHRlcm1pbmFsSW5wdXQuc2V0U2VsZWN0aW9uUmFuZ2UodGVybWluYWxJbnB1dC52YWx1ZS5sZW5ndGgsIHRlcm1pbmFsSW5wdXQudmFsdWUubGVuZ3RoKTsNCn0NCg0KLy8gSGFuZGxlIHRlcm1pbmFsIG91dHB1dCBrZXlib2FyZCBzaG9ydGN1dHMNCmZ1bmN0aW9uIGhhbmRsZVRlcm1pbmFsT3V0cHV0S2V5RG93bihlKSB7DQogICAgaWYgKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpIHsNCiAgICAgICAgaWYgKGUua2V5ID09PSAnYycpIHsNCiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTsNCiAgICAgICAgICAgIGlmIChzZWxlY3Rpb24udG9TdHJpbmcoKSkgew0KICAgICAgICAgICAgICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHNlbGVjdGlvbi50b1N0cmluZygpKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy8gQ29weSBhbGwgdGVybWluYWwgb3V0cHV0IGlmIG5vdGhpbmcgaXMgc2VsZWN0ZWQNCiAgICAgICAgICAgICAgICBjb25zdCBhbGxUZXh0ID0gdGVybWluYWxPdXRwdXQuaW5uZXJUZXh0IHx8IHRlcm1pbmFsT3V0cHV0LnRleHRDb250ZW50Ow0KICAgICAgICAgICAgICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGFsbFRleHQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnYScpIHsNCiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTsNCiAgICAgICAgICAgIHJhbmdlLnNlbGVjdE5vZGVDb250ZW50cyh0ZXJtaW5hbE91dHB1dCk7DQogICAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7DQogICAgICAgICAgICBzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7DQogICAgICAgICAgICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBDb25uZWN0IHRvIFdlYlNvY2tldCBmb3IgcmVhbC10aW1lIHRlcm1pbmFsIG91dHB1dA0KYXN5bmMgZnVuY3Rpb24gY29ubmVjdFRlcm1pbmFsV2ViU29ja2V0KCkgew0KICAgIHRyeSB7DQogICAgICAgIC8vIENvbm5lY3QgdG8gV2ViU29ja2V0DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5jb25uZWN0U29ja2V0KCk7DQogICAgICAgIA0KICAgICAgICAvLyBKb2luIHRlcm1pbmFsIHJvb20NCiAgICAgICAgc3lwbmV4QVBJLmpvaW5Sb29tKCd0ZXJtaW5hbCcpOw0KICAgICAgICANCiAgICAgICAgLy8gTGlzdGVuIGZvciB0ZXJtaW5hbCBvdXRwdXQNCiAgICAgICAgc3lwbmV4QVBJLm9uKCd0ZXJtaW5hbF9vdXRwdXQnLCAoZGF0YSkgPT4gew0KICAgICAgICAgICAgaGFuZGxlVGVybWluYWxXZWJTb2NrZXRPdXRwdXQoZGF0YSk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY29ubmVjdCB0ZXJtaW5hbCBXZWJTb2NrZXQ6JywgZXJyb3IpOw0KICAgIH0NCn0NCg0KLy8gSGFuZGxlIFdlYlNvY2tldCB0ZXJtaW5hbCBvdXRwdXQNCmZ1bmN0aW9uIGhhbmRsZVRlcm1pbmFsV2ViU29ja2V0T3V0cHV0KGRhdGEpIHsNCiAgICBjb25zdCB7IG91dHB1dCwgdHlwZSB9ID0gZGF0YTsNCiAgICANCiAgICAvLyBEZXRlcm1pbmUgb3V0cHV0IGNsYXNzIGJhc2VkIG9uIHR5cGUNCiAgICBsZXQgY2xhc3NOYW1lID0gJyc7DQogICAgaWYgKHR5cGUgPT09ICdzdGRlcnInKSB7DQogICAgICAgIGNsYXNzTmFtZSA9ICd0ZXJtaW5hbC1lcnJvcic7DQogICAgfSBlbHNlIGlmICh0eXBlID09PSAnY29tcGxldGlvbicpIHsNCiAgICAgICAgY2xhc3NOYW1lID0gJ3Rlcm1pbmFsLWluZm8nOw0KICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2Vycm9yJykgew0KICAgICAgICBjbGFzc05hbWUgPSAndGVybWluYWwtZXJyb3InOw0KICAgIH0NCiAgICANCiAgICAvLyBBcHBlbmQgdGhlIG91dHB1dA0KICAgIGFwcGVuZFRlcm1pbmFsT3V0cHV0KG91dHB1dCwgY2xhc3NOYW1lKTsNCn0NCg0KLy8gVGVybWluYWwgcmVzaXplIGZ1bmN0aW9uYWxpdHkNCmZ1bmN0aW9uIHN0YXJ0VGVybWluYWxSZXNpemUoZSkgew0KICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICANCiAgICBjb25zdCBzdGFydFkgPSBlLmNsaWVudFk7DQogICAgY29uc3Qgc3RhcnRIZWlnaHQgPSBpbnRlZ3JhdGVkVGVybWluYWwub2Zmc2V0SGVpZ2h0Ow0KICAgIA0KICAgIGZ1bmN0aW9uIG9uTW91c2VNb3ZlKGUpIHsNCiAgICAgICAgY29uc3QgZGVsdGFZID0gZS5jbGllbnRZIC0gc3RhcnRZOw0KICAgICAgICBjb25zdCBuZXdIZWlnaHQgPSBNYXRoLm1heCgyMDAsIE1hdGgubWluKDYwMCwgc3RhcnRIZWlnaHQgKyBkZWx0YVkpKTsNCiAgICAgICAgaW50ZWdyYXRlZFRlcm1pbmFsLnN0eWxlLmhlaWdodCA9IG5ld0hlaWdodCArICdweCc7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIG9uTW91c2VVcCgpIHsNCiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUpOw0KICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgb25Nb3VzZVVwKTsNCiAgICB9DQogICAgDQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUpOw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBvbk1vdXNlVXApOw0KfQ0KDQovLyBJbml0aWFsaXplIHRlcm1pbmFsIHdoZW4gdGV4dCBlZGl0b3IgaXMgcmVhZHkNCmZ1bmN0aW9uIGluaXRUZXh0RWRpdG9yV2l0aFRlcm1pbmFsKCkgew0KICAgIGluaXRUZXh0RWRpdG9yKCk7DQogICAgaW5pdEludGVncmF0ZWRUZXJtaW5hbCgpOw0KfQ0KDQovLyBTZXQgdXAgZXZlbnQgaGFuZGxlcnMNCmZ1bmN0aW9uIHNldHVwRXZlbnRIYW5kbGVycygpIHsNCiAgICAvLyBCdXR0b24gZXZlbnRzDQogICAgbmV3RmlsZUJ0bj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjcmVhdGVOZXdGaWxlKTsNCiAgICBsb2FkRmlsZUJ0bj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBsb2FkRmlsZSk7DQogICAgc2F2ZUZpbGVCdG4/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2F2ZUZpbGUpOw0KICAgIHNhdmVBc0ZpbGVCdG4/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2F2ZUFzRmlsZSk7DQogICAgd29yZFdyYXBUb2dnbGU/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlV29yZFdyYXApOw0KICAgIGxpbmVOdW1iZXJzVG9nZ2xlPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZUxpbmVOdW1iZXJzKTsNCiAgICBzeW50YXhIaWdobGlnaHRpbmdUb2dnbGU/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlU3ludGF4SGlnaGxpZ2h0aW5nKTsNCiAgICB2YWxpZGF0aW9uVG9nZ2xlPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVZhbGlkYXRpb24pOw0KICAgIA0KICAgIC8vIFRleHRhcmVhIGV2ZW50cw0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBoYW5kbGVUZXh0Q2hhbmdlKTsNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHN5bmNTY3JvbGwpOw0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUtleURvd24pOw0KICAgIA0KDQogICAgDQogICAgLy8gV2luZG93IGV2ZW50cw0KICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCBoYW5kbGVCZWZvcmVVbmxvYWQpOw0KfQ0KDQoNCg0KLy8gSGFuZGxlIGtleWJvYXJkIHNob3J0Y3V0cw0KZnVuY3Rpb24gaGFuZGxlS2V5RG93bihlKSB7DQogICAgLy8gQ3RybC9DbWQgKyBTOiBTYXZlDQogICAgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJ3MnICYmICFlLnNoaWZ0S2V5KSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgc2F2ZUZpbGUoKTsNCiAgICB9DQogICAgDQogICAgLy8gQ3RybC9DbWQgKyBTaGlmdCArIFM6IFNhdmUgQXMNCiAgICBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS5rZXkgPT09ICdTJykgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHNhdmVBc0ZpbGUoKTsNCiAgICB9DQogICAgDQogICAgLy8gQ3RybC9DbWQgKyBOOiBOZXcgZmlsZQ0KICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkgPT09ICduJykgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGNyZWF0ZU5ld0ZpbGUoKTsNCiAgICB9DQogICAgDQogICAgLy8gQ3RybC9DbWQgKyBPOiBMb2FkIGZpbGUNCiAgICBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5ID09PSAnbycpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBsb2FkRmlsZSgpOw0KICAgIH0NCiAgICANCiAgICAvLyBDdHJsL0NtZCArIFNoaWZ0ICsgVjogRm9yY2UgdmFsaWRhdGlvbg0KICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLmtleSA9PT0gJ1YnKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgaWYgKGlzUHl0aG9uRmlsZSh0ZXh0RWRpdG9yLmZpbGVQYXRoKSkgew0KICAgICAgICAgICAgc2NoZWR1bGVWYWxpZGF0aW9uKCk7DQogICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignVmFsaWRhdGlvbiB0cmlnZ2VyZWQgbWFudWFsbHknLCAnaW5mbycpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ05vdCBhIFB5dGhvbiBmaWxlJywgJ3dhcm5pbmcnKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBUYWIgaGFuZGxpbmcNCiAgICBpZiAoZS5rZXkgPT09ICdUYWInKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgY29uc3Qgc3RhcnQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnNlbGVjdGlvblN0YXJ0Ow0KICAgICAgICBjb25zdCBlbmQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnNlbGVjdGlvbkVuZDsNCiAgICAgICAgY29uc3Qgc3BhY2VzID0gJyAnLnJlcGVhdCh0ZXh0RWRpdG9yLnNldHRpbmdzLnRhYlNpemUpOw0KICAgICAgICANCiAgICAgICAgdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZSA9IA0KICAgICAgICAgICAgdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZS5zdWJzdHJpbmcoMCwgc3RhcnQpICsgDQogICAgICAgICAgICBzcGFjZXMgKyANCiAgICAgICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUuc3Vic3RyaW5nKGVuZCk7DQogICAgICAgIA0KICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnNlbGVjdGlvblN0YXJ0ID0gdGV4dEVkaXRvci50ZXh0YXJlYS5zZWxlY3Rpb25FbmQgPSBzdGFydCArIHNwYWNlcy5sZW5ndGg7DQogICAgICAgIA0KICAgICAgICAvLyBNYW51YWxseSB0cmlnZ2VyIGNvbnRlbnQgdXBkYXRlIHNpbmNlIHdlIHByZXZlbnRlZCB0aGUgZGVmYXVsdA0KICAgICAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgICAgICBtYXJrQXNNb2RpZmllZCgpOw0KICAgICAgICBpZiAodGV4dEVkaXRvci5zeW50YXhIaWdobGlnaHRpbmdFbmFibGVkKSB7DQogICAgICAgICAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICAgICAgfQ0KICAgICAgICBzY2hlZHVsZVZhbGlkYXRpb24oKTsNCiAgICB9DQp9DQoNCg0KLy8gVG9nZ2xlIHdvcmQgd3JhcA0KZnVuY3Rpb24gdG9nZ2xlV29yZFdyYXAoKSB7DQogICAgdGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQgPSAhdGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQ7DQogICAgdGV4dEVkaXRvci50ZXh0YXJlYS5jbGFzc0xpc3QudG9nZ2xlKCd3b3JkLXdyYXAnLCB0ZXh0RWRpdG9yLndvcmRXcmFwRW5hYmxlZCk7DQogICAgDQogICAgLy8gVXBkYXRlIGhpZ2hsaWdodGVkIGVkaXRvciBpZiBpdCBleGlzdHMNCiAgICBpZiAodGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yLnN0eWxlLndvcmRXcmFwID0gdGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQgPyAnYnJlYWstd29yZCcgOiAnbm9ybWFsJzsNCiAgICB9DQogICAgDQogICAgaWYgKHdvcmRXcmFwVG9nZ2xlKSB7DQogICAgICAgIHdvcmRXcmFwVG9nZ2xlLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIHRleHRFZGl0b3Iud29yZFdyYXBFbmFibGVkKTsNCiAgICB9DQogICAgDQogICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oDQogICAgICAgIGBXb3JkIHdyYXAgJHt0ZXh0RWRpdG9yLndvcmRXcmFwRW5hYmxlZCA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCd9YCwNCiAgICAgICAgJ2luZm8nDQogICAgKTsNCn0NCg0KLy8gVG9nZ2xlIGxpbmUgbnVtYmVycw0KZnVuY3Rpb24gdG9nZ2xlTGluZU51bWJlcnMoKSB7DQogICAgdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQgPSAhdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQ7DQogICAgdGV4dEVkaXRvci5saW5lTnVtYmVycy5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nLCAhdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQpOw0KICAgIA0KICAgIGlmIChsaW5lTnVtYmVyc1RvZ2dsZSkgew0KICAgICAgICBsaW5lTnVtYmVyc1RvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzRW5hYmxlZCk7DQogICAgfQ0KICAgIA0KICAgIGlmICh0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzRW5hYmxlZCkgew0KICAgICAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgIH0NCiAgICANCiAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbigNCiAgICAgICAgYExpbmUgbnVtYmVycyAke3RleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJ31gLA0KICAgICAgICAnaW5mbycNCiAgICApOw0KfQ0KDQoNCi8vIFRvZ2dsZSBjb2RlIHZhbGlkYXRpb24NCmFzeW5jIGZ1bmN0aW9uIHRvZ2dsZVZhbGlkYXRpb24oKSB7DQogICAgdGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZCA9ICF0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkOw0KICAgIA0KICAgIC8vIFNhdmUgc2V0dGluZw0KICAgIHRyeSB7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5zZXRTZXR0aW5nKCdDT0RFX1ZBTElEQVRJT04nLCB0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkKTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSB2YWxpZGF0aW9uIHNldHRpbmc6JywgZXJyb3IpOw0KICAgIH0NCiAgICANCiAgICAvLyBVcGRhdGUgVUkNCiAgICBpZiAodmFsaWRhdGlvblRvZ2dsZSkgew0KICAgICAgICB2YWxpZGF0aW9uVG9nZ2xlLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIHRleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQpOw0KICAgIH0NCiAgICANCiAgICAvLyBBcHBseSB2YWxpZGF0aW9uIGlmIGVuYWJsZWQsIG90aGVyd2lzZSBjbGVhciBlcnJvcnMNCiAgICBpZiAodGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZCkgew0KICAgICAgICBzY2hlZHVsZVZhbGlkYXRpb24oKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBjbGVhckVycm9yTWFya2VycygpOw0KICAgICAgICB1cGRhdGVFcnJvckNvdW50KDApOw0KICAgIH0NCiAgICANCiAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbigNCiAgICAgICAgYENvZGUgdmFsaWRhdGlvbiAke3RleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWAsDQogICAgICAgICdpbmZvJw0KICAgICk7DQp9DQoNCg0KLy8gSGFuZGxlIGJlZm9yZSB1bmxvYWQNCmZ1bmN0aW9uIGhhbmRsZUJlZm9yZVVubG9hZChlKSB7DQogICAgaWYgKHRleHRFZGl0b3IuaXNNb2RpZmllZCkgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGUucmV0dXJuVmFsdWUgPSAnWW91IGhhdmUgdW5zYXZlZCBjaGFuZ2VzLiBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gbGVhdmU/JzsNCiAgICAgICAgcmV0dXJuIGUucmV0dXJuVmFsdWU7DQogICAgfQ0KfQ0KDQoNCi8vIFRleHQgRWRpdG9yIEFwcA0KDQovLyBHbG9iYWwgdmFyaWFibGVzDQpsZXQgdGV4dEVkaXRvciA9IHsNCiAgICB0ZXh0YXJlYTogbnVsbCwNCiAgICBsaW5lTnVtYmVyczogbnVsbCwNCiAgICBmaWxlUGF0aDogbnVsbCwNCiAgICBvcmlnaW5hbENvbnRlbnQ6ICcnLA0KICAgIGlzTW9kaWZpZWQ6IGZhbHNlLA0KICAgIGF1dG9TYXZlSW50ZXJ2YWw6IG51bGwsDQogICAgd29yZFdyYXBFbmFibGVkOiBmYWxzZSwNCiAgICBsaW5lTnVtYmVyc0VuYWJsZWQ6IHRydWUsDQogICAgc2V0dGluZ3M6IHt9LA0KICAgIC8vIFN5bnRheCBoaWdobGlnaHRpbmcNCiAgICBwcmlzbUxvYWRlZDogZmFsc2UsDQogICAgc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZDogZmFsc2UsDQogICAgaGlnaGxpZ2h0ZWRFZGl0b3I6IG51bGwsDQogICAgaGlnaGxpZ2h0Q29udGFpbmVyOiBudWxsLA0KICAgIG9yaWdpbmFsVGV4dGFyZWFTdHlsZXM6IG51bGwsDQogICAgZGVib3VuY2VUaW1lcjogbnVsbCwNCiAgICAvLyBDdXJzb3IgcG9zaXRpb24gdHJhY2tpbmcNCiAgICBjdXJzb3JQb3NpdGlvbjogMCwNCiAgICAvLyBDb2RlIHZhbGlkYXRpb24NCiAgICBweW9kaWRlTG9hZGVkOiBmYWxzZSwNCiAgICB2YWxpZGF0aW9uRW5hYmxlZDogdHJ1ZSwNCiAgICB2YWxpZGF0aW9uRGVib3VuY2VUaW1lcjogbnVsbCwNCiAgICBjdXJyZW50RXJyb3JzOiBbXSwNCiAgICBlcnJvck1hcmtlcnM6IFtdDQp9Ow0KDQovLyBET00gZWxlbWVudHMNCmxldCBuZXdGaWxlQnRuLCBsb2FkRmlsZUJ0biwgc2F2ZUZpbGVCdG4sIHNhdmVBc0ZpbGVCdG47DQpsZXQgY3VycmVudEZpbGVuYW1lRWwsIHdvcmRXcmFwVG9nZ2xlLCBsaW5lTnVtYmVyc1RvZ2dsZSwgc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlLCB2YWxpZGF0aW9uVG9nZ2xlOw0KbGV0IG1vZGlmaWVkU3RhdHVzRWwsIGVycm9yQ291bnRFbDsNCg0KLy8gSW5pdGlhbGl6ZSB3aGVuIERPTSBpcyByZWFkeQ0KZnVuY3Rpb24gaW5pdFRleHRFZGl0b3IoKSB7DQogICAgDQogICAgLy8gQ2hlY2sgaWYgU3lwbmV4QVBJIGlzIGF2YWlsYWJsZQ0KICAgIGlmICh0eXBlb2Ygc3lwbmV4QVBJID09PSAndW5kZWZpbmVkJyB8fCAhc3lwbmV4QVBJKSB7DQogICAgICAgIGNvbnNvbGUud2FybignU3lwbmV4QVBJIG5vdCBhdmFpbGFibGUgLSBydW5uaW5nIGluIHN0YW5kYWxvbmUgbW9kZScpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgDQogICAgLy8gVGVzdCBpZiBhcHAgY29udGFpbmVyIGV4aXN0cw0KICAgIGNvbnN0IGFwcENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcHAtY29udGFpbmVyJyk7DQogICAgaWYgKGFwcENvbnRhaW5lcikgew0KICAgIH0NCiAgICANCiAgICAvLyBHZXQgRE9NIGVsZW1lbnRzDQogICAgdGV4dEVkaXRvci50ZXh0YXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZXh0LWVkaXRvcicpOw0KICAgIHRleHRFZGl0b3IubGluZU51bWJlcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluZS1udW1iZXJzJyk7DQogICAgDQogICAgbmV3RmlsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXctZmlsZScpOw0KICAgIGxvYWRGaWxlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWQtZmlsZScpOw0KICAgIHNhdmVGaWxlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmUtZmlsZScpOw0KICAgIHNhdmVBc0ZpbGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZS1hcy1maWxlJyk7DQogICAgY3VycmVudEZpbGVuYW1lRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VycmVudC1maWxlbmFtZScpOw0KICAgIHdvcmRXcmFwVG9nZ2xlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dvcmQtd3JhcC10b2dnbGUnKTsNCiAgICBsaW5lTnVtYmVyc1RvZ2dsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5lLW51bWJlcnMtdG9nZ2xlJyk7DQogICAgc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N5bnRheC1oaWdobGlnaHRpbmctdG9nZ2xlJyk7DQogICAgdmFsaWRhdGlvblRvZ2dsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2YWxpZGF0aW9uLXRvZ2dsZScpOw0KICAgIA0KICAgIG1vZGlmaWVkU3RhdHVzRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kaWZpZWQtc3RhdHVzJyk7DQogICAgZXJyb3JDb3VudEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yLWNvdW50Jyk7DQogICAgDQogICAgLy8gQ3JpdGljYWwgZWxlbWVudCBjaGVja3MNCiAgICBpZiAoIXRleHRFZGl0b3IudGV4dGFyZWEpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVGV4dCBlZGl0b3IgdGV4dGFyZWEgbm90IGZvdW5kJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgaWYgKCF0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0xpbmUgbnVtYmVycyBlbGVtZW50IG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIA0KICAgIC8vIExvYWQgc2V0dGluZ3MNCiAgICBsb2FkU2V0dGluZ3MoKTsNCiAgICANCiAgICAvLyBMb2FkIHRlcm1pbmFsIHN0YXRlDQogICAgbG9hZFRlcm1pbmFsU3RhdGUoKTsNCiAgICANCiAgICAvLyBTZXQgdXAgZXZlbnQgaGFuZGxlcnMNCiAgICBzZXR1cEV2ZW50SGFuZGxlcnMoKTsNCiAgICANCiAgICAvLyBJbml0aWFsaXplIGVkaXRvciBzdGF0ZQ0KICAgIGluaXRpYWxpemVFZGl0b3IoKTsNCiAgICANCiAgICAvLyBTZXQgaW5pdGlhbCBidXR0b24gc3RhdGVzDQogICAgaWYgKHN5bnRheEhpZ2hsaWdodGluZ1RvZ2dsZSkgew0KICAgICAgICBzeW50YXhIaWdobGlnaHRpbmdUb2dnbGUuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywgdGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmcpOw0KICAgIH0NCiAgICBpZiAodmFsaWRhdGlvblRvZ2dsZSkgew0KICAgICAgICB2YWxpZGF0aW9uVG9nZ2xlLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIHRleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQpOw0KICAgIH0NCiAgICANCiAgICAvLyBUZXh0IEVkaXRvciBsb2FkZWQgc3VjY2Vzc2Z1bGx5IChubyBub3RpZmljYXRpb24gbmVlZGVkKQ0KICAgIA0KfQ0KDQoNCg0KDQoNCg0KLy8gUmVwbGFjZSB0aGUgb3JpZ2luYWwgaW5pdFRleHRFZGl0b3IgY2FsbA0KaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdsb2FkaW5nJykgew0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBpbml0VGV4dEVkaXRvcldpdGhUZXJtaW5hbCk7DQp9IGVsc2Ugew0KICAgIC8vIERPTSBpcyBhbHJlYWR5IGxvYWRlZA0KICAgIGluaXRUZXh0RWRpdG9yV2l0aFRlcm1pbmFsKCk7DQp9IDwvc2NyaXB0Pg=="
  },
  "package_info": {
    "format_version": "1.0",
    "created_at": "2025-07-24T00:56:24.401744",
    "packaged_by": "Sypnex OS App Packager",
    "source_directory": ".\\text_editor"
  }
}