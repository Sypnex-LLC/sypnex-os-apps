{
  "app_metadata": {
    "id": "text_editor",
    "name": "Text Editor",
    "description": "A simple text editor for creating and editing text files in the virtual file system",
    "icon": "fas fa-edit",
    "keywords": [
      "text_editor",
      "editor",
      "file",
      "edit",
      "write"
    ],
    "author": "Sypnex OS",
    "version": "1.0.7",
    "type": "user_app",
    "scripts": [
      "js/utils.js",
      "js/settings-manager.js",
      "js/file-manager.js",
      "js/editor-manager.js",
      "js/syntax-highlighting.js",
      "js/code-validation.js",
      "js/ui-manager.js",
      "js/main.js"
    ],
    "settings": [
      {
        "key": "AUTO_SAVE_INTERVAL",
        "name": "Auto Save Interval (s)",
        "type": "number",
        "value": 30,
        "description": "Auto save content every N seconds (0 = disabled)"
      },
      {
        "key": "FONT_SIZE",
        "name": "Font Size",
        "type": "number",
        "value": 14,
        "description": "Text editor font size in pixels"
      },
      {
        "key": "TAB_SIZE",
        "name": "Tab Size",
        "type": "number",
        "value": 4,
        "description": "Number of spaces for tab indentation"
      }
    ]
  },
  "files": {
    "text_editor.app": "ew0KICAgICJpZCI6ICJ0ZXh0X2VkaXRvciIsDQogICAgIm5hbWUiOiAiVGV4dCBFZGl0b3IiLA0KICAgICJkZXNjcmlwdGlvbiI6ICJBIHNpbXBsZSB0ZXh0IGVkaXRvciBmb3IgY3JlYXRpbmcgYW5kIGVkaXRpbmcgdGV4dCBmaWxlcyBpbiB0aGUgdmlydHVhbCBmaWxlIHN5c3RlbSIsDQogICAgImljb24iOiAiZmFzIGZhLWVkaXQiLA0KICAgICJrZXl3b3JkcyI6IFsidGV4dF9lZGl0b3IiLCAiZWRpdG9yIiwgImZpbGUiLCAiZWRpdCIsICJ3cml0ZSJdLA0KICAgICJhdXRob3IiOiAiU3lwbmV4IE9TIiwNCiAgICAidmVyc2lvbiI6ICIxLjAuNyIsDQogICAgInR5cGUiOiAidXNlcl9hcHAiLA0KICAgICJzY3JpcHRzIjogWw0KICAgICAgICAianMvdXRpbHMuanMiLA0KICAgICAgICAianMvc2V0dGluZ3MtbWFuYWdlci5qcyIsDQogICAgICAgICJqcy9maWxlLW1hbmFnZXIuanMiLA0KICAgICAgICAianMvZWRpdG9yLW1hbmFnZXIuanMiLA0KICAgICAgICAianMvc3ludGF4LWhpZ2hsaWdodGluZy5qcyIsDQogICAgICAgICJqcy9jb2RlLXZhbGlkYXRpb24uanMiLCANCiAgICAgICAgImpzL3VpLW1hbmFnZXIuanMiLA0KICAgICAgICAianMvbWFpbi5qcyINCiAgICBdLA0KICAgICJzZXR0aW5ncyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICAgImtleSI6ICJBVVRPX1NBVkVfSU5URVJWQUwiLA0KICAgICAgICAgICAgIm5hbWUiOiAiQXV0byBTYXZlIEludGVydmFsIChzKSIsDQogICAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICAgInZhbHVlIjogMzAsDQogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiQXV0byBzYXZlIGNvbnRlbnQgZXZlcnkgTiBzZWNvbmRzICgwID0gZGlzYWJsZWQpIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAia2V5IjogIkZPTlRfU0laRSIsDQogICAgICAgICAgICAibmFtZSI6ICJGb250IFNpemUiLA0KICAgICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAgICJ2YWx1ZSI6IDE0LA0KICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlRleHQgZWRpdG9yIGZvbnQgc2l6ZSBpbiBwaXhlbHMiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJrZXkiOiAiVEFCX1NJWkUiLA0KICAgICAgICAgICAgIm5hbWUiOiAiVGFiIFNpemUiLA0KICAgICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAgICJ2YWx1ZSI6IDQsDQogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIHNwYWNlcyBmb3IgdGFiIGluZGVudGF0aW9uIg0KICAgICAgICB9DQogICAgXQ0KfSA=",
    "text_editor.html": "PGRpdiBjbGFzcz0iYXBwLWNvbnRhaW5lciI+DQogICAgPGRpdiBjbGFzcz0iYXBwLWNvbnRlbnQiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtdG9vbGJhciI+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtYnRuLWdyb3VwIj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJuZXctZmlsZSIgY2xhc3M9ImFwcC1idG4gcHJpbWFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZmlsZSI+PC9pPiBOZXcNCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJsb2FkLWZpbGUiIGNsYXNzPSJhcHAtYnRuIHNlY29uZGFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZm9sZGVyLW9wZW4iPjwvaT4gTG9hZA0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InNhdmUtZmlsZSIgY2xhc3M9ImFwcC1idG4gcHJpbWFyeSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2F2ZSI+PC9pPiBTYXZlDQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ic2F2ZS1hcy1maWxlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXNhdmUiPjwvaT4gU2F2ZSBBcw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICANCg0KICAgICAgICAgICAgDQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJhcHAtYnRuLWdyb3VwIj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ3b3JkLXdyYXAtdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRleHQtd2lkdGgiPjwvaT4gV29yZCBXcmFwDQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ibGluZS1udW1iZXJzLXRvZ2dsZSIgY2xhc3M9ImFwcC1idG4gc2Vjb25kYXJ5Ij4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1saXN0LW9sIj48L2k+IExpbmUgTnVtYmVycw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InN5bnRheC1oaWdobGlnaHRpbmctdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWNvZGUiPjwvaT4gU3ludGF4IEhpZ2hsaWdodGluZw0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InZhbGlkYXRpb24tdG9nZ2xlIiBjbGFzcz0iYXBwLWJ0biBzZWNvbmRhcnkiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWNoZWNrLWNpcmNsZSI+PC9pPiBDb2RlIFZhbGlkYXRpb24NCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCg0KICAgICAgICA8ZGl2IGNsYXNzPSJlZGl0b3ItY29udGFpbmVyIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImVkaXRvci13cmFwcGVyIj4NCiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJsaW5lLW51bWJlcnMiIGNsYXNzPSJsaW5lLW51bWJlcnMiPjwvZGl2Pg0KICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBpZD0idGV4dC1lZGl0b3IiIGNsYXNzPSJhcHAtdGV4dGFyZWEiIHBsYWNlaG9sZGVyPSJTdGFydCB0eXBpbmcgeW91ciB0ZXh0IGhlcmUuLi4iPjwvdGV4dGFyZWE+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgPGRpdiBjbGFzcz0iZWRpdG9yLXN0YXR1cyI+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0dXMtbGVmdCI+DQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InN0YXR1cy1pdGVtIj5GaWxlOiA8c3BhbiBpZD0iY3VycmVudC1maWxlbmFtZSI+dW50aXRsZWQudHh0PC9zcGFuPjwvc3Bhbj4NCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3RhdHVzLWl0ZW0iPk1vZGlmaWVkOiA8c3BhbiBpZD0ibW9kaWZpZWQtc3RhdHVzIj5Obzwvc3Bhbj48L3NwYW4+DQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InN0YXR1cy1pdGVtIj5FcnJvcnM6IDxzcGFuIGlkPSJlcnJvci1jb3VudCI+MDwvc3Bhbj48L3NwYW4+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQo8L2Rpdj4gDQo8c3R5bGU+LyogPT09PT0gU3R5bGU6IHN0eWxlLmNzcyA9PT09PSAqLw0KLyogVGV4dCBFZGl0b3IgQXBwIFN0eWxlcyAqLw0KDQovKiBBcHAgQ29udGFpbmVyICovDQouYXBwLWNvbnRhaW5lciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGhlaWdodDogMTAwJTsNCiAgICBtaW4taGVpZ2h0OiAwOw0KfQ0KDQouYXBwLWNvbnRlbnQgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBmbGV4OiAxOw0KICAgIG1pbi1oZWlnaHQ6IDA7DQp9DQoNCi8qIEVkaXRvciBDb250YWluZXIgKi8NCi5lZGl0b3ItY29udGFpbmVyIHsNCiAgICBmbGV4OiAxOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgbWFyZ2luOiAxNXB4IDA7DQogICAgbWluLWhlaWdodDogMjAwcHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KfQ0KDQouZWRpdG9yLXdyYXBwZXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleDogMTsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgaGVpZ2h0OiAxMDAlOw0KfQ0KDQovKiBMaW5lIE51bWJlcnMgKi8NCi5saW5lLW51bWJlcnMgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIHBhZGRpbmc6IDEwcHggOHB4Ow0KICAgIGZvbnQtZmFtaWx5OiAnU0YgTW9ubycsIE1vbmFjbywgJ0Nhc2NhZGlhIENvZGUnLCBtb25vc3BhY2U7DQogICAgZm9udC1zaXplOiAxNHB4OyAvKiBNYXRjaCBlZGl0b3IgZm9udCBzaXplICovDQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtYWxpZ246IHJpZ2h0Ow0KICAgIG1pbi13aWR0aDogNTBweDsNCiAgICB1c2VyLXNlbGVjdDogbm9uZTsNCiAgICBvdmVyZmxvdy15OiBoaWRkZW47DQogICAgbGluZS1oZWlnaHQ6IDEuNjsgLyogTWF0Y2ggZWRpdG9yIGxpbmUgaGVpZ2h0ICovDQogICAgZmxleC1zaHJpbms6IDA7DQp9DQoNCi5saW5lLW51bWJlcnMuaGlkZGVuIHsNCiAgICBkaXNwbGF5OiBub25lOw0KfQ0KDQoubGluZS1udW1iZXIgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgIHBhZGRpbmc6IDAgNHB4Ow0KfQ0KDQovKiBUZXh0IEVkaXRvciAqLw0KI3RleHQtZWRpdG9yIHsNCiAgICBmbGV4OiAxOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpOw0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsNCiAgICBmb250LWZhbWlseTogJ1NGIE1vbm8nLCBNb25hY28sICdDYXNjYWRpYSBDb2RlJywgbW9ub3NwYWNlOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBsaW5lLWhlaWdodDogMS42Ow0KICAgIHBhZGRpbmc6IDEwcHggMTVweDsNCiAgICByZXNpemU6IG5vbmU7DQogICAgb3V0bGluZTogbm9uZTsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIG92ZXJmbG93LXg6IGF1dG87DQogICAgd2hpdGUtc3BhY2U6IHByZTsNCiAgICB0YWItc2l6ZTogNDsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCn0NCg0KI3RleHQtZWRpdG9yLndvcmQtd3JhcCB7DQogICAgd2hpdGUtc3BhY2U6IHByZS13cmFwOw0KICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsNCn0NCg0KI3RleHQtZWRpdG9yOjpwbGFjZWhvbGRlciB7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KfQ0KDQovKiBTeW50YXggSGlnaGxpZ2h0aW5nIEVkaXRvciAqLw0KLmhpZ2hsaWdodGVkLWVkaXRvciB7DQogICAgZmxleDogMTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWJnKTsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7DQogICAgZm9udC1mYW1pbHk6ICdTRiBNb25vJywgTW9uYWNvLCAnQ2FzY2FkaWEgQ29kZScsIG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgbGluZS1oZWlnaHQ6IDEuNjsNCiAgICBwYWRkaW5nOiAxMHB4IDE1cHg7DQogICAgb3V0bGluZTogbm9uZTsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIG92ZXJmbG93LXg6IGF1dG87DQogICAgd2hpdGUtc3BhY2U6IHByZTsNCiAgICB0YWItc2l6ZTogNDsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3I6Zm9jdXMgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpOw0KfQ0KDQovKiBQcmlzbS5qcyBUaGVtZSBPdmVycmlkZXMgZm9yIGJldHRlciBpbnRlZ3JhdGlvbiAqLw0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uY29tbWVudCwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnByb2xvZywNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmRvY3R5cGUsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jZGF0YSB7DQogICAgY29sb3I6ICM2YTczN2Q7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnB1bmN0dWF0aW9uIHsNCiAgICBjb2xvcjogI2UxZTRlODsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ucHJvcGVydHksDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi50YWcsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5ib29sZWFuLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ubnVtYmVyLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uY29uc3RhbnQsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5zeW1ib2wsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5kZWxldGVkIHsNCiAgICBjb2xvcjogIzc5YjhmZjsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uc2VsZWN0b3IsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5hdHRyLW5hbWUsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5zdHJpbmcsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5jaGFyLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uYnVpbHRpbiwNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmluc2VydGVkIHsNCiAgICBjb2xvcjogIzg1ZTg5ZDsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ub3BlcmF0b3IsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5lbnRpdHksDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi51cmwsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC5sYW5ndWFnZS1jc3MgLnRva2VuLnN0cmluZywNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnN0eWxlIC50b2tlbi5zdHJpbmcgew0KICAgIGNvbG9yOiAjZjk3NTgzOw0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5hdHJ1bGUsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5hdHRyLXZhbHVlLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4ua2V5d29yZCB7DQogICAgY29sb3I6ICNmOTc1ODM7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmZ1bmN0aW9uLA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uY2xhc3MtbmFtZSB7DQogICAgY29sb3I6ICNiMzkyZjA7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLnJlZ2V4LA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uaW1wb3J0YW50LA0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4udmFyaWFibGUgew0KICAgIGNvbG9yOiAjZmZhYjcwOw0KfQ0KDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5pbXBvcnRhbnQsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yIC50b2tlbi5ib2xkIHsNCiAgICBmb250LXdlaWdodDogYm9sZDsNCn0NCg0KLmhpZ2hsaWdodGVkLWVkaXRvciAudG9rZW4uaXRhbGljIHsNCiAgICBmb250LXN0eWxlOiBpdGFsaWM7DQp9DQoNCi5oaWdobGlnaHRlZC1lZGl0b3IgLnRva2VuLmVudGl0eSB7DQogICAgY3Vyc29yOiBoZWxwOw0KfQ0KDQovKiBFZGl0b3IgU3RhdHVzIEJhciAqLw0KLmVkaXRvci1zdGF0dXMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIHBhZGRpbmc6IDhweCAyMHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtc2Vjb25kYXJ5KTsNCiAgICBmbGV4LXNocmluazogMDsNCiAgICBoZWlnaHQ6IDMycHg7DQogICAgbWluLWhlaWdodDogMzJweDsNCn0NCg0KLnN0YXR1cy1sZWZ0IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGdhcDogMjBweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KfQ0KDQovKiBPdmVycmlkZSB0aGUgbWFpbiBPUyAuc3RhdHVzLWl0ZW0gc3R5bGVzIHRvIGJlIGZsYXQgKi8NCi5lZGl0b3Itc3RhdHVzIC5zdGF0dXMtaXRlbSB7DQogICAgYmFja2dyb3VuZDogbm9uZSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlcjogbm9uZSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlci1yYWRpdXM6IDAgIWltcG9ydGFudDsNCiAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7DQogICAgdGV4dC1hbGlnbjogbGVmdCAhaW1wb3J0YW50Ow0KICAgIGRpc3BsYXk6IGlubGluZSAhaW1wb3J0YW50Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXNlY29uZGFyeSk7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjQ7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCn0NCg0KLmVkaXRvci1zdGF0dXMgLnN0YXR1cy1pdGVtIHNwYW4gew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQp9DQoNCi8qIEZpbGUgUGF0aCBEaXNwbGF5ICovDQouZmlsZS1wYXRoLWRpc3BsYXkgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBwYWRkaW5nOiAxMHB4IDE1cHg7DQogICAgbWluLXdpZHRoOiAyMDBweDsNCiAgICBmb250LWZhbWlseTogJ1NGIE1vbm8nLCBNb25hY28sICdDYXNjYWRpYSBDb2RlJywgbW9ub3NwYWNlOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7DQp9DQoNCi8qIFJlc3BvbnNpdmUgRGVzaWduICovDQpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsNCiAgICAuYXBwLXRvb2xiYXIgew0KICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgICAgICBnYXA6IDEwcHg7DQogICAgfQ0KICAgIA0KICAgIC5hcHAtYnRuLWdyb3VwIHsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgfQ0KICAgIA0KICAgIC5lZGl0b3Itc3RhdHVzIHsNCiAgICAgICAgZmxleC13cmFwOiB3cmFwOw0KICAgICAgICBnYXA6IDE1cHg7DQogICAgICAgIHBhZGRpbmc6IDhweCAxNXB4Ow0KICAgICAgICBmb250LXNpemU6IDEzcHg7DQogICAgfQ0KICAgIA0KICAgIC5saW5lLW51bWJlcnMgew0KICAgICAgICBtaW4td2lkdGg6IDQwcHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTNweDsgLyogTWF0Y2ggZWRpdG9yIGZvbnQgc2l6ZSAqLw0KICAgIH0NCiAgICANCiAgICAjdGV4dC1lZGl0b3IsDQogICAgLmhpZ2hsaWdodGVkLWVkaXRvciB7DQogICAgICAgIGZvbnQtc2l6ZTogMTNweDsNCiAgICB9DQp9DQoNCi8qIEZvY3VzIFN0YXRlcyAqLw0KI3RleHQtZWRpdG9yOmZvY3VzIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWJnKTsNCn0NCg0KLyogU2Nyb2xsYmFyIFN0eWxpbmcgKi8NCiN0ZXh0LWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXIsDQoubGluZS1udW1iZXJzOjotd2Via2l0LXNjcm9sbGJhciwNCi5oaWdobGlnaHRlZC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyIHsNCiAgICB3aWR0aDogOHB4Ow0KICAgIGhlaWdodDogOHB4Ow0KfQ0KDQojdGV4dC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrLA0KLmxpbmUtbnVtYmVyczo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2ssDQouaGlnaGxpZ2h0ZWQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhci10cmFjayB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KfQ0KDQojdGV4dC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iLA0KLmxpbmUtbnVtYmVyczo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIsDQouaGlnaGxpZ2h0ZWQtZWRpdG9yOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQp9DQoNCiN0ZXh0LWVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXIsDQoubGluZS1udW1iZXJzOjotd2Via2l0LXNjcm9sbGJhci10aHVtYjpob3ZlciwNCi5oaWdobGlnaHRlZC1lZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KfQ0KDQovKiBBcHAgVG9vbGJhciAqLw0KLmFwcC10b29sYmFyIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIHBhZGRpbmc6IDE1cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGZsZXgtc2hyaW5rOiAwOw0KfQ0KDQouYXBwLWJ0bi1ncm91cCB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDEwcHg7DQp9DQoNCi8qIEFuaW1hdGlvbiBmb3Igc3RhdHVzIGNoYW5nZXMgKi8NCi5zdGF0dXMtdmFsdWUgew0KICAgIHRyYW5zaXRpb246IGNvbG9yIDAuMnMgZWFzZTsNCn0NCg0KLyogTW9kaWZpZWQgc3RhdHVzIGluZGljYXRvciAqLw0KLnN0YXR1cy12YWx1ZS5tb2RpZmllZCB7DQogICAgY29sb3I6ICNmZjk4MDA7DQogICAgYW5pbWF0aW9uOiBwdWxzZSAycyBpbmZpbml0ZTsNCn0NCg0KQGtleWZyYW1lcyBwdWxzZSB7DQogICAgMCUgeyBvcGFjaXR5OiAxOyB9DQogICAgNTAlIHsgb3BhY2l0eTogMC43OyB9DQogICAgMTAwJSB7IG9wYWNpdHk6IDE7IH0NCn0NCg0KLyogQ29kZSBWYWxpZGF0aW9uIEVycm9yIFN0eWxlcyAqLw0KLmxpbmUtZXJyb3Igew0KICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAxMDcsIDEwNywgMC4yKSAhaW1wb3J0YW50Ow0KICAgIGNvbG9yOiAjZmY2YjZiICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyLWxlZnQ6IDNweCBzb2xpZCAjZmY2YjZiICFpbXBvcnRhbnQ7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KfQ0KDQoubGluZS1lcnJvcjo6YmVmb3JlIHsNCiAgICBjb250ZW50OiAi4pqgIjsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgbGVmdDogMnB4Ow0KICAgIHRvcDogNTAlOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsNCiAgICBjb2xvcjogI2ZmNmI2YjsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgei1pbmRleDogMTsNCn0NCg0KLyogRXJyb3IgY291bnQgaW4gc3RhdHVzIGJhciAqLw0KLnN0YXR1cy12YWx1ZSB7DQogICAgdHJhbnNpdGlvbjogY29sb3IgMC4zcyBlYXNlOw0KfQ0KDQovKiBBY3RpdmUgdmFsaWRhdGlvbiB0b2dnbGUgYnV0dG9uICovDQouYXBwLWJ0bi5hY3RpdmUgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1wcmltYXJ5KTsNCiAgICBjb2xvcjogd2hpdGU7DQp9IDwvc3R5bGU+DQo8c2NyaXB0Pi8vID09PT09IFNjcmlwdDoganMvdXRpbHMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL3NldHRpbmdzLW1hbmFnZXIuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2ZpbGUtbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvZWRpdG9yLW1hbmFnZXIuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL3N5bnRheC1oaWdobGlnaHRpbmcuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2NvZGUtdmFsaWRhdGlvbi5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvdWktbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvbWFpbi5qcyA9PT09PQ0KDQoNCi8vIENoZWNrIGlmIGZpbGUgaXMgc3VwcG9ydGVkIGZvciBzeW50YXggaGlnaGxpZ2h0aW5nDQpmdW5jdGlvbiBnZXRGaWxlTGFuZ3VhZ2UoZmlsZVBhdGgpIHsNCiAgICBpZiAoIWZpbGVQYXRoKSByZXR1cm4gbnVsbDsNCiAgICANCiAgICBjb25zdCBleHRlbnNpb24gPSBmaWxlUGF0aC50b0xvd2VyQ2FzZSgpLnN1YnN0cmluZyhmaWxlUGF0aC5sYXN0SW5kZXhPZignLicpKTsNCiAgICANCiAgICBjb25zdCBsYW5ndWFnZU1hcCA9IHsNCiAgICAgICAgJy5weSc6ICdweXRob24nLA0KICAgICAgICAnLnB5dyc6ICdweXRob24nLCANCiAgICAgICAgJy5weXgnOiAncHl0aG9uJywNCiAgICAgICAgJy5weWknOiAncHl0aG9uJywNCiAgICAgICAgJy5weWQnOiAncHl0aG9uJywNCiAgICAgICAgJy5qcyc6ICdqYXZhc2NyaXB0JywNCiAgICAgICAgJy5qc29uJzogJ2pzb24nLA0KICAgICAgICAnLmh0bWwnOiAnaHRtbCcsDQogICAgICAgICcuaHRtJzogJ2h0bWwnLA0KICAgICAgICAnLmNzcyc6ICdjc3MnDQogICAgfTsNCiAgICANCiAgICByZXR1cm4gbGFuZ3VhZ2VNYXBbZXh0ZW5zaW9uXSB8fCBudWxsOw0KfQ0KDQovLyBDaGVjayBpZiBmaWxlIGlzIFB5dGhvbiAoZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpDQpmdW5jdGlvbiBpc1B5dGhvbkZpbGUoZmlsZVBhdGgpIHsNCiAgICByZXR1cm4gZ2V0RmlsZUxhbmd1YWdlKGZpbGVQYXRoKSA9PT0gJ3B5dGhvbic7DQp9DQoNCi8vIFNpbXBsZSBoZWxwZXIgZnVuY3Rpb25zIChrZWVwaW5nIHRoZXNlIGZvciBwb3RlbnRpYWwgZnV0dXJlIHVzZSkNCmZ1bmN0aW9uIGdldFNpbXBsZVRleHRDb250ZW50KCkgew0KICAgIHJldHVybiB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlOw0KfQ0KDQovLyBMb2FkIGFwcCBzZXR0aW5ncw0KYXN5bmMgZnVuY3Rpb24gbG9hZFNldHRpbmdzKCkgew0KICAgIHRyeSB7DQogICAgICAgIHRleHRFZGl0b3Iuc2V0dGluZ3MgPSB7DQogICAgICAgICAgICBhdXRvU2F2ZUludGVydmFsOiBhd2FpdCBzeXBuZXhBUEkuZ2V0U2V0dGluZygnQVVUT19TQVZFX0lOVEVSVkFMJywgMzApLA0KICAgICAgICAgICAgZm9udFNpemU6IGF3YWl0IHN5cG5leEFQSS5nZXRTZXR0aW5nKCdGT05UX1NJWkUnLCAxNCksDQogICAgICAgICAgICB0YWJTaXplOiBhd2FpdCBzeXBuZXhBUEkuZ2V0U2V0dGluZygnVEFCX1NJWkUnLCA0KSwNCiAgICAgICAgICAgIHN5bnRheEhpZ2hsaWdodGluZzogYXdhaXQgc3lwbmV4QVBJLmdldFNldHRpbmcoJ1NZTlRBWF9ISUdITElHSFRJTkcnLCB0cnVlKSwNCiAgICAgICAgICAgIGNvZGVWYWxpZGF0aW9uOiBhd2FpdCBzeXBuZXhBUEkuZ2V0U2V0dGluZygnQ09ERV9WQUxJREFUSU9OJywgdHJ1ZSkNCiAgICAgICAgfTsNCiAgICAgICAgDQogICAgICAgIC8vIEFwcGx5IHNldHRpbmdzDQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEuc3R5bGUuZm9udFNpemUgPSB0ZXh0RWRpdG9yLnNldHRpbmdzLmZvbnRTaXplICsgJ3B4JzsNCiAgICAgICAgdGV4dEVkaXRvci50ZXh0YXJlYS5zdHlsZS50YWJTaXplID0gdGV4dEVkaXRvci5zZXR0aW5ncy50YWJTaXplOw0KICAgICAgICB0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkID0gdGV4dEVkaXRvci5zZXR0aW5ncy5jb2RlVmFsaWRhdGlvbjsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgc2V0dGluZ3M6JywgZXJyb3IpOw0KICAgICAgICAvLyBVc2UgZGVmYXVsdHMNCiAgICAgICAgdGV4dEVkaXRvci5zZXR0aW5ncyA9IHsNCiAgICAgICAgICAgIGF1dG9TYXZlSW50ZXJ2YWw6IDMwLA0KICAgICAgICAgICAgZm9udFNpemU6IDE0LA0KICAgICAgICAgICAgdGFiU2l6ZTogNCwNCiAgICAgICAgICAgIHN5bnRheEhpZ2hsaWdodGluZzogdHJ1ZSwNCiAgICAgICAgICAgIGNvZGVWYWxpZGF0aW9uOiB0cnVlDQogICAgICAgIH07DQogICAgICAgIHRleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQgPSB0cnVlOw0KICAgIH0NCn0NCg0KDQoNCg0KLy8gQ3JlYXRlIG5ldyBmaWxlDQpmdW5jdGlvbiBjcmVhdGVOZXdGaWxlKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLmlzTW9kaWZpZWQpIHsNCiAgICAgICAgaWYgKGNvbmZpcm0oJ1lvdSBoYXZlIHVuc2F2ZWQgY2hhbmdlcy4gQ3JlYXRlIG5ldyBmaWxlIGFueXdheT8nKSkgew0KICAgICAgICAgICAgY2xlYXJFZGl0b3IoKTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIGNsZWFyRWRpdG9yKCk7DQogICAgfQ0KfQ0KDQovLyBMb2FkIGZpbGUgZnJvbSBWRlMNCmFzeW5jIGZ1bmN0aW9uIGxvYWRGaWxlKCkgew0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IGZpbGVQYXRoID0gYXdhaXQgc3lwbmV4QVBJLnNob3dGaWxlRXhwbG9yZXIoew0KICAgICAgICAgICAgbW9kZTogJ29wZW4nLA0KICAgICAgICAgICAgdGl0bGU6ICdPcGVuIFRleHQgRmlsZScsDQogICAgICAgICAgICBpbml0aWFsUGF0aDogJy8nLA0KICAgICAgICAgICAgb25TZWxlY3Q6IChzZWxlY3RlZFBhdGgpID0+IHsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4gew0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCg0KICAgICAgICBpZiAoIWZpbGVQYXRoKSB7DQogICAgICAgICAgICByZXR1cm47IC8vIFVzZXIgY2FuY2VsbGVkDQogICAgICAgIH0NCg0KICAgICAgICAvLyBVc2UgdGhlIGhlbHBlciBmdW5jdGlvbiB0byBsb2FkIHRoZSBmaWxlDQogICAgICAgIGF3YWl0IGxvYWRGaWxlQnlQYXRoKGZpbGVQYXRoKTsNCg0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIGZpbGU6JywgZXJyb3IpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmFpbGVkIHRvIGxvYWQgZmlsZTogJHtlcnJvci5tZXNzYWdlfWAsICdlcnJvcicpOw0KICAgIH0NCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGxvYWQgYSBmaWxlIGJ5IHBhdGggKHVzZWQgYnkgYm90aCBpbnRlcmFjdGl2ZSBsb2FkIGFuZCBpbnRlbnQgc3lzdGVtKQ0KYXN5bmMgZnVuY3Rpb24gbG9hZEZpbGVCeVBhdGgoZmlsZVBhdGgpIHsNCiAgICB0cnkgew0KICAgICAgICAvLyBDaGVjayBpZiBmaWxlIGV4aXN0cyBhbmQgbG9hZCBpdA0KICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZVRleHQoZmlsZVBhdGgpOw0KDQogICAgICAgIC8vIExvYWQgY29udGVudCBpbnRvIGVkaXRvcg0KICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlID0gY29udGVudDsNCiAgICAgICAgdGV4dEVkaXRvci5maWxlUGF0aCA9IGZpbGVQYXRoOw0KICAgICAgICB0ZXh0RWRpdG9yLm9yaWdpbmFsQ29udGVudCA9IGNvbnRlbnQ7DQoNCiAgICAgICAgLy8gVXBkYXRlIFVJDQogICAgICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgICAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgICAgICB1cGRhdGVTdGF0dXMoKTsNCiAgICAgICAgbWFya0FzU2F2ZWQoKTsNCg0KICAgICAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBmb3IgbG9hZGVkIGZpbGUNCiAgICAgICAgYXdhaXQgZW5hYmxlU3ludGF4SGlnaGxpZ2h0aW5nKCk7DQoNCiAgICAgICAgLy8gRm9yY2UgdXBkYXRlIGhpZ2hsaWdodGVkIGNvbnRlbnQgaWYgaGlnaGxpZ2h0aW5nIGlzIGVuYWJsZWQNCiAgICAgICAgaWYgKHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCAmJiB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgICAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFNjaGVkdWxlIHZhbGlkYXRpb24gZm9yIFB5dGhvbiBmaWxlcw0KICAgICAgICBzY2hlZHVsZVZhbGlkYXRpb24oKTsNCg0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmlsZSBsb2FkZWQ6ICR7ZmlsZVBhdGh9YCwgJ3N1Y2Nlc3MnKTsNCg0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIGZpbGUgYnkgcGF0aDonLCBlcnJvcik7DQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGYWlsZWQgdG8gbG9hZCBmaWxlOiAke2Vycm9yLm1lc3NhZ2V9YCwgJ2Vycm9yJyk7DQogICAgICAgIHRocm93IGVycm9yOw0KICAgIH0NCn0NCg0KDQovLyBTYXZlIGZpbGUgdG8gVkZTDQphc3luYyBmdW5jdGlvbiBzYXZlRmlsZSgpIHsNCiAgICBjb25zdCBjb250ZW50ID0gdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZTsNCg0KICAgIHRyeSB7DQogICAgICAgIGxldCBmaWxlUGF0aCA9IHRleHRFZGl0b3IuZmlsZVBhdGg7DQoNCiAgICAgICAgLy8gSWYgaXQncyBhIG5ldyBmaWxlICh1bnRpdGxlZCkgb3Igd2Ugd2FudCB0byBzYXZlIGFzLCBzaG93IGZpbGUgZXhwbG9yZXINCiAgICAgICAgaWYgKHRleHRFZGl0b3IuZmlsZVBhdGggPT09ICcvdW50aXRsZWQudHh0Jykgew0KICAgICAgICAgICAgZmlsZVBhdGggPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0ZpbGVFeHBsb3Jlcih7DQogICAgICAgICAgICAgICAgbW9kZTogJ3NhdmUnLA0KICAgICAgICAgICAgICAgIHRpdGxlOiAnU2F2ZSBUZXh0IEZpbGUnLA0KICAgICAgICAgICAgICAgIGluaXRpYWxQYXRoOiAnLycsDQogICAgICAgICAgICAgICAgZmlsZU5hbWU6ICd1bnRpdGxlZC50eHQnLA0KICAgICAgICAgICAgICAgIG9uU2VsZWN0OiAoc2VsZWN0ZWRQYXRoKSA9PiB7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4gew0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBpZiAoIWZpbGVQYXRoKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBVc2VyIGNhbmNlbGxlZA0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGUoZmlsZVBhdGgsIGNvbnRlbnQpOw0KDQogICAgICAgIHRleHRFZGl0b3IuZmlsZVBhdGggPSBmaWxlUGF0aDsNCiAgICAgICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgIG1hcmtBc1NhdmVkKCk7DQoNCiAgICAgICAgLy8gRW5hYmxlIHN5bnRheCBoaWdobGlnaHRpbmcgZm9yIHNhdmVkIGZpbGUNCiAgICAgICAgYXdhaXQgZW5hYmxlU3ludGF4SGlnaGxpZ2h0aW5nKCk7DQoNCiAgICAgICAgLy8gRm9yY2UgdXBkYXRlIGhpZ2hsaWdodGVkIGNvbnRlbnQgaWYgaGlnaGxpZ2h0aW5nIGlzIGVuYWJsZWQNCiAgICAgICAgaWYgKHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCAmJiB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgICAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGaWxlIHNhdmVkOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQoNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBmaWxlOicsIGVycm9yKTsNCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZhaWxlZCB0byBzYXZlIGZpbGU6ICR7ZXJyb3IubWVzc2FnZX1gLCAnZXJyb3InKTsNCiAgICB9DQp9DQoNCi8vIFNhdmUgZmlsZSBhcyAoYWx3YXlzIHNob3cgZmlsZSBleHBsb3JlcikNCmFzeW5jIGZ1bmN0aW9uIHNhdmVBc0ZpbGUoKSB7DQogICAgY29uc3QgY29udGVudCA9IHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWU7DQoNCiAgICB0cnkgew0KICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGF3YWl0IHN5cG5leEFQSS5zaG93RmlsZUV4cGxvcmVyKHsNCiAgICAgICAgICAgIG1vZGU6ICdzYXZlJywNCiAgICAgICAgICAgIHRpdGxlOiAnU2F2ZSBUZXh0IEZpbGUgQXMnLA0KICAgICAgICAgICAgaW5pdGlhbFBhdGg6ICcvJywNCiAgICAgICAgICAgIGZpbGVOYW1lOiB0ZXh0RWRpdG9yLmZpbGVQYXRoID09PSAnL3VudGl0bGVkLnR4dCcgPyAndW50aXRsZWQudHh0JyA6IHRleHRFZGl0b3IuZmlsZVBhdGguc3BsaXQoJy8nKS5wb3AoKSwNCiAgICAgICAgICAgIG9uU2VsZWN0OiAoc2VsZWN0ZWRQYXRoKSA9PiB7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgb25DYW5jZWw6ICgpID0+IHsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgaWYgKCFmaWxlUGF0aCkgew0KICAgICAgICAgICAgcmV0dXJuOyAvLyBVc2VyIGNhbmNlbGxlZA0KICAgICAgICB9DQoNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGUoZmlsZVBhdGgsIGNvbnRlbnQpOw0KDQogICAgICAgIHRleHRFZGl0b3IuZmlsZVBhdGggPSBmaWxlUGF0aDsNCiAgICAgICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgIG1hcmtBc1NhdmVkKCk7DQoNCiAgICAgICAgLy8gRW5hYmxlIHN5bnRheCBoaWdobGlnaHRpbmcgZm9yIHNhdmVkIGZpbGUNCiAgICAgICAgYXdhaXQgZW5hYmxlU3ludGF4SGlnaGxpZ2h0aW5nKCk7DQoNCiAgICAgICAgLy8gRm9yY2UgdXBkYXRlIGhpZ2hsaWdodGVkIGNvbnRlbnQgaWYgaGlnaGxpZ2h0aW5nIGlzIGVuYWJsZWQNCiAgICAgICAgaWYgKHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCAmJiB0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgICAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGaWxlIHNhdmVkIGFzOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQoNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBmaWxlIGFzOicsIGVycm9yKTsNCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZhaWxlZCB0byBzYXZlIGZpbGUgYXM6ICR7ZXJyb3IubWVzc2FnZX1gLCAnZXJyb3InKTsNCiAgICB9DQp9DQoNCg0KLy8gVXBkYXRlIGxpbmUgbnVtYmVycw0KZnVuY3Rpb24gdXBkYXRlTGluZU51bWJlcnMoKSB7DQogICAgaWYgKCF0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzIHx8ICF0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzRW5hYmxlZCkgcmV0dXJuOw0KICAgIA0KICAgIGNvbnN0IGxpbmVzID0gdGV4dEVkaXRvci50ZXh0YXJlYS52YWx1ZS5zcGxpdCgnXG4nKTsNCiAgICBjb25zdCBsaW5lQ291bnQgPSBsaW5lcy5sZW5ndGg7DQogICAgDQogICAgLy8gR2VuZXJhdGUgbGluZSBudW1iZXJzIEhUTUwNCiAgICBsZXQgbGluZU51bWJlcnNIVE1MID0gJyc7DQogICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gbGluZUNvdW50OyBpKyspIHsNCiAgICAgICAgbGluZU51bWJlcnNIVE1MICs9IGA8c3BhbiBjbGFzcz0ibGluZS1udW1iZXIiPiR7aX08L3NwYW4+XG5gOw0KICAgIH0NCiAgICANCiAgICB0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzLmlubmVySFRNTCA9IGxpbmVOdW1iZXJzSFRNTDsNCn0NCg0KLy8gU3luYyBzY3JvbGwgYmV0d2VlbiB0ZXh0YXJlYSBhbmQgbGluZSBudW1iZXJzDQpmdW5jdGlvbiBzeW5jU2Nyb2xsKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzICYmIHRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkKSB7DQogICAgICAgIHRleHRFZGl0b3IubGluZU51bWJlcnMuc2Nyb2xsVG9wID0gdGV4dEVkaXRvci50ZXh0YXJlYS5zY3JvbGxUb3A7DQogICAgfQ0KICAgIA0KICAgIC8vIEFsc28gc3luYyB0aGUgYmFja2Ryb3AgaWYgaXQgZXhpc3RzDQogICAgc3luY0JhY2tkcm9wU2Nyb2xsKCk7DQp9DQoNCg0KLy8gSGFuZGxlIHRleHQgY2hhbmdlcw0KZnVuY3Rpb24gaGFuZGxlVGV4dENoYW5nZSgpIHsNCiAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgIHVwZGF0ZVN0YXR1cygpOw0KICAgIG1hcmtBc01vZGlmaWVkKCk7DQogICAgDQogICAgLy8gU2NoZWR1bGUgdmFsaWRhdGlvbiBmb3IgUHl0aG9uIGZpbGVzDQogICAgc2NoZWR1bGVWYWxpZGF0aW9uKCk7DQp9DQoNCi8vIEZvY3VzIGFwcHJvcHJpYXRlIGVkaXRvcg0KZnVuY3Rpb24gZm9jdXNFZGl0b3IoKSB7DQogICAgaWYgKHRleHRFZGl0b3IudGV4dGFyZWEpIHsNCiAgICAgICAgdGV4dEVkaXRvci50ZXh0YXJlYS5mb2N1cygpOw0KICAgIH0NCn0NCg0KDQovLyBVcGRhdGUgZmlsZW5hbWUgZGlzcGxheQ0KZnVuY3Rpb24gdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCkgew0KICAgIGlmIChjdXJyZW50RmlsZW5hbWVFbCkgew0KICAgICAgICBjb25zdCBmaWxlbmFtZSA9IHRleHRFZGl0b3IuZmlsZVBhdGggPyB0ZXh0RWRpdG9yLmZpbGVQYXRoLnNwbGl0KCcvJykucG9wKCkgOiAndW50aXRsZWQudHh0JzsNCiAgICAgICAgY3VycmVudEZpbGVuYW1lRWwudGV4dENvbnRlbnQgPSBmaWxlbmFtZTsNCiAgICB9DQp9DQoNCi8vIEluaXRpYWxpemUgZWRpdG9yIHN0YXRlDQpmdW5jdGlvbiBpbml0aWFsaXplRWRpdG9yKCkgew0KICAgIC8vIFNldCBpbml0aWFsIGZpbGUgcGF0aA0KICAgIHRleHRFZGl0b3IuZmlsZVBhdGggPSAnL3VudGl0bGVkLnR4dCc7DQogICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgDQogICAgLy8gVXBkYXRlIGxpbmUgbnVtYmVycw0KICAgIHVwZGF0ZUxpbmVOdW1iZXJzKCk7DQogICAgDQogICAgLy8gVXBkYXRlIHN0YXR1cw0KICAgIHVwZGF0ZVN0YXR1cygpOw0KICAgIA0KICAgIC8vIEVuYWJsZSBzeW50YXggaGlnaGxpZ2h0aW5nIGlmIG5lZWRlZA0KICAgIGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpOw0KICAgIA0KICAgIC8vIFN0YXJ0IGF1dG8tc2F2ZSBpZiBlbmFibGVkDQogICAgaWYgKHRleHRFZGl0b3Iuc2V0dGluZ3MuYXV0b1NhdmVJbnRlcnZhbCA+IDApIHsNCiAgICAgICAgc3RhcnRBdXRvU2F2ZSgpOw0KICAgIH0NCn0NCg0KDQoNCi8vIFVwZGF0ZSBzdGF0dXMgYmFyDQpmdW5jdGlvbiB1cGRhdGVTdGF0dXMoKSB7DQogICAgLy8gU3RhdHVzIGJhciBub3cgb25seSBzaG93cyBtb2RpZmllZCBzdGF0dXMsIHdoaWNoIGlzIGhhbmRsZWQgYnkgbWFya0FzTW9kaWZpZWQvbWFya0FzU2F2ZWQNCiAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIGtlcHQgZm9yIHBvdGVudGlhbCBmdXR1cmUgdXNlDQp9DQoNCi8vIE1hcmsgZmlsZSBhcyBtb2RpZmllZA0KZnVuY3Rpb24gbWFya0FzTW9kaWZpZWQoKSB7DQogICAgaWYgKCF0ZXh0RWRpdG9yLmlzTW9kaWZpZWQpIHsNCiAgICAgICAgdGV4dEVkaXRvci5pc01vZGlmaWVkID0gdHJ1ZTsNCiAgICAgICAgaWYgKG1vZGlmaWVkU3RhdHVzRWwpIHsNCiAgICAgICAgICAgIG1vZGlmaWVkU3RhdHVzRWwudGV4dENvbnRlbnQgPSAnWWVzJzsNCiAgICAgICAgICAgIG1vZGlmaWVkU3RhdHVzRWwuY2xhc3NMaXN0LmFkZCgnbW9kaWZpZWQnKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gTWFyayBmaWxlIGFzIHNhdmVkDQpmdW5jdGlvbiBtYXJrQXNTYXZlZCgpIHsNCiAgICB0ZXh0RWRpdG9yLmlzTW9kaWZpZWQgPSBmYWxzZTsNCiAgICB0ZXh0RWRpdG9yLm9yaWdpbmFsQ29udGVudCA9IHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWU7DQogICAgaWYgKG1vZGlmaWVkU3RhdHVzRWwpIHsNCiAgICAgICAgbW9kaWZpZWRTdGF0dXNFbC50ZXh0Q29udGVudCA9ICdObyc7DQogICAgICAgIG1vZGlmaWVkU3RhdHVzRWwuY2xhc3NMaXN0LnJlbW92ZSgnbW9kaWZpZWQnKTsNCiAgICB9DQp9DQoNCg0KLy8gQ2xlYXIgZWRpdG9yDQpmdW5jdGlvbiBjbGVhckVkaXRvcigpIHsNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlID0gJyc7DQogICAgdGV4dEVkaXRvci5maWxlUGF0aCA9ICcvdW50aXRsZWQudHh0JzsNCiAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICB0ZXh0RWRpdG9yLm9yaWdpbmFsQ29udGVudCA9ICcnOw0KICAgIG1hcmtBc1NhdmVkKCk7DQogICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICB1cGRhdGVTdGF0dXMoKTsNCiAgICANCiAgICAvLyBFbmFibGUgc3ludGF4IGhpZ2hsaWdodGluZyBmb3IgbmV3IGZpbGUNCiAgICBlbmFibGVTeW50YXhIaWdobGlnaHRpbmcoKTsNCiAgICANCiAgICAvLyBGb3JjZSB1cGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudCBpZiBoaWdobGlnaHRpbmcgaXMgZW5hYmxlZA0KICAgIGlmICh0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgJiYgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvcikgew0KICAgICAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICB9DQogICAgDQogICAgLy8gQ2xlYXIgYW55IGV4aXN0aW5nIGVycm9ycw0KICAgIGNsZWFyRXJyb3JNYXJrZXJzKCk7DQogICAgdXBkYXRlRXJyb3JDb3VudCgwKTsNCiAgICANCiAgICAvLyBGb2N1cyB0aGUgdGV4dGFyZWEgKG5vdCB0aGUgYmFja2Ryb3ApDQogICAgZm9jdXNFZGl0b3IoKTsNCn0NCg0KLy8gU3RhcnQgYXV0by1zYXZlDQpmdW5jdGlvbiBzdGFydEF1dG9TYXZlKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLmF1dG9TYXZlSW50ZXJ2YWwpIHsNCiAgICAgICAgY2xlYXJJbnRlcnZhbCh0ZXh0RWRpdG9yLmF1dG9TYXZlSW50ZXJ2YWwpOw0KICAgIH0NCiAgICANCiAgICB0ZXh0RWRpdG9yLmF1dG9TYXZlSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7DQogICAgICAgIGlmICh0ZXh0RWRpdG9yLmlzTW9kaWZpZWQgJiYgdGV4dEVkaXRvci5maWxlUGF0aCAmJiB0ZXh0RWRpdG9yLmZpbGVQYXRoICE9PSAnL3VudGl0bGVkLnR4dCcpIHsNCiAgICAgICAgICAgIHNhdmVGaWxlKCk7DQogICAgICAgIH0NCiAgICB9LCB0ZXh0RWRpdG9yLnNldHRpbmdzLmF1dG9TYXZlSW50ZXJ2YWwgKiAxMDAwKTsNCiAgICANCn0NCg0KLy8gU3RvcCBhdXRvLXNhdmUNCmZ1bmN0aW9uIHN0b3BBdXRvU2F2ZSgpIHsNCiAgICBpZiAodGV4dEVkaXRvci5hdXRvU2F2ZUludGVydmFsKSB7DQogICAgICAgIGNsZWFySW50ZXJ2YWwodGV4dEVkaXRvci5hdXRvU2F2ZUludGVydmFsKTsNCiAgICAgICAgdGV4dEVkaXRvci5hdXRvU2F2ZUludGVydmFsID0gbnVsbDsNCiAgICB9DQp9DQoNCg0KLy8gTG9hZCBQcmlzbS5qcyBmb3Igc3ludGF4IGhpZ2hsaWdodGluZw0KYXN5bmMgZnVuY3Rpb24gbG9hZFByaXNtSlMoKSB7DQogICAgaWYgKHRleHRFZGl0b3IucHJpc21Mb2FkZWQpIHJldHVybjsNCiAgICANCiAgICB0cnkgew0KICAgICAgICANCiAgICAgICAgLy8gTG9hZCBQcmlzbS5qcyBsaWJyYXJ5DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL3ByaXNtLm1pbi5qcycsIHsNCiAgICAgICAgICAgIGxvY2FsTmFtZTogJ1ByaXNtJw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIC8vIExvYWQgbGFuZ3VhZ2UgY29tcG9uZW50cw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC9jb21wb25lbnRzL3ByaXNtLXB5dGhvbi5taW4uanMnKTsNCiAgICAgICAgYXdhaXQgc3lwbmV4QVBJLmxvYWRMaWJyYXJ5KCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wcmlzbS8xLjI5LjAvY29tcG9uZW50cy9wcmlzbS1qYXZhc2NyaXB0Lm1pbi5qcycpOw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC9jb21wb25lbnRzL3ByaXNtLWpzb24ubWluLmpzJyk7DQogICAgICAgIGF3YWl0IHN5cG5leEFQSS5sb2FkTGlicmFyeSgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL2NvbXBvbmVudHMvcHJpc20tbWFya3VwLm1pbi5qcycpOw0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ByaXNtLzEuMjkuMC9jb21wb25lbnRzL3ByaXNtLWNzcy5taW4uanMnKTsNCiAgICAgICAgDQogICAgICAgIC8vIExvYWQgUHJpc20gQ1NTDQogICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJyk7DQogICAgICAgIGxpbmsucmVsID0gJ3N0eWxlc2hlZXQnOw0KICAgICAgICBsaW5rLmhyZWYgPSAnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcHJpc20vMS4yOS4wL3RoZW1lcy9wcmlzbS10b21vcnJvdy5taW4uY3NzJzsNCiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChsaW5rKTsNCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBjdXN0b20gQ1NTIHRvIGZpeCBzdHlsaW5nIGlzc3Vlcw0KICAgICAgICBjb25zdCBjdXN0b21TdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7DQogICAgICAgIGN1c3RvbVN0eWxlLnRleHRDb250ZW50ID0gYA0KICAgICAgICAgICAgLmhpZ2hsaWdodGVkLWJhY2tkcm9wICogew0KICAgICAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbi1saW5lOiBub25lICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uLXN0eWxlOiBub25lICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uLWNvbG9yOiB0cmFuc3BhcmVudCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgIGJvcmRlci1ib3R0b206IG5vbmUgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICB0ZXh0LXVuZGVybGluZS1vZmZzZXQ6IDAgIWltcG9ydGFudDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC5oaWdobGlnaHRlZC1iYWNrZHJvcCAudG9rZW4uc3RyaW5nIHsNCiAgICAgICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IG5vbmUgIWltcG9ydGFudDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgYDsNCiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChjdXN0b21TdHlsZSk7DQogICAgICAgIA0KICAgICAgICB0ZXh0RWRpdG9yLnByaXNtTG9hZGVkID0gdHJ1ZTsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgUHJpc20uanM6JywgZXJyb3IpOw0KICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignRmFpbGVkIHRvIGxvYWQgc3ludGF4IGhpZ2hsaWdodGluZycsICdlcnJvcicpOw0KICAgIH0NCn0NCg0KLy8gQ3JlYXRlIGhpZ2hsaWdodGVkIGVkaXRvcg0KZnVuY3Rpb24gY3JlYXRlSGlnaGxpZ2h0ZWRFZGl0b3IoKSB7DQogICAgaWYgKCF0ZXh0RWRpdG9yLnByaXNtTG9hZGVkKSByZXR1cm47DQogICAgDQogICAgLy8gQ2xlYW4gdXAgYW55IGV4aXN0aW5nIGhpZ2hsaWdodGVkIHNldHVwDQogICAgY2xlYW51cEhpZ2hsaWdodGVkRWRpdG9yKCk7DQogICAgDQogICAgY29uc3QgZWRpdG9yV3JhcHBlciA9IHRleHRFZGl0b3IudGV4dGFyZWEucGFyZW50RWxlbWVudDsNCiAgICBjb25zdCB0ZXh0YXJlYSA9IHRleHRFZGl0b3IudGV4dGFyZWE7DQogICAgDQogICAgLy8gU3RvcmUgb3JpZ2luYWwgdGV4dGFyZWEgc3R5bGVzDQogICAgY29uc3Qgb3JpZ2luYWxTdHlsZXMgPSB7DQogICAgICAgIHBvc2l0aW9uOiB0ZXh0YXJlYS5zdHlsZS5wb3NpdGlvbiwNCiAgICAgICAgYmFja2dyb3VuZDogdGV4dGFyZWEuc3R5bGUuYmFja2dyb3VuZCwNCiAgICAgICAgY29sb3I6IHRleHRhcmVhLnN0eWxlLmNvbG9yLA0KICAgICAgICB6SW5kZXg6IHRleHRhcmVhLnN0eWxlLnpJbmRleCwNCiAgICAgICAgY2FyZXRDb2xvcjogdGV4dGFyZWEuc3R5bGUuY2FyZXRDb2xvciwNCiAgICAgICAgc3BlbGxjaGVjazogdGV4dGFyZWEuZ2V0QXR0cmlidXRlKCdzcGVsbGNoZWNrJyksDQogICAgICAgIGF1dG9jb21wbGV0ZTogdGV4dGFyZWEuZ2V0QXR0cmlidXRlKCdhdXRvY29tcGxldGUnKSwNCiAgICAgICAgYXV0b2NvcnJlY3Q6IHRleHRhcmVhLmdldEF0dHJpYnV0ZSgnYXV0b2NvcnJlY3QnKSwNCiAgICAgICAgYXV0b2NhcGl0YWxpemU6IHRleHRhcmVhLmdldEF0dHJpYnV0ZSgnYXV0b2NhcGl0YWxpemUnKQ0KICAgIH07DQogICAgDQogICAgLy8gQ3JlYXRlIGEgY29udGFpbmVyIGZvciB0aGUgb3ZlcmxheSBhcHByb2FjaA0KICAgIGNvbnN0IGhpZ2hsaWdodENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIGhpZ2hsaWdodENvbnRhaW5lci5jbGFzc05hbWUgPSAnaGlnaGxpZ2h0LWNvbnRhaW5lcic7DQogICAgaGlnaGxpZ2h0Q29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJzsNCiAgICBoaWdobGlnaHRDb250YWluZXIuc3R5bGUud2lkdGggPSAnMTAwJSc7DQogICAgaGlnaGxpZ2h0Q29udGFpbmVyLnN0eWxlLmhlaWdodCA9ICcxMDAlJzsNCiAgICANCiAgICAvLyBDcmVhdGUgaGlnaGxpZ2h0ZWQgYmFja2Ryb3ANCiAgICBjb25zdCBoaWdobGlnaHRlZEJhY2tkcm9wID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5pZCA9ICdoaWdobGlnaHRlZC1iYWNrZHJvcCc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5jbGFzc05hbWUgPSAnaGlnaGxpZ2h0ZWQtYmFja2Ryb3AnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUudG9wID0gJzAnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUubGVmdCA9ICcwJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLndpZHRoID0gJzEwMCUnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUuaGVpZ2h0ID0gJzEwMCUnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJzsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLmZvbnRGYW1pbHkgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0ZXh0YXJlYSkuZm9udEZhbWlseTsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLmZvbnRTaXplID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGV4dGFyZWEpLmZvbnRTaXplOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUubGluZUhlaWdodCA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRleHRhcmVhKS5saW5lSGVpZ2h0Ow0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUucGFkZGluZyA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRleHRhcmVhKS5wYWRkaW5nOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUubWFyZ2luID0gJzAnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUuYm9yZGVyID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGV4dGFyZWEpLmJvcmRlcjsNCiAgICBoaWdobGlnaHRlZEJhY2tkcm9wLnN0eWxlLndoaXRlU3BhY2UgPSAncHJlLXdyYXAnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUud29yZFdyYXAgPSAnYnJlYWstd29yZCc7DQogICAgaGlnaGxpZ2h0ZWRCYWNrZHJvcC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUuekluZGV4ID0gJzEnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUucmVzaXplID0gJ25vbmUnOw0KICAgIGhpZ2hsaWdodGVkQmFja2Ryb3Auc3R5bGUuY29sb3IgPSAnI2ZmZmZmZic7IC8vIERlZmF1bHQgdGV4dCBjb2xvciBmb3IgaGlnaGxpZ2h0aW5nDQogICAgDQogICAgLy8gTWFrZSBzdXJlIHRleHRhcmVhIGlzIG9uIHRvcCBhbmQgaGFzIHRyYW5zcGFyZW50IGJhY2tncm91bmQgYW5kIHRleHQNCiAgICB0ZXh0YXJlYS5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7DQogICAgdGV4dGFyZWEuc3R5bGUuekluZGV4ID0gJzInOw0KICAgIHRleHRhcmVhLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnOw0KICAgIHRleHRhcmVhLnN0eWxlLmNvbG9yID0gJ3RyYW5zcGFyZW50JzsNCiAgICB0ZXh0YXJlYS5zdHlsZS5jYXJldENvbG9yID0gJyNmZmZmZmYnOw0KICAgIA0KICAgIC8vIERpc2FibGUgYnJvd3NlciBzcGVsbCBjaGVja2luZyBmb3IgY29kZQ0KICAgIHRleHRhcmVhLnNldEF0dHJpYnV0ZSgnc3BlbGxjaGVjaycsICdmYWxzZScpOw0KICAgIHRleHRhcmVhLnNldEF0dHJpYnV0ZSgnYXV0b2NvbXBsZXRlJywgJ29mZicpOw0KICAgIHRleHRhcmVhLnNldEF0dHJpYnV0ZSgnYXV0b2NvcnJlY3QnLCAnb2ZmJyk7DQogICAgdGV4dGFyZWEuc2V0QXR0cmlidXRlKCdhdXRvY2FwaXRhbGl6ZScsICdvZmYnKTsNCiAgICANCiAgICAvLyBXcmFwIHRleHRhcmVhIGluIGNvbnRhaW5lcg0KICAgIGVkaXRvcldyYXBwZXIuaW5zZXJ0QmVmb3JlKGhpZ2hsaWdodENvbnRhaW5lciwgdGV4dGFyZWEpOw0KICAgIGhpZ2hsaWdodENvbnRhaW5lci5hcHBlbmRDaGlsZChoaWdobGlnaHRlZEJhY2tkcm9wKTsNCiAgICBoaWdobGlnaHRDb250YWluZXIuYXBwZW5kQ2hpbGQodGV4dGFyZWEpOw0KICAgIA0KICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IgPSBoaWdobGlnaHRlZEJhY2tkcm9wOw0KICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0Q29udGFpbmVyID0gaGlnaGxpZ2h0Q29udGFpbmVyOw0KICAgIHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcyA9IG9yaWdpbmFsU3R5bGVzOw0KICAgIHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCA9IHRydWU7DQogICAgDQogICAgLy8gU2V0IGluaXRpYWwgY29udGVudA0KICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgIA0KICAgIC8vIFNldCB1cCBzaW1wbGUgZXZlbnQgaGFuZGxlcnMgZm9yIHRoZSB0ZXh0YXJlYSAobm90IHRoZSBiYWNrZHJvcCkNCiAgICB0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGhhbmRsZVNpbXBsZUlucHV0KTsNCiAgICB0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBzeW5jQmFja2Ryb3BTY3JvbGwpOw0KICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVIaWdobGlnaHRLZXlEb3duKTsNCiAgICB0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUhpZ2hsaWdodENsaWNrKTsNCiAgICB0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIGhhbmRsZUhpZ2hsaWdodEZvY3VzKTsNCiAgICANCn0NCg0KDQovLyBVcGRhdGUgaGlnaGxpZ2h0ZWQgY29udGVudA0KZnVuY3Rpb24gdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCkgew0KICAgIGlmICghdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvciB8fCAhdGV4dEVkaXRvci5wcmlzbUxvYWRlZCkgcmV0dXJuOw0KICAgIA0KICAgIGNvbnN0IGNvbnRlbnQgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlOw0KICAgIGNvbnN0IGxhbmd1YWdlID0gZ2V0RmlsZUxhbmd1YWdlKHRleHRFZGl0b3IuZmlsZVBhdGgpOw0KICAgIA0KICAgIGlmICghbGFuZ3VhZ2UpIHsNCiAgICAgICAgLy8gTm8gbGFuZ3VhZ2UgZGV0ZWN0ZWQsIHVzZSBwbGFpbiB0ZXh0DQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IudGV4dENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIEFwcGx5IHN5bnRheCBoaWdobGlnaHRpbmcgdG8gYmFja2Ryb3ANCiAgICBjb25zdCBoaWdobGlnaHRlZENvbnRlbnQgPSBQcmlzbS5oaWdobGlnaHQoY29udGVudCwgUHJpc20ubGFuZ3VhZ2VzW2xhbmd1YWdlXSwgbGFuZ3VhZ2UpOw0KICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IuaW5uZXJIVE1MID0gaGlnaGxpZ2h0ZWRDb250ZW50Ow0KICAgIA0KICAgIC8vIFN5bmMgc2Nyb2xsIHBvc2l0aW9uDQogICAgc3luY0JhY2tkcm9wU2Nyb2xsKCk7DQogICAgDQp9DQoNCi8vIEVuYWJsZSBzeW50YXggaGlnaGxpZ2h0aW5nIGZvciBzdXBwb3J0ZWQgZmlsZXMNCmFzeW5jIGZ1bmN0aW9uIGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpIHsNCiAgICBpZiAoIXRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nKSB7DQogICAgICAgIGNsZWFudXBIaWdobGlnaHRlZEVkaXRvcigpOw0KICAgICAgICB0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgPSBmYWxzZTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBsYW5ndWFnZSA9IGdldEZpbGVMYW5ndWFnZSh0ZXh0RWRpdG9yLmZpbGVQYXRoKTsNCiAgICANCiAgICBpZiAobGFuZ3VhZ2UpIHsNCiAgICAgICAgaWYgKCF0ZXh0RWRpdG9yLnByaXNtTG9hZGVkKSB7DQogICAgICAgICAgICBhd2FpdCBsb2FkUHJpc21KUygpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBpZiAoIXRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgICAgIGNyZWF0ZUhpZ2hsaWdodGVkRWRpdG9yKCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCA9IHRydWU7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gRGlzYWJsZSBoaWdobGlnaHRpbmcgZm9yIHVuc3VwcG9ydGVkIGZpbGVzDQogICAgICAgIGNsZWFudXBIaWdobGlnaHRlZEVkaXRvcigpOw0KICAgICAgICB0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgPSBmYWxzZTsNCiAgICB9DQp9DQoNCi8vIEhhbmRsZSBzaW1wbGUgaW5wdXQgZm9yIGJhY2tkcm9wIGFwcHJvYWNoDQpmdW5jdGlvbiBoYW5kbGVTaW1wbGVJbnB1dCgpIHsNCiAgICAvLyBVcGRhdGUgbGluZSBudW1iZXJzIGFuZCBzdGF0dXMgaW1tZWRpYXRlbHkNCiAgICB1cGRhdGVMaW5lTnVtYmVycygpOw0KICAgIHVwZGF0ZVN0YXR1cygpOw0KICAgIG1hcmtBc01vZGlmaWVkKCk7DQogICAgDQogICAgLy8gSW1tZWRpYXRlIGhpZ2hsaWdodGluZyB1cGRhdGUgZm9yIHJlc3BvbnNpdmUgZmVlbA0KICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgIA0KICAgIC8vIFNjaGVkdWxlIHZhbGlkYXRpb24gZm9yIFB5dGhvbiBmaWxlcw0KICAgIHNjaGVkdWxlVmFsaWRhdGlvbigpOw0KfQ0KDQovLyBIYW5kbGUga2V5IGV2ZW50cyB0aGF0IG1pZ2h0IGNoYW5nZSBjb250ZW50DQpmdW5jdGlvbiBoYW5kbGVIaWdobGlnaHRLZXlEb3duKGUpIHsNCiAgICAvLyBGb3Iga2V5cyB0aGF0IG1vZGlmeSBjb250ZW50LCB1cGRhdGUgaGlnaGxpZ2h0aW5nIGltbWVkaWF0ZWx5IGFmdGVyIHRoZSBldmVudA0KICAgIGlmIChlLmtleSA9PT0gJ1RhYicgfHwgZS5rZXkgPT09ICdFbnRlcicgfHwgZS5rZXkgPT09ICdCYWNrc3BhY2UnIHx8IGUua2V5ID09PSAnRGVsZXRlJykgew0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIHVwZGF0ZUhpZ2hsaWdodGVkQ29udGVudCgpOw0KICAgICAgICB9LCAwKTsgLy8gVXBkYXRlIG9uIG5leHQgdGljayBhZnRlciB0aGUga2V5IGV2ZW50IGlzIHByb2Nlc3NlZA0KICAgIH0NCn0NCg0KLy8gSGFuZGxlIGNsaWNrIGV2ZW50cyAoY3Vyc29yIHBvc2l0aW9uIGNoYW5nZXMpDQpmdW5jdGlvbiBoYW5kbGVIaWdobGlnaHRDbGljaygpIHsNCiAgICAvLyBTeW5jIHNjcm9sbCBwb3NpdGlvbiB3aGVuIHVzZXIgY2xpY2tzDQogICAgc3luY0JhY2tkcm9wU2Nyb2xsKCk7DQp9DQoNCi8vIEhhbmRsZSBmb2N1cyBldmVudHMNCmZ1bmN0aW9uIGhhbmRsZUhpZ2hsaWdodEZvY3VzKCkgew0KICAgIC8vIEVuc3VyZSBoaWdobGlnaHRpbmcgaXMgaW4gc3luYyB3aGVuIHRleHRhcmVhIGdldHMgZm9jdXMNCiAgICB1cGRhdGVIaWdobGlnaHRlZENvbnRlbnQoKTsNCiAgICBzeW5jQmFja2Ryb3BTY3JvbGwoKTsNCn0NCg0KLy8gU3luYyBiYWNrZHJvcCBzY3JvbGwgd2l0aCB0ZXh0YXJlYQ0KZnVuY3Rpb24gc3luY0JhY2tkcm9wU2Nyb2xsKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3Iuc2Nyb2xsVG9wID0gdGV4dEVkaXRvci50ZXh0YXJlYS5zY3JvbGxUb3A7DQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3Iuc2Nyb2xsTGVmdCA9IHRleHRFZGl0b3IudGV4dGFyZWEuc2Nyb2xsTGVmdDsNCiAgICB9DQp9DQoNCi8vIENsZWFuIHVwIGhpZ2hsaWdodGVkIGVkaXRvcg0KZnVuY3Rpb24gY2xlYW51cEhpZ2hsaWdodGVkRWRpdG9yKCkgew0KICAgIGlmICh0ZXh0RWRpdG9yLmhpZ2hsaWdodENvbnRhaW5lcikgew0KICAgICAgICAvLyBSZXN0b3JlIG9yaWdpbmFsIHRleHRhcmVhIHN0eWxlcw0KICAgICAgICBpZiAodGV4dEVkaXRvci5vcmlnaW5hbFRleHRhcmVhU3R5bGVzKSB7DQogICAgICAgICAgICBjb25zdCB0ZXh0YXJlYSA9IHRleHRFZGl0b3IudGV4dGFyZWE7DQogICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS5wb3NpdGlvbiA9IHRleHRFZGl0b3Iub3JpZ2luYWxUZXh0YXJlYVN0eWxlcy5wb3NpdGlvbjsNCiAgICAgICAgICAgIHRleHRhcmVhLnN0eWxlLmJhY2tncm91bmQgPSB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMuYmFja2dyb3VuZDsNCiAgICAgICAgICAgIHRleHRhcmVhLnN0eWxlLmNvbG9yID0gdGV4dEVkaXRvci5vcmlnaW5hbFRleHRhcmVhU3R5bGVzLmNvbG9yOw0KICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuekluZGV4ID0gdGV4dEVkaXRvci5vcmlnaW5hbFRleHRhcmVhU3R5bGVzLnpJbmRleDsNCiAgICAgICAgICAgIHRleHRhcmVhLnN0eWxlLmNhcmV0Q29sb3IgPSB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMuY2FyZXRDb2xvcjsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gUmVtb3ZlIHRoZSBjb250YWluZXIgYW5kIHJlc3RvcmUgdGV4dGFyZWEgdG8gaXRzIG9yaWdpbmFsIHBhcmVudA0KICAgICAgICBjb25zdCBlZGl0b3JXcmFwcGVyID0gdGV4dEVkaXRvci5oaWdobGlnaHRDb250YWluZXIucGFyZW50RWxlbWVudDsNCiAgICAgICAgY29uc3QgdGV4dGFyZWEgPSB0ZXh0RWRpdG9yLnRleHRhcmVhOw0KICAgICAgICANCiAgICAgICAgLy8gTW92ZSB0ZXh0YXJlYSBiYWNrIHRvIGl0cyBvcmlnaW5hbCBsb2NhdGlvbg0KICAgICAgICBlZGl0b3JXcmFwcGVyLmluc2VydEJlZm9yZSh0ZXh0YXJlYSwgdGV4dEVkaXRvci5oaWdobGlnaHRDb250YWluZXIpOw0KICAgICAgICANCiAgICAgICAgLy8gUmVtb3ZlIHRoZSBoaWdobGlnaHQgY29udGFpbmVyDQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0Q29udGFpbmVyLnJlbW92ZSgpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgcmVmZXJlbmNlcw0KICAgICAgICB0ZXh0RWRpdG9yLmhpZ2hsaWdodENvbnRhaW5lciA9IG51bGw7DQogICAgICAgIHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IgPSBudWxsOw0KICAgICAgICB0ZXh0RWRpdG9yLm9yaWdpbmFsVGV4dGFyZWFTdHlsZXMgPSBudWxsOw0KICAgIH0NCn0NCg0KLy8gVG9nZ2xlIHN5bnRheCBoaWdobGlnaHRpbmcNCmFzeW5jIGZ1bmN0aW9uIHRvZ2dsZVN5bnRheEhpZ2hsaWdodGluZygpIHsNCiAgICB0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZyA9ICF0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZzsNCiAgICANCiAgICAvLyBTYXZlIHNldHRpbmcNCiAgICB0cnkgew0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkuc2V0U2V0dGluZygnU1lOVEFYX0hJR0hMSUdIVElORycsIHRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nKTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBzeW50YXggaGlnaGxpZ2h0aW5nIHNldHRpbmc6JywgZXJyb3IpOw0KICAgIH0NCiAgICANCiAgICAvLyBVcGRhdGUgVUkNCiAgICBpZiAoc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlKSB7DQogICAgICAgIHN5bnRheEhpZ2hsaWdodGluZ1RvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZyk7DQogICAgfQ0KICAgIA0KICAgIC8vIEFwcGx5IG9yIGRpc2FibGUgaGlnaGxpZ2h0aW5nDQogICAgaWYgKHRleHRFZGl0b3Iuc2V0dGluZ3Muc3ludGF4SGlnaGxpZ2h0aW5nKSB7DQogICAgICAgIGF3YWl0IGVuYWJsZVN5bnRheEhpZ2hsaWdodGluZygpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIERpc2FibGUgaGlnaGxpZ2h0aW5nDQogICAgICAgIGNsZWFudXBIaWdobGlnaHRlZEVkaXRvcigpOw0KICAgICAgICB0ZXh0RWRpdG9yLnN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQgPSBmYWxzZTsNCiAgICB9DQogICAgDQogICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oDQogICAgICAgIGBTeW50YXggaGlnaGxpZ2h0aW5nICR7dGV4dEVkaXRvci5zZXR0aW5ncy5zeW50YXhIaWdobGlnaHRpbmcgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWAsDQogICAgICAgICdpbmZvJw0KICAgICk7DQp9DQoNCg0KLy8gTG9hZCBQeW9kaWRlIGZvciBQeXRob24gc3ludGF4IHZhbGlkYXRpb24NCmFzeW5jIGZ1bmN0aW9uIGxvYWRQeW9kaWRlKCkgew0KICAgIA0KICAgIGlmICh0ZXh0RWRpdG9yLnB5b2RpZGVMb2FkZWQgJiYgd2luZG93LnB5b2RpZGUpIHsNCiAgICAgICAgcmV0dXJuIHdpbmRvdy5weW9kaWRlOw0KICAgIH0NCiAgICANCiAgICB0cnkgew0KICAgICAgICANCiAgICAgICAgLy8gTG9hZCBQeW9kaWRlIHNjcmlwdA0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkubG9hZExpYnJhcnkoJ2h0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9weW9kaWRlL3YwLjI0LjEvZnVsbC9weW9kaWRlLmpzJywgew0KICAgICAgICAgICAgbG9jYWxOYW1lOiAnbG9hZFB5b2RpZGUnDQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgDQogICAgICAgIC8vIEluaXRpYWxpemUgUHlvZGlkZSAtIHVzZSB0aGUgZ2xvYmFsIGxvYWRQeW9kaWRlIGZ1bmN0aW9uDQogICAgICAgIHdpbmRvdy5weW9kaWRlID0gYXdhaXQgd2luZG93LmxvYWRQeW9kaWRlKHsNCiAgICAgICAgICAgIGluZGV4VVJMOiAiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L3B5b2RpZGUvdjAuMjQuMS9mdWxsLyINCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICANCiAgICAgICAgLy8gSW5zdGFsbCB2YWxpZGF0aW9uIGZ1bmN0aW9uDQogICAgICAgIHdpbmRvdy5weW9kaWRlLnJ1blB5dGhvbihgDQppbXBvcnQgYXN0DQoNCmRlZiB2YWxpZGF0ZV9weXRob25fc3ludGF4KGNvZGUpOg0KICAgICIiIlZhbGlkYXRlIFB5dGhvbiBzeW50YXggYW5kIHJldHVybiBlcnJvcnMiIiINCiAgICB0cnk6DQogICAgICAgICMgVHJ5IHRvIHBhcnNlIHRoZSBjb2RlIGFzIGFuIEFTVA0KICAgICAgICBhc3QucGFyc2UoY29kZSkNCiAgICAgICAgcmV0dXJuIHsidmFsaWQiOiBUcnVlLCAiZXJyb3JzIjogW119DQogICAgZXhjZXB0IFN5bnRheEVycm9yIGFzIGU6DQogICAgICAgIGVycm9yX2luZm8gPSB7DQogICAgICAgICAgICAibGluZSI6IGUubGluZW5vIG9yIDEsDQogICAgICAgICAgICAiY29sdW1uIjogZS5vZmZzZXQgb3IgMSwgDQogICAgICAgICAgICAibWVzc2FnZSI6IGUubXNnIG9yICJTeW50YXggZXJyb3IiLA0KICAgICAgICAgICAgInR5cGUiOiAic3ludGF4Ig0KICAgICAgICB9DQogICAgICAgIHJldHVybiB7InZhbGlkIjogRmFsc2UsICJlcnJvcnMiOiBbZXJyb3JfaW5mb119DQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICBlcnJvcl9pbmZvID0gew0KICAgICAgICAgICAgImxpbmUiOiAxLA0KICAgICAgICAgICAgImNvbHVtbiI6IDEsDQogICAgICAgICAgICAibWVzc2FnZSI6IHN0cihlKSwNCiAgICAgICAgICAgICJ0eXBlIjogImdlbmVyYWwiDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHsidmFsaWQiOiBGYWxzZSwgImVycm9ycyI6IFtlcnJvcl9pbmZvXX0NCiAgICAgICAgYCk7DQogICAgICAgIA0KICAgICAgICB0ZXh0RWRpdG9yLnB5b2RpZGVMb2FkZWQgPSB0cnVlOw0KICAgICAgICANCiAgICAgICAgLy8gU2hvdyBub3RpZmljYXRpb24NCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ1B5dGhvbiB2YWxpZGF0aW9uIHJlYWR5IScsICdzdWNjZXNzJyk7DQogICAgICAgIA0KICAgICAgICByZXR1cm4gd2luZG93LnB5b2RpZGU7DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gbG9hZCBQeW9kaWRlOicsIGVycm9yKTsNCiAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ0ZhaWxlZCB0byBsb2FkIFB5dGhvbiB2YWxpZGF0aW9uOiAnICsgZXJyb3IubWVzc2FnZSwgJ2Vycm9yJyk7DQogICAgICAgIHRocm93IGVycm9yOw0KICAgIH0NCn0NCg0KLy8gVmFsaWRhdGUgUHl0aG9uIHN5bnRheCB1c2luZyBQeW9kaWRlDQphc3luYyBmdW5jdGlvbiB2YWxpZGF0ZVB5dGhvblN5bnRheChjb2RlKSB7DQogICAgDQogICAgaWYgKCF0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkKSB7DQogICAgICAgIHJldHVybiB7InZhbGlkIjogdHJ1ZSwgImVycm9ycyI6IFtdfTsNCiAgICB9DQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgcHlvZGlkZSA9IGF3YWl0IGxvYWRQeW9kaWRlKCk7DQogICAgICAgIA0KICAgICAgICAvLyBDYWxsIHRoZSBQeXRob24gdmFsaWRhdGlvbiBmdW5jdGlvbg0KICAgICAgICBweW9kaWRlLmdsb2JhbHMuc2V0KCJjb2RlX3RvX3ZhbGlkYXRlIiwgY29kZSk7DQogICAgICAgIGNvbnN0IHJlc3VsdCA9IHB5b2RpZGUucnVuUHl0aG9uKCJ2YWxpZGF0ZV9weXRob25fc3ludGF4KGNvZGVfdG9fdmFsaWRhdGUpIik7DQogICAgICAgIA0KICAgICAgICBjb25zdCBqc1Jlc3VsdCA9IHJlc3VsdC50b0pzKHtkaWN0X2NvbnZlcnRlcjogT2JqZWN0LmZyb21FbnRyaWVzfSk7DQogICAgICAgIA0KICAgICAgICByZXR1cm4ganNSZXN1bHQ7DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBQeW9kaWRlIHZhbGlkYXRpb24gZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICANCiAgICAgICAgLy8gRmFsbGJhY2sgdG8gYmFzaWMgY2xpZW50LXNpZGUgdmFsaWRhdGlvbg0KICAgICAgICByZXR1cm4gdmFsaWRhdGVQeXRob25CYXNpYyhjb2RlKTsNCiAgICB9DQp9DQoNCi8vIEJhc2ljIFB5dGhvbiBzeW50YXggdmFsaWRhdGlvbiAoZmFsbGJhY2spDQpmdW5jdGlvbiB2YWxpZGF0ZVB5dGhvbkJhc2ljKGNvZGUpIHsNCiAgICBjb25zdCBlcnJvcnMgPSBbXTsNCiAgICBjb25zdCBsaW5lcyA9IGNvZGUuc3BsaXQoJ1xuJyk7DQogICAgDQogICAgbGluZXMuZm9yRWFjaCgobGluZSwgaW5kZXgpID0+IHsNCiAgICAgICAgY29uc3QgbGluZU51bSA9IGluZGV4ICsgMTsNCiAgICAgICAgY29uc3QgdHJpbW1lZCA9IGxpbmUudHJpbSgpOw0KICAgICAgICANCiAgICAgICAgLy8gU2tpcCBlbXB0eSBsaW5lcyBhbmQgY29tbWVudHMNCiAgICAgICAgaWYgKCF0cmltbWVkIHx8IHRyaW1tZWQuc3RhcnRzV2l0aCgnIycpKSByZXR1cm47DQogICAgICAgIA0KICAgICAgICAvLyBDaGVjayBmb3IgdW50ZXJtaW5hdGVkIHN0cmluZ3MgKG1vcmUgYWNjdXJhdGUpDQogICAgICAgIGxldCBpblN0cmluZyA9IGZhbHNlOw0KICAgICAgICBsZXQgc3RyaW5nQ2hhciA9IG51bGw7DQogICAgICAgIGxldCBlc2NhcGVkID0gZmFsc2U7DQogICAgICAgIA0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyaW1tZWQubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGNvbnN0IGNoYXIgPSB0cmltbWVkW2ldOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoZXNjYXBlZCkgew0KICAgICAgICAgICAgICAgIGVzY2FwZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGNoYXIgPT09ICdcXCcpIHsNCiAgICAgICAgICAgICAgICBlc2NhcGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKCFpblN0cmluZyAmJiAoY2hhciA9PT0gJyInIHx8IGNoYXIgPT09ICInIikpIHsNCiAgICAgICAgICAgICAgICBpblN0cmluZyA9IHRydWU7DQogICAgICAgICAgICAgICAgc3RyaW5nQ2hhciA9IGNoYXI7DQogICAgICAgICAgICB9IGVsc2UgaWYgKGluU3RyaW5nICYmIGNoYXIgPT09IHN0cmluZ0NoYXIpIHsNCiAgICAgICAgICAgICAgICBpblN0cmluZyA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIHN0cmluZ0NoYXIgPSBudWxsOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBpZiAoaW5TdHJpbmcpIHsNCiAgICAgICAgICAgIGVycm9ycy5wdXNoKHsNCiAgICAgICAgICAgICAgICBsaW5lOiBsaW5lTnVtLA0KICAgICAgICAgICAgICAgIGNvbHVtbjogMSwNCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAiVW50ZXJtaW5hdGVkIHN0cmluZyBsaXRlcmFsIiwNCiAgICAgICAgICAgICAgICB0eXBlOiAic3ludGF4Ig0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIENoZWNrIGZvciBtaXNzaW5nIGNvbG9ucyBhZnRlciBjb250cm9sIHN0cnVjdHVyZXMgKG1vcmUgcHJlY2lzZSkNCiAgICAgICAgY29uc3QgY29udHJvbFN0cnVjdHVyZXMgPSAvXihpZnxlbGlmfGVsc2V8Zm9yfHdoaWxlfGRlZnxjbGFzc3x0cnl8ZXhjZXB0fGZpbmFsbHl8d2l0aHxhc3luY1xzK2RlZilccy87DQogICAgICAgIGlmIChjb250cm9sU3RydWN0dXJlcy50ZXN0KHRyaW1tZWQpICYmICF0cmltbWVkLmVuZHNXaXRoKCc6JykgJiYgIXRyaW1tZWQuaW5jbHVkZXMoJyMnKSkgew0KICAgICAgICAgICAgZXJyb3JzLnB1c2goew0KICAgICAgICAgICAgICAgIGxpbmU6IGxpbmVOdW0sDQogICAgICAgICAgICAgICAgY29sdW1uOiB0cmltbWVkLmxlbmd0aCwNCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAiTWlzc2luZyBjb2xvbiIsDQogICAgICAgICAgICAgICAgdHlwZTogInN5bnRheCINCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBDaGVjayBmb3IgYmFzaWMgaW5kZW50YXRpb24gZXJyb3JzICh2ZXJ5IGJhc2ljKQ0KICAgICAgICBpZiAodHJpbW1lZC5tYXRjaCgvXihyZXR1cm58YnJlYWt8Y29udGludWV8cGFzc3xyYWlzZXx5aWVsZClccy8pICYmIGxpbmUgIT09IHRyaW1tZWQpIHsNCiAgICAgICAgICAgIC8vIFRoZXNlIGtleXdvcmRzIHNob3VsZCB0eXBpY2FsbHkgYmUgYXQgcHJvcGVyIGluZGVudGF0aW9uIGxldmVscw0KICAgICAgICAgICAgLy8gQnV0IHRoaXMgaXMgdG9vIGNvbXBsZXggZm9yIGJhc2ljIHZhbGlkYXRpb24sIHNvIHNraXAgaXQNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gT25seSBjaGVjayBwYXJlbnRoZXNlcyBvbiBsaW5lcyB0aGF0IHNlZW0gdG8gaGF2ZSBmdW5jdGlvbiBjYWxscyBvciBkZWZpbml0aW9ucw0KICAgICAgICBpZiAodHJpbW1lZC5pbmNsdWRlcygnKCcpIHx8IHRyaW1tZWQuaW5jbHVkZXMoJyknKSkgew0KICAgICAgICAgICAgY29uc3Qgb3BlblBhcmVucyA9ICh0cmltbWVkLm1hdGNoKC9cKC9nKSB8fCBbXSkubGVuZ3RoOw0KICAgICAgICAgICAgY29uc3QgY2xvc2VQYXJlbnMgPSAodHJpbW1lZC5tYXRjaCgvXCkvZykgfHwgW10pLmxlbmd0aDsNCiAgICAgICAgICAgIGlmIChvcGVuUGFyZW5zICE9PSBjbG9zZVBhcmVucykgew0KICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgbGluZTogbGluZU51bSwNCiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiAxLA0KICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAiVW5tYXRjaGVkIHBhcmVudGhlc2VzIiwNCiAgICAgICAgICAgICAgICAgICAgdHlwZTogInN5bnRheCINCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIHJldHVybiB7DQogICAgICAgIHZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLA0KICAgICAgICBlcnJvcnM6IGVycm9ycw0KICAgIH07DQp9DQoNCg0KLy8gU2NoZWR1bGUgdmFsaWRhdGlvbiB3aXRoIGRlYm91bmNpbmcNCmZ1bmN0aW9uIHNjaGVkdWxlVmFsaWRhdGlvbigpIHsNCiAgICANCiAgICAvLyBDbGVhciBleGlzdGluZyB0aW1lcg0KICAgIGlmICh0ZXh0RWRpdG9yLnZhbGlkYXRpb25EZWJvdW5jZVRpbWVyKSB7DQogICAgICAgIGNsZWFyVGltZW91dCh0ZXh0RWRpdG9yLnZhbGlkYXRpb25EZWJvdW5jZVRpbWVyKTsNCiAgICB9DQogICAgDQogICAgLy8gT25seSB2YWxpZGF0ZSBQeXRob24gZmlsZXMNCiAgICBpZiAoIWlzUHl0aG9uRmlsZSh0ZXh0RWRpdG9yLmZpbGVQYXRoKSB8fCAhdGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZCkgew0KICAgICAgICBjbGVhckVycm9yTWFya2VycygpOw0KICAgICAgICB1cGRhdGVFcnJvckNvdW50KDApOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIA0KICAgIC8vIERlYm91bmNlIHZhbGlkYXRpb24gdG8gYXZvaWQgdG9vIGZyZXF1ZW50IGNhbGxzIGFuZCBpbnRlcmZlcmVuY2Ugd2l0aCB0eXBpbmcNCiAgICB0ZXh0RWRpdG9yLnZhbGlkYXRpb25EZWJvdW5jZVRpbWVyID0gc2V0VGltZW91dChhc3luYyAoKSA9PiB7DQogICAgICAgIGNvbnN0IGNvZGUgPSB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlOw0KICAgICAgICANCiAgICAgICAgLy8gRG9uJ3QgdmFsaWRhdGUgZW1wdHkgZmlsZXMNCiAgICAgICAgaWYgKCFjb2RlLnRyaW0oKSkgew0KICAgICAgICAgICAgY2xlYXJFcnJvck1hcmtlcnMoKTsNCiAgICAgICAgICAgIHVwZGF0ZUVycm9yQ291bnQoMCk7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB2YWxpZGF0ZVB5dGhvblN5bnRheChjb2RlKTsNCiAgICAgICAgICAgIGRpc3BsYXlWYWxpZGF0aW9uRXJyb3JzKHJlc3VsdC5lcnJvcnMgfHwgW10pOw0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFZhbGlkYXRpb24gc2NoZWR1bGluZyBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIH0NCiAgICB9LCAxMDAwKTsgLy8gMTAwMG1zIGRlbGF5IC0gbXVjaCBsb25nZXIgdG8gYXZvaWQgaW50ZXJmZXJpbmcgd2l0aCBmYXN0IHR5cGluZw0KfQ0KDQovLyBEaXNwbGF5IHZhbGlkYXRpb24gZXJyb3JzIGluIHRoZSBlZGl0b3INCmZ1bmN0aW9uIGRpc3BsYXlWYWxpZGF0aW9uRXJyb3JzKGVycm9ycykgew0KICAgIC8vIENsZWFyIHByZXZpb3VzIGVycm9ycw0KICAgIGNsZWFyRXJyb3JNYXJrZXJzKCk7DQogICAgDQogICAgLy8gU3RvcmUgY3VycmVudCBlcnJvcnMNCiAgICB0ZXh0RWRpdG9yLmN1cnJlbnRFcnJvcnMgPSBlcnJvcnM7DQogICAgDQogICAgLy8gVXBkYXRlIGVycm9yIGNvdW50DQogICAgdXBkYXRlRXJyb3JDb3VudChlcnJvcnMubGVuZ3RoKTsNCiAgICANCiAgICAvLyBBZGQgZXJyb3IgbWFya2Vycw0KICAgIGVycm9ycy5mb3JFYWNoKGVycm9yID0+IHsNCiAgICAgICAgYWRkRXJyb3JNYXJrZXIoZXJyb3IubGluZSwgZXJyb3IubWVzc2FnZSwgZXJyb3IudHlwZSk7DQogICAgfSk7DQogICAgDQp9DQoNCg0KLy8gQWRkIGVycm9yIG1hcmtlciB0byBhIHNwZWNpZmljIGxpbmUNCmZ1bmN0aW9uIGFkZEVycm9yTWFya2VyKGxpbmVOdW1iZXIsIG1lc3NhZ2UsIHR5cGUgPSAnc3ludGF4Jykgew0KICAgIGlmICghdGV4dEVkaXRvci5saW5lTnVtYmVycyB8fCBsaW5lTnVtYmVyIDwgMSkgcmV0dXJuOw0KICAgIA0KICAgIC8vIEZpbmQgdGhlIGxpbmUgbnVtYmVyIGVsZW1lbnQNCiAgICBjb25zdCBsaW5lTnVtYmVyRWxlbWVudHMgPSB0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzLmNoaWxkcmVuOw0KICAgIGNvbnN0IGxpbmVJbmRleCA9IGxpbmVOdW1iZXIgLSAxOyAvLyBDb252ZXJ0IHRvIDAtYmFzZWQgaW5kZXgNCiAgICANCiAgICBpZiAobGluZUluZGV4IDwgbGluZU51bWJlckVsZW1lbnRzLmxlbmd0aCkgew0KICAgICAgICBjb25zdCBsaW5lRWwgPSBsaW5lTnVtYmVyRWxlbWVudHNbbGluZUluZGV4XTsNCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBlcnJvciBjbGFzcw0KICAgICAgICBsaW5lRWwuY2xhc3NMaXN0LmFkZCgnbGluZS1lcnJvcicpOw0KICAgICAgICBsaW5lRWwudGl0bGUgPSBgTGluZSAke2xpbmVOdW1iZXJ9OiAke21lc3NhZ2V9YDsNCiAgICAgICAgDQogICAgICAgIC8vIFN0b3JlIGVycm9yIGluZm8gZm9yIGNsZWFudXANCiAgICAgICAgdGV4dEVkaXRvci5lcnJvck1hcmtlcnMucHVzaChsaW5lRWwpOw0KICAgIH0NCiAgICANCiAgICAvLyBBbHNvIHRyeSB0byBhZGQgdW5kZXJsaW5lIHRvIHRoZSB0ZXh0IGlmIHVzaW5nIGhpZ2hsaWdodGVkIGVkaXRvcg0KICAgIGlmICh0ZXh0RWRpdG9yLmhpZ2hsaWdodGVkRWRpdG9yKSB7DQogICAgICAgIGFkZEVycm9yVW5kZXJsaW5lKGxpbmVOdW1iZXIsIG1lc3NhZ2UpOw0KICAgIH0NCn0NCg0KLy8gQWRkIGVycm9yIHVuZGVybGluZSB0byBoaWdobGlnaHRlZCBlZGl0b3IgKGJhc2ljIGltcGxlbWVudGF0aW9uKQ0KZnVuY3Rpb24gYWRkRXJyb3JVbmRlcmxpbmUobGluZU51bWJlciwgbWVzc2FnZSkgew0KICAgIC8vIFRoaXMgaXMgYSBzaW1wbGlmaWVkIHZlcnNpb24gLSB3ZSBjb3VsZCBtYWtlIGl0IG1vcmUgc29waGlzdGljYXRlZA0KICAgIC8vIEZvciBub3csIHdlJ2xsIHJlbHkgb24gdGhlIGxpbmUgbnVtYmVyIGhpZ2hsaWdodGluZw0KfQ0KDQovLyBDbGVhciBhbGwgZXJyb3IgbWFya2Vycw0KZnVuY3Rpb24gY2xlYXJFcnJvck1hcmtlcnMoKSB7DQogICAgLy8gQ2xlYXIgbGluZSBudW1iZXIgZXJyb3IgY2xhc3Nlcw0KICAgIHRleHRFZGl0b3IuZXJyb3JNYXJrZXJzLmZvckVhY2gobGluZUVsID0+IHsNCiAgICAgICAgbGluZUVsLmNsYXNzTGlzdC5yZW1vdmUoJ2xpbmUtZXJyb3InKTsNCiAgICAgICAgbGluZUVsLnJlbW92ZUF0dHJpYnV0ZSgndGl0bGUnKTsNCiAgICB9KTsNCiAgICANCiAgICB0ZXh0RWRpdG9yLmVycm9yTWFya2VycyA9IFtdOw0KICAgIHRleHRFZGl0b3IuY3VycmVudEVycm9ycyA9IFtdOw0KfQ0KDQovLyBVcGRhdGUgZXJyb3IgY291bnQgaW4gc3RhdHVzIGJhcg0KZnVuY3Rpb24gdXBkYXRlRXJyb3JDb3VudChjb3VudCkgew0KICAgIGlmIChlcnJvckNvdW50RWwpIHsNCiAgICAgICAgZXJyb3JDb3VudEVsLnRleHRDb250ZW50ID0gY291bnQudG9TdHJpbmcoKTsNCiAgICAgICAgZXJyb3JDb3VudEVsLnN0eWxlLmNvbG9yID0gY291bnQgPiAwID8gJyNmZjZiNmInIDogJyM1MWNmNjYnOw0KICAgIH0NCn0NCg0KLy8gU2V0IHVwIGV2ZW50IGhhbmRsZXJzDQpmdW5jdGlvbiBzZXR1cEV2ZW50SGFuZGxlcnMoKSB7DQogICAgLy8gQnV0dG9uIGV2ZW50cw0KICAgIG5ld0ZpbGVCdG4/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY3JlYXRlTmV3RmlsZSk7DQogICAgbG9hZEZpbGVCdG4/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbG9hZEZpbGUpOw0KICAgIHNhdmVGaWxlQnRuPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhdmVGaWxlKTsNCiAgICBzYXZlQXNGaWxlQnRuPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhdmVBc0ZpbGUpOw0KICAgIHdvcmRXcmFwVG9nZ2xlPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVdvcmRXcmFwKTsNCiAgICBsaW5lTnVtYmVyc1RvZ2dsZT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVMaW5lTnVtYmVycyk7DQogICAgc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVN5bnRheEhpZ2hsaWdodGluZyk7DQogICAgdmFsaWRhdGlvblRvZ2dsZT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVWYWxpZGF0aW9uKTsNCiAgICANCiAgICAvLyBUZXh0YXJlYSBldmVudHMNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgaGFuZGxlVGV4dENoYW5nZSk7DQogICAgdGV4dEVkaXRvci50ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBzeW5jU2Nyb2xsKTsNCiAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVLZXlEb3duKTsNCiAgICANCg0KICAgIA0KICAgIC8vIFdpbmRvdyBldmVudHMNCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgaGFuZGxlQmVmb3JlVW5sb2FkKTsNCn0NCg0KDQoNCi8vIEhhbmRsZSBrZXlib2FyZCBzaG9ydGN1dHMNCmZ1bmN0aW9uIGhhbmRsZUtleURvd24oZSkgew0KICAgIC8vIEN0cmwvQ21kICsgUzogU2F2ZQ0KICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkgPT09ICdzJyAmJiAhZS5zaGlmdEtleSkgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHNhdmVGaWxlKCk7DQogICAgfQ0KICAgIA0KICAgIC8vIEN0cmwvQ21kICsgU2hpZnQgKyBTOiBTYXZlIEFzDQogICAgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLnNoaWZ0S2V5ICYmIGUua2V5ID09PSAnUycpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBzYXZlQXNGaWxlKCk7DQogICAgfQ0KICAgIA0KICAgIC8vIEN0cmwvQ21kICsgTjogTmV3IGZpbGUNCiAgICBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5ID09PSAnbicpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBjcmVhdGVOZXdGaWxlKCk7DQogICAgfQ0KICAgIA0KICAgIC8vIEN0cmwvQ21kICsgTzogTG9hZCBmaWxlDQogICAgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJ28nKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgbG9hZEZpbGUoKTsNCiAgICB9DQogICAgDQogICAgLy8gQ3RybC9DbWQgKyBTaGlmdCArIFY6IEZvcmNlIHZhbGlkYXRpb24NCiAgICBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS5rZXkgPT09ICdWJykgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGlmIChpc1B5dGhvbkZpbGUodGV4dEVkaXRvci5maWxlUGF0aCkpIHsNCiAgICAgICAgICAgIHNjaGVkdWxlVmFsaWRhdGlvbigpOw0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ1ZhbGlkYXRpb24gdHJpZ2dlcmVkIG1hbnVhbGx5JywgJ2luZm8nKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdOb3QgYSBQeXRob24gZmlsZScsICd3YXJuaW5nJyk7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgLy8gVGFiIGhhbmRsaW5nDQogICAgaWYgKGUua2V5ID09PSAnVGFiJykgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGNvbnN0IHN0YXJ0ID0gdGV4dEVkaXRvci50ZXh0YXJlYS5zZWxlY3Rpb25TdGFydDsNCiAgICAgICAgY29uc3QgZW5kID0gdGV4dEVkaXRvci50ZXh0YXJlYS5zZWxlY3Rpb25FbmQ7DQogICAgICAgIGNvbnN0IHNwYWNlcyA9ICcgJy5yZXBlYXQodGV4dEVkaXRvci5zZXR0aW5ncy50YWJTaXplKTsNCiAgICAgICAgDQogICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUgPSANCiAgICAgICAgICAgIHRleHRFZGl0b3IudGV4dGFyZWEudmFsdWUuc3Vic3RyaW5nKDAsIHN0YXJ0KSArIA0KICAgICAgICAgICAgc3BhY2VzICsgDQogICAgICAgICAgICB0ZXh0RWRpdG9yLnRleHRhcmVhLnZhbHVlLnN1YnN0cmluZyhlbmQpOw0KICAgICAgICANCiAgICAgICAgdGV4dEVkaXRvci50ZXh0YXJlYS5zZWxlY3Rpb25TdGFydCA9IHRleHRFZGl0b3IudGV4dGFyZWEuc2VsZWN0aW9uRW5kID0gc3RhcnQgKyBzcGFjZXMubGVuZ3RoOw0KICAgICAgICANCiAgICAgICAgLy8gTWFudWFsbHkgdHJpZ2dlciBjb250ZW50IHVwZGF0ZSBzaW5jZSB3ZSBwcmV2ZW50ZWQgdGhlIGRlZmF1bHQNCiAgICAgICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICAgICAgbWFya0FzTW9kaWZpZWQoKTsNCiAgICAgICAgaWYgKHRleHRFZGl0b3Iuc3ludGF4SGlnaGxpZ2h0aW5nRW5hYmxlZCkgew0KICAgICAgICAgICAgdXBkYXRlSGlnaGxpZ2h0ZWRDb250ZW50KCk7DQogICAgICAgIH0NCiAgICAgICAgc2NoZWR1bGVWYWxpZGF0aW9uKCk7DQogICAgfQ0KfQ0KDQoNCi8vIFRvZ2dsZSB3b3JkIHdyYXANCmZ1bmN0aW9uIHRvZ2dsZVdvcmRXcmFwKCkgew0KICAgIHRleHRFZGl0b3Iud29yZFdyYXBFbmFibGVkID0gIXRleHRFZGl0b3Iud29yZFdyYXBFbmFibGVkOw0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEuY2xhc3NMaXN0LnRvZ2dsZSgnd29yZC13cmFwJywgdGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQpOw0KICAgIA0KICAgIC8vIFVwZGF0ZSBoaWdobGlnaHRlZCBlZGl0b3IgaWYgaXQgZXhpc3RzDQogICAgaWYgKHRleHRFZGl0b3IuaGlnaGxpZ2h0ZWRFZGl0b3IpIHsNCiAgICAgICAgdGV4dEVkaXRvci5oaWdobGlnaHRlZEVkaXRvci5zdHlsZS53b3JkV3JhcCA9IHRleHRFZGl0b3Iud29yZFdyYXBFbmFibGVkID8gJ2JyZWFrLXdvcmQnIDogJ25vcm1hbCc7DQogICAgfQ0KICAgIA0KICAgIGlmICh3b3JkV3JhcFRvZ2dsZSkgew0KICAgICAgICB3b3JkV3JhcFRvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLndvcmRXcmFwRW5hYmxlZCk7DQogICAgfQ0KICAgIA0KICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKA0KICAgICAgICBgV29yZCB3cmFwICR7dGV4dEVkaXRvci53b3JkV3JhcEVuYWJsZWQgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWAsDQogICAgICAgICdpbmZvJw0KICAgICk7DQp9DQoNCi8vIFRvZ2dsZSBsaW5lIG51bWJlcnMNCmZ1bmN0aW9uIHRvZ2dsZUxpbmVOdW1iZXJzKCkgew0KICAgIHRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkID0gIXRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkOw0KICAgIHRleHRFZGl0b3IubGluZU51bWJlcnMuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJywgIXRleHRFZGl0b3IubGluZU51bWJlcnNFbmFibGVkKTsNCiAgICANCiAgICBpZiAobGluZU51bWJlcnNUb2dnbGUpIHsNCiAgICAgICAgbGluZU51bWJlcnNUb2dnbGUuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywgdGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQpOw0KICAgIH0NCiAgICANCiAgICBpZiAodGV4dEVkaXRvci5saW5lTnVtYmVyc0VuYWJsZWQpIHsNCiAgICAgICAgdXBkYXRlTGluZU51bWJlcnMoKTsNCiAgICB9DQogICAgDQogICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oDQogICAgICAgIGBMaW5lIG51bWJlcnMgJHt0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzRW5hYmxlZCA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCd9YCwNCiAgICAgICAgJ2luZm8nDQogICAgKTsNCn0NCg0KDQovLyBUb2dnbGUgY29kZSB2YWxpZGF0aW9uDQphc3luYyBmdW5jdGlvbiB0b2dnbGVWYWxpZGF0aW9uKCkgew0KICAgIHRleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQgPSAhdGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZDsNCiAgICANCiAgICAvLyBTYXZlIHNldHRpbmcNCiAgICB0cnkgew0KICAgICAgICBhd2FpdCBzeXBuZXhBUEkuc2V0U2V0dGluZygnQ09ERV9WQUxJREFUSU9OJywgdGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZCk7DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNhdmUgdmFsaWRhdGlvbiBzZXR0aW5nOicsIGVycm9yKTsNCiAgICB9DQogICAgDQogICAgLy8gVXBkYXRlIFVJDQogICAgaWYgKHZhbGlkYXRpb25Ub2dnbGUpIHsNCiAgICAgICAgdmFsaWRhdGlvblRvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkKTsNCiAgICB9DQogICAgDQogICAgLy8gQXBwbHkgdmFsaWRhdGlvbiBpZiBlbmFibGVkLCBvdGhlcndpc2UgY2xlYXIgZXJyb3JzDQogICAgaWYgKHRleHRFZGl0b3IudmFsaWRhdGlvbkVuYWJsZWQpIHsNCiAgICAgICAgc2NoZWR1bGVWYWxpZGF0aW9uKCk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgY2xlYXJFcnJvck1hcmtlcnMoKTsNCiAgICAgICAgdXBkYXRlRXJyb3JDb3VudCgwKTsNCiAgICB9DQogICAgDQogICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oDQogICAgICAgIGBDb2RlIHZhbGlkYXRpb24gJHt0ZXh0RWRpdG9yLnZhbGlkYXRpb25FbmFibGVkID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJ31gLA0KICAgICAgICAnaW5mbycNCiAgICApOw0KfQ0KDQoNCi8vIEhhbmRsZSBiZWZvcmUgdW5sb2FkDQpmdW5jdGlvbiBoYW5kbGVCZWZvcmVVbmxvYWQoZSkgew0KICAgIGlmICh0ZXh0RWRpdG9yLmlzTW9kaWZpZWQpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBlLnJldHVyblZhbHVlID0gJ1lvdSBoYXZlIHVuc2F2ZWQgY2hhbmdlcy4gQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGxlYXZlPyc7DQogICAgICAgIHJldHVybiBlLnJldHVyblZhbHVlOw0KICAgIH0NCn0NCg0KDQovLyBUZXh0IEVkaXRvciBBcHANCg0KLy8gR2xvYmFsIHZhcmlhYmxlcw0KbGV0IHRleHRFZGl0b3IgPSB7DQogICAgdGV4dGFyZWE6IG51bGwsDQogICAgbGluZU51bWJlcnM6IG51bGwsDQogICAgZmlsZVBhdGg6IG51bGwsDQogICAgb3JpZ2luYWxDb250ZW50OiAnJywNCiAgICBpc01vZGlmaWVkOiBmYWxzZSwNCiAgICBhdXRvU2F2ZUludGVydmFsOiBudWxsLA0KICAgIHdvcmRXcmFwRW5hYmxlZDogZmFsc2UsDQogICAgbGluZU51bWJlcnNFbmFibGVkOiB0cnVlLA0KICAgIHNldHRpbmdzOiB7fSwNCiAgICAvLyBTeW50YXggaGlnaGxpZ2h0aW5nDQogICAgcHJpc21Mb2FkZWQ6IGZhbHNlLA0KICAgIHN5bnRheEhpZ2hsaWdodGluZ0VuYWJsZWQ6IGZhbHNlLA0KICAgIGhpZ2hsaWdodGVkRWRpdG9yOiBudWxsLA0KICAgIGhpZ2hsaWdodENvbnRhaW5lcjogbnVsbCwNCiAgICBvcmlnaW5hbFRleHRhcmVhU3R5bGVzOiBudWxsLA0KICAgIGRlYm91bmNlVGltZXI6IG51bGwsDQogICAgLy8gQ3Vyc29yIHBvc2l0aW9uIHRyYWNraW5nDQogICAgY3Vyc29yUG9zaXRpb246IDAsDQogICAgLy8gQ29kZSB2YWxpZGF0aW9uDQogICAgcHlvZGlkZUxvYWRlZDogZmFsc2UsDQogICAgdmFsaWRhdGlvbkVuYWJsZWQ6IHRydWUsDQogICAgdmFsaWRhdGlvbkRlYm91bmNlVGltZXI6IG51bGwsDQogICAgY3VycmVudEVycm9yczogW10sDQogICAgZXJyb3JNYXJrZXJzOiBbXQ0KfTsNCg0KLy8gRE9NIGVsZW1lbnRzDQpsZXQgbmV3RmlsZUJ0biwgbG9hZEZpbGVCdG4sIHNhdmVGaWxlQnRuLCBzYXZlQXNGaWxlQnRuOw0KbGV0IGN1cnJlbnRGaWxlbmFtZUVsLCB3b3JkV3JhcFRvZ2dsZSwgbGluZU51bWJlcnNUb2dnbGUsIHN5bnRheEhpZ2hsaWdodGluZ1RvZ2dsZSwgdmFsaWRhdGlvblRvZ2dsZTsNCmxldCBtb2RpZmllZFN0YXR1c0VsLCBlcnJvckNvdW50RWw7DQoNCi8vIEluaXRpYWxpemUgd2hlbiBET00gaXMgcmVhZHkNCmFzeW5jIGZ1bmN0aW9uIGluaXRUZXh0RWRpdG9yKCkgew0KICAgIA0KICAgIC8vIENoZWNrIGlmIFN5cG5leEFQSSBpcyBhdmFpbGFibGUNCiAgICBpZiAodHlwZW9mIHN5cG5leEFQSSA9PT0gJ3VuZGVmaW5lZCcgfHwgIXN5cG5leEFQSSkgew0KICAgICAgICBjb25zb2xlLndhcm4oJ1N5cG5leEFQSSBub3QgYXZhaWxhYmxlIC0gcnVubmluZyBpbiBzdGFuZGFsb25lIG1vZGUnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIA0KICAgIC8vIFRlc3QgaWYgYXBwIGNvbnRhaW5lciBleGlzdHMNCiAgICBjb25zdCBhcHBDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXBwLWNvbnRhaW5lcicpOw0KICAgIGlmIChhcHBDb250YWluZXIpIHsNCiAgICB9DQogICAgDQogICAgLy8gR2V0IERPTSBlbGVtZW50cw0KICAgIHRleHRFZGl0b3IudGV4dGFyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGV4dC1lZGl0b3InKTsNCiAgICB0ZXh0RWRpdG9yLmxpbmVOdW1iZXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmUtbnVtYmVycycpOw0KICAgIA0KICAgIG5ld0ZpbGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3LWZpbGUnKTsNCiAgICBsb2FkRmlsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkLWZpbGUnKTsNCiAgICBzYXZlRmlsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlLWZpbGUnKTsNCiAgICBzYXZlQXNGaWxlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmUtYXMtZmlsZScpOw0KICAgIGN1cnJlbnRGaWxlbmFtZUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1cnJlbnQtZmlsZW5hbWUnKTsNCiAgICB3b3JkV3JhcFRvZ2dsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3b3JkLXdyYXAtdG9nZ2xlJyk7DQogICAgbGluZU51bWJlcnNUb2dnbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluZS1udW1iZXJzLXRvZ2dsZScpOw0KICAgIHN5bnRheEhpZ2hsaWdodGluZ1RvZ2dsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzeW50YXgtaGlnaGxpZ2h0aW5nLXRvZ2dsZScpOw0KICAgIHZhbGlkYXRpb25Ub2dnbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmFsaWRhdGlvbi10b2dnbGUnKTsNCiAgICANCiAgICBtb2RpZmllZFN0YXR1c0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGlmaWVkLXN0YXR1cycpOw0KICAgIGVycm9yQ291bnRFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvci1jb3VudCcpOw0KICAgIA0KICAgIC8vIENyaXRpY2FsIGVsZW1lbnQgY2hlY2tzDQogICAgaWYgKCF0ZXh0RWRpdG9yLnRleHRhcmVhKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RleHQgZWRpdG9yIHRleHRhcmVhIG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGlmICghdGV4dEVkaXRvci5saW5lTnVtYmVycykgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdMaW5lIG51bWJlcnMgZWxlbWVudCBub3QgZm91bmQnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICANCiAgICAvLyBMb2FkIHNldHRpbmdzIChXQUlUIGZvciB0aGVtIHRvIGNvbXBsZXRlKQ0KICAgIGF3YWl0IGxvYWRTZXR0aW5ncygpOw0KICAgIA0KICAgIC8vIFNldCB1cCBldmVudCBoYW5kbGVycw0KICAgIHNldHVwRXZlbnRIYW5kbGVycygpOw0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgZWRpdG9yIHN0YXRlDQogICAgaW5pdGlhbGl6ZUVkaXRvcigpOw0KICAgIA0KICAgIC8vIFNldCBpbml0aWFsIGJ1dHRvbiBzdGF0ZXMNCiAgICBpZiAoc3ludGF4SGlnaGxpZ2h0aW5nVG9nZ2xlKSB7DQogICAgICAgIHN5bnRheEhpZ2hsaWdodGluZ1RvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0ZXh0RWRpdG9yLnNldHRpbmdzLnN5bnRheEhpZ2hsaWdodGluZyk7DQogICAgfQ0KICAgIGlmICh2YWxpZGF0aW9uVG9nZ2xlKSB7DQogICAgICAgIHZhbGlkYXRpb25Ub2dnbGUuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywgdGV4dEVkaXRvci52YWxpZGF0aW9uRW5hYmxlZCk7DQogICAgfQ0KICAgIA0KICAgIC8vIFRleHQgRWRpdG9yIGxvYWRlZCBzdWNjZXNzZnVsbHkgKG5vIG5vdGlmaWNhdGlvbiBuZWVkZWQpDQogICAgDQogICAgLy8gQ2hlY2sgZm9yIHBlbmRpbmcgaW50ZW50cyBBRlRFUiBldmVyeXRoaW5nIGlzIGZ1bGx5IGluaXRpYWxpemVkDQogICAgY2hlY2tGb3JBcHBJbnRlbnQoKTsNCiAgICANCn0NCg0KLy8gQ2hlY2sgZm9yIGFwcCBpbnRlbnRzIChlLmcuLCBmaWxlIHRvIG9wZW4gZnJvbSBWRlMpDQphc3luYyBmdW5jdGlvbiBjaGVja0ZvckFwcEludGVudCgpIHsNCiAgICB0cnkgew0KICAgICAgICBjb25zb2xlLmxvZygnVGV4dCBFZGl0b3I6IENoZWNraW5nIGZvciBhcHAgaW50ZW50Li4uJyk7DQogICAgICAgIA0KICAgICAgICAvLyBSZWFkIGludGVudCBmcm9tIHVzZXIgcHJlZmVyZW5jZXMgKHdoZXJlIGl0J3Mgc3RvcmVkKQ0KICAgICAgICBjb25zdCBpbnRlbnREYXRhID0gYXdhaXQgc3lwbmV4QVBJLmdldFByZWZlcmVuY2UoJ3RleHRfZWRpdG9yJywgJ19wZW5kaW5nX2ludGVudCcsIG51bGwpOw0KICAgICAgICBjb25zb2xlLmxvZygnVGV4dCBFZGl0b3I6IEludGVudCBkYXRhIGZyb20gcHJlZmVyZW5jZXM6JywgaW50ZW50RGF0YSk7DQogICAgICAgIA0KICAgICAgICBpZiAoaW50ZW50RGF0YSAmJiBpbnRlbnREYXRhLmFjdGlvbiA9PT0gJ29wZW5fZmlsZScpIHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdUZXh0IEVkaXRvcjogUHJvY2Vzc2luZyBmaWxlIG9wZW4gaW50ZW50OicsIGludGVudERhdGEpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBmaWxlRGF0YSA9IGludGVudERhdGEuZGF0YTsNCiAgICAgICAgICAgIGlmIChmaWxlRGF0YSAmJiBmaWxlRGF0YS5maWxlUGF0aCkgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdUZXh0IEVkaXRvcjogTG9hZGluZyBmaWxlOicsIGZpbGVEYXRhLmZpbGVQYXRoKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBVc2UgZXhpc3RpbmcgZmlsZSBsb2FkaW5nIGxvZ2ljIGluc3RlYWQgb2YgZHVwbGljYXRpbmcgaXQNCiAgICAgICAgICAgICAgICBhd2FpdCBsb2FkRmlsZUJ5UGF0aChmaWxlRGF0YS5maWxlUGF0aCk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIGludGVudCBzaW5jZSB3ZSBjb25zdW1lZCBpdCAoc2V0IHRvIG51bGwpDQogICAgICAgICAgICAgICAgYXdhaXQgc3lwbmV4QVBJLnNldFByZWZlcmVuY2UoJ3RleHRfZWRpdG9yJywgJ19wZW5kaW5nX2ludGVudCcsIG51bGwpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdUZXh0IEVkaXRvcjogU3VjY2Vzc2Z1bGx5IG9wZW5lZCBmaWxlIGZyb20gaW50ZW50Jyk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignVGV4dCBFZGl0b3I6IEludmFsaWQgZmlsZSBkYXRhIGluIGludGVudDonLCBmaWxlRGF0YSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjb25zb2xlLmxvZygnVGV4dCBFZGl0b3I6IE5vIGludGVudCBmb3VuZCBvciB3cm9uZyBhY3Rpb24gdHlwZScpOw0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVGV4dCBFZGl0b3I6IEVycm9yIGNoZWNraW5nIGZvciBhcHAgaW50ZW50OicsIGVycm9yKTsNCiAgICB9DQp9DQoNCg0KDQoNCg0KDQovLyBSZXBsYWNlIHRoZSBvcmlnaW5hbCBpbml0VGV4dEVkaXRvciBjYWxsDQppZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXRUZXh0RWRpdG9yKTsNCn0gZWxzZSB7DQogICAgLy8gRE9NIGlzIGFscmVhZHkgbG9hZGVkDQogICAgaW5pdFRleHRFZGl0b3IoKTsNCn0gPC9zY3JpcHQ+"
  },
  "package_info": {
    "format_version": "1.0",
    "created_at": "2025-07-24T08:15:41.021554",
    "packaged_by": "Sypnex OS App Packager",
    "source_directory": ".\\text_editor"
  }
}