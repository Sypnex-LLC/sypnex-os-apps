{
  "app_metadata": {
    "id": "flow_editor",
    "name": "Flow Editor",
    "description": "Visual node-based workflow editor for creating and executing data processing pipelines",
    "icon": "fas fa-project-diagram",
    "keywords": [
      "flow",
      "workflow",
      "nodes",
      "pipeline",
      "visual",
      "editor"
    ],
    "author": "Sypnex OS",
    "version": "1.1.7",
    "type": "user_app",
    "scripts": [
      "js/utils.js",
      "js/node-registry.js",
      "js/canvas.js",
      "js/node-config.js",
      "js/node-renderer.js",
      "js/data-executors.js",
      "js/http-executors.js",
      "js/media-executors.js",
      "js/flow-executors.js",
      "js/ai-executors.js",
      "js/execution-engine.js",
      "js/workflow.js",
      "js/canvas-manager.js",
      "js/tag-manager.js",
      "js/file-manager.js",
      "js/ui-manager.js",
      "js/main.js"
    ],
    "styles": [
      "css/layout.css",
      "css/nodes.css",
      "css/components.css",
      "css/node-types.css",
      "css/responsive.css",
      "css/performance.css",
      "css/os-theme.css"
    ],
    "additional_files": [
      {
        "vfs_path": "/nodes/nodes-pack.json",
        "source_file": "node-definitions/nodes-pack.json"
      }
    ],
    "settings": [
      {
        "key": "DEFAULT_HTTP_TIMEOUT",
        "name": "HTTP Timeout (ms)",
        "type": "number",
        "value": 30000,
        "description": "Default timeout for HTTP requests in milliseconds"
      },
      {
        "key": "AUTO_SAVE_INTERVAL",
        "name": "Auto Save Interval (s)",
        "type": "number",
        "value": 30,
        "description": "Auto save workflows every N seconds (0 = disabled)"
      },
      {
        "key": "MAX_NODES",
        "name": "Maximum Nodes",
        "type": "number",
        "value": 50,
        "description": "Maximum number of nodes allowed in a workflow"
      }
    ]
  },
  "files": {
    "flow_editor.app": "ew0KICAiaWQiOiAiZmxvd19lZGl0b3IiLA0KICAibmFtZSI6ICJGbG93IEVkaXRvciIsDQogICJkZXNjcmlwdGlvbiI6ICJWaXN1YWwgbm9kZS1iYXNlZCB3b3JrZmxvdyBlZGl0b3IgZm9yIGNyZWF0aW5nIGFuZCBleGVjdXRpbmcgZGF0YSBwcm9jZXNzaW5nIHBpcGVsaW5lcyIsDQogICJpY29uIjogImZhcyBmYS1wcm9qZWN0LWRpYWdyYW0iLA0KICAia2V5d29yZHMiOiBbImZsb3ciLCAid29ya2Zsb3ciLCAibm9kZXMiLCAicGlwZWxpbmUiLCAidmlzdWFsIiwgImVkaXRvciJdLA0KICAiYXV0aG9yIjogIlN5cG5leCBPUyIsDQogICJ2ZXJzaW9uIjogIjEuMS43IiwNCiAgInR5cGUiOiAidXNlcl9hcHAiLA0KICAic2NyaXB0cyI6IFsNCiAgICAianMvdXRpbHMuanMiLA0KICAgICJqcy9ub2RlLXJlZ2lzdHJ5LmpzIiwNCiAgICAianMvY2FudmFzLmpzIiwNCiAgICAianMvbm9kZS1jb25maWcuanMiLA0KICAgICJqcy9ub2RlLXJlbmRlcmVyLmpzIiwNCiAgICAianMvZGF0YS1leGVjdXRvcnMuanMiLA0KICAgICJqcy9odHRwLWV4ZWN1dG9ycy5qcyIsDQogICAgImpzL21lZGlhLWV4ZWN1dG9ycy5qcyIsDQogICAgImpzL2Zsb3ctZXhlY3V0b3JzLmpzIiwNCiAgICAianMvYWktZXhlY3V0b3JzLmpzIiwNCiAgICAianMvZXhlY3V0aW9uLWVuZ2luZS5qcyIsDQogICAgImpzL3dvcmtmbG93LmpzIiwNCiAgICAianMvY2FudmFzLW1hbmFnZXIuanMiLA0KICAgICJqcy90YWctbWFuYWdlci5qcyIsDQogICAgImpzL2ZpbGUtbWFuYWdlci5qcyIsDQogICAgImpzL3VpLW1hbmFnZXIuanMiLA0KICAgICJqcy9tYWluLmpzIg0KICBdLA0KICAic3R5bGVzIjogWw0KICAgICJjc3MvbGF5b3V0LmNzcyIsDQogICAgImNzcy9ub2Rlcy5jc3MiLA0KICAgICJjc3MvY29tcG9uZW50cy5jc3MiLA0KICAgICJjc3Mvbm9kZS10eXBlcy5jc3MiLA0KICAgICJjc3MvcmVzcG9uc2l2ZS5jc3MiLA0KICAgICJjc3MvcGVyZm9ybWFuY2UuY3NzIiwNCiAgICAiY3NzL29zLXRoZW1lLmNzcyINCiAgXSwNCiAgImFkZGl0aW9uYWxfZmlsZXMiOiBbDQogICAgew0KICAgICAgInZmc19wYXRoIjogIi9ub2Rlcy9ub2Rlcy1wYWNrLmpzb24iLA0KICAgICAgInNvdXJjZV9maWxlIjogIm5vZGUtZGVmaW5pdGlvbnMvbm9kZXMtcGFjay5qc29uIg0KICAgIH0NCiAgXSwNCiAgInNldHRpbmdzIjogWw0KICAgIHsNCiAgICAgICJrZXkiOiAiREVGQVVMVF9IVFRQX1RJTUVPVVQiLA0KICAgICAgIm5hbWUiOiAiSFRUUCBUaW1lb3V0IChtcykiLA0KICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICJ2YWx1ZSI6IDMwMDAwLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkRlZmF1bHQgdGltZW91dCBmb3IgSFRUUCByZXF1ZXN0cyBpbiBtaWxsaXNlY29uZHMiDQogICAgfSwNCiAgICB7DQogICAgICAia2V5IjogIkFVVE9fU0FWRV9JTlRFUlZBTCIsDQogICAgICAibmFtZSI6ICJBdXRvIFNhdmUgSW50ZXJ2YWwgKHMpIiwNCiAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAidmFsdWUiOiAzMCwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJBdXRvIHNhdmUgd29ya2Zsb3dzIGV2ZXJ5IE4gc2Vjb25kcyAoMCA9IGRpc2FibGVkKSINCiAgICB9LA0KICAgIHsNCiAgICAgICJrZXkiOiAiTUFYX05PREVTIiwNCiAgICAgICJuYW1lIjogIk1heGltdW0gTm9kZXMiLA0KICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICJ2YWx1ZSI6IDUwLA0KICAgICAgImRlc2NyaXB0aW9uIjogIk1heGltdW0gbnVtYmVyIG9mIG5vZGVzIGFsbG93ZWQgaW4gYSB3b3JrZmxvdyINCiAgICB9DQogIF0NCn0=",
    "flow_editor.html": "PHN0eWxlIHR5cGU9InRleHQvY3NzIj4vKiA9PT09PSBTdHlsZTogY3NzL2xheW91dC5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIExheW91dCAmIFN0cnVjdHVyZSAqLw0KLyogRW5zdXJlIGFwcC1jb250YWluZXIgdXNlcyBmdWxsIGhlaWdodCBhbmQgcHJldmVudCB2aXN1YWwgZmxhc2hpbmcgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcHAtY29udGFpbmVyIHsNCiAgICBoZWlnaHQ6IDEwMHZoOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIC8qIFByZXZlbnQgdmlzdWFsIGFydGlmYWN0cyBkdXJpbmcgZnVsbHNjcmVlbiB0cmFuc2l0aW9ucyAqLw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIHRyYW5zaXRpb246IG5vbmUgIWltcG9ydGFudA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcHAtY29udGVudCB7DQogICAgZmxleDogMTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBnYXA6IDEwcHg7DQogICAgcGFkZGluZzogMTBweDsNCiAgICBtaW4taGVpZ2h0OiAwOw0KICAgIC8qIFByZXZlbnQgZmxhc2hpbmcgZHVyaW5nIHJlc2l6ZSAqLw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpDQogICAgfQ0KLyogRmxvdyBFZGl0b3IgTGF5b3V0ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1lZGl0b3Igew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleDogMTsNCiAgICBnYXA6IDA7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBtaW4taGVpZ2h0OiAwOw0KICAgIC8qIEVuaGFuY2VkIHZpc3VhbCBzdGFiaWxpdHkgKi8NCiAgICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW4NCiAgICB9DQovKiBMZWZ0IFRvb2xib3ggKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xib3ggew0KICAgIHdpZHRoOiAyNTBweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBmbGV4LXNocmluazogMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LWhlYWRlciB7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtaGVhZGVyIGg0IHsNCiAgICBtYXJnaW46IDA7DQogICAgZm9udC1zaXplOiAxNnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdICN0b2dnbGUtdG9vbGJveCB7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdG9nZ2xlLXRvb2xib3g6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQovKiBDb2xsYXBzZWQgc3RhdGUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xib3guY29sbGFwc2VkIHsNCiAgICB3aWR0aDogNTBweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xib3guY29sbGFwc2VkIC50b29sYm94LWNvbnRlbnQgew0KICAgIGRpc3BsYXk6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYm94LmNvbGxhcHNlZCAudG9vbGJveC1oZWFkZXIgaDQgew0KICAgIGRpc3BsYXk6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1jb250ZW50IHsNCiAgICBmbGV4OiAxOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgcGFkZGluZzogMTBweA0KICAgIH0NCi8qIE1haW4gV29ya3NwYWNlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy13b3Jrc3BhY2Ugew0KICAgIGZsZXg6IDE7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIG1pbi13aWR0aDogMA0KICAgIH0NCi8qIFRvb2xiYXIgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgcGFkZGluZzogMTJweCAyMHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGZsZXgtc2hyaW5rOiAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xiYXItbGVmdCB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDEwcHg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jdXJyZW50LWZpbGUtaW5mbyB7DQogICAgbWFyZ2luLWxlZnQ6IDE1cHg7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmN1cnJlbnQtZmlsZW5hbWUgew0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xiYXItcmlnaHQgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZ2FwOiA4cHg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmUNCiAgICB9DQovKiBab29tIENvbnRyb2xzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuem9vbS1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogNHB4Ow0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuem9vbS1sZXZlbCB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIG1pbi13aWR0aDogNDBweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgdXNlci1zZWxlY3Q6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuem9vbS1jb250cm9scyBidXR0b24gew0KICAgIHBhZGRpbmc6IDRweCA2cHg7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWNvbnRyb2xzIGJ1dHRvbjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWNvbnRyb2xzIGJ1dHRvbjphY3RpdmUgew0KICAgIHRyYW5zZm9ybTogc2NhbGUoMC45NSkNCiAgICB9DQovKiBDYW52YXMgQ29udGFpbmVyICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jYW52YXMtY29udGFpbmVyIHsNCiAgICBmbGV4OiAxOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIC8qIFByZXZlbnQgdmlzdWFsIGFydGlmYWN0cyBhbmQgZmxhc2hpbmcgKi8NCiAgICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLyogSW1wcm92ZSByZW5kZXJpbmcgcGVyZm9ybWFuY2UgKi8NCiAgICBjb250YWluOiBsYXlvdXQgc3R5bGUgcGFpbnQ7DQogICAgd2lsbC1jaGFuZ2U6IGF1dG8NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jYW52YXMgew0KICAgIHdpZHRoOiAxMDAwMHB4Ow0KICAgIGhlaWdodDogMTAwMDBweDsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCAyMHB4IDIwcHgsIHZhcigtLWJvcmRlci1jb2xvcikgMXB4LCB0cmFuc3BhcmVudCAxcHgpLCByYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDQwcHggNDBweCwgdmFyKC0tYm9yZGVyLWNvbG9yKSAxcHgsIHRyYW5zcGFyZW50IDFweCk7DQogICAgYmFja2dyb3VuZC1zaXplOiA0MHB4IDQwcHg7DQogICAgY3Vyc29yOiBncmFiOw0KICAgIHRyYW5zZm9ybS1vcmlnaW46IDAgMDsNCiAgICB3aWxsLWNoYW5nZTogdHJhbnNmb3JtOw0KICAgIC8qIEVuaGFuY2VkIEdQVSBhY2NlbGVyYXRpb24gZm9yIHNtb290aGVyIHRyYW5zZm9ybXMgKi8NCiAgICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgcGVyc3BlY3RpdmU6IDEwMDBweDsNCiAgICAtd2Via2l0LXBlcnNwZWN0aXZlOiAxMDAwcHg7DQogICAgdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZDsNCiAgICAtd2Via2l0LXRyYW5zZm9ybS1zdHlsZTogcHJlc2VydmUtM2Q7DQogICAgLyogUHJldmVudCB2aXN1YWwgYXJ0aWZhY3RzIGR1cmluZyB6b29tICovDQogICAgaW1hZ2UtcmVuZGVyaW5nOiBhdXRvOw0KICAgIC13ZWJraXQtZm9udC1zbW9vdGhpbmc6IHN1YnBpeGVsLWFudGlhbGlhc2VkOw0KICAgIC8qIEltcHJvdmUgYmFja2dyb3VuZCBwYXR0ZXJuIHNjYWxpbmcgKi8NCiAgICBiYWNrZ3JvdW5kLWF0dGFjaG1lbnQ6IGxvY2FsDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY2FudmFzOmFjdGl2ZSB7DQogICAgY3Vyc29yOiBncmFiYmluZw0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNhbnZhcy5wYW5uaW5nIHsNCiAgICBjdXJzb3I6IGdyYWJiaW5nDQogICAgfQ0KLyogQ29uZmlndXJhdGlvbiBQYW5lbCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLXBhbmVsIHsNCiAgICB3aWR0aDogMzAwcHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBmbGV4LXNocmluazogMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctaGVhZGVyIHsNCiAgICBwYWRkaW5nOiAxNXB4Ow0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWhlYWRlciBoNCB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdG9nZ2xlLWNvbmZpZyB7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdG9nZ2xlLWNvbmZpZzpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCi8qIENvbGxhcHNlZCBzdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLXBhbmVsLmNvbGxhcHNlZCB7DQogICAgd2lkdGg6IDUwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25maWctcGFuZWwuY29sbGFwc2VkIC5jb25maWctY29udGVudCB7DQogICAgZGlzcGxheTogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbmZpZy1wYW5lbC5jb2xsYXBzZWQgLmNvbmZpZy1oZWFkZXIgaDQgew0KICAgIGRpc3BsYXk6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWNvbnRlbnQgew0KICAgIGZsZXg6IDE7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBwYWRkaW5nOiAxNXB4DQogICAgfQ0KLyogT3V0cHV0IFBhbmVsICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1vdXRwdXQtcGFuZWwgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgZmxleC1zaHJpbms6IDA7DQogICAgbWF4LWhlaWdodDogMzAwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAxMnB4IDE1cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LWhlYWRlciBoNCB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LWNvbnRlbnQgew0KICAgIHBhZGRpbmc6IDE1cHg7DQogICAgbWF4LWhlaWdodDogMjUwcHg7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBvdmVyZmxvdy14OiBoaWRkZW4NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1vdXRwdXQtcGFuZWwuY29sbGFwc2VkIC5vdXRwdXQtY29udGVudCB7DQogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctb3V0cHV0LXBhbmVsIC5vdXRwdXQtaGVhZGVyIHsNCiAgICBjdXJzb3I6IHBvaW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1vdXRwdXQtcGFuZWwgLm91dHB1dC1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDhweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyDQogICAgfQ0KLyogPT09PT0gU3R5bGU6IGNzcy9ub2Rlcy5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIE5vZGVzICYgQ29ubmVjdGlvbnMgKi8NCi8qIE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgbWluLXdpZHRoOiAxNTBweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIGN1cnNvcjogZ3JhYjsNCiAgICB1c2VyLXNlbGVjdDogbm9uZTsNCiAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjEpOw0KICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4ycyBlYXNlLCB0cmFuc2Zvcm0gMC4xcyBlYXNlOw0KICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm07DQogICAgLyogRW5oYW5jZWQgdmlzdWFsIHN0YWJpbGl0eSBkdXJpbmcgem9vbSAqLw0KICAgIGJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjsNCiAgICAtd2Via2l0LWJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjsNCiAgICAvKiBJbXByb3ZlIHJlbmRlcmluZyBxdWFsaXR5IGF0IGRpZmZlcmVudCB6b29tIGxldmVscyAqLw0KICAgIGltYWdlLXJlbmRlcmluZzogYXV0bzsNCiAgICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBzdWJwaXhlbC1hbnRpYWxpYXNlZDsNCiAgICB0cmFuc2Zvcm0tc3R5bGU6IHByZXNlcnZlLTNkOw0KICAgIC8qIERvIE5PVCB1c2UgJ2NvbnRhaW4nIHByb3BlcnR5IGFzIGl0IGhpZGVzIHRoZSBwb3J0cyB3aGljaCBhcmUgcG9zaXRpb25lZCBvdXRzaWRlICovDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZTphY3RpdmUgew0KICAgIGN1cnNvcjogZ3JhYmJpbmc7DQogICAgdHJhbnNpdGlvbjogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGU6aG92ZXIgew0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjE1KTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTFweCkgdHJhbnNsYXRleigwKTsNCiAgICAvKiBGb3JjZSBoYXJkd2FyZSBhY2NlbGVyYXRpb24gKi8NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLnNlbGVjdGVkIHsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXByaW1hcnktY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1oZWFkZXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweDsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5ub2RlLWRlbGV0ZS1idG4gew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICByaWdodDogLTVweDsNCiAgICB0b3A6IC01cHg7DQogICAgd2lkdGg6IDIwcHg7DQogICAgaGVpZ2h0OiAyMHB4Ow0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMTBweDsNCiAgICBvcGFjaXR5OiAwOw0KICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC4ycyBlYXNlOw0KICAgIHotaW5kZXg6IDEwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZTpob3ZlciAubm9kZS1kZWxldGUtYnRuIHsNCiAgICBvcGFjaXR5OiAxDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm5vZGUtZGVsZXRlLWJ0bjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogI2QzMmYyZjsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLXR5cGUgew0KICAgIHBhZGRpbmc6IDJweCA2cHg7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBmb250LXdlaWdodDogbm9ybWFsOw0KICAgIGJhY2tncm91bmQ6ICM2Yzc1N2Q7DQogICAgY29sb3I6IHdoaXRlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1jb250ZW50IHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1wb3J0cyB7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGhlaWdodDogMTAwJTsNCiAgICBwb2ludGVyLWV2ZW50czogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtcG9ydCB7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHdpZHRoOiAxMnB4Ow0KICAgIGhlaWdodDogMTJweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgcG9pbnRlci1ldmVudHM6IGFsbDsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1wb3J0OmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIHRyYW5zZm9ybTogc2NhbGUoMS4yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtcG9ydC5pbnB1dCB7DQogICAgbGVmdDogLTZweDsNCiAgICB0b3A6IDUwJTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTUwJSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLXBvcnQub3V0cHV0IHsNCiAgICByaWdodDogLTZweDsNCiAgICB0b3A6IDUwJTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTUwJSkNCiAgICB9DQovKiBDb25uZWN0aW9uIExpbmVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25uZWN0aW9uIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgcG9pbnRlci1ldmVudHM6IG5vbmU7DQogICAgei1pbmRleDogMTsNCiAgICAvKiBPcHRpbWl6ZSBTVkcgcmVuZGVyaW5nIHBlcmZvcm1hbmNlICovDQogICAgd2lsbC1jaGFuZ2U6IGF1dG87DQogICAgY29udGFpbjogbGF5b3V0IHN0eWxlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29ubmVjdGlvbi1saW5lIHsNCiAgICBzdHJva2U6IHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgc3Ryb2tlLXdpZHRoOiA4Ow0KICAgIGZpbGw6IG5vbmU7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICBvcGFjaXR5OiAwLjY7DQogICAgLyogU2xpZ2h0bHkgdHJhbnNwYXJlbnQgYnkgZGVmYXVsdCAqLw0KICAgIC8qIEltcHJvdmUgU1ZHIHJlbmRlcmluZyBxdWFsaXR5IGF0IGRpZmZlcmVudCB6b29tIGxldmVscyAqLw0KICAgIHNoYXBlLXJlbmRlcmluZzogZ2VvbWV0cmljUHJlY2lzaW9uOw0KICAgIHZlY3Rvci1lZmZlY3Q6IG5vbi1zY2FsaW5nLXN0cm9rZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbm5lY3Rpb24tbGluZTpob3ZlciB7DQogICAgc3Ryb2tlOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBvcGFjaXR5OiAxOw0KICAgIHN0cm9rZS13aWR0aDogMTANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25uZWN0aW9uLWxpbmUuY29ubmVjdGVkIHsNCiAgICBzdHJva2U6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIG9wYWNpdHk6IDAuOA0KICAgIH0NCi8qIFJ1bm5pbmcgU3RhdGUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUucnVubmluZyB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsNCiAgICBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlDQogICAgfQ0KLyogV2FpdGluZyBmb3IgSW5wdXRzIFN0YXRlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLndhaXRpbmctaW5wdXRzIHsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXdhcm5pbmctY29sb3IpOw0KICAgIGFuaW1hdGlvbjogd2FpdGluZy1wdWxzZSAycyBpbmZpbml0ZQ0KICAgIH0NCi8qIENvbXBsZXRlZCBTdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5jb21wbGV0ZWQgew0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tc3VjY2Vzcy1jb2xvcikNCiAgICB9DQovKiBFcnJvciBTdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5lcnJvciB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQpAa2V5ZnJhbWVzIHB1bHNlIHsNCiAgICAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS1zdWNjZXNzLWNvbG9yLXJnYiksIDAuNCk7DQogICAgICAgIH0gNzAlIHsNCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDAgMTBweCByZ2JhKHZhcigtLXN1Y2Nlc3MtY29sb3ItcmdiKSwgMCk7DQogICAgICAgIH0gMTAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS1zdWNjZXNzLWNvbG9yLXJnYiksIDApOw0KICAgICAgICB9DQogICAgfQ0KQGtleWZyYW1lcyB3YWl0aW5nLXB1bHNlIHsNCiAgICAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS13YXJuaW5nLWNvbG9yLXJnYiksIDAuNCk7DQogICAgICAgIH0gNzAlIHsNCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDAgMTBweCByZ2JhKHZhcigtLXdhcm5pbmctY29sb3ItcmdiKSwgMCk7DQogICAgICAgIH0gMTAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS13YXJuaW5nLWNvbG9yLXJnYiksIDApOw0KICAgICAgICB9DQogICAgfQ0KLyogPT09PT0gU3R5bGU6IGNzcy9jb21wb25lbnRzLmNzcyA9PT09PSAqLw0KLyogRmxvdyBFZGl0b3IgVUkgQ29tcG9uZW50cyAqLw0KLyogTm9kZSBDYXRlZ29yeSBUb29sYm94ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubm9kZS1jYXRlZ29yeSB7DQogICAgbWFyZ2luLWJvdHRvbTogMjBweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5ub2RlLWNhdGVnb3J5IGg1IHsNCiAgICBtYXJnaW46IDAgMCAxMHB4IDA7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7DQogICAgbGV0dGVyLXNwYWNpbmc6IDAuNXB4Ow0KICAgIHBhZGRpbmc6IDAgNXB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtbm9kZS1idG4gew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDEwcHg7DQogICAgcGFkZGluZzogMTJweCAxNXB4Ow0KICAgIG1hcmdpbi1ib3R0b206IDVweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBjdXJzb3I6IGdyYWI7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICB0ZXh0LWFsaWduOiBsZWZ0Ow0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1ub2RlLWJ0bjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KC0xcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1ub2RlLWJ0bjphY3RpdmUgew0KICAgIGN1cnNvcjogZ3JhYmJpbmc7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KDApDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtbm9kZS1idG4gaSB7DQogICAgZm9udC1zaXplOiAxNnB4Ow0KICAgIHdpZHRoOiAyMHB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LW5vZGUtYnRuIHNwYW4gew0KICAgIGZsZXg6IDE7DQogICAgZm9udC13ZWlnaHQ6IDUwMA0KICAgIH0NCi8qIEJ1dHRvbnMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0biB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogNnB4Ow0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQogICAgdGV4dC1kZWNvcmF0aW9uOiBub25lDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTFweCk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwgMCwgMCwgMC4xKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0bi1vdXRsaW5lLWRhbmdlciB7DQogICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4tb3V0bGluZS1kYW5nZXI6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4tb3V0bGluZS1zZWNvbmRhcnkgew0KICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuLW91dGxpbmUtc2Vjb25kYXJ5OmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKQ0KICAgIH0NCi8qIENvbmZpZ3VyYXRpb24gU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWdyb3VwIHsNCiAgICBtYXJnaW4tYm90dG9tOiAxNXB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1ncm91cCBsYWJlbCB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgbWFyZ2luLWJvdHRvbTogNXB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgaW5wdXQgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgdHJhbnNpdGlvbjogYm9yZGVyLWNvbG9yIDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgc2VsZWN0IHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOw0KICAgIGN1cnNvcjogcG9pbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgaW5wdXQ6Zm9jdXMgew0KICAgIG91dGxpbmU6IG5vbmU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgc2VsZWN0OmZvY3VzIHsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDIxMiwgMjU1LCAwLjA1KQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgc2VsZWN0IG9wdGlvbiB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1ncm91cCBzZWxlY3Qgb3B0aW9uOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZykNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWdyb3VwIHRleHRhcmVhIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHJlc2l6ZTogdmVydGljYWw7DQogICAgbWluLWhlaWdodDogODBweDsNCiAgICBmb250LWZhbWlseTogbW9ub3NwYWNlDQogICAgfQ0KLyogVGFnIFBhbmVsICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdGFnLXBhbmVsIHsNCiAgICBtYXJnaW4tdG9wOiAyMHB4Ow0KICAgIHBhZGRpbmctdG9wOiAyMHB4Ow0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gI3RhZy1wYW5lbCBoNSB7DQogICAgbWFyZ2luOiAwIDAgMTVweCAwOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDEwcHg7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQogICAgbWFyZ2luLWJvdHRvbTogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctY29sb3Igew0KICAgIHdpZHRoOiAxMnB4Ow0KICAgIGhlaWdodDogMTJweDsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgZmxleC1zaHJpbms6IDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWluZm8gew0KICAgIGZsZXg6IDE7DQogICAgbWluLXdpZHRoOiAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1uYW1lIHsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIGZvbnQtc2l6ZTogMTNweDsNCiAgICBtYXJnaW4tYm90dG9tOiAycHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWRlc2NyaXB0aW9uIHsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgb3BhY2l0eTogMC43DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1kZWxldGUgew0KICAgIGJhY2tncm91bmQ6IG5vbmU7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGNvbG9yOiBpbmhlcml0Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBwYWRkaW5nOiA0cHg7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG9wYWNpdHk6IDAuNjsNCiAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctZGVsZXRlOmhvdmVyIHsNCiAgICBvcGFjaXR5OiAxOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKQ0KICAgIH0NCi8qIE91dHB1dCBTdHlsZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leGVjdXRpb24tb3V0cHV0IHsNCiAgICBmb250LWZhbWlseTogbW9ub3NwYWNlOw0KICAgIGZvbnQtc2l6ZTogMTNweDsNCiAgICBsaW5lLWhlaWdodDogMS40Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leGVjdXRpb24tb3V0cHV0IC5sb2ctZW50cnkgew0KICAgIG1hcmdpbi1ib3R0b206IDVweDsNCiAgICBwYWRkaW5nOiA0cHggMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leGVjdXRpb24tb3V0cHV0IC5sb2ctZW50cnkuaW5mbyB7DQogICAgY29sb3I6IHZhcigtLWluZm8tY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmV4ZWN1dGlvbi1vdXRwdXQgLmxvZy1lbnRyeS5zdWNjZXNzIHsNCiAgICBjb2xvcjogdmFyKC0tc3VjY2Vzcy1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZXhlY3V0aW9uLW91dHB1dCAubG9nLWVudHJ5LmVycm9yIHsNCiAgICBjb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmV4ZWN1dGlvbi1vdXRwdXQgLmxvZy1lbnRyeS53YXJuaW5nIHsNCiAgICBjb2xvcjogdmFyKC0td2FybmluZy1jb2xvcikNCiAgICB9DQovKiBJbnB1dC9PdXRwdXQgTWFwcGluZ3MgQ29uZmlndXJhdGlvbiBTdHlsZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5ncy1jb25maWcsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5vdXRwdXQtbWFwcGluZ3MtY29uZmlnIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgbWFyZ2luLXRvcDogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmctY29uZmlnLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmctY29uZmlnIHsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICBib3JkZXItbGVmdDogM3B4IHNvbGlkIHZhcigtLXByaW1hcnktY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmctY29uZmlnOmxhc3QtY2hpbGQsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5vdXRwdXQtbWFwcGluZy1jb25maWc6bGFzdC1jaGlsZCB7DQogICAgbWFyZ2luLWJvdHRvbTogMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5nLWNvbmZpZyBsYWJlbCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm91dHB1dC1tYXBwaW5nLWNvbmZpZyBsYWJlbCB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIG1hcmdpbi1ib3R0b206IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5nLXNlbGVjdCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm91dHB1dC1tYXBwaW5nLXNlbGVjdCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LXRhcmdldC1zZWxlY3Qgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQogICAgY3Vyc29yOiBwb2ludGVyDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmctc2VsZWN0OmZvY3VzLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmctc2VsZWN0OmZvY3VzLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtdGFyZ2V0LXNlbGVjdDpmb2N1cyB7DQogICAgb3V0bGluZTogbm9uZTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAyMTIsIDI1NSwgMC4wNSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZy1zZWxlY3Qgb3B0aW9uLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmctc2VsZWN0IG9wdGlvbiwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LXRhcmdldC1zZWxlY3Qgb3B0aW9uIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWJnKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgcGFkZGluZzogOHB4IDEycHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZy1zZWxlY3Qgb3B0aW9uOmhvdmVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmctc2VsZWN0IG9wdGlvbjpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LXRhcmdldC1zZWxlY3Qgb3B0aW9uOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZykNCiAgICB9DQovKiBMZWdhY3kgc3R5bGVzIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZ3Mgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBtYXJnaW4tdG9wOiA0cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZyB7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBtYXJnaW4tYm90dG9tOiA0cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgbGluZS1oZWlnaHQ6IDEuMg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5nOmxhc3QtY2hpbGQgew0KICAgIG1hcmdpbi1ib3R0b206IDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZyAuc291cmNlLW5vZGUgew0KICAgIGZvbnQtd2VpZ2h0OiA2MDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZyAuc291cmNlLXBvcnQgew0KICAgIG9wYWNpdHk6IDAuODsNCiAgICBmb250LXN0eWxlOiBpdGFsaWMNCiAgICB9DQovKiBDb2xsYXBzaWJsZSBDb25maWd1cmF0aW9uIFNlY3Rpb25zIC0gVXNpbmcgZXhpc3RpbmcgT1MgdGhlbWUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbiB7DQogICAgbWFyZ2luLWJvdHRvbTogMTVweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1zZWN0aW9uLWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIHBhZGRpbmc6IDEycHggMTVweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICB1c2VyLXNlbGVjdDogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbi1oZWFkZXI6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLXNlY3Rpb24taGVhZGVyLmNvbGxhcHNlZCB7DQogICAgYm9yZGVyLWJvdHRvbTogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbi1oZWFkZXIgaSB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1zZWN0aW9uLWhlYWRlciBzcGFuIHsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBmb250LXNpemU6IDE0cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWNvdW50IHsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7DQogICAgbWFyZ2luLWxlZnQ6IGF1dG8NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLXNlY3Rpb24tY29udGVudCB7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbi1oZWFkZXIuY29sbGFwc2VkICsgLmNvbmZpZy1zZWN0aW9uLWNvbnRlbnQgew0KICAgIGJvcmRlci10b3A6IG5vbmUNCiAgICB9DQovKiBBZGp1c3QgZXhpc3RpbmcgY29uZmlnIGdyb3VwcyB3aXRoaW4gc2VjdGlvbnMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbiAuY29uZmlnLWdyb3VwIHsNCiAgICBtYXJnaW4tYm90dG9tOiAxMnB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1zZWN0aW9uIC5jb25maWctZ3JvdXA6bGFzdC1jaGlsZCB7DQogICAgbWFyZ2luLWJvdHRvbTogMA0KICAgIH0NCi8qID09PT09IFN0eWxlOiBjc3Mvbm9kZS10eXBlcy5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIE5vZGUgVHlwZSBTcGVjaWZpYyBTdHlsZXMgKi8NCi8qIERpc3BsYXkgTm9kZSBDb250ZW50ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZGlzcGxheS1jb250ZW50IHsNCiAgICBwYWRkaW5nOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZGlzcGxheS10ZXh0IHsNCiAgICBtaW4taGVpZ2h0OiA0MHB4Ow0KICAgIG1heC1oZWlnaHQ6IDIwMHB4Ow0KICAgIHdpZHRoOiAyMjBweDsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgcmVzaXplOiBub25lOw0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3gNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZGlzcGxheS10ZXh0IHByZSB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7DQogICAgd2hpdGUtc3BhY2U6IHByZS13cmFwOw0KICAgIHdvcmQtYnJlYWs6IGJyZWFrLXdvcmQ7DQogICAgdXNlci1zZWxlY3Q6IHRleHQNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZGlzcGxheS1mb3JtYXQgew0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpDQogICAgfQ0KLyogQXVkaW8gUGxheWVyIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmF1ZGlvLWNvbnRyb2xzIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxMHB4Ow0KICAgIG1hcmdpbi10b3A6IDEwcHg7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmF1ZGlvLXBsYXktYnRuLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXVkaW8tc3RvcC1idG4gew0KICAgIHdpZHRoOiAzMnB4Ow0KICAgIGhlaWdodDogMzJweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXVkaW8tcGxheS1idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1Y2Nlc3MtY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hdWRpby1zdG9wLWJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hdWRpby1wbGF5LWJ0bjpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmF1ZGlvLXN0b3AtYnRuOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwgMCwgMCwgMC4yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hdWRpby1zdGF0dXMgew0KICAgIGZsZXg6IDE7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXINCiAgICB9DQovKiBKU09OIEV4dHJhY3QgRGlzcGxheSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmpzb24tZXh0cmFjdC1kaXNwbGF5IHsNCiAgICBtYXJnaW4tdG9wOiAxMHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuMDUpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leHRyYWN0LWxhYmVsIHsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIG1hcmdpbi1ib3R0b206IDRweDsNCiAgICBmb250LXdlaWdodDogNTAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmV4dHJhY3QtdmFsdWUgew0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiAzcHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leHRyYWN0LXZhbHVlLnN1Y2Nlc3Mgew0KICAgIGNvbG9yOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXN1Y2Nlc3MtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmV4dHJhY3QtdmFsdWUuZXJyb3Igew0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQovKiBSZXBlYXRlciBOb2RlIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLWNvbnRlbnQgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIHBhZGRpbmc6IDhweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5yZXBlYXRlci1zdGF0dXMgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBtaW4td2lkdGg6IDgwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAucmVwZWF0ZXItc3RhdHVzLnN0b3BwZWQgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4xKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAucmVwZWF0ZXItc3RhdHVzLnJ1bm5pbmcgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1Y2Nlc3MtY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLWNvbnRyb2xzIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGdhcDogOHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0YXJ0LWJ0biwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0b3AtYnRuIHsNCiAgICB3aWR0aDogMjhweDsNCiAgICBoZWlnaHQ6IDI4cHg7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0YXJ0LWJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VjY2Vzcy1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0b3AtYnRuIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0YXJ0LWJ0bjpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0b3AtYnRuOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwgMCwgMCwgMC4yKQ0KICAgIH0NCi8qIEltYWdlIE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtY29udGFpbmVyIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgbWluLWhlaWdodDogMTIwcHg7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtdGh1bWJuYWlsIHsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBvYmplY3QtZml0OiBjb250YWluOw0KICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtdGh1bWJuYWlsOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMDUpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtaW5mbyB7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMTFweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICB3aWR0aDogMTAwJQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbWFnZS1lcnJvciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA0cHg7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtZXJyb3IgaSB7DQogICAgZm9udC1zaXplOiAxNnB4DQogICAgfQ0KLyogSW1hZ2UgTW9kYWwgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwgew0KICAgIHBvc2l0aW9uOiBmaXhlZDsNCiAgICB0b3A6IDA7DQogICAgbGVmdDogMDsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjgpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICB6LWluZGV4OiAxMDAwOw0KICAgIHBhZGRpbmc6IDIwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtY29udGVudCB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIG1heC13aWR0aDogOTAlOw0KICAgIG1heC1oZWlnaHQ6IDkwJTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDIwcHggcmdiYSgwLCAwLCAwLCAwLjMpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLW1vZGFsLWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAxNXB4IDIwcHg7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtaGVhZGVyIHNwYW4gew0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLW1vZGFsLWNsb3NlIHsNCiAgICBiYWNrZ3JvdW5kOiBub25lOw0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBmb250LXNpemU6IDI0cHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBwYWRkaW5nOiAwOw0KICAgIHdpZHRoOiAzMHB4Ow0KICAgIGhlaWdodDogMzBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtY2xvc2U6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4xKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtYm9keSB7DQogICAgcGFkZGluZzogMjBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDE1cHg7DQogICAgbWF4LWhlaWdodDogY2FsYyg5MHZoIC0gMTAwcHgpOw0KICAgIG92ZXJmbG93LXk6IGF1dG8NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtaW1hZ2Ugew0KICAgIG1heC13aWR0aDogMTAwJTsNCiAgICBtYXgtaGVpZ2h0OiA3MHZoOw0KICAgIG9iamVjdC1maXQ6IGNvbnRhaW47DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtaW5mbyB7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIHBhZGRpbmc6IDEwcHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgd2lkdGg6IDEwMCUNCiAgICB9DQovKiBSYW5kb20gUXVvdGUgTm9kZSBTdHlsZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5xdW90ZS1jb250ZW50IHsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5xdW90ZS10ZXh0IHsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgbWluLWhlaWdodDogNDBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAucXVvdGUtZGlzcGxheSB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZm9udC1zaXplOiAxM3B4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjQ7DQogICAgbWF4LXdpZHRoOiAxMDAlOw0KICAgIHdvcmQtd3JhcDogYnJlYWstd29yZA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5xdW90ZS1pbmZvIHsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIHBhZGRpbmctdG9wOiA4cHgNCiAgICB9DQovKiBMTE0gQ2hhdCBOb2RlIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmxsbS1yZXNwb25zZSB7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjMsIDE2MiwgMTg0LCAwLjEpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBtYXJnaW46IDRweCAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlc3BvbnNlLXByZXZpZXcgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBsaW5lLWhlaWdodDogMS4zOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgbWFyZ2luLWJvdHRvbTogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnVzYWdlLWluZm8gew0KICAgIGZvbnQtc2l6ZTogMTBweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHJnYmEoMCwgMCwgMCwgMC4xKTsNCiAgICBwYWRkaW5nLXRvcDogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmxsbS1lcnJvciB7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjIwLCA1MywgNjksIDAuMSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG1hcmdpbjogNHB4IDA7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogNnB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmxsbS1lcnJvciBpIHsNCiAgICBmb250LXNpemU6IDE0cHgNCiAgICB9DQovKiBUZXh0IE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGV4dC1jb250ZW50IHsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgxMDgsIDExNywgMTI1LCAwLjEpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBtYXJnaW46IDRweCAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRleHQtcHJldmlldyB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjM7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsNCiAgICBtYXJnaW4tYm90dG9tOiA0cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGV4dC1pbmZvIHsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMSk7DQogICAgcGFkZGluZy10b3A6IDRweA0KICAgIH0NCi8qIE5vZGUgU3RhdHVzIERpc3BsYXkgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5ub2RlLXN0YXR1cyB7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG1hcmdpbjogNHB4IDA7DQogICAgdGV4dC1hbGlnbjogY2VudGVyDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnN0YXR1cy10ZXh0IHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgbWFyZ2luLWJvdHRvbTogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnN0YXR1cy1pbmZvIHsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpDQogICAgfQ0KLyogQ29udGVudCBEaXNwbGF5IGluIENvbmZpZyBQYW5lbCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbnRlbnQtZGlzcGxheSB7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgcGFkZGluZzogMTJweDsNCiAgICBtYXJnaW4tdG9wOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29udGVudC10ZXh0IHsNCiAgICBtYXJnaW46IDA7DQogICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgbGluZS1oZWlnaHQ6IDEuNDsNCiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7DQogICAgd29yZC1icmVhazogYnJlYWstd29yZDsNCiAgICBtYXgtaGVpZ2h0OiAzMDBweDsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogM3B4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICB1c2VyLXNlbGVjdDogdGV4dA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb250ZW50LWluZm8gew0KICAgIG1hcmdpbi10b3A6IDhweDsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgIH0NCi8qIFRlcm1pbmFsIE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGVybWluYWwtZXJyb3Igew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDIyMCwgNTMsIDY5LCAwLjEpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgbWFyZ2luLXRvcDogOHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRlcm1pbmFsLWVycm9yIGkgew0KICAgIG1hcmdpbi1yaWdodDogOHB4Ow0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQovKiA9PT09PSBTdHlsZTogY3NzL3Jlc3BvbnNpdmUuY3NzID09PT09ICovDQovKiBGbG93IEVkaXRvciBSZXNwb25zaXZlIERlc2lnbiAmIEVmZmVjdHMgKi8NCi8qIEhhbWJ1cmdlciBNZW51IFN0eWxlcyAtIEFsd2F5cyB2aXNpYmxlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaGFtYnVyZ2VyLWJ0biB7DQogICAgcGFkZGluZzogOHB4IDEycHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZHJvcGRvd24tbWVudSB7DQogICAgZGlzcGxheTogbm9uZTsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMik7DQogICAgei1pbmRleDogOTk5OTsNCiAgICBtaW4td2lkdGg6IDE4MHB4Ow0KICAgIHdpZHRoOiAxODBweDsNCiAgICBtYXgtaGVpZ2h0OiA3MHZoOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgcGFkZGluZzogMDsNCiAgICBtYXJnaW46IDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZHJvcGRvd24tbWVudS5zaG93IHsNCiAgICBkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm1lbnUtc2VjdGlvbiB7DQogICAgcGFkZGluZzogOHB4IDA7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1zZWN0aW9uOmxhc3QtY2hpbGQgew0KICAgIGJvcmRlci1ib3R0b206IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1zZWN0aW9uLXRpdGxlIHsNCiAgICBwYWRkaW5nOiA4cHggMTZweDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsNCiAgICBsZXR0ZXItc3BhY2luZzogMC41cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1pdGVtIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxMHB4Ow0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDEwcHggMTZweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAwLjJzIGVhc2U7DQogICAgdGV4dC1hbGlnbjogbGVmdA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5tZW51LWl0ZW06aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1pdGVtLmRhbmdlciB7DQogICAgY29sb3I6ICNmZjZiNmINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1pdGVtLmRhbmdlcjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDEwNywgMTA3LCAwLjEpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm1lbnUtem9vbS1jb250cm9scyB7DQogICAgcGFkZGluZzogMCAxNnB4Ow0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBnYXA6IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5tZW51LXpvb20tbGV2ZWwgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgcGFkZGluZzogNHB4IDA7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgbWFyZ2luOiA0cHggMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWJ0biB7DQogICAgcGFkZGluZzogNnB4IDEycHggIWltcG9ydGFudDsNCiAgICBmb250LXNpemU6IDEycHggIWltcG9ydGFudA0KICAgIH0NCi8qIFJlc3BvbnNpdmUgRGVzaWduICovDQpAbWVkaWEgKG1heC13aWR0aDogMTIwMHB4KSB7DQogICAgLmZsb3ctZWRpdG9yIHsNCiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgbWluLWhlaWdodDogMA0KICAgICAgICB9DQogICAgLmZsb3ctdG9vbGJveCB7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICBoZWlnaHQ6IGF1dG87DQogICAgICAgIGJvcmRlci1yaWdodDogbm9uZTsNCiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgICAgIGZsZXgtc2hyaW5rOiAwOw0KICAgICAgICBtYXgtaGVpZ2h0OiAyMDBweA0KICAgICAgICB9DQogICAgLnRvb2xib3gtY29udGVudCB7DQogICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgIGZsZXgtd3JhcDogd3JhcDsNCiAgICAgICAgZ2FwOiAxMHB4Ow0KICAgICAgICBwYWRkaW5nOiAxNXB4Ow0KICAgICAgICBvdmVyZmxvdy15OiBhdXRvDQogICAgICAgIH0NCiAgICAubm9kZS1jYXRlZ29yeSB7DQogICAgICAgIG1hcmdpbi1ib3R0b206IDA7DQogICAgICAgIGZsZXg6IDE7DQogICAgICAgIG1pbi13aWR0aDogMjAwcHgNCiAgICAgICAgfQ0KICAgIC5mbG93LXdvcmtzcGFjZSB7DQogICAgICAgIGZsZXg6IDE7DQogICAgICAgIG1pbi1oZWlnaHQ6IDANCiAgICAgICAgfQ0KICAgIC5mbG93LWNvbmZpZy1wYW5lbCB7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICBib3JkZXItbGVmdDogbm9uZTsNCiAgICAgICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgICAgIGZsZXgtc2hyaW5rOiAwOw0KICAgICAgICBtYXgtaGVpZ2h0OiAzMDBweA0KICAgICAgICB9DQogICAgLmZsb3ctb3V0cHV0LXBhbmVsIHsNCiAgICAgICAgbWF4LWhlaWdodDogMjAwcHgNCiAgICAgICAgfQ0KICAgIC5vdXRwdXQtY29udGVudCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4DQogICAgICAgIH0NCiAgICB9DQpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsNCiAgICAuYXBwLWNvbnRlbnQgew0KICAgICAgICBwYWRkaW5nOiA1cHg7DQogICAgICAgIGdhcDogNXB4DQogICAgICAgIH0NCiAgICAuZmxvdy10b29sYmFyIHsNCiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgZ2FwOiAxMHB4Ow0KICAgICAgICBwYWRkaW5nOiA4cHggMTVweA0KICAgICAgICB9DQogICAgLnRvb2xiYXItbGVmdCwgLnRvb2xiYXItcmlnaHQgew0KICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgIGZsZXgtd3JhcDogd3JhcA0KICAgICAgICB9DQogICAgLmZsb3ctdG9vbGJhciAuYnRuIHsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgICAgICBwYWRkaW5nOiA2cHggMTBweA0KICAgICAgICB9DQogICAgLmZsb3ctdG9vbGJveCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4DQogICAgICAgIH0NCiAgICAuZmxvdy1jb25maWctcGFuZWwgew0KICAgICAgICBtYXgtaGVpZ2h0OiAyNTBweA0KICAgICAgICB9DQogICAgLmZsb3ctb3V0cHV0LXBhbmVsIHsNCiAgICAgICAgbWF4LWhlaWdodDogMTUwcHgNCiAgICAgICAgfQ0KICAgIC5vdXRwdXQtY29udGVudCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDEwMHB4Ow0KICAgICAgICBwYWRkaW5nOiAxMHB4DQogICAgICAgIH0NCiAgICB9DQpAbWVkaWEgKG1heC13aWR0aDogNDgwcHgpIHsNCiAgICAudG9vbGJhci1sZWZ0LCAudG9vbGJhci1yaWdodCB7DQogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICAgIGdhcDogNXB4Ow0KICAgICAgICBhbGlnbi1pdGVtczogc3RyZXRjaA0KICAgICAgICB9DQogICAgLmZsb3ctdG9vbGJhciAuYnRuIHsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgICAgICB9DQogICAgLnpvb20tY29udHJvbHMgew0KICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcg0KICAgICAgICB9DQogICAgfQ0KLyogPT09PT0gU3R5bGU6IGNzcy9wZXJmb3JtYW5jZS5jc3MgPT09PT0gKi8NCi8qIFBlcmZvcm1hbmNlIG9wdGltaXphdGlvbnMgYW5kIGFudGktZmxhc2hpbmcgbWVhc3VyZXMgZm9yIEZsb3cgRWRpdG9yICovDQovKiBQcmV2ZW50IHZpc3VhbCBhcnRpZmFjdHMgZHVyaW5nIGZ1bGxzY3JlZW4gdHJhbnNpdGlvbnMgYW5kIHNjYWxpbmcgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5uby10cmFuc2l0aW9ucyAqIHsNCiAgICB0cmFuc2l0aW9uOiBub25lICFpbXBvcnRhbnQ7DQogICAgYW5pbWF0aW9uOiBub25lICFpbXBvcnRhbnQNCiAgICB9DQovKiBJbXByb3ZlIG92ZXJhbGwgcmVuZGVyaW5nIHBlcmZvcm1hbmNlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1lZGl0b3IgKiB7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveA0KICAgIH0NCi8qIFJlZHVjZSBsYXlvdXQgdGhyYXNoaW5nIGR1cmluZyB6b29tIG9wZXJhdGlvbnMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNhbnZhcywgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29ubmVjdGlvbiB7DQogICAgY29udGFpbjogbGF5b3V0IHN0eWxlIHBhaW50DQogICAgfQ0KLyogT3B0aW1pemUgZm9yIGhhcmR3YXJlIGFjY2VsZXJhdGlvbiAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY2FudmFzLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25uZWN0aW9uIHsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXooMCkNCiAgICB9DQovKiBQcmV2ZW50IGZvbnQgc21vb3RoaW5nIGlzc3VlcyBhdCBkaWZmZXJlbnQgem9vbSBsZXZlbHMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUgKiB7DQogICAgLXdlYmtpdC1mb250LXNtb290aGluZzogc3VicGl4ZWwtYW50aWFsaWFzZWQ7DQogICAgLW1vei1vc3gtZm9udC1zbW9vdGhpbmc6IGF1dG87DQogICAgdGV4dC1yZW5kZXJpbmc6IG9wdGltaXplU3BlZWQNCiAgICB9DQovKiBSZWR1Y2UgcGFpbnQgY29tcGxleGl0eSBkdXJpbmcgem9vbSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZTpub3QoOmhvdmVyKTpub3QoLnNlbGVjdGVkKSB7DQogICAgd2lsbC1jaGFuZ2U6IGF1dG8NCiAgICB9DQovKiBPbmx5IGVuYWJsZSB3aWxsLWNoYW5nZSB3aGVuIGFjdHVhbGx5IG5lZWRlZCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZTpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5zZWxlY3RlZCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5kcmFnZ2luZyB7DQogICAgd2lsbC1jaGFuZ2U6IHRyYW5zZm9ybQ0KICAgIH0NCi8qIEltcHJvdmUgcGVyZm9ybWFuY2Ugb2YgYW5pbWF0aW9ucyAqLw0KQG1lZGlhIChwcmVmZXJzLXJlZHVjZWQtbW90aW9uOiByZWR1Y2UpIHsNCiAgICAuZmxvdy1ub2RlLCAuZmxvdy1jb25uZWN0aW9uLWxpbmUgew0KICAgICAgICB0cmFuc2l0aW9uOiBub25lICFpbXBvcnRhbnQ7DQogICAgICAgIGFuaW1hdGlvbjogbm9uZSAhaW1wb3J0YW50DQogICAgICAgIH0NCiAgICB9DQovKiBGb3JjZSBjb21wb3NpdGluZyBsYXllciBmb3Igc21vb3RoZXIgdHJhbnNmb3JtcyBkdXJpbmcgem9vbSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY2FudmFzLnpvb21pbmcgew0KICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm07DQogICAgdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZA0KICAgIH0NCi8qIFJlbW92ZSBjb21wb3NpdGluZyBsYXllciB3aGVuIG5vdCB6b29taW5nICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jYW52YXM6bm90KC56b29taW5nKSB7DQogICAgd2lsbC1jaGFuZ2U6IGF1dG8NCiAgICB9DQovKiA9PT09PSBTdHlsZTogY3NzL29zLXRoZW1lLmNzcyA9PT09PSAqLw0KLyogRmxvdyBFZGl0b3IgLSBTeXBuZXhPUyBUaGVtZSBJbnRlZ3JhdGlvbiAqLw0KLyogVGhpcyBmaWxlIGVuc3VyZXMgdGhlIGZsb3cgZWRpdG9yIG1hdGNoZXMgdGhlIE9TIGFlc3RoZXRpYyBwZXJmZWN0bHkgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIHsNCiAgICAvKiBPdmVycmlkZSBmbG93IGVkaXRvciB2YXJpYWJsZXMgd2l0aCBPUyB2YXJpYWJsZXMgKi8NCiAgICAtLXN1cmZhY2UtY29sb3I6IHZhcigtLWdsYXNzLWJnKTsNCiAgICAtLWJvcmRlci1jb2xvcjogdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICAtLXRleHQtY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7DQogICAgLS10ZXh0LW11dGVkOiB2YXIoLS10ZXh0LXNlY29uZGFyeSk7DQogICAgLS1wcmltYXJ5LWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIC0tcHJpbWFyeS1jb2xvci1yZ2I6IDAsIDIxMiwgMjU1Ow0KICAgIC0tZXJyb3ItY29sb3I6ICNmZjQ3NTc7DQogICAgLS1zdWNjZXNzLWNvbG9yOiAjMmVkNTczOw0KICAgIC0td2FybmluZy1jb2xvcjogI2ZmYTUwMg0KICAgIH0NCi8qIEVuaGFuY2VkIGdsYXNzIG1vcnBoaXNtIGZvciBmbG93IGVkaXRvciAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctZWRpdG9yIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3JkZXItcmFkaXVzOiAxMnB4Ow0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KTsNCiAgICBib3gtc2hhZG93OiAwIDhweCAzMnB4IHJnYmEoMCwgMCwgMCwgMC4zKQ0KICAgIH0NCi8qIFRvb2xib3ggd2l0aCBiZXR0ZXIgZ2xhc3MgZWZmZWN0ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYm94IHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI2LCAyNiwgMjYsIDAuOSk7DQogICAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTVweCkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1oZWFkZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMTAsIDEwLCAxMCwgMC44KTsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LWhlYWRlciBoNCB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgdGV4dC1zaGFkb3c6IDAgMCAxMHB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMykNCiAgICB9DQovKiBFbmhhbmNlZCBub2RlIHN0eWxpbmcgd2l0aCBnbGFzcyBtb3JwaGlzbSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZSB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm9yZGVyLXJhZGl1czogMTJweDsNCiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTBweCk7DQogICAgYm94LXNoYWRvdzogMCA0cHggMjBweCByZ2JhKDAsIDAsIDAsIDAuMik7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGU6aG92ZXIgew0KICAgIGJveC1zaGFkb3c6IDAgOHB4IDMycHggcmdiYSgwLCAyMTIsIDI1NSwgMC4yKTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTJweCk7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5zZWxlY3RlZCB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGJveC1zaGFkb3c6IDAgMCAwIDNweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjMpOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMjEyLCAyNTUsIDAuMDUpDQogICAgfQ0KLyogTm9kZSBwb3J0cyB3aXRoIG5lb24gZ2xvdyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1wb3J0IHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3gtc2hhZG93OiAwIDAgMTBweCByZ2JhKDAsIDAsIDAsIDAuNSk7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtcG9ydDpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgYm94LXNoYWRvdzogMCAwIDE1cHggcmdiYSgwLCAyMTIsIDI1NSwgMC44KTsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMykNCiAgICB9DQovKiBDb25uZWN0aW9uIGxpbmVzIHdpdGggbmVvbiBlZmZlY3QgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbm5lY3Rpb24tbGluZSB7DQogICAgc3Ryb2tlOiB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIHN0cm9rZS13aWR0aDogMzsNCiAgICBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCAzcHggcmdiYSgwLCAyMTIsIDI1NSwgMC4zKSk7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbm5lY3Rpb24tbGluZTpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29ubmVjdGlvbi1saW5lLmNvbm5lY3RlZCB7DQogICAgc3Ryb2tlOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIHN0cm9rZS13aWR0aDogNDsNCiAgICBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCA4cHggcmdiYSgwLCAyMTIsIDI1NSwgMC44KSkNCiAgICB9DQovKiBUb29sYmFyIHdpdGggZ2xhc3MgZWZmZWN0ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDEwLCAxMCwgMTAsIDAuOSk7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDE1cHgpDQogICAgfQ0KLyogRW5oYW5jZWQgYnV0dG9uIHN0eWxpbmcgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LW5vZGUtYnRuIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LW5vZGUtYnRuOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDIxMiwgMjU1LCAwLjEpOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTFweCk7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTVweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjIpOw0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpDQogICAgfQ0KLyogRmxvdyB0b29sYmFyIGJ1dHRvbnMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDIxMiwgMjU1LCAwLjEpOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTFweCk7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTVweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjIpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuLXN1Y2Nlc3Mgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXByaW1hcnktYmcpOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0bi1zdWNjZXNzOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtaG92ZXIpOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDIwcHggcmdiYSgwLCAyMTIsIDI1NSwgMC40KQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0bi1kYW5nZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4tZGFuZ2VyOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiAjZmYzNzQyOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDIwcHggcmdiYSgyNTUsIDcxLCA4NywgMC40KQ0KICAgIH0NCi8qIE5vZGUgdHlwZSBzdHlsaW5nICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLXR5cGUgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXByaW1hcnktYmcpOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgdGV4dC1zaGFkb3c6IG5vbmU7DQogICAgYm9yZGVyLXJhZGl1czogNnB4DQogICAgfQ0KLyogTm9kZSBkZWxldGUgYnV0dG9uICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubm9kZS1kZWxldGUtYnRuIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgYm9yZGVyOiAycHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDEwcHggcmdiYSgyNTUsIDcxLCA4NywgMC4zKTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm5vZGUtZGVsZXRlLWJ0bjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogI2ZmMzc0MjsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTVweCByZ2JhKDI1NSwgNzEsIDg3LCAwLjUpDQogICAgfQ0KLyogQ3VycmVudCBmaWxlbmFtZSBzdHlsaW5nICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY3VycmVudC1maWxlbmFtZSB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICB0ZXh0LXNoYWRvdzogMCAwIDVweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjMpDQogICAgfQ0KLyogWm9vbSBjb250cm9scyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnpvb20tY29udHJvbHMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgcGFkZGluZzogNHB4Ow0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWxldmVsIHsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIG1pbi13aWR0aDogNDVweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgZm9udC1zaXplOiAxMnB4DQogICAgfQ0KLyogTG9hZGluZyBzdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmxvYWRpbmctbm9kZXMgew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXNlY29uZGFyeSk7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIHBhZGRpbmc6IDIwcHg7DQogICAgZm9udC1zdHlsZTogaXRhbGljDQogICAgfQ0KLyogTm9kZSBjYXRlZ29yaWVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubm9kZS1jYXRlZ29yeSBoNSB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsNCiAgICBsZXR0ZXItc3BhY2luZzogMXB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA3MDA7DQogICAgZm9udC1zaXplOiAxMXB4DQogICAgfQ0KLyogQ2FudmFzIHRhZ3MgYW5kIGNvbmZpZ3VyYXRpb24gbGlzdCB0YWdzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10YWcsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcmVhLXRhZywgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY2FudmFzLXRhZyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50Ow0KICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWJnKSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudDsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgYm94LXNoYWRvdzogMCAycHggMTBweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjMpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10YWc6aG92ZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcmVhLXRhZzpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtOmhvdmVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY2FudmFzLXRhZzpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWhvdmVyKSAhaW1wb3J0YW50Ow0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDE1cHggcmdiYSgwLCAyMTIsIDI1NSwgMC41KTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTFweCkNCiAgICB9DQovKiBUYWcgdGV4dCBhbmQgaWNvbnMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRhZyAudGFnLXRleHQsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcmVhLXRhZyAudGFnLXRleHQsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbSAudGFnLXRleHQsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jYW52YXMtdGFnIC50YWctdGV4dCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdGFnIGksIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcmVhLXRhZyBpLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gaSwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNhbnZhcy10YWcgaSB7DQogICAgY29sb3I6IHZhcigtLXByaW1hcnktYmcpICFpbXBvcnRhbnQNCiAgICB9DQovKiBUYWcgaW5kaWNhdG9yIGNpcmNsZXMvZG90cyBpbiBjb25maWd1cmF0aW9uIGFyZWEgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaW5kaWNhdG9yLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWNvbG9yLWluZGljYXRvciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1jaXJjbGUsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctZG90LCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXJlYS10YWctaW5kaWNhdG9yLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWNvbG9yIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQ7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50DQogICAgfQ0KLyogVGFnIGl0ZW1zIGluIGNvbmZpZ3VyYXRpb24gbGlzdCAtIG1hdGNoIG5vZGUgbGlzdCBzdHlsaW5nICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcikgIWltcG9ydGFudDsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSkgIWltcG9ydGFudA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbTpob3ZlciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAyMTIsIDI1NSwgMC4xKSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50Ow0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRleSgtMXB4KTsNCiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gLnRhZy1uYW1lIHsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KSAhaW1wb3J0YW50DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtIC50YWctaW5mbyB7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSkgIWltcG9ydGFudA0KICAgIH0NCi8qIFRhZyBkZWxldGUgYnV0dG9uIHN0eWxpbmcgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctZGVsZXRlLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gLnRhZy1kZWxldGUgew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpICFpbXBvcnRhbnQ7DQogICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQgIWltcG9ydGFudDsNCiAgICBib3JkZXI6IG5vbmUgIWltcG9ydGFudA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctZGVsZXRlOmhvdmVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gLnRhZy1kZWxldGU6aG92ZXIgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWRlbGV0ZSBpLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gLnRhZy1kZWxldGUgaSB7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSkgIWltcG9ydGFudA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctZGVsZXRlOmhvdmVyIGksIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbSAudGFnLWRlbGV0ZTpob3ZlciBpIHsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50DQogICAgfQ0KLyogQ29uZmlndXJhdGlvbiBhcmVhIGhlYWRlciB0ZXh0ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWhlYWRlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZ3VyYXRpb24taGVhZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25maWctaGVhZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLXBsYWNlaG9sZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlndXJhdGlvbi1wbGFjZWhvbGRlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLWFyZWEgcCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLWFyZWEgLnBsYWNlaG9sZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25maWctYXJlYSAuY29uZmlnLW1lc3NhZ2UsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctYXJlYSBwLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWFyZWEgLnBsYWNlaG9sZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWFyZWEgLmNvbmZpZy1tZXNzYWdlLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25maWd1cmF0aW9uIHAsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbmZpZ3VyYXRpb24gLnBsYWNlaG9sZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGV4dC1tdXRlZCB7DQogICAgY29sb3I6IHZhcigtLXRleHQtc2Vjb25kYXJ5KSAhaW1wb3J0YW50DQogICAgfQ0KLyogUnVubmluZyBzdGF0ZSB3aXRoIHB1bHNpbmcgZWZmZWN0ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLnJ1bm5pbmcgew0KICAgIGFuaW1hdGlvbjogcHVsc2UtbmVvbiAycyBpbmZpbml0ZTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXN1Y2Nlc3MtY29sb3IpDQogICAgfQ0KQGtleWZyYW1lcyBwdWxzZS1uZW9uIHsNCiAgICAwJSwgMTAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCA1cHggcmdiYSg0NiwgMjEzLCAxMTUsIDAuNSk7DQogICAgICAgIH0gNTAlIHsNCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDIwcHggcmdiYSg0NiwgMjEzLCAxMTUsIDAuOCksIDAgMCAzMHB4IHJnYmEoNDYsIDIxMywgMTE1LCAwLjQpOw0KICAgICAgICB9DQogICAgfQ0KLyogRXJyb3Igc3RhdGUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUuZXJyb3Igew0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGFuaW1hdGlvbjogcHVsc2UtZXJyb3ItbmVvbiAxcyBpbmZpbml0ZQ0KICAgIH0NCkBrZXlmcmFtZXMgcHVsc2UtZXJyb3ItbmVvbiB7DQogICAgMCUsIDEwMCUgew0KICAgICAgICBib3gtc2hhZG93OiAwIDAgNXB4IHJnYmEoMjU1LCA3MSwgODcsIDAuNSk7DQogICAgICAgIH0gNTAlIHsNCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDIwcHggcmdiYSgyNTUsIDcxLCA4NywgMC44KSwgMCAwIDMwcHggcmdiYSgyNTUsIDcxLCA4NywgMC40KTsNCiAgICAgICAgfQ0KICAgIH0NCi8qIFJlc3BvbnNpdmUgYWRqdXN0bWVudHMgKi8NCkBtZWRpYSAobWF4LXdpZHRoOiA3NjhweCkgew0KICAgIC5mbG93LXRvb2xib3ggew0KICAgICAgICB3aWR0aDogMjAwcHgNCiAgICAgICAgfQ0KICAgIC5mbG93LW5vZGUgew0KICAgICAgICBtaW4td2lkdGg6IDEyMHB4Ow0KICAgICAgICBmb250LXNpemU6IDEycHgNCiAgICAgICAgfQ0KICAgIC50b29sYm94LW5vZGUtYnRuIHsNCiAgICAgICAgcGFkZGluZzogOHB4IDEwcHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTJweA0KICAgICAgICB9DQogICAgfTwvc3R5bGU+PGRpdiBjbGFzcz0iYXBwLWNvbnRhaW5lciIgZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiPg0KPGRpdiBjbGFzcz0iYXBwLWNvbnRlbnQiPg0KPGRpdiBjbGFzcz0iZmxvdy1lZGl0b3IiPg0KPCEtLSBMZWZ0IFRvb2xib3ggLS0+DQo8ZGl2IGNsYXNzPSJmbG93LXRvb2xib3giIGlkPSJmbG93LXRvb2xib3giPg0KPGRpdiBjbGFzcz0idG9vbGJveC1oZWFkZXIiPg0KPGg0PjxpIGNsYXNzPSJmYXMgZmEtdG9vbHMiPjwvaT4gTm9kZXM8L2g0Pg0KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tb3V0bGluZS1zZWNvbmRhcnkiIGlkPSJ0b2dnbGUtdG9vbGJveCIgdGl0bGU9IkNvbGxhcHNlIFRvb2xib3giPg0KPGkgY2xhc3M9ImZhcyBmYS1jaGV2cm9uLWxlZnQiPjwvaT4NCjwvYnV0dG9uPg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJ0b29sYm94LWNvbnRlbnQiIGlkPSJ0b29sYm94LWNvbnRlbnQiPg0KPCEtLSBOb2RlcyB3aWxsIGJlIGxvYWRlZCBkeW5hbWljYWxseSBmcm9tIFZGUyAtLT4NCjxkaXYgY2xhc3M9ImxvYWRpbmctbm9kZXMiPg0KPHAgY2xhc3M9InRleHQtbXV0ZWQiPkxvYWRpbmcgbm9kZXMuLi48L3A+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQo8IS0tIE1haW4gd29ya3NwYWNlIC0tPg0KPGRpdiBjbGFzcz0iZmxvdy13b3Jrc3BhY2UiPg0KPCEtLSBUb29sYmFyIC0tPg0KPGRpdiBjbGFzcz0iZmxvdy10b29sYmFyIj4NCjxkaXYgY2xhc3M9InRvb2xiYXItbGVmdCI+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXN1Y2Nlc3MiIGlkPSJydW4td29ya2Zsb3ciPg0KPGkgY2xhc3M9ImZhcyBmYS1wbGF5Ij48L2k+IDxzcGFuIGNsYXNzPSJidG4tdGV4dCI+UnVuIFdvcmtmbG93PC9zcGFuPg0KPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLWRhbmdlciIgaWQ9InN0b3Atd29ya2Zsb3ciIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQo8aSBjbGFzcz0iZmFzIGZhLXN0b3AiPjwvaT4gPHNwYW4gY2xhc3M9ImJ0bi10ZXh0Ij5TdG9wPC9zcGFuPg0KPC9idXR0b24+DQo8ZGl2IGNsYXNzPSJjdXJyZW50LWZpbGUtaW5mbyI+DQo8c3BhbiBjbGFzcz0iY3VycmVudC1maWxlbmFtZSIgaWQ9ImN1cnJlbnQtZmlsZW5hbWUiPnVudGl0bGVkLmZsb3c8L3NwYW4+DQo8L2Rpdj4NCjwvZGl2Pg0KPGRpdiBjbGFzcz0idG9vbGJhci1yaWdodCI+DQo8IS0tIFpvb20gY29udHJvbHMgc3RheSB2aXNpYmxlIC0tPg0KPGRpdiBjbGFzcz0iem9vbS1jb250cm9scyI+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiBpZD0iem9vbS1vdXQiIHRpdGxlPSJab29tIE91dCI+DQo8aSBjbGFzcz0iZmFzIGZhLXNlYXJjaC1taW51cyI+PC9pPg0KPC9idXR0b24+DQo8c3BhbiBjbGFzcz0iem9vbS1sZXZlbCIgaWQ9Inpvb20tbGV2ZWwiPjEwMCU8L3NwYW4+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiBpZD0iem9vbS1pbiIgdGl0bGU9Ilpvb20gSW4iPg0KPGkgY2xhc3M9ImZhcyBmYS1zZWFyY2gtcGx1cyI+PC9pPg0KPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiBpZD0iem9vbS1maXQiIHRpdGxlPSJab29tIHRvIEZpdCI+DQo8aSBjbGFzcz0iZmFzIGZhLWV4cGFuZC1hcnJvd3MtYWx0Ij48L2k+DQo8L2J1dHRvbj4NCjwvZGl2Pg0KPCEtLSBIYW1idXJnZXIgTWVudSBCdXR0b24gLS0+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IGhhbWJ1cmdlci1idG4iIGlkPSJoYW1idXJnZXItbWVudSIgdGl0bGU9Ik1lbnUiPg0KPGkgY2xhc3M9ImZhcyBmYS1iYXJzIj48L2k+DQo8L2J1dHRvbj4NCjwvZGl2Pg0KPC9kaXY+DQo8IS0tIERyb3Bkb3duIE1lbnUgLSBPbmx5IGZpbGUgb3BlcmF0aW9ucyBhbmQgZGVsZXRlL2NsZWFyIGFjdGlvbnMgLS0+DQo8ZGl2IGNsYXNzPSJkcm9wZG93bi1tZW51IiBpZD0iZHJvcGRvd24tbWVudSI+DQo8ZGl2IGNsYXNzPSJtZW51LXNlY3Rpb24iPg0KPGRpdiBjbGFzcz0ibWVudS1zZWN0aW9uLXRpdGxlIj5GaWxlIEFjdGlvbnM8L2Rpdj4NCjxidXR0b24gY2xhc3M9Im1lbnUtaXRlbSIgZGF0YS1hY3Rpb249InNhdmUtZmxvdyI+DQo8aSBjbGFzcz0iZmFzIGZhLXNhdmUiPjwvaT4gU2F2ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0iIGRhdGEtYWN0aW9uPSJzYXZlLWZsb3ctYXMiPg0KPGkgY2xhc3M9ImZhcyBmYS1zYXZlIj48L2k+IFNhdmUgQXMNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIiBkYXRhLWFjdGlvbj0ibG9hZC1mbG93Ij4NCjxpIGNsYXNzPSJmYXMgZmEtZm9sZGVyLW9wZW4iPjwvaT4gTG9hZA0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQo8L2Rpdj4NCjxkaXYgY2xhc3M9Im1lbnUtc2VjdGlvbiI+DQo8ZGl2IGNsYXNzPSJtZW51LXNlY3Rpb24tdGl0bGUiPlZpZXcgQWN0aW9uczwvZGl2Pg0KPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIiBkYXRhLWFjdGlvbj0iYWRkLXRhZyI+DQo8aSBjbGFzcz0iZmFzIGZhLXRhZyI+PC9pPiBBZGQgVGFnDQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCjxidXR0b24gY2xhc3M9Im1lbnUtaXRlbSIgZGF0YS1hY3Rpb249InJlc2V0LXZpZXciPg0KPGkgY2xhc3M9ImZhcyBmYS1jcm9zc2hhaXJzIj48L2k+IFJlc2V0IFZpZXcNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJtZW51LXNlY3Rpb24iPg0KPGRpdiBjbGFzcz0ibWVudS1zZWN0aW9uLXRpdGxlIj5FZGl0IEFjdGlvbnM8L2Rpdj4NCjxidXR0b24gY2xhc3M9Im1lbnUtaXRlbSBkYW5nZXIiIGRhdGEtYWN0aW9uPSJkZWxldGUtc2VsZWN0ZWQiPg0KPGkgY2xhc3M9ImZhcyBmYS10cmFzaCI+PC9pPiBEZWxldGUgU2VsZWN0ZWQNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIGRhbmdlciIgZGF0YS1hY3Rpb249ImNsZWFyLWNhbnZhcyI+DQo8aSBjbGFzcz0iZmFzIGZhLXRyYXNoLWFsdCI+PC9pPiBDbGVhciBBbGwNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPC9kaXY+DQo8L2Rpdj4NCjwhLS0gTWFpbiBjYW52YXMgYXJlYSAtLT4NCjxkaXYgY2xhc3M9ImZsb3ctY2FudmFzLWNvbnRhaW5lciI+DQo8ZGl2IGNsYXNzPSJmbG93LWNhbnZhcyIgaWQ9ImZsb3ctY2FudmFzIj4NCjwhLS0gTm9kZXMgd2lsbCBiZSBhZGRlZCBoZXJlIGR5bmFtaWNhbGx5IC0tPg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KPCEtLSBDb25maWd1cmF0aW9uIHBhbmVsIC0tPg0KPGRpdiBjbGFzcz0iZmxvdy1jb25maWctcGFuZWwiIGlkPSJmbG93LWNvbmZpZy1wYW5lbCI+DQo8ZGl2IGNsYXNzPSJjb25maWctaGVhZGVyIj4NCjxoND48aSBjbGFzcz0iZmFzIGZhLWNvZyI+PC9pPiBDb25maWd1cmF0aW9uPC9oND4NCjxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiBpZD0idG9nZ2xlLWNvbmZpZyIgdGl0bGU9IkNvbGxhcHNlIENvbmZpZ3VyYXRpb24gUGFuZWwiPg0KPGkgY2xhc3M9ImZhcyBmYS1jaGV2cm9uLXJpZ2h0Ij48L2k+DQo8L2J1dHRvbj4NCjwvZGl2Pg0KPGRpdiBjbGFzcz0iY29uZmlnLWNvbnRlbnQiIGlkPSJjb25maWctY29udGVudCI+DQo8ZGl2IGlkPSJub2RlLWNvbmZpZyI+DQo8cCBjbGFzcz0idGV4dC1tdXRlZCI+U2VsZWN0IGEgbm9kZSB0byBjb25maWd1cmUgaXQ8L3A+DQo8L2Rpdj4NCjxkaXYgaWQ9InRhZy1wYW5lbCI+DQo8aDU+PGkgY2xhc3M9ImZhcyBmYS10YWdzIj48L2k+IEFyZWEgVGFnczwvaDU+DQo8cCBjbGFzcz0idGV4dC1tdXRlZCI+Tm8gdGFncyB5ZXQ8L3A+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCjwhLS0gT3V0cHV0IHBhbmVsIC0tPg0KPGRpdiBjbGFzcz0iZmxvdy1vdXRwdXQtcGFuZWwgY29sbGFwc2VkIiBpZD0iZmxvdy1vdXRwdXQtcGFuZWwiPg0KPGRpdiBjbGFzcz0ib3V0cHV0LWhlYWRlciI+DQo8aDQ+PGkgY2xhc3M9ImZhcyBmYS10ZXJtaW5hbCI+PC9pPiBFeGVjdXRpb24gT3V0cHV0PC9oND4NCjxkaXYgY2xhc3M9Im91dHB1dC1jb250cm9scyI+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSIgaWQ9InRvZ2dsZS1vdXRwdXQiIHRpdGxlPSJTaG93L0hpZGUgT3V0cHV0Ij4NCjxpIGNsYXNzPSJmYXMgZmEtY2hldnJvbi1kb3duIj48L2k+DQo8L2J1dHRvbj4NCjxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiBpZD0iY2xlYXItb3V0cHV0Ij4NCjxpIGNsYXNzPSJmYXMgZmEtdHJhc2giPjwvaT4gQ2xlYXINCiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQo8L2Rpdj4NCjwvZGl2Pg0KPGRpdiBjbGFzcz0ib3V0cHV0LWNvbnRlbnQiIGlkPSJvdXRwdXQtY29udGVudCIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4NCjxkaXYgY2xhc3M9ImV4ZWN1dGlvbi1vdXRwdXQiIGlkPSJleGVjdXRpb24tb3V0cHV0Ij4NCjxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5Xb3JrZmxvdyBvdXRwdXQgd2lsbCBhcHBlYXIgaGVyZTwvcD4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQoNCjxzY3JpcHQ+Ly8gPT09PT0gU2NyaXB0OiBqcy91dGlscy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvbm9kZS1yZWdpc3RyeS5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvY2FudmFzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9ub2RlLWNvbmZpZy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvbm9kZS1yZW5kZXJlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvZGF0YS1leGVjdXRvcnMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2h0dHAtZXhlY3V0b3JzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9tZWRpYS1leGVjdXRvcnMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2Zsb3ctZXhlY3V0b3JzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9haS1leGVjdXRvcnMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2V4ZWN1dGlvbi1lbmdpbmUuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL3dvcmtmbG93LmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9jYW52YXMtbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvdGFnLW1hbmFnZXIuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2ZpbGUtbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvdWktbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvbWFpbi5qcyA9PT09PQ0KDQoNCi8vIHV0aWxzLmpzIC0gVXRpbGl0eSBmdW5jdGlvbnMgZm9yIEZsb3cgRWRpdG9yDQoNCi8vIENhbnZhcy1zcGVjaWZpYyBjb29yZGluYXRlIHRyYW5zZm9ybWF0aW9uIHV0aWxpdGllcw0KLy8gKEFwcCBzY2FsaW5nIHV0aWxpdGllcyBhcmUgbm93IGNlbnRyYWxpemVkIGluIHN5cG5leEFQSS5zY2FsaW5nKQ0KDQovLyBVdGlsaXR5IGZ1bmN0aW9uIHRvIGVzY2FwZSBIVE1MDQpmdW5jdGlvbiBlc2NhcGVIdG1sKHRleHQpIHsNCiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBkaXYudGV4dENvbnRlbnQgPSB0ZXh0Ow0KICAgIHJldHVybiBkaXYuaW5uZXJIVE1MOw0KfQ0KDQovLyBVdGlsaXR5IGZ1bmN0aW9uIHRvIGZvcm1hdCBmaWxlIHNpemUNCmZ1bmN0aW9uIGZvcm1hdEZpbGVTaXplKGJ5dGVzKSB7DQogICAgaWYgKGJ5dGVzID09PSAwKSByZXR1cm4gJzAgQnl0ZXMnOw0KICAgIGNvbnN0IGsgPSAxMDI0Ow0KICAgIGNvbnN0IHNpemVzID0gWydCeXRlcycsICdLQicsICdNQicsICdHQiddOw0KICAgIGNvbnN0IGkgPSBNYXRoLmZsb29yKE1hdGgubG9nKGJ5dGVzKSAvIE1hdGgubG9nKGspKTsNCiAgICByZXR1cm4gcGFyc2VGbG9hdCgoYnl0ZXMgLyBNYXRoLnBvdyhrLCBpKSkudG9GaXhlZCgyKSkgKyAnICcgKyBzaXplc1tpXTsNCn0NCg0KLy8gVXRpbGl0eSBmdW5jdGlvbiB0byBkZWJvdW5jZSBmdW5jdGlvbiBjYWxscw0KZnVuY3Rpb24gZGVib3VuY2UoZnVuYywgd2FpdCkgew0KICAgIGxldCB0aW1lb3V0Ow0KICAgIHJldHVybiBmdW5jdGlvbiBleGVjdXRlZEZ1bmN0aW9uKC4uLmFyZ3MpIHsNCiAgICAgICAgY29uc3QgbGF0ZXIgPSAoKSA9PiB7DQogICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7DQogICAgICAgICAgICBmdW5jKC4uLmFyZ3MpOw0KICAgICAgICB9Ow0KICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7DQogICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTsNCiAgICB9Ow0KfQ0KDQoNCi8vIEhlbHBlciBtZXRob2QgZm9yIHRlbXBsYXRlIHByb2Nlc3NpbmcNCmZ1bmN0aW9uIHByb2Nlc3NUZW1wbGF0ZXModGVtcGxhdGUsIGRhdGEpIHsNCiAgICBsZXQgcmVzdWx0ID0gdGVtcGxhdGU7DQogICAgaWYgKHR5cGVvZiBkYXRhID09PSAnb2JqZWN0JyAmJiBkYXRhICE9PSBudWxsKSB7DQogICAgICAgIC8vIENoZWNrIGlmIGRhdGEuZGF0YSBpcyBhIEpTT04gc3RyaW5nIGFuZCB0cnkgdG8gcGFyc2UgaXQNCiAgICAgICAgbGV0IHRlbXBsYXRlRGF0YSA9IGRhdGE7DQogICAgICAgIGlmIChkYXRhLmRhdGEgJiYgdHlwZW9mIGRhdGEuZGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkRGF0YSA9IEpTT04ucGFyc2UoZGF0YS5kYXRhKTsNCiAgICAgICAgICAgICAgICAvLyBNZXJnZSB0aGUgcGFyc2VkIEpTT04gd2l0aCB0aGUgb3JpZ2luYWwgZGF0YSBvYmplY3QNCiAgICAgICAgICAgICAgICB0ZW1wbGF0ZURhdGEgPSB7IC4uLmRhdGEsIC4uLnBhcnNlZERhdGEgfTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAvLyBJZiBwYXJzaW5nIGZhaWxzLCBqdXN0IHVzZSB0aGUgb3JpZ2luYWwgZGF0YQ0KICAgICAgICAgICAgICAgIHRlbXBsYXRlRGF0YSA9IGRhdGE7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEZpbmQgYWxsIHRlbXBsYXRlIHBhdHRlcm5zIGxpa2Uge3trZXl9fSBvciB7e3BhdGgudG8udmFsdWV9fQ0KICAgICAgICBjb25zdCB0ZW1wbGF0ZVBhdHRlcm4gPSAvXHtceyhbXn1dKylcfVx9L2c7DQogICAgICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKHRlbXBsYXRlUGF0dGVybiwgKG1hdGNoLCBwYXRoKSA9PiB7DQogICAgICAgICAgICAvLyBUcnkgdG8gZ2V0IG5lc3RlZCB2YWx1ZSB1c2luZyBkb3Qgbm90YXRpb24NCiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZXh0cmFjdE5lc3RlZFZhbHVlKHRlbXBsYXRlRGF0YSwgcGF0aCk7DQogICAgICAgICAgICAvLyBSZXR1cm4gdGhlIHZhbHVlIGlmIGZvdW5kLCBvdGhlcndpc2Uga2VlcCB0aGUgb3JpZ2luYWwgdGVtcGxhdGUNCiAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiBtYXRjaDsNCiAgICAgICAgfSk7DQogICAgfQ0KICAgIHJldHVybiByZXN1bHQ7DQp9DQoNCi8vIEhlbHBlciBtZXRob2QgZm9yIGV4dHJhY3RpbmcgbmVzdGVkIEpTT04gdmFsdWVzDQpmdW5jdGlvbiBleHRyYWN0TmVzdGVkVmFsdWUob2JqLCBwYXRoKSB7DQogICAgY29uc3Qga2V5cyA9IHBhdGguc3BsaXQoJy4nKTsNCiAgICBsZXQgY3VycmVudCA9IG9iajsNCg0KICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHsNCiAgICAgICAgaWYgKGN1cnJlbnQgPT09IG51bGwgfHwgY3VycmVudCA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEhhbmRsZSBhcnJheSBhY2Nlc3MgbGlrZSAiaXRlbXNbMF0ubmFtZSINCiAgICAgICAgY29uc3QgYXJyYXlNYXRjaCA9IGtleS5tYXRjaCgvXiguKylcWyhcZCspXF0kLyk7DQogICAgICAgIGlmIChhcnJheU1hdGNoKSB7DQogICAgICAgICAgICBjb25zdCBhcnJheUtleSA9IGFycmF5TWF0Y2hbMV07DQogICAgICAgICAgICBjb25zdCBhcnJheUluZGV4ID0gcGFyc2VJbnQoYXJyYXlNYXRjaFsyXSk7DQoNCiAgICAgICAgICAgIGlmIChjdXJyZW50W2FycmF5S2V5XSAmJiBBcnJheS5pc0FycmF5KGN1cnJlbnRbYXJyYXlLZXldKSkgew0KICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50W2FycmF5S2V5XVthcnJheUluZGV4XTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFtrZXldOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcmV0dXJuIGN1cnJlbnQ7DQp9DQoNCi8vIEhlbHBlciBtZXRob2QgdG8gZGV0ZWN0IGltYWdlIHR5cGUgZnJvbSBiYXNlNjQgZGF0YQ0KZnVuY3Rpb24gZGV0ZWN0SW1hZ2VUeXBlRnJvbUJhc2U2NChiYXNlNjREYXRhKSB7DQogICAgLy8gQ2hlY2sgdGhlIGZpcnN0IGZldyBieXRlcyB0byBkZXRlcm1pbmUgaW1hZ2UgdHlwZQ0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IGJpbmFyeVN0cmluZyA9IGF0b2IoYmFzZTY0RGF0YSk7DQogICAgICAgIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYmluYXJ5U3RyaW5nLmxlbmd0aCk7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmluYXJ5U3RyaW5nLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBieXRlc1tpXSA9IGJpbmFyeVN0cmluZy5jaGFyQ29kZUF0KGkpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQ2hlY2sgZmlsZSBzaWduYXR1cmVzDQogICAgICAgIGlmIChieXRlc1swXSA9PT0gMHhGRiAmJiBieXRlc1sxXSA9PT0gMHhEOCAmJiBieXRlc1syXSA9PT0gMHhGRikgew0KICAgICAgICAgICAgcmV0dXJuICdpbWFnZS9qcGVnJzsNCiAgICAgICAgfSBlbHNlIGlmIChieXRlc1swXSA9PT0gMHg4OSAmJiBieXRlc1sxXSA9PT0gMHg1MCAmJiBieXRlc1syXSA9PT0gMHg0RSAmJiBieXRlc1szXSA9PT0gMHg0Nykgew0KICAgICAgICAgICAgcmV0dXJuICdpbWFnZS9wbmcnOw0KICAgICAgICB9IGVsc2UgaWYgKGJ5dGVzWzBdID09PSAweDQ3ICYmIGJ5dGVzWzFdID09PSAweDQ5ICYmIGJ5dGVzWzJdID09PSAweDQ2KSB7DQogICAgICAgICAgICByZXR1cm4gJ2ltYWdlL2dpZic7DQogICAgICAgIH0gZWxzZSBpZiAoYnl0ZXNbMF0gPT09IDB4NTIgJiYgYnl0ZXNbMV0gPT09IDB4NDkgJiYgYnl0ZXNbMl0gPT09IDB4NDYgJiYgYnl0ZXNbM10gPT09IDB4NDYpIHsNCiAgICAgICAgICAgIHJldHVybiAnaW1hZ2Uvd2VicCc7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBEZWZhdWx0IHRvIFBORyBpZiB3ZSBjYW4ndCBkZXRlcm1pbmUNCiAgICAgICAgICAgIHJldHVybiAnaW1hZ2UvcG5nJzsNCiAgICAgICAgfQ0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgLy8gRGVmYXVsdCB0byBQTkcgaWYgdGhlcmUncyBhbiBlcnJvcg0KICAgICAgICByZXR1cm4gJ2ltYWdlL3BuZyc7DQogICAgfQ0KfQ0KDQovLyBDb252ZXJ0IHZpZXdwb3J0IGNvb3JkaW5hdGVzIHRvIGNhbnZhcyBjb29yZGluYXRlcyAoYWNjb3VudGluZyBmb3IgcGFuIGFuZCB6b29tKQ0KZnVuY3Rpb24gdmlld3BvcnRUb0NhbnZhc0Nvb3Jkcyh2aWV3cG9ydFgsIHZpZXdwb3J0WSkgew0KICAgIGlmICh0eXBlb2YgZmxvd0VkaXRvciA9PT0gJ3VuZGVmaW5lZCcpIHsNCiAgICAgICAgcmV0dXJuIHsgeDogdmlld3BvcnRYLCB5OiB2aWV3cG9ydFkgfTsNCiAgICB9DQogICAgDQogICAgcmV0dXJuIHsNCiAgICAgICAgeDogKHZpZXdwb3J0WCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWwsDQogICAgICAgIHk6ICh2aWV3cG9ydFkgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsDQogICAgfTsNCn0NCg0KLy8gQ29udmVydCBjYW52YXMgY29vcmRpbmF0ZXMgdG8gdmlld3BvcnQgY29vcmRpbmF0ZXMgKGFjY291bnRpbmcgZm9yIHBhbiBhbmQgem9vbSkNCmZ1bmN0aW9uIGNhbnZhc1RvVmlld3BvcnRDb29yZHMoY2FudmFzWCwgY2FudmFzWSkgew0KICAgIGlmICh0eXBlb2YgZmxvd0VkaXRvciA9PT0gJ3VuZGVmaW5lZCcpIHsNCiAgICAgICAgcmV0dXJuIHsgeDogY2FudmFzWCwgeTogY2FudmFzWSB9Ow0KICAgIH0NCiAgICANCiAgICByZXR1cm4gew0KICAgICAgICB4OiAoY2FudmFzWCAqIGZsb3dFZGl0b3Iuem9vbUxldmVsKSArIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngsDQogICAgICAgIHk6IChjYW52YXNZICogZmxvd0VkaXRvci56b29tTGV2ZWwpICsgZmxvd0VkaXRvci5wYW5PZmZzZXQueQ0KICAgIH07DQp9DQoNCi8vIEdldCB0aGUgY2VudGVyIG9mIHRoZSBjdXJyZW50IHZpZXdwb3J0IGluIGNhbnZhcyBjb29yZGluYXRlcw0KZnVuY3Rpb24gZ2V0Vmlld3BvcnRDZW50ZXJJbkNhbnZhcygpIHsNCiAgICBpZiAodHlwZW9mIGZsb3dFZGl0b3IgPT09ICd1bmRlZmluZWQnIHx8ICFmbG93RWRpdG9yLmNhbnZhcykgew0KICAgICAgICByZXR1cm4geyB4OiAwLCB5OiAwIH07DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgaWYgKCFjb250YWluZXIpIHsNCiAgICAgICAgcmV0dXJuIHsgeDogMCwgeTogMCB9Ow0KICAgIH0NCiAgICANCiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOw0KICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICANCiAgICByZXR1cm4gdmlld3BvcnRUb0NhbnZhc0Nvb3Jkcyh2aWV3cG9ydENlbnRlclgsIHZpZXdwb3J0Q2VudGVyWSk7DQp9DQoNCi8vIENlbnRlciB0aGUgdmlld3BvcnQgb24gc3BlY2lmaWMgY2FudmFzIGNvb3JkaW5hdGVzDQpmdW5jdGlvbiBjZW50ZXJWaWV3cG9ydE9uQ2FudmFzKGNhbnZhc1gsIGNhbnZhc1kpIHsNCiAgICBpZiAodHlwZW9mIGZsb3dFZGl0b3IgPT09ICd1bmRlZmluZWQnIHx8ICFmbG93RWRpdG9yLmNhbnZhcykgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgaWYgKCFjb250YWluZXIpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOw0KICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICANCiAgICAvLyBDYWxjdWxhdGUgcGFuIG9mZnNldCB0byBjZW50ZXIgdGhlIHNwZWNpZmllZCBjYW52YXMgY29vcmRpbmF0ZXMgaW4gdGhlIHZpZXdwb3J0DQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IHZpZXdwb3J0Q2VudGVyWCAtIChjYW52YXNYICogZmxvd0VkaXRvci56b29tTGV2ZWwpOw0KICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSB2aWV3cG9ydENlbnRlclkgLSAoY2FudmFzWSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsKTsNCiAgICANCiAgICAvLyBVcGRhdGUgdGhlIHRyYW5zZm9ybQ0KICAgIGlmICh3aW5kb3cuY2FudmFzTWFuYWdlciAmJiB3aW5kb3cuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0pIHsNCiAgICAgICAgd2luZG93LmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgfQ0KfQ0KDQovLyBFeHBvcnQgdXRpbGl0aWVzIGZvciB1c2UgaW4gb3RoZXIgbW9kdWxlcw0KLy8gQ2FudmFzLXNwZWNpZmljIHV0aWxpdGllcyBvbmx5IC0gc2NhbGluZyB1dGlsaXRpZXMgYXJlIG5vdyBpbiBzeXBuZXhBUEkuc2NhbGluZw0Kd2luZG93LmZsb3dFZGl0b3JVdGlscyA9IHsNCiAgICAvLyBDYW52YXMtc3BlY2lmaWMgY29vcmRpbmF0ZSB0cmFuc2Zvcm1hdGlvbnMNCiAgICB2aWV3cG9ydFRvQ2FudmFzQ29vcmRzLA0KICAgIGNhbnZhc1RvVmlld3BvcnRDb29yZHMsDQogICAgZ2V0Vmlld3BvcnRDZW50ZXJJbkNhbnZhcywNCiAgICBjZW50ZXJWaWV3cG9ydE9uQ2FudmFzLA0KICAgIA0KICAgIC8vIEdlbmVyYWwgdXRpbGl0aWVzDQogICAgZXNjYXBlSHRtbCwNCiAgICBmb3JtYXRGaWxlU2l6ZSwNCiAgICBkZWJvdW5jZSwNCiAgICBwcm9jZXNzVGVtcGxhdGVzLA0KICAgIGV4dHJhY3ROZXN0ZWRWYWx1ZSwNCiAgICBkZXRlY3RJbWFnZVR5cGVGcm9tQmFzZTY0DQp9Ow0KDQovLyBSZXBsYWNlIHRlbXBsYXRlIHBsYWNlaG9sZGVycyBpbiBKU09OIGJvZHkNCmZ1bmN0aW9uIHJlcGxhY2VUZW1wbGF0ZVBsYWNlaG9sZGVycyhib2R5LCB0ZW1wbGF0ZURhdGEpIHsNCg0KICAgIGlmICghYm9keSkgew0KICAgICAgICByZXR1cm4gYm9keTsNCiAgICB9DQoNCiAgICAvLyBIYW5kbGUgYm90aCBzdHJpbmcgYW5kIG9iamVjdCBpbnB1dHMNCiAgICBsZXQgYm9keVN0cmluZzsNCiAgICBsZXQgaXNKc29uU3RyaW5nID0gZmFsc2U7DQoNCiAgICBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7DQogICAgICAgIGJvZHlTdHJpbmcgPSBib2R5Ow0KICAgICAgICAvLyBDaGVjayBpZiBpdCdzIGFscmVhZHkgYSBKU09OIHN0cmluZw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgSlNPTi5wYXJzZShib2R5KTsNCiAgICAgICAgICAgIGlzSnNvblN0cmluZyA9IHRydWU7DQogICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgIC8vIE5vdCBhIEpTT04gc3RyaW5nLCB0cmVhdCBhcyByZWd1bGFyIHN0cmluZw0KICAgICAgICB9DQogICAgfSBlbHNlIGlmICh0eXBlb2YgYm9keSA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgYm9keVN0cmluZyA9IEpTT04uc3RyaW5naWZ5KGJvZHkpOw0KICAgICAgICBpc0pzb25TdHJpbmcgPSB0cnVlOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBib2R5Ow0KICAgIH0NCg0KDQogICAgLy8gUmVwbGFjZSBwbGFjZWhvbGRlcnMgd2l0aCB0ZW1wbGF0ZSBkYXRhDQogICAgaWYgKHRlbXBsYXRlRGF0YSAhPT0gdW5kZWZpbmVkICYmIHRlbXBsYXRlRGF0YSAhPT0gbnVsbCkgew0KICAgICAgICBjb25zdCBiZWZvcmVSZXBsYWNlID0gYm9keVN0cmluZzsNCg0KDQogICAgICAgIC8vIFNpbXBsZSBKU09OIGZpZWxkIHJlcGxhY2VtZW50IC0ganVzdCB7e2ZpZWxkfX0gb3Ige3tuZXN0ZWQuZmllbGR9fQ0KICAgICAgICBpZiAodHlwZW9mIHRlbXBsYXRlRGF0YSA9PT0gJ29iamVjdCcpIHsNCg0KICAgICAgICAgICAgLy8gVXNlIGEgc2ltcGxlciwgbW9yZSBleHBsaWNpdCByZWdleA0KICAgICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXJSZWdleCA9IC9ce1x7KFtefV0rKVx9XH0vZzsNCg0KICAgICAgICAgICAgLy8gVGVzdCBpZiB0aGUgcmVnZXggZmluZHMgYW55dGhpbmcNCiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBib2R5U3RyaW5nLm1hdGNoKHBsYWNlaG9sZGVyUmVnZXgpOw0KDQogICAgICAgICAgICBib2R5U3RyaW5nID0gYm9keVN0cmluZy5yZXBsYWNlKHBsYWNlaG9sZGVyUmVnZXgsIChtYXRjaCwgZmllbGRQYXRoKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBnZXROZXN0ZWRWYWx1ZSh0ZW1wbGF0ZURhdGEsIGZpZWxkUGF0aCk7DQogICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgbGV0IHJlcGxhY2VtZW50Ow0KICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWx3YXlzIGVzY2FwZSB0aGUgc3RyaW5nIHByb3Blcmx5IGZvciBKU09OIGNvbnRleHQNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50ID0gdmFsdWUucmVwbGFjZSgvXFwvZywgJ1xcXFwnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC8iL2csICdcXCInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cbi9nLCAnXFxuJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXHIvZywgJ1xccicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1x0L2csICdcXHQnKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBub24tc3RyaW5ncywgY29udmVydCB0byBKU09OIHN0cmluZw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnQgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcGxhY2VtZW50Ow0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXRjaDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdGVtcGxhdGVEYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgLy8gRm9yIHN0cmluZ3MsIGp1c3QgcmVwbGFjZSB7e1ZBTFVFfX0gYXMgYSBmYWxsYmFjaw0KICAgICAgICAgICAgYm9keVN0cmluZyA9IGJvZHlTdHJpbmcucmVwbGFjZSgve3tWQUxVRX19L2csIEpTT04uc3RyaW5naWZ5KHRlbXBsYXRlRGF0YSkpOw0KICAgICAgICB9DQoNCiAgICB9IGVsc2Ugew0KICAgIH0NCg0KICAgIGlmICh0eXBlb2YgYm9keSA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKGJvZHlTdHJpbmcpOw0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIHRlbXBsYXRlLXJlcGxhY2VkIGJvZHk6JywgZXJyb3IpOw0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignQm9keSBzdHJpbmcgd2FzOicsIGJvZHlTdHJpbmcpOw0KICAgICAgICAgICAgcmV0dXJuIGJvZHk7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gYm9keVN0cmluZzsNCiAgICB9DQp9DQoNCi8vIEdldCBuZXN0ZWQgdmFsdWUgZnJvbSBvYmplY3QgdXNpbmcgZG90IG5vdGF0aW9uDQpmdW5jdGlvbiBnZXROZXN0ZWRWYWx1ZShvYmosIHBhdGgpIHsNCiAgICBjb25zdCByZXN1bHQgPSBwYXRoLnNwbGl0KCcuJykucmVkdWNlKChjdXJyZW50LCBrZXkpID0+IHsNCiAgICAgICAgY29uc3QgdmFsdWUgPSBjdXJyZW50ICYmIGN1cnJlbnRba2V5XSAhPT0gdW5kZWZpbmVkID8gY3VycmVudFtrZXldIDogdW5kZWZpbmVkOw0KICAgICAgICByZXR1cm4gdmFsdWU7DQogICAgfSwgb2JqKTsNCiAgICByZXR1cm4gcmVzdWx0Ow0KfQ0KDQoNCi8vIFVwZGF0ZSBKU09OIGV4dHJhY3Qgbm9kZSBkaXNwbGF5DQpmdW5jdGlvbiB1cGRhdGVKc29uRXh0cmFjdERpc3BsYXkobm9kZUlkLCBsYWJlbCwgdmFsdWUsIHN0YXR1cyA9ICdub3JtYWwnKSB7DQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICBjb25zdCBjb250ZW50RWxlbWVudCA9IG5vZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mbG93LW5vZGUtY29udGVudCcpOw0KICAgICAgICBpZiAoY29udGVudEVsZW1lbnQpIHsNCiAgICAgICAgICAgIGNvbnN0IHN0YXR1c0NsYXNzID0gc3RhdHVzID09PSAnZXJyb3InID8gJ3RleHQtZGFuZ2VyJyA6IHN0YXR1cyA9PT0gJ3N1Y2Nlc3MnID8gJ3RleHQtc3VjY2VzcycgOiAndGV4dC1tdXRlZCc7DQoNCiAgICAgICAgICAgIC8vIFNob3cganVzdCBhIHN0YXR1cyBvbiB0aGUgbm9kZSwgZnVsbCBjb250ZW50IHdpbGwgYmUgaW4gY29uZmlnIHBhbmVsDQogICAgICAgICAgICBjb25zdCB0cnVuY2F0ZWRWYWx1ZSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUubGVuZ3RoID4gNTAgPw0KICAgICAgICAgICAgICAgIHZhbHVlLnN1YnN0cmluZygwLCA1MCkgKyAnLi4uJyA6IHZhbHVlOw0KDQogICAgICAgICAgICBjb250ZW50RWxlbWVudC5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibm9kZS1zdGF0dXMiPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0dXMtdGV4dCI+VmFsdWUgZXh0cmFjdGVkPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXR1cy1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD4ke2xhYmVsfTogJHtlc2NhcGVIdG1sKFN0cmluZyh0cnVuY2F0ZWRWYWx1ZSkpfTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gQWRkIGV4ZWN1dGlvbiBsb2cgZW50cnkNCmZ1bmN0aW9uIGFkZEV4ZWN1dGlvbkxvZyhtZXNzYWdlLCB0eXBlID0gJ2luZm8nKSB7DQogICAgY29uc3Qgb3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4ZWN1dGlvbi1vdXRwdXQnKTsNCiAgICBpZiAob3V0cHV0KSB7DQogICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCk7DQogICAgICAgIG91dHB1dC5pbm5lckhUTUwgKz0gYDxkaXYgY2xhc3M9ImxvZy1lbnRyeSAke3R5cGV9Ij5bJHt0aW1lc3RhbXB9XSAke21lc3NhZ2V9PC9kaXY+YDsNCiAgICAgICAgb3V0cHV0LnNjcm9sbFRvcCA9IG91dHB1dC5zY3JvbGxIZWlnaHQ7DQogICAgfQ0KfQ0KDQovLyBDbGVhciBleGVjdXRpb24gb3V0cHV0DQpmdW5jdGlvbiBjbGVhck91dHB1dCgpIHsNCiAgICBjb25zdCBvdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhlY3V0aW9uLW91dHB1dCcpOw0KICAgIGlmIChvdXRwdXQpIHsNCiAgICAgICAgb3V0cHV0LmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPSJsb2ctZW50cnkgaW5mbyI+T3V0cHV0IGNsZWFyZWQ8L2Rpdj4nOw0KICAgIH0NCn0NCg0KDQovLyBJbnRlcmFjdGl2ZSBoZWxwZXIgZnVuY3Rpb25zIGZvciBzcGVjaWFsIG5vZGUgdHlwZXMNCg0KLy8gQXVkaW8gY29udHJvbCBmdW5jdGlvbnMNCmZ1bmN0aW9uIHBsYXlBdWRpbyhub2RlSWQpIHsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUgfHwgIW5vZGUubGFzdEF1ZGlvVXJsKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIGF1ZGlvIGRhdGEgYXZhaWxhYmxlIGZvciBub2RlOicsIG5vZGVJZCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBDcmVhdGUgb3IgcmV1c2UgYXVkaW8gZWxlbWVudA0KICAgIGlmICghbm9kZS5hdWRpb0VsZW1lbnQpIHsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQgPSBuZXcgQXVkaW8obm9kZS5sYXN0QXVkaW9VcmwpOw0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC52b2x1bWUgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLnZvbHVtZS52YWx1ZSk7DQogICAgfQ0KDQogICAgbm9kZS5hdWRpb0VsZW1lbnQucGxheSgpLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBsYXkgYXVkaW86JywgZXJyb3IpOw0KICAgIH0pOw0KDQp9DQoNCmZ1bmN0aW9uIHN0b3BBdWRpbyhub2RlSWQpIHsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUgfHwgIW5vZGUuYXVkaW9FbGVtZW50KSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIGF1ZGlvIGVsZW1lbnQgZm91bmQgZm9yIG5vZGU6Jywgbm9kZUlkKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIG5vZGUuYXVkaW9FbGVtZW50LnBhdXNlKCk7DQogICAgbm9kZS5hdWRpb0VsZW1lbnQuY3VycmVudFRpbWUgPSAwOw0KDQp9DQoNCi8vIEltYWdlIGRpc3BsYXkgZnVuY3Rpb25zDQpmdW5jdGlvbiBzaG93RnVsbEltYWdlKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCAhbm9kZS5sYXN0SW1hZ2VVcmwpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTm8gaW1hZ2UgZGF0YSBhdmFpbGFibGUgZm9yIG5vZGU6Jywgbm9kZUlkKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIENyZWF0ZSBhIG1vZGFsIHRvIHNob3cgdGhlIGZ1bGwgaW1hZ2UNCiAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIG1vZGFsLmNsYXNzTmFtZSA9ICdpbWFnZS1tb2RhbCc7DQogICAgbW9kYWwuc3R5bGUuY3NzVGV4dCA9IGANCiAgICAgICAgcG9zaXRpb246IGZpeGVkOw0KICAgICAgICB0b3A6IDA7DQogICAgICAgIGxlZnQ6IDA7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICBoZWlnaHQ6IDEwMCU7DQogICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC44KTsNCiAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICAgIHotaW5kZXg6IDEwMDAwOw0KICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgYDsNCg0KICAgIGNvbnN0IGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpOw0KICAgIGltZy5zcmMgPSBub2RlLmxhc3RJbWFnZVVybDsNCiAgICBpbWcuc3R5bGUuY3NzVGV4dCA9IGANCiAgICAgICAgbWF4LXdpZHRoOiA5MCU7DQogICAgICAgIG1heC1oZWlnaHQ6IDkwJTsNCiAgICAgICAgb2JqZWN0LWZpdDogY29udGFpbjsNCiAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgICAgICBib3gtc2hhZG93OiAwIDRweCAyMHB4IHJnYmEoMCwgMCwgMCwgMC41KTsNCiAgICBgOw0KDQogICAgbW9kYWwuYXBwZW5kQ2hpbGQoaW1nKTsNCiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vZGFsKTsNCg0KICAgIC8vIENsb3NlIG1vZGFsIG9uIGNsaWNrDQogICAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobW9kYWwpOw0KICAgIH0pOw0KDQp9DQoNCi8vIFJlcGVhdGVyIGNvbnRyb2wgZnVuY3Rpb25zDQpmdW5jdGlvbiBzdGFydFJlcGVhdGVyKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCBub2RlLnR5cGUgIT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignSW52YWxpZCByZXBlYXRlciBub2RlOicsIG5vZGVJZCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBFeGVjdXRlIHRoZSByZXBlYXRlciBub2RlIHRvIHN0YXJ0IGl0DQogICAgZXhlY3V0aW9uRW5naW5lLmV4ZWN1dGVOb2RlKG5vZGUsIHt9LCBuZXcgU2V0KCkpLnRoZW4oKCkgPT4gew0KICAgICAgICAvLyBSZWZyZXNoIHRoZSBjb25maWcgcGFuZWwgdG8gdXBkYXRlIHRoZSBVSQ0KICAgICAgICBzaG93Tm9kZUNvbmZpZyhub2RlSWQpOw0KICAgIH0pLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHN0YXJ0IHJlcGVhdGVyOicsIGVycm9yKTsNCiAgICB9KTsNCn0NCg0KZnVuY3Rpb24gc3RvcFJlcGVhdGVyKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCBub2RlLnR5cGUgIT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignSW52YWxpZCByZXBlYXRlciBub2RlOicsIG5vZGVJZCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBTdG9wIHRoZSByZXBlYXRlciB1c2luZyB0aGUgZXhlY3V0aW9uIGVuZ2luZSBtZXRob2QNCiAgICBleGVjdXRpb25FbmdpbmUuc3RvcFJlcGVhdGVyKG5vZGUpOw0KDQogICAgLy8gUmVmcmVzaCB0aGUgY29uZmlnIHBhbmVsIHRvIHVwZGF0ZSB0aGUgVUkNCiAgICBzaG93Tm9kZUNvbmZpZyhub2RlSWQpOw0KfQ0KDQoNCg0KLy8gVXBkYXRlIGlucHV0IG1hcHBpbmcgd2hlbiB1c2VyIHNlbGVjdHMgYSBkaWZmZXJlbnQgb3V0cHV0IHBvcnQNCmZ1bmN0aW9uIHVwZGF0ZUlucHV0TWFwcGluZyhub2RlSWQsIGlucHV0UG9ydCwgc2VsZWN0ZWRPdXRwdXRQb3J0KSB7DQogICAgLy8gRmluZCB0aGUgY29ubmVjdGlvbiB0aGF0IGdvZXMgdG8gdGhpcyBpbnB1dCBwb3J0IChpZ25vcmUgZnJvbS5wb3J0TmFtZSkNCiAgICBjb25zdCBjb25uZWN0aW9uID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5maW5kKGNvbm4gPT4NCiAgICAgICAgY29ubi50by5ub2RlSWQgPT09IG5vZGVJZCAmJiBjb25uLnRvLnBvcnROYW1lID09PSBpbnB1dFBvcnQNCiAgICApOw0KICAgIGlmIChjb25uZWN0aW9uKSB7DQogICAgICAgIC8vIFJlbW92ZSB0aGUgb2xkIGNvbm5lY3Rpb24NCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5kZWxldGUoY29ubmVjdGlvbi5pZCk7DQogICAgICAgIGlmIChjb25uZWN0aW9uLnN2ZykgY29ubmVjdGlvbi5zdmcucmVtb3ZlKCk7DQogICAgICAgIC8vIENyZWF0ZSBhIG5ldyBjb25uZWN0aW9uIHdpdGggdGhlIHVwZGF0ZWQgcG9ydCBuYW1lIGFuZCBuZXcgSUQNCiAgICAgICAgY29uc3QgbmV3Q29ubmVjdGlvbklkID0gYGNvbm5fJHtjb25uZWN0aW9uLmZyb20ubm9kZUlkfV8ke3NlbGVjdGVkT3V0cHV0UG9ydH1fJHtjb25uZWN0aW9uLnRvLm5vZGVJZH1fJHtjb25uZWN0aW9uLnRvLnBvcnROYW1lfWA7DQogICAgICAgIGNvbnN0IG5ld0Nvbm5lY3Rpb24gPSB7DQogICAgICAgICAgICBpZDogbmV3Q29ubmVjdGlvbklkLA0KICAgICAgICAgICAgZnJvbTogeyBub2RlSWQ6IGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQsIHBvcnROYW1lOiBzZWxlY3RlZE91dHB1dFBvcnQgfSwNCiAgICAgICAgICAgIHRvOiB7IG5vZGVJZDogY29ubmVjdGlvbi50by5ub2RlSWQsIHBvcnROYW1lOiBjb25uZWN0aW9uLnRvLnBvcnROYW1lIH0NCiAgICAgICAgfTsNCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5zZXQobmV3Q29ubmVjdGlvbklkLCBuZXdDb25uZWN0aW9uKTsNCiAgICAgICAgZHJhd0Nvbm5lY3Rpb24obmV3Q29ubmVjdGlvbik7DQogICAgICAgIC8vIFJlZnJlc2ggdGhlIG5vZGUgY29uZmlnIHBhbmVsIHRvIHNob3cgdXBkYXRlZCBzdGF0ZQ0KICAgICAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPT09IG5vZGVJZCkgew0KICAgICAgICAgICAgc2hvd05vZGVDb25maWcobm9kZUlkKTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBBdXRvLXNhdmUgdGhlIHdvcmtmbG93IHRvIHBlcnNpc3QgdGhlIG1hcHBpbmcgY2hhbmdlDQogICAgICAgIGlmICh3aW5kb3cuZmlsZU1hbmFnZXIuc2F2ZUZsb3cpIHsNCiAgICAgICAgICAgIHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvdygpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBVcGRhdGUgb3V0cHV0IG1hcHBpbmcgd2hlbiB1c2VyIHNlbGVjdHMgYSBkaWZmZXJlbnQgb3V0cHV0IHBvcnQNCmZ1bmN0aW9uIHVwZGF0ZU91dHB1dE1hcHBpbmcobm9kZUlkLCBvdXRwdXRQb3J0LCB0YXJnZXROb2RlSWQsIHNlbGVjdGVkT3V0cHV0UG9ydCkgew0KICAgIC8vIFJlbW92ZSBhbGwgY29ubmVjdGlvbnMgZnJvbSB0aGlzIG5vZGUgdG8gdGhlIHRhcmdldCBub2RlIChyZWdhcmRsZXNzIG9mIHBvcnQpDQogICAgY29uc3QgY29ubmVjdGlvbnNUb1JlbW92ZSA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkuZmlsdGVyKGNvbm4gPT4NCiAgICAgICAgY29ubi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkICYmIGNvbm4udG8ubm9kZUlkID09PSB0YXJnZXROb2RlSWQNCiAgICApOw0KICAgIGNvbm5lY3Rpb25zVG9SZW1vdmUuZm9yRWFjaChjb25uID0+IHsNCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5kZWxldGUoY29ubi5pZCk7DQogICAgICAgIGlmIChjb25uLnN2ZykgY29ubi5zdmcucmVtb3ZlKCk7DQogICAgfSk7DQogICAgLy8gQWRkIHRoZSBuZXcgY29ubmVjdGlvbg0KICAgIGNvbnN0IG5ld0Nvbm5lY3Rpb25JZCA9IGBjb25uXyR7bm9kZUlkfV8ke3NlbGVjdGVkT3V0cHV0UG9ydH1fJHt0YXJnZXROb2RlSWR9YDsNCiAgICBjb25zdCBuZXdDb25uZWN0aW9uID0gew0KICAgICAgICBpZDogbmV3Q29ubmVjdGlvbklkLA0KICAgICAgICBmcm9tOiB7IG5vZGVJZDogbm9kZUlkLCBwb3J0TmFtZTogc2VsZWN0ZWRPdXRwdXRQb3J0IH0sDQogICAgICAgIHRvOiB7IG5vZGVJZDogdGFyZ2V0Tm9kZUlkLCBwb3J0TmFtZTogY29ubmVjdGlvbnNUb1JlbW92ZVswXT8udG8ucG9ydE5hbWUgfHwgJ2RhdGEnIH0NCiAgICB9Ow0KICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuc2V0KG5ld0Nvbm5lY3Rpb25JZCwgbmV3Q29ubmVjdGlvbik7DQogICAgZHJhd0Nvbm5lY3Rpb24obmV3Q29ubmVjdGlvbik7DQogICAgLy8gUmVmcmVzaCB0aGUgdGFyZ2V0IG5vZGUgaWYgc2VsZWN0ZWQNCiAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPT09IHRhcmdldE5vZGVJZCkgew0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIHNob3dOb2RlQ29uZmlnKHRhcmdldE5vZGVJZCk7DQogICAgICAgIH0sIDEwKTsNCiAgICB9DQogICAgLy8gQXV0by1zYXZlDQogICAgaWYgKHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvdykgd2luZG93LmZpbGVNYW5hZ2VyLnNhdmVGbG93KCk7DQp9DQoNCg0KLy8gbm9kZS1yZWdpc3RyeS5qcyAtIER5bmFtaWMgbm9kZSByZWdpc3RyeSBmb3IgRmxvdyBFZGl0b3INCg0KY2xhc3MgTm9kZVJlZ2lzdHJ5IHsNCiAgICBjb25zdHJ1Y3RvcigpIHsNCiAgICAgICAgdGhpcy5ub2RlVHlwZXMgPSBuZXcgTWFwKCk7DQogICAgICAgIHRoaXMuZXhlY3V0b3JzID0gbmV3IE1hcCgpOw0KICAgICAgICB0aGlzLmxvYWRlZCA9IGZhbHNlOw0KICAgIH0NCiAgICANCiAgICBhc3luYyBsb2FkTm9kZXNGcm9tVkZTKCkgew0KICAgICAgICBpZiAodGhpcy5sb2FkZWQpIHJldHVybjsNCiAgICAgICAgDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIExvYWQgdGhlIHBhY2tlZCBub2RlcyBmaWxlIGRpcmVjdGx5DQogICAgICAgICAgICBjb25zdCBwYWNrRmlsZVBhdGggPSAnL25vZGVzL25vZGVzLXBhY2suanNvbic7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlVGV4dChwYWNrRmlsZVBhdGgpOw0KICAgICAgICAgICAgY29uc3QgcGFja0RhdGEgPSBKU09OLnBhcnNlKGNvbnRlbnQpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFJlZ2lzdGVyIGFsbCBub2RlcyBmcm9tIHRoZSBwYWNrDQogICAgICAgICAgICBmb3IgKGNvbnN0IFtub2RlSWQsIG5vZGVEZWZdIG9mIE9iamVjdC5lbnRyaWVzKHBhY2tEYXRhLm5vZGVzKSkgew0KICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJOb2RlKG5vZGVEZWYpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICB0aGlzLmxvYWRlZCA9IHRydWU7DQogICAgICAgICAgICANCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIG5vZGVzIGZyb20gVkZTIHBhY2tlZCBmaWxlOicsIGVycm9yKTsNCiAgICAgICAgICAgIHRocm93IGVycm9yOyAvLyBSZS10aHJvdyB0byBpbmRpY2F0ZSBmYWlsdXJlDQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgYXN5bmMgbG9hZE5vZGVGaWxlKGZpbGVQYXRoKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZVRleHQoZmlsZVBhdGgpOw0KICAgICAgICAgICAgY29uc3Qgbm9kZURlZiA9IEpTT04ucGFyc2UoY29udGVudCk7DQogICAgICAgICAgICB0aGlzLnJlZ2lzdGVyTm9kZShub2RlRGVmKTsNCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBsb2FkIG5vZGUgZnJvbSAke2ZpbGVQYXRofTpgLCBlcnJvcik7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmVnaXN0ZXJOb2RlKG5vZGVEZWYpIHsNCiAgICAgICAgdGhpcy5ub2RlVHlwZXMuc2V0KG5vZGVEZWYuaWQsIG5vZGVEZWYpOw0KICAgIH0NCiAgICANCiAgICByZWdpc3RlckV4ZWN1dG9yKG5hbWUsIGV4ZWN1dG9yKSB7DQogICAgICAgIHRoaXMuZXhlY3V0b3JzLnNldChuYW1lLCBleGVjdXRvcik7DQogICAgfQ0KICAgIA0KICAgIGdldE5vZGVUeXBlKGlkKSB7DQogICAgICAgIHJldHVybiB0aGlzLm5vZGVUeXBlcy5nZXQoaWQpOw0KICAgIH0NCiAgICANCiAgICBnZXRFeGVjdXRvcihuYW1lKSB7DQogICAgICAgIHJldHVybiB0aGlzLmV4ZWN1dG9ycy5nZXQobmFtZSk7DQogICAgfQ0KICAgIA0KICAgIGdldEFsbE5vZGVUeXBlcygpIHsNCiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5ub2RlVHlwZXMudmFsdWVzKCkpOw0KICAgIH0NCiAgICANCiAgICBnZXROb2RlVHlwZXNCeUNhdGVnb3J5KGNhdGVnb3J5KSB7DQogICAgICAgIHJldHVybiB0aGlzLmdldEFsbE5vZGVUeXBlcygpLmZpbHRlcihub2RlID0+IG5vZGUuY2F0ZWdvcnkgPT09IGNhdGVnb3J5KTsNCiAgICB9DQp9DQoNCi8vIEdsb2JhbCBub2RlIHJlZ2lzdHJ5IGluc3RhbmNlDQpjb25zdCBub2RlUmVnaXN0cnkgPSBuZXcgTm9kZVJlZ2lzdHJ5KCk7DQoNCg0KLy8gY2FudmFzLmpzIC0gQ2FudmFzIGV2ZW50IGhhbmRsZXJzIGFuZCBkcmF3aW5nIGxvZ2ljIGZvciBGbG93IEVkaXRvcg0KDQovLyBTdGFydCBkcmFnZ2luZyBhIG5vZGUNCmZ1bmN0aW9uIHN0YXJ0RHJhZ2dpbmdOb2RlKG5vZGVJZCwgZSkgew0KICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgIA0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSkgcmV0dXJuOw0KICAgIA0KICAgIGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlID0gbm9kZUlkOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBvZmZzZXQgZnJvbSBtb3VzZSB0byBub2RlIGNvcm5lciB1c2luZyBzY2FsZWQgY29vcmRpbmF0ZXMNCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgY29uc3QgcmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/IA0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KG5vZGVFbGVtZW50KSA6IA0KICAgICAgICBub2RlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8gDQogICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6IA0KICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgDQogICAgZmxvd0VkaXRvci5kcmFnT2Zmc2V0ID0gew0KICAgICAgICB4OiBtb3VzZUNvb3Jkcy54IC0gcmVjdC5sZWZ0LA0KICAgICAgICB5OiBtb3VzZUNvb3Jkcy55IC0gcmVjdC50b3ANCiAgICB9Ow0KICAgIA0KICAgIG5vZGVFbGVtZW50LnN0eWxlLmN1cnNvciA9ICdncmFiYmluZyc7DQogICAgbm9kZUVsZW1lbnQuc3R5bGUuekluZGV4ID0gJzEwMDAnOyAvLyBCcmluZyB0byBmcm9udCB3aGlsZSBkcmFnZ2luZw0KICAgIA0KICAgIC8vIENhY2hlIGNhbnZhcyByZWN0IGZvciBwZXJmb3JtYW5jZSAoc2NhbGVkKQ0KICAgIGZsb3dFZGl0b3IuY2FudmFzUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/IA0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGZsb3dFZGl0b3IuY2FudmFzKSA6IA0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCn0NCg0KLy8gU2VsZWN0IGEgbm9kZQ0KZnVuY3Rpb24gc2VsZWN0Tm9kZShub2RlSWQpIHsNCiAgICAvLyBSZW1vdmUgcHJldmlvdXMgc2VsZWN0aW9uDQogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZsb3ctbm9kZS5zZWxlY3RlZCcpLmZvckVhY2gobm9kZSA9PiB7DQogICAgICAgIG5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTsNCiAgICB9KTsNCiAgICANCiAgICAvLyBTZWxlY3QgbmV3IG5vZGUNCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7DQogICAgICAgIGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlID0gbm9kZUlkOw0KICAgICAgICBzaG93Tm9kZUNvbmZpZyhub2RlSWQpOw0KICAgIH0NCn0NCg0KDQovLyBTdGFydCBhIGNvbm5lY3Rpb24gZnJvbSBhIHBvcnQNCmZ1bmN0aW9uIHN0YXJ0Q29ubmVjdGlvbihub2RlSWQsIHBvcnROYW1lLCBpc091dHB1dCkgew0KICAgIGlmIChpc091dHB1dCkgew0KICAgICAgICAvLyBTdGFydGluZyBmcm9tIG91dHB1dCBwb3J0DQogICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20gPSB7DQogICAgICAgICAgICBub2RlSWQ6IG5vZGVJZCwNCiAgICAgICAgICAgIHBvcnROYW1lOiBwb3J0TmFtZSwNCiAgICAgICAgICAgIGlzT3V0cHV0OiB0cnVlDQogICAgICAgIH07DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gU3RhcnRpbmcgZnJvbSBpbnB1dCBwb3J0IC0gY2hlY2sgaWYgd2UgaGF2ZSBhIHBlbmRpbmcgY29ubmVjdGlvbg0KICAgICAgICBpZiAoZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbSAmJiBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tLmlzT3V0cHV0KSB7DQogICAgICAgICAgICAvLyBDb21wbGV0ZSB0aGUgY29ubmVjdGlvbg0KICAgICAgICAgICAgY29uc3QgZnJvbU5vZGVJZCA9IGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20ubm9kZUlkOw0KICAgICAgICAgICAgY29uc3QgZnJvbVBvcnQgPSBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tLnBvcnROYW1lOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjcmVhdGVDb25uZWN0aW9uKGZyb21Ob2RlSWQsIGZyb21Qb3J0LCBub2RlSWQsIHBvcnROYW1lKTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20gPSBudWxsOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBVcGRhdGUgY29ubmVjdGlvbnMgZm9yIGEgc3BlY2lmaWMgbm9kZQ0KZnVuY3Rpb24gdXBkYXRlQ29ubmVjdGlvbnNGb3JOb2RlKG5vZGVJZCkgew0KICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBub2RlSWQgfHwgY29ubmVjdGlvbi50by5ub2RlSWQgPT09IG5vZGVJZCkgew0KICAgICAgICAgICAgdXBkYXRlQ29ubmVjdGlvbihjb25uZWN0aW9uKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gVXBkYXRlIGEgc2luZ2xlIGNvbm5lY3Rpb24NCmZ1bmN0aW9uIHVwZGF0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbikgew0KICAgIGNvbnN0IGZyb21Ob2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCk7DQogICAgY29uc3QgdG9Ob2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgIA0KICAgIGlmICghZnJvbU5vZGUgfHwgIXRvTm9kZSB8fCAhY29ubmVjdGlvbi5zdmcpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBHZXQgbm9kZSBkYXRhIHBvc2l0aW9ucw0KICAgIGNvbnN0IGZyb21Ob2RlRGF0YSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQpOw0KICAgIGNvbnN0IHRvTm9kZURhdGEgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgDQogICAgaWYgKCFmcm9tTm9kZURhdGEgfHwgIXRvTm9kZURhdGEpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBHZXQgYWN0dWFsIG5vZGUgZGltZW5zaW9ucyBmcm9tIGNvbXB1dGVkIHN0eWxlcw0KICAgIGNvbnN0IGZyb21TdHlsZXMgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShmcm9tTm9kZSk7DQogICAgY29uc3QgdG9TdHlsZXMgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0b05vZGUpOw0KICAgIA0KICAgIGNvbnN0IGZyb21XaWR0aCA9IHBhcnNlRmxvYXQoZnJvbVN0eWxlcy53aWR0aCkgfHwgMjAwOw0KICAgIGNvbnN0IGZyb21IZWlnaHQgPSBwYXJzZUZsb2F0KGZyb21TdHlsZXMuaGVpZ2h0KSB8fCA4MDsNCiAgICBjb25zdCB0b1dpZHRoID0gcGFyc2VGbG9hdCh0b1N0eWxlcy53aWR0aCkgfHwgMjAwOw0KICAgIGNvbnN0IHRvSGVpZ2h0ID0gcGFyc2VGbG9hdCh0b1N0eWxlcy5oZWlnaHQpIHx8IDgwOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBjb25uZWN0aW9uIHBvc2l0aW9ucyBkaXJlY3RseSBmcm9tIG5vZGUgZGF0YSAobm8gZXh0cmEgdHJhbnNmb3JtcykNCiAgICAvLyBGcm9tIG91dHB1dCBwb3J0IChyaWdodCBzaWRlIG9mIGZyb20gbm9kZSwgbWlkZGxlIHZlcnRpY2FsbHkpDQogICAgY29uc3QgZnJvbVggPSBmcm9tTm9kZURhdGEueCArIGZyb21XaWR0aDsNCiAgICBjb25zdCBmcm9tWSA9IGZyb21Ob2RlRGF0YS55ICsgZnJvbUhlaWdodCAvIDI7DQogICAgDQogICAgLy8gVG8gaW5wdXQgcG9ydCAobGVmdCBzaWRlIG9mIHRvIG5vZGUsIG1pZGRsZSB2ZXJ0aWNhbGx5KSAgDQogICAgY29uc3QgdG9YID0gdG9Ob2RlRGF0YS54Ow0KICAgIGNvbnN0IHRvWSA9IHRvTm9kZURhdGEueSArIHRvSGVpZ2h0IC8gMjsNCiAgICANCiAgICANCiAgICAvLyBVcGRhdGUgdGhlIHBhdGgNCiAgICBjb25zdCBwYXRoID0gY29ubmVjdGlvbi5zdmcucXVlcnlTZWxlY3RvcigncGF0aCcpOw0KICAgIGlmIChwYXRoKSB7DQogICAgICAgIGNvbnN0IGNvbnRyb2xQb2ludDFYID0gZnJvbVggKyAodG9YIC0gZnJvbVgpICogMC41Ow0KICAgICAgICBjb25zdCBjb250cm9sUG9pbnQyWCA9IGZyb21YICsgKHRvWCAtIGZyb21YKSAqIDAuNTsNCiAgICAgICAgY29uc3QgcGF0aEQgPSBgTSAke2Zyb21YfSAke2Zyb21ZfSBDICR7Y29udHJvbFBvaW50MVh9ICR7ZnJvbVl9ICR7Y29udHJvbFBvaW50Mlh9ICR7dG9ZfSAke3RvWH0gJHt0b1l9YDsNCiAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ2QnLCBwYXRoRCk7DQogICAgfSBlbHNlIHsNCiAgICB9DQp9DQoNCi8vIFJlZHJhdyBhbGwgY29ubmVjdGlvbnMgKGZvciB3aW5kb3cgcmVzaXplLCBldGMuKQ0KZnVuY3Rpb24gcmVkcmF3QWxsQ29ubmVjdGlvbnMoKSB7DQogICAgLy8gUHJldmVudCBvdmVyd2hlbG1pbmcgdGhlIHN5c3RlbSB3aXRoIHRvbyBtYW55IHJlZHJhd3MNCiAgICBpZiAoZmxvd0VkaXRvci5yZWRyYXdJblByb2dyZXNzKSByZXR1cm47DQogICAgZmxvd0VkaXRvci5yZWRyYXdJblByb2dyZXNzID0gdHJ1ZTsNCiAgICANCiAgICAvLyBVc2UgcmVxdWVzdEFuaW1hdGlvbkZyYW1lIGZvciBzbW9vdGggcmVkcmF3aW5nDQogICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHsNCiAgICAgICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgICAgIHVwZGF0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbik7DQogICAgICAgIH0NCiAgICAgICAgZmxvd0VkaXRvci5yZWRyYXdJblByb2dyZXNzID0gZmFsc2U7DQogICAgfSk7DQp9DQoNCi8vIERlbGV0ZSBhIG5vZGUgYW5kIGFsbCBpdHMgY29ubmVjdGlvbnMNCmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZU5vZGUobm9kZUlkKSB7DQogICAgY29uc3QgY29uZmlybWVkID0gYXdhaXQgc3lwbmV4QVBJLnNob3dDb25maXJtYXRpb24oDQogICAgICAgICdEZWxldGUgTm9kZScsDQogICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgbm9kZT8nLA0KICAgICAgICB7DQogICAgICAgICAgICB0eXBlOiAnZGFuZ2VyJywNCiAgICAgICAgICAgIGNvbmZpcm1UZXh0OiAnRGVsZXRlJywNCiAgICAgICAgICAgIGNhbmNlbFRleHQ6ICdDYW5jZWwnLA0KICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS1jdWJlJw0KICAgICAgICB9DQogICAgKTsNCiAgICANCiAgICBpZiAoY29uZmlybWVkKSB7DQogICAgICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYW4gdXAgYXVkaW8gZWxlbWVudHMgaWYgdGhpcyBpcyBhbiBhdWRpbyBub2RlDQogICAgICAgIGlmIChub2RlICYmIG5vZGUudHlwZSA9PT0gJ2F1ZGlvJyAmJiBub2RlLmF1ZGlvRWxlbWVudCkgew0KICAgICAgICAgICAgLy8gUGF1c2UgYW5kIHN0b3AgdGhlIGF1ZGlvDQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5wYXVzZSgpOw0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuY3VycmVudFRpbWUgPSAwOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBSZW1vdmUgZXZlbnQgbGlzdGVuZXJzIHByb3Blcmx5DQogICAgICAgICAgICBpZiAobm9kZS5hdWRpb0V2ZW50TGlzdGVuZXJzKSB7DQogICAgICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZW5kZWQnLCBub2RlLmF1ZGlvRXZlbnRMaXN0ZW5lcnMuZW5kZWQpOw0KICAgICAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgbm9kZS5hdWRpb0V2ZW50TGlzdGVuZXJzLmVycm9yKTsNCiAgICAgICAgICAgICAgICBub2RlLmF1ZGlvRXZlbnRMaXN0ZW5lcnMgPSBudWxsOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBTdG9yZSB0aGUgc3JjIGJlZm9yZSBjbGVhcmluZyBpdCBmb3IgY2xlYW51cA0KICAgICAgICAgICAgY29uc3QgYXVkaW9TcmMgPSBub2RlLmF1ZGlvRWxlbWVudC5zcmM7DQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zcmMgPSAnJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUmV2b2tlIGJsb2IgVVJMIGlmIGl0IGV4aXN0cw0KICAgICAgICAgICAgaWYgKGF1ZGlvU3JjICYmIGF1ZGlvU3JjLnN0YXJ0c1dpdGgoJ2Jsb2I6JykpIHsNCiAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKGF1ZGlvU3JjKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIGF1ZGlvIGVsZW1lbnQgcmVmZXJlbmNlDQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudCA9IG51bGw7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFJlbW92ZSBhbGwgY29ubmVjdGlvbnMgaW52b2x2aW5nIHRoaXMgbm9kZQ0KICAgICAgICBjb25zdCBjb25uZWN0aW9uc1RvRGVsZXRlID0gW107DQogICAgICAgIGZvciAoY29uc3QgW2Nvbm5lY3Rpb25JZCwgY29ubmVjdGlvbl0gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5lbnRyaWVzKCkpIHsNCiAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBub2RlSWQgfHwgY29ubmVjdGlvbi50by5ub2RlSWQgPT09IG5vZGVJZCkgew0KICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25zVG9EZWxldGUucHVzaChjb25uZWN0aW9uSWQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBEZWxldGUgY29ubmVjdGlvbnMNCiAgICAgICAgZm9yIChjb25zdCBjb25uZWN0aW9uSWQgb2YgY29ubmVjdGlvbnNUb0RlbGV0ZSkgew0KICAgICAgICAgICAgZGVsZXRlQ29ubmVjdGlvbihjb25uZWN0aW9uSWQpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBSZW1vdmUgbm9kZSBmcm9tIGRhdGEgc3RydWN0dXJlDQogICAgICAgIGZsb3dFZGl0b3Iubm9kZXMuZGVsZXRlKG5vZGVJZCk7DQogICAgICAgIA0KICAgICAgICAvLyBSZW1vdmUgbm9kZSBlbGVtZW50IGZyb20gRE9NDQogICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICBub2RlRWxlbWVudC5yZW1vdmUoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gRGVzZWxlY3QgaWYgdGhpcyB3YXMgdGhlIHNlbGVjdGVkIG5vZGUNCiAgICAgICAgaWYgKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlID09PSBub2RlSWQpIHsNCiAgICAgICAgICAgIGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlID0gbnVsbDsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlLWNvbmZpZycpLmlubmVySFRNTCA9ICc8cCBjbGFzcz0idGV4dC1tdXRlZCI+U2VsZWN0IGEgbm9kZSB0byBjb25maWd1cmUgaXQ8L3A+JzsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICB9DQp9DQoNCi8vIERlbGV0ZSBhIGNvbm5lY3Rpb24NCmZ1bmN0aW9uIGRlbGV0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbklkKSB7DQogICAgY29uc3QgY29ubmVjdGlvbiA9IGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuZ2V0KGNvbm5lY3Rpb25JZCk7DQogICAgaWYgKGNvbm5lY3Rpb24gJiYgY29ubmVjdGlvbi5zdmcpIHsNCiAgICAgICAgY29ubmVjdGlvbi5zdmcucmVtb3ZlKCk7DQogICAgfQ0KICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuZGVsZXRlKGNvbm5lY3Rpb25JZCk7DQp9DQoNCi8vIERlbGV0ZSBzZWxlY3RlZCBub2RlDQphc3luYyBmdW5jdGlvbiBkZWxldGVTZWxlY3RlZE5vZGUoKSB7DQogICAgaWYgKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlKSB7DQogICAgICAgIGF3YWl0IGRlbGV0ZU5vZGUoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpOw0KICAgIH0NCn0NCg0KLy8gSGFuZGxlIGtleWJvYXJkIHNob3J0Y3V0cw0KZnVuY3Rpb24gaGFuZGxlS2V5RG93bihlKSB7DQogICAgaWYgKGUua2V5ID09PSAnRGVsZXRlJyB8fCAoZS5rZXkgPT09ICdCYWNrc3BhY2UnICYmIGUuY3RybEtleSkpIHsNCiAgICAgICAgaWYgKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlKSB7DQogICAgICAgICAgICBkZWxldGVTZWxlY3RlZE5vZGUoKTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7DQogICAgICAgIC8vIERlc2VsZWN0IG5vZGUNCiAgICAgICAgaWYgKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlKSB7DQogICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlKTsNCiAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlID0gbnVsbDsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlLWNvbmZpZycpLmlubmVySFRNTCA9ICc8cCBjbGFzcz0idGV4dC1tdXRlZCI+U2VsZWN0IGEgbm9kZSB0byBjb25maWd1cmUgaXQ8L3A+JzsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5ID09PSAncycgJiYgIWUuc2hpZnRLZXkpIHsNCiAgICAgICAgLy8gQ3RybC9DbWQgKyBTOiBTYXZlDQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgd2luZG93LmZpbGVNYW5hZ2VyLnNhdmVGbG93KCk7DQogICAgfSBlbHNlIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLmtleSA9PT0gJ1MnKSB7DQogICAgICAgIC8vIEN0cmwvQ21kICsgU2hpZnQgKyBTOiBTYXZlIEFzDQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgd2luZG93LmZpbGVNYW5hZ2VyLnNhdmVGbG93QXMoKTsNCiAgICB9IGVsc2UgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJ28nKSB7DQogICAgICAgIC8vIEN0cmwvQ21kICsgTzogTG9hZA0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHdpbmRvdy5maWxlTWFuYWdlci5sb2FkRmxvdygpOw0KICAgIH0gZWxzZSBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5ID09PSAnPScpIHsNCiAgICAgICAgLy8gQ3RybC9DbWQgKyA9OiBab29tIEluDQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgd2luZG93LmNhbnZhc01hbmFnZXIuem9vbUluKCk7DQogICAgfSBlbHNlIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkgPT09ICctJykgew0KICAgICAgICAvLyBDdHJsL0NtZCArIC06IFpvb20gT3V0DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgd2luZG93LmNhbnZhc01hbmFnZXIuem9vbU91dCgpOw0KICAgIH0gZWxzZSBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5ID09PSAnMCcpIHsNCiAgICAgICAgLy8gQ3RybC9DbWQgKyAwOiBSZXNldCB6b29tIGFuZCBwYW4NCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICB3aW5kb3cuY2FudmFzTWFuYWdlci5yZXNldENhbnZhc1BhbigpOw0KICAgIH0gZWxzZSBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIChlLnNoaWZ0S2V5KSAmJiBlLmtleSA9PT0gJ0YnKSB7DQogICAgICAgIC8vIEN0cmwvQ21kICsgU2hpZnQgKyBGOiBab29tIHRvIGZpdA0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnpvb21Ub0ZpdCgpOw0KICAgIH0NCn0NCg0KLy8gSGFuZGxlIHBvcnQgbW91c2UgZXZlbnRzIGZvciBjb25uZWN0aW9ucw0KZnVuY3Rpb24gaGFuZGxlUG9ydE1vdXNlRG93bihlLCBub2RlSWQsIHBvcnROYW1lLCBpc091dHB1dCkgew0KICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgIA0KICAgIGlmIChpc091dHB1dCkgew0KICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tID0geyBub2RlSWQsIHBvcnROYW1lIH07DQogICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2Nvbm5lY3RpbmcnKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBpZiAoZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbSkgew0KICAgICAgICAgICAgY3JlYXRlQ29ubmVjdGlvbihmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tLm5vZGVJZCwgZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbS5wb3J0TmFtZSwgbm9kZUlkLCBwb3J0TmFtZSk7DQogICAgICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tID0gbnVsbDsNCiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mbG93LW5vZGUtcG9ydCcpLmZvckVhY2gocG9ydCA9PiBwb3J0LmNsYXNzTGlzdC5yZW1vdmUoJ2Nvbm5lY3RpbmcnKSk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIENyZWF0ZSBhIGNvbm5lY3Rpb24gYmV0d2VlbiBub2Rlcw0KZnVuY3Rpb24gY3JlYXRlQ29ubmVjdGlvbihmcm9tTm9kZUlkLCBmcm9tUG9ydCwgdG9Ob2RlSWQsIHRvUG9ydCkgew0KICAgIC8vIENoZWNrIGlmIGNvbm5lY3Rpb24gYWxyZWFkeSBleGlzdHMNCiAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gZnJvbU5vZGVJZCAmJiANCiAgICAgICAgICAgIGNvbm5lY3Rpb24uZnJvbS5wb3J0TmFtZSA9PT0gZnJvbVBvcnQgJiYNCiAgICAgICAgICAgIGNvbm5lY3Rpb24udG8ubm9kZUlkID09PSB0b05vZGVJZCAmJiANCiAgICAgICAgICAgIGNvbm5lY3Rpb24udG8ucG9ydE5hbWUgPT09IHRvUG9ydCkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGNvbm5lY3Rpb25JZCA9IGBjb25uXyR7ZnJvbU5vZGVJZH1fJHtmcm9tUG9ydH1fJHt0b05vZGVJZH1fJHt0b1BvcnR9YDsNCiAgICBjb25zdCBjb25uZWN0aW9uID0gew0KICAgICAgICBpZDogY29ubmVjdGlvbklkLA0KICAgICAgICBmcm9tOiB7IG5vZGVJZDogZnJvbU5vZGVJZCwgcG9ydE5hbWU6IGZyb21Qb3J0IH0sDQogICAgICAgIHRvOiB7IG5vZGVJZDogdG9Ob2RlSWQsIHBvcnROYW1lOiB0b1BvcnQgfQ0KICAgIH07DQogICAgDQogICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5zZXQoY29ubmVjdGlvbklkLCBjb25uZWN0aW9uKTsNCiAgICBkcmF3Q29ubmVjdGlvbihjb25uZWN0aW9uKTsNCiAgICANCn0NCg0KLy8gRHJhdyBhIGNvbm5lY3Rpb24gb24gdGhlIGNhbnZhcw0KZnVuY3Rpb24gZHJhd0Nvbm5lY3Rpb24oY29ubmVjdGlvbikgew0KICAgIGNvbnN0IGZyb21Ob2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCk7DQogICAgY29uc3QgdG9Ob2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgIA0KICAgIGlmICghZnJvbU5vZGUgfHwgIXRvTm9kZSkgcmV0dXJuOw0KICAgIA0KICAgIC8vIENyZWF0ZSBTVkcgZWxlbWVudCBmb3IgdGhlIGNvbm5lY3Rpb24NCiAgICBjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpOw0KICAgIHN2Zy5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7DQogICAgc3ZnLnN0eWxlLnRvcCA9ICcwJzsNCiAgICBzdmcuc3R5bGUubGVmdCA9ICcwJzsNCiAgICBzdmcuc3R5bGUud2lkdGggPSAnMTAwJSc7DQogICAgc3ZnLnN0eWxlLmhlaWdodCA9ICcxMDAlJzsNCiAgICBzdmcuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJzsgLy8gRG9uJ3QgY2FwdHVyZSBldmVudHMgYnkgZGVmYXVsdA0KICAgIHN2Zy5zdHlsZS56SW5kZXggPSAnMSc7DQogICAgc3ZnLmRhdGFzZXQuY29ubmVjdGlvbklkID0gY29ubmVjdGlvbi5pZDsNCiAgICANCiAgICBjb25zdCBwYXRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwYXRoJyk7DQogICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICcjNENBRjUwJyk7DQogICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7DQogICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnbm9uZScpOw0KICAgIHBhdGguc2V0QXR0cmlidXRlKCdtYXJrZXItZW5kJywgJ3VybCgjYXJyb3doZWFkKScpOw0KICAgIHBhdGguc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInOw0KICAgIHBhdGguc3R5bGUucG9pbnRlckV2ZW50cyA9ICdhdXRvJzsgLy8gT25seSB0aGUgcGF0aCBjYXB0dXJlcyBldmVudHMNCiAgICANCiAgICAvLyBBZGQgaG92ZXIgZWZmZWN0cw0KICAgIHBhdGguYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHsNCiAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICc0Jyk7DQogICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCdzdHJva2UnLCAnI2ZmNmI2YicpOw0KICAgICAgICAvLyBTaG93IGRlbGV0ZSB0b29sdGlwDQogICAgICAgIHNob3dDb25uZWN0aW9uVG9vbHRpcChjb25uZWN0aW9uLmlkLCAnQ2xpY2sgdG8gZGVsZXRlIGNvbm5lY3Rpb24nKTsNCiAgICB9KTsNCiAgICANCiAgICBwYXRoLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7DQogICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMicpOw0KICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJyM0Q0FGNTAnKTsNCiAgICAgICAgaGlkZUNvbm5lY3Rpb25Ub29sdGlwKCk7DQogICAgfSk7DQogICAgDQogICAgLy8gQWRkIGNsaWNrIHRvIGRlbGV0ZQ0KICAgIHBhdGguYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZSkgPT4gew0KICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICBjb25zdCBjb25maXJtZWQgPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0NvbmZpcm1hdGlvbigNCiAgICAgICAgICAgICdEZWxldGUgQ29ubmVjdGlvbicsDQogICAgICAgICAgICAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIGNvbm5lY3Rpb24/JywNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0eXBlOiAnZGFuZ2VyJywNCiAgICAgICAgICAgICAgICBjb25maXJtVGV4dDogJ0RlbGV0ZScsDQogICAgICAgICAgICAgICAgY2FuY2VsVGV4dDogJ0NhbmNlbCcsDQogICAgICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS1saW5rJw0KICAgICAgICAgICAgfQ0KICAgICAgICApOw0KICAgICAgICANCiAgICAgICAgaWYgKGNvbmZpcm1lZCkgew0KICAgICAgICAgICAgZGVsZXRlQ29ubmVjdGlvbihjb25uZWN0aW9uLmlkKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIHN2Zy5hcHBlbmRDaGlsZChwYXRoKTsNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5hcHBlbmRDaGlsZChzdmcpOw0KICAgIA0KICAgIC8vIFN0b3JlIFNWRyByZWZlcmVuY2UNCiAgICBjb25uZWN0aW9uLnN2ZyA9IHN2ZzsNCiAgICANCiAgICAvLyBVcGRhdGUgY29ubmVjdGlvbiBwb3NpdGlvbg0KICAgIHVwZGF0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbik7DQp9DQoNCi8vIFNob3cgY29ubmVjdGlvbiB0b29sdGlwDQpmdW5jdGlvbiBzaG93Q29ubmVjdGlvblRvb2x0aXAoY29ubmVjdGlvbklkLCBtZXNzYWdlKSB7DQogICAgLy8gQ2hlY2sgaWYgYXBwIGlzIHN0aWxsIGFjdGl2ZQ0KICAgIGlmICghZmxvd0VkaXRvci5pc0FjdGl2ZSkgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIFJlbW92ZSBleGlzdGluZyB0b29sdGlwDQogICAgaGlkZUNvbm5lY3Rpb25Ub29sdGlwKCk7DQogICAgDQogICAgY29uc3QgdG9vbHRpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIHRvb2x0aXAuY2xhc3NOYW1lID0gJ2Nvbm5lY3Rpb24tdG9vbHRpcCc7DQogICAgdG9vbHRpcC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7DQogICAgdG9vbHRpcC5zdHlsZS5jc3NUZXh0ID0gYA0KICAgICAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC44KTsNCiAgICAgICAgY29sb3I6IHdoaXRlOw0KICAgICAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7DQogICAgICAgIHotaW5kZXg6IDEwMDAwOw0KICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOw0KICAgICAgICBkaXNwbGF5OiBub25lOw0KICAgIGA7DQogICAgDQogICAgdG9vbHRpcC5pZCA9ICdjb25uZWN0aW9uLXRvb2x0aXAnOw0KICAgIA0KICAgIC8vIFRyeSB0byBhcHBlbmQgdG8gYXBwIGNvbnRhaW5lciBmaXJzdCwgZmFsbGJhY2sgdG8gYm9keQ0KICAgIGNvbnN0IGFwcENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcHAtY29udGFpbmVyJyk7DQogICAgY29uc3QgY29udGFpbmVyID0gYXBwQ29udGFpbmVyIHx8IGRvY3VtZW50LmJvZHk7DQogICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRvb2x0aXApOw0KICAgIA0KICAgIC8vIFBvc2l0aW9uIHRvb2x0aXAgbmVhciBtb3VzZSAod2lsbCBiZSB1cGRhdGVkIG9uIG1vdXNlbW92ZSkNCiAgICBjb25zdCB0b29sdGlwTW91c2VNb3ZlSGFuZGxlciA9IChlKSA9PiB1cGRhdGVUb29sdGlwUG9zaXRpb24oZSk7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdG9vbHRpcE1vdXNlTW92ZUhhbmRsZXIpOw0KICAgIA0KICAgIC8vIFN0b3JlIHRoZSBoYW5kbGVyIHJlZmVyZW5jZSBmb3IgY2xlYW51cA0KICAgIHdpbmRvdy5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIgPSB0b29sdGlwTW91c2VNb3ZlSGFuZGxlcjsNCiAgICANCiAgICAvLyBTaG93IHRoZSB0b29sdGlwIGFmdGVyIGEgc21hbGwgZGVsYXkgdG8gcHJldmVudCBmbGlja2VyaW5nDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGlmICh0b29sdGlwLnBhcmVudE5vZGUgJiYgZmxvd0VkaXRvci5pc0FjdGl2ZSkgew0KICAgICAgICAgICAgdG9vbHRpcC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgfQ0KICAgIH0sIDEwKTsNCn0NCg0KLy8gVXBkYXRlIHRvb2x0aXAgcG9zaXRpb24NCmZ1bmN0aW9uIHVwZGF0ZVRvb2x0aXBQb3NpdGlvbihlKSB7DQogICAgY29uc3QgdG9vbHRpcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25uZWN0aW9uLXRvb2x0aXAnKTsNCiAgICBpZiAodG9vbHRpcCkgew0KICAgICAgICAvLyBVc2Ugc2NhbGVkIGNvb3JkaW5hdGVzIGZvciB0b29sdGlwIHBvc2l0aW9uaW5nDQogICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPyANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6IA0KICAgICAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgICAgICB0b29sdGlwLnN0eWxlLmxlZnQgPSAobW91c2VDb29yZHMueCArIDEwKSArICdweCc7DQogICAgICAgIHRvb2x0aXAuc3R5bGUudG9wID0gKG1vdXNlQ29vcmRzLnkgLSAxMCkgKyAncHgnOw0KICAgIH0NCn0NCg0KLy8gSGlkZSBjb25uZWN0aW9uIHRvb2x0aXANCmZ1bmN0aW9uIGhpZGVDb25uZWN0aW9uVG9vbHRpcCgpIHsNCiAgICBjb25zdCB0b29sdGlwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nvbm5lY3Rpb24tdG9vbHRpcCcpOw0KICAgIGlmICh0b29sdGlwKSB7DQogICAgICAgIC8vIFJlbW92ZSB0aGUgc3BlY2lmaWMgZXZlbnQgbGlzdGVuZXIgd2UgYWRkZWQNCiAgICAgICAgaWYgKHdpbmRvdy5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIpIHsNCiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHdpbmRvdy5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIpOw0KICAgICAgICAgICAgd2luZG93LmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlciA9IG51bGw7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEhpZGUgYW5kIHJlbW92ZSB0aGUgdG9vbHRpcA0KICAgICAgICB0b29sdGlwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIGlmICh0b29sdGlwLnBhcmVudE5vZGUpIHsNCiAgICAgICAgICAgIHRvb2x0aXAucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0b29sdGlwKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gQ2xlYXIgdGhlIGNhbnZhcw0KYXN5bmMgZnVuY3Rpb24gY2xlYXJDYW52YXMoKSB7DQogICAgY29uc3QgY29uZmlybWVkID0gYXdhaXQgc3lwbmV4QVBJLnNob3dDb25maXJtYXRpb24oDQogICAgICAgICdDbGVhciBDYW52YXMnLA0KICAgICAgICAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNsZWFyIHRoZSBjYW52YXM/IFRoaXMgd2lsbCBkZWxldGUgYWxsIG5vZGVzIGFuZCBjb25uZWN0aW9ucy4nLA0KICAgICAgICB7DQogICAgICAgICAgICB0eXBlOiAnZGFuZ2VyJywNCiAgICAgICAgICAgIGNvbmZpcm1UZXh0OiAnQ2xlYXIgQWxsJywNCiAgICAgICAgICAgIGNhbmNlbFRleHQ6ICdDYW5jZWwnLA0KICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS10cmFzaC1hbHQnDQogICAgICAgIH0NCiAgICApOw0KICAgIA0KICAgIGlmIChjb25maXJtZWQpIHsNCiAgICAgICAgY2xlYXJDYW52YXNTaWxlbnQoKTsNCiAgICB9DQp9DQoNCi8vIENsZWFyIHRoZSBjYW52YXMgd2l0aG91dCBjb25maXJtYXRpb24gKHVzZWQgaW50ZXJuYWxseSkNCmZ1bmN0aW9uIGNsZWFyQ2FudmFzU2lsZW50KCkgew0KICAgIC8vIEhpZGUgYW55IGFjdGl2ZSB0b29sdGlwcw0KICAgIGhpZGVDb25uZWN0aW9uVG9vbHRpcCgpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgYWxsIGNvbm5lY3Rpb25zDQogICAgICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5zdmcpIHsNCiAgICAgICAgICAgICAgICBjb25uZWN0aW9uLnN2Zy5yZW1vdmUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmNsZWFyKCk7DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciBhbGwgbm9kZXMNCiAgICAgICAgZm9yIChjb25zdCBub2RlSWQgb2YgZmxvd0VkaXRvci5ub2Rlcy5rZXlzKCkpIHsNCiAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LnJlbW92ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGZsb3dFZGl0b3Iubm9kZXMuY2xlYXIoKTsNCiAgICAgICAgDQogICAgICAgIC8vIENsZWFyIGFsbCB0YWdzDQogICAgICAgIGZvciAoY29uc3QgdGFnSWQgb2YgZmxvd0VkaXRvci50YWdzLmtleXMoKSkgew0KICAgICAgICAgICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhZ0lkKTsNCiAgICAgICAgICAgIGlmICh0YWdFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgdGFnRWxlbWVudC5yZW1vdmUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBmbG93RWRpdG9yLnRhZ3MuY2xlYXIoKTsNCiAgICAgICAgDQogICAgICAgIC8vIFVwZGF0ZSB0YWcgcGFuZWwgdG8gcmVmbGVjdCBjbGVhcmVkIHRhZ3MNCiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cudGFnTWFuYWdlci51cGRhdGVUYWdQYW5lbCA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgd2luZG93LnRhZ01hbmFnZXIudXBkYXRlVGFnUGFuZWwoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gUmVzZXQgY291bnRlcnMNCiAgICAgICAgZmxvd0VkaXRvci5ub2RlQ291bnRlciA9IDA7DQogICAgICAgIGZsb3dFZGl0b3IudGFnQ291bnRlciA9IDA7DQogICAgICAgIGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlID0gbnVsbDsNCiAgICAgICAgDQogICAgICAgIC8vIENsZWFyIGN1cnJlbnQgZmlsZSBwYXRoDQogICAgICAgIGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoID0gbnVsbDsNCiAgICAgICAgDQogICAgICAgIC8vIFJlc2V0IHBhbiBvZmZzZXQgdG8gY2VudGVyIG9mIGxhcmdlIGNhbnZhcw0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldCA9IHsgeDogLTUwMDAsIHk6IC01MDAwIH07DQogICAgICAgIA0KICAgICAgICAvLyBSZXNldCB6b29tIGxldmVsDQogICAgICAgIGZsb3dFZGl0b3Iuem9vbUxldmVsID0gMS4wOw0KICAgICAgICANCiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0gPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBVcGRhdGUgZmlsZW5hbWUgZGlzcGxheQ0KICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy5maWxlTWFuYWdlci51cGRhdGVGaWxlbmFtZURpc3BsYXkgPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgIHdpbmRvdy5maWxlTWFuYWdlci51cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgY29uZmlnIHBhbmVsDQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlLWNvbmZpZycpLmlubmVySFRNTCA9ICc8cCBjbGFzcz0idGV4dC1tdXRlZCI+U2VsZWN0IGEgbm9kZSB0byBjb25maWd1cmUgaXQ8L3A+JzsNCn0gDQoNCg0KLy8gU2hvdyBub2RlIGNvbmZpZ3VyYXRpb24NCmFzeW5jIGZ1bmN0aW9uIHNob3dOb2RlQ29uZmlnKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSkgcmV0dXJuOw0KICAgIA0KICAgIGNvbnN0IG5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICBpZiAoIW5vZGVEZWYpIHJldHVybjsNCg0KICAgIC8vIExvYWQgc2F2ZWQgY29uZmlndXJhdGlvbiBzZWN0aW9uIHN0YXRlcw0KICAgIGxldCBzZWN0aW9uU3RhdGVzID0ge307DQogICAgdHJ5IHsNCiAgICAgICAgaWYgKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTZXR0aW5nKSB7DQogICAgICAgICAgICAvLyBMb2FkIHN0YXRlcyBmb3IgYWxsIHBvc3NpYmxlIHNlY3Rpb25zDQogICAgICAgICAgICBjb25zdCBzZWN0aW9ucyA9IFsnbm9kZS1jb250ZW50JywgJ2lucHV0LWNvbm5lY3Rpb25zJywgJ291dHB1dC1jb25uZWN0aW9ucycsICdub2RlLXNldHRpbmdzJywgJ291dHB1dC1kYXRhJ107DQogICAgICAgICAgICBmb3IgKGNvbnN0IHNlY3Rpb25JZCBvZiBzZWN0aW9ucykgew0KICAgICAgICAgICAgICAgIC8vIERlZmF1bHQgdG8gZXhwYW5kZWQgZm9yIG5vZGUtY29udGVudCwgY29sbGFwc2VkIGZvciBvdGhlcnMNCiAgICAgICAgICAgICAgICBjb25zdCBkZWZhdWx0RXhwYW5kZWQgPSBzZWN0aW9uSWQgPT09ICdub2RlLWNvbnRlbnQnOw0KICAgICAgICAgICAgICAgIHNlY3Rpb25TdGF0ZXNbc2VjdGlvbklkXSA9IGF3YWl0IHN5cG5leEFQSS5nZXRTZXR0aW5nKGBjb25maWdfc2VjdGlvbl8ke3NlY3Rpb25JZH1gLCBkZWZhdWx0RXhwYW5kZWQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gbG9hZCBjb25maWcgc2VjdGlvbiBzdGF0ZXM6JywgZXJyb3IpOw0KICAgICAgICAvLyBVc2UgZGVmYXVsdHMgaWYgbG9hZGluZyBmYWlscw0KICAgICAgICBzZWN0aW9uU3RhdGVzID0gew0KICAgICAgICAgICAgJ25vZGUtY29udGVudCc6IHRydWUsDQogICAgICAgICAgICAnaW5wdXQtY29ubmVjdGlvbnMnOiBmYWxzZSwNCiAgICAgICAgICAgICdvdXRwdXQtY29ubmVjdGlvbnMnOiBmYWxzZSwNCiAgICAgICAgICAgICdub2RlLXNldHRpbmdzJzogZmFsc2UsDQogICAgICAgICAgICAnb3V0cHV0LWRhdGEnOiBmYWxzZQ0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICAvLyBTaG93IGNvbmZpZyBwYW5lbCB3aXRoIG5vZGUgY29uZmlndXJhdGlvbg0KICAgIGNvbnN0IGNvbmZpZ1BhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUtY29uZmlnJyk7DQogICAgaWYgKGNvbmZpZ1BhbmVsKSB7DQogICAgICAgIGxldCBjb25maWdIdG1sID0gYDxoND4ke25vZGVEZWYubmFtZX0gQ29uZmlndXJhdGlvbjwvaDQ+YDsNCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBzcGVjaWFsIGNvbnRlbnQgZGlzcGxheSBmb3IgZGlmZmVyZW50IG5vZGUgdHlwZXMNCiAgICAgICAgbGV0IGhhc1NwZWNpYWxDb250ZW50ID0gZmFsc2U7DQogICAgICAgIGxldCBzcGVjaWFsQ29udGVudEh0bWwgPSAnJzsNCiAgICAgICAgDQogICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdkaXNwbGF5JyAmJiBub2RlLmxhc3RDb250ZW50KSB7DQogICAgICAgICAgICBoYXNTcGVjaWFsQ29udGVudCA9IHRydWU7DQogICAgICAgICAgICBzcGVjaWFsQ29udGVudEh0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5MYXN0IENvbnRlbnQ8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50LWRpc3BsYXkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHByZSBjbGFzcz0iY29udGVudC10ZXh0Ij4ke2VzY2FwZUh0bWwobm9kZS5sYXN0Q29udGVudCl9PC9wcmU+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50LWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5Gb3JtYXQ6ICR7bm9kZS5sYXN0Rm9ybWF0fSDigKIgTGVuZ3RoOiAke25vZGUubGFzdENvbnRlbnQubGVuZ3RofSBjaGFyczwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9IGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ2ltYWdlJyAmJiBub2RlLmxhc3RJbWFnZURhdGEpIHsNCiAgICAgICAgICAgIGhhc1NwZWNpYWxDb250ZW50ID0gdHJ1ZTsNCiAgICAgICAgICAgIHNwZWNpYWxDb250ZW50SHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkltYWdlIFByZXZpZXc8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbWFnZS1kaXNwbGF5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSIke25vZGUubGFzdEltYWdlVXJsfSIgYWx0PSJJbWFnZSBwcmV2aWV3IiBzdHlsZT0ibWF4LXdpZHRoOiAyMDBweDsgbWF4LWhlaWdodDogMTUwcHg7IGJvcmRlcjogMXB4IHNvbGlkICNjY2M7IGJvcmRlci1yYWRpdXM6IDRweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW1hZ2UtaW5mbyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPlNpemU6ICR7bm9kZS5sYXN0SW1hZ2VJbmZvPy53aWR0aCB8fCAnPyd9eCR7bm9kZS5sYXN0SW1hZ2VJbmZvPy5oZWlnaHQgfHwgJz8nfSDigKIgRm9ybWF0OiAke25vZGUubGFzdEltYWdlSW5mbz8uZm9ybWF0IHx8ICc/J308L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1wcmltYXJ5IG10LTIgdmlldy1mdWxsLWltYWdlLWJ0biIgZGF0YS1ub2RlLWlkPSIke25vZGVJZH0iPlZpZXcgRnVsbCBJbWFnZTwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0gZWxzZSBpZiAobm9kZS50eXBlID09PSAnYXVkaW8nICYmIG5vZGUubGFzdEF1ZGlvRGF0YSkgew0KICAgICAgICAgICAgaGFzU3BlY2lhbENvbnRlbnQgPSB0cnVlOw0KICAgICAgICAgICAgc3BlY2lhbENvbnRlbnRIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+QXVkaW8gQ29udHJvbHM8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhdWRpby1kaXNwbGF5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImF1ZGlvLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5BdWRpbyBsb2FkZWQgc3VjY2Vzc2Z1bGx5PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXVkaW8tY29udHJvbHMgbXQtMiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tc3VjY2VzcyBwbGF5LWF1ZGlvLWJ0biIgZGF0YS1ub2RlLWlkPSIke25vZGVJZH0iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXBsYXkiPjwvaT4gUGxheQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLWRhbmdlciBzdG9wLWF1ZGlvLWJ0biIgZGF0YS1ub2RlLWlkPSIke25vZGVJZH0iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXN0b3AiPjwvaT4gU3RvcA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09ICd2ZnNfbG9hZCcpIHsNCiAgICAgICAgICAgIGhhc1NwZWNpYWxDb250ZW50ID0gdHJ1ZTsNCiAgICAgICAgICAgIHNwZWNpYWxDb250ZW50SHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlZGUyBMb2FkIFN0YXR1czwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InZmcy1sb2FkLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPkxhc3QgbG9hZGVkOiAke25vZGUubGFzdExvYWRlZEZpbGUgfHwgJ05vbmUnfTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09ICdsbG1fY2hhdCcgJiYgbm9kZS5sYXN0UmVzcG9uc2UpIHsNCiAgICAgICAgICAgIGhhc1NwZWNpYWxDb250ZW50ID0gdHJ1ZTsNCiAgICAgICAgICAgIHNwZWNpYWxDb250ZW50SHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkxhc3QgUmVzcG9uc2U8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50LWRpc3BsYXkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHByZSBjbGFzcz0iY29udGVudC10ZXh0Ij4ke2VzY2FwZUh0bWwobm9kZS5sYXN0UmVzcG9uc2UpfTwvcHJlPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udGVudC1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+VG9rZW5zOiAke25vZGUubGFzdFVzYWdlPy50b3RhbF90b2tlbnMgfHwgMH0g4oCiIE1vZGVsOiAke25vZGUubGFzdE1vZGVsIHx8ICdVbmtub3duJ308L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgICAgIGhhc1NwZWNpYWxDb250ZW50ID0gdHJ1ZTsNCiAgICAgICAgICAgIGNvbnN0IGlzUnVubmluZyA9IG5vZGUucmVwZWF0ZXJTdGF0ZSAmJiBub2RlLnJlcGVhdGVyU3RhdGUuaXNSdW5uaW5nOw0KICAgICAgICAgICAgY29uc3QgY291bnQgPSBub2RlLnJlcGVhdGVyU3RhdGUgPyBub2RlLnJlcGVhdGVyU3RhdGUuY291bnQgOiAwOw0KICAgICAgICAgICAgc3BlY2lhbENvbnRlbnRIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+UmVwZWF0ZXIgQ29udHJvbHM8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyZXBlYXRlci1kaXNwbGF5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJlcGVhdGVyLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5TdGF0dXM6ICR7aXNSdW5uaW5nID8gJ1J1bm5pbmcnIDogJ1N0b3BwZWQnfSDigKIgQ291bnQ6ICR7Y291bnR9PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmVwZWF0ZXItY29udHJvbHMgbXQtMiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tc3VjY2VzcyBzdGFydC1yZXBlYXRlci1idG4iIGRhdGEtbm9kZS1pZD0iJHtub2RlSWR9IiAke2lzUnVubmluZyA/ICdkaXNhYmxlZCcgOiAnJ30+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtcGxheSI+PC9pPiBTdGFydA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLWRhbmdlciBzdG9wLXJlcGVhdGVyLWJ0biIgZGF0YS1ub2RlLWlkPSIke25vZGVJZH0iICR7IWlzUnVubmluZyA/ICdkaXNhYmxlZCcgOiAnJ30+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc3RvcCI+PC9pPiBTdG9wDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBXcmFwIHNwZWNpYWwgY29udGVudCBpbiBhIGNvbGxhcHNpYmxlIHNlY3Rpb24gaWYgcHJlc2VudA0KICAgICAgICBpZiAoaGFzU3BlY2lhbENvbnRlbnQpIHsNCiAgICAgICAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSBzZWN0aW9uU3RhdGVzWydub2RlLWNvbnRlbnQnXTsNCiAgICAgICAgICAgIGNvbnN0IGhlYWRlckNsYXNzID0gaXNFeHBhbmRlZCA/ICcnIDogJ2NvbGxhcHNlZCc7DQogICAgICAgICAgICBjb25zdCBpY29uQ2xhc3MgPSBpc0V4cGFuZGVkID8gJ2ZhcyBmYS1jaGV2cm9uLWRvd24nIDogJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRTdHlsZSA9IGlzRXhwYW5kZWQgPyAnJyA6ICcgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Iic7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uIj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24taGVhZGVyICR7aGVhZGVyQ2xhc3N9IiBkYXRhLXNlY3Rpb249Im5vZGUtY29udGVudCI+DQogICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iJHtpY29uQ2xhc3N9Ij48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5Ob2RlIENvbnRlbnQ8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbi1jb250ZW50IiBpZD0ibm9kZS1jb250ZW50LWNvbnRlbnQiJHtjb250ZW50U3R5bGV9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgJHtzcGVjaWFsQ29udGVudEh0bWx9DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gU2hvdyBpbnB1dCBtYXBwaW5ncyBjb25maWd1cmF0aW9uICh3aGF0IHRoaXMgbm9kZSByZWNlaXZlcyBmcm9tIG90aGVyIG5vZGVzKQ0KICAgICAgICBjb25zdCBpbnB1dENvbm5lY3Rpb25zID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKQ0KICAgICAgICAgICAgLmZpbHRlcihjb25uID0+IGNvbm4udG8ubm9kZUlkID09PSBub2RlSWQpOw0KICAgICAgICANCiAgICAgICAgaWYgKGlucHV0Q29ubmVjdGlvbnMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9IHNlY3Rpb25TdGF0ZXNbJ2lucHV0LWNvbm5lY3Rpb25zJ107DQogICAgICAgICAgICBjb25zdCBoZWFkZXJDbGFzcyA9IGlzRXhwYW5kZWQgPyAnJyA6ICdjb2xsYXBzZWQnOw0KICAgICAgICAgICAgY29uc3QgaWNvbkNsYXNzID0gaXNFeHBhbmRlZCA/ICdmYXMgZmEtY2hldnJvbi1kb3duJyA6ICdmYXMgZmEtY2hldnJvbi1yaWdodCc7DQogICAgICAgICAgICBjb25zdCBjb250ZW50U3R5bGUgPSBpc0V4cGFuZGVkID8gJycgOiAnIHN0eWxlPSJkaXNwbGF5OiBub25lOyInOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWhlYWRlciAke2hlYWRlckNsYXNzfSIgZGF0YS1zZWN0aW9uPSJpbnB1dC1jb25uZWN0aW9ucyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iJHtpY29uQ2xhc3N9Ij48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5JbnB1dCBDb25uZWN0aW9uczwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbCBjbGFzcz0iY29uZmlnLWNvdW50Ij4oJHtpbnB1dENvbm5lY3Rpb25zLmxlbmd0aH0pPC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWNvbnRlbnQiIGlkPSJpbnB1dC1jb25uZWN0aW9ucy1jb250ZW50IiR7Y29udGVudFN0eWxlfT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImlucHV0LW1hcHBpbmdzLWNvbmZpZyI+DQogICAgICAgICAgICBgOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm4gb2YgaW5wdXRDb25uZWN0aW9ucykgew0KICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZU5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uLmZyb20ubm9kZUlkKTsNCiAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2VOb2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKHNvdXJjZU5vZGU/LnR5cGUgfHwgJ3Vua25vd24nKTsNCiAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2VOb2RlTmFtZSA9IHNvdXJjZU5vZGVEZWY/Lm5hbWUgfHwgc291cmNlTm9kZT8udHlwZSB8fCAndW5rbm93bic7DQogICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRPdXRwdXQgPSBzb3VyY2VOb2RlRGVmPy5vdXRwdXRzPy5maW5kKG91dHB1dCA9PiBvdXRwdXQuaWQgPT09IGNvbm4uZnJvbS5wb3J0TmFtZSk7DQogICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0TmFtZSA9IHNlbGVjdGVkT3V0cHV0ID8gc2VsZWN0ZWRPdXRwdXQubmFtZSA6IGNvbm4uZnJvbS5wb3J0TmFtZTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBTaW1wbGU6IFNob3cgd2hhdCBJJ20gcmVjZWl2aW5nIGFuZCBsZXQgbWUgY2hvb3NlIG15IGlucHV0IHBvcnQNCiAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5wdXQtbWFwcGluZy1jb25maWciPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29ubmVjdGlvbi1oZWFkZXIiPkZyb20gJHtzb3VyY2VOb2RlTmFtZX0gKCR7b3V0cHV0TmFtZX0pPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25uZWN0aW9uLWNvbnRyb2xzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250cm9sLXJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5UbyBteSBpbnB1dDo8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPSJpbnB1dF90YXJnZXRfJHtub2RlSWR9fCR7Y29ubi50by5wb3J0TmFtZX0iIGNsYXNzPSJpbnB1dC10YXJnZXQtc2VsZWN0Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IiI+U2VsZWN0Li4uPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke25vZGVEZWYuaW5wdXRzLm1hcChpbnB1dCA9PiANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgPG9wdGlvbiB2YWx1ZT0iJHtpbnB1dC5pZH0iICR7Y29ubi50by5wb3J0TmFtZSA9PT0gaW5wdXQuaWQgPyAnc2VsZWN0ZWQnIDogJyd9PiR7aW5wdXQubmFtZX08L29wdGlvbj5gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmpvaW4oJycpfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFNob3cgb3V0cHV0IG1hcHBpbmdzIGNvbmZpZ3VyYXRpb24gKHdoYXQgb3RoZXIgbm9kZXMgcmVjZWl2ZSBmcm9tIHRoaXMgbm9kZSkNCiAgICAgICAgY29uc3Qgb3V0cHV0Q29ubmVjdGlvbnMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpDQogICAgICAgICAgICAuZmlsdGVyKGNvbm4gPT4gY29ubi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkKTsNCiAgICAgICAgDQogICAgICAgIGlmIChvdXRwdXRDb25uZWN0aW9ucy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gc2VjdGlvblN0YXRlc1snb3V0cHV0LWNvbm5lY3Rpb25zJ107DQogICAgICAgICAgICBjb25zdCBoZWFkZXJDbGFzcyA9IGlzRXhwYW5kZWQgPyAnJyA6ICdjb2xsYXBzZWQnOw0KICAgICAgICAgICAgY29uc3QgaWNvbkNsYXNzID0gaXNFeHBhbmRlZCA/ICdmYXMgZmEtY2hldnJvbi1kb3duJyA6ICdmYXMgZmEtY2hldnJvbi1yaWdodCc7DQogICAgICAgICAgICBjb25zdCBjb250ZW50U3R5bGUgPSBpc0V4cGFuZGVkID8gJycgOiAnIHN0eWxlPSJkaXNwbGF5OiBub25lOyInOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWhlYWRlciAke2hlYWRlckNsYXNzfSIgZGF0YS1zZWN0aW9uPSJvdXRwdXQtY29ubmVjdGlvbnMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9IiR7aWNvbkNsYXNzfSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+T3V0cHV0IENvbm5lY3Rpb25zPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsIGNsYXNzPSJjb25maWctY291bnQiPigke291dHB1dENvbm5lY3Rpb25zLmxlbmd0aH0pPC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWNvbnRlbnQiIGlkPSJvdXRwdXQtY29ubmVjdGlvbnMtY29udGVudCIke2NvbnRlbnRTdHlsZX0+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJvdXRwdXQtbWFwcGluZ3MtY29uZmlnIj4NCiAgICAgICAgICAgIGA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGZvciAoY29uc3QgY29ubiBvZiBvdXRwdXRDb25uZWN0aW9ucykgew0KICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uLnRvLm5vZGVJZCk7DQogICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Tm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZSh0YXJnZXROb2RlPy50eXBlIHx8ICd1bmtub3duJyk7DQogICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Tm9kZU5hbWUgPSB0YXJnZXROb2RlRGVmPy5uYW1lIHx8IHRhcmdldE5vZGU/LnR5cGUgfHwgJ3Vua25vd24nOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIEdldCBhdmFpbGFibGUgb3V0cHV0cyBmcm9tIFRISVMgbm9kZSAoc291cmNlIG5vZGUpDQogICAgICAgICAgICAgICAgY29uc3Qgc291cmNlTm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShub2RlLnR5cGUpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGF2YWlsYWJsZU91dHB1dHMgPSBzb3VyY2VOb2RlRGVmPy5vdXRwdXRzIHx8IFtdOw0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJvdXRwdXQtbWFwcGluZy1jb25maWciPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29ubmVjdGlvbi1oZWFkZXIiPlRvICR7dGFyZ2V0Tm9kZU5hbWV9PC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25uZWN0aW9uLWNvbnRyb2xzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250cm9sLXJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5TZW5kIG91dHB1dDo8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPSJvdXRwdXRfbWFwcGluZ18ke25vZGVJZH18JHtjb25uLmZyb20ucG9ydE5hbWV9fCR7Y29ubi50by5ub2RlSWR9IiBjbGFzcz0ib3V0cHV0LW1hcHBpbmctc2VsZWN0Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IiI+U2VsZWN0Li4uPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2F2YWlsYWJsZU91dHB1dHMubWFwKG91dHB1dCA9PiANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgPG9wdGlvbiB2YWx1ZT0iJHtvdXRwdXQuaWR9IiAke2Nvbm4uZnJvbS5wb3J0TmFtZSA9PT0gb3V0cHV0LmlkID8gJ3NlbGVjdGVkJyA6ICcnfT4ke291dHB1dC5uYW1lfTwvb3B0aW9uPmANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuam9pbignJyl9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gR2VuZXJhdGUgY29uZmlndXJhdGlvbiBmaWVsZHMgLSBncm91cGVkIGZvciBiZXR0ZXIgb3JnYW5pemF0aW9uDQogICAgICAgIGNvbnN0IGNvbmZpZ0VudHJpZXMgPSBPYmplY3QuZW50cmllcyhub2RlRGVmLmNvbmZpZyk7DQogICAgICAgIGlmIChjb25maWdFbnRyaWVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSBzZWN0aW9uU3RhdGVzWydub2RlLXNldHRpbmdzJ107DQogICAgICAgICAgICBjb25zdCBoZWFkZXJDbGFzcyA9IGlzRXhwYW5kZWQgPyAnJyA6ICdjb2xsYXBzZWQnOw0KICAgICAgICAgICAgY29uc3QgaWNvbkNsYXNzID0gaXNFeHBhbmRlZCA/ICdmYXMgZmEtY2hldnJvbi1kb3duJyA6ICdmYXMgZmEtY2hldnJvbi1yaWdodCc7DQogICAgICAgICAgICBjb25zdCBjb250ZW50U3R5bGUgPSBpc0V4cGFuZGVkID8gJycgOiAnIHN0eWxlPSJkaXNwbGF5OiBub25lOyInOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWhlYWRlciAke2hlYWRlckNsYXNzfSIgZGF0YS1zZWN0aW9uPSJub2RlLXNldHRpbmdzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSIke2ljb25DbGFzc30iPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPk5vZGUgU2V0dGluZ3M8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c21hbGwgY2xhc3M9ImNvbmZpZy1jb3VudCI+KCR7Y29uZmlnRW50cmllcy5sZW5ndGh9KTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbi1jb250ZW50IiBpZD0ibm9kZS1zZXR0aW5ncy1jb250ZW50IiR7Y29udGVudFN0eWxlfT4NCiAgICAgICAgICAgIGA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgY29uZmlnXSBvZiBjb25maWdFbnRyaWVzKSB7DQogICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJjb25maWdfJHtub2RlSWR9XyR7a2V5fSI+JHtjb25maWcubGFiZWx9PC9sYWJlbD4NCiAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChjb25maWcudHlwZSA9PT0gJ3NlbGVjdCcpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPHNlbGVjdCBpZD0iY29uZmlnXyR7bm9kZUlkfV8ke2tleX0iPmA7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBub2RlX3JlZmVyZW5jZSBub2RlDQogICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdub2RlX3JlZmVyZW5jZScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT09ICdzb3VyY2Vfbm9kZV9pZCcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQb3B1bGF0ZSB3aXRoIGFsbCBhdmFpbGFibGUgbm9kZXMgKGV4Y2x1ZGluZyB0aGlzIG5vZGUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3QgYSBub2RlLi4uPC9vcHRpb24+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFthdmFpbGFibGVOb2RlSWQsIGF2YWlsYWJsZU5vZGVdIG9mIGZsb3dFZGl0b3Iubm9kZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF2YWlsYWJsZU5vZGVJZCAhPT0gbm9kZUlkKSB7IC8vIERvbid0IGluY2x1ZGUgc2VsZg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXZhaWxhYmxlTm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShhdmFpbGFibGVOb2RlLnR5cGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZU5hbWUgPSBhdmFpbGFibGVOb2RlRGVmID8gYXZhaWxhYmxlTm9kZURlZi5uYW1lIDogYXZhaWxhYmxlTm9kZS50eXBlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBub2RlLmNvbmZpZ1trZXldLnZhbHVlID09PSBhdmFpbGFibGVOb2RlSWQgPyAnc2VsZWN0ZWQnIDogJyc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8b3B0aW9uIHZhbHVlPSIke2F2YWlsYWJsZU5vZGVJZH0iICR7c2VsZWN0ZWR9PiR7bm9kZU5hbWV9ICgke2F2YWlsYWJsZU5vZGVJZH0pPC9vcHRpb24+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSAnb3V0cHV0X3BvcnRfaWQnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUG9wdWxhdGUgd2l0aCBvdXRwdXQgcG9ydHMgb2YgdGhlIHNlbGVjdGVkIHNvdXJjZSBub2RlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3Qgb3V0cHV0IHBvcnQuLi48L29wdGlvbj5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkTm9kZUlkID0gbm9kZS5jb25maWcuc291cmNlX25vZGVfaWQudmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZUlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkTm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KHNlbGVjdGVkTm9kZUlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWROb2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKHNlbGVjdGVkTm9kZS50eXBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZE5vZGVEZWYgJiYgc2VsZWN0ZWROb2RlRGVmLm91dHB1dHMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG91dHB1dCBvZiBzZWxlY3RlZE5vZGVEZWYub3V0cHV0cykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZCA9IG5vZGUuY29uZmlnW2tleV0udmFsdWUgPT09IG91dHB1dC5pZCA/ICdzZWxlY3RlZCcgOiAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPG9wdGlvbiB2YWx1ZT0iJHtvdXRwdXQuaWR9IiAke3NlbGVjdGVkfT4ke291dHB1dC5uYW1lfSAoJHtvdXRwdXQudHlwZX0pPC9vcHRpb24+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlZ3VsYXIgc2VsZWN0IGZpZWxkDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLm9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZCA9IG5vZGUuY29uZmlnW2tleV0udmFsdWUgPT09IG9wdGlvbiA/ICdzZWxlY3RlZCcgOiAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPG9wdGlvbiB2YWx1ZT0iJHtvcHRpb259IiAke3NlbGVjdGVkfT4ke29wdGlvbn08L29wdGlvbj5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVndWxhciBzZWxlY3QgZmllbGQgZm9yIG90aGVyIG5vZGVzDQogICAgICAgICAgICAgICAgICAgICAgICBjb25maWcub3B0aW9ucy5mb3JFYWNoKG9wdGlvbiA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBub2RlLmNvbmZpZ1trZXldLnZhbHVlID09PSBvcHRpb24gPyAnc2VsZWN0ZWQnIDogJyc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPG9wdGlvbiB2YWx1ZT0iJHtvcHRpb259IiAke3NlbGVjdGVkfT4ke29wdGlvbn08L29wdGlvbj5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDwvc2VsZWN0PmA7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb25maWcudHlwZSA9PT0gJ3RleHRhcmVhJykgew0KICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8dGV4dGFyZWEgaWQ9ImNvbmZpZ18ke25vZGVJZH1fJHtrZXl9Ij4ke25vZGUuY29uZmlnW2tleV0udmFsdWV9PC90ZXh0YXJlYT5gOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnR5cGUgPT09ICdudW1iZXInKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbiA9IGNvbmZpZy5taW4gPyBgIG1pbj0iJHtjb25maWcubWlufSJgIDogJyc7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1heCA9IGNvbmZpZy5tYXggPyBgIG1heD0iJHtjb25maWcubWF4fSJgIDogJyc7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0ZXAgPSBjb25maWcuc3RlcCA/IGAgc3RlcD0iJHtjb25maWcuc3RlcH0iYCA6ICcnOw0KICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8aW5wdXQgdHlwZT0ibnVtYmVyIiBpZD0iY29uZmlnXyR7bm9kZUlkfV8ke2tleX0iIHZhbHVlPSIke25vZGUuY29uZmlnW2tleV0udmFsdWV9IiR7bWlufSR7bWF4fSR7c3RlcH0+YDsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8aW5wdXQgdHlwZT0iJHtjb25maWcudHlwZX0iIGlkPSJjb25maWdfJHtub2RlSWR9XyR7a2V5fSIgdmFsdWU9IiR7bm9kZS5jb25maWdba2V5XS52YWx1ZX0iPmA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDwvZGl2PmA7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFNob3cgb3V0cHV0IGRhdGEgZm9yIGFsbCBwb3J0cyAoaWYgbm9kZSBoYXMgYmVlbiBleGVjdXRlZCkgLSBhdCB0aGUgYm90dG9tDQogICAgICAgIGlmIChub2RlLmxhc3RPdXRwdXREYXRhICYmIG5vZGUubGFzdEV4ZWN1dGlvblRpbWUpIHsNCiAgICAgICAgICAgIGNvbnN0IG5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICAgICAgICAgIGNvbnN0IG91dHB1dHMgPSBub2RlRGVmLm91dHB1dHMgfHwgW107DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChvdXRwdXRzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gc2VjdGlvblN0YXRlc1snb3V0cHV0LWRhdGEnXTsNCiAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJDbGFzcyA9IGlzRXhwYW5kZWQgPyAnJyA6ICdjb2xsYXBzZWQnOw0KICAgICAgICAgICAgICAgIGNvbnN0IGljb25DbGFzcyA9IGlzRXhwYW5kZWQgPyAnZmFzIGZhLWNoZXZyb24tZG93bicgOiAnZmFzIGZhLWNoZXZyb24tcmlnaHQnOw0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRTdHlsZSA9IGlzRXhwYW5kZWQgPyAnJyA6ICcgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Iic7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWhlYWRlciAke2hlYWRlckNsYXNzfSIgZGF0YS1zZWN0aW9uPSJvdXRwdXQtZGF0YSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9IiR7aWNvbkNsYXNzfSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPk91dHB1dCBEYXRhPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbCBjbGFzcz0iY29uZmlnLWNvdW50Ij4oJHtvdXRwdXRzLmxlbmd0aH0gcG9ydHMpPC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24tY29udGVudCIgaWQ9Im91dHB1dC1kYXRhLWNvbnRlbnQiJHtjb250ZW50U3R5bGV9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMTJweDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBtYXJnaW4tYm90dG9tOiA4cHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGFzdCBleGVjdXRlZDogJHtuZXcgRGF0ZShub2RlLmxhc3RFeGVjdXRpb25UaW1lKS50b0xvY2FsZVN0cmluZygpfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBvdXRwdXQgb2Ygb3V0cHV0cykgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXREYXRhID0gZ2V0T3V0cHV0UG9ydERhdGEobm9kZS5pZCwgb3V0cHV0LmlkKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gZm9ybWF0RGF0YVByZXZpZXcob3V0cHV0RGF0YSk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQtZGlzcGxheSIgc3R5bGU9Im1hcmdpbi1ib3R0b206IDhweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OiA1MDA7IG1hcmdpbi1ib3R0b206IDZweDsgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOyBmb250LXNpemU6IDEzcHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtvdXRwdXQubmFtZX0gPHNwYW4gc3R5bGU9ImNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC13ZWlnaHQ6IG5vcm1hbDsgZm9udC1zaXplOiAxMXB4OyI+KCR7Zm9ybWF0dGVkLnR5cGV9KTwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cHJlIGNsYXNzPSJjb250ZW50LXRleHQiIHN0eWxlPSJtYXJnaW4tYm90dG9tOiA0cHg7IG1heC1oZWlnaHQ6IDgwcHg7Ij4ke2VzY2FwZUh0bWwoZm9ybWF0dGVkLnByZXZpZXcpfTwvcHJlPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7Zm9ybWF0dGVkLmxlbmd0aCAhPT0gdW5kZWZpbmVkID8gYDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMTFweDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyI+TGVuZ3RoOiAke2Zvcm1hdHRlZC5sZW5ndGh9PC9kaXY+YCA6ICcnfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7Zm9ybWF0dGVkLmtleXMgIT09IHVuZGVmaW5lZCA/IGA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDExcHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsiPktleXM6ICR7Zm9ybWF0dGVkLmtleXN9PC9kaXY+YCA6ICcnfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7Zm9ybWF0dGVkLnNpemUgIT09IHVuZGVmaW5lZCA/IGA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDExcHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsiPlNpemU6ICR7KGZvcm1hdHRlZC5zaXplIC8gMTAyNCkudG9GaXhlZCgyKX0gS0I8L2Rpdj5gIDogJyd9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtmb3JtYXR0ZWQuZXN0aW1hdGVkU2l6ZSAhPT0gdW5kZWZpbmVkID8gYDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMTFweDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyI+RXN0LiBTaXplOiAkeyhmb3JtYXR0ZWQuZXN0aW1hdGVkU2l6ZSAvIDEwMjQpLnRvRml4ZWQoMil9IEtCPC9kaXY+YCA6ICcnfQ0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbmZpZ1BhbmVsLmlubmVySFRNTCA9IGNvbmZpZ0h0bWw7DQogICAgICAgIA0KICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzIGZvciBtYXBwaW5nIHNlbGVjdHMNCiAgICAgICAgLy8gTm8gaW5wdXQgbWFwcGluZyBzZWxlY3RzIGFueW1vcmUgLSBub2RlcyBjYW4ndCBjb250cm9sIHdoYXQgdGhleSByZWNlaXZlDQogICAgICAgIA0KICAgICAgICBjb25zdCBpbnB1dFRhcmdldFNlbGVjdHMgPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5wdXQtdGFyZ2V0LXNlbGVjdCcpOw0KICAgICAgICBpbnB1dFRhcmdldFNlbGVjdHMuZm9yRWFjaChzZWxlY3QgPT4gew0KICAgICAgICAgICAgc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3QgW25vZGVJZCwgY3VycmVudElucHV0UG9ydF0gPSBlLnRhcmdldC5pZC5yZXBsYWNlKCdpbnB1dF90YXJnZXRfJywgJycpLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRJbnB1dFBvcnQgPSBlLnRhcmdldC52YWx1ZTsNCiAgICAgICAgICAgICAgICAvLyBGaW5kIHRoZSBjb25uZWN0aW9uDQogICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkuZmluZChjb25uID0+DQogICAgICAgICAgICAgICAgICAgIGNvbm4udG8ubm9kZUlkID09PSBub2RlSWQgJiYgY29ubi50by5wb3J0TmFtZSA9PT0gY3VycmVudElucHV0UG9ydA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24gJiYgc2VsZWN0ZWRJbnB1dFBvcnQpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGFsbCBjb25uZWN0aW9ucyBmcm9tIHRoZSBzYW1lIGZyb21Ob2RlIHRvIHRoaXMgbm9kZSAocmVnYXJkbGVzcyBvZiBwb3J0KQ0KICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uc1RvUmVtb3ZlID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5maWx0ZXIoY29ubiA9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgY29ubi5mcm9tLm5vZGVJZCA9PT0gY29ubmVjdGlvbi5mcm9tLm5vZGVJZCAmJiBjb25uLnRvLm5vZGVJZCA9PT0gbm9kZUlkDQogICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25zVG9SZW1vdmUuZm9yRWFjaChjb25uID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuZGVsZXRlKGNvbm4uaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm4uc3ZnKSBjb25uLnN2Zy5yZW1vdmUoKTsNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgbmV3IGNvbm5lY3Rpb24NCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Q29ubmVjdGlvbklkID0gYGNvbm5fJHtjb25uZWN0aW9uLmZyb20ubm9kZUlkfV8ke2Nvbm5lY3Rpb24uZnJvbS5wb3J0TmFtZX1fJHtub2RlSWR9XyR7c2VsZWN0ZWRJbnB1dFBvcnR9YDsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Q29ubmVjdGlvbiA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBuZXdDb25uZWN0aW9uSWQsDQogICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiB7IG5vZGVJZDogY29ubmVjdGlvbi5mcm9tLm5vZGVJZCwgcG9ydE5hbWU6IGNvbm5lY3Rpb24uZnJvbS5wb3J0TmFtZSB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgdG86IHsgbm9kZUlkOiBub2RlSWQsIHBvcnROYW1lOiBzZWxlY3RlZElucHV0UG9ydCB9DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuc2V0KG5ld0Nvbm5lY3Rpb25JZCwgbmV3Q29ubmVjdGlvbik7DQogICAgICAgICAgICAgICAgICAgIGRyYXdDb25uZWN0aW9uKG5ld0Nvbm5lY3Rpb24pOw0KICAgICAgICAgICAgICAgICAgICAvLyBBdXRvLXNhdmUNCiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5zYXZlRmxvdykgd2luZG93LnNhdmVGbG93KCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgY29uc3Qgb3V0cHV0TWFwcGluZ1NlbGVjdHMgPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcub3V0cHV0LW1hcHBpbmctc2VsZWN0Jyk7DQogICAgICAgIG91dHB1dE1hcHBpbmdTZWxlY3RzLmZvckVhY2goc2VsZWN0ID0+IHsNCiAgICAgICAgICAgIHNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gZS50YXJnZXQuaWQucmVwbGFjZSgnb3V0cHV0X21hcHBpbmdfJywgJycpLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gcGFydHNbMF07DQogICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0UG9ydCA9IHBhcnRzWzFdOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGVJZCA9IHBhcnRzWzJdOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkT3V0cHV0UG9ydCA9IGUudGFyZ2V0LnZhbHVlOw0KICAgICAgICAgICAgICAgIHVwZGF0ZU91dHB1dE1hcHBpbmcobm9kZUlkLCBvdXRwdXRQb3J0LCB0YXJnZXROb2RlSWQsIHNlbGVjdGVkT3V0cHV0UG9ydCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzIGZvciBzcGVjaWFsIGJ1dHRvbnMNCiAgICAgICAgY29uc3Qgdmlld0Z1bGxJbWFnZUJ0biA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3IoJy52aWV3LWZ1bGwtaW1hZ2UtYnRuJyk7DQogICAgICAgIGlmICh2aWV3RnVsbEltYWdlQnRuKSB7DQogICAgICAgICAgICB2aWV3RnVsbEltYWdlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS1pZCcpOw0KICAgICAgICAgICAgICAgIHNob3dGdWxsSW1hZ2Uobm9kZUlkKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25zdCBwbGF5QXVkaW9CdG4gPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yKCcucGxheS1hdWRpby1idG4nKTsNCiAgICAgICAgaWYgKHBsYXlBdWRpb0J0bikgew0KICAgICAgICAgICAgcGxheUF1ZGlvQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS1pZCcpOw0KICAgICAgICAgICAgICAgIHBsYXlBdWRpbyhub2RlSWQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHN0b3BBdWRpb0J0biA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3IoJy5zdG9wLWF1ZGlvLWJ0bicpOw0KICAgICAgICBpZiAoc3RvcEF1ZGlvQnRuKSB7DQogICAgICAgICAgICBzdG9wQXVkaW9CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1ub2RlLWlkJyk7DQogICAgICAgICAgICAgICAgc3RvcEF1ZGlvKG5vZGVJZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgY29uc3Qgc3RhcnRSZXBlYXRlckJ0biA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3IoJy5zdGFydC1yZXBlYXRlci1idG4nKTsNCiAgICAgICAgaWYgKHN0YXJ0UmVwZWF0ZXJCdG4pIHsNCiAgICAgICAgICAgIHN0YXJ0UmVwZWF0ZXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1ub2RlLWlkJyk7DQogICAgICAgICAgICAgICAgc3RhcnRSZXBlYXRlcihub2RlSWQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHN0b3BSZXBlYXRlckJ0biA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3IoJy5zdG9wLXJlcGVhdGVyLWJ0bicpOw0KICAgICAgICBpZiAoc3RvcFJlcGVhdGVyQnRuKSB7DQogICAgICAgICAgICBzdG9wUmVwZWF0ZXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1ub2RlLWlkJyk7DQogICAgICAgICAgICAgICAgc3RvcFJlcGVhdGVyKG5vZGVJZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQWRkIGNoYW5nZSBsaXN0ZW5lcnMNCiAgICAgICAgZm9yIChjb25zdCBba2V5LCBjb25maWddIG9mIE9iamVjdC5lbnRyaWVzKG5vZGVEZWYuY29uZmlnKSkgew0KICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjb25maWdfJHtub2RlSWR9XyR7a2V5fWApOw0KICAgICAgICAgICAgaWYgKGVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIG5vZGUuY29uZmlnW2tleV0udmFsdWUgPSBlLnRhcmdldC52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIFNwZWNpYWwgaGFuZGxpbmcgZm9yIGRpc3BsYXkgbm9kZSBmb3JtYXQgY2hhbmdlcw0KICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnZGlzcGxheScgJiYga2V5ID09PSAnZm9ybWF0Jykgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBkaXNwbGF5LWZvcm1hdC0ke25vZGVJZH1gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYXRFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0RWxlbWVudC50ZXh0Q29udGVudCA9IGUudGFyZ2V0LnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBub2RlX3JlZmVyZW5jZSBzb3VyY2Ugbm9kZSBjaGFuZ2VzDQogICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdub2RlX3JlZmVyZW5jZScgJiYga2V5ID09PSAnc291cmNlX25vZGVfaWQnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIG91dHB1dCBwb3J0IGRyb3Bkb3duIHdoZW4gc291cmNlIG5vZGUgY2hhbmdlcw0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0UG9ydFNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjb25maWdfJHtub2RlSWR9X291dHB1dF9wb3J0X2lkYCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAob3V0cHV0UG9ydFNlbGVjdCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENsZWFyIGFuZCByZXBvcHVsYXRlIG91dHB1dCBwb3J0IG9wdGlvbnMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRQb3J0U2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSIiPlNlbGVjdCBvdXRwdXQgcG9ydC4uLjwvb3B0aW9uPic7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWROb2RlSWQgPSBlLnRhcmdldC52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWROb2RlSWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWROb2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoc2VsZWN0ZWROb2RlSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWROb2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZE5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUoc2VsZWN0ZWROb2RlLnR5cGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZURlZiAmJiBzZWxlY3RlZE5vZGVEZWYub3V0cHV0cykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgb3V0cHV0IG9mIHNlbGVjdGVkTm9kZURlZi5vdXRwdXRzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb24udmFsdWUgPSBvdXRwdXQuaWQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbi50ZXh0Q29udGVudCA9IGAke291dHB1dC5uYW1lfSAoJHtvdXRwdXQudHlwZX0pYDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0UG9ydFNlbGVjdC5hcHBlbmRDaGlsZChvcHRpb24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXNldCB0aGUgb3V0cHV0IHBvcnQgdmFsdWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmNvbmZpZy5vdXRwdXRfcG9ydF9pZC52YWx1ZSA9ICcnOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBjb2xsYXBzaWJsZSBzZWN0aW9uIGZ1bmN0aW9uYWxpdHkgd2l0aCBwZXJzaXN0ZW5jZQ0KICAgICAgICBjb25zdCBzZWN0aW9uSGVhZGVycyA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb25maWctc2VjdGlvbi1oZWFkZXInKTsNCiAgICAgICAgc2VjdGlvbkhlYWRlcnMuZm9yRWFjaChoZWFkZXIgPT4gew0KICAgICAgICAgICAgaGVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbklkID0gaGVhZGVyLmdldEF0dHJpYnV0ZSgnZGF0YS1zZWN0aW9uJyk7DQogICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke3NlY3Rpb25JZH0tY29udGVudGApOw0KICAgICAgICAgICAgICAgIGNvbnN0IGljb24gPSBoZWFkZXIucXVlcnlTZWxlY3RvcignaScpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChjb250ZW50ICYmIGljb24pIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDb2xsYXBzZWQgPSBoZWFkZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGlmIChpc0NvbGxhcHNlZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXhwYW5kDQogICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXIuY2xhc3NMaXN0LnJlbW92ZSgnY29sbGFwc2VkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLWRvd24nOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29sbGFwc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlci5jbGFzc0xpc3QuYWRkKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gU2F2ZSB0aGUgc3RhdGUgdG8gYXBwIHNldHRpbmdzICh0cnVlID0gZXhwYW5kZWQsIGZhbHNlID0gY29sbGFwc2VkKQ0KICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5zZXRTZXR0aW5nKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9ICFoZWFkZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzeXBuZXhBUEkuc2V0U2V0dGluZyhgY29uZmlnX3NlY3Rpb25fJHtzZWN0aW9uSWR9YCwgaXNFeHBhbmRlZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBzYXZlIGNvbmZpZyBzZWN0aW9uIHN0YXRlOicsIGVycm9yKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICB9DQp9DQoNCi8vIG5vZGUtcmVuZGVyZXIuanMgLSBEeW5hbWljIG5vZGUgcmVuZGVyaW5nIGZvciBGbG93IEVkaXRvcg0KDQpjbGFzcyBOb2RlUmVuZGVyZXIgew0KICAgIGNvbnN0cnVjdG9yKCkgew0KICAgICAgICB0aGlzLnRlbXBsYXRlcyA9IG5ldyBNYXAoKTsNCiAgICAgICAgdGhpcy5zZXR1cFN0YW5kYXJkVGVtcGxhdGUoKTsNCiAgICB9DQogICAgDQogICAgc2V0dXBTdGFuZGFyZFRlbXBsYXRlKCkgew0KICAgICAgICB0aGlzLnRlbXBsYXRlcy5zZXQoJ3N0YW5kYXJkJywgew0KICAgICAgICAgICAgcmVuZGVyOiAobm9kZSwgbm9kZURlZikgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0cyA9IG5vZGVEZWYuaW5wdXRzIHx8IFtdOw0KICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dHMgPSBub2RlRGVmLm91dHB1dHMgfHwgW107DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgcmV0dXJuIGANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmxvdy1ub2RlLWhlYWRlciI+DQogICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iJHtub2RlRGVmLmljb259Ij48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj4ke25vZGVEZWYubmFtZX08L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iZmxvdy1ub2RlLXR5cGUgJHtub2RlLnR5cGV9Ij4ke25vZGUudHlwZS50b1VwcGVyQ2FzZSgpfTwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Im5vZGUtZGVsZXRlLWJ0biIgdGl0bGU9IkRlbGV0ZSBub2RlIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRpbWVzIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsb3ctbm9kZS1jb250ZW50Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5vZGUtZGVmYXVsdC1jb250ZW50Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGwgY2xhc3M9InRleHQtbXV0ZWQiPiR7bm9kZURlZi5kZXNjcmlwdGlvbn08L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LW5vZGUtcG9ydHMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgJHtpbnB1dHMubWFwKGlucHV0ID0+IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8ZGl2IGNsYXNzPSJmbG93LW5vZGUtcG9ydCBpbnB1dCIgZGF0YS1wb3J0PSIke2lucHV0LmlkfSI+PC9kaXY+YA0KICAgICAgICAgICAgICAgICAgICAgICAgKS5qb2luKCcnKX0NCiAgICAgICAgICAgICAgICAgICAgICAgICR7b3V0cHV0cy5tYXAob3V0cHV0ID0+IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8ZGl2IGNsYXNzPSJmbG93LW5vZGUtcG9ydCBvdXRwdXQiIGRhdGEtcG9ydD0iJHtvdXRwdXQuaWR9Ij48L2Rpdj5gDQogICAgICAgICAgICAgICAgICAgICAgICApLmpvaW4oJycpfQ0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgDQogICAgcmVnaXN0ZXJUZW1wbGF0ZShuYW1lLCB0ZW1wbGF0ZSkgew0KICAgICAgICB0aGlzLnRlbXBsYXRlcy5zZXQobmFtZSwgdGVtcGxhdGUpOw0KICAgIH0NCiAgICANCiAgICByZW5kZXJOb2RlKG5vZGUpIHsNCiAgICAgICAgY29uc3Qgbm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShub2RlLnR5cGUpOw0KICAgICAgICBpZiAoIW5vZGVEZWYpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYE5vIG5vZGUgZGVmaW5pdGlvbiBmb3VuZCBmb3IgdHlwZTogJHtub2RlLnR5cGV9YCk7DQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHRlbXBsYXRlTmFtZSA9IG5vZGVEZWYudGVtcGxhdGUgfHwgJ3N0YW5kYXJkJzsNCiAgICAgICAgY29uc3QgdGVtcGxhdGUgPSB0aGlzLnRlbXBsYXRlcy5nZXQodGVtcGxhdGVOYW1lKTsNCiAgICAgICAgDQogICAgICAgIGlmICghdGVtcGxhdGUpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYE5vIHRlbXBsYXRlIGZvdW5kOiAke3RlbXBsYXRlTmFtZX1gKTsNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHRlbXBsYXRlLnJlbmRlcihub2RlLCBub2RlRGVmKTsNCiAgICB9DQogICAgDQogICAgY3JlYXRlTm9kZUVsZW1lbnQobm9kZSkgew0KICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgICAgICBub2RlRWxlbWVudC5jbGFzc05hbWUgPSBgZmxvdy1ub2RlICR7bm9kZS50eXBlfS1ub2RlYDsNCiAgICAgICAgbm9kZUVsZW1lbnQuaWQgPSBub2RlLmlkOw0KICAgICAgICBub2RlRWxlbWVudC5zdHlsZS5sZWZ0ID0gbm9kZS54ICsgJ3B4JzsNCiAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUudG9wID0gbm9kZS55ICsgJ3B4JzsNCiAgICAgICAgDQogICAgICAgIC8vIFJlbmRlciB0aGUgbm9kZSBjb250ZW50DQogICAgICAgIG5vZGVFbGVtZW50LmlubmVySFRNTCA9IHRoaXMucmVuZGVyTm9kZShub2RlKTsNCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lcnMgYW5kIGdldCB0aGUgdXBkYXRlZCBlbGVtZW50DQogICAgICAgIGNvbnN0IGZpbmFsRWxlbWVudCA9IHRoaXMuYWRkTm9kZUV2ZW50TGlzdGVuZXJzKG5vZGVFbGVtZW50LCBub2RlKTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiBmaW5hbEVsZW1lbnQ7DQogICAgfQ0KICAgIA0KICAgIGFkZE5vZGVFdmVudExpc3RlbmVycyhub2RlRWxlbWVudCwgbm9kZSkgew0KICAgICAgICAvLyBEZWxldGUgYnV0dG9uDQogICAgICAgIGNvbnN0IGRlbGV0ZUJ0biA9IG5vZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ub2RlLWRlbGV0ZS1idG4nKTsNCiAgICAgICAgaWYgKGRlbGV0ZUJ0bikgew0KICAgICAgICAgICAgZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgICAgIGRlbGV0ZU5vZGUobm9kZS5pZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gTm9kZSBzZWxlY3Rpb24NCiAgICAgICAgbm9kZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy5ub2RlLWRlbGV0ZS1idG4nKSkgcmV0dXJuOw0KICAgICAgICAgICAgc2VsZWN0Tm9kZShub2RlLmlkKTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyBOb2RlIGRyYWdnaW5nDQogICAgICAgIG5vZGVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7DQogICAgICAgICAgICBpZiAoZS50YXJnZXQuY2xvc2VzdCgnLm5vZGUtZGVsZXRlLWJ0bicpKSByZXR1cm47DQogICAgICAgICAgICBzdGFydERyYWdnaW5nTm9kZShub2RlLmlkLCBlKTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyBQb3J0IGNvbm5lY3Rpb25zDQogICAgICAgIGNvbnN0IHBvcnRzID0gbm9kZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZsb3ctbm9kZS1wb3J0Jyk7DQogICAgICAgIHBvcnRzLmZvckVhY2gocG9ydCA9PiB7DQogICAgICAgICAgICBwb3J0LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgICAgICBzdGFydENvbm5lY3Rpb24obm9kZS5pZCwgcG9ydC5kYXRhc2V0LnBvcnQsIHBvcnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdvdXRwdXQnKSk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICByZXR1cm4gbm9kZUVsZW1lbnQ7DQogICAgfQ0KfQ0KDQovLyBHbG9iYWwgbm9kZSByZW5kZXJlciBpbnN0YW5jZQ0KY29uc3Qgbm9kZVJlbmRlcmVyID0gbmV3IE5vZGVSZW5kZXJlcigpOw0KDQoNCi8vIFRleHQgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVRleHROb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IHRleHRDb250ZW50ID0gbm9kZS5jb25maWcudGV4dF9jb250ZW50LnZhbHVlOw0KDQogICAgcmV0dXJuIHsgdGV4dDogdGV4dENvbnRlbnQgfTsNCn0NCg0KDQovLyBKU09OIEV4dHJhY3QgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUpzb25FeHRyYWN0Tm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBmaWVsZFBhdGggPSBub2RlLmNvbmZpZy5maWVsZF9wYXRoLnZhbHVlOw0KICAgIGNvbnN0IGRlZmF1bHRWYWx1ZSA9IG5vZGUuY29uZmlnLmRlZmF1bHRfdmFsdWU/LnZhbHVlIHx8ICcnOw0KDQogICAgLy8gQWNjZXB0IGFueSBpbnB1dCBkYXRhLCBub3QganVzdCBqc29uX2RhdGENCiAgICBsZXQganNvbkRhdGEgPSBudWxsOw0KDQogICAgLy8gVHJ5IHRvIGZpbmQgSlNPTiBkYXRhIGZyb20gYW55IGlucHV0DQogICAgaWYgKGlucHV0RGF0YS5qc29uX2RhdGEpIHsNCiAgICAgICAganNvbkRhdGEgPSBpbnB1dERhdGEuanNvbl9kYXRhOw0KICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLmRhdGEpIHsNCiAgICAgICAganNvbkRhdGEgPSBpbnB1dERhdGEuZGF0YTsNCiAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS50ZXh0KSB7DQogICAgICAgIGpzb25EYXRhID0gaW5wdXREYXRhLnRleHQ7DQogICAgfSBlbHNlIGlmIChpbnB1dERhdGEucmVzcG9uc2UpIHsNCiAgICAgICAganNvbkRhdGEgPSBpbnB1dERhdGEucmVzcG9uc2U7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gVXNlIHRoZSBmaXJzdCBhdmFpbGFibGUgaW5wdXQNCiAgICAgICAgY29uc3QgZmlyc3RJbnB1dCA9IE9iamVjdC52YWx1ZXMoaW5wdXREYXRhKVswXTsNCiAgICAgICAganNvbkRhdGEgPSBmaXJzdElucHV0Ow0KICAgIH0NCg0KDQogICAgbGV0IGV4dHJhY3RlZFZhbHVlID0gbnVsbDsNCg0KICAgIHRyeSB7DQogICAgICAgIC8vIFBhcnNlIEpTT04gaWYgaXQncyBhIHN0cmluZw0KICAgICAgICBpZiAodHlwZW9mIGpzb25EYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAganNvbkRhdGEgPSBKU09OLnBhcnNlKGpzb25EYXRhKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEV4dHJhY3QgdmFsdWUgdXNpbmcgZG90IG5vdGF0aW9uDQogICAgICAgIGV4dHJhY3RlZFZhbHVlID0gd2luZG93LmZsb3dFZGl0b3JVdGlscy5leHRyYWN0TmVzdGVkVmFsdWUoanNvbkRhdGEsIGZpZWxkUGF0aCk7DQoNCiAgICAgICAgLy8gVXNlIGRlZmF1bHQgdmFsdWUgaWYgZXh0cmFjdGlvbiBmYWlsZWQNCiAgICAgICAgaWYgKGV4dHJhY3RlZFZhbHVlID09PSBudWxsIHx8IGV4dHJhY3RlZFZhbHVlID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGV4dHJhY3RlZFZhbHVlID0gZGVmYXVsdFZhbHVlOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gRm9ybWF0IHRoZSBvdXRwdXQgYXMgc3RyaW5nIGZvciBjb25zaXN0ZW5jeQ0KICAgICAgICBsZXQgZm9ybWF0dGVkVmFsdWUgPSBTdHJpbmcoZXh0cmFjdGVkVmFsdWUpOw0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBub2RlLmxhc3RFeHRyYWN0ZWRWYWx1ZSA9IGZvcm1hdHRlZFZhbHVlOw0KICAgICAgICBub2RlLmxhc3RGaWVsZFBhdGggPSBmaWVsZFBhdGg7DQoNCiAgICAgICAgLy8gRGVidWcgbG9nZ2luZw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkYXRhOiBmb3JtYXR0ZWRWYWx1ZSwNCiAgICAgICAgICAgIHRleHQ6IGZvcm1hdHRlZFZhbHVlLA0KICAgICAgICAgICAganNvbjogZXh0cmFjdGVkVmFsdWUsDQogICAgICAgICAgICBleHRyYWN0ZWRfdmFsdWU6IGZvcm1hdHRlZFZhbHVlLA0KICAgICAgICAgICAgZmllbGRfcGF0aDogZmllbGRQYXRoLA0KICAgICAgICAgICAgb3JpZ2luYWw6IGpzb25EYXRhDQogICAgICAgIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignSlNPTiBFeHRyYWN0IGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGRhdGE6IGRlZmF1bHRWYWx1ZSwNCiAgICAgICAgICAgIHRleHQ6IGRlZmF1bHRWYWx1ZSwNCiAgICAgICAgICAgIGpzb246IG51bGwsDQogICAgICAgICAgICBleHRyYWN0ZWRfdmFsdWU6IGRlZmF1bHRWYWx1ZSwNCiAgICAgICAgICAgIGZpZWxkX3BhdGg6IGZpZWxkUGF0aCwNCiAgICAgICAgICAgIG9yaWdpbmFsOiBqc29uRGF0YSwNCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQoNCi8vIFJhbmRvbSBMaW5lIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVSYW5kb21RdW90ZU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgc2tpcEVtcHR5ID0gbm9kZS5jb25maWcuc2tpcF9lbXB0eS52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IHRyaW1XaGl0ZXNwYWNlID0gbm9kZS5jb25maWcudHJpbV93aGl0ZXNwYWNlLnZhbHVlID09PSAndHJ1ZSc7DQogICAgY29uc3QgbWF4TGVuZ3RoID0gcGFyc2VJbnQobm9kZS5jb25maWcubWF4X2xlbmd0aC52YWx1ZSk7DQoNCg0KICAgIGxldCB0ZXh0ID0gaW5wdXREYXRhLnRleHQ7DQogICAgaWYgKHR5cGVvZiB0ZXh0ICE9PSAnc3RyaW5nJykgew0KICAgICAgICB0ZXh0ID0gSlNPTi5zdHJpbmdpZnkodGV4dCk7DQogICAgfQ0KDQoNCiAgICBjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoJ1xuJyk7DQoNCiAgICBsZXQgdmFsaWRMaW5lcyA9IGxpbmVzOw0KDQogICAgaWYgKHNraXBFbXB0eSkgew0KICAgICAgICB2YWxpZExpbmVzID0gbGluZXMuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkubGVuZ3RoID4gMCk7DQogICAgfQ0KDQogICAgaWYgKHRyaW1XaGl0ZXNwYWNlKSB7DQogICAgICAgIHZhbGlkTGluZXMgPSB2YWxpZExpbmVzLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKTsNCiAgICB9DQoNCiAgICBpZiAodmFsaWRMaW5lcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgcmV0dXJuIHsgcmFuZG9tX2xpbmU6IG51bGwsIGxpbmVfbnVtYmVyOiAwLCB0b3RhbF9saW5lczogMCB9Ow0KICAgIH0NCg0KICAgIGNvbnN0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdmFsaWRMaW5lcy5sZW5ndGgpOw0KICAgIGxldCByYW5kb21MaW5lID0gdmFsaWRMaW5lc1tyYW5kb21JbmRleF07DQoNCg0KICAgIGlmIChtYXhMZW5ndGggPiAwICYmIHJhbmRvbUxpbmUubGVuZ3RoID4gbWF4TGVuZ3RoKSB7DQogICAgICAgIHJhbmRvbUxpbmUgPSByYW5kb21MaW5lLnN1YnN0cmluZygwLCBtYXhMZW5ndGgpICsgJy4uLic7DQogICAgfQ0KDQogICAgY29uc3QgcmVzdWx0ID0gew0KICAgICAgICByYW5kb21fbGluZTogcmFuZG9tTGluZSwNCiAgICAgICAgbGluZV9udW1iZXI6IHJhbmRvbUluZGV4ICsgMSwNCiAgICAgICAgdG90YWxfbGluZXM6IHZhbGlkTGluZXMubGVuZ3RoDQogICAgfTsNCg0KICAgIHJldHVybiByZXN1bHQ7DQp9DQoNCi8vIE1hdGggT3BlcmF0aW9ucyBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlTWF0aE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgb3BlcmF0aW9uID0gbm9kZS5jb25maWcub3BlcmF0aW9uLnZhbHVlOw0KICAgIGNvbnN0IGNvbmZpZ1ZhbHVlQSA9IHBhcnNlRmxvYXQobm9kZS5jb25maWcudmFsdWVfYS52YWx1ZSkgfHwgMDsNCiAgICBjb25zdCBjb25maWdWYWx1ZUIgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLnZhbHVlX2IudmFsdWUpIHx8IDA7DQogICAgbGV0IGRlY2ltYWxQbGFjZXMgPSBwYXJzZUludChub2RlLmNvbmZpZy5kZWNpbWFsX3BsYWNlcy52YWx1ZSk7DQogICAgaWYgKGlzTmFOKGRlY2ltYWxQbGFjZXMpKSBkZWNpbWFsUGxhY2VzID0gMDsgLy8gRGVmYXVsdCB0byAwIGlmIG5vdCBhIG51bWJlcg0KDQogICAgLy8gR2V0IHZhbHVlcyBmcm9tIGlucHV0cyBvciBjb25maWcNCiAgICBsZXQgdmFsdWVBID0gaW5wdXREYXRhLnZhbHVlX2EgIT09IHVuZGVmaW5lZCA/IGlucHV0RGF0YS52YWx1ZV9hIDogDQogICAgICAgICAgICAgICAgIGlucHV0RGF0YS5udW1iZXJfYSAhPT0gdW5kZWZpbmVkID8gaW5wdXREYXRhLm51bWJlcl9hIDogY29uZmlnVmFsdWVBOw0KICAgIGxldCB2YWx1ZUIgPSBpbnB1dERhdGEudmFsdWVfYiAhPT0gdW5kZWZpbmVkID8gaW5wdXREYXRhLnZhbHVlX2IgOiANCiAgICAgICAgICAgICAgICAgaW5wdXREYXRhLm51bWJlcl9iICE9PSB1bmRlZmluZWQgPyBpbnB1dERhdGEubnVtYmVyX2IgOiBjb25maWdWYWx1ZUI7DQoNCiAgICAvLyBDb252ZXJ0IHRvIG51bWJlcnMNCiAgICBpZiAodHlwZW9mIHZhbHVlQSA9PT0gJ3N0cmluZycpIHZhbHVlQSA9IHBhcnNlRmxvYXQodmFsdWVBKSB8fCAwOw0KICAgIGlmICh0eXBlb2YgdmFsdWVCID09PSAnc3RyaW5nJykgdmFsdWVCID0gcGFyc2VGbG9hdCh2YWx1ZUIpIHx8IDA7DQogICAgaWYgKHR5cGVvZiB2YWx1ZUEgPT09ICdvYmplY3QnICYmIHZhbHVlQSAhPT0gbnVsbCkgew0KICAgICAgICAvLyBUcnkgdG8gZXh0cmFjdCBudW1lcmljIHZhbHVlIGZyb20gb2JqZWN0DQogICAgICAgIHZhbHVlQSA9IHBhcnNlRmxvYXQodmFsdWVBLnZhbHVlIHx8IHZhbHVlQS5yZXN1bHQgfHwgdmFsdWVBLmRhdGEgfHwgMCk7DQogICAgfQ0KICAgIGlmICh0eXBlb2YgdmFsdWVCID09PSAnb2JqZWN0JyAmJiB2YWx1ZUIgIT09IG51bGwpIHsNCiAgICAgICAgdmFsdWVCID0gcGFyc2VGbG9hdCh2YWx1ZUIudmFsdWUgfHwgdmFsdWVCLnJlc3VsdCB8fCB2YWx1ZUIuZGF0YSB8fCAwKTsNCiAgICB9DQoNCiAgICBsZXQgcmVzdWx0ID0gMDsNCg0KICAgIHRyeSB7DQogICAgICAgIHN3aXRjaCAob3BlcmF0aW9uKSB7DQogICAgICAgICAgICBjYXNlICdhZGQnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlQSArIHZhbHVlQjsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3N1YnRyYWN0JzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZUEgLSB2YWx1ZUI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdtdWx0aXBseSc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWVBICogdmFsdWVCOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZGl2aWRlJzoNCiAgICAgICAgICAgICAgICBpZiAodmFsdWVCID09PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ0RpdmlzaW9uIGJ5IHplcm8nKTsNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZUEgLyB2YWx1ZUI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdtb2R1bG8nOg0KICAgICAgICAgICAgICAgIGlmICh2YWx1ZUIgPT09IDApIHRocm93IG5ldyBFcnJvcignTW9kdWxvIGJ5IHplcm8nKTsNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZUEgJSB2YWx1ZUI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdwb3dlcic6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5wb3codmFsdWVBLCB2YWx1ZUIpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbWluJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLm1pbih2YWx1ZUEsIHZhbHVlQik7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdtYXgnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGgubWF4KHZhbHVlQSwgdmFsdWVCKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2Ficyc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5hYnModmFsdWVBKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JvdW5kJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLnJvdW5kKHZhbHVlQSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdmbG9vcic6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5mbG9vcih2YWx1ZUEpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnY2VpbCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5jZWlsKHZhbHVlQSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlQTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFJvdW5kIHRvIHNwZWNpZmllZCBkZWNpbWFsIHBsYWNlcw0KICAgICAgICBpZiAoZGVjaW1hbFBsYWNlcyA+PSAwKSB7DQogICAgICAgICAgICByZXN1bHQgPSBwYXJzZUZsb2F0KHJlc3VsdC50b0ZpeGVkKGRlY2ltYWxQbGFjZXMpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBub2RlLmxhc3RWYWx1ZUEgPSB2YWx1ZUE7DQogICAgICAgIG5vZGUubGFzdFZhbHVlQiA9IHZhbHVlQjsNCiAgICAgICAgbm9kZS5sYXN0UmVzdWx0ID0gcmVzdWx0Ow0KICAgICAgICBub2RlLmxhc3RPcGVyYXRpb24gPSBvcGVyYXRpb247DQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHJlc3VsdDogcmVzdWx0LA0KICAgICAgICAgICAgZGF0YTogcmVzdWx0LA0KICAgICAgICAgICAgdGV4dDogcmVzdWx0LnRvU3RyaW5nKCksDQogICAgICAgICAgICBmb3JtYXR0ZWQ6IGRlY2ltYWxQbGFjZXMgPT09IDAgPyByZXN1bHQudG9TdHJpbmcoKSA6IHJlc3VsdC50b0ZpeGVkKGRlY2ltYWxQbGFjZXMpDQogICAgICAgIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTWF0aCBvcGVyYXRpb24gZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgcmVzdWx0OiAwLA0KICAgICAgICAgICAgZGF0YTogMCwNCiAgICAgICAgICAgIHRleHQ6ICIwIiwNCiAgICAgICAgICAgIGZvcm1hdHRlZDogZGVjaW1hbFBsYWNlcyA9PT0gMCA/ICIwIiA6ICIwLjAwIiwNCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQovLyBBcnJheSBPcGVyYXRpb25zIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVBcnJheU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgb3BlcmF0aW9uID0gbm9kZS5jb25maWcub3BlcmF0aW9uLnZhbHVlOw0KICAgIGNvbnN0IGZpZWxkUGF0aCA9IG5vZGUuY29uZmlnLmZpZWxkX3BhdGgudmFsdWU7DQogICAgY29uc3QgZmlsdGVyVmFsdWUgPSBub2RlLmNvbmZpZy5maWx0ZXJfdmFsdWUudmFsdWU7DQogICAgY29uc3QgZmlsdGVyT3BlcmF0b3IgPSBub2RlLmNvbmZpZy5maWx0ZXJfb3BlcmF0b3IudmFsdWU7DQogICAgY29uc3Qgam9pblNlcGFyYXRvciA9IG5vZGUuY29uZmlnLmpvaW5fc2VwYXJhdG9yLnZhbHVlIHx8ICcsICc7DQogICAgY29uc3Qgc2xpY2VTdGFydCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLnNsaWNlX3N0YXJ0LnZhbHVlKSB8fCAwOw0KICAgIGNvbnN0IHNsaWNlRW5kID0gcGFyc2VJbnQobm9kZS5jb25maWcuc2xpY2VfZW5kLnZhbHVlKSB8fCAwOw0KDQogICAgLy8gR2V0IGFycmF5IGZyb20gaW5wdXQNCiAgICBsZXQgYXJyYXkgPSBpbnB1dERhdGEuYXJyYXkgfHwgaW5wdXREYXRhLmRhdGE7DQogICAgbGV0IG9iamVjdCA9IGlucHV0RGF0YS5vYmplY3QgfHwgaW5wdXREYXRhLmRhdGE7DQogICAgDQogICAgLy8gRm9yIG9iamVjdCBvcGVyYXRpb25zLCB3ZSB3b3JrIHdpdGggb2JqZWN0cyBpbnN0ZWFkIG9mIGFycmF5cw0KICAgIGlmIChbJ29iamVjdF9rZXlzJywgJ29iamVjdF92YWx1ZXMnLCAnb2JqZWN0X2VudHJpZXMnXS5pbmNsdWRlcyhvcGVyYXRpb24pKSB7DQogICAgICAgIC8vIFBhcnNlIG9iamVjdCBpZiBpdCdzIGEgc3RyaW5nDQogICAgICAgIGlmICh0eXBlb2Ygb2JqZWN0ID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBvYmplY3QgPSBKU09OLnBhcnNlKG9iamVjdCk7DQogICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIG9iamVjdDonLCBlKTsNCiAgICAgICAgICAgICAgICByZXR1cm4geyByZXN1bHQ6IG51bGwsIGVycm9yOiAnSW52YWxpZCBvYmplY3QgZGF0YScgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh0eXBlb2Ygb2JqZWN0ICE9PSAnb2JqZWN0JyB8fCBBcnJheS5pc0FycmF5KG9iamVjdCkgfHwgb2JqZWN0ID09PSBudWxsKSB7DQogICAgICAgICAgICByZXR1cm4geyByZXN1bHQ6IG51bGwsIGVycm9yOiAnSW5wdXQgaXMgbm90IGFuIG9iamVjdCcgfTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIFBhcnNlIGFycmF5IGlmIGl0J3MgYSBzdHJpbmcgKGV4aXN0aW5nIGxvZ2ljKQ0KICAgICAgICBpZiAodHlwZW9mIGFycmF5ID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBhcnJheSA9IEpTT04ucGFyc2UoYXJyYXkpOw0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSBhcnJheTonLCBlKTsNCiAgICAgICAgICAgICAgICByZXR1cm4geyByZXN1bHQ6IG51bGwsIGVycm9yOiAnSW52YWxpZCBhcnJheSBkYXRhJyB9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBudWxsLCBlcnJvcjogJ0lucHV0IGlzIG5vdCBhbiBhcnJheScgfTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGxldCByZXN1bHQgPSBudWxsOw0KDQogICAgdHJ5IHsNCiAgICAgICAgc3dpdGNoIChvcGVyYXRpb24pIHsNCiAgICAgICAgICAgIGNhc2UgJ21hcCc6DQogICAgICAgICAgICAgICAgaWYgKGZpZWxkUGF0aCkgew0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5tYXAoaXRlbSA9PiB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShpdGVtLCBmaWVsZFBhdGgpKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5zbGljZSgpOyAvLyBSZXR1cm4gY29weSBvZiBhcnJheQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2ZpbHRlcic6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkuZmlsdGVyKGl0ZW0gPT4gew0KICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBmaWVsZFBhdGggPyB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShpdGVtLCBmaWVsZFBhdGgpIDogaXRlbTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBlcmZvcm1GaWx0ZXJPcGVyYXRpb24odmFsdWUsIGZpbHRlclZhbHVlLCBmaWx0ZXJPcGVyYXRvcik7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdsZW5ndGgnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5Lmxlbmd0aDsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2pvaW4nOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5Lm1hcChpdGVtID0+IHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGZpZWxkUGF0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZXh0cmFjdE5lc3RlZFZhbHVlKGl0ZW0sIGZpZWxkUGF0aCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBpdGVtID09PSAnb2JqZWN0JyA/IEpTT04uc3RyaW5naWZ5KGl0ZW0pIDogU3RyaW5nKGl0ZW0pOw0KICAgICAgICAgICAgICAgIH0pLmpvaW4oam9pblNlcGFyYXRvcik7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdmaXJzdCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkubGVuZ3RoID4gMCA/IGFycmF5WzBdIDogbnVsbDsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2xhc3QnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5Lmxlbmd0aCA+IDAgPyBhcnJheVthcnJheS5sZW5ndGggLSAxXSA6IG51bGw7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzbGljZSc6DQogICAgICAgICAgICAgICAgY29uc3QgZW5kID0gc2xpY2VFbmQgPiAwID8gc2xpY2VFbmQgOiBhcnJheS5sZW5ndGg7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkuc2xpY2Uoc2xpY2VTdGFydCwgZW5kKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JldmVyc2UnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5LnNsaWNlKCkucmV2ZXJzZSgpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnc29ydCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkuc2xpY2UoKS5zb3J0KChhLCBiKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZUEgPSBmaWVsZFBhdGggPyB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShhLCBmaWVsZFBhdGgpIDogYTsNCiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlQiA9IGZpZWxkUGF0aCA/IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZXh0cmFjdE5lc3RlZFZhbHVlKGIsIGZpZWxkUGF0aCkgOiBiOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWVBIDwgdmFsdWVCID8gLTEgOiB2YWx1ZUEgPiB2YWx1ZUIgPyAxIDogMDsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3VuaXF1ZSc6DQogICAgICAgICAgICAgICAgaWYgKGZpZWxkUGF0aCkgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWVuID0gbmV3IFNldCgpOw0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5maWx0ZXIoaXRlbSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZXh0cmFjdE5lc3RlZFZhbHVlKGl0ZW0sIGZpZWxkUGF0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2Vlbi5oYXModmFsdWUpKSByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWVuLmFkZCh2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gWy4uLm5ldyBTZXQoYXJyYXkpXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdvYmplY3Rfa2V5cyc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gT2JqZWN0LmtleXMob2JqZWN0KTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ29iamVjdF92YWx1ZXMnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE9iamVjdC52YWx1ZXMob2JqZWN0KTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ29iamVjdF9lbnRyaWVzJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBPYmplY3QuZW50cmllcyhvYmplY3QpLm1hcCgoW2tleSwgdmFsdWVdKSA9PiAoew0KICAgICAgICAgICAgICAgICAgICBrZXk6IGtleSwNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlDQogICAgICAgICAgICAgICAgfSkpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBpZiAoWydvYmplY3Rfa2V5cycsICdvYmplY3RfdmFsdWVzJywgJ29iamVjdF9lbnRyaWVzJ10uaW5jbHVkZXMob3BlcmF0aW9uKSkgew0KICAgICAgICAgICAgbm9kZS5sYXN0QXJyYXkgPSBvYmplY3Q7DQogICAgICAgICAgICBub2RlLmxhc3RPYmplY3QgPSBvYmplY3Q7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBub2RlLmxhc3RBcnJheSA9IGFycmF5Ow0KICAgICAgICB9DQogICAgICAgIG5vZGUubGFzdFJlc3VsdCA9IHJlc3VsdDsNCiAgICAgICAgbm9kZS5sYXN0T3BlcmF0aW9uID0gb3BlcmF0aW9uOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXN1bHQ6IHJlc3VsdCwNCiAgICAgICAgICAgIGRhdGE6IHJlc3VsdCwNCiAgICAgICAgICAgIHRleHQ6IEFycmF5LmlzQXJyYXkocmVzdWx0KSA/IEpTT04uc3RyaW5naWZ5KHJlc3VsdCkgOiBTdHJpbmcocmVzdWx0KSwNCiAgICAgICAgICAgIGxlbmd0aDogQXJyYXkuaXNBcnJheShyZXN1bHQpID8gcmVzdWx0Lmxlbmd0aCA6IEFycmF5LmlzQXJyYXkoYXJyYXkpID8gYXJyYXkubGVuZ3RoIDogMCwNCiAgICAgICAgICAgIGZpcnN0OiBBcnJheS5pc0FycmF5KGFycmF5KSAmJiBhcnJheS5sZW5ndGggPiAwID8gYXJyYXlbMF0gOiBudWxsLA0KICAgICAgICAgICAgbGFzdDogQXJyYXkuaXNBcnJheShhcnJheSkgJiYgYXJyYXkubGVuZ3RoID4gMCA/IGFycmF5W2FycmF5Lmxlbmd0aCAtIDFdIDogbnVsbA0KICAgICAgICB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0FycmF5IG9wZXJhdGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXN1bHQ6IG51bGwsDQogICAgICAgICAgICBkYXRhOiBudWxsLA0KICAgICAgICAgICAgdGV4dDogIiIsDQogICAgICAgICAgICBsZW5ndGg6IDAsDQogICAgICAgICAgICBmaXJzdDogbnVsbCwNCiAgICAgICAgICAgIGxhc3Q6IG51bGwsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIGZvciBhcnJheSBmaWx0ZXJpbmcNCmZ1bmN0aW9uIHBlcmZvcm1GaWx0ZXJPcGVyYXRpb24odmFsdWUsIGZpbHRlclZhbHVlLCBvcGVyYXRvcikgew0KICAgIGNvbnN0IHZhbHVlU3RyID0gU3RyaW5nKHZhbHVlKS50b0xvd2VyQ2FzZSgpOw0KICAgIGNvbnN0IGZpbHRlclN0ciA9IFN0cmluZyhmaWx0ZXJWYWx1ZSkudG9Mb3dlckNhc2UoKTsNCiAgICANCiAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7DQogICAgICAgIGNhc2UgJ2VxdWFscyc6DQogICAgICAgICAgICByZXR1cm4gdmFsdWUgPT0gZmlsdGVyVmFsdWU7DQogICAgICAgIGNhc2UgJ25vdF9lcXVhbHMnOg0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlICE9IGZpbHRlclZhbHVlOw0KICAgICAgICBjYXNlICdjb250YWlucyc6DQogICAgICAgICAgICByZXR1cm4gdmFsdWVTdHIuaW5jbHVkZXMoZmlsdGVyU3RyKTsNCiAgICAgICAgY2FzZSAnZ3JlYXRlcl90aGFuJzoNCiAgICAgICAgICAgIHJldHVybiBOdW1iZXIodmFsdWUpID4gTnVtYmVyKGZpbHRlclZhbHVlKTsNCiAgICAgICAgY2FzZSAnbGVzc190aGFuJzoNCiAgICAgICAgICAgIHJldHVybiBOdW1iZXIodmFsdWUpIDwgTnVtYmVyKGZpbHRlclZhbHVlKTsNCiAgICAgICAgY2FzZSAnc3RhcnRzX3dpdGgnOg0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlU3RyLnN0YXJ0c1dpdGgoZmlsdGVyU3RyKTsNCiAgICAgICAgY2FzZSAnZW5kc193aXRoJzoNCiAgICAgICAgICAgIHJldHVybiB2YWx1ZVN0ci5lbmRzV2l0aChmaWx0ZXJTdHIpOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KfQ0KDQovLyBTdHJpbmcgT3BlcmF0aW9ucyBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlU3RyaW5nTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBvcGVyYXRpb24gPSBub2RlLmNvbmZpZy5vcGVyYXRpb24udmFsdWU7DQogICAgY29uc3QgY29uZmlnVGV4dEIgPSBub2RlLmNvbmZpZy50ZXh0X2IudmFsdWU7DQogICAgDQogICAgLy8gUHJvY2VzcyBlc2NhcGUgc2VxdWVuY2VzIGluIHNlcGFyYXRvciAoZS5nLiwgXG4sIFxyXG4sIFx0LCBldGMuKQ0KICAgIGxldCBzZXBhcmF0b3IgPSBub2RlLmNvbmZpZy5zZXBhcmF0b3IudmFsdWUgfHwgJywnOw0KICAgIHNlcGFyYXRvciA9IHNlcGFyYXRvcg0KICAgICAgICAucmVwbGFjZSgvXFxuL2csICdcbicpDQogICAgICAgIC5yZXBsYWNlKC9cXHIvZywgJ1xyJykNCiAgICAgICAgLnJlcGxhY2UoL1xcdC9nLCAnXHQnKQ0KICAgICAgICAucmVwbGFjZSgvXFxcXC9nLCAnXFwnKTsNCiAgICANCiAgICBjb25zdCBzZWFyY2hUZXh0ID0gbm9kZS5jb25maWcuc2VhcmNoX3RleHQudmFsdWU7DQogICAgY29uc3QgcmVwbGFjZVRleHQgPSBub2RlLmNvbmZpZy5yZXBsYWNlX3RleHQudmFsdWU7DQogICAgY29uc3Qgc3RhcnRJbmRleCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLnN0YXJ0X2luZGV4LnZhbHVlKSB8fCAwOw0KICAgIGNvbnN0IGVuZEluZGV4ID0gcGFyc2VJbnQobm9kZS5jb25maWcuZW5kX2luZGV4LnZhbHVlKSB8fCAwOw0KICAgIGNvbnN0IHJlcGVhdENvdW50ID0gcGFyc2VJbnQobm9kZS5jb25maWcucmVwZWF0X2NvdW50LnZhbHVlKSB8fCAxOw0KICAgIGNvbnN0IGNhc2VTZW5zaXRpdmUgPSBub2RlLmNvbmZpZy5jYXNlX3NlbnNpdGl2ZS52YWx1ZSA9PT0gJ3RydWUnOw0KDQogICAgLy8gR2V0IHRleHQgaW5wdXRzDQogICAgbGV0IHRleHRBID0gaW5wdXREYXRhLnRleHQgfHwgaW5wdXREYXRhLmRhdGEgfHwgJyc7DQogICAgbGV0IHRleHRCID0gaW5wdXREYXRhLnRleHRfYiB8fCBjb25maWdUZXh0QiB8fCAnJzsNCg0KICAgIC8vIERlYnVnIGxvZ2dpbmcgZm9yIGlucHV0IHN5bmNocm9uaXphdGlvbg0KICAgIGNvbnNvbGUubG9nKCfwn5SXIFN0cmluZyBOb2RlIElucHV0IERlYnVnOicsIHsNCiAgICAgICAgaW5wdXREYXRhOiBpbnB1dERhdGEsDQogICAgICAgIHRleHRBOiB0ZXh0QSwNCiAgICAgICAgdGV4dEI6IHRleHRCLA0KICAgICAgICBjb25maWdUZXh0QjogY29uZmlnVGV4dEIsDQogICAgICAgIG9wZXJhdGlvbjogb3BlcmF0aW9uDQogICAgfSk7DQoNCiAgICAvLyBDb252ZXJ0IHRvIHN0cmluZ3MNCiAgICBpZiAodHlwZW9mIHRleHRBICE9PSAnc3RyaW5nJykgdGV4dEEgPSBTdHJpbmcodGV4dEEpOw0KICAgIGlmICh0eXBlb2YgdGV4dEIgIT09ICdzdHJpbmcnKSB0ZXh0QiA9IFN0cmluZyh0ZXh0Qik7DQoNCiAgICBsZXQgcmVzdWx0ID0gJyc7DQoNCiAgICB0cnkgew0KICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbikgew0KICAgICAgICAgICAgY2FzZSAnY29uY2F0ZW5hdGUnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBICsgc2VwYXJhdG9yICsgdGV4dEI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzcGxpdCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdGV4dEEuc3BsaXQoc2VwYXJhdG9yKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JlcGxhY2UnOg0KICAgICAgICAgICAgICAgIGlmIChjYXNlU2Vuc2l0aXZlKSB7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnJlcGxhY2UobmV3IFJlZ0V4cChlc2NhcGVSZWdleChzZWFyY2hUZXh0KSwgJ2cnKSwgcmVwbGFjZVRleHQpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnJlcGxhY2UobmV3IFJlZ0V4cChlc2NhcGVSZWdleChzZWFyY2hUZXh0KSwgJ2dpJyksIHJlcGxhY2VUZXh0KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICd0cmltJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS50cmltKCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICd1cHBlcmNhc2UnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdsb3dlcmNhc2UnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzdWJzdHJpbmcnOg0KICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IGVuZEluZGV4ID4gMCA/IGVuZEluZGV4IDogdGV4dEEubGVuZ3RoOw0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnN1YnN0cmluZyhzdGFydEluZGV4LCBlbmQpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAncmVnZXhfbWF0Y2gnOg0KICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoRmxhZ3MgPSBjYXNlU2Vuc2l0aXZlID8gJ2cnIDogJ2dpJzsNCiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gdGV4dEEubWF0Y2gobmV3IFJlZ0V4cChzZWFyY2hUZXh0LCBtYXRjaEZsYWdzKSk7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gbWF0Y2hlcyB8fCBbXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JlZ2V4X3JlcGxhY2UnOg0KICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VGbGFncyA9IGNhc2VTZW5zaXRpdmUgPyAnZycgOiAnZ2knOw0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnJlcGxhY2UobmV3IFJlZ0V4cChzZWFyY2hUZXh0LCByZXBsYWNlRmxhZ3MpLCByZXBsYWNlVGV4dCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzdGFydHNfd2l0aCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gY2FzZVNlbnNpdGl2ZSA/IHRleHRBLnN0YXJ0c1dpdGgoc2VhcmNoVGV4dCkgOiANCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChzZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCkpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZW5kc193aXRoJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBjYXNlU2Vuc2l0aXZlID8gdGV4dEEuZW5kc1dpdGgoc2VhcmNoVGV4dCkgOiANCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2NvbnRhaW5zJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBjYXNlU2Vuc2l0aXZlID8gdGV4dEEuaW5jbHVkZXMoc2VhcmNoVGV4dCkgOiANCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JlcGVhdCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdGV4dEEucmVwZWF0KE1hdGgubWF4KDAsIE1hdGgubWluKHJlcGVhdENvdW50LCAxMDApKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdsYXN0X2xpbmUnOg0KICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gdGV4dEEuc3BsaXQoJ1xuJykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkubGVuZ3RoID4gMCk7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gbGluZXMubGVuZ3RoID4gMCA/IGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdIDogJyc7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU3RvcmUgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgICAgIG5vZGUubGFzdFRleHRBID0gdGV4dEE7DQogICAgICAgIG5vZGUubGFzdFRleHRCID0gdGV4dEI7DQogICAgICAgIG5vZGUubGFzdFJlc3VsdCA9IHJlc3VsdDsNCiAgICAgICAgbm9kZS5sYXN0T3BlcmF0aW9uID0gb3BlcmF0aW9uOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXN1bHQ6IEFycmF5LmlzQXJyYXkocmVzdWx0KSA/IHJlc3VsdCA6IFN0cmluZyhyZXN1bHQpLA0KICAgICAgICAgICAgZGF0YTogcmVzdWx0LA0KICAgICAgICAgICAgYXJyYXk6IEFycmF5LmlzQXJyYXkocmVzdWx0KSA/IHJlc3VsdCA6IG51bGwsDQogICAgICAgICAgICBsZW5ndGg6IFN0cmluZyhyZXN1bHQpLmxlbmd0aCwNCiAgICAgICAgICAgIHdvcmRfY291bnQ6IFN0cmluZyhyZXN1bHQpLnRyaW0oKS5zcGxpdCgvXHMrLykuZmlsdGVyKHdvcmQgPT4gd29yZC5sZW5ndGggPiAwKS5sZW5ndGgNCiAgICAgICAgfTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdTdHJpbmcgb3BlcmF0aW9uIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHJlc3VsdDogJycsDQogICAgICAgICAgICBkYXRhOiAnJywNCiAgICAgICAgICAgIGFycmF5OiBudWxsLA0KICAgICAgICAgICAgbGVuZ3RoOiAwLA0KICAgICAgICAgICAgd29yZF9jb3VudDogMCwNCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gZXNjYXBlIHJlZ2V4IHNwZWNpYWwgY2hhcmFjdGVycw0KZnVuY3Rpb24gZXNjYXBlUmVnZXgoc3RyaW5nKSB7DQogICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC9bLiorP14ke30oKXxbXF1cXF0vZywgJ1xcJCYnKTsNCn0NCg0KLy8gTm9kZSBSZWZlcmVuY2UgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZU5vZGVSZWZlcmVuY2VOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IHNvdXJjZU5vZGVJZCA9IG5vZGUuY29uZmlnLnNvdXJjZV9ub2RlX2lkLnZhbHVlOw0KICAgIGNvbnN0IG91dHB1dFBvcnRJZCA9IG5vZGUuY29uZmlnLm91dHB1dF9wb3J0X2lkLnZhbHVlOw0KICAgIGNvbnN0IGZhbGxiYWNrVmFsdWUgPSBub2RlLmNvbmZpZy5mYWxsYmFja192YWx1ZS52YWx1ZSB8fCBudWxsOw0KDQogICAgLy8gVmFsaWRhdGUgaW5wdXRzDQogICAgaWYgKCFzb3VyY2VOb2RlSWQpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCdOb2RlIFJlZmVyZW5jZTogTm8gc291cmNlIG5vZGUgc2VsZWN0ZWQnKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGRhdGE6IGZhbGxiYWNrVmFsdWUsDQogICAgICAgICAgICB0ZXh0OiBTdHJpbmcoZmFsbGJhY2tWYWx1ZSB8fCAnJyksDQogICAgICAgICAgICBqc29uOiBmYWxsYmFja1ZhbHVlLA0KICAgICAgICAgICAgbnVtYmVyOiBpc05hTihOdW1iZXIoZmFsbGJhY2tWYWx1ZSkpID8gMCA6IE51bWJlcihmYWxsYmFja1ZhbHVlKSwNCiAgICAgICAgICAgIGJvb2xlYW46IEJvb2xlYW4oZmFsbGJhY2tWYWx1ZSksDQogICAgICAgICAgICBiaW5hcnk6IG51bGwsDQogICAgICAgICAgICBvcmlnaW5hbDogZmFsbGJhY2tWYWx1ZSwNCiAgICAgICAgICAgIGVycm9yOiAnTm8gc291cmNlIG5vZGUgc2VsZWN0ZWQnDQogICAgICAgIH07DQogICAgfQ0KDQogICAgaWYgKCFvdXRwdXRQb3J0SWQpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCdOb2RlIFJlZmVyZW5jZTogTm8gb3V0cHV0IHBvcnQgc2VsZWN0ZWQnKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGRhdGE6IGZhbGxiYWNrVmFsdWUsDQogICAgICAgICAgICB0ZXh0OiBTdHJpbmcoZmFsbGJhY2tWYWx1ZSB8fCAnJyksDQogICAgICAgICAgICBqc29uOiBmYWxsYmFja1ZhbHVlLA0KICAgICAgICAgICAgbnVtYmVyOiBpc05hTihOdW1iZXIoZmFsbGJhY2tWYWx1ZSkpID8gMCA6IE51bWJlcihmYWxsYmFja1ZhbHVlKSwNCiAgICAgICAgICAgIGJvb2xlYW46IEJvb2xlYW4oZmFsbGJhY2tWYWx1ZSksDQogICAgICAgICAgICBiaW5hcnk6IG51bGwsDQogICAgICAgICAgICBvcmlnaW5hbDogZmFsbGJhY2tWYWx1ZSwNCiAgICAgICAgICAgIGVycm9yOiAnTm8gb3V0cHV0IHBvcnQgc2VsZWN0ZWQnDQogICAgICAgIH07DQogICAgfQ0KDQogICAgdHJ5IHsNCiAgICAgICAgLy8gR2V0IHRoZSByZWZlcmVuY2VkIGRhdGEgdXNpbmcgdGhlIGV4aXN0aW5nIGZ1bmN0aW9uDQogICAgICAgIGNvbnN0IHJlZmVyZW5jZWREYXRhID0gZ2V0T3V0cHV0UG9ydERhdGEoc291cmNlTm9kZUlkLCBvdXRwdXRQb3J0SWQpOw0KICAgICAgICANCiAgICAgICAgaWYgKHJlZmVyZW5jZWREYXRhID09PSBudWxsIHx8IHJlZmVyZW5jZWREYXRhID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGNvbnNvbGUud2FybihgTm9kZSBSZWZlcmVuY2U6IE5vIGRhdGEgZm91bmQgZm9yIG5vZGUgJHtzb3VyY2VOb2RlSWR9LCBwb3J0ICR7b3V0cHV0UG9ydElkfWApOw0KICAgICAgICAgICAgY29uc3QgZmFsbGJhY2sgPSBmYWxsYmFja1ZhbHVlICE9PSAnJyA/IGZhbGxiYWNrVmFsdWUgOiBudWxsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIGRhdGE6IGZhbGxiYWNrLA0KICAgICAgICAgICAgICAgIHRleHQ6IFN0cmluZyhmYWxsYmFjayB8fCAnJyksDQogICAgICAgICAgICAgICAganNvbjogZmFsbGJhY2ssDQogICAgICAgICAgICAgICAgbnVtYmVyOiBpc05hTihOdW1iZXIoZmFsbGJhY2spKSA/IDAgOiBOdW1iZXIoZmFsbGJhY2spLA0KICAgICAgICAgICAgICAgIGJvb2xlYW46IEJvb2xlYW4oZmFsbGJhY2spLA0KICAgICAgICAgICAgICAgIGJpbmFyeTogbnVsbCwNCiAgICAgICAgICAgICAgICBvcmlnaW5hbDogZmFsbGJhY2ssDQogICAgICAgICAgICAgICAgZXJyb3I6IGBObyBkYXRhIGZvdW5kIGZvciBub2RlICR7c291cmNlTm9kZUlkfSwgcG9ydCAke291dHB1dFBvcnRJZH1gDQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU3VjY2Vzc2Z1bGx5IGdvdCB0aGUgZGF0YSAtIGZvcm1hdCBpdCBmb3IgYWxsIG91dHB1dCB0eXBlcw0KICAgICAgICBsZXQgdGV4dFZhbHVlID0gU3RyaW5nKHJlZmVyZW5jZWREYXRhKTsNCiAgICAgICAgbGV0IGpzb25WYWx1ZSA9IHJlZmVyZW5jZWREYXRhOw0KICAgICAgICBsZXQgbnVtYmVyVmFsdWUgPSAwOw0KICAgICAgICBsZXQgYm9vbGVhblZhbHVlID0gQm9vbGVhbihyZWZlcmVuY2VkRGF0YSk7DQoNCiAgICAgICAgLy8gSGFuZGxlIGRpZmZlcmVudCBkYXRhIHR5cGVzIGFwcHJvcHJpYXRlbHkNCiAgICAgICAgaWYgKHR5cGVvZiByZWZlcmVuY2VkRGF0YSA9PT0gJ251bWJlcicpIHsNCiAgICAgICAgICAgIG51bWJlclZhbHVlID0gcmVmZXJlbmNlZERhdGE7DQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHJlZmVyZW5jZWREYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gTnVtYmVyKHJlZmVyZW5jZWREYXRhKTsNCiAgICAgICAgICAgIG51bWJlclZhbHVlID0gaXNOYU4ocGFyc2VkKSA/IDAgOiBwYXJzZWQ7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBGb3IgSlNPTiBvdXRwdXQsIHRyeSB0byBwcmVzZXJ2ZSBvYmplY3Qgc3RydWN0dXJlDQogICAgICAgIGlmICh0eXBlb2YgcmVmZXJlbmNlZERhdGEgPT09ICdvYmplY3QnKSB7DQogICAgICAgICAgICBqc29uVmFsdWUgPSByZWZlcmVuY2VkRGF0YTsNCiAgICAgICAgICAgIHRleHRWYWx1ZSA9IEpTT04uc3RyaW5naWZ5KHJlZmVyZW5jZWREYXRhLCBudWxsLCAyKTsNCiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcmVmZXJlbmNlZERhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBKU09ODQogICAgICAgICAgICAgICAganNvblZhbHVlID0gSlNPTi5wYXJzZShyZWZlcmVuY2VkRGF0YSk7DQogICAgICAgICAgICB9IGNhdGNoIHsNCiAgICAgICAgICAgICAgICAvLyBOb3QgdmFsaWQgSlNPTiwga2VlcCBhcyBzdHJpbmcNCiAgICAgICAgICAgICAgICBqc29uVmFsdWUgPSByZWZlcmVuY2VkRGF0YTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGNvbnNvbGUubG9nKGBOb2RlIFJlZmVyZW5jZTogU3VjY2Vzc2Z1bGx5IHJldHJpZXZlZCBkYXRhIGZyb20gJHtzb3VyY2VOb2RlSWR9LiR7b3V0cHV0UG9ydElkfTpgLCByZWZlcmVuY2VkRGF0YSk7DQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGRhdGE6IHJlZmVyZW5jZWREYXRhLA0KICAgICAgICAgICAgdGV4dDogdGV4dFZhbHVlLA0KICAgICAgICAgICAganNvbjoganNvblZhbHVlLA0KICAgICAgICAgICAgbnVtYmVyOiBudW1iZXJWYWx1ZSwNCiAgICAgICAgICAgIGJvb2xlYW46IGJvb2xlYW5WYWx1ZSwNCiAgICAgICAgICAgIGJpbmFyeTogKHJlZmVyZW5jZWREYXRhIGluc3RhbmNlb2YgQmxvYiB8fCByZWZlcmVuY2VkRGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSA/IHJlZmVyZW5jZWREYXRhIDogbnVsbCwNCiAgICAgICAgICAgIG9yaWdpbmFsOiByZWZlcmVuY2VkRGF0YQ0KICAgICAgICB9Ow0KDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTm9kZSBSZWZlcmVuY2UgZXhlY3V0aW9uIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgY29uc3QgZmFsbGJhY2sgPSBmYWxsYmFja1ZhbHVlICE9PSAnJyA/IGZhbGxiYWNrVmFsdWUgOiBudWxsOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGRhdGE6IGZhbGxiYWNrLA0KICAgICAgICAgICAgdGV4dDogU3RyaW5nKGZhbGxiYWNrIHx8ICcnKSwNCiAgICAgICAgICAgIGpzb246IGZhbGxiYWNrLA0KICAgICAgICAgICAgbnVtYmVyOiBpc05hTihOdW1iZXIoZmFsbGJhY2spKSA/IDAgOiBOdW1iZXIoZmFsbGJhY2spLA0KICAgICAgICAgICAgYm9vbGVhbjogQm9vbGVhbihmYWxsYmFjayksDQogICAgICAgICAgICBiaW5hcnk6IG51bGwsDQogICAgICAgICAgICBvcmlnaW5hbDogZmFsbGJhY2ssDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gUmFuZG9tIE51bWJlciBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlUmFuZG9tTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBtaW5WYWx1ZSA9IHBhcnNlRmxvYXQobm9kZS5jb25maWcubWluX3ZhbHVlLnZhbHVlKSB8fCAwOw0KICAgIGNvbnN0IG1heFZhbHVlID0gcGFyc2VGbG9hdChub2RlLmNvbmZpZy5tYXhfdmFsdWUudmFsdWUpIHx8IDEwMDsNCiAgICBjb25zdCBkZWNpbWFsUGxhY2VzID0gcGFyc2VJbnQobm9kZS5jb25maWcuZGVjaW1hbF9wbGFjZXMudmFsdWUpIHx8IDA7DQogICAgY29uc3Qgb3V0cHV0VHlwZSA9IG5vZGUuY29uZmlnLm91dHB1dF90eXBlLnZhbHVlIHx8ICdpbnRlZ2VyJzsNCg0KICAgIC8vIFZhbGlkYXRlIHJhbmdlDQogICAgaWYgKG1pblZhbHVlID49IG1heFZhbHVlKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JhbmRvbTogTWluaW11bSB2YWx1ZSBtdXN0IGJlIGxlc3MgdGhhbiBtYXhpbXVtIHZhbHVlJyk7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBudW1iZXI6IDAsDQogICAgICAgICAgICB0ZXh0OiAnMCcsDQogICAgICAgICAgICBkYXRhOiAnMCcsDQogICAgICAgICAgICBpbnRlZ2VyOiAwLA0KICAgICAgICAgICAgZmxvYXQ6IDAuMCwNCiAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCByYW5nZTogbWluaW11bSBtdXN0IGJlIGxlc3MgdGhhbiBtYXhpbXVtJw0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgIHRyeSB7DQogICAgICAgIC8vIEdlbmVyYXRlIHJhbmRvbSBudW1iZXIgYmV0d2VlbiBtaW4gYW5kIG1heA0KICAgICAgICBsZXQgcmFuZG9tVmFsdWUgPSBNYXRoLnJhbmRvbSgpICogKG1heFZhbHVlIC0gbWluVmFsdWUpICsgbWluVmFsdWU7DQoNCiAgICAgICAgLy8gQXBwbHkgb3V0cHV0IHR5cGUgYW5kIGRlY2ltYWwgcGxhY2VzDQogICAgICAgIGlmIChvdXRwdXRUeXBlID09PSAnaW50ZWdlcicgfHwgZGVjaW1hbFBsYWNlcyA9PT0gMCkgew0KICAgICAgICAgICAgcmFuZG9tVmFsdWUgPSBNYXRoLnJvdW5kKHJhbmRvbVZhbHVlKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJhbmRvbVZhbHVlID0gcGFyc2VGbG9hdChyYW5kb21WYWx1ZS50b0ZpeGVkKGRlY2ltYWxQbGFjZXMpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBub2RlLmxhc3RSYW5kb21WYWx1ZSA9IHJhbmRvbVZhbHVlOw0KICAgICAgICBub2RlLmxhc3RSYW5nZSA9IGAke21pblZhbHVlfSAtICR7bWF4VmFsdWV9YDsNCiAgICAgICAgbm9kZS5sYXN0T3V0cHV0VHlwZSA9IG91dHB1dFR5cGU7DQoNCiAgICAgICAgY29uc29sZS5sb2coYFJhbmRvbTogR2VuZXJhdGVkICR7cmFuZG9tVmFsdWV9ICgke291dHB1dFR5cGV9KSBpbiByYW5nZSAke21pblZhbHVlfS0ke21heFZhbHVlfWApOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBudW1iZXI6IHJhbmRvbVZhbHVlLA0KICAgICAgICAgICAgdGV4dDogU3RyaW5nKHJhbmRvbVZhbHVlKSwgLy8gQ29udmVydCB0byBzdHJpbmcgZm9yIFZGUyBjb21wYXRpYmlsaXR5DQogICAgICAgICAgICBkYXRhOiBTdHJpbmcocmFuZG9tVmFsdWUpLCAvLyBDb252ZXJ0IHRvIHN0cmluZyBmb3IgVkZTIGNvbXBhdGliaWxpdHkgIA0KICAgICAgICAgICAgaW50ZWdlcjogTWF0aC5yb3VuZChyYW5kb21WYWx1ZSksDQogICAgICAgICAgICBmbG9hdDogcGFyc2VGbG9hdChyYW5kb21WYWx1ZS50b0ZpeGVkKE1hdGgubWF4KGRlY2ltYWxQbGFjZXMsIDEpKSkNCiAgICAgICAgfTsNCg0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JhbmRvbSBleGVjdXRpb24gZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgbnVtYmVyOiAwLA0KICAgICAgICAgICAgdGV4dDogJzAnLA0KICAgICAgICAgICAgZGF0YTogJzAnLA0KICAgICAgICAgICAgaW50ZWdlcjogMCwNCiAgICAgICAgICAgIGZsb2F0OiAwLjAsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gRXhwb3J0IHRvIGdsb2JhbCBzY29wZQ0Kd2luZG93LmRhdGFFeGVjdXRvcnMgPSB7DQogICAgZXhlY3V0ZVRleHROb2RlLA0KICAgIGV4ZWN1dGVKc29uRXh0cmFjdE5vZGUsDQogICAgZXhlY3V0ZVJhbmRvbVF1b3RlTm9kZSwNCiAgICBleGVjdXRlTWF0aE5vZGUsDQogICAgZXhlY3V0ZUFycmF5Tm9kZSwNCiAgICBleGVjdXRlU3RyaW5nTm9kZSwNCiAgICBleGVjdXRlTm9kZVJlZmVyZW5jZU5vZGUsDQogICAgZXhlY3V0ZVJhbmRvbU5vZGUNCn07DQoNCg0KLy8gSFRUUCBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlSHR0cE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgdXJsID0gbm9kZS5jb25maWcudXJsLnZhbHVlOw0KICAgIGNvbnN0IG1ldGhvZCA9IG5vZGUuY29uZmlnLm1ldGhvZC52YWx1ZTsNCiAgICBjb25zdCBoZWFkZXJzID0gSlNPTi5wYXJzZShub2RlLmNvbmZpZy5oZWFkZXJzLnZhbHVlIHx8ICd7fScpOw0KICAgIGNvbnN0IGJvZHkgPSBub2RlLmNvbmZpZy5ib2R5LnZhbHVlOw0KICAgIGNvbnN0IHVzZVRlbXBsYXRlID0gdHJ1ZTsgLy8gQWx3YXlzIGVuYWJsZSB0ZW1wbGF0ZSBwcm9jZXNzaW5nDQoNCiAgICBsZXQgcHJvY2Vzc2VkQm9keSA9IGJvZHk7DQoNCiAgICBjb25zb2xlLmxvZygnSFRUUCBOb2RlIERlYnVnOicsIHsNCiAgICAgICAgaW5wdXREYXRhOiBpbnB1dERhdGEsDQogICAgICAgIG9yaWdpbmFsQm9keTogYm9keSwNCiAgICAgICAgdXNlVGVtcGxhdGU6IHVzZVRlbXBsYXRlDQogICAgfSk7DQoNCiAgICAvLyBQcm9jZXNzIHRlbXBsYXRlcyBmaXJzdCBvbiB0aGUgc3RyaW5nIGJvZHkNCiAgICBpZiAodXNlVGVtcGxhdGUgJiYgaW5wdXREYXRhKSB7DQogICAgICAgIHByb2Nlc3NlZEJvZHkgPSB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLnByb2Nlc3NUZW1wbGF0ZXMocHJvY2Vzc2VkQm9keSwgaW5wdXREYXRhKTsNCiAgICAgICAgY29uc29sZS5sb2coJ0hUVFAgTm9kZSBUZW1wbGF0ZSBQcm9jZXNzaW5nOicsIHsNCiAgICAgICAgICAgIG9yaWdpbmFsQm9keTogYm9keSwNCiAgICAgICAgICAgIHByb2Nlc3NlZEJvZHk6IHByb2Nlc3NlZEJvZHksDQogICAgICAgICAgICBpbnB1dERhdGE6IGlucHV0RGF0YQ0KICAgICAgICB9KTsNCiAgICB9DQoNCiAgICAvLyBUaGVuIHBhcnNlIGFzIEpTT04gaWYgaXQncyBhIHN0cmluZyBhbmQgbG9va3MgbGlrZSBKU09ODQogICAgaWYgKHR5cGVvZiBwcm9jZXNzZWRCb2R5ID09PSAnc3RyaW5nJyAmJiBwcm9jZXNzZWRCb2R5LnRyaW0oKS5zdGFydHNXaXRoKCd7JykpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHByb2Nlc3NlZEJvZHkgPSBKU09OLnBhcnNlKHByb2Nlc3NlZEJvZHkpOw0KICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBwYXJzZSBib2R5IGFzIEpTT04sIHVzaW5nIGFzIHN0cmluZzonLCBlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIFVzZSBPUyBwcm94eSB0byBieXBhc3MgQ09SUw0KICAgIGNvbnN0IHByb3h5UmVxdWVzdCA9IHsNCiAgICAgICAgdXJsOiB1cmwsDQogICAgICAgIG1ldGhvZDogbWV0aG9kLA0KICAgICAgICBoZWFkZXJzOiBoZWFkZXJzLA0KICAgICAgICBib2R5OiBwcm9jZXNzZWRCb2R5LA0KICAgICAgICB0aW1lb3V0OiAzMA0KICAgIH07DQoNCg0KICAgIGNvbnN0IHByb3h5UmVzcG9uc2UgPSBhd2FpdCBzeXBuZXhBUEkucHJveHlIVFRQKHByb3h5UmVxdWVzdCk7DQoNCiAgICBpZiAoIXByb3h5UmVzcG9uc2UgfHwgcHJveHlSZXNwb25zZS5zdGF0dXMgPCAyMDAgfHwgcHJveHlSZXNwb25zZS5zdGF0dXMgPj0gMzAwKSB7DQogICAgICAgIHRocm93IG5ldyBFcnJvcihgUHJveHkgcmVxdWVzdCBmYWlsZWQ6ICR7cHJveHlSZXNwb25zZT8uc3RhdHVzIHx8ICdVbmtub3duIGVycm9yJ31gKTsNCiAgICB9DQoNCiAgICBjb25zdCBwcm94eURhdGEgPSBwcm94eVJlc3BvbnNlOw0KDQogICAgaWYgKHByb3h5RGF0YS5lcnJvcikgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgcmVxdWVzdCBmYWlsZWQ6ICR7cHJveHlEYXRhLmVycm9yfWApOw0KICAgIH0NCg0KICAgIC8vIENoZWNrIGlmIHJlc3BvbnNlIGlzIGJpbmFyeSAoYXVkaW8sIGltYWdlLCBldGMuKQ0KICAgIGlmIChwcm94eURhdGEuaXNfYmluYXJ5KSB7DQoNCiAgICAgICAgLy8gQ29udmVydCBiYXNlNjQgY29udGVudCB0byBibG9iIGZvciBiaW5hcnkgZGF0YQ0KICAgICAgICBjb25zdCBiaW5hcnlEYXRhID0gYXRvYihwcm94eURhdGEuY29udGVudCk7DQogICAgICAgIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYmluYXJ5RGF0YS5sZW5ndGgpOw0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJpbmFyeURhdGEubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGJ5dGVzW2ldID0gYmluYXJ5RGF0YS5jaGFyQ29kZUF0KGkpOw0KICAgICAgICB9DQogICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gcHJveHlEYXRhLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddIHx8IHByb3h5RGF0YS5oZWFkZXJzWydDb250ZW50LVR5cGUnXSB8fCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJzsNCiAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtieXRlc10sIHsgdHlwZTogY29udGVudFR5cGUgfSk7DQoNCiAgICAgICAgLy8gUmV0dXJuIHN0cnVjdHVyZWQgb3V0cHV0IGZvciBiaW5hcnkgcmVzcG9uc2VzIHdpdGggYWxsIHBvcnRzDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBvcmlnaW5hbF9kYXRhOiBibG9iLA0KICAgICAgICAgICAgcHJvY2Vzc2VkX2RhdGE6IGJsb2IsDQogICAgICAgICAgICByZXNwb25zZTogYmxvYiwNCiAgICAgICAgICAgIHN0YXR1c19jb2RlOiBwcm94eURhdGEuc3RhdHVzIHx8IDIwMCwNCiAgICAgICAgICAgIGhlYWRlcnM6IHByb3h5RGF0YS5oZWFkZXJzIHx8IHt9LA0KICAgICAgICAgICAgcGFyc2VkX2pzb246IG51bGwsDQogICAgICAgICAgICAvLyBBbHNvIHByb3ZpZGUgdGhlIHJhdyByZXNwb25zZSBhcyAnZGF0YScgZm9yIGNvbXBhdGliaWxpdHkNCiAgICAgICAgICAgIGRhdGE6IGJsb2IsDQogICAgICAgICAgICAvLyBBZGQgdGhlIG1pc3Npbmcgb3V0cHV0IHBvcnRzIGZyb20gbm9kZSBkZWZpbml0aW9uDQogICAgICAgICAgICB0ZXh0OiBudWxsLA0KICAgICAgICAgICAganNvbjogbnVsbCwNCiAgICAgICAgICAgIHVybDogdXJsLA0KICAgICAgICAgICAgYmluYXJ5OiBieXRlcywgIC8vIFJhdyBiaW5hcnkgZGF0YSBhcyBVaW50OEFycmF5DQogICAgICAgICAgICBibG9iOiBibG9iICAgICAgLy8gQmxvYiBvYmplY3QgZm9yIGNvbXBhdGliaWxpdHkNCiAgICAgICAgfTsNCiAgICB9DQoNCiAgICAvLyBGb3IgdGV4dCByZXNwb25zZXMsIHRyeSB0byBwYXJzZSBhcyBKU09OIGFuZCByZXR1cm4gc3RydWN0dXJlZCBvdXRwdXQNCg0KICAgIGxldCBwYXJzZWRKc29uID0gbnVsbDsNCiAgICB0cnkgew0KICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgSlNPTg0KICAgICAgICBwYXJzZWRKc29uID0gSlNPTi5wYXJzZShwcm94eURhdGEuY29udGVudCk7DQogICAgfSBjYXRjaCAoZSkgew0KICAgIH0NCg0KICAgIC8vIFJldHVybiBzdHJ1Y3R1cmVkIG91dHB1dCBmb3IgdGV4dCByZXNwb25zZXMgbWF0Y2hpbmcgbmV3IG5vZGUgYXJjaGl0ZWN0dXJlDQogICAgcmV0dXJuIHsNCiAgICAgICAgb3JpZ2luYWxfZGF0YTogcHJveHlEYXRhLmNvbnRlbnQsDQogICAgICAgIHByb2Nlc3NlZF9kYXRhOiBwYXJzZWRKc29uIHx8IHByb3h5RGF0YS5jb250ZW50LA0KICAgICAgICByZXNwb25zZTogcHJveHlEYXRhLmNvbnRlbnQsDQogICAgICAgIHN0YXR1c19jb2RlOiBwcm94eURhdGEuc3RhdHVzIHx8IDIwMCwNCiAgICAgICAgaGVhZGVyczogcHJveHlEYXRhLmhlYWRlcnMgfHwge30sDQogICAgICAgIHBhcnNlZF9qc29uOiBwYXJzZWRKc29uLA0KICAgICAgICAvLyBBbHNvIHByb3ZpZGUgdGhlIHJhdyByZXNwb25zZSBhcyAnZGF0YScgZm9yIGNvbXBhdGliaWxpdHkNCiAgICAgICAgZGF0YTogcHJveHlEYXRhLmNvbnRlbnQsDQogICAgICAgIC8vIEFkZCB0aGUgbWlzc2luZyBvdXRwdXQgcG9ydHMgZnJvbSBub2RlIGRlZmluaXRpb24NCiAgICAgICAgdGV4dDogcHJveHlEYXRhLmNvbnRlbnQsDQogICAgICAgIGpzb246IHBhcnNlZEpzb24sDQogICAgICAgIHVybDogdXJsDQogICAgfTsNCn0NCg0KLy8gVkZTIExvYWQgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVZmc0xvYWROb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGxldCBmaWxlUGF0aCA9IG5vZGUuY29uZmlnLmZpbGVfcGF0aC52YWx1ZTsNCiAgICBjb25zdCBmb3JtYXQgPSBub2RlLmNvbmZpZy5mb3JtYXQudmFsdWU7DQoNCiAgICAvLyBQcm9jZXNzIHRlbXBsYXRlIHZhcmlhYmxlcyBpbiBmaWxlIHBhdGgNCiAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgY29uc3QgZGF0ZVRlbXBsYXRlcyA9IHsNCiAgICAgICAgJ3t7REFURX19JzogY3VycmVudERhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdLCAvLyBZWVlZLU1NLUREDQogICAgICAgICd7e1lZWVl9fSc6IGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKSwNCiAgICAgICAgJ3t7TU19fSc6IChjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpLA0KICAgICAgICAne3tERH19JzogY3VycmVudERhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSwNCiAgICAgICAgJ3t7VElNRVNUQU1QfX0nOiBjdXJyZW50RGF0ZS5nZXRUaW1lKCkudG9TdHJpbmcoKSwNCiAgICAgICAgJ3t7SVNPX0RBVEV9fSc6IGN1cnJlbnREYXRlLnRvSVNPU3RyaW5nKCkNCiAgICB9Ow0KDQogICAgLy8gUmVwbGFjZSBhbGwgdGVtcGxhdGUgdmFyaWFibGVzIHVzaW5nIHNpbXBsZSBzdHJpbmcgcmVwbGFjZW1lbnQNCiAgICBmb3IgKGNvbnN0IFt0ZW1wbGF0ZSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGVUZW1wbGF0ZXMpKSB7DQogICAgICAgIGZpbGVQYXRoID0gZmlsZVBhdGgucmVwbGFjZUFsbCh0ZW1wbGF0ZSwgdmFsdWUpOw0KICAgIH0NCg0KDQogICAgdHJ5IHsNCiAgICAgICAgbGV0IGRhdGEgPSBudWxsOw0KDQoNCiAgICAgICAgaWYgKGZvcm1hdCA9PT0gJ2pzb24nKSB7DQogICAgICAgICAgICBkYXRhID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZUpTT04oZmlsZVBhdGgpOw0KICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ3RleHQnKSB7DQogICAgICAgICAgICBkYXRhID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZVRleHQoZmlsZVBhdGgpOw0KICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ2Jsb2InKSB7DQogICAgICAgICAgICAvLyBGb3IgYmxvYiBmb3JtYXQsIHJlYWQgYXMgdGV4dCAoZGF0YSBVUkxzIGFyZSBzdG9yZWQgYXMgdGV4dCkNCiAgICAgICAgICAgIGRhdGEgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlVGV4dChmaWxlUGF0aCk7DQogICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAnYmluYXJ5Jykgew0KICAgICAgICAgICAgLy8gRm9yIGJpbmFyeSBmaWxlcywgdXNlIHRoZSBuZXcgU3lwbmV4QVBJIG1ldGhvZCB0byBnZXQgQmxvYg0KICAgICAgICAgICAgZGF0YSA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVCbG9iKGZpbGVQYXRoKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biBmb3JtYXQ6ICcgKyBmb3JtYXQgKyAnLiBTdXBwb3J0ZWQgZm9ybWF0cyBhcmU6IGpzb24sIHRleHQsIGJsb2IsIGJpbmFyeScpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU3RvcmUgdGhlIGxvYWRlZCBkYXRhIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBub2RlLmxhc3RMb2FkZWRGaWxlID0gZmlsZVBhdGg7DQogICAgICAgIG5vZGUubGFzdExvYWRlZERhdGEgPSBkYXRhOw0KDQoNCiAgICAgICAgLy8gUmV0dXJuIHN0cnVjdHVyZWQgb3V0cHV0IHdpdGggYXBwcm9wcmlhdGUgcG9ydCBuYW1lcw0KICAgICAgICBjb25zdCByZXN1bHQgPSB7DQogICAgICAgICAgICBkYXRhOiBkYXRhLA0KICAgICAgICAgICAgZmlsZV9wYXRoOiBmaWxlUGF0aCwgIC8vIFJldHVybiB0aGUgYWN0dWFsIHByb2Nlc3NlZCBmaWxlIHBhdGggc3RyaW5nDQogICAgICAgICAgICBqc29uX2RhdGE6IGZvcm1hdCA9PT0gJ2pzb24nID8gZGF0YSA6IG51bGwNCiAgICAgICAgfTsNCiAgICAgICAgcmV0dXJuIHJlc3VsdDsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdWRlMgTG9hZCBlcnJvcjonLCB7DQogICAgICAgICAgICBvcmlnaW5hbFBhdGg6IG5vZGUuY29uZmlnLmZpbGVfcGF0aC52YWx1ZSwNCiAgICAgICAgICAgIHByb2Nlc3NlZFBhdGg6IGZpbGVQYXRoLA0KICAgICAgICAgICAgZm9ybWF0OiBmb3JtYXQsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSwNCiAgICAgICAgICAgIGVycm9yU3RhY2s6IGVycm9yLnN0YWNrDQogICAgICAgIH0pOw0KICAgICAgICByZXR1cm4geyBkYXRhOiBudWxsLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9Ow0KICAgIH0NCn0NCg0KDQovLyBWRlMgU2F2ZSBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlVmZzU2F2ZU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgZmlsZVBhdGggPSBub2RlLmNvbmZpZy5maWxlX3BhdGgudmFsdWU7DQogICAgY29uc3QgZm9ybWF0ID0gbm9kZS5jb25maWcuZm9ybWF0LnZhbHVlOw0KICAgIGNvbnN0IG92ZXJ3cml0ZSA9IG5vZGUuY29uZmlnLm92ZXJ3cml0ZS52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IGFwcGVuZCA9IG5vZGUuY29uZmlnLmFwcGVuZC52YWx1ZSA9PT0gJ3RydWUnOw0KDQogICAgdHJ5IHsNCiAgICAgICAgbGV0IGRhdGEgPSBpbnB1dERhdGEuZGF0YTsNCiAgICAgICAgbGV0IHN1Y2Nlc3MgPSBmYWxzZTsNCg0KICAgICAgICBjb25zb2xlLmxvZygnVkZTIFNhdmUgRGVidWc6Jywgew0KICAgICAgICAgICAgZmlsZVBhdGg6IGZpbGVQYXRoLA0KICAgICAgICAgICAgZm9ybWF0OiBmb3JtYXQsDQogICAgICAgICAgICBvdmVyd3JpdGU6IG92ZXJ3cml0ZSwNCiAgICAgICAgICAgIGFwcGVuZDogYXBwZW5kLA0KICAgICAgICAgICAgZGF0YVR5cGU6IHR5cGVvZiBkYXRhLA0KICAgICAgICAgICAgZGF0YTogZGF0YQ0KICAgICAgICB9KTsNCg0KICAgICAgICBpZiAoZm9ybWF0ID09PSAnanNvbicpIHsNCiAgICAgICAgICAgIC8vIEZvciBKU09OIGZvcm1hdCB3aXRoIGFwcGVuZCBtb2RlLCB3ZSBuZWVkIHRvIGhhbmRsZSBpdCBzcGVjaWFsbHkNCiAgICAgICAgICAgIGlmIChhcHBlbmQgJiYgIW92ZXJ3cml0ZSkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIC8vIFRyeSB0byByZWFkIGV4aXN0aW5nIGZpbGUgZmlyc3QNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdEYXRhID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZUpTT04oZmlsZVBhdGgpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShleGlzdGluZ0RhdGEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBleGlzdGluZyBkYXRhIGlzIGFuIGFycmF5LCBhcHBlbmQgdG8gaXQNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nRGF0YS5wdXNoKGRhdGEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGV4aXN0aW5nRGF0YTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIGV4aXN0aW5nIGRhdGEgaXMgbm90IGFuIGFycmF5LCBjcmVhdGUgYSBuZXcgYXJyYXkNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBbZXhpc3RpbmdEYXRhLCBkYXRhXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIEZpbGUgZG9lc24ndCBleGlzdCBvciBjYW4ndCBiZSByZWFkLCBjcmVhdGUgbmV3IGFycmF5DQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBbZGF0YV07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgc3VjY2VzcyA9IGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlSlNPTihmaWxlUGF0aCwgZGF0YSk7DQogICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAndGV4dCcpIHsNCiAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgICAgICAvLyBGb3IgdGV4dCBmb3JtYXQgd2l0aCBhcHBlbmQgbW9kZQ0KICAgICAgICAgICAgICAgIGlmIChhcHBlbmQgJiYgIW92ZXJ3cml0ZSkgew0KICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IHRvIHJlYWQgZXhpc3RpbmcgZmlsZSBmaXJzdA0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdUZXh0ID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZVRleHQoZmlsZVBhdGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGV4aXN0aW5nVGV4dCArICdcbicgKyBkYXRhOw0KICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmlsZSBkb2Vzbid0IGV4aXN0LCB1c2UgZGF0YSBhcy1pcw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZShmaWxlUGF0aCwgZGF0YSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGV4dCBmb3JtYXQgcmVxdWlyZXMgc3RyaW5nIGRhdGEsIHJlY2VpdmVkOiAnICsgdHlwZW9mIGRhdGEgKyAnLiBVc2UgSlNPTiBmb3JtYXQgZm9yIG9iamVjdHMuJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAnYmluYXJ5Jykgew0KICAgICAgICAgICAgLy8gSGFuZGxlIGJpbmFyeSBkYXRhIHByb3Blcmx5IHVzaW5nIHRoZSBiaW5hcnkgdXBsb2FkIGVuZHBvaW50DQogICAgICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHsNCiAgICAgICAgICAgICAgICAvLyBVc2UgdGhlIGJpbmFyeSB1cGxvYWQgbWV0aG9kIGZvciByYXcgYmluYXJ5IGRhdGENCiAgICAgICAgICAgICAgICBzdWNjZXNzID0gYXdhaXQgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGVCaW5hcnkoZmlsZVBhdGgsIGRhdGEpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvLyBCaW5hcnkgZm9ybWF0IG9ubHkgc3VwcG9ydHMgVWludDhBcnJheSBmb3IgcmF3IGJpbmFyeSBkYXRhDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCaW5hcnkgZm9ybWF0IHJlcXVpcmVzIFVpbnQ4QXJyYXkgZGF0YSBmb3IgcmF3IGJpbmFyeSwgcmVjZWl2ZWQ6ICcgKyB0eXBlb2YgZGF0YSArICcuIFVzZSBibG9iIGZvcm1hdCBmb3IgQmxvYiBkYXRhLicpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ2Jsb2InKSB7DQogICAgICAgICAgICAvLyBIYW5kbGUgQmxvYiB0byBkYXRhIFVSTCBjb252ZXJzaW9uDQogICAgICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEJsb2IpIHsNCiAgICAgICAgICAgICAgICAvLyBDb252ZXJ0IEJsb2IgdG8gZGF0YSBVUkwNCiAgICAgICAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFVcmwgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7DQogICAgICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoKSA9PiByZXNvbHZlKHJlYWRlci5yZXN1bHQpOw0KICAgICAgICAgICAgICAgICAgICByZWFkZXIub25lcnJvciA9IHJlamVjdDsNCiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZGF0YSk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgc3VjY2VzcyA9IGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlKGZpbGVQYXRoLCBkYXRhVXJsKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCbG9iIGZvcm1hdCByZXF1aXJlcyBCbG9iIGRhdGEsIHJlY2VpdmVkOiAnICsgdHlwZW9mIGRhdGEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gVW5rbm93biBmb3JtYXQNCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biBmb3JtYXQ6ICcgKyBmb3JtYXQgKyAnLiBTdXBwb3J0ZWQgZm9ybWF0cyBhcmU6IGpzb24sIHRleHQsIGJpbmFyeSwgYmxvYicpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHsgc3VjY2Vzczogc3VjY2VzcyB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1ZGUyBTYXZlIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07DQogICAgfQ0KfQ0KDQovLyBWRlMgRGlyZWN0b3J5IExpc3QgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVZmc0RpcmVjdG9yeUxpc3ROb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGxldCBkaXJlY3RvcnlQYXRoID0gbm9kZS5jb25maWcuZGlyZWN0b3J5X3BhdGgudmFsdWU7DQogICAgY29uc3QgZmlsdGVyRXh0ZW5zaW9ucyA9IG5vZGUuY29uZmlnLmZpbHRlcl9leHRlbnNpb25zLnZhbHVlOw0KICAgIGNvbnN0IGluY2x1ZGVEaXJlY3RvcmllcyA9IG5vZGUuY29uZmlnLmluY2x1ZGVfZGlyZWN0b3JpZXMudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCByZWN1cnNpdmUgPSBub2RlLmNvbmZpZy5yZWN1cnNpdmUudmFsdWUgPT09ICd0cnVlJzsNCg0KICAgIC8vIERlYnVnIGxvZ2dpbmcNCiAgICBjb25zb2xlLmxvZygnVkZTIERpcmVjdG9yeSBMaXN0IERlYnVnOicsIHsNCiAgICAgICAgY29uZmlnVmFsdWU6IG5vZGUuY29uZmlnLmRpcmVjdG9yeV9wYXRoLnZhbHVlLA0KICAgICAgICBpbnB1dERhdGE6IGlucHV0RGF0YSwNCiAgICAgICAgaW5pdGlhbERpcmVjdG9yeVBhdGg6IGRpcmVjdG9yeVBhdGgNCiAgICB9KTsNCg0KICAgIC8vIFVzZSBpbnB1dCBwYXRoIGlmIHByb3ZpZGVkLCBvdGhlcndpc2UgdXNlIGNvbmZpZw0KICAgIGlmIChpbnB1dERhdGEgJiYgaW5wdXREYXRhLmRpcmVjdG9yeV9wYXRoKSB7DQogICAgICAgIGRpcmVjdG9yeVBhdGggPSBpbnB1dERhdGEuZGlyZWN0b3J5X3BhdGg7DQogICAgICAgIGNvbnNvbGUubG9nKCdVc2luZyBpbnB1dCBkaXJlY3RvcnkgcGF0aDonLCBkaXJlY3RvcnlQYXRoKTsNCiAgICB9DQoNCiAgICAvLyBFbnN1cmUgZGlyZWN0b3J5UGF0aCBpcyBhIHN0cmluZyBhbmQgbm90IGVtcHR5DQogICAgaWYgKHR5cGVvZiBkaXJlY3RvcnlQYXRoICE9PSAnc3RyaW5nJyB8fCAhZGlyZWN0b3J5UGF0aCkgew0KICAgICAgICBkaXJlY3RvcnlQYXRoID0gJy8nOw0KICAgICAgICBjb25zb2xlLmxvZygnUmVzZXQgZGlyZWN0b3J5IHBhdGggdG8gcm9vdDonLCBkaXJlY3RvcnlQYXRoKTsNCiAgICB9DQoNCiAgICAvLyBQcm9jZXNzIHRlbXBsYXRlIHZhcmlhYmxlcyBpbiBkaXJlY3RvcnkgcGF0aA0KICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTsNCiAgICBjb25zdCBkYXRlVGVtcGxhdGVzID0gew0KICAgICAgICAne3tEQVRFfX0nOiBjdXJyZW50RGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sDQogICAgICAgICd7e1lZWVl9fSc6IGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKSwNCiAgICAgICAgJ3t7TU19fSc6IChjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpLA0KICAgICAgICAne3tERH19JzogY3VycmVudERhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSwNCiAgICAgICAgJ3t7VElNRVNUQU1QfX0nOiBjdXJyZW50RGF0ZS5nZXRUaW1lKCkudG9TdHJpbmcoKSwNCiAgICAgICAgJ3t7SVNPX0RBVEV9fSc6IGN1cnJlbnREYXRlLnRvSVNPU3RyaW5nKCkNCiAgICB9Ow0KDQogICAgZm9yIChjb25zdCBbdGVtcGxhdGUsIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhkYXRlVGVtcGxhdGVzKSkgew0KICAgICAgICBkaXJlY3RvcnlQYXRoID0gZGlyZWN0b3J5UGF0aC5yZXBsYWNlQWxsKHRlbXBsYXRlLCB2YWx1ZSk7DQogICAgfQ0KDQogICAgY29uc29sZS5sb2coJ0ZpbmFsIGRpcmVjdG9yeSBwYXRoIGJlZm9yZSBBUEkgY2FsbDonLCBkaXJlY3RvcnlQYXRoKTsNCg0KICAgIHRyeSB7DQogICAgICAgIC8vIFVzZSB0aGUgZXhpc3Rpbmcgc3lwbmV4QVBJLmxpc3RWaXJ0dWFsRmlsZXMgbWV0aG9kDQogICAgICAgIGNvbnN0IGZpbGVMaXN0RGF0YSA9IGF3YWl0IHN5cG5leEFQSS5saXN0VmlydHVhbEZpbGVzKGRpcmVjdG9yeVBhdGgpOw0KICAgICAgICANCiAgICAgICAgaWYgKCFmaWxlTGlzdERhdGEgfHwgIWZpbGVMaXN0RGF0YS5pdGVtcykgew0KICAgICAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICAgICAgZXJyb3I6IGBEaXJlY3Rvcnkgbm90IGZvdW5kIG9yIGVtcHR5OiAke2RpcmVjdG9yeVBhdGh9YCwNCiAgICAgICAgICAgICAgICBmaWxlX2xpc3Q6IFtdLA0KICAgICAgICAgICAgICAgIGZpbGVfcGF0aHM6IFtdLA0KICAgICAgICAgICAgICAgIGZpbGVfbmFtZXM6IFtdLA0KICAgICAgICAgICAgICAgIGNvdW50OiAwLA0KICAgICAgICAgICAgICAgIGRpcmVjdG9yaWVzOiBbXSwNCiAgICAgICAgICAgICAgICBmaWxlc19vbmx5OiBbXQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KDQogICAgICAgIGxldCBhbGxJdGVtcyA9IGZpbGVMaXN0RGF0YS5pdGVtczsNCiAgICAgICAgDQogICAgICAgIC8vIEhhbmRsZSByZWN1cnNpdmUgbGlzdGluZyBpZiBlbmFibGVkDQogICAgICAgIGlmIChyZWN1cnNpdmUpIHsNCiAgICAgICAgICAgIGNvbnN0IGdldEFsbEZpbGVzUmVjdXJzaXZlID0gYXN5bmMgKGl0ZW1zLCBiYXNlUGF0aCkgPT4gew0KICAgICAgICAgICAgICAgIGxldCBhbGxGaWxlcyA9IFtdOw0KICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykgew0KICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5pc19kaXJlY3RvcnkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1YlBhdGggPSBiYXNlUGF0aCArIChiYXNlUGF0aC5lbmRzV2l0aCgnLycpID8gJycgOiAnLycpICsgaXRlbS5uYW1lOw0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJEaXJEYXRhID0gYXdhaXQgc3lwbmV4QVBJLmxpc3RWaXJ0dWFsRmlsZXMoc3ViUGF0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YkRpckRhdGEgJiYgc3ViRGlyRGF0YS5pdGVtcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJGaWxlcyA9IGF3YWl0IGdldEFsbEZpbGVzUmVjdXJzaXZlKHN1YkRpckRhdGEuaXRlbXMsIHN1YlBhdGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxGaWxlcyA9IGFsbEZpbGVzLmNvbmNhdChzdWJGaWxlcyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBDb3VsZCBub3QgcmVhZCBzdWJkaXJlY3RvcnkgJHtzdWJQYXRofTpgLCBlcnIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGFsbEZpbGVzLnB1c2goey4uLml0ZW0sIGZ1bGxQYXRoOiBiYXNlUGF0aCArIChiYXNlUGF0aC5lbmRzV2l0aCgnLycpID8gJycgOiAnLycpICsgaXRlbS5uYW1lfSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiBhbGxGaWxlczsNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICANCiAgICAgICAgICAgIGFsbEl0ZW1zID0gYXdhaXQgZ2V0QWxsRmlsZXNSZWN1cnNpdmUoYWxsSXRlbXMsIGRpcmVjdG9yeVBhdGgpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gQWRkIGZ1bGwgcGF0aCBmb3Igbm9uLXJlY3Vyc2l2ZQ0KICAgICAgICAgICAgYWxsSXRlbXMgPSBhbGxJdGVtcy5tYXAoaXRlbSA9PiAoew0KICAgICAgICAgICAgICAgIC4uLml0ZW0sIA0KICAgICAgICAgICAgICAgIGZ1bGxQYXRoOiBkaXJlY3RvcnlQYXRoICsgKGRpcmVjdG9yeVBhdGguZW5kc1dpdGgoJy8nKSA/ICcnIDogJy8nKSArIGl0ZW0ubmFtZQ0KICAgICAgICAgICAgfSkpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gRmlsdGVyIGJ5IGZpbGUgZXh0ZW5zaW9ucyBpZiBzcGVjaWZpZWQNCiAgICAgICAgbGV0IGZpbHRlcmVkSXRlbXMgPSBhbGxJdGVtczsNCiAgICAgICAgaWYgKGZpbHRlckV4dGVuc2lvbnMgJiYgZmlsdGVyRXh0ZW5zaW9ucy50cmltKCkpIHsNCiAgICAgICAgICAgIGNvbnN0IGV4dGVuc2lvbnMgPSBmaWx0ZXJFeHRlbnNpb25zLnNwbGl0KCcsJykubWFwKGV4dCA9PiBleHQudHJpbSgpLnRvTG93ZXJDYXNlKCkpOw0KICAgICAgICAgICAgZmlsdGVyZWRJdGVtcyA9IGFsbEl0ZW1zLmZpbHRlcihpdGVtID0+IHsNCiAgICAgICAgICAgICAgICAvLyBBbHdheXMgaW5jbHVkZSBkaXJlY3RvcmllcyBpZiBpbmNsdWRlRGlyZWN0b3JpZXMgaXMgdHJ1ZQ0KICAgICAgICAgICAgICAgIGlmIChpdGVtLmlzX2RpcmVjdG9yeSkgcmV0dXJuIGluY2x1ZGVEaXJlY3RvcmllczsNCiAgICAgICAgICAgICAgICAvLyBGb3IgZmlsZXMsIGNoZWNrIHRoZSBleHRlbnNpb24NCiAgICAgICAgICAgICAgICBjb25zdCBpdGVtRXh0ID0gaXRlbS5uYW1lLnNwbGl0KCcuJykucG9wKCk/LnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGV4dGVuc2lvbnMuaW5jbHVkZXMoaXRlbUV4dCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFeHRlbnNpb24gZmlsdGVyaW5nIGFwcGxpZWQ6Jywgew0KICAgICAgICAgICAgICAgIGV4dGVuc2lvbnM6IGV4dGVuc2lvbnMsDQogICAgICAgICAgICAgICAgYmVmb3JlRmlsdGVyOiBhbGxJdGVtcy5sZW5ndGgsDQogICAgICAgICAgICAgICAgYWZ0ZXJGaWx0ZXI6IGZpbHRlcmVkSXRlbXMubGVuZ3RoDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdObyBleHRlbnNpb24gZmlsdGVyaW5nIC0gcmV0dXJuaW5nIGFsbCBpdGVtcycpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU2VwYXJhdGUgZmlsZXMgYW5kIGRpcmVjdG9yaWVzDQogICAgICAgIGNvbnN0IGZpbGVzID0gZmlsdGVyZWRJdGVtcy5maWx0ZXIoaXRlbSA9PiAhaXRlbS5pc19kaXJlY3RvcnkpOw0KICAgICAgICBjb25zdCBkaXJlY3RvcmllcyA9IGZpbHRlcmVkSXRlbXMuZmlsdGVyKGl0ZW0gPT4gaXRlbS5pc19kaXJlY3RvcnkpOw0KICAgICAgICANCiAgICAgICAgLy8gQ3JlYXRlIG91dHB1dCBhcnJheXMNCiAgICAgICAgY29uc3QgZmlsZVBhdGhzID0gZmlsZXMubWFwKGZpbGUgPT4gZmlsZS5mdWxsUGF0aCk7DQogICAgICAgIGNvbnN0IGZpbGVOYW1lcyA9IGZpbGVzLm1hcChmaWxlID0+IGZpbGUubmFtZSk7DQogICAgICAgIGNvbnN0IGRpcmVjdG9yeVBhdGhzID0gZGlyZWN0b3JpZXMubWFwKGRpciA9PiBkaXIuZnVsbFBhdGgpOw0KDQogICAgICAgIC8vIEZpbmFsIGZpbGUgbGlzdCBiYXNlZCBvbiBpbmNsdWRlRGlyZWN0b3JpZXMgc2V0dGluZw0KICAgICAgICAvLyBJZiBpbmNsdWRlRGlyZWN0b3JpZXMgaXMgdHJ1ZSwgcmV0dXJuIGFsbCBmaWx0ZXJlZCBpdGVtcyAoZmlsZXMgKyBkaXJlY3RvcmllcykNCiAgICAgICAgLy8gSWYgaW5jbHVkZURpcmVjdG9yaWVzIGlzIGZhbHNlLCByZXR1cm4gb25seSBmaWxlcw0KICAgICAgICBjb25zdCBmaW5hbEZpbGVMaXN0ID0gaW5jbHVkZURpcmVjdG9yaWVzID8gZmlsdGVyZWRJdGVtcyA6IGZpbGVzOw0KDQogICAgICAgIGNvbnNvbGUubG9nKCdQcm9jZXNzaW5nIHJlc3VsdHM6Jywgew0KICAgICAgICAgICAgdG90YWxGaWx0ZXJlZEl0ZW1zOiBmaWx0ZXJlZEl0ZW1zLmxlbmd0aCwNCiAgICAgICAgICAgIGZpbGVzQ291bnQ6IGZpbGVzLmxlbmd0aCwNCiAgICAgICAgICAgIGRpcmVjdG9yaWVzQ291bnQ6IGRpcmVjdG9yaWVzLmxlbmd0aCwNCiAgICAgICAgICAgIGluY2x1ZGVEaXJlY3RvcmllczogaW5jbHVkZURpcmVjdG9yaWVzLA0KICAgICAgICAgICAgZmluYWxGaWxlTGlzdENvdW50OiBmaW5hbEZpbGVMaXN0Lmxlbmd0aA0KICAgICAgICB9KTsNCg0KICAgICAgICAvLyBTdG9yZSByZXN1bHRzIGZvciBjb25maWcgcGFuZWwgZGlzcGxheQ0KICAgICAgICBub2RlLmxhc3REaXJlY3RvcnlQYXRoID0gZGlyZWN0b3J5UGF0aDsNCiAgICAgICAgbm9kZS5sYXN0RmlsZUNvdW50ID0gZmluYWxGaWxlTGlzdC5sZW5ndGg7DQogICAgICAgIG5vZGUubGFzdEZpbGVMaXN0ID0gZmluYWxGaWxlTGlzdDsNCg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgZmlsZV9saXN0OiBmaW5hbEZpbGVMaXN0LA0KICAgICAgICAgICAgZmlsZV9wYXRoczogZmlsZVBhdGhzLA0KICAgICAgICAgICAgZmlsZV9uYW1lczogZmlsZU5hbWVzLA0KICAgICAgICAgICAgY291bnQ6IGZpbmFsRmlsZUxpc3QubGVuZ3RoLA0KICAgICAgICAgICAgZGlyZWN0b3JpZXM6IGRpcmVjdG9yeVBhdGhzLA0KICAgICAgICAgICAgZmlsZXNfb25seTogZmlsZXMNCiAgICAgICAgfTsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVkZTIERpcmVjdG9yeSBMaXN0IGVycm9yOicsIHsNCiAgICAgICAgICAgIGRpcmVjdG9yeVBhdGg6IGRpcmVjdG9yeVBhdGgsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSwNCiAgICAgICAgICAgIGVycm9yU3RhY2s6IGVycm9yLnN0YWNrDQogICAgICAgIH0pOw0KICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLA0KICAgICAgICAgICAgZmlsZV9saXN0OiBbXSwNCiAgICAgICAgICAgIGZpbGVfcGF0aHM6IFtdLA0KICAgICAgICAgICAgZmlsZV9uYW1lczogW10sDQogICAgICAgICAgICBjb3VudDogMCwNCiAgICAgICAgICAgIGRpcmVjdG9yaWVzOiBbXSwNCiAgICAgICAgICAgIGZpbGVzX29ubHk6IFtdDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQovLyBFeHBvcnQgdG8gZ2xvYmFsIHNjb3BlDQp3aW5kb3cuaHR0cEV4ZWN1dG9ycyA9IHsNCiAgICBleGVjdXRlSHR0cE5vZGUsDQogICAgZXhlY3V0ZVZmc0xvYWROb2RlLA0KICAgIGV4ZWN1dGVWZnNTYXZlTm9kZSwNCiAgICBleGVjdXRlVmZzRGlyZWN0b3J5TGlzdE5vZGUNCn07DQoNCi8vIEltYWdlIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVJbWFnZU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgbWF4UHJldmlld1NpemUgPSBub2RlLmNvbmZpZy5tYXhfcHJldmlld19zaXplLnZhbHVlOw0KICAgIGNvbnN0IHNob3dJbmZvID0gbm9kZS5jb25maWcuc2hvd19pbmZvLnZhbHVlID09PSAndHJ1ZSc7DQoNCiAgICBsZXQgaW1hZ2VEYXRhID0gaW5wdXREYXRhLmltYWdlX2RhdGE7DQogICAgbGV0IGltYWdlVXJsID0gbnVsbDsNCiAgICBsZXQgaW1hZ2VJbmZvID0gbnVsbDsNCg0KICAgIC8vIEhhbmRsZSBkaWZmZXJlbnQgdHlwZXMgb2YgaW1hZ2UgZGF0YQ0KICAgIGlmIChpbWFnZURhdGEgaW5zdGFuY2VvZiBCbG9iKSB7DQogICAgICAgIC8vIENyZWF0ZSBvYmplY3QgVVJMIGZvciBCbG9iIGRhdGENCiAgICAgICAgaW1hZ2VVcmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGltYWdlRGF0YSk7DQogICAgICAgIGltYWdlSW5mbyA9IHsNCiAgICAgICAgICAgIHR5cGU6IGltYWdlRGF0YS50eXBlIHx8ICdpbWFnZScsDQogICAgICAgICAgICBzaXplOiBpbWFnZURhdGEuc2l6ZQ0KICAgICAgICB9Ow0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGltYWdlRGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBiYXNlNjQgZGF0YQ0KICAgICAgICBpZiAoaW1hZ2VEYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6aW1hZ2UvJykgfHwgaW1hZ2VEYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6YXBwbGljYXRpb24vJykpIHsNCiAgICAgICAgICAgIC8vIEFscmVhZHkgYSBkYXRhIFVSTA0KICAgICAgICAgICAgaW1hZ2VVcmwgPSBpbWFnZURhdGE7DQogICAgICAgIH0gZWxzZSBpZiAoaW1hZ2VEYXRhLm1hdGNoKC9eW0EtWmEtejAtOSsvXSo9ezAsMn0kLykpIHsNCiAgICAgICAgICAgIC8vIExvb2tzIGxpa2UgYmFzZTY0IGRhdGEsIGNvbnZlcnQgdG8gZGF0YSBVUkwNCiAgICAgICAgICAgIC8vIFRyeSB0byBkZXRlY3QgaW1hZ2UgdHlwZSBmcm9tIHRoZSBkYXRhDQogICAgICAgICAgICBjb25zdCBpbWFnZVR5cGUgPSB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmRldGVjdEltYWdlVHlwZUZyb21CYXNlNjQoaW1hZ2VEYXRhKTsNCiAgICAgICAgICAgIGltYWdlVXJsID0gYGRhdGE6JHtpbWFnZVR5cGV9O2Jhc2U2NCwke2ltYWdlRGF0YX1gOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSByZWd1bGFyIFVSTA0KICAgICAgICAgICAgaW1hZ2VVcmwgPSBpbWFnZURhdGE7DQogICAgICAgIH0NCiAgICB9IGVsc2UgaWYgKGltYWdlRGF0YSAmJiB0eXBlb2YgaW1hZ2VEYXRhID09PSAnb2JqZWN0Jykgew0KICAgICAgICAvLyBIYW5kbGUgb2JqZWN0IHdpdGggaW1hZ2UgZGF0YQ0KICAgICAgICBpZiAoaW1hZ2VEYXRhLnVybCkgew0KICAgICAgICAgICAgaW1hZ2VVcmwgPSBpbWFnZURhdGEudXJsOw0KICAgICAgICB9IGVsc2UgaWYgKGltYWdlRGF0YS5kYXRhKSB7DQogICAgICAgICAgICBpbWFnZVVybCA9IGltYWdlRGF0YS5kYXRhOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGltYWdlRGF0YS5pbmZvKSB7DQogICAgICAgICAgICBpbWFnZUluZm8gPSBpbWFnZURhdGEuaW5mbzsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIE5vdGU6IFJlbW92ZWQgaW1hZ2UgZGltZW5zaW9uIGRldGVjdGlvbiBhcyBpdCdzIG5vdCBuZWVkZWQNCg0KICAgIC8vIFN0b3JlIGltYWdlIGRhdGEgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgbm9kZS5sYXN0SW1hZ2VEYXRhID0gaW1hZ2VEYXRhOw0KICAgIG5vZGUubGFzdEltYWdlVXJsID0gaW1hZ2VVcmw7DQogICAgbm9kZS5sYXN0SW1hZ2VJbmZvID0gaW1hZ2VJbmZvOw0KDQogICAgcmV0dXJuIHsNCiAgICAgICAgaW1hZ2VfZGF0YTogaW1hZ2VEYXRhLA0KICAgICAgICBpbWFnZV91cmw6IGltYWdlVXJsLA0KICAgICAgICBpbWFnZV9pbmZvOiBpbWFnZUluZm8sDQogICAgICAgIGRhdGE6IGltYWdlRGF0YQ0KICAgIH07DQp9DQoNCi8vIEF1ZGlvIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVBdWRpb05vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgYXV0b1BsYXkgPSBub2RlLmNvbmZpZy5hdXRvUGxheS52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IHZvbHVtZSA9IHBhcnNlRmxvYXQobm9kZS5jb25maWcudm9sdW1lLnZhbHVlKTsNCg0KICAgIGxldCBhdWRpb0RhdGEgPSBpbnB1dERhdGEuYXVkaW9fZGF0YTsNCg0KDQogICAgaWYgKCFhdWRpb0RhdGEpIHsNCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBhdWRpbyBkYXRhIHByb3ZpZGVkJyk7DQogICAgfQ0KDQogICAgLy8gU3RvcmUgYXVkaW8gZGF0YSBmb3IgbWFudWFsIHBsYXkgYnV0dG9uIHN5c3RlbSAobGlrZSBvbGQgc3lzdGVtKQ0KICAgIG5vZGUuYXVkaW9EYXRhID0gYXVkaW9EYXRhOw0KICAgIG5vZGUudm9sdW1lID0gdm9sdW1lOw0KDQogICAgLy8gQ3JlYXRlIGF1ZGlvIGVsZW1lbnQgaWYgaXQgZG9lc24ndCBleGlzdCAobGlrZSBvbGQgc3lzdGVtKQ0KICAgIGlmICghbm9kZS5hdWRpb0VsZW1lbnQpIHsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQgPSBuZXcgQXVkaW8oKTsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuY29udHJvbHMgPSB0cnVlOw0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zdHlsZS53aWR0aCA9ICcxMDAlJzsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnOw0KICAgIH0NCg0KICAgIC8vIFNldCBhdWRpbyBzb3VyY2UgKGxpa2Ugb2xkIHN5c3RlbSkNCiAgICBpZiAoYXVkaW9EYXRhIGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGF1ZGlvRGF0YSk7DQogICAgfSBlbHNlIGlmICh0eXBlb2YgYXVkaW9EYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICBpZiAoYXVkaW9EYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6YXVkaW8vJykgfHwgYXVkaW9EYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6YXBwbGljYXRpb24vJykpIHsNCiAgICAgICAgICAgIC8vIEFscmVhZHkgYSBkYXRhIFVSTA0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gYXVkaW9EYXRhOw0KICAgICAgICB9IGVsc2UgaWYgKGF1ZGlvRGF0YS5tYXRjaCgvXltBLVphLXowLTkrL10qPXswLDJ9JC8pKSB7DQogICAgICAgICAgICAvLyBMb29rcyBsaWtlIGJhc2U2NCBkYXRhLCBjb252ZXJ0IHRvIGRhdGEgVVJMDQogICAgICAgICAgICBjb25zdCBhdWRpb1R5cGUgPSAnYXVkaW8vbXBlZyc7IC8vIERlZmF1bHQgdG8gTVAzLCBjb3VsZCBiZSBlbmhhbmNlZCB0byBkZXRlY3QgdHlwZQ0KICAgICAgICAgICAgY29uc3QgZGF0YVVybCA9IGBkYXRhOiR7YXVkaW9UeXBlfTtiYXNlNjQsJHthdWRpb0RhdGF9YDsNCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnNyYyA9IGRhdGFVcmw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBBc3N1bWUgaXQncyBhIHJlZ3VsYXIgVVJMDQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zcmMgPSBhdWRpb0RhdGE7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zcmMgPSBhdWRpb0RhdGE7DQogICAgfQ0KDQogICAgLy8gU2V0IHZvbHVtZQ0KICAgIG5vZGUuYXVkaW9FbGVtZW50LnZvbHVtZSA9IHZvbHVtZTsNCg0KICAgIC8vIFN0b3JlIGZvciBjb25maWcgcGFuZWwgY29tcGF0aWJpbGl0eQ0KICAgIG5vZGUubGFzdEF1ZGlvRGF0YSA9IGF1ZGlvRGF0YTsNCiAgICBub2RlLmxhc3RBdWRpb1VybCA9IG5vZGUuYXVkaW9FbGVtZW50LnNyYzsNCg0KICAgIC8vIEF1dG8tcGxheSBpZiBjb25maWd1cmVkDQogICAgaWYgKGF1dG9QbGF5KSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBhd2FpdCBub2RlLmF1ZGlvRWxlbWVudC5wbGF5KCk7DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdBdXRvLXBsYXkgZmFpbGVkOicsIGVycm9yKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIENvbnZlcnQgYXVkaW8gZGF0YSB0byBwcm9wZXIgZGF0YSBVUkwgZm9yIFZGUyBTYXZlDQogICAgbGV0IGRhdGFVcmxGb3JTYXZlID0gbnVsbDsNCg0KICAgIGlmIChhdWRpb0RhdGEgaW5zdGFuY2VvZiBCbG9iKSB7DQogICAgICAgIC8vIENvbnZlcnQgQmxvYiB0byBkYXRhIFVSTA0KICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOw0KICAgICAgICBkYXRhVXJsRm9yU2F2ZSA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsNCiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoKSA9PiByZXNvbHZlKHJlYWRlci5yZXN1bHQpOw0KICAgICAgICAgICAgcmVhZGVyLm9uZXJyb3IgPSByZWplY3Q7DQogICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChhdWRpb0RhdGEpOw0KICAgICAgICB9KTsNCiAgICB9IGVsc2UgaWYgKHR5cGVvZiBhdWRpb0RhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgIGlmIChhdWRpb0RhdGEuc3RhcnRzV2l0aCgnZGF0YTphdWRpby8nKSB8fCBhdWRpb0RhdGEuc3RhcnRzV2l0aCgnZGF0YTphcHBsaWNhdGlvbi8nKSkgew0KICAgICAgICAgICAgLy8gQWxyZWFkeSBhIGRhdGEgVVJMDQogICAgICAgICAgICBkYXRhVXJsRm9yU2F2ZSA9IGF1ZGlvRGF0YTsNCiAgICAgICAgfSBlbHNlIGlmIChhdWRpb0RhdGEubWF0Y2goL15bQS1aYS16MC05Ky9dKj17MCwyfSQvKSkgew0KICAgICAgICAgICAgLy8gQmFzZTY0IGRhdGEsIGNvbnZlcnQgdG8gZGF0YSBVUkwNCiAgICAgICAgICAgIGNvbnN0IGF1ZGlvVHlwZSA9ICdhdWRpby9tcGVnJzsgLy8gRGVmYXVsdCB0byBNUDMsIGNvdWxkIGJlIGVuaGFuY2VkIHRvIGRldGVjdCB0eXBlDQogICAgICAgICAgICBkYXRhVXJsRm9yU2F2ZSA9IGBkYXRhOiR7YXVkaW9UeXBlfTtiYXNlNjQsJHthdWRpb0RhdGF9YDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIFJlZ3VsYXIgVVJMLCBrZWVwIGFzIGlzDQogICAgICAgICAgICBkYXRhVXJsRm9yU2F2ZSA9IGF1ZGlvRGF0YTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIEZhbGxiYWNrDQogICAgICAgIGRhdGFVcmxGb3JTYXZlID0gYXVkaW9EYXRhOw0KICAgIH0NCg0KICAgIHJldHVybiB7DQogICAgICAgIGF1ZGlvX2RhdGE6IGF1ZGlvRGF0YSwNCiAgICAgICAgYXVkaW9fdXJsOiBub2RlLmF1ZGlvRWxlbWVudC5zcmMsDQogICAgICAgIGRhdGE6IGRhdGFVcmxGb3JTYXZlICAvLyBSZXR1cm4gdGhlIGFjdHVhbCBhdWRpbyBkYXRhIGFzIGRhdGEgVVJMDQogICAgfTsNCn0NCg0KLy8gRXhwb3J0IHRvIGdsb2JhbCBzY29wZQ0Kd2luZG93Lm1lZGlhRXhlY3V0b3JzID0gew0KICAgIGV4ZWN1dGVJbWFnZU5vZGUsDQogICAgZXhlY3V0ZUF1ZGlvTm9kZQ0KfTsNCg0KDQovLyBUaW1lciBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlVGltZXJOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGludGVydmFsID0gbm9kZS5jb25maWcuaW50ZXJ2YWwudmFsdWU7DQogICAgY29uc3QgY291bnQgPSBub2RlLmNvbmZpZy5jb3VudC52YWx1ZTsNCg0KICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gew0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IERhdGUubm93KCk7DQogICAgICAgICAgICByZXNvbHZlKHsNCiAgICAgICAgICAgICAgICB0cmlnZ2VyOiB0aW1lc3RhbXAsDQogICAgICAgICAgICAgICAgb3JpZ2luYWxfZGF0YTogdGltZXN0YW1wLA0KICAgICAgICAgICAgICAgIHByb2Nlc3NlZF9kYXRhOiB0aW1lc3RhbXAsDQogICAgICAgICAgICAgICAgdGltZXN0YW1wOiB0aW1lc3RhbXAsDQogICAgICAgICAgICAgICAgZWxhcHNlZDogaW50ZXJ2YWwNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9LCBpbnRlcnZhbCk7DQogICAgfSk7DQp9DQoNCi8vIERpc3BsYXkgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZURpc3BsYXlOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGZvcm1hdCA9IG5vZGUuY29uZmlnLmZvcm1hdC52YWx1ZTsNCiAgICBjb25zdCBtYXhMZW5ndGggPSBub2RlLmNvbmZpZy5tYXhMZW5ndGgudmFsdWU7DQogICAgY29uc3QgaW5wdXRQb3J0ID0gbm9kZS5jb25maWcuaW5wdXRfcG9ydD8udmFsdWUgfHwgJ2F1dG8nOw0KDQogICAgLy8gVHJ5IHRvIGZpbmQgY29udGVudCBiYXNlZCBvbiBjb25maWd1cmVkIGlucHV0IHBvcnQgb3IgYXV0by1kZXRlY3QNCiAgICBsZXQgY29udGVudCA9IG51bGw7DQoNCiAgICBpZiAoaW5wdXRQb3J0ICE9PSAnYXV0bycpIHsNCiAgICAgICAgLy8gVXNlIHRoZSBzcGVjaWZpZWQgaW5wdXQgcG9ydA0KICAgICAgICBjb250ZW50ID0gaW5wdXREYXRhW2lucHV0UG9ydF07DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gQXV0by1kZXRlY3Q6IFByaW9yaXR5IG9yZGVyOiB0ZXh0LCBqc29uLCBkYXRhLCBiaW5hcnkNCiAgICAgICAgaWYgKGlucHV0RGF0YS50ZXh0ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBpbnB1dERhdGEudGV4dDsNCiAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGEuanNvbiAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBjb250ZW50ID0gaW5wdXREYXRhLmpzb247DQogICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLmRhdGEgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgY29udGVudCA9IGlucHV0RGF0YS5kYXRhOw0KICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS5iaW5hcnkgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgY29udGVudCA9IGlucHV0RGF0YS5iaW5hcnk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBVc2UgdGhlIGZpcnN0IGF2YWlsYWJsZSBpbnB1dA0KICAgICAgICAgICAgY29uc3QgZmlyc3RJbnB1dCA9IE9iamVjdC52YWx1ZXMoaW5wdXREYXRhKVswXTsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBmaXJzdElucHV0Ow0KICAgICAgICB9DQogICAgfQ0KDQoNCiAgICAvLyBPbmx5IGNvbnZlcnQgdG8gSlNPTiBzdHJpbmcgaWYgZm9ybWF0IGlzICdqc29uJyBvciBpZiBpdCdzIGFuIG9iamVjdCBhbmQgZm9ybWF0IGlzIG5vdCBzcGVjaWZpZWQNCiAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdvYmplY3QnICYmIGZvcm1hdCA9PT0gJ2pzb24nKSB7DQogICAgICAgIGNvbnRlbnQgPSBKU09OLnN0cmluZ2lmeShjb250ZW50LCBudWxsLCAyKTsNCiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnb2JqZWN0JyAmJiBmb3JtYXQgPT09ICd0ZXh0Jykgew0KICAgICAgICAvLyBGb3IgdGV4dCBmb3JtYXQsIGV4dHJhY3QgdGhlIGFjdHVhbCB2YWx1ZSBmcm9tIGNvbW1vbiBmaWVsZHMNCiAgICAgICAgaWYgKGNvbnRlbnQgPT09IG51bGwpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSAnbnVsbCc7DQogICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShjb250ZW50KSkgew0KICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQuam9pbignLCAnKTsNCiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgICAgIC8vIExvb2sgZm9yIHRoZSBhY3R1YWwgdmFsdWUgaW4gY29tbW9uIGZpZWxkcw0KICAgICAgICAgICAgaWYgKGNvbnRlbnQuZXh0cmFjdGVkX3ZhbHVlICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICBjb250ZW50ID0gU3RyaW5nKGNvbnRlbnQuZXh0cmFjdGVkX3ZhbHVlKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGVudC52YWx1ZSAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgY29udGVudCA9IFN0cmluZyhjb250ZW50LnZhbHVlKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGVudC50ZXh0ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICBjb250ZW50ID0gU3RyaW5nKGNvbnRlbnQudGV4dCk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRlbnQuZGF0YSAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgY29udGVudCA9IFN0cmluZyhjb250ZW50LmRhdGEpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvLyBJZiBubyBjb21tb24gZmllbGRzIGZvdW5kLCBqdXN0IHNob3cgdGhlIGZpcnN0IHZhbHVlDQogICAgICAgICAgICAgICAgY29uc3QgZmlyc3RWYWx1ZSA9IE9iamVjdC52YWx1ZXMoY29udGVudClbMF07DQogICAgICAgICAgICAgICAgY29udGVudCA9IFN0cmluZyhmaXJzdFZhbHVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmIChjb250ZW50ICYmIGNvbnRlbnQubGVuZ3RoID4gbWF4TGVuZ3RoKSB7DQogICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnN1YnN0cmluZygwLCBtYXhMZW5ndGgpICsgJy4uLic7DQogICAgfQ0KDQogICAgLy8gVXBkYXRlIGRpc3BsYXkgbm9kZSBjb250ZW50DQogICAgdXBkYXRlRGlzcGxheU5vZGVDb250ZW50KG5vZGUuaWQsIGNvbnRlbnQsIGZvcm1hdCk7DQoNCiAgICByZXR1cm4gew0KICAgICAgICBvcmlnaW5hbF9kYXRhOiBjb250ZW50LA0KICAgICAgICBkaXNwbGF5ZWQ6IGNvbnRlbnQsDQogICAgICAgIHByb2Nlc3NlZF9kYXRhOiBjb250ZW50DQogICAgfTsNCn0NCg0KDQovLyBSZXBlYXRlciBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlUmVwZWF0ZXJOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGludGVydmFsID0gcGFyc2VJbnQobm9kZS5jb25maWcuaW50ZXJ2YWwudmFsdWUpOw0KICAgIGNvbnN0IGNvdW50ID0gcGFyc2VJbnQobm9kZS5jb25maWcuY291bnQudmFsdWUpOw0KDQogICAgLy8gSW5pdGlhbGl6ZSByZXBlYXRlciBzdGF0ZSBpZiBub3QgZXhpc3RzDQogICAgaWYgKCFub2RlLnJlcGVhdGVyU3RhdGUpIHsNCiAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlID0gew0KICAgICAgICAgICAgY291bnQ6IDAsDQogICAgICAgICAgICBpbnRlcnZhbDogbnVsbCwNCiAgICAgICAgICAgIGlzUnVubmluZzogZmFsc2UNCiAgICAgICAgfTsNCiAgICB9DQoNCiAgICAvLyBJZiB0aGlzIGlzIGEgbWFudWFsIHRyaWdnZXIgKG5vdCBmcm9tIGludGVydmFsKSwgc3RhcnQgdGhlIHJlcGVhdGVyDQogICAgaWYgKCFub2RlLnJlcGVhdGVyU3RhdGUuaXNSdW5uaW5nKSB7DQogICAgICAgIG5vZGUucmVwZWF0ZXJTdGF0ZS5pc1J1bm5pbmcgPSB0cnVlOw0KICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUuY291bnQgPSAwOw0KDQogICAgICAgIC8vIFN0YXJ0IHRoZSBpbnRlcnZhbA0KICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7DQogICAgICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUuY291bnQrKzsNCg0KICAgICAgICAgICAgLy8gRXhlY3V0ZSB0aGUgY29ubmVjdGVkIHdvcmtmbG93DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3RlZE5vZGVzID0gZmluZENvbm5lY3RlZE5vZGVzKG5vZGUuaWQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGV4ZWN1dGVkID0gbmV3IFNldCgpOw0KDQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0ZWROb2RlIG9mIGNvbm5lY3RlZE5vZGVzKSB7DQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGV4ZWN1dGVOb2RlKGNvbm5lY3RlZE5vZGUubm9kZSwgeyB0cmlnZ2VyOiBEYXRlLm5vdygpIH0sIGV4ZWN1dGVkKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGV4ZWN1dGluZyByZXBlYXRlciB3b3JrZmxvdzonLCBlcnJvcik7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFN0b3AgaWYgY291bnQgbGltaXQgcmVhY2hlZA0KICAgICAgICAgICAgaWYgKGNvdW50ID4gMCAmJiBub2RlLnJlcGVhdGVyU3RhdGUuY291bnQgPj0gY291bnQpIHsNCiAgICAgICAgICAgICAgICBlbmdpbmUuc3RvcFJlcGVhdGVyKG5vZGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LCBpbnRlcnZhbCk7DQogICAgfQ0KDQogICAgcmV0dXJuIHsgdHJpZ2dlcjogRGF0ZS5ub3coKSwgY291bnQ6IG5vZGUucmVwZWF0ZXJTdGF0ZS5jb3VudCwgaXNSdW5uaW5nOiBub2RlLnJlcGVhdGVyU3RhdGUuaXNSdW5uaW5nIH07DQp9DQoNCi8vIENvbmRpdGlvbiBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlQ29uZGl0aW9uTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBvcGVyYXRvciA9IG5vZGUuY29uZmlnLm9wZXJhdG9yLnZhbHVlOw0KICAgIGNvbnN0IGNvbXBhcmVWYWx1ZSA9IG5vZGUuY29uZmlnLmNvbXBhcmVfdmFsdWUudmFsdWU7DQogICAgY29uc3QgY2FzZVNlbnNpdGl2ZSA9IG5vZGUuY29uZmlnLmNhc2Vfc2Vuc2l0aXZlLnZhbHVlID09PSAndHJ1ZSc7DQoNCiAgICBsZXQgaW5wdXRWYWx1ZSA9IGlucHV0RGF0YS52YWx1ZTsNCiAgICBsZXQgcmVzdWx0ID0gZmFsc2U7DQoNCiAgICAvLyBDb252ZXJ0IGlucHV0IHRvIHN0cmluZyBmb3IgY29tcGFyaXNvbiBpZiBuZWVkZWQNCiAgICBsZXQgaW5wdXRTdHIgPSBTdHJpbmcoaW5wdXRWYWx1ZSk7DQogICAgbGV0IGNvbXBhcmVTdHIgPSBTdHJpbmcoY29tcGFyZVZhbHVlKTsNCg0KICAgIC8vIERlYnVnIGxvZ2dpbmcgZm9yIHN0cmluZyBjb21wYXJpc29ucw0KDQogICAgLy8gSGFuZGxlIGNhc2Ugc2Vuc2l0aXZpdHkNCiAgICBpZiAoIWNhc2VTZW5zaXRpdmUpIHsNCiAgICAgICAgaW5wdXRTdHIgPSBpbnB1dFN0ci50b0xvd2VyQ2FzZSgpOw0KICAgICAgICBjb21wYXJlU3RyID0gY29tcGFyZVN0ci50b0xvd2VyQ2FzZSgpOw0KICAgIH0NCg0KICAgIC8vIFBlcmZvcm0gY29tcGFyaXNvbiBiYXNlZCBvbiBvcGVyYXRvcg0KICAgIHN3aXRjaCAob3BlcmF0b3IpIHsNCiAgICAgICAgY2FzZSAnZXF1YWxzJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IGlucHV0U3RyID09PSBjb21wYXJlU3RyOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ25vdF9lcXVhbHMnOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIgIT09IGNvbXBhcmVTdHI7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnZ3JlYXRlcl90aGFuJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IE51bWJlcihpbnB1dFZhbHVlKSA+IE51bWJlcihjb21wYXJlVmFsdWUpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2xlc3NfdGhhbic6DQogICAgICAgICAgICByZXN1bHQgPSBOdW1iZXIoaW5wdXRWYWx1ZSkgPCBOdW1iZXIoY29tcGFyZVZhbHVlKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdncmVhdGVyX3RoYW5fb3JfZXF1YWwnOg0KICAgICAgICAgICAgcmVzdWx0ID0gTnVtYmVyKGlucHV0VmFsdWUpID49IE51bWJlcihjb21wYXJlVmFsdWUpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2xlc3NfdGhhbl9vcl9lcXVhbCc6DQogICAgICAgICAgICByZXN1bHQgPSBOdW1iZXIoaW5wdXRWYWx1ZSkgPD0gTnVtYmVyKGNvbXBhcmVWYWx1ZSk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnY29udGFpbnMnOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIuaW5jbHVkZXMoY29tcGFyZVN0cik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnbm90X2NvbnRhaW5zJzoNCiAgICAgICAgICAgIHJlc3VsdCA9ICFpbnB1dFN0ci5pbmNsdWRlcyhjb21wYXJlU3RyKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdzdGFydHNfd2l0aCc6DQogICAgICAgICAgICByZXN1bHQgPSBpbnB1dFN0ci5zdGFydHNXaXRoKGNvbXBhcmVTdHIpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2VuZHNfd2l0aCc6DQogICAgICAgICAgICByZXN1bHQgPSBpbnB1dFN0ci5lbmRzV2l0aChjb21wYXJlU3RyKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdpc19lbXB0eSc6DQogICAgICAgICAgICByZXN1bHQgPSBpbnB1dFN0ci50cmltKCkgPT09ICcnOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2lzX25vdF9lbXB0eSc6DQogICAgICAgICAgICByZXN1bHQgPSBpbnB1dFN0ci50cmltKCkgIT09ICcnOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICByZXN1bHQgPSBmYWxzZTsNCiAgICB9DQoNCiAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICBub2RlLmxhc3RJbnB1dFZhbHVlID0gaW5wdXRWYWx1ZTsNCiAgICBub2RlLmxhc3RDb21wYXJlVmFsdWUgPSBjb21wYXJlVmFsdWU7DQogICAgbm9kZS5sYXN0UmVzdWx0ID0gcmVzdWx0Ow0KICAgIG5vZGUubGFzdE9wZXJhdG9yID0gb3BlcmF0b3I7DQoNCiAgICByZXR1cm4geyByZXN1bHQ6IHJlc3VsdCB9Ow0KfQ0KDQovLyBMb2dpY2FsIEdhdGUgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUxvZ2ljYWxHYXRlTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBpbnZlcnQgPSBub2RlLmNvbmZpZy5pbnZlcnQudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IG5vZGUuY29uZmlnLmRlc2NyaXB0aW9uLnZhbHVlOw0KDQogICAgbGV0IGNvbmRpdGlvbiA9IGlucHV0RGF0YS5jb25kaXRpb247DQoNCiAgICAvLyBDb252ZXJ0IHRvIGJvb2xlYW4gaWYgbmVlZGVkDQogICAgaWYgKHR5cGVvZiBjb25kaXRpb24gPT09ICdzdHJpbmcnKSB7DQogICAgICAgIGNvbmRpdGlvbiA9IGNvbmRpdGlvbi50b0xvd2VyQ2FzZSgpID09PSAndHJ1ZSc7DQogICAgfSBlbHNlIGlmICh0eXBlb2YgY29uZGl0aW9uID09PSAnbnVtYmVyJykgew0KICAgICAgICBjb25kaXRpb24gPSBjb25kaXRpb24gIT09IDA7DQogICAgfSBlbHNlIGlmICh0eXBlb2YgY29uZGl0aW9uID09PSAnb2JqZWN0Jykgew0KICAgICAgICAvLyBJZiBpdCdzIGFuIG9iamVjdCB3aXRoIGEgcmVzdWx0IGZpZWxkIChmcm9tIGNvbmRpdGlvbiBub2RlKQ0KICAgICAgICBjb25kaXRpb24gPSBjb25kaXRpb24ucmVzdWx0ID09PSB0cnVlOw0KICAgIH0NCg0KICAgIC8vIEFwcGx5IGludmVyc2lvbiBpZiBjb25maWd1cmVkDQogICAgaWYgKGludmVydCkgew0KICAgICAgICBjb25kaXRpb24gPSAhY29uZGl0aW9uOw0KICAgIH0NCg0KICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgIG5vZGUubGFzdENvbmRpdGlvbiA9IGNvbmRpdGlvbjsNCiAgICBub2RlLmxhc3RJbnZlcnRlZCA9IGludmVydDsNCiAgICBub2RlLmxhc3REZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uOw0KDQogICAgLy8gT25seSByZXR1cm4gdHJpZ2dlciBpZiBjb25kaXRpb24gaXMgdHJ1ZQ0KICAgIGlmIChjb25kaXRpb24pIHsNCiAgICAgICAgcmV0dXJuIHsgdHJpZ2dlcjogRGF0ZS5ub3coKSB9Ow0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIFJldHVybiBzcGVjaWFsIG9iamVjdCB0byBpbmRpY2F0ZSBleGVjdXRpb24gc2hvdWxkIHN0b3ANCiAgICAgICAgcmV0dXJuIHsgX19zdG9wX2V4ZWN1dGlvbjogdHJ1ZSB9Ow0KICAgIH0NCn0NCg0KLy8gRm9yIEVhY2ggTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUZvckVhY2hOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IHN0b3BPbkVycm9yID0gbm9kZS5jb25maWcuc3RvcF9vbl9lcnJvci52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIA0KICAgIC8vIEdldCB0aGUgaXRlcmF0aW9uIGRlbGF5IGZyb20gY29uZmlnIChpbiBtaWxsaXNlY29uZHMpDQogICAgY29uc3QgaXRlcmF0aW9uRGVsYXkgPSBub2RlLmNvbmZpZy5pdGVyYXRpb25fZGVsYXk/LnZhbHVlIHx8IDA7DQogICAgDQogICAgLy8gR2V0IHRoZSBhcnJheSBmcm9tIGlucHV0DQogICAgbGV0IGFycmF5ID0gaW5wdXREYXRhLmFycmF5Ow0KICAgIA0KICAgIC8vIElmIGFycmF5IGlzIG5vdCBwcm92aWRlZCwgdHJ5IG90aGVyIGNvbW1vbiBpbnB1dCBuYW1lcw0KICAgIGlmICghQXJyYXkuaXNBcnJheShhcnJheSkpIHsNCiAgICAgICAgYXJyYXkgPSBpbnB1dERhdGEuZGF0YSB8fCBpbnB1dERhdGEuZmlsZV9uYW1lcyB8fCBpbnB1dERhdGEuaXRlbXM7DQogICAgfQ0KICAgIA0KICAgIC8vIEVuc3VyZSB3ZSBoYXZlIGEgdmFsaWQgYXJyYXkNCiAgICBpZiAoIUFycmF5LmlzQXJyYXkoYXJyYXkpKSB7DQogICAgICAgIHRocm93IG5ldyBFcnJvcignRm9yIEVhY2ggbm9kZSByZXF1aXJlcyBhbiBhcnJheSBpbnB1dCcpOw0KICAgIH0NCg0KICAgIGNvbnNvbGUubG9nKCdGb3IgRWFjaCBEZWJ1ZzonLCB7DQogICAgICAgIGFycmF5TGVuZ3RoOiBhcnJheS5sZW5ndGgsDQogICAgICAgIGFycmF5UHJldmlldzogYXJyYXkuc2xpY2UoMCwgMyksDQogICAgICAgIHN0b3BPbkVycm9yOiBzdG9wT25FcnJvciwNCiAgICAgICAgaXRlcmF0aW9uRGVsYXk6IGl0ZXJhdGlvbkRlbGF5DQogICAgfSk7DQoNCiAgICAvLyBJbml0aWFsaXplIGl0ZXJhdGlvbiBzdGF0ZSBpZiBub3QgZXhpc3RzDQogICAgaWYgKCFub2RlLmZvckVhY2hTdGF0ZSkgew0KICAgICAgICBub2RlLmZvckVhY2hTdGF0ZSA9IHsNCiAgICAgICAgICAgIGN1cnJlbnRJbmRleDogMCwNCiAgICAgICAgICAgIGFycmF5OiBhcnJheSwNCiAgICAgICAgICAgIGlzSXRlcmF0aW5nOiBmYWxzZSwNCiAgICAgICAgICAgIGlzRXhlY3V0aW5nSXRlcmF0aW9uOiBmYWxzZSwNCiAgICAgICAgICAgIGludGVydmFsOiBudWxsDQogICAgICAgIH07DQogICAgfQ0KDQogICAgLy8gSWYgdGhpcyBpcyBhIG1hbnVhbCB0cmlnZ2VyIChub3QgZnJvbSBpbnRlcnZhbCksIHN0YXJ0IHRoZSBpdGVyYXRvcg0KICAgIGlmICghbm9kZS5mb3JFYWNoU3RhdGUuaXNJdGVyYXRpbmcpIHsNCiAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaXNJdGVyYXRpbmcgPSB0cnVlOw0KICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5jdXJyZW50SW5kZXggPSAwOw0KICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5hcnJheSA9IGFycmF5Ow0KDQogICAgICAgIC8vIFN0YXJ0IHRoZSBpdGVyYXRpb24gcHJvY2Vzc2luZyB3aXRoIHByb3BlciB0aW1pbmcNCiAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7DQogICAgICAgICAgICAvLyBTa2lwIGlmIHByZXZpb3VzIGl0ZXJhdGlvbiBpcyBzdGlsbCBydW5uaW5nDQogICAgICAgICAgICBpZiAobm9kZS5mb3JFYWNoU3RhdGUuaXNFeGVjdXRpbmdJdGVyYXRpb24pIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRm9yIEVhY2g6IFNraXBwaW5nIGl0ZXJhdGlvbiAtIHByZXZpb3VzIHN0aWxsIHJ1bm5pbmcnKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChub2RlLmZvckVhY2hTdGF0ZS5jdXJyZW50SW5kZXggPCBub2RlLmZvckVhY2hTdGF0ZS5hcnJheS5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pc0V4ZWN1dGluZ0l0ZXJhdGlvbiA9IHRydWU7DQogICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEl0ZW0gPSBub2RlLmZvckVhY2hTdGF0ZS5hcnJheVtub2RlLmZvckVhY2hTdGF0ZS5jdXJyZW50SW5kZXhdOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRJbmRleCA9IG5vZGUuZm9yRWFjaFN0YXRlLmN1cnJlbnRJbmRleDsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgRm9yIEVhY2ggaXRlcmF0aW9uICR7Y3VycmVudEluZGV4ICsgMX0vJHtub2RlLmZvckVhY2hTdGF0ZS5hcnJheS5sZW5ndGh9OmAsIGN1cnJlbnRJdGVtKTsNCg0KICAgICAgICAgICAgICAgIC8vIENsZWFyIGJ1ZmZlciBmb3IgbXVsdGktaW5wdXQgbm9kZXMgYXQgc3RhcnQgb2YgZWFjaCBpdGVyYXRpb24NCiAgICAgICAgICAgICAgICBpZiAod2luZG93Lmdsb2JhbE5vZGVJbnB1dEJ1ZmZlcikgew0KICAgICAgICAgICAgICAgICAgICAvLyBDbGVhciBhbnkgZG93bnN0cmVhbSBtdWx0aS1pbnB1dCBub2RlIGJ1ZmZlcnMgdG8gZW5zdXJlIGZyZXNoIHN0YXRlIGZvciB0aGlzIGl0ZXJhdGlvbg0KICAgICAgICAgICAgICAgICAgICAvLyBCdXQgYmUgbW9yZSBzZWxlY3RpdmUgLSBvbmx5IGNsZWFyIG5vZGVzIHRoYXQgYXJlbid0IGltbWVkaWF0ZSBjaGlsZHJlbg0KICAgICAgICAgICAgICAgICAgICBjb25zdCBpbW1lZGlhdGVDaGlsZElkcyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBhbGxEb3duc3RyZWFtSWRzID0gW107DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IG5vZGUuaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbW1lZGlhdGVDaGlsZElkcy5wdXNoKGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBhbGwgZG93bnN0cmVhbSBub2RlcyAoY2hpbGRyZW4gb2YgY2hpbGRyZW4pDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbmRBbGxEb3duc3RyZWFtID0gKG5vZGVJZHMsIHZpc2l0ZWQgPSBuZXcgU2V0KCkpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZUlkIG9mIG5vZGVJZHMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlzaXRlZC5oYXMobm9kZUlkKSkgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaXRlZC5hZGQobm9kZUlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxEb3duc3RyZWFtSWRzLnB1c2gobm9kZUlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGlsZElkcyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBub2RlSWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkSWRzLnB1c2goY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmRBbGxEb3duc3RyZWFtKGNoaWxkSWRzLCB2aXNpdGVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGZpbmRBbGxEb3duc3RyZWFtKGltbWVkaWF0ZUNoaWxkSWRzKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgY2xlYXIgYnVmZmVycyBmb3IgZG93bnN0cmVhbSBub2RlcyB0aGF0IGFyZW4ndCBpbW1lZGlhdGUgY2hpbGRyZW4NCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZXNUb0NsZWFyID0gYWxsRG93bnN0cmVhbUlkcy5maWx0ZXIoaWQgPT4gIWltbWVkaWF0ZUNoaWxkSWRzLmluY2x1ZGVzKGlkKSk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGVJZCBvZiBub2Rlc1RvQ2xlYXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuZ2xvYmFsTm9kZUlucHV0QnVmZmVyLmhhcyhub2RlSWQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lmdsb2JhbE5vZGVJbnB1dEJ1ZmZlci5kZWxldGUobm9kZUlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+nuSBDbGVhcmVkIGJ1ZmZlciBmb3IgZG93bnN0cmVhbSBub2RlICR7bm9kZUlkfSBhdCBzdGFydCBvZiBpdGVyYXRpb24gJHtjdXJyZW50SW5kZXggKyAxfWApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSB0aGUgY29ubmVjdGVkIHdvcmtmbG93IC0gdXNlIHRoZSBleGVjdXRpb24gZW5naW5lIGRpcmVjdGx5DQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBub2RlcyBjb25uZWN0ZWQgdG8gdGhlIGN1cnJlbnRfaXRlbSBvdXRwdXQgcG9ydA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0ZWROb2RlcyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IG5vZGUuaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXROb2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3RlZE5vZGVzLnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZTogdGFyZ2V0Tm9kZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UG9ydDogY29ubmVjdGlvbi50by5wb3J0TmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFBvcnQ6IGNvbm5lY3Rpb24uZnJvbS5wb3J0TmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBTZXQgYWxsIGNvbm5lY3RlZCBub2RlcyB0byBydW5uaW5nIHN0YXRlIGJlZm9yZSBleGVjdXRpb24NCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0ZWROb2RlSW5mbyBvZiBjb25uZWN0ZWROb2Rlcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0ZWROb2RlSW5mby5ub2RlLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2NvbXBsZXRlZCcsICdlcnJvcicsICd3YWl0aW5nLWlucHV0cycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3J1bm5pbmcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIEV4ZWN1dGUgZWFjaCBjb25uZWN0ZWQgbm9kZSB3aXRoIHRoZSBhcHByb3ByaWF0ZSBkYXRhDQogICAgICAgICAgICAgICAgICAgIC8vIFVzZSBzaGFyZWQgYnVmZmVyIGZvciB0aGUgZW50aXJlIGl0ZXJhdGlvbiBzbyBtdWx0aS1pbnB1dCBub2RlcyBjYW4gYWNjdW11bGF0ZQ0KICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVyYXRpb25FeGVjdXRlZCA9IG5ldyBTZXQoKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlcmF0aW9uSW5wdXRCdWZmZXIgPSBuZXcgTWFwKCk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBDb3B5IGFueSBleGlzdGluZyBidWZmZXIgZGF0YSBmcm9tIGdsb2JhbCBidWZmZXIgdGhhdCBtaWdodCBiZSBuZWVkZWQNCiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5nbG9iYWxOb2RlSW5wdXRCdWZmZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW25vZGVJZCwgYnVmZmVyRGF0YV0gb2Ygd2luZG93Lmdsb2JhbE5vZGVJbnB1dEJ1ZmZlci5lbnRyaWVzKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRpb25JbnB1dEJ1ZmZlci5zZXQobm9kZUlkLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpdmVkSW5wdXRzOiB7IC4uLmJ1ZmZlckRhdGEucmVjZWl2ZWRJbnB1dHMgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGVkUG9ydHM6IFsuLi5idWZmZXJEYXRhLmNvbm5lY3RlZFBvcnRzXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3RlZE5vZGVJbmZvIG9mIGNvbm5lY3RlZE5vZGVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW5wdXRWYWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFwIHRoZSBGb3IgRWFjaCBvdXRwdXRzIHRvIHRoZSBjb25uZWN0ZWQgbm9kZSdzIGlucHV0DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGVkTm9kZUluZm8ub3V0cHV0UG9ydCA9PT0gJ2N1cnJlbnRfaXRlbScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFZhbHVlID0gY3VycmVudEl0ZW07DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbm5lY3RlZE5vZGVJbmZvLm91dHB1dFBvcnQgPT09ICdjdXJyZW50X2luZGV4Jykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbnZlcnQgaW5kZXggdG8gc3RyaW5nIGZvciBjb21wYXRpYmlsaXR5IHdpdGggdGV4dC1iYXNlZCBub2Rlcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBTdHJpbmcoY3VycmVudEluZGV4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IGN1cnJlbnRJdGVtOyAvLyBEZWZhdWx0IHRvIGN1cnJlbnQgaXRlbQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgaW5wdXQgZGF0YSBmb3IgdGhlIGNvbm5lY3RlZCBub2RlDQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlSW5wdXREYXRhID0ge307DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlSW5wdXREYXRhW2Nvbm5lY3RlZE5vZGVJbmZvLmlucHV0UG9ydF0gPSBpbnB1dFZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVzZSB0aGUgd29ya2Zsb3cgZXhlY3V0aW9uIHN5c3RlbSB0byBlbnN1cmUgZG93bnN0cmVhbSBub2RlcyBleGVjdXRlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyB3aWxsIHRyaWdnZXIgdGhlIGNvbXBsZXRlIGV4ZWN1dGlvbiBjaGFpbiAobGxtIOKGkiBodHRwIOKGkiBldGMuKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV4ZWN1dGVOb2RlU21hcnQoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3RlZE5vZGVJbmZvLm5vZGUsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0ZWROb2RlSW5mby5pbnB1dFBvcnQsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFZhbHVlLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlcmF0aW9uRXhlY3V0ZWQsIC8vIFVzZSBzaGFyZWQgZXhlY3V0ZWQgc2V0IGZvciB0aGlzIGl0ZXJhdGlvbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRpb25JbnB1dEJ1ZmZlciAgLy8gVXNlIHNoYXJlZCBidWZmZXIgZm9yIHRoaXMgaXRlcmF0aW9uDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIG5vZGUgYXMgY29tcGxldGVkIGFmdGVyIHN1Y2Nlc3NmdWwgZXhlY3V0aW9uDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0ZWROb2RlSW5mby5ub2RlLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZWQnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChub2RlRXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIG5vZGUgYXMgZXJyb3IgaWYgZXhlY3V0aW9uIGZhaWxzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0ZWROb2RlSW5mby5ub2RlLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlcnJvcicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZS10aHJvdyB0aGUgZXJyb3IgdG8gYmUgaGFuZGxlZCBieSB0aGUgb3V0ZXIgY2F0Y2gNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBub2RlRXJyb3I7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgdGhpcyBpdGVyYXRpb24gYXMgY29tcGxldGUNCiAgICAgICAgICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaXNFeGVjdXRpbmdJdGVyYXRpb24gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZXhlY3V0aW5nIGZvciBlYWNoIGl0ZXJhdGlvbjonLCBlcnJvcik7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIHRoaXMgaXRlcmF0aW9uIGFzIGNvbXBsZXRlIGV2ZW4gb24gZXJyb3INCiAgICAgICAgICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaXNFeGVjdXRpbmdJdGVyYXRpb24gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgYW55IHN0aWxsLXJ1bm5pbmcgY29ubmVjdGVkIG5vZGVzIGFzIGVycm9yDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3RlZE5vZGVzID0gW107DQogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZS5pZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldE5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGVkTm9kZXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlOiB0YXJnZXROb2RlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRQb3J0OiBjb25uZWN0aW9uLnRvLnBvcnROYW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0UG9ydDogY29ubmVjdGlvbi5mcm9tLnBvcnROYW1lDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0ZWROb2RlSW5mbyBvZiBjb25uZWN0ZWROb2Rlcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0ZWROb2RlSW5mby5ub2RlLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCAmJiBub2RlRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ3J1bm5pbmcnKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlcnJvcicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAoc3RvcE9uRXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0b3AgdGhlIGl0ZXJhdGlvbg0KICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChub2RlLmZvckVhY2hTdGF0ZS5pbnRlcnZhbCk7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pc0l0ZXJhdGluZyA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaW50ZXJ2YWwgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy8gTW92ZSB0byBuZXh0IGl0ZW0NCiAgICAgICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5jdXJyZW50SW5kZXgrKzsNCg0KICAgICAgICAgICAgICAgIC8vIFN0b3AgaWYgd2UndmUgcHJvY2Vzc2VkIGFsbCBpdGVtcw0KICAgICAgICAgICAgICAgIGlmIChub2RlLmZvckVhY2hTdGF0ZS5jdXJyZW50SW5kZXggPj0gbm9kZS5mb3JFYWNoU3RhdGUuYXJyYXkubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwobm9kZS5mb3JFYWNoU3RhdGUuaW50ZXJ2YWwpOw0KICAgICAgICAgICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pc0l0ZXJhdGluZyA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pbnRlcnZhbCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGb3IgRWFjaCBjb21wbGV0ZWQgYWxsIGl0ZW1zJyk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBFbnN1cmUgYWxsIGNvbm5lY3RlZCBub2RlcyBzaG93IGZpbmFsIGNvbXBsZXRlZCBzdGF0dXMNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGVkTm9kZXMgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBub2RlLmlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Tm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0Tm9kZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0ZWROb2Rlcy5wdXNoKHRhcmdldE5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0ZWROb2RlIG9mIGNvbm5lY3RlZE5vZGVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbm5lY3RlZE5vZGUuaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50ICYmICFub2RlRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2Vycm9yJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJywgJ3dhaXRpbmctaW5wdXRzJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sIGl0ZXJhdGlvbkRlbGF5KTsgLy8gVXNlIGNvbmZpZ3VyYWJsZSBpdGVyYXRpb24gZGVsYXkNCiAgICAgICAgDQogICAgICAgIC8vIERvbid0IHJldHVybiBhbnkgZGF0YSBpbW1lZGlhdGVseSAtIGxldCB0aGUgaW50ZXJ2YWwgaGFuZGxlIGFsbCBleGVjdXRpb25zDQogICAgICAgIC8vIFVzZSBhIHNwZWNpYWwgZmxhZyB0byBwcmV2ZW50IG1haW4gd29ya2Zsb3cgZnJvbSBleGVjdXRpbmcgZG93bnN0cmVhbSBub2Rlcw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgc3RhcnRlZDogdHJ1ZSwNCiAgICAgICAgICAgIHRvdGFsX2l0ZW1zOiBhcnJheS5sZW5ndGgsDQogICAgICAgICAgICBpdGVyYXRpb25fZGVsYXk6IGl0ZXJhdGlvbkRlbGF5LA0KICAgICAgICAgICAgbWVzc2FnZTogYEZvciBFYWNoIGl0ZXJhdGlvbiBzdGFydGVkIHdpdGggJHtpdGVyYXRpb25EZWxheX1tcyBkZWxheWAsDQogICAgICAgICAgICBfX2Zvcl9lYWNoX2NvbnRyb2w6IHRydWUgIC8vIFNwZWNpYWwgZmxhZyB0byBwcmV2ZW50IGRvd25zdHJlYW0gZXhlY3V0aW9uIGJ5IG1haW4gd29ya2Zsb3cNCiAgICAgICAgfTsNCiAgICB9DQoNCiAgICAvLyBJZiBhbHJlYWR5IGl0ZXJhdGluZywgcmV0dXJuIGN1cnJlbnQgc3RhdGUNCiAgICByZXR1cm4gew0KICAgICAgICBpc0l0ZXJhdGluZzogbm9kZS5mb3JFYWNoU3RhdGUuaXNJdGVyYXRpbmcsDQogICAgICAgIGN1cnJlbnRfaW5kZXg6IG5vZGUuZm9yRWFjaFN0YXRlLmN1cnJlbnRJbmRleCwNCiAgICAgICAgdG90YWxfaXRlbXM6IG5vZGUuZm9yRWFjaFN0YXRlLmFycmF5Lmxlbmd0aA0KICAgIH07DQp9DQoNCi8vIERlbGF5IE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVEZWxheU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgZGVsYXlNcyA9IHBhcnNlSW50KG5vZGUuY29uZmlnLmRlbGF5X21zPy52YWx1ZSB8fCBub2RlLmNvbmZpZy5kZWxheV9tcyB8fCAxMDAwKTsNCiAgICANCiAgICBjb25zb2xlLmxvZyhgRGVsYXkgbm9kZSBzdGFydGluZyAke2RlbGF5TXN9bXMgZGVsYXlgKTsNCiAgICANCiAgICAvLyBHZXQgdGhlIGlucHV0IGRhdGEgdG8gcGFzcyB0aHJvdWdoIGFmdGVyIGRlbGF5DQogICAgbGV0IGRhdGFUb1Bhc3NUaHJvdWdoID0gaW5wdXREYXRhLmRhdGE7DQogICAgDQogICAgLy8gSWYgbm8gc3BlY2lmaWMgZGF0YSBpbnB1dCwgdXNlIHRoZSBmaXJzdCBhdmFpbGFibGUgaW5wdXQNCiAgICBpZiAoZGF0YVRvUGFzc1Rocm91Z2ggPT09IHVuZGVmaW5lZCkgew0KICAgICAgICBjb25zdCBpbnB1dEtleXMgPSBPYmplY3Qua2V5cyhpbnB1dERhdGEpOw0KICAgICAgICBpZiAoaW5wdXRLZXlzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIGRhdGFUb1Bhc3NUaHJvdWdoID0gaW5wdXREYXRhW2lucHV0S2V5c1swXV07DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgLy8gV2FpdCBmb3IgdGhlIHNwZWNpZmllZCBkZWxheQ0KICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gew0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBEZWxheSBub2RlIGNvbXBsZXRlZCBhZnRlciAke2RlbGF5TXN9bXNgKTsNCiAgICAgICAgICAgIHJlc29sdmUoKTsNCiAgICAgICAgfSwgZGVsYXlNcyk7DQogICAgfSk7DQogICAgDQogICAgLy8gUmV0dXJuIHRoZSBzYW1lIGRhdGEgdGhhdCB3YXMgaW5wdXQNCiAgICByZXR1cm4gew0KICAgICAgICBkYXRhOiBkYXRhVG9QYXNzVGhyb3VnaCwNCiAgICAgICAgb3JpZ2luYWxfZGF0YTogZGF0YVRvUGFzc1Rocm91Z2gsDQogICAgICAgIHByb2Nlc3NlZF9kYXRhOiBkYXRhVG9QYXNzVGhyb3VnaCwNCiAgICAgICAgZGVsYXlfbXM6IGRlbGF5TXMsDQogICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKQ0KICAgIH07DQp9DQoNCi8vIEV4cG9ydCB0byBnbG9iYWwgc2NvcGUNCndpbmRvdy5mbG93RXhlY3V0b3JzID0gew0KICAgIGV4ZWN1dGVUaW1lck5vZGUsDQogICAgZXhlY3V0ZURpc3BsYXlOb2RlLA0KICAgIGV4ZWN1dGVSZXBlYXRlck5vZGUsDQogICAgZXhlY3V0ZUNvbmRpdGlvbk5vZGUsDQogICAgZXhlY3V0ZUxvZ2ljYWxHYXRlTm9kZSwNCiAgICBleGVjdXRlRm9yRWFjaE5vZGUsDQogICAgZXhlY3V0ZURlbGF5Tm9kZQ0KfTsNCg0KDQovLyBMTE0gQ2hhdCBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlTGxtQ2hhdE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgZW5kcG9pbnQgPSBub2RlLmNvbmZpZy5lbmRwb2ludC52YWx1ZTsNCiAgICBjb25zdCBtb2RlbCA9IG5vZGUuY29uZmlnLm1vZGVsLnZhbHVlOw0KICAgIGNvbnN0IHRlbXBlcmF0dXJlID0gcGFyc2VGbG9hdChub2RlLmNvbmZpZy50ZW1wZXJhdHVyZS52YWx1ZSk7DQogICAgY29uc3QgbWF4VG9rZW5zID0gcGFyc2VJbnQobm9kZS5jb25maWcubWF4X3Rva2Vucy52YWx1ZSk7DQogICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gbm9kZS5jb25maWcuc3lzdGVtX3Byb21wdC52YWx1ZTsNCiAgICBjb25zdCBpbmNsdWRlQ29udGV4dCA9IG5vZGUuY29uZmlnLmluY2x1ZGVfY29udGV4dC52YWx1ZSA9PT0gJ3RydWUnOw0KDQogICAgLy8gQWNjZXB0IHByb21wdCBmcm9tIGVpdGhlciAncHJvbXB0JyBvciAndGV4dCcgaW5wdXQNCiAgICBsZXQgcHJvbXB0ID0gaW5wdXREYXRhLnByb21wdDsNCiAgICBpZiAoIXByb21wdCAmJiBpbnB1dERhdGEudGV4dCkgew0KICAgICAgICBwcm9tcHQgPSBpbnB1dERhdGEudGV4dDsNCiAgICB9DQogICAgaWYgKCFwcm9tcHQgJiYgaW5wdXREYXRhLmNvbnRleHQpIHsNCiAgICAgICAgLy8gSWYgY29udGV4dCBpcyBhIHN0cmluZywgdXNlIGl0IGFzIHByb21wdA0KICAgICAgICBpZiAodHlwZW9mIGlucHV0RGF0YS5jb250ZXh0ID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgcHJvbXB0ID0gaW5wdXREYXRhLmNvbnRleHQ7DQogICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLmNvbnRleHQgJiYgdHlwZW9mIGlucHV0RGF0YS5jb250ZXh0ID09PSAnb2JqZWN0JyAmJiBpbnB1dERhdGEuY29udGV4dC50ZXh0KSB7DQogICAgICAgICAgICAvLyBJZiBjb250ZXh0IGlzIGFuIG9iamVjdCB3aXRoIHRleHQgZmllbGQsIHVzZSB0aGF0DQogICAgICAgICAgICBwcm9tcHQgPSBpbnB1dERhdGEuY29udGV4dC50ZXh0Ow0KICAgICAgICB9DQogICAgfQ0KICAgIGlmICghcHJvbXB0KSB7DQogICAgICAgIHRocm93IG5ldyBFcnJvcignTExNIENoYXQgcmVxdWlyZXMgYSBwcm9tcHQgaW5wdXQuIENvbm5lY3QgYSBUZXh0IG5vZGUgdG8gcHJvdmlkZSB0aGUgcHJvbXB0LicpOw0KICAgIH0NCg0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IG1lc3NhZ2VzID0gW107DQoNCiAgICAgICAgaWYgKHN5c3RlbVByb21wdCkgew0KICAgICAgICAgICAgbWVzc2FnZXMucHVzaCh7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBzeXN0ZW1Qcm9tcHQgfSk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaW5jbHVkZUNvbnRleHQgJiYgaW5wdXREYXRhLmNvbnRleHQpIHsNCiAgICAgICAgICAgIG1lc3NhZ2VzLnB1c2goeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IGBDb250ZXh0OiAke0pTT04uc3RyaW5naWZ5KGlucHV0RGF0YS5jb250ZXh0KX1cblxuUHJvbXB0OiAke3Byb21wdH1gIH0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgbWVzc2FnZXMucHVzaCh7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH0pOw0KICAgICAgICB9DQoNCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzeXBuZXhBUEkucHJveHlIVFRQKHsNCiAgICAgICAgICAgIHVybDogYCR7ZW5kcG9pbnR9L2NoYXQvY29tcGxldGlvbnNgLA0KICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsDQogICAgICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGJvZHk6IHsNCiAgICAgICAgICAgICAgICBtb2RlbDogbW9kZWwsDQogICAgICAgICAgICAgICAgbWVzc2FnZXM6IG1lc3NhZ2VzLA0KICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiB0ZW1wZXJhdHVyZSwNCiAgICAgICAgICAgICAgICBtYXhfdG9rZW5zOiBtYXhUb2tlbnMNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgLy8gSGFuZGxlIHByb3h5IHJlc3BvbnNlIGZvcm1hdA0KICAgICAgICBpZiAoIXJlc3BvbnNlIHx8IHJlc3BvbnNlLnN0YXR1cyA8IDIwMCB8fCByZXNwb25zZS5zdGF0dXMgPj0gMzAwKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFByb3h5IHJlcXVlc3QgZmFpbGVkOiAke3Jlc3BvbnNlPy5zdGF0dXMgfHwgJ1Vua25vd24gZXJyb3InfWApOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYExMTSByZXF1ZXN0IGZhaWxlZDogJHtyZXNwb25zZS5lcnJvcn1gKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFBhcnNlIHRoZSBKU09OIHJlc3BvbnNlIGNvbnRlbnQgZnJvbSBwcm94eQ0KICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZS5jb250ZW50KTsNCg0KICAgICAgICBpZiAoZGF0YS5lcnJvcikgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGRhdGEuZXJyb3IubWVzc2FnZSB8fCAnTExNIEFQSSBlcnJvcicpOw0KICAgICAgICB9DQoNCiAgICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gZGF0YS5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8ICcnOw0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBub2RlLmxhc3RSZXNwb25zZSA9IHJlc3BvbnNlVGV4dDsNCiAgICAgICAgbm9kZS5sYXN0VXNhZ2UgPSBkYXRhLnVzYWdlOw0KICAgICAgICBub2RlLmxhc3RNb2RlbCA9IG1vZGVsOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXNwb25zZTogcmVzcG9uc2VUZXh0LA0KICAgICAgICAgICAgdG9rZW5zX3VzZWQ6IGRhdGEudXNhZ2U/LnRvdGFsX3Rva2VucyB8fCAwLA0KICAgICAgICAgICAgbW9kZWxfdXNlZDogbW9kZWwsDQogICAgICAgICAgICBmdWxsX3Jlc3BvbnNlOiBkYXRhDQogICAgICAgIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTExNIENoYXQgZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4geyByZXNwb25zZTogbnVsbCwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTsNCiAgICB9DQp9DQoNCg0KLy8gVGVybWluYWwgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVRlcm1pbmFsTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBjb21tYW5kID0gbm9kZS5jb25maWcuY29tbWFuZC52YWx1ZTsNCiAgICBjb25zdCB1c2VJbnB1dENvbW1hbmQgPSBub2RlLmNvbmZpZy51c2VfaW5wdXRfY29tbWFuZC52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IHdvcmtpbmdEaXJlY3RvcnkgPSBub2RlLmNvbmZpZy53b3JraW5nX2RpcmVjdG9yeS52YWx1ZTsNCiAgICBjb25zdCB0aW1lb3V0ID0gcGFyc2VJbnQobm9kZS5jb25maWcudGltZW91dC52YWx1ZSk7DQoNCiAgICBsZXQgZmluYWxDb21tYW5kID0gY29tbWFuZDsNCiAgICBpZiAodXNlSW5wdXRDb21tYW5kICYmIGlucHV0RGF0YS5jb21tYW5kKSB7DQogICAgICAgIGZpbmFsQ29tbWFuZCA9IGlucHV0RGF0YS5jb21tYW5kOw0KICAgIH0NCg0KICAgIHRyeSB7DQogICAgICAgIC8vIFRoaXMgd291bGQgbmVlZCB0byBiZSBpbXBsZW1lbnRlZCB3aXRoIGFjdHVhbCB0ZXJtaW5hbCBleGVjdXRpb24NCiAgICAgICAgLy8gRm9yIG5vdywgd2UnbGwgcmV0dXJuIGEgcGxhY2Vob2xkZXINCg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgb3V0cHV0OiBgQ29tbWFuZCBleGVjdXRlZDogJHtmaW5hbENvbW1hbmR9YCwNCiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsDQogICAgICAgICAgICBlcnJvcjogbnVsbCwNCiAgICAgICAgICAgIGV4aXRfY29kZTogMA0KICAgICAgICB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Rlcm1pbmFsIGV4ZWN1dGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBvdXRwdXQ6IG51bGwsDQogICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwNCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLA0KICAgICAgICAgICAgZXhpdF9jb2RlOiAxDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQovLyBFeHBvcnQgdG8gZ2xvYmFsIHNjb3BlDQp3aW5kb3cuYWlFeGVjdXRvcnMgPSB7DQogICAgZXhlY3V0ZUxsbUNoYXROb2RlLA0KICAgIGV4ZWN1dGVUZXJtaW5hbE5vZGUNCn07DQoNCi8vIGV4ZWN1dGlvbi1lbmdpbmUuanMgLSBEeW5hbWljIGV4ZWN1dGlvbiBlbmdpbmUgZm9yIEZsb3cgRWRpdG9yDQoNCmNsYXNzIEV4ZWN1dGlvbkVuZ2luZSB7DQogICAgY29uc3RydWN0b3IocmVnaXN0cnkpIHsNCiAgICAgICAgdGhpcy5yZWdpc3RyeSA9IHJlZ2lzdHJ5Ow0KICAgICAgICB0aGlzLnNldHVwRXhlY3V0b3JzKCk7DQogICAgfQ0KDQogICAgc2V0dXBFeGVjdXRvcnMoKSB7DQogICAgICAgIC8vIFJlZ2lzdGVyIGV4ZWN1dG9ycyBmcm9tIGV4dGVybmFsIGZpbGVzIHdpdGggZW5naW5lIGluc3RhbmNlIHBhc3NlZCBhcyBmaXJzdCBwYXJhbWV0ZXINCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdodHRwX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93Lmh0dHBFeGVjdXRvcnMuZXhlY3V0ZUh0dHBOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd2ZnNfc2F2ZV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5odHRwRXhlY3V0b3JzLmV4ZWN1dGVWZnNTYXZlTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigndmZzX2xvYWRfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuaHR0cEV4ZWN1dG9ycy5leGVjdXRlVmZzTG9hZE5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3Zmc19kaXJlY3RvcnlfbGlzdF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5odHRwRXhlY3V0b3JzLmV4ZWN1dGVWZnNEaXJlY3RvcnlMaXN0Tm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgICAgICANCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd0aW1lcl9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5mbG93RXhlY3V0b3JzLmV4ZWN1dGVUaW1lck5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2Rpc3BsYXlfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZmxvd0V4ZWN1dG9ycy5leGVjdXRlRGlzcGxheU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3JlcGVhdGVyX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmZsb3dFeGVjdXRvcnMuZXhlY3V0ZVJlcGVhdGVyTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignY29uZGl0aW9uX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmZsb3dFeGVjdXRvcnMuZXhlY3V0ZUNvbmRpdGlvbk5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2xvZ2ljYWxfZ2F0ZV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5mbG93RXhlY3V0b3JzLmV4ZWN1dGVMb2dpY2FsR2F0ZU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2Zvcl9lYWNoX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmZsb3dFeGVjdXRvcnMuZXhlY3V0ZUZvckVhY2hOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdkZWxheV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5mbG93RXhlY3V0b3JzLmV4ZWN1dGVEZWxheU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICAgICAgDQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignYXVkaW9fZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cubWVkaWFFeGVjdXRvcnMuZXhlY3V0ZUF1ZGlvTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignaW1hZ2VfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cubWVkaWFFeGVjdXRvcnMuZXhlY3V0ZUltYWdlTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgICAgICANCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdqc29uX2V4dHJhY3RfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZGF0YUV4ZWN1dG9ycy5leGVjdXRlSnNvbkV4dHJhY3ROb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdyYW5kb21fbGluZV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVSYW5kb21RdW90ZU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3RleHRfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZGF0YUV4ZWN1dG9ycy5leGVjdXRlVGV4dE5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ21hdGhfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZGF0YUV4ZWN1dG9ycy5leGVjdXRlTWF0aE5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2FycmF5X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmRhdGFFeGVjdXRvcnMuZXhlY3V0ZUFycmF5Tm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignc3RyaW5nX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmRhdGFFeGVjdXRvcnMuZXhlY3V0ZVN0cmluZ05vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ25vZGVfcmVmZXJlbmNlX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmRhdGFFeGVjdXRvcnMuZXhlY3V0ZU5vZGVSZWZlcmVuY2VOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdyYW5kb21fZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZGF0YUV4ZWN1dG9ycy5leGVjdXRlUmFuZG9tTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgICAgICANCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdsbG1fY2hhdF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5haUV4ZWN1dG9ycy5leGVjdXRlTGxtQ2hhdE5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3Rlcm1pbmFsX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmFpRXhlY3V0b3JzLmV4ZWN1dGVUZXJtaW5hbE5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgIH0NCg0KICAgIGFzeW5jIGV4ZWN1dGVOb2RlKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICAgICAgY29uc3Qgbm9kZURlZiA9IHRoaXMucmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICAgICAgaWYgKCFub2RlRGVmKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIG5vZGUgZGVmaW5pdGlvbiBmb3VuZCBmb3IgdHlwZTogJHtub2RlLnR5cGV9YCk7DQogICAgICAgIH0NCg0KICAgICAgICBjb25zdCBleGVjdXRvck5hbWUgPSBub2RlRGVmLmV4ZWN1dG9yOw0KICAgICAgICBjb25zdCBleGVjdXRvciA9IHRoaXMucmVnaXN0cnkuZ2V0RXhlY3V0b3IoZXhlY3V0b3JOYW1lKTsNCg0KICAgICAgICBpZiAoIWV4ZWN1dG9yKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIGV4ZWN1dG9yIGZvdW5kIGZvcjogJHtleGVjdXRvck5hbWV9YCk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gYXdhaXQgZXhlY3V0b3Iobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCk7DQogICAgfQ0KDQoNCg0KICAgIC8vIFN0b3AgcmVwZWF0ZXIgbWV0aG9kDQogICAgc3RvcFJlcGVhdGVyKG5vZGUpIHsNCiAgICAgICAgaWYgKG5vZGUucmVwZWF0ZXJTdGF0ZSAmJiBub2RlLnJlcGVhdGVyU3RhdGUuaW50ZXJ2YWwpIHsNCiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwobm9kZS5yZXBlYXRlclN0YXRlLmludGVydmFsKTsNCiAgICAgICAgICAgIG5vZGUucmVwZWF0ZXJTdGF0ZS5pbnRlcnZhbCA9IG51bGw7DQogICAgICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUuaXNSdW5uaW5nID0gZmFsc2U7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBTdG9wIGZvciBlYWNoIG1ldGhvZA0KICAgIHN0b3BGb3JFYWNoKG5vZGUpIHsNCiAgICAgICAgaWYgKG5vZGUuZm9yRWFjaFN0YXRlICYmIG5vZGUuZm9yRWFjaFN0YXRlLmludGVydmFsKSB7DQogICAgICAgICAgICBjbGVhckludGVydmFsKG5vZGUuZm9yRWFjaFN0YXRlLmludGVydmFsKTsNCiAgICAgICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmludGVydmFsID0gbnVsbDsNCiAgICAgICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmlzSXRlcmF0aW5nID0gZmFsc2U7DQogICAgICAgIH0NCiAgICB9DQoNCg0KDQoNCn0NCg0KLy8gR2xvYmFsIGV4ZWN1dGlvbiBlbmdpbmUgaW5zdGFuY2UNCmNvbnN0IGV4ZWN1dGlvbkVuZ2luZSA9IG5ldyBFeGVjdXRpb25FbmdpbmUobm9kZVJlZ2lzdHJ5KTsNCg0KDQovLyB3b3JrZmxvdy5qcyAtIFdvcmtmbG93IGV4ZWN1dGlvbiBsb2dpYyBmb3IgRmxvdyBFZGl0b3INCg0KLy8gUnVuIHRoZSB3b3JrZmxvdw0KYXN5bmMgZnVuY3Rpb24gcnVuV29ya2Zsb3coKSB7DQogICAgaWYgKGZsb3dFZGl0b3IuaXNSdW5uaW5nKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgZmxvd0VkaXRvci5pc1J1bm5pbmcgPSB0cnVlOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdydW4td29ya2Zsb3cnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9wLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtZmxleCc7DQogICAgDQogICAgLy8gQ2xlYXIgYWxsIHZpc3VhbCBzdGF0ZXMgZnJvbSBwcmV2aW91cyBydW5zDQogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZsb3ctbm9kZScpLmZvckVhY2gobm9kZSA9PiB7DQogICAgICAgIG5vZGUuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycsICd3YWl0aW5nLWlucHV0cycsICdjb21wbGV0ZWQnLCAnZXJyb3InKTsNCiAgICB9KTsNCiAgICANCiAgICAvLyBDbGVhciBvdXRwdXQNCiAgICBjb25zdCBvdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhlY3V0aW9uLW91dHB1dCcpOw0KICAgIG91dHB1dC5pbm5lckhUTUwgPSAnPGRpdiBjbGFzcz0ibG9nLWVudHJ5IGluZm8iPlN0YXJ0aW5nIHdvcmtmbG93IGV4ZWN1dGlvbi4uLjwvZGl2Pic7DQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgLy8gRmluZCBzdGFydCBub2RlcyAobm9kZXMgd2l0aCBubyBpbnB1dHMgdGhhdCBhcmUgcGFydCBvZiBhIGNvbm5lY3RlZCB3b3JrZmxvdykNCiAgICAgICAgY29uc3Qgc3RhcnROb2RlcyA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5ub2Rlcy52YWx1ZXMoKSkuZmlsdGVyKG5vZGUgPT4gew0KICAgICAgICAgICAgY29uc3Qgbm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShub2RlLnR5cGUpOw0KICAgICAgICAgICAgaWYgKCFub2RlRGVmKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBObyBub2RlIGRlZmluaXRpb24gZm91bmQgZm9yIHR5cGU6ICR7bm9kZS50eXBlfWApOw0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBUaW1lciBhbmQgUmVwZWF0ZXIgbm9kZXMgYXJlIHN0YXJ0IG5vZGVzIChjYW4gdHJpZ2dlciB0aGVtc2VsdmVzKQ0KICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ3RpbWVyJyB8fCBub2RlLnR5cGUgPT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAncmVwZWF0ZXInKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzUnVubmluZyA9IG5vZGUucmVwZWF0ZXJTdGF0ZSAmJiBub2RlLnJlcGVhdGVyU3RhdGUuaXNSdW5uaW5nOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvLyBUaW1lci9SZXBlYXRlciBpcyBhIHN0YXJ0IG5vZGUgaWYgaXQgaGFzIGNvbm5lY3RlZCBvdXRwdXRzDQogICAgICAgICAgICAgICAgY29uc3QgaGFzQ29ubmVjdGVkT3V0cHV0cyA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkuc29tZShjb25uID0+IA0KICAgICAgICAgICAgICAgICAgICBjb25uLmZyb20ubm9kZUlkID09PSBub2RlLmlkDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gaGFzQ29ubmVjdGVkT3V0cHV0czsgLy8gVGltZXIvUmVwZWF0ZXIgaXMgYSBzdGFydCBub2RlIGlmIGNvbm5lY3RlZA0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBJZiBub2RlIGhhcyBubyBpbnB1dHMsIGNoZWNrIGlmIGl0J3MgcGFydCBvZiBhIGNvbm5lY3RlZCB3b3JrZmxvdw0KICAgICAgICAgICAgaWYgKG5vZGVEZWYuaW5wdXRzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoaXMgbm9kZSBoYXMgYW55IG91dHB1dHMgdGhhdCBhcmUgY29ubmVjdGVkIHRvIG90aGVyIG5vZGVzDQogICAgICAgICAgICAgICAgY29uc3QgaGFzQ29ubmVjdGVkT3V0cHV0cyA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkuc29tZShjb25uID0+IA0KICAgICAgICAgICAgICAgICAgICBjb25uLmZyb20ubm9kZUlkID09PSBub2RlLmlkDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBPbmx5IGluY2x1ZGUgaWYgaXQncyBjb25uZWN0ZWQgdG8gdGhlIHdvcmtmbG93DQogICAgICAgICAgICAgICAgcmV0dXJuIGhhc0Nvbm5lY3RlZE91dHB1dHM7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFNwZWNpYWwgaGFuZGxpbmcgZm9yIG5vZGVzIHdpdGggb3B0aW9uYWwgaW5wdXRzDQogICAgICAgICAgICBjb25zdCBvcHRpb25hbElucHV0cyA9IG5vZGVEZWYuaW5wdXRzLmZpbHRlcihpbnB1dCA9PiBpbnB1dC5vcHRpb25hbCk7DQogICAgICAgICAgICBpZiAob3B0aW9uYWxJbnB1dHMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoaXMgbm9kZSBoYXMgY29ubmVjdGVkIG91dHB1dHMNCiAgICAgICAgICAgICAgICBjb25zdCBoYXNDb25uZWN0ZWRPdXRwdXRzID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5zb21lKGNvbm4gPT4gDQogICAgICAgICAgICAgICAgICAgIGNvbm4uZnJvbS5ub2RlSWQgPT09IG5vZGUuaWQNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIHJldHVybiBoYXNDb25uZWN0ZWRPdXRwdXRzOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBOb2RlcyB3aXRoIHJlcXVpcmVkIGlucHV0cyBhcmUgbm90IHN0YXJ0IG5vZGVzIC0gdGhleSBzaG91bGQgYmUgdHJpZ2dlcmVkIGJ5IG90aGVyIG5vZGVzDQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgaWYgKHN0YXJ0Tm9kZXMubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHN0YXJ0IG5vZGVzIGZvdW5kLiBBZGQgbm9kZXMgd2l0aCBubyBpbnB1dHMgKFRpbWVyKSBvciBub2RlcyB3aXRoIG9wdGlvbmFsIGlucHV0cyB0aGF0IGFyZW5cJ3QgY29ubmVjdGVkIChIVFRQIFJlcXVlc3QpJyk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEV4ZWN1dGUgd29ya2Zsb3cNCiAgICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGV4ZWN1dGVXb3JrZmxvdyhzdGFydE5vZGVzKTsNCiAgICAgICAgDQogICAgICAgIC8vIERpc3BsYXkgcmVzdWx0cw0KICAgICAgICBvdXRwdXQuaW5uZXJIVE1MICs9ICc8ZGl2IGNsYXNzPSJsb2ctZW50cnkgc3VjY2VzcyI+V29ya2Zsb3cgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSE8L2Rpdj4nOw0KICAgICAgICBmb3IgKGNvbnN0IHJlc3VsdCBvZiByZXN1bHRzKSB7DQogICAgICAgICAgICBvdXRwdXQuaW5uZXJIVE1MICs9IGA8ZGl2IGNsYXNzPSJsb2ctZW50cnkgaW5mbyI+JHtyZXN1bHQubm9kZUlkfTogJHtyZXN1bHQub3V0cHV0fTwvZGl2PmA7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFNlbmQgY29tcGxldGlvbiB2aWEgV2ViU29ja2V0DQogICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNlbmRNZXNzYWdlKSB7DQogICAgICAgICAgICBzeXBuZXhBUEkuc2VuZE1lc3NhZ2UoJ3dvcmtmbG93X2NvbXBsZXRlZCcsIHsNCiAgICAgICAgICAgICAgICByZXN1bHRzOiByZXN1bHRzLA0KICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKQ0KICAgICAgICAgICAgfSwgJ2Zsb3ctZWRpdG9yJyk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignV29ya2Zsb3cgZXhlY3V0aW9uIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgb3V0cHV0LmlubmVySFRNTCArPSBgPGRpdiBjbGFzcz0ibG9nLWVudHJ5IGVycm9yIj5FcnJvcjogJHtlcnJvci5tZXNzYWdlfTwvZGl2PmA7DQogICAgfSBmaW5hbGx5IHsNCiAgICAgICAgZmxvd0VkaXRvci5pc1J1bm5pbmcgPSBmYWxzZTsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3J1bi13b3JrZmxvdycpLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWZsZXgnOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcC13b3JrZmxvdycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgfQ0KfQ0KDQovLyBFeGVjdXRlIHdvcmtmbG93DQphc3luYyBmdW5jdGlvbiBleGVjdXRlV29ya2Zsb3coc3RhcnROb2Rlcykgew0KICAgIGNvbnN0IHJlc3VsdHMgPSBbXTsNCiAgICBjb25zdCBleGVjdXRlZCA9IG5ldyBTZXQoKTsNCiAgICBjb25zdCBub2RlSW5wdXRCdWZmZXIgPSBuZXcgTWFwKCk7IC8vIFRyYWNrIGlucHV0cyBmb3IgbXVsdGktaW5wdXQgbm9kZXMNCiAgICANCiAgICAvLyBTdG9yZSBnbG9iYWxseSBzbyBGb3IgRWFjaCBjYW4gYWNjZXNzIGl0DQogICAgd2luZG93Lmdsb2JhbE5vZGVJbnB1dEJ1ZmZlciA9IG5vZGVJbnB1dEJ1ZmZlcjsNCiAgICANCiAgICBmb3IgKGNvbnN0IHN0YXJ0Tm9kZSBvZiBzdGFydE5vZGVzKSB7DQogICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGV4ZWN1dGVOb2RlKHN0YXJ0Tm9kZSwge30sIGV4ZWN1dGVkLCBub2RlSW5wdXRCdWZmZXIpOw0KICAgICAgICBpZiAocmVzdWx0KSByZXN1bHRzLnB1c2gocmVzdWx0KTsNCiAgICB9DQogICAgDQogICAgcmV0dXJuIHJlc3VsdHM7DQp9DQoNCi8vIEV4ZWN1dGUgYSBzaW5nbGUgbm9kZSAoZHluYW1pYyB2ZXJzaW9uKQ0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZU5vZGUobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCwgbm9kZUlucHV0QnVmZmVyKSB7DQogICAgaWYgKGV4ZWN1dGVkLmhhcyhub2RlLmlkKSkgew0KICAgICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQogICAgZXhlY3V0ZWQuYWRkKG5vZGUuaWQpOw0KICAgIA0KICAgIC8vIE1hcmsgbm9kZSBhcyBydW5uaW5nDQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlLmlkKTsNCiAgICBpZiAobm9kZUVsZW1lbnQpIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3J1bm5pbmcnKTsNCiAgICANCiAgICB0cnkgew0KICAgICAgICAvLyBVc2UgdGhlIGR5bmFtaWMgZXhlY3V0aW9uIGVuZ2luZQ0KICAgICAgICBjb25zdCBvdXRwdXQgPSBhd2FpdCBleGVjdXRpb25FbmdpbmUuZXhlY3V0ZU5vZGUobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCk7DQogICAgICAgIA0KICAgICAgICAvLyBTdG9yZSBvdXRwdXQgZGF0YSBmb3IgY29uZmlnIHBhbmVsIGRpc3BsYXkNCiAgICAgICAgbm9kZS5sYXN0T3V0cHV0RGF0YSA9IG91dHB1dDsNCiAgICAgICAgbm9kZS5sYXN0RXhlY3V0aW9uVGltZSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTsNCiAgICAgICAgDQogICAgICAgIC8vIENoZWNrIGlmIG91dHB1dCBpbmRpY2F0ZXMgZXhlY3V0aW9uIHNob3VsZCBzdG9wIChsb2dpY2FsIGdhdGUgc3BlY2lmaWMpDQogICAgICAgIGlmIChvdXRwdXQgJiYgdHlwZW9mIG91dHB1dCA9PT0gJ29iamVjdCcgJiYgb3V0cHV0Ll9fc3RvcF9leGVjdXRpb24gPT09IHRydWUpIHsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTWFyayBub2RlIGFzIGNvbXBsZXRlZA0KICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NvbXBsZXRlZCcpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICByZXR1cm4geyBub2RlSWQ6IG5vZGUuaWQsIG91dHB1dDogbnVsbCB9Ow0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBDaGVjayBmb3IgZm9yX2VhY2ggY29udHJvbCBmbGFnIC0gc2tpcCBkb3duc3RyZWFtIGV4ZWN1dGlvbiwgbGV0IGludGVydmFsIGhhbmRsZSBpdA0KICAgICAgICBpZiAob3V0cHV0ICYmIHR5cGVvZiBvdXRwdXQgPT09ICdvYmplY3QnICYmIG91dHB1dC5fX2Zvcl9lYWNoX2NvbnRyb2wgPT09IHRydWUpIHsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTWFyayBub2RlIGFzIGNvbXBsZXRlZCBidXQgZG9uJ3QgZXhlY3V0ZSBkb3duc3RyZWFtIG5vZGVzDQogICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJyk7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIHJldHVybiB7IG5vZGVJZDogbm9kZS5pZCwgb3V0cHV0OiBvdXRwdXQgfTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gRmluZCBjb25uZWN0ZWQgbm9kZXMgYW5kIGV4ZWN1dGUgdGhlbQ0KICAgICAgICBjb25zdCBjb25uZWN0ZWROb2RlcyA9IGZpbmRDb25uZWN0ZWROb2Rlcyhub2RlLmlkKTsNCiAgICAgICAgDQogICAgICAgIGZvciAoY29uc3QgY29ubmVjdGVkTm9kZSBvZiBjb25uZWN0ZWROb2Rlcykgew0KICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIGN5Y2xlcyBiZWZvcmUgZXhlY3V0aW5nDQogICAgICAgICAgICBpZiAoZXhlY3V0ZWQuaGFzKGNvbm5lY3RlZE5vZGUubm9kZS5pZCkpIHsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBIYW5kbGUgb3V0cHV0IG1hcHBpbmcgdG8gaW5wdXQgcG9ydHMgLSBESVJFQ1QgTUFQUElORw0KICAgICAgICAgICAgbGV0IGlucHV0VmFsdWUgPSBvdXRwdXQ7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChvdXRwdXQgaW5zdGFuY2VvZiBCbG9iKSB7DQogICAgICAgICAgICAgICAgLy8gQmxvYiBvdXRwdXQgLSBwYXNzIGRpcmVjdGx5IHRvIHRoZSBpbnB1dCBwb3J0DQogICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IG91dHB1dDsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG91dHB1dCA9PT0gJ29iamVjdCcgJiYgb3V0cHV0ICE9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgLy8gT2JqZWN0IG91dHB1dCAtIGV4dHJhY3QgdGhlIEVYQUNUIG91dHB1dCBwb3J0IGZpZWxkDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgKGNvbm5lY3RlZE5vZGUub3V0cHV0UG9ydCBpbiBvdXRwdXQpIHsNCiAgICAgICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IG91dHB1dFtjb25uZWN0ZWROb2RlLm91dHB1dFBvcnRdOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYE5vZGUgJHtub2RlLmlkfSAtPiAke2Nvbm5lY3RlZE5vZGUubm9kZS5pZH06IEVSUk9SIC0gT3V0cHV0IHBvcnQgJyR7Y29ubmVjdGVkTm9kZS5vdXRwdXRQb3J0fScgbm90IGZvdW5kIGluIG91dHB1dCFgKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgQXZhaWxhYmxlIGZpZWxkczpgLCBPYmplY3Qua2V5cyhvdXRwdXQpKTsNCiAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCB0aGlzIGNvbm5lY3Rpb24gaW5zdGVhZCBvZiBwYXNzaW5nIG51bGwNCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvLyBTaW1wbGUgdmFsdWUgb3V0cHV0IC0gcGFzcyBkaXJlY3RseQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgLy8gVXNlIHNtYXJ0IGV4ZWN1dGlvbiB0aGF0IGhhbmRsZXMgbXVsdGktaW5wdXQgc3luY2hyb25pemF0aW9uDQogICAgICAgICAgICAgICAgYXdhaXQgZXhlY3V0ZU5vZGVTbWFydChjb25uZWN0ZWROb2RlLm5vZGUsIGNvbm5lY3RlZE5vZGUuaW5wdXRQb3J0LCBpbnB1dFZhbHVlLCBleGVjdXRlZCwgbm9kZUlucHV0QnVmZmVyKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZXhlY3V0aW5nIGNvbm5lY3RlZCBub2RlICR7Y29ubmVjdGVkTm9kZS5ub2RlLmlkfTpgLCBlcnJvcik7DQogICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0UGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhlY3V0aW9uLW91dHB1dCcpOw0KICAgICAgICAgICAgICAgIG91dHB1dFBhbmVsLmlubmVySFRNTCArPSBgPGRpdiBjbGFzcz0ibG9nLWVudHJ5IGVycm9yIj5FcnJvciBpbiBjb25uZWN0ZWQgbm9kZSAke2Nvbm5lY3RlZE5vZGUubm9kZS5pZH06ICR7ZXJyb3IubWVzc2FnZX08L2Rpdj5gOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBNYXJrIG5vZGUgYXMgY29tcGxldGVkDQogICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHJldHVybiB7IG5vZGVJZDogbm9kZS5pZCwgb3V0cHV0OiBvdXRwdXQgfTsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZXhlY3V0aW5nIG5vZGUgJHtub2RlLmlkfTpgLCBlcnJvcik7DQogICAgICAgIA0KICAgICAgICAvLyBNYXJrIG5vZGUgYXMgZXJyb3INCiAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJyk7DQogICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlcnJvcicpOw0KICAgIH0NCiAgICANCiAgICAgICAgdGhyb3cgZXJyb3I7DQogICAgfSBmaW5hbGx5IHsNCiAgICAgICAgLy8gUmVtb3ZlIHJ1bm5pbmcgc3RhdGUNCiAgICAgICAgaWYgKG5vZGVFbGVtZW50KSBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJyk7DQogICAgfQ0KfQ0KDQovLyBTbWFydCBleGVjdXRpb24gZnVuY3Rpb24gdGhhdCBoYW5kbGVzIG11bHRpLWlucHV0IHN5bmNocm9uaXphdGlvbg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZU5vZGVTbWFydChub2RlLCBpbnB1dFBvcnQsIGlucHV0VmFsdWUsIGV4ZWN1dGVkLCBub2RlSW5wdXRCdWZmZXIpIHsNCiAgICBjb25zdCBub2RlSWQgPSBub2RlLmlkOw0KICAgIA0KICAgIC8vIEdldCBhbGwgY29ubmVjdGVkIGlucHV0IHBvcnRzIGZvciB0aGlzIG5vZGUNCiAgICBjb25zdCBjb25uZWN0ZWRJbnB1dFBvcnRzID0gZ2V0Q29ubmVjdGVkSW5wdXRQb3J0cyhub2RlSWQpOw0KICAgIA0KICAgIGNvbnNvbGUubG9nKGDwn5SnIGV4ZWN1dGVOb2RlU21hcnQgZm9yICR7bm9kZS50eXBlfSBub2RlICR7bm9kZUlkfTpgLCB7DQogICAgICAgIGlucHV0UG9ydCwNCiAgICAgICAgaW5wdXRWYWx1ZSwNCiAgICAgICAgY29ubmVjdGVkSW5wdXRQb3J0cywNCiAgICAgICAgY29ubmVjdGVkUG9ydHNDb3VudDogY29ubmVjdGVkSW5wdXRQb3J0cy5sZW5ndGgNCiAgICB9KTsNCiAgICANCiAgICAvLyBJZiBub2RlIGhhcyAwIG9yIDEgaW5wdXQgY29ubmVjdGlvbnMsIGV4ZWN1dGUgaW1tZWRpYXRlbHkNCiAgICBpZiAoY29ubmVjdGVkSW5wdXRQb3J0cy5sZW5ndGggPD0gMSkgew0KICAgICAgICBjb25zb2xlLmxvZyhg8J+agCBFeGVjdXRpbmcgaW1tZWRpYXRlbHkgKCR7Y29ubmVjdGVkSW5wdXRQb3J0cy5sZW5ndGh9IGNvbm5lY3RlZCBwb3J0cylgKTsNCiAgICAgICAgcmV0dXJuIGF3YWl0IGV4ZWN1dGVOb2RlKG5vZGUsIHsgW2lucHV0UG9ydF06IGlucHV0VmFsdWUgfSwgZXhlY3V0ZWQsIG5vZGVJbnB1dEJ1ZmZlcik7DQogICAgfQ0KICAgIA0KICAgIC8vIE11bHRpLWlucHV0IG5vZGUgLSBuZWVkIHRvIGNvbGxlY3QgYWxsIGlucHV0cyBiZWZvcmUgZXhlY3V0aW5nDQogICAgaWYgKCFub2RlSW5wdXRCdWZmZXIuaGFzKG5vZGVJZCkpIHsNCiAgICAgICAgbm9kZUlucHV0QnVmZmVyLnNldChub2RlSWQsIHsNCiAgICAgICAgICAgIHJlY2VpdmVkSW5wdXRzOiB7fSwNCiAgICAgICAgICAgIGNvbm5lY3RlZFBvcnRzOiBjb25uZWN0ZWRJbnB1dFBvcnRzDQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgLy8gTWFyayBub2RlIGFzIHdhaXRpbmcgZm9yIGlucHV0cyAodmlzdWFsIGZlZWRiYWNrKQ0KICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnd2FpdGluZy1pbnB1dHMnKTsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2NvbXBsZXRlZCcsICdlcnJvcicpOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGJ1ZmZlciA9IG5vZGVJbnB1dEJ1ZmZlci5nZXQobm9kZUlkKTsNCiAgICANCiAgICBjb25zb2xlLmxvZyhg8J+UpyBCdWZmZXIgdXBkYXRlIEJFRk9SRSBmb3IgJHtub2RlLnR5cGV9IG5vZGUgJHtub2RlSWR9OmAsIHsNCiAgICAgICAgaW5wdXRQb3J0LA0KICAgICAgICBpbnB1dFZhbHVlLA0KICAgICAgICByZWNlaXZlZElucHV0c0JlZm9yZTogeyAuLi5idWZmZXIucmVjZWl2ZWRJbnB1dHMgfSwNCiAgICAgICAgY29ubmVjdGVkUG9ydHM6IGJ1ZmZlci5jb25uZWN0ZWRQb3J0cywNCiAgICAgICAgcmVjZWl2ZWRLZXlzQmVmb3JlOiBPYmplY3Qua2V5cyhidWZmZXIucmVjZWl2ZWRJbnB1dHMpLA0KICAgICAgICBtaXNzaW5nUG9ydHM6IGJ1ZmZlci5jb25uZWN0ZWRQb3J0cy5maWx0ZXIocG9ydCA9PiAhKHBvcnQgaW4gYnVmZmVyLnJlY2VpdmVkSW5wdXRzKSkNCiAgICB9KTsNCiAgICANCiAgICAvLyBTdG9yZSB0aGlzIGlucHV0DQogICAgYnVmZmVyLnJlY2VpdmVkSW5wdXRzW2lucHV0UG9ydF0gPSBpbnB1dFZhbHVlOw0KICAgIA0KICAgIGNvbnNvbGUubG9nKGDwn5SnIEJ1ZmZlciB1cGRhdGUgQUZURVIgZm9yICR7bm9kZS50eXBlfSBub2RlICR7bm9kZUlkfTpgLCB7DQogICAgICAgIHJlY2VpdmVkSW5wdXRzQWZ0ZXI6IHsgLi4uYnVmZmVyLnJlY2VpdmVkSW5wdXRzIH0sDQogICAgICAgIHJlY2VpdmVkS2V5c0FmdGVyOiBPYmplY3Qua2V5cyhidWZmZXIucmVjZWl2ZWRJbnB1dHMpDQogICAgfSk7DQogICAgDQogICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBhbGwgcmVxdWlyZWQgaW5wdXRzDQogICAgY29uc3QgaGFzQWxsSW5wdXRzID0gYnVmZmVyLmNvbm5lY3RlZFBvcnRzLmV2ZXJ5KHBvcnQgPT4gcG9ydCBpbiBidWZmZXIucmVjZWl2ZWRJbnB1dHMpOw0KICAgIA0KICAgIGNvbnNvbGUubG9nKGDwn5SnIElucHV0IGNoZWNrIGZvciAke25vZGUudHlwZX0gbm9kZSAke25vZGVJZH06YCwgew0KICAgICAgICBoYXNBbGxJbnB1dHMsDQogICAgICAgIHJlcXVpcmVkUG9ydHM6IGJ1ZmZlci5jb25uZWN0ZWRQb3J0cywNCiAgICAgICAgcmVjZWl2ZWRQb3J0czogT2JqZWN0LmtleXMoYnVmZmVyLnJlY2VpdmVkSW5wdXRzKQ0KICAgIH0pOw0KICAgIA0KICAgIGlmICghaGFzQWxsSW5wdXRzKSB7DQogICAgICAgIGNvbnNvbGUubG9nKGDij7MgU3RpbGwgd2FpdGluZyBmb3IgaW5wdXRzIG9uICR7bm9kZS50eXBlfSBub2RlICR7bm9kZUlkfWApOw0KICAgICAgICAvLyBTdGlsbCB3YWl0aW5nIGZvciBtb3JlIGlucHV0cw0KICAgICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQogICAgDQogICAgLy8gQWxsIGlucHV0cyByZWFkeSAtIHJlbW92ZSB3YWl0aW5nIHN0YXRlIGFuZCBleGVjdXRlIQ0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnd2FpdGluZy1pbnB1dHMnKTsNCiAgICB9DQogICAgDQogICAgDQogICAgLy8gQ2xlYXIgYnVmZmVyIGZvciBuZXh0IGV4ZWN1dGlvbg0KICAgIG5vZGVJbnB1dEJ1ZmZlci5kZWxldGUobm9kZUlkKTsNCiAgICANCiAgICAvLyBFeGVjdXRlIHdpdGggYWxsIGFnZ3JlZ2F0ZWQgaW5wdXRzDQogICAgcmV0dXJuIGF3YWl0IGV4ZWN1dGVOb2RlKG5vZGUsIGJ1ZmZlci5yZWNlaXZlZElucHV0cywgZXhlY3V0ZWQsIG5vZGVJbnB1dEJ1ZmZlcik7DQp9DQoNCi8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgY29ubmVjdGVkIGlucHV0IHBvcnRzIGZvciBhIG5vZGUNCmZ1bmN0aW9uIGdldENvbm5lY3RlZElucHV0UG9ydHMobm9kZUlkKSB7DQogICAgbGV0IGNvbm5lY3Rpb25zID0gbnVsbDsNCiAgICANCiAgICAvLyBEZWJ1ZzogTG9nIHdoYXQncyBhdmFpbGFibGUgb24gZmxvd0VkaXRvciAodHJ5IGJvdGggd2luZG93LmZsb3dFZGl0b3IgYW5kIGZsb3dFZGl0b3IpDQogICAgDQogICAgLy8gVHJ5IHRvIGFjY2VzcyBmbG93RWRpdG9yIGRpcmVjdGx5IChub3QgdmlhIHdpbmRvdykNCiAgICBsZXQgZWRpdG9yID0gbnVsbDsNCiAgICBpZiAodHlwZW9mIGZsb3dFZGl0b3IgIT09ICd1bmRlZmluZWQnICYmIGZsb3dFZGl0b3IpIHsNCiAgICAgICAgZWRpdG9yID0gZmxvd0VkaXRvcjsNCiAgICB9IGVsc2UgaWYgKHdpbmRvdy5mbG93RWRpdG9yKSB7DQogICAgICAgIGVkaXRvciA9IHdpbmRvdy5mbG93RWRpdG9yOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBbXTsNCiAgICB9DQogICAgDQogICAgDQogICAgLy8gVHJ5IG11bHRpcGxlIHdheXMgdG8gYWNjZXNzIGNvbm5lY3Rpb25zIGRhdGENCiAgICBpZiAoZWRpdG9yLmNvbm5lY3Rpb25zKSB7DQogICAgICAgIGNvbm5lY3Rpb25zID0gZWRpdG9yLmNvbm5lY3Rpb25zOw0KICAgIH0gZWxzZSBpZiAoZWRpdG9yLndvcmtmbG93ICYmIGVkaXRvci53b3JrZmxvdy5jb25uZWN0aW9ucykgew0KICAgICAgICBjb25uZWN0aW9ucyA9IG5ldyBNYXAoZWRpdG9yLndvcmtmbG93LmNvbm5lY3Rpb25zLm1hcChjb25uID0+IFtjb25uLmlkLCBjb25uXSkpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBbXTsNCiAgICB9DQogICAgDQogICAgY29uc3QgYWxsQ29ubmVjdGlvbnMgPSBBcnJheS5mcm9tKGNvbm5lY3Rpb25zLnZhbHVlcygpKTsNCiAgICANCiAgICAvLyBMb2cgYWxsIGNvbm5lY3Rpb25zIGZvciBkZWJ1Z2dpbmcNCiAgICBhbGxDb25uZWN0aW9ucy5mb3JFYWNoKChjb25uLCBpbmRleCkgPT4gew0KICAgIH0pOw0KICAgIA0KICAgIGNvbnN0IGNvbm5lY3RlZFBvcnRzID0gYWxsQ29ubmVjdGlvbnMNCiAgICAgICAgLmZpbHRlcihjb25uID0+IHsNCiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBjb25uLnRvLm5vZGVJZCA9PT0gbm9kZUlkOw0KICAgICAgICAgICAgaWYgKG1hdGNoZXMpIHsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBtYXRjaGVzOw0KICAgICAgICB9KQ0KICAgICAgICAubWFwKGNvbm4gPT4gY29ubi50by5wb3J0TmFtZSk7DQogICAgICAgIA0KICAgIHJldHVybiBjb25uZWN0ZWRQb3J0czsNCn0NCiAgICANCi8vIEhlbHBlciBmdW5jdGlvbiB0byB1cGRhdGUgZGlzcGxheSBub2RlIGNvbnRlbnQgKHVzZWQgYnkgZXhlY3V0aW9uIGVuZ2luZSkNCmZ1bmN0aW9uIHVwZGF0ZURpc3BsYXlOb2RlQ29udGVudChub2RlSWQsIGNvbnRlbnQsIGZvcm1hdCkgew0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGVFbGVtZW50KSByZXR1cm47DQogICAgDQogICAgY29uc3QgZGlzcGxheVRleHQgPSBub2RlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZGlzcGxheS10ZXh0Jyk7DQogICAgY29uc3QgZm9ybWF0RWxlbWVudCA9IG5vZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kaXNwbGF5LWZvcm1hdCBzcGFuJyk7DQogICAgDQogICAgaWYgKGRpc3BsYXlUZXh0KSB7DQogICAgICAgIGxldCBmb3JtYXR0ZWRDb250ZW50ID0gY29udGVudDsNCiAgICAgICAgDQogICAgc3dpdGNoIChmb3JtYXQpIHsNCiAgICAgICAgY2FzZSAnanNvbic6DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWQgPSB0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKGNvbnRlbnQpIDogY29udGVudDsNCiAgICAgICAgICAgICAgICAgICAgZm9ybWF0dGVkQ29udGVudCA9IEpTT04uc3RyaW5naWZ5KHBhcnNlZCwgbnVsbCwgMik7DQogICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2h0bWwnOg0KICAgICAgICAgICAgICAgIGZvcm1hdHRlZENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ3RleHQnOg0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIGZvcm1hdHRlZENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICAgICAgYnJlYWs7DQogICAgfQ0KICAgIA0KICAgICAgICBkaXNwbGF5VGV4dC5pbm5lckhUTUwgPSBgPHByZSBjbGFzcz0iY29udGVudC10ZXh0Ij4ke2VzY2FwZUh0bWwoZm9ybWF0dGVkQ29udGVudCl9PC9wcmU+YDsNCiAgICB9DQogICAgDQogICAgaWYgKGZvcm1hdEVsZW1lbnQpIHsNCiAgICAgICAgZm9ybWF0RWxlbWVudC50ZXh0Q29udGVudCA9IGZvcm1hdDsNCiAgICB9DQogICAgDQogICAgLy8gU3RvcmUgZm9yIGNvbmZpZyBwYW5lbCBkaXNwbGF5DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKG5vZGUpIHsNCiAgICAgICAgbm9kZS5sYXN0Q29udGVudCA9IGNvbnRlbnQ7DQogICAgICAgIG5vZGUubGFzdEZvcm1hdCA9IGZvcm1hdDsNCiAgICB9DQp9DQoNCi8vIEhlbHBlciBmdW5jdGlvbiB0byBlc2NhcGUgSFRNTA0KZnVuY3Rpb24gZXNjYXBlSHRtbCh0ZXh0KSB7DQogICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgZGl2LnRleHRDb250ZW50ID0gdGV4dDsNCiAgICByZXR1cm4gZGl2LmlubmVySFRNTDsNCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHJlcGxhY2UgdGVtcGxhdGUgcGxhY2Vob2xkZXJzDQpmdW5jdGlvbiByZXBsYWNlVGVtcGxhdGVQbGFjZWhvbGRlcnModGVtcGxhdGUsIGRhdGEpIHsNCiAgICBpZiAodHlwZW9mIHRlbXBsYXRlICE9PSAnb2JqZWN0JyB8fCB0ZW1wbGF0ZSA9PT0gbnVsbCkgew0KICAgICAgICByZXR1cm4gdGVtcGxhdGU7DQogICAgfQ0KICAgIA0KICAgIGlmIChBcnJheS5pc0FycmF5KHRlbXBsYXRlKSkgew0KICAgICAgICByZXR1cm4gdGVtcGxhdGUubWFwKGl0ZW0gPT4gcmVwbGFjZVRlbXBsYXRlUGxhY2Vob2xkZXJzKGl0ZW0sIGRhdGEpKTsNCiAgICB9DQogICAgDQogICAgY29uc3QgcmVzdWx0ID0ge307DQogICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXModGVtcGxhdGUpKSB7DQogICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICBsZXQgcmVwbGFjZWRWYWx1ZSA9IHZhbHVlOw0KICAgIA0KICAgICAgICAgICAgLy8gUmVwbGFjZSB7e1ZBTFVFfX0gd2l0aCB0aGUgZnVsbCBkYXRhIG9iamVjdA0KICAgICAgICAgICAgaWYgKHZhbHVlLmluY2x1ZGVzKCd7e1ZBTFVFfX0nKSkgew0KICAgICAgICAgICAgICAgIHJlcGxhY2VkVmFsdWUgPSB2YWx1ZS5yZXBsYWNlKCd7e1ZBTFVFfX0nLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7DQp9DQoNCiAgICAgICAgICAgIC8vIFJlcGxhY2Uge3tKU09OOmZpZWxkfX0gd2l0aCBzcGVjaWZpYyBmaWVsZA0KICAgICAgICAgICAgY29uc3QganNvbk1hdGNoZXMgPSB2YWx1ZS5tYXRjaCgvXHtce0pTT046KFtefV0rKVx9XH0vZyk7DQogICAgICAgICAgICBpZiAoanNvbk1hdGNoZXMpIHsNCiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIGpzb25NYXRjaGVzKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gbWF0Y2gubWF0Y2goL1x7XHtKU09OOihbXn1dKylcfVx9LylbMV07DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBnZXROZXN0ZWRWYWx1ZShkYXRhLCBmaWVsZCk7DQogICAgICAgICAgICAgICAgICAgIHJlcGxhY2VkVmFsdWUgPSByZXBsYWNlZFZhbHVlLnJlcGxhY2UobWF0Y2gsIEpTT04uc3RyaW5naWZ5KGZpZWxkVmFsdWUpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgICAgICAgICAgLy8gUmVwbGFjZSB7e2ZpZWxkfX0gd2l0aCBzcGVjaWZpYyBmaWVsZCB2YWx1ZQ0KICAgICAgICAgICAgY29uc3QgZmllbGRNYXRjaGVzID0gdmFsdWUubWF0Y2goL1x7XHsoW159XSspXH1cfS9nKTsNCiAgICAgICAgICAgIGlmIChmaWVsZE1hdGNoZXMpIHsNCiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIGZpZWxkTWF0Y2hlcykgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZCA9IG1hdGNoLm1hdGNoKC9ce1x7KFtefV0rKVx9XH0vKVsxXTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGZpZWxkICE9PSAnVkFMVUUnICYmICFmaWVsZC5zdGFydHNXaXRoKCdKU09OOicpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZFZhbHVlID0gZ2V0TmVzdGVkVmFsdWUoZGF0YSwgZmllbGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZWRWYWx1ZSA9IHJlcGxhY2VkVmFsdWUucmVwbGFjZShtYXRjaCwgZmllbGRWYWx1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gcmVwbGFjZWRWYWx1ZTsNCiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICE9PSBudWxsKSB7DQogICAgICAgICAgICByZXN1bHRba2V5XSA9IHJlcGxhY2VUZW1wbGF0ZVBsYWNlaG9sZGVycyh2YWx1ZSwgZGF0YSk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXN1bHRba2V5XSA9IHZhbHVlOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIHJldHVybiByZXN1bHQ7DQp9DQoNCi8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgbmVzdGVkIG9iamVjdCB2YWx1ZXMNCmZ1bmN0aW9uIGdldE5lc3RlZFZhbHVlKG9iaiwgcGF0aCkgew0KICAgIGNvbnN0IGtleXMgPSBwYXRoLnNwbGl0KCcuJyk7DQogICAgbGV0IGN1cnJlbnQgPSBvYmo7DQogICAgDQogICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgew0KICAgICAgICBpZiAoY3VycmVudCA9PT0gbnVsbCB8fCBjdXJyZW50ID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBIYW5kbGUgYXJyYXkgYWNjZXNzIGxpa2UgIml0ZW1zWzBdLm5hbWUiDQogICAgICAgIGNvbnN0IGFycmF5TWF0Y2ggPSBrZXkubWF0Y2goL14oLispXFsoXGQrKVxdJC8pOw0KICAgICAgICBpZiAoYXJyYXlNYXRjaCkgew0KICAgICAgICAgICAgY29uc3QgYXJyYXlLZXkgPSBhcnJheU1hdGNoWzFdOw0KICAgICAgICAgICAgY29uc3QgYXJyYXlJbmRleCA9IHBhcnNlSW50KGFycmF5TWF0Y2hbMl0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoY3VycmVudFthcnJheUtleV0gJiYgQXJyYXkuaXNBcnJheShjdXJyZW50W2FycmF5S2V5XSkpIHsNCiAgICAgICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFthcnJheUtleV1bYXJyYXlJbmRleF07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFtrZXldOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIHJldHVybiBjdXJyZW50Ow0KfQ0KDQovLyBTdG9wIHdvcmtmbG93IGV4ZWN1dGlvbg0KZnVuY3Rpb24gc3RvcFdvcmtmbG93KCkgew0KICAgICAgICBmbG93RWRpdG9yLmlzUnVubmluZyA9IGZhbHNlOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncnVuLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtZmxleCc7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9wLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgDQogICAgLy8gQ2xlYXIgcnVubmluZyBzdGF0ZXMgZnJvbSBhbGwgbm9kZXMNCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZsb3ctbm9kZS5ydW5uaW5nLCAuZmxvdy1ub2RlLndhaXRpbmctaW5wdXRzJykuZm9yRWFjaChub2RlID0+IHsNCiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycsICd3YWl0aW5nLWlucHV0cycpOw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgY29uc3Qgb3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4ZWN1dGlvbi1vdXRwdXQnKTsNCiAgICBvdXRwdXQuaW5uZXJIVE1MICs9ICc8ZGl2IGNsYXNzPSJsb2ctZW50cnkgd2FybmluZyI+V29ya2Zsb3cgZXhlY3V0aW9uIHN0b3BwZWQgYnkgdXNlcjwvZGl2Pic7DQogICAgDQp9DQoNCi8vIEZpbmQgbm9kZXMgY29ubmVjdGVkIHRvIGEgc3BlY2lmaWMgbm9kZQ0KZnVuY3Rpb24gZmluZENvbm5lY3RlZE5vZGVzKG5vZGVJZCkgew0KICAgIGNvbnN0IGNvbm5lY3RlZE5vZGVzID0gW107DQogICAgDQogICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IG5vZGVJZCkgew0KICAgICAgICAgICAgY29uc3QgdGFyZ2V0Tm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICAgICAgICAgIGlmICh0YXJnZXROb2RlKSB7DQogICAgICAgICAgICAgICAgY29ubmVjdGVkTm9kZXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgIG5vZGU6IHRhcmdldE5vZGUsDQogICAgICAgICAgICAgICAgICAgIGlucHV0UG9ydDogY29ubmVjdGlvbi50by5wb3J0TmFtZSwNCiAgICAgICAgICAgICAgICAgICAgb3V0cHV0UG9ydDogY29ubmVjdGlvbi5mcm9tLnBvcnROYW1lDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIGNvbm5lY3RlZE5vZGVzOw0KfQ0KDQovLyBGb3JtYXQgZGF0YSBmb3IgcHJldmlldyBpbiBjb25maWcgcGFuZWwNCmZ1bmN0aW9uIGZvcm1hdERhdGFQcmV2aWV3KGRhdGEsIG1heExlbmd0aCA9IDIwMCkgew0KICAgIGlmIChkYXRhID09PSBudWxsIHx8IGRhdGEgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICByZXR1cm4geyB0eXBlOiAnbnVsbCcsIHByZXZpZXc6ICdudWxsJyB9Ow0KICAgIH0NCiAgICANCiAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEJsb2IpIHsNCiAgICAgICAgY29uc3Qgc2l6ZUtCID0gKGRhdGEuc2l6ZSAvIDEwMjQpLnRvRml4ZWQoMik7DQogICAgICAgIGNvbnN0IHNpemVNQiA9IGRhdGEuc2l6ZSA+IDEwMjQgKiAxMDI0ID8gYCAoJHsoZGF0YS5zaXplIC8gKDEwMjQgKiAxMDI0KSkudG9GaXhlZCgyKX0gTUIpYCA6ICcnOw0KICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgIHR5cGU6ICdCbG9iJywgDQogICAgICAgICAgICBwcmV2aWV3OiBgJHtkYXRhLnR5cGUgfHwgJ3Vua25vd24nfSAtICR7c2l6ZUtCfSBLQiR7c2l6ZU1CfWAsDQogICAgICAgICAgICBzaXplOiBkYXRhLnNpemUNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgew0KICAgICAgICBjb25zdCBzaXplS0IgPSAoZGF0YS5ieXRlTGVuZ3RoIC8gMTAyNCkudG9GaXhlZCgyKTsNCiAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICB0eXBlOiAnQXJyYXlCdWZmZXInLCANCiAgICAgICAgICAgIHByZXZpZXc6IGBCaW5hcnkgZGF0YSAtICR7c2l6ZUtCfSBLQmAsDQogICAgICAgICAgICBzaXplOiBkYXRhLmJ5dGVMZW5ndGgNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5IHx8IGRhdGEgaW5zdGFuY2VvZiBJbnQ4QXJyYXkgfHwgDQogICAgICAgIGRhdGEgaW5zdGFuY2VvZiBVaW50MTZBcnJheSB8fCBkYXRhIGluc3RhbmNlb2YgSW50MTZBcnJheSB8fA0KICAgICAgICBkYXRhIGluc3RhbmNlb2YgVWludDMyQXJyYXkgfHwgZGF0YSBpbnN0YW5jZW9mIEludDMyQXJyYXkgfHwNCiAgICAgICAgZGF0YSBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheSB8fCBkYXRhIGluc3RhbmNlb2YgRmxvYXQ2NEFycmF5KSB7DQogICAgICAgIGNvbnN0IHNpemVLQiA9IChkYXRhLmJ5dGVMZW5ndGggLyAxMDI0KS50b0ZpeGVkKDIpOw0KICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgIHR5cGU6IGRhdGEuY29uc3RydWN0b3IubmFtZSwgDQogICAgICAgICAgICBwcmV2aWV3OiBgQmluYXJ5IGFycmF5IC0gJHtzaXplS0J9IEtCYCwNCiAgICAgICAgICAgIHNpemU6IGRhdGEuYnl0ZUxlbmd0aA0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICBpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkgew0KICAgICAgICAvLyBDaGVjayBpZiBpdCdzIGxpa2VseSBiaW5hcnkgZGF0YSAoYXJyYXkgb2YgbnVtYmVycyAwLTI1NSkNCiAgICAgICAgaWYgKGRhdGEubGVuZ3RoID4gMCAmJiBkYXRhLmV2ZXJ5KGl0ZW0gPT4gdHlwZW9mIGl0ZW0gPT09ICdudW1iZXInICYmIGl0ZW0gPj0gMCAmJiBpdGVtIDw9IDI1NSkpIHsNCiAgICAgICAgICAgIGNvbnN0IHNpemVLQiA9IChkYXRhLmxlbmd0aCAvIDEwMjQpLnRvRml4ZWQoMik7DQogICAgICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgICAgICB0eXBlOiAnQmluYXJ5IEFycmF5JywgDQogICAgICAgICAgICAgICAgcHJldmlldzogYEJpbmFyeSBkYXRhIGFycmF5IC0gJHtzaXplS0J9IEtCYCwNCiAgICAgICAgICAgICAgICBsZW5ndGg6IGRhdGEubGVuZ3RoDQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25zdCBwcmV2aWV3ID0gZGF0YS5sZW5ndGggPiAzIA0KICAgICAgICAgICAgPyBgWyR7ZGF0YS5zbGljZSgwLCAzKS5tYXAoaXRlbSA9PiBKU09OLnN0cmluZ2lmeShpdGVtKSkuam9pbignLCAnKX0sIC4uLl1gDQogICAgICAgICAgICA6IEpTT04uc3RyaW5naWZ5KGRhdGEpOw0KICAgICAgICBjb25zdCB0cnVuY2F0ZWQgPSBwcmV2aWV3Lmxlbmd0aCA+IG1heExlbmd0aCA/IHByZXZpZXcuc3Vic3RyaW5nKDAsIG1heExlbmd0aCkgKyAnLi4uJyA6IHByZXZpZXc7DQogICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgdHlwZTogJ0FycmF5JywgDQogICAgICAgICAgICBwcmV2aWV3OiB0cnVuY2F0ZWQsDQogICAgICAgICAgICBsZW5ndGg6IGRhdGEubGVuZ3RoDQogICAgICAgIH07DQogICAgfQ0KICAgIA0KICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGRhdGEpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2hlY2sgaWYgaXQgbG9va3MgbGlrZSBhIGxhcmdlIGRhdGEgb2JqZWN0IChoYXMgY29tbW9uIGxhcmdlIGRhdGEgaW5kaWNhdG9ycykNCiAgICAgICAgY29uc3QgaGFzTGFyZ2VEYXRhSW5kaWNhdG9ycyA9IGtleXMuc29tZShrZXkgPT4gDQogICAgICAgICAgICBrZXkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnZGF0YScpIHx8IA0KICAgICAgICAgICAga2V5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2J1ZmZlcicpIHx8DQogICAgICAgICAgICBrZXkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYmFzZTY0JykgfHwNCiAgICAgICAgICAgIGtleS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdiaW5hcnknKQ0KICAgICAgICApOw0KICAgICAgICANCiAgICAgICAgaWYgKGhhc0xhcmdlRGF0YUluZGljYXRvcnMpIHsNCiAgICAgICAgICAgIC8vIENoZWNrIHNpemVzIG9mIHZhbHVlcyB0aGF0IG1pZ2h0IGJlIGxhcmdlDQogICAgICAgICAgICBsZXQgdG90YWxTaXplID0gMDsNCiAgICAgICAgICAgIGxldCBoYXNMYXJnZVZhbHVlcyA9IGZhbHNlOw0KICAgICAgICAgICAgY29uc3Qgc3VtbWFyeSA9IHt9Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBkYXRhW2tleV07DQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUubGVuZ3RoID4gMTAwMCkgew0KICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5W2tleV0gPSBgU3RyaW5nICgkeyh2YWx1ZS5sZW5ndGggLyAxMDI0KS50b0ZpeGVkKDIpfSBLQilgOw0KICAgICAgICAgICAgICAgICAgICB0b3RhbFNpemUgKz0gdmFsdWUubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICBoYXNMYXJnZVZhbHVlcyA9IHRydWU7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7DQogICAgICAgICAgICAgICAgICAgIHN1bW1hcnlba2V5XSA9IGBBcnJheUJ1ZmZlciAoJHsodmFsdWUuYnl0ZUxlbmd0aCAvIDEwMjQpLnRvRml4ZWQoMil9IEtCKWA7DQogICAgICAgICAgICAgICAgICAgIHRvdGFsU2l6ZSArPSB2YWx1ZS5ieXRlTGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICBoYXNMYXJnZVZhbHVlcyA9IHRydWU7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSAmJiB2YWx1ZS5sZW5ndGggPiAxMDAwKSB7DQogICAgICAgICAgICAgICAgICAgIHN1bW1hcnlba2V5XSA9IGBBcnJheVske3ZhbHVlLmxlbmd0aH1dICgkeyh2YWx1ZS5sZW5ndGggLyAxMDI0KS50b0ZpeGVkKDIpfSBLQiBlc3QuKWA7DQogICAgICAgICAgICAgICAgICAgIHRvdGFsU2l6ZSArPSB2YWx1ZS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgIGhhc0xhcmdlVmFsdWVzID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5W2tleV0gPSB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnID8gYCIke3ZhbHVlLnN1YnN0cmluZygwLCAzMCl9Li4uImAgOiB0eXBlb2YgdmFsdWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoaGFzTGFyZ2VWYWx1ZXMpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0xhcmdlIE9iamVjdCcsIA0KICAgICAgICAgICAgICAgICAgICBwcmV2aWV3OiBKU09OLnN0cmluZ2lmeShzdW1tYXJ5LCBudWxsLCAyKSwNCiAgICAgICAgICAgICAgICAgICAga2V5czoga2V5cy5sZW5ndGgsDQogICAgICAgICAgICAgICAgICAgIGVzdGltYXRlZFNpemU6IHRvdGFsU2l6ZQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFJlZ3VsYXIgb2JqZWN0IGhhbmRsaW5nDQogICAgICAgIGNvbnN0IHByZXZpZXcgPSBrZXlzLmxlbmd0aCA+IDMNCiAgICAgICAgICAgID8gYHske2tleXMuc2xpY2UoMCwgMykuam9pbignLCAnKX0sIC4uLn1gDQogICAgICAgICAgICA6IEpTT04uc3RyaW5naWZ5KGRhdGEpOw0KICAgICAgICBjb25zdCB0cnVuY2F0ZWQgPSBwcmV2aWV3Lmxlbmd0aCA+IG1heExlbmd0aCA/IHByZXZpZXcuc3Vic3RyaW5nKDAsIG1heExlbmd0aCkgKyAnLi4uJyA6IHByZXZpZXc7DQogICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgdHlwZTogJ09iamVjdCcsIA0KICAgICAgICAgICAgcHJldmlldzogdHJ1bmNhdGVkLA0KICAgICAgICAgICAga2V5czoga2V5cy5sZW5ndGgNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAvLyBDaGVjayBpZiBpdCdzIGJhc2U2NCBkYXRhDQogICAgICAgIGNvbnN0IGlzQmFzZTY0ID0gL15bQS1aYS16MC05Ky9dKj17MCwyfSQvLnRlc3QoZGF0YSkgJiYgZGF0YS5sZW5ndGggPiAxMDAgJiYgZGF0YS5sZW5ndGggJSA0ID09PSAwOw0KICAgICAgICBpZiAoaXNCYXNlNjQpIHsNCiAgICAgICAgICAgIGNvbnN0IHNpemVLQiA9IChkYXRhLmxlbmd0aCAqIDAuNzUgLyAxMDI0KS50b0ZpeGVkKDIpOyAvLyBCYXNlNjQgaXMgfjMzJSBsYXJnZXIgdGhhbiBiaW5hcnkNCiAgICAgICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgICAgIHR5cGU6ICdCYXNlNjQgRGF0YScsIA0KICAgICAgICAgICAgICAgIHByZXZpZXc6IGBCYXNlNjQgZW5jb2RlZCBkYXRhIC0gJHtzaXplS0J9IEtCYCwNCiAgICAgICAgICAgICAgICBsZW5ndGg6IGRhdGEubGVuZ3RoDQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBDaGVjayBpZiBpdCdzIGEgZGF0YSBVUkwNCiAgICAgICAgaWYgKGRhdGEuc3RhcnRzV2l0aCgnZGF0YTonKSkgew0KICAgICAgICAgICAgY29uc3QgY29tbWFJbmRleCA9IGRhdGEuaW5kZXhPZignLCcpOw0KICAgICAgICAgICAgY29uc3QgaGVhZGVyID0gY29tbWFJbmRleCA+IDAgPyBkYXRhLnN1YnN0cmluZygwLCBjb21tYUluZGV4KSA6IGRhdGEuc3Vic3RyaW5nKDAsIDUwKTsNCiAgICAgICAgICAgIGNvbnN0IGRhdGFTaXplID0gY29tbWFJbmRleCA+IDAgPyBkYXRhLmxlbmd0aCAtIGNvbW1hSW5kZXggLSAxIDogZGF0YS5sZW5ndGg7DQogICAgICAgICAgICBjb25zdCBzaXplS0IgPSAoZGF0YVNpemUgKiAwLjc1IC8gMTAyNCkudG9GaXhlZCgyKTsNCiAgICAgICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgICAgIHR5cGU6ICdEYXRhIFVSTCcsIA0KICAgICAgICAgICAgICAgIHByZXZpZXc6IGAke2hlYWRlcn0uLi4gLSAke3NpemVLQn0gS0JgLA0KICAgICAgICAgICAgICAgIGxlbmd0aDogZGF0YS5sZW5ndGgNCiAgICAgICAgICAgIH07DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFJlZ3VsYXIgc3RyaW5nIGhhbmRsaW5nDQogICAgICAgIGNvbnN0IHRydW5jYXRlZCA9IGRhdGEubGVuZ3RoID4gbWF4TGVuZ3RoID8gZGF0YS5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKSArICcuLi4nIDogZGF0YTsNCiAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICB0eXBlOiAnU3RyaW5nJywgDQogICAgICAgICAgICBwcmV2aWV3OiB0cnVuY2F0ZWQsDQogICAgICAgICAgICBsZW5ndGg6IGRhdGEubGVuZ3RoDQogICAgICAgIH07DQogICAgfQ0KICAgIA0KICAgIHJldHVybiB7IA0KICAgICAgICB0eXBlOiB0eXBlb2YgZGF0YSwgDQogICAgICAgIHByZXZpZXc6IFN0cmluZyhkYXRhKSANCiAgICB9Ow0KfQ0KDQovLyBHZXQgb3V0cHV0IHBvcnQgZGF0YSBmb3IgYSBzcGVjaWZpYyBub2RlIGFuZCBwb3J0DQpmdW5jdGlvbiBnZXRPdXRwdXRQb3J0RGF0YShub2RlSWQsIHBvcnRJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCAhbm9kZS5sYXN0T3V0cHV0RGF0YSkgew0KICAgICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQogICAgDQogICAgLy8gSWYgdGhlIG91dHB1dCBkYXRhIGlzIGFuIG9iamVjdCB3aXRoIG5hbWVkIHBvcnRzLCBleHRyYWN0IHRoZSBzcGVjaWZpYyBwb3J0DQogICAgaWYgKHR5cGVvZiBub2RlLmxhc3RPdXRwdXREYXRhID09PSAnb2JqZWN0JyAmJiBub2RlLmxhc3RPdXRwdXREYXRhICE9PSBudWxsICYmICFBcnJheS5pc0FycmF5KG5vZGUubGFzdE91dHB1dERhdGEpICYmICEobm9kZS5sYXN0T3V0cHV0RGF0YSBpbnN0YW5jZW9mIEJsb2IpICYmICEobm9kZS5sYXN0T3V0cHV0RGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSkgew0KICAgICAgICBpZiAocG9ydElkIGluIG5vZGUubGFzdE91dHB1dERhdGEpIHsNCiAgICAgICAgICAgIHJldHVybiBub2RlLmxhc3RPdXRwdXREYXRhW3BvcnRJZF07DQogICAgICAgIH0NCiAgICAgICAgLy8gUG9ydCBub3QgZm91bmQgaW4gb3V0cHV0IG9iamVjdA0KICAgICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQogICAgDQogICAgLy8gRm9yIHNpbmdsZSBvdXRwdXQgbm9kZXMgb3Igbm9uLW9iamVjdCBvdXRwdXRzIChCbG9iLCBBcnJheUJ1ZmZlciwgcHJpbWl0aXZlcyksIA0KICAgIC8vIG9ubHkgcmV0dXJuIGRhdGEgZm9yIHRoZSBmaXJzdC9wcmltYXJ5IG91dHB1dCBwb3J0DQogICAgY29uc3Qgbm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShub2RlLnR5cGUpOw0KICAgIGlmIChub2RlRGVmICYmIG5vZGVEZWYub3V0cHV0cyAmJiBub2RlRGVmLm91dHB1dHMubGVuZ3RoID4gMCkgew0KICAgICAgICAvLyBPbmx5IHJldHVybiBkYXRhIGZvciB0aGUgZmlyc3Qgb3V0cHV0IHBvcnQsIG90aGVycyBnZXQgbnVsbA0KICAgICAgICBpZiAocG9ydElkID09PSBub2RlRGVmLm91dHB1dHNbMF0uaWQpIHsNCiAgICAgICAgICAgIHJldHVybiBub2RlLmxhc3RPdXRwdXREYXRhOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCiAgICANCiAgICAvLyBGYWxsYmFjazogcmV0dXJuIHRoZSBkYXRhIChzaG91bGRuJ3Qgbm9ybWFsbHkgcmVhY2ggaGVyZSkNCiAgICByZXR1cm4gbm9kZS5sYXN0T3V0cHV0RGF0YTsNCn0gDQoNCi8vIFVwZGF0ZSBjYW52YXMgdHJhbnNmb3JtIGZvciBwYW5uaW5nIGFuZCB6b29taW5nDQpmdW5jdGlvbiB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKSB7DQogICAgaWYgKGZsb3dFZGl0b3IuY2FudmFzKSB7DQogICAgICAgIC8vIFVzZSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgdG8gcHJldmVudCB2aXN1YWwgZmxhc2hpbmcNCiAgICAgICAgaWYgKGZsb3dFZGl0b3IudHJhbnNmb3JtVXBkYXRlUmVxdWVzdGVkKSByZXR1cm47DQogICAgICAgIGZsb3dFZGl0b3IudHJhbnNmb3JtVXBkYXRlUmVxdWVzdGVkID0gdHJ1ZTsNCiAgICAgICAgDQogICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7DQogICAgICAgICAgICBpZiAoZmxvd0VkaXRvci5jYW52YXMpIHsNCiAgICAgICAgICAgICAgICBjb25zdCB0cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKCR7Zmxvd0VkaXRvci5wYW5PZmZzZXQueH1weCwgJHtmbG93RWRpdG9yLnBhbk9mZnNldC55fXB4KSBzY2FsZSgke2Zsb3dFZGl0b3Iuem9vbUxldmVsfSlgOw0KICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zZm9ybSA9IHRyYW5zZm9ybTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgem9vbSBsZXZlbCBkaXNwbGF5DQogICAgICAgICAgICAgICAgY29uc3Qgem9vbURpc3BsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9vbS1sZXZlbCcpOw0KICAgICAgICAgICAgICAgIGlmICh6b29tRGlzcGxheSkgew0KICAgICAgICAgICAgICAgICAgICB6b29tRGlzcGxheS50ZXh0Q29udGVudCA9IE1hdGgucm91bmQoZmxvd0VkaXRvci56b29tTGV2ZWwgKiAxMDApICsgJyUnOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGZsb3dFZGl0b3IudHJhbnNmb3JtVXBkYXRlUmVxdWVzdGVkID0gZmFsc2U7DQogICAgICAgIH0pOw0KICAgIH0NCn0NCg0KLy8gU3RhcnQgY2FudmFzIHBhbm5pbmcNCmZ1bmN0aW9uIHN0YXJ0Q2FudmFzUGFuKGUpIHsNCiAgICAvLyBPbmx5IHN0YXJ0IHBhbm5pbmcgaWYgY2xpY2tpbmcgZGlyZWN0bHkgb24gY2FudmFzIChub3Qgb24gbm9kZXMgb3Igb3RoZXIgZWxlbWVudHMpDQogICAgLy8gYW5kIG5vdCBhbHJlYWR5IGRyYWdnaW5nIGEgbm9kZQ0KICAgIGlmIChlLnRhcmdldCA9PT0gZmxvd0VkaXRvci5jYW52YXMgJiYgIWZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKSB7DQogICAgICAgIGZsb3dFZGl0b3IuaXNQYW5uaW5nID0gdHJ1ZTsNCiAgICAgICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOg0KICAgICAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgICAgICBmbG93RWRpdG9yLnBhblN0YXJ0ID0geyB4OiBtb3VzZUNvb3Jkcy54LCB5OiBtb3VzZUNvb3Jkcy55IH07DQogICAgICAgIGZsb3dFZGl0b3IubGFzdFBhbk9mZnNldCA9IHsgLi4uZmxvd0VkaXRvci5wYW5PZmZzZXQgfTsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUuY3Vyc29yID0gJ2dyYWJiaW5nJzsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuY2xhc3NMaXN0LmFkZCgncGFubmluZycpOw0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgfQ0KfQ0KDQovLyBVcGRhdGUgY2FudmFzIHBhbm5pbmcNCmZ1bmN0aW9uIHVwZGF0ZUNhbnZhc1BhbihlKSB7DQogICAgaWYgKGZsb3dFZGl0b3IuaXNQYW5uaW5nKSB7DQogICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPw0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDoNCiAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgY29uc3QgZGVsdGFYID0gbW91c2VDb29yZHMueCAtIGZsb3dFZGl0b3IucGFuU3RhcnQueDsNCiAgICAgICAgY29uc3QgZGVsdGFZID0gbW91c2VDb29yZHMueSAtIGZsb3dFZGl0b3IucGFuU3RhcnQueTsNCg0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gZmxvd0VkaXRvci5sYXN0UGFuT2Zmc2V0LnggKyBkZWx0YVg7DQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSBmbG93RWRpdG9yLmxhc3RQYW5PZmZzZXQueSArIGRlbHRhWTsNCg0KICAgICAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIH0NCn0NCg0KLy8gU3RvcCBjYW52YXMgcGFubmluZw0KZnVuY3Rpb24gc3RvcENhbnZhc1BhbigpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5pc1Bhbm5pbmcpIHsNCiAgICAgICAgZmxvd0VkaXRvci5pc1Bhbm5pbmcgPSBmYWxzZTsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUuY3Vyc29yID0gJ2dyYWInOw0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5jbGFzc0xpc3QucmVtb3ZlKCdwYW5uaW5nJyk7DQogICAgfQ0KfQ0KDQovLyBSZXNldCBjYW52YXMgcGFuIHRvIGNlbnRlcg0KZnVuY3Rpb24gcmVzZXRDYW52YXNQYW4oKSB7DQogICAgLy8gUHJldmVudCBjb25jdXJyZW50IG9wZXJhdGlvbnMNCiAgICBpZiAoZmxvd0VkaXRvci5pc1Jlc2V0dGluZykgcmV0dXJuOw0KICAgIGZsb3dFZGl0b3IuaXNSZXNldHRpbmcgPSB0cnVlOw0KICAgIA0KICAgIC8vIEFkZCBzbW9vdGggdHJhbnNpdGlvbiBmb3IgcmVzZXQgd2l0aCBpbXByb3ZlZCBlYXNpbmcNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS50cmFuc2l0aW9uID0gJ3RyYW5zZm9ybSAwLjVzIGN1YmljLWJlemllcigwLjI1LCAwLjQ2LCAwLjQ1LCAwLjk0KSc7DQoNCiAgICAvLyBDYWxjdWxhdGUgY2VudGVyIG9mIGFsbCBub2RlcyBpZiBhbnkgZXhpc3QNCiAgICBpZiAoZmxvd0VkaXRvci5ub2Rlcy5zaXplID4gMCkgew0KICAgICAgICBjb25zdCBub2RlcyA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5ub2Rlcy52YWx1ZXMoKSk7DQogICAgICAgIGNvbnN0IG1pblggPSBNYXRoLm1pbiguLi5ub2Rlcy5tYXAobiA9PiBuLngpKTsNCiAgICAgICAgY29uc3QgbWF4WCA9IE1hdGgubWF4KC4uLm5vZGVzLm1hcChuID0+IG4ueCkpOw0KICAgICAgICBjb25zdCBtaW5ZID0gTWF0aC5taW4oLi4ubm9kZXMubWFwKG4gPT4gbi55KSk7DQogICAgICAgIGNvbnN0IG1heFkgPSBNYXRoLm1heCguLi5ub2Rlcy5tYXAobiA9PiBuLnkpKTsNCg0KICAgICAgICBjb25zdCBjZW50ZXJYID0gKG1pblggKyBtYXhYKSAvIDI7DQogICAgICAgIGNvbnN0IGNlbnRlclkgPSAobWluWSArIG1heFkpIC8gMjsNCg0KICAgICAgICAvLyBHZXQgY2FudmFzIGNvbnRhaW5lciBkaW1lbnNpb25zIChzY2FsZWQpDQogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPw0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDoNCiAgICAgICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCg0KICAgICAgICAvLyBDYWxjdWxhdGUgcGFuIG9mZnNldCB0byBjZW50ZXIgdGhlIG5vZGVzIGluIHRoZSB2aWV3cG9ydA0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gLWNlbnRlclggKyBjb250YWluZXJSZWN0LndpZHRoIC8gMjsNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IC1jZW50ZXJZICsgY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIElmIG5vIG5vZGVzLCByZXNldCB0byBjZW50ZXIgb2YgdGhlIGxhcmdlIGNhbnZhcw0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldCA9IHsgeDogLTUwMDAsIHk6IC01MDAwIH07DQogICAgfQ0KDQogICAgLy8gUmVzZXQgem9vbSB0byAxMDAlDQogICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSAxLjA7DQoNCiAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCg0KICAgIC8vIFJlbW92ZSB0cmFuc2l0aW9uIGFmdGVyIGFuaW1hdGlvbiBjb21wbGV0ZXMgd2l0aCBwcm9wZXIgdGltaW5nDQogICAgY2xlYXJUaW1lb3V0KGZsb3dFZGl0b3IucmVzZXRUaW1lb3V0KTsNCiAgICBmbG93RWRpdG9yLnJlc2V0VGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS50cmFuc2l0aW9uID0gJyc7DQogICAgICAgIGZsb3dFZGl0b3IuaXNSZXNldHRpbmcgPSBmYWxzZTsNCiAgICB9LCA1MDApOyAvLyBNYXRjaCB0cmFuc2l0aW9uIGR1cmF0aW9uDQp9DQoNCi8vIFpvb20gZnVuY3Rpb25zDQpmdW5jdGlvbiB6b29tSW4oKSB7DQogICAgY29uc3QgbmV3Wm9vbSA9IE1hdGgubWluKGZsb3dFZGl0b3Iuem9vbUxldmVsICsgZmxvd0VkaXRvci56b29tU3RlcCwgZmxvd0VkaXRvci5tYXhab29tKTsNCiAgICBzZXRab29tTGV2ZWwobmV3Wm9vbSk7DQp9DQoNCmZ1bmN0aW9uIHpvb21PdXQoKSB7DQogICAgY29uc3QgbmV3Wm9vbSA9IE1hdGgubWF4KGZsb3dFZGl0b3Iuem9vbUxldmVsIC0gZmxvd0VkaXRvci56b29tU3RlcCwgZmxvd0VkaXRvci5taW5ab29tKTsNCiAgICBzZXRab29tTGV2ZWwobmV3Wm9vbSk7DQp9DQoNCmZ1bmN0aW9uIHNldFpvb21MZXZlbCh6b29tTGV2ZWwpIHsNCiAgICAvLyBQcmV2ZW50IGNvbmN1cnJlbnQgem9vbSBvcGVyYXRpb25zIHRvIGF2b2lkIHZpc3VhbCBhcnRpZmFjdHMNCiAgICBpZiAoZmxvd0VkaXRvci5pc1pvb21pbmcpIHJldHVybjsNCiAgICBmbG93RWRpdG9yLmlzWm9vbWluZyA9IHRydWU7DQogICAgDQogICAgLy8gQWRkIHpvb21pbmcgY2xhc3MgZm9yIHBlcmZvcm1hbmNlIG9wdGltaXphdGlvbnMNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5jbGFzc0xpc3QuYWRkKCd6b29taW5nJyk7DQogICAgDQogICAgLy8gR2V0IHRoZSBjZW50ZXIgb2YgdGhlIGNhbnZhcyBjb250YWluZXIgZm9yIHpvb20gb3JpZ2luDQogICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8NCiAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDoNCiAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIA0KICAgIGNvbnN0IGNlbnRlclggPSBjb250YWluZXJSZWN0LndpZHRoIC8gMjsNCiAgICBjb25zdCBjZW50ZXJZID0gY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSB0aGUgcG9pbnQgaW4gY2FudmFzIGNvb3JkaW5hdGVzIHRoYXQgc2hvdWxkIHJlbWFpbiBmaXhlZA0KICAgIGNvbnN0IGNhbnZhc1ggPSAoY2VudGVyWCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgY29uc3QgY2FudmFzWSA9IChjZW50ZXJZIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICANCiAgICAvLyBVcGRhdGUgem9vbSBsZXZlbA0KICAgIGZsb3dFZGl0b3Iuem9vbUxldmVsID0gTWF0aC5tYXgoZmxvd0VkaXRvci5taW5ab29tLCBNYXRoLm1pbihmbG93RWRpdG9yLm1heFpvb20sIHpvb21MZXZlbCkpOw0KICAgIA0KICAgIC8vIEFkanVzdCBwYW4gb2Zmc2V0IHRvIGtlZXAgdGhlIGNlbnRlciBwb2ludCBmaXhlZA0KICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnggPSBjZW50ZXJYIC0gY2FudmFzWCAqIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSBjZW50ZXJZIC0gY2FudmFzWSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIA0KICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgIA0KICAgIC8vIENvbnNvbGlkYXRlZCByZWRyYXcgdGltaW5nIHRvIHByZXZlbnQgbXVsdGlwbGUgcmVkcmF3cw0KICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnpvb21SZWRyYXdUaW1lb3V0KTsNCiAgICBmbG93RWRpdG9yLnpvb21SZWRyYXdUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLmNsYXNzTGlzdC5yZW1vdmUoJ3pvb21pbmcnKTsNCiAgICAgICAgZmxvd0VkaXRvci5pc1pvb21pbmcgPSBmYWxzZTsNCiAgICB9LCAzMik7IC8vIEluY3JlYXNlZCBmcm9tIDE2bXMgdG8gcHJldmVudCB0b28gZnJlcXVlbnQgcmVkcmF3cw0KfQ0KDQpmdW5jdGlvbiB6b29tVG9GaXQoKSB7DQogICAgaWYgKGZsb3dFZGl0b3Iubm9kZXMuc2l6ZSA9PT0gMCkgew0KICAgICAgICAvLyBJZiBubyBub2RlcywgcmVzZXQgdG8gMTAwJSB6b29tIGFuZCBjZW50ZXINCiAgICAgICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSAxLjA7DQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0ID0geyB4OiAtNTAwMCwgeTogLTUwMDAgfTsNCiAgICAgICAgdXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gUHJldmVudCBjb25jdXJyZW50IHpvb20gb3BlcmF0aW9ucw0KICAgIGlmIChmbG93RWRpdG9yLmlzWm9vbWluZykgcmV0dXJuOw0KICAgIGZsb3dFZGl0b3IuaXNab29taW5nID0gdHJ1ZTsNCiAgICANCiAgICAvLyBGaW5kIGJvdW5kcyBvZiBhbGwgbm9kZXMNCiAgICBjb25zdCBub2RlcyA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5ub2Rlcy52YWx1ZXMoKSk7DQogICAgY29uc3QgcGFkZGluZyA9IDEwMDsgLy8gRXh0cmEgcGFkZGluZyBhcm91bmQgbm9kZXMNCiAgICANCiAgICBsZXQgbWluWCA9IEluZmluaXR5LCBtYXhYID0gLUluZmluaXR5Ow0KICAgIGxldCBtaW5ZID0gSW5maW5pdHksIG1heFkgPSAtSW5maW5pdHk7DQogICAgDQogICAgbm9kZXMuZm9yRWFjaChub2RlID0+IHsNCiAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlLmlkKTsNCiAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICBjb25zdCByZWN0ID0gbm9kZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICAgICAgICBtaW5YID0gTWF0aC5taW4obWluWCwgbm9kZS54KTsNCiAgICAgICAgICAgIG1heFggPSBNYXRoLm1heChtYXhYLCBub2RlLnggKyByZWN0LndpZHRoKTsNCiAgICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCBub2RlLnkpOw0KICAgICAgICAgICAgbWF4WSA9IE1hdGgubWF4KG1heFksIG5vZGUueSArIHJlY3QuaGVpZ2h0KTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIEFkZCBwYWRkaW5nDQogICAgbWluWCAtPSBwYWRkaW5nOw0KICAgIG1heFggKz0gcGFkZGluZzsNCiAgICBtaW5ZIC09IHBhZGRpbmc7DQogICAgbWF4WSArPSBwYWRkaW5nOw0KICAgIA0KICAgIGNvbnN0IGNvbnRlbnRXaWR0aCA9IG1heFggLSBtaW5YOw0KICAgIGNvbnN0IGNvbnRlbnRIZWlnaHQgPSBtYXhZIC0gbWluWTsNCiAgICANCiAgICAvLyBHZXQgY29udGFpbmVyIGRpbWVuc2lvbnMNCiAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPw0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOg0KICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgDQogICAgLy8gQ2FsY3VsYXRlIHpvb20gdG8gZml0DQogICAgY29uc3Qgem9vbVggPSBjb250YWluZXJSZWN0LndpZHRoIC8gY29udGVudFdpZHRoOw0KICAgIGNvbnN0IHpvb21ZID0gY29udGFpbmVyUmVjdC5oZWlnaHQgLyBjb250ZW50SGVpZ2h0Ow0KICAgIGNvbnN0IG5ld1pvb20gPSBNYXRoLm1pbih6b29tWCwgem9vbVksIGZsb3dFZGl0b3IubWF4Wm9vbSk7DQogICAgDQogICAgLy8gU2V0IHpvb20gbGV2ZWwNCiAgICBmbG93RWRpdG9yLnpvb21MZXZlbCA9IE1hdGgubWF4KGZsb3dFZGl0b3IubWluWm9vbSwgbmV3Wm9vbSk7DQogICAgDQogICAgLy8gQ2VudGVyIHRoZSBjb250ZW50DQogICAgY29uc3QgY2VudGVyWCA9IChtaW5YICsgbWF4WCkgLyAyOw0KICAgIGNvbnN0IGNlbnRlclkgPSAobWluWSArIG1heFkpIC8gMjsNCiAgICANCiAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gY29udGFpbmVyUmVjdC53aWR0aCAvIDIgLSBjZW50ZXJYICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMiAtIGNlbnRlclkgKiBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICANCiAgICAvLyBBZGQgc21vb3RoIHRyYW5zaXRpb24gd2l0aCBiZXR0ZXIgdGltaW5nDQogICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICd0cmFuc2Zvcm0gMC40cyBjdWJpYy1iZXppZXIoMC4yNSwgMC40NiwgMC40NSwgMC45NCknOw0KICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgIA0KICAgIC8vIFJlbW92ZSB0cmFuc2l0aW9uIGFuZCByZWRyYXcgd2l0aCBwcm9wZXIgdGltaW5nDQogICAgY2xlYXJUaW1lb3V0KGZsb3dFZGl0b3Iuem9vbUZpdFRpbWVvdXQpOw0KICAgIGZsb3dFZGl0b3Iuem9vbUZpdFRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICcnOw0KICAgICAgICAvLyBVc2UgcmVxdWVzdEFuaW1hdGlvbkZyYW1lIGZvciBzbW9vdGggcmVkcmF3DQogICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7DQogICAgICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci5pc1pvb21pbmcgPSBmYWxzZTsNCiAgICAgICAgfSk7DQogICAgfSwgNDAwKTsgLy8gTWF0Y2ggdHJhbnNpdGlvbiBkdXJhdGlvbg0KfQ0KDQovLyBIYW5kbGUgbW91c2Ugd2hlZWwgem9vbQ0KZnVuY3Rpb24gaGFuZGxlTW91c2VXaGVlbChlKSB7DQogICAgaWYgKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICANCiAgICAgICAgLy8gVGhyb3R0bGUgd2hlZWwgZXZlbnRzIHRvIHByZXZlbnQgb3ZlcndoZWxtaW5nIHRoZSBzeXN0ZW0NCiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTsNCiAgICAgICAgaWYgKGZsb3dFZGl0b3IubGFzdFdoZWVsVGltZSAmJiBub3cgLSBmbG93RWRpdG9yLmxhc3RXaGVlbFRpbWUgPCAxNikgew0KICAgICAgICAgICAgcmV0dXJuOyAvLyBMaW1pdCB0byB+NjBmcHMNCiAgICAgICAgfQ0KICAgICAgICBmbG93RWRpdG9yLmxhc3RXaGVlbFRpbWUgPSBub3c7DQogICAgICAgIA0KICAgICAgICAvLyBHZXQgbW91c2UgcG9zaXRpb24gcmVsYXRpdmUgdG8gY29udGFpbmVyDQogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPw0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDoNCiAgICAgICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPw0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDoNCiAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IG1vdXNlWCA9IG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQ7DQogICAgICAgIGNvbnN0IG1vdXNlWSA9IG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcDsNCiAgICAgICAgDQogICAgICAgIC8vIENhbGN1bGF0ZSB6b29tIGRlbHRhDQogICAgICAgIGNvbnN0IHpvb21EZWx0YSA9IGUuZGVsdGFZID4gMCA/IC1mbG93RWRpdG9yLnpvb21TdGVwIDogZmxvd0VkaXRvci56b29tU3RlcDsNCiAgICAgICAgY29uc3QgbmV3Wm9vbSA9IE1hdGgubWF4KGZsb3dFZGl0b3IubWluWm9vbSwgTWF0aC5taW4oZmxvd0VkaXRvci5tYXhab29tLCBmbG93RWRpdG9yLnpvb21MZXZlbCArIHpvb21EZWx0YSkpOw0KICAgICAgICANCiAgICAgICAgaWYgKG5ld1pvb20gIT09IGZsb3dFZGl0b3Iuem9vbUxldmVsKSB7DQogICAgICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIHBvaW50IGluIGNhbnZhcyBjb29yZGluYXRlcyB0aGF0IHNob3VsZCByZW1haW4gZml4ZWQgKHVuZGVyIG1vdXNlKQ0KICAgICAgICAgICAgY29uc3QgY2FudmFzWCA9IChtb3VzZVggLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgY29uc3QgY2FudmFzWSA9IChtb3VzZVkgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBVcGRhdGUgem9vbSBsZXZlbA0KICAgICAgICAgICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSBuZXdab29tOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBBZGp1c3QgcGFuIG9mZnNldCB0byBrZWVwIHRoZSBtb3VzZSBwb2ludCBmaXhlZA0KICAgICAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IG1vdXNlWCAtIGNhbnZhc1ggKiBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSBtb3VzZVkgLSBjYW52YXNZICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDb25zb2xpZGF0ZWQgcmVkcmF3IHRpbWluZyB3aXRoIGRlYm91bmNpbmcNCiAgICAgICAgICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnpvb21SZWRyYXdUaW1lb3V0KTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3Iuem9vbVJlZHJhd1RpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICAgICAgfSwgMTAwKTsgLy8gSW5jcmVhc2VkIGRlYm91bmNlIHRpbWUgZm9yIHdoZWVsIHpvb21pbmcNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gSGFuZGxlIGNhbnZhcyBjbGljayBldmVudHMNCmZ1bmN0aW9uIGhhbmRsZUNhbnZhc0NsaWNrKGUpIHsNCiAgICBpZiAoZS50YXJnZXQgPT09IGZsb3dFZGl0b3IuY2FudmFzKSB7DQogICAgICAgIC8vIERlc2VsZWN0IG5vZGUNCiAgICAgICAgaWYgKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlKSB7DQogICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlKTsNCiAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlID0gbnVsbDsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlLWNvbmZpZycpLmlubmVySFRNTCA9ICc8cCBjbGFzcz0idGV4dC1tdXRlZCI+U2VsZWN0IGEgbm9kZSB0byBjb25maWd1cmUgaXQ8L3A+JzsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gSGFuZGxlIGRvY3VtZW50IG1vdXNlIGV2ZW50cyBmb3Igc21vb3RoIGRyYWdnaW5nDQpmdW5jdGlvbiBoYW5kbGVEb2N1bWVudE1vdXNlRG93bihlKSB7DQogICAgLy8gRG9uJ3Qgc3RhcnQgZHJhZ2dpbmcgaWYgY2xpY2tpbmcgb24gVUkgZWxlbWVudHMNCiAgICBpZiAoZS50YXJnZXQuY2xvc2VzdCgnLmZsb3ctdG9vbGJhcicpIHx8IA0KICAgICAgICBlLnRhcmdldC5jbG9zZXN0KCcuZmxvdy1jb25maWctcGFuZWwnKSB8fCANCiAgICAgICAgZS50YXJnZXQuY2xvc2VzdCgnLmZsb3ctb3V0cHV0LXBhbmVsJykgfHwNCiAgICAgICAgZS50YXJnZXQuY2xvc2VzdCgnLm5vZGUtZGVsZXRlLWJ0bicpKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gRG9uJ3Qgc3RhcnQgZHJhZ2dpbmcgaWYgd2UncmUgcGFubmluZw0KICAgIGlmIChmbG93RWRpdG9yLmlzUGFubmluZykgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIE9ubHkgYWxsb3cgZHJhZ2dpbmcgZnJvbSB0aGUgbm9kZSBoZWFkZXINCiAgICBjb25zdCBoZWFkZXJFbGVtZW50ID0gZS50YXJnZXQuY2xvc2VzdCgnLmZsb3ctbm9kZS1oZWFkZXInKTsNCiAgICBpZiAoIWhlYWRlckVsZW1lbnQpIHJldHVybjsNCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGhlYWRlckVsZW1lbnQuY2xvc2VzdCgnLmZsb3ctbm9kZScpOw0KICAgIGlmICghbm9kZUVsZW1lbnQpIHJldHVybjsNCiAgICANCiAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICBjb25zdCBub2RlSWQgPSBub2RlRWxlbWVudC5pZDsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICANCiAgICBpZiAobm9kZSkgew0KICAgICAgICBmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSA9IG5vZGVJZDsNCiAgICAgICAgDQogICAgICAgIC8vIENhbGN1bGF0ZSBvZmZzZXQgZnJvbSBtb3VzZSB0byBub2RlIGNvcm5lciwgYWNjb3VudGluZyBmb3Igem9vbQ0KICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOiANCiAgICAgICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPyANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6IA0KICAgICAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgICAgICANCiAgICAgICAgLy8gQ29udmVydCBtb3VzZSBwb3NpdGlvbiB0byBjYW52YXMgY29vcmRpbmF0ZXMNCiAgICAgICAgY29uc3QgY2FudmFzTW91c2VYID0gKG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQgLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICBjb25zdCBjYW52YXNNb3VzZVkgPSAobW91c2VDb29yZHMueSAtIGNvbnRhaW5lclJlY3QudG9wIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgDQogICAgICAgIC8vIENhbGN1bGF0ZSBvZmZzZXQgaW4gY2FudmFzIGNvb3JkaW5hdGVzDQogICAgICAgIGZsb3dFZGl0b3IuZHJhZ09mZnNldCA9IHsNCiAgICAgICAgICAgIHg6IChjYW52YXNNb3VzZVggLSBub2RlLngpICogZmxvd0VkaXRvci56b29tTGV2ZWwsDQogICAgICAgICAgICB5OiAoY2FudmFzTW91c2VZIC0gbm9kZS55KSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsDQogICAgICAgIH07DQogICAgICAgIA0KICAgICAgICBub2RlRWxlbWVudC5zdHlsZS5jdXJzb3IgPSAnZ3JhYmJpbmcnOw0KICAgICAgICBub2RlRWxlbWVudC5zdHlsZS56SW5kZXggPSAnMTAwMCc7IC8vIEJyaW5nIHRvIGZyb250IHdoaWxlIGRyYWdnaW5nDQogICAgICAgIA0KICAgICAgICAvLyBDYWNoZSBjb250YWluZXIgcmVjdCBmb3IgcGVyZm9ybWFuY2UNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXNSZWN0ID0gY29udGFpbmVyUmVjdDsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIGhhbmRsZURvY3VtZW50TW91c2VNb3ZlKGUpIHsNCiAgICAvLyBIYW5kbGUgY2FudmFzIHBhbm5pbmcNCiAgICBpZiAoZmxvd0VkaXRvci5pc1Bhbm5pbmcpIHsNCiAgICAgICAgdXBkYXRlQ2FudmFzUGFuKGUpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIEdldCBzY2FsZWQgY29vcmRpbmF0ZXMNCiAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8gDQogICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6IA0KICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgDQogICAgLy8gSGFuZGxlIHRhZyBkcmFnZ2luZw0KICAgIGlmIChmbG93RWRpdG9yLmRyYWdnaW5nVGFnICYmIGZsb3dFZGl0b3IudGFnRHJhZ09mZnNldCkgew0KICAgICAgICBjb25zdCB0YWcgPSBmbG93RWRpdG9yLnRhZ3MuZ2V0KGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcpOw0KICAgICAgICBpZiAodGFnKSB7DQogICAgICAgICAgICAvLyBHZXQgY29udGFpbmVyIGRpbWVuc2lvbnMgZm9yIGNvb3JkaW5hdGUgY29udmVyc2lvbg0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPyANCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOiANCiAgICAgICAgICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENvbnZlcnQgbW91c2UgY29vcmRpbmF0ZXMgdG8gY2FudmFzIGNvb3JkaW5hdGVzLCBhY2NvdW50aW5nIGZvciBwYW4gYW5kIHpvb20NCiAgICAgICAgICAgIGNvbnN0IGNhbnZhc01vdXNlWCA9IChtb3VzZUNvb3Jkcy54IC0gY29udGFpbmVyUmVjdC5sZWZ0IC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueCkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIGNvbnN0IGNhbnZhc01vdXNlWSA9IChtb3VzZUNvb3Jkcy55IC0gY29udGFpbmVyUmVjdC50b3AgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDYWxjdWxhdGUgbmV3IHBvc2l0aW9uIHdpdGggb2Zmc2V0IChkcmFnIG9mZnNldCBpcyBhbHNvIGluIHNjcmVlbiBjb29yZGluYXRlcywgc28gY29udmVydCBpdCkNCiAgICAgICAgICAgIGNvbnN0IGRyYWdPZmZzZXRYID0gZmxvd0VkaXRvci50YWdEcmFnT2Zmc2V0LnggLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIGNvbnN0IGRyYWdPZmZzZXRZID0gZmxvd0VkaXRvci50YWdEcmFnT2Zmc2V0LnkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgdGFnLnggPSBjYW52YXNNb3VzZVggLSBkcmFnT2Zmc2V0WDsNCiAgICAgICAgICAgIHRhZy55ID0gY2FudmFzTW91c2VZIC0gZHJhZ09mZnNldFk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IHRhZ0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmbG93RWRpdG9yLmRyYWdnaW5nVGFnKTsNCiAgICAgICAgICAgIGlmICh0YWdFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgLy8gVXNlIGxlZnQvdG9wIGZvciBwb3NpdGlvbmluZw0KICAgICAgICAgICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUubGVmdCA9IHRhZy54ICsgJ3B4JzsNCiAgICAgICAgICAgICAgICB0YWdFbGVtZW50LnN0eWxlLnRvcCA9IHRhZy55ICsgJ3B4JzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gVGhyb3R0bGUgdXBkYXRlcyBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlDQogICAgICAgICAgICBpZiAoIWZsb3dFZGl0b3IudGFnVXBkYXRlVGltZW91dCkgew0KICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IudGFnVXBkYXRlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnRhZ1VwZGF0ZVRpbWVvdXQgPSBudWxsOw0KICAgICAgICAgICAgICAgIH0sIDE2KTsgLy8gfjYwZnBzDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBpZiAoZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUgJiYgZmxvd0VkaXRvci5kcmFnT2Zmc2V0KSB7DQogICAgICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSk7DQogICAgICAgIGlmIChub2RlKSB7DQogICAgICAgICAgICAvLyBHZXQgY29udGFpbmVyIGRpbWVuc2lvbnMgZm9yIGNvb3JkaW5hdGUgY29udmVyc2lvbg0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPyANCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOiANCiAgICAgICAgICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENvbnZlcnQgbW91c2UgY29vcmRpbmF0ZXMgdG8gY2FudmFzIGNvb3JkaW5hdGVzLCBhY2NvdW50aW5nIGZvciBwYW4gYW5kIHpvb20NCiAgICAgICAgICAgIGNvbnN0IGNhbnZhc01vdXNlWCA9IChtb3VzZUNvb3Jkcy54IC0gY29udGFpbmVyUmVjdC5sZWZ0IC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueCkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIGNvbnN0IGNhbnZhc01vdXNlWSA9IChtb3VzZUNvb3Jkcy55IC0gY29udGFpbmVyUmVjdC50b3AgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDYWxjdWxhdGUgbmV3IHBvc2l0aW9uIHdpdGggb2Zmc2V0IChkcmFnIG9mZnNldCBpcyBhbHNvIGluIHNjcmVlbiBjb29yZGluYXRlcywgc28gY29udmVydCBpdCkNCiAgICAgICAgICAgIGNvbnN0IGRyYWdPZmZzZXRYID0gZmxvd0VkaXRvci5kcmFnT2Zmc2V0LnggLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIGNvbnN0IGRyYWdPZmZzZXRZID0gZmxvd0VkaXRvci5kcmFnT2Zmc2V0LnkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgbm9kZS54ID0gY2FudmFzTW91c2VYIC0gZHJhZ09mZnNldFg7DQogICAgICAgICAgICBub2RlLnkgPSBjYW52YXNNb3VzZVkgLSBkcmFnT2Zmc2V0WTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSk7DQogICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5zdHlsZS5sZWZ0ID0gbm9kZS54ICsgJ3B4JzsNCiAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5zdHlsZS50b3AgPSBub2RlLnkgKyAncHgnOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBhbGwgY29ubmVjdGlvbnMgZm9yIHRoaXMgbm9kZSAodGhyb3R0bGVkIGZvciBwZXJmb3JtYW5jZSkNCiAgICAgICAgICAgICAgICBpZiAoIWZsb3dFZGl0b3IudXBkYXRlVGltZW91dCkgew0KICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZUNvbm5lY3Rpb25zRm9yTm9kZShub2RlLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IudXBkYXRlVGltZW91dCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIH0sIDE2KTsgLy8gfjYwZnBzDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBoYW5kbGVEb2N1bWVudE1vdXNlVXAoZSkgew0KICAgIC8vIEhhbmRsZSBjYW52YXMgcGFubmluZyBzdG9wDQogICAgaWYgKGZsb3dFZGl0b3IuaXNQYW5uaW5nKSB7DQogICAgICAgIHN0b3BDYW52YXNQYW4oKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBIYW5kbGUgdGFnIGRyYWdnaW5nIHN0b3ANCiAgICBpZiAoZmxvd0VkaXRvci5kcmFnZ2luZ1RhZykgew0KICAgICAgICBjb25zdCB0YWdFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmxvd0VkaXRvci5kcmFnZ2luZ1RhZyk7DQogICAgICAgIGlmICh0YWdFbGVtZW50KSB7DQogICAgICAgICAgICB0YWdFbGVtZW50LnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJzsNCiAgICAgICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUuekluZGV4ID0gJzEwMCc7DQogICAgICAgICAgICB0YWdFbGVtZW50LnN0eWxlLnRyYW5zaXRpb24gPSAnYm94LXNoYWRvdyAwLjJzIGVhc2UsIHRyYW5zZm9ybSAwLjJzIGVhc2UnOyAvLyBSZXN0b3JlIHRyYW5zaXRpb25zDQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcgPSBudWxsOw0KICAgICAgICBmbG93RWRpdG9yLnRhZ0RyYWdPZmZzZXQgPSBudWxsOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGlmIChmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSkgew0KICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKTsNCiAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICBub2RlRWxlbWVudC5zdHlsZS5jdXJzb3IgPSAnZ3JhYic7DQogICAgICAgICAgICBub2RlRWxlbWVudC5zdHlsZS56SW5kZXggPSAnJzsgLy8gUmVzZXQgei1pbmRleA0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciBhbnkgcGVuZGluZyBjb25uZWN0aW9uIHVwZGF0ZXMNCiAgICAgICAgaWYgKGZsb3dFZGl0b3IudXBkYXRlVGltZW91dCkgew0KICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGZsb3dFZGl0b3IudXBkYXRlVGltZW91dCk7DQogICAgICAgICAgICBmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQgPSBudWxsOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBGaW5hbCBjb25uZWN0aW9uIHVwZGF0ZQ0KICAgICAgICB1cGRhdGVDb25uZWN0aW9uc0Zvck5vZGUoZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUpOw0KICAgICAgICANCiAgICAgICAgZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUgPSBudWxsOw0KICAgICAgICBmbG93RWRpdG9yLmRyYWdPZmZzZXQgPSBudWxsOw0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhc1JlY3QgPSBudWxsOw0KICAgIH0NCn0NCg0KDQovLyBFeGFtcGxlOiBjYW52YXMtbWFuYWdlci5qcw0Kd2luZG93LmNhbnZhc01hbmFnZXIgPSB7DQogICAgdXBkYXRlQ2FudmFzVHJhbnNmb3JtLA0KICAgIHN0YXJ0Q2FudmFzUGFuLA0KICAgIHVwZGF0ZUNhbnZhc1BhbiwNCiAgICBzdG9wQ2FudmFzUGFuLA0KICAgIHJlc2V0Q2FudmFzUGFuLA0KICAgIGhhbmRsZUNhbnZhc0NsaWNrLA0KICAgIGhhbmRsZURvY3VtZW50TW91c2VEb3duLA0KICAgIGhhbmRsZURvY3VtZW50TW91c2VNb3ZlLA0KICAgIGhhbmRsZURvY3VtZW50TW91c2VVcCwNCiAgICB6b29tSW4sDQogICAgem9vbU91dCwNCiAgICBzZXRab29tTGV2ZWwsDQogICAgem9vbVRvRml0LA0KICAgIGhhbmRsZU1vdXNlV2hlZWwNCn07DQoNCg0KLy8gQWRkIGEgbmV3IHRhZyBhdCBjdXJyZW50IHZpZXdwb3J0IGNlbnRlcg0KYXN5bmMgZnVuY3Rpb24gYWRkVGFnKCkgew0KICAgIGNvbnN0IHRhZ05hbWUgPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0lucHV0TW9kYWwoDQogICAgICAgICdDcmVhdGUgTmV3IFRhZycsDQogICAgICAgICdUYWcgTmFtZTonLA0KICAgICAgICB7DQogICAgICAgICAgICBwbGFjZWhvbGRlcjogJ0VudGVyIHRhZyBuYW1lJywNCiAgICAgICAgICAgIGNvbmZpcm1UZXh0OiAnQ3JlYXRlIFRhZycsDQogICAgICAgICAgICBjYW5jZWxUZXh0OiAnQ2FuY2VsJywNCiAgICAgICAgICAgIGljb246ICdmYXMgZmEtdGFnJw0KICAgICAgICB9DQogICAgKTsNCiAgICANCiAgICBpZiAoIXRhZ05hbWUgfHwgdGFnTmFtZS50cmltKCkgPT09ICcnKSByZXR1cm47DQoNCiAgICBjb25zdCB0YWdJZCA9IGB0YWdfJHsrK2Zsb3dFZGl0b3IudGFnQ291bnRlcn1gOw0KDQogICAgLy8gQ2FsY3VsYXRlIHBvc2l0aW9uIGF0IGN1cnJlbnQgdmlld3BvcnQgY2VudGVyDQogICAgLy8gR2V0IGNlbnRlciBwb3NpdGlvbiBpbiBjYW52YXMgY29vcmRpbmF0ZXMNCiAgICBjb25zdCBjZW50ZXIgPSB3aW5kb3cuZmxvd0VkaXRvclV0aWxzID8gDQogICAgICAgIHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZ2V0Vmlld3BvcnRDZW50ZXJJbkNhbnZhcygpIDoNCiAgICAgICAgeyB4OiA1MDAwLCB5OiA1MDAwIH07IC8vIEZhbGxiYWNrIHRvIGNhbnZhcyBjZW50ZXINCg0KICAgIGNvbnN0IHRhZyA9IHsNCiAgICAgICAgaWQ6IHRhZ0lkLA0KICAgICAgICBuYW1lOiB0YWdOYW1lLnRyaW0oKSwNCiAgICAgICAgZGVzY3JpcHRpb246ICcnLA0KICAgICAgICB4OiBjZW50ZXIueCwNCiAgICAgICAgeTogY2VudGVyLnksDQogICAgICAgIGNvbG9yOiAnIzRDQUY1MCcgLy8gR3JlZW4gY29sb3INCiAgICB9Ow0KDQogICAgZmxvd0VkaXRvci50YWdzLnNldCh0YWdJZCwgdGFnKTsNCiAgICBjcmVhdGVUYWdFbGVtZW50KHRhZyk7DQogICAgdXBkYXRlVGFnUGFuZWwoKTsNCg0KfQ0KDQovLyBDcmVhdGUgdGFnIGVsZW1lbnQgb24gY2FudmFzDQpmdW5jdGlvbiBjcmVhdGVUYWdFbGVtZW50KHRhZykgew0KICAgIGNvbnN0IHRhZ0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICB0YWdFbGVtZW50LmlkID0gdGFnLmlkOw0KICAgIHRhZ0VsZW1lbnQuY2xhc3NOYW1lID0gJ2NhbnZhcy10YWcnOw0KICAgIHRhZ0VsZW1lbnQuc3R5bGUuY3NzVGV4dCA9IGANCiAgICAgICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgICAgICBsZWZ0OiAke3RhZy54fXB4Ow0KICAgICAgICB0b3A6ICR7dGFnLnl9cHg7DQogICAgICAgIGJhY2tncm91bmQ6ICR7dGFnLmNvbG9yfTsNCiAgICAgICAgY29sb3I6IHdoaXRlOw0KICAgICAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgICAgICBib3JkZXItcmFkaXVzOiAxMnB4Ow0KICAgICAgICBmb250LXNpemU6IDEycHg7DQogICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICAgICAgdXNlci1zZWxlY3Q6IG5vbmU7DQogICAgICAgIHotaW5kZXg6IDEwMDsNCiAgICAgICAgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwwLDAsMC4yKTsNCiAgICAgICAgdHJhbnNpdGlvbjogYm94LXNoYWRvdyAwLjJzIGVhc2UsIHRyYW5zZm9ybSAwLjJzIGVhc2U7DQogICAgYDsNCiAgICB0YWdFbGVtZW50LnRleHRDb250ZW50ID0gdGFnLm5hbWU7DQoNCiAgICAvLyBNYWtlIHRhZyBkcmFnZ2FibGUNCiAgICB0YWdFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgc3RhcnREcmFnZ2luZ1RhZyh0YWcuaWQsIGUpOw0KICAgIH0pOw0KDQogICAgLy8gQ2xpY2sgdG8ganVtcCB0byB0YWcNCiAgICB0YWdFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgaWYgKCFmbG93RWRpdG9yLmRyYWdnaW5nVGFnKSB7DQogICAgICAgICAgICBqdW1wVG9UYWcodGFnLmlkKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgLy8gSG92ZXIgZWZmZWN0cw0KICAgIHRhZ0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHsNCiAgICAgICAgdGFnRWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGUoMS4wNSknOw0KICAgICAgICB0YWdFbGVtZW50LnN0eWxlLmJveFNoYWRvdyA9ICcwIDRweCA4cHggcmdiYSgwLDAsMCwwLjMpJzsNCiAgICB9KTsNCg0KICAgIHRhZ0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHsNCiAgICAgICAgdGFnRWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGUoMSknOw0KICAgICAgICB0YWdFbGVtZW50LnN0eWxlLmJveFNoYWRvdyA9ICcwIDJweCA0cHggcmdiYSgwLDAsMCwwLjIpJzsNCiAgICB9KTsNCg0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFwcGVuZENoaWxkKHRhZ0VsZW1lbnQpOw0KfQ0KDQovLyBTdGFydCBkcmFnZ2luZyBhIHRhZw0KZnVuY3Rpb24gc3RhcnREcmFnZ2luZ1RhZyh0YWdJZCwgZSkgew0KICAgIGNvbnN0IHRhZyA9IGZsb3dFZGl0b3IudGFncy5nZXQodGFnSWQpOw0KICAgIGlmICghdGFnKSByZXR1cm47DQoNCiAgICBmbG93RWRpdG9yLmRyYWdnaW5nVGFnID0gdGFnSWQ7DQoNCiAgICAvLyBDYWxjdWxhdGUgb2Zmc2V0IGZyb20gbW91c2UgdG8gdGFnIGNvcm5lciwgYWNjb3VudGluZyBmb3Igem9vbQ0KICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgY29uc3QgY29udGFpbmVyUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/IA0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOiANCiAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIA0KICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPyANCiAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDogDQogICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICANCiAgICAvLyBDb252ZXJ0IG1vdXNlIHBvc2l0aW9uIHRvIGNhbnZhcyBjb29yZGluYXRlcw0KICAgIGNvbnN0IGNhbnZhc01vdXNlWCA9IChtb3VzZUNvb3Jkcy54IC0gY29udGFpbmVyUmVjdC5sZWZ0IC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueCkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICBjb25zdCBjYW52YXNNb3VzZVkgPSAobW91c2VDb29yZHMueSAtIGNvbnRhaW5lclJlY3QudG9wIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICANCiAgICAvLyBDYWxjdWxhdGUgb2Zmc2V0IGluIGNhbnZhcyBjb29yZGluYXRlcw0KICAgIGZsb3dFZGl0b3IudGFnRHJhZ09mZnNldCA9IHsNCiAgICAgICAgeDogKGNhbnZhc01vdXNlWCAtIHRhZy54KSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsLA0KICAgICAgICB5OiAoY2FudmFzTW91c2VZIC0gdGFnLnkpICogZmxvd0VkaXRvci56b29tTGV2ZWwNCiAgICB9Ow0KDQogICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhZ0lkKTsNCiAgICB0YWdFbGVtZW50LnN0eWxlLmN1cnNvciA9ICdncmFiYmluZyc7DQogICAgdGFnRWxlbWVudC5zdHlsZS56SW5kZXggPSAnMTAwMSc7DQogICAgdGFnRWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gJ25vbmUnOyAvLyBEaXNhYmxlIHRyYW5zaXRpb25zIGR1cmluZyBkcmFnDQp9DQoNCi8vIEp1bXAgdG8gdGFnIGxvY2F0aW9uDQpmdW5jdGlvbiBqdW1wVG9UYWcodGFnSWQpIHsNCiAgICBjb25zdCB0YWcgPSBmbG93RWRpdG9yLnRhZ3MuZ2V0KHRhZ0lkKTsNCiAgICBpZiAoIXRhZykgcmV0dXJuOw0KDQogICAgLy8gQWRkIHNtb290aCB0cmFuc2l0aW9uDQogICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICd0cmFuc2Zvcm0gMC41cyBlYXNlLW91dCc7DQoNCiAgICAvLyBVc2UgdXRpbGl0eSBmdW5jdGlvbiB0byBjZW50ZXIgdmlld3BvcnQgb24gdGFnIGNvb3JkaW5hdGVzDQogICAgaWYgKHdpbmRvdy5mbG93RWRpdG9yVXRpbHMgJiYgd2luZG93LmZsb3dFZGl0b3JVdGlscy5jZW50ZXJWaWV3cG9ydE9uQ2FudmFzKSB7DQogICAgICAgIHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuY2VudGVyVmlld3BvcnRPbkNhbnZhcyh0YWcueCwgdGFnLnkpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIEZhbGxiYWNrIG1ldGhvZA0KICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICANCiAgICAgICAgY29uc3Qgdmlld3BvcnRDZW50ZXJYID0gY29udGFpbmVyUmVjdC53aWR0aCAvIDI7DQogICAgICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICAgICAgDQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnggPSB2aWV3cG9ydENlbnRlclggLSAodGFnLnggKiBmbG93RWRpdG9yLnpvb21MZXZlbCk7DQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSB2aWV3cG9ydENlbnRlclkgLSAodGFnLnkgKiBmbG93RWRpdG9yLnpvb21MZXZlbCk7DQogICAgICAgIA0KICAgICAgICB3aW5kb3cuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICB9DQoNCiAgICAvLyBSZW1vdmUgdHJhbnNpdGlvbiBhZnRlciBhbmltYXRpb24gY29tcGxldGVzDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zaXRpb24gPSAnJzsNCiAgICB9LCA1MDApOw0KfQ0KDQovLyBVcGRhdGUgdGFnIHBhbmVsDQpmdW5jdGlvbiB1cGRhdGVUYWdQYW5lbCgpIHsNCiAgICBjb25zdCB0YWdQYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YWctcGFuZWwnKTsNCiAgICBpZiAoIXRhZ1BhbmVsKSByZXR1cm47DQoNCiAgICBpZiAoZmxvd0VkaXRvci50YWdzLnNpemUgPT09IDApIHsNCiAgICAgICAgdGFnUGFuZWwuaW5uZXJIVE1MID0gJzxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5ObyB0YWdzIHlldDwvcD4nOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgbGV0IHRhZ0h0bWwgPSAnJzsNCiAgICBmbG93RWRpdG9yLnRhZ3MuZm9yRWFjaCh0YWcgPT4gew0KICAgICAgICB0YWdIdG1sICs9IGANCiAgICAgICAgICAgIDxkaXYgY2xhc3M9InRhZy1pdGVtIiBkYXRhLXRhZy1pZD0iJHt0YWcuaWR9Ij4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWctY29sb3IiIHN0eWxlPSJiYWNrZ3JvdW5kOiAke3RhZy5jb2xvcn0iPjwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRhZy1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFnLW5hbWUiPiR7dGFnLm5hbWV9PC9kaXY+DQogICAgICAgICAgICAgICAgICAgICR7dGFnLmRlc2NyaXB0aW9uID8gYDxkaXYgY2xhc3M9InRhZy1kZXNjcmlwdGlvbiI+JHt0YWcuZGVzY3JpcHRpb259PC9kaXY+YCA6ICcnfQ0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InRhZy1kZWxldGUiIGRhdGEtdGFnLWlkPSIke3RhZy5pZH0iPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRpbWVzIj48L2k+DQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgYDsNCiAgICB9KTsNCg0KICAgIHRhZ1BhbmVsLmlubmVySFRNTCA9IHRhZ0h0bWw7DQoNCiAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzDQogICAgdGFnUGFuZWwucXVlcnlTZWxlY3RvckFsbCgnLnRhZy1pdGVtJykuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICBpZiAoIWUudGFyZ2V0LmNsb3Nlc3QoJy50YWctZGVsZXRlJykpIHsNCiAgICAgICAgICAgICAgICBjb25zdCB0YWdJZCA9IGl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLXRhZy1pZCcpOw0KICAgICAgICAgICAgICAgIGp1bXBUb1RhZyh0YWdJZCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0pOw0KDQogICAgdGFnUGFuZWwucXVlcnlTZWxlY3RvckFsbCgnLnRhZy1kZWxldGUnKS5mb3JFYWNoKGJ0biA9PiB7DQogICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgY29uc3QgdGFnSWQgPSBidG4uZ2V0QXR0cmlidXRlKCdkYXRhLXRhZy1pZCcpOw0KICAgICAgICAgICAgZGVsZXRlVGFnKHRhZ0lkKTsNCiAgICAgICAgfSk7DQogICAgfSk7DQp9DQoNCi8vIERlbGV0ZSBhIHRhZw0KYXN5bmMgZnVuY3Rpb24gZGVsZXRlVGFnKHRhZ0lkKSB7DQogICAgY29uc3QgY29uZmlybWVkID0gYXdhaXQgc3lwbmV4QVBJLnNob3dDb25maXJtYXRpb24oDQogICAgICAgICdEZWxldGUgVGFnJywNCiAgICAgICAgJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyB0YWc/JywNCiAgICAgICAgew0KICAgICAgICAgICAgdHlwZTogJ2RhbmdlcicsDQogICAgICAgICAgICBjb25maXJtVGV4dDogJ0RlbGV0ZScsDQogICAgICAgICAgICBjYW5jZWxUZXh0OiAnQ2FuY2VsJywNCiAgICAgICAgICAgIGljb246ICdmYXMgZmEtdGFnJw0KICAgICAgICB9DQogICAgKTsNCiAgICANCiAgICBpZiAoY29uZmlybWVkKSB7DQogICAgICAgIGNvbnN0IHRhZ0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWdJZCk7DQogICAgICAgIGlmICh0YWdFbGVtZW50KSB7DQogICAgICAgICAgICB0YWdFbGVtZW50LnJlbW92ZSgpOw0KICAgICAgICB9DQogICAgICAgIGZsb3dFZGl0b3IudGFncy5kZWxldGUodGFnSWQpOw0KICAgICAgICB1cGRhdGVUYWdQYW5lbCgpOw0KICAgIH0NCn0NCg0KLy8gRXhhbXBsZTogdGFnLW1hbmFnZXIuanMNCndpbmRvdy50YWdNYW5hZ2VyID0gew0KICAgIGFkZFRhZywNCiAgICBjcmVhdGVUYWdFbGVtZW50LA0KICAgIHN0YXJ0RHJhZ2dpbmdUYWcsDQogICAganVtcFRvVGFnLA0KICAgIHVwZGF0ZVRhZ1BhbmVsLA0KICAgIGRlbGV0ZVRhZw0KfTsNCg0KLy8gU2F2ZSBmbG93IHRvIHZpcnR1YWwgZmlsZSBzeXN0ZW0NCmFzeW5jIGZ1bmN0aW9uIHNhdmVGbG93KCkgew0KICAgIGNvbnN0IGZsb3dEYXRhID0gew0KICAgICAgICBub2RlczogQXJyYXkuZnJvbShmbG93RWRpdG9yLm5vZGVzLnZhbHVlcygpKS5tYXAobm9kZSA9PiAoew0KICAgICAgICAgICAgaWQ6IG5vZGUuaWQsDQogICAgICAgICAgICB0eXBlOiBub2RlLnR5cGUsDQogICAgICAgICAgICB4OiBub2RlLngsDQogICAgICAgICAgICB5OiBub2RlLnksDQogICAgICAgICAgICBjb25maWc6IG5vZGUuY29uZmlnDQogICAgICAgIH0pKSwNCiAgICAgICAgY29ubmVjdGlvbnM6IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkubWFwKGNvbm4gPT4gKHsNCiAgICAgICAgICAgIGlkOiBjb25uLmlkLA0KICAgICAgICAgICAgZnJvbTogY29ubi5mcm9tLA0KICAgICAgICAgICAgdG86IGNvbm4udG8NCiAgICAgICAgfSkpLA0KICAgICAgICB0YWdzOiBBcnJheS5mcm9tKGZsb3dFZGl0b3IudGFncy52YWx1ZXMoKSksDQogICAgICAgIG1ldGFkYXRhOiB7DQogICAgICAgICAgICBzYXZlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksDQogICAgICAgICAgICBub2RlQ291bnQ6IGZsb3dFZGl0b3Iubm9kZXMuc2l6ZSwNCiAgICAgICAgICAgIGNvbm5lY3Rpb25Db3VudDogZmxvd0VkaXRvci5jb25uZWN0aW9ucy5zaXplLA0KICAgICAgICAgICAgdGFnQ291bnQ6IGZsb3dFZGl0b3IudGFncy5zaXplDQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgdHJ5IHsNCiAgICAgICAgbGV0IGZpbGVQYXRoID0gZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGg7DQogICAgICAgIA0KICAgICAgICAvLyBJZiBubyBjdXJyZW50IGZpbGUgcGF0aCwgc2hvdyBmaWxlIGV4cGxvcmVyDQogICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgIGZpbGVQYXRoID0gYXdhaXQgc3lwbmV4QVBJLnNob3dGaWxlRXhwbG9yZXIoew0KICAgICAgICAgICAgICAgIG1vZGU6ICdzYXZlJywNCiAgICAgICAgICAgICAgICB0aXRsZTogJ1NhdmUgRmxvdyBGaWxlJywNCiAgICAgICAgICAgICAgICBpbml0aWFsUGF0aDogJy8nLA0KICAgICAgICAgICAgICAgIGZpbGVOYW1lOiAnZmxvd193b3JrZmxvdy5qc29uJywNCiAgICAgICAgICAgICAgICBmaWxlRXh0ZW5zaW9uOiAnLmpzb24nLA0KICAgICAgICAgICAgICAgIG9uU2VsZWN0OiAoc2VsZWN0ZWRQYXRoKSA9PiB7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4gew0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBpZiAoIWZpbGVQYXRoKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBVc2VyIGNhbmNlbGxlZA0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU2F2ZSB0byB2aXJ0dWFsIGZpbGUgc3lzdGVtDQogICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGVKU09OKSB7DQogICAgICAgICAgICBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZUpTT04oZmlsZVBhdGgsIGZsb3dEYXRhKTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgICAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGbG93IHNhdmVkIHRvOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBmbG93OicsIGVycm9yKTsNCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbikgew0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ0ZhaWxlZCB0byBzYXZlIGZsb3c6ICcgKyBlcnJvci5tZXNzYWdlLCAnZXJyb3InKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gU2F2ZSBmbG93IGFzIChhbHdheXMgc2hvdyBmaWxlIGV4cGxvcmVyKQ0KYXN5bmMgZnVuY3Rpb24gc2F2ZUZsb3dBcygpIHsNCiAgICBjb25zdCBmbG93RGF0YSA9IHsNCiAgICAgICAgbm9kZXM6IEFycmF5LmZyb20oZmxvd0VkaXRvci5ub2Rlcy52YWx1ZXMoKSkubWFwKG5vZGUgPT4gKHsNCiAgICAgICAgICAgIGlkOiBub2RlLmlkLA0KICAgICAgICAgICAgdHlwZTogbm9kZS50eXBlLA0KICAgICAgICAgICAgeDogbm9kZS54LA0KICAgICAgICAgICAgeTogbm9kZS55LA0KICAgICAgICAgICAgY29uZmlnOiBub2RlLmNvbmZpZw0KICAgICAgICB9KSksDQogICAgICAgIGNvbm5lY3Rpb25zOiBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLm1hcChjb25uID0+ICh7DQogICAgICAgICAgICBpZDogY29ubi5pZCwNCiAgICAgICAgICAgIGZyb206IGNvbm4uZnJvbSwNCiAgICAgICAgICAgIHRvOiBjb25uLnRvDQogICAgICAgIH0pKSwNCiAgICAgICAgdGFnczogQXJyYXkuZnJvbShmbG93RWRpdG9yLnRhZ3MudmFsdWVzKCkpLA0KICAgICAgICBtZXRhZGF0YTogew0KICAgICAgICAgICAgc2F2ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLA0KICAgICAgICAgICAgbm9kZUNvdW50OiBmbG93RWRpdG9yLm5vZGVzLnNpemUsDQogICAgICAgICAgICBjb25uZWN0aW9uQ291bnQ6IGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuc2l6ZSwNCiAgICAgICAgICAgIHRhZ0NvdW50OiBmbG93RWRpdG9yLnRhZ3Muc2l6ZQ0KICAgICAgICB9DQogICAgfTsNCg0KICAgIHRyeSB7DQogICAgICAgIC8vIFNob3cgZmlsZSBleHBsb3JlciBmb3Igc2F2aW5nDQogICAgICAgIGNvbnN0IGZpbGVQYXRoID0gYXdhaXQgc3lwbmV4QVBJLnNob3dGaWxlRXhwbG9yZXIoew0KICAgICAgICAgICAgbW9kZTogJ3NhdmUnLA0KICAgICAgICAgICAgdGl0bGU6ICdTYXZlIEZsb3cgRmlsZSBBcycsDQogICAgICAgICAgICBpbml0aWFsUGF0aDogJy8nLA0KICAgICAgICAgICAgZmlsZU5hbWU6ICdmbG93X3dvcmtmbG93Lmpzb24nLA0KICAgICAgICAgICAgZmlsZUV4dGVuc2lvbjogJy5qc29uJywNCiAgICAgICAgICAgIG9uU2VsZWN0OiAoc2VsZWN0ZWRQYXRoKSA9PiB7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgb25DYW5jZWw6ICgpID0+IHsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgaWYgKCFmaWxlUGF0aCkgew0KICAgICAgICAgICAgcmV0dXJuOyAvLyBVc2VyIGNhbmNlbGxlZA0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU2F2ZSB0byB2aXJ0dWFsIGZpbGUgc3lzdGVtDQogICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGVKU09OKSB7DQogICAgICAgICAgICBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZUpTT04oZmlsZVBhdGgsIGZsb3dEYXRhKTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgICAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGbG93IHNhdmVkIGFzOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBmbG93IGFzOicsIGVycm9yKTsNCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbikgew0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ0ZhaWxlZCB0byBzYXZlIGZsb3cgYXM6ICcgKyBlcnJvci5tZXNzYWdlLCAnZXJyb3InKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gTG9hZCBmbG93IGZyb20gdmlydHVhbCBmaWxlIHN5c3RlbQ0KYXN5bmMgZnVuY3Rpb24gbG9hZEZsb3coKSB7DQogICAgdHJ5IHsNCiAgICAgICAgLy8gU2hvdyBmaWxlIGV4cGxvcmVyIGZvciBsb2FkaW5nDQogICAgICAgIGNvbnN0IGZpbGVQYXRoID0gYXdhaXQgc3lwbmV4QVBJLnNob3dGaWxlRXhwbG9yZXIoew0KICAgICAgICAgICAgbW9kZTogJ29wZW4nLA0KICAgICAgICAgICAgdGl0bGU6ICdMb2FkIEZsb3cgRmlsZScsDQogICAgICAgICAgICBpbml0aWFsUGF0aDogJy8nLA0KICAgICAgICAgICAgb25TZWxlY3Q6IChzZWxlY3RlZFBhdGgpID0+IHsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4gew0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCg0KICAgICAgICBpZiAoIWZpbGVQYXRoKSB7DQogICAgICAgICAgICByZXR1cm47IC8vIFVzZXIgY2FuY2VsbGVkDQogICAgICAgIH0NCg0KICAgICAgICBsZXQgZmxvd0RhdGEgPSBudWxsOw0KICAgICAgICANCiAgICAgICAgLy8gVHJ5IHZpcnR1YWwgZmlsZSBzeXN0ZW0gZmlyc3QNCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlSlNPTikgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBmbG93RGF0YSA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVKU09OKGZpbGVQYXRoKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKHZmc0Vycm9yKSB7DQogICAgICAgICAgICAgICAgdGhyb3cgdmZzRXJyb3I7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGlmIChmbG93RGF0YSkgew0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDbGVhciBjdXJyZW50IGNhbnZhcyAod2l0aG91dCBjb25maXJtYXRpb24gc2luY2Ugd2UncmUgbG9hZGluZyBhIGZpbGUpDQogICAgICAgICAgICBjbGVhckNhbnZhc1NpbGVudCgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBSZXNldCBwYW4gb2Zmc2V0IHRvIGNlbnRlciBvZiBsYXJnZSBjYW52YXMgZm9yIG5ldyB3b3JrZmxvdw0KICAgICAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQgPSB7IHg6IC01MDAwLCB5OiAtNTAwMCB9Ow0KICAgICAgICAgICAgd2luZG93LmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFJlc2V0IG5vZGUgY291bnRlciB0byBhdm9pZCBJRCBjb25mbGljdHMNCiAgICAgICAgICAgIGZsb3dFZGl0b3Iubm9kZUNvdW50ZXIgPSAwOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBMb2FkIG5vZGVzDQogICAgICAgICAgICBpZiAoZmxvd0RhdGEubm9kZXMpIHsNCiAgICAgICAgICAgICAgICBmbG93RGF0YS5ub2Rlcy5mb3JFYWNoKG5vZGVEYXRhID0+IHsNCiAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5vZGUgd2l0aCBwcm9wZXIgSUQNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gbm9kZURhdGEuaWQ7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGUgPSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZDogbm9kZUlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogbm9kZURhdGEudHlwZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHg6IG5vZGVEYXRhLngsDQogICAgICAgICAgICAgICAgICAgICAgICB5OiBub2RlRGF0YS55LA0KICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnOiBub2RlRGF0YS5jb25maWcsDQogICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7fQ0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIG5vZGUgY291bnRlcg0KICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlTnVtID0gcGFyc2VJbnQobm9kZUlkLnJlcGxhY2UoJ25vZGVfJywgJycpKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVOdW0gPiBmbG93RWRpdG9yLm5vZGVDb3VudGVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLm5vZGVDb3VudGVyID0gbm9kZU51bTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci5ub2Rlcy5zZXQobm9kZUlkLCBub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBub2RlIGVsZW1lbnQgdXNpbmcgdGhlIHJlbmRlcmVyIGFuZCBhZGQgdG8gY2FudmFzDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gbm9kZVJlbmRlcmVyLmNyZWF0ZU5vZGVFbGVtZW50KG5vZGUpOw0KICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5hcHBlbmRDaGlsZChub2RlRWxlbWVudCk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIExvYWQgY29ubmVjdGlvbnMgYWZ0ZXIgbm9kZXMgYXJlIGZ1bGx5IGNyZWF0ZWQgYW5kIHBvc2l0aW9uZWQNCiAgICAgICAgICAgIGlmIChmbG93RGF0YS5jb25uZWN0aW9ucykgew0KICAgICAgICAgICAgICAgIGZsb3dEYXRhLmNvbm5lY3Rpb25zLmZvckVhY2goY29ubkRhdGEgPT4gew0KICAgICAgICAgICAgICAgICAgICBjcmVhdGVDb25uZWN0aW9uKGNvbm5EYXRhLmZyb20ubm9kZUlkLCBjb25uRGF0YS5mcm9tLnBvcnROYW1lLCBjb25uRGF0YS50by5ub2RlSWQsIGNvbm5EYXRhLnRvLnBvcnROYW1lKTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBJbW1lZGlhdGVseSByZWRyYXcgY29ubmVjdGlvbnMgbm93IHRoYXQgYWxsIFNWRyBlbGVtZW50cyBleGlzdA0KICAgICAgICAgICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIExvYWQgdGFncw0KICAgICAgICAgICAgaWYgKGZsb3dEYXRhLnRhZ3MpIHsNCiAgICAgICAgICAgICAgICBmbG93RGF0YS50YWdzLmZvckVhY2godGFnRGF0YSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhZyA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB0YWdEYXRhLmlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGFnRGF0YS5uYW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHRhZ0RhdGEuZGVzY3JpcHRpb24gfHwgJycsDQogICAgICAgICAgICAgICAgICAgICAgICB4OiB0YWdEYXRhLngsDQogICAgICAgICAgICAgICAgICAgICAgICB5OiB0YWdEYXRhLnksDQogICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogdGFnRGF0YS5jb2xvciB8fCAnIzRDQUY1MCcNCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0YWcgY291bnRlcg0KICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdOdW0gPSBwYXJzZUludCh0YWdEYXRhLmlkLnJlcGxhY2UoJ3RhZ18nLCAnJykpOw0KICAgICAgICAgICAgICAgICAgICBpZiAodGFnTnVtID4gZmxvd0VkaXRvci50YWdDb3VudGVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnRhZ0NvdW50ZXIgPSB0YWdOdW07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IudGFncy5zZXQodGFnRGF0YS5pZCwgdGFnKTsNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LnRhZ01hbmFnZXIuY3JlYXRlVGFnRWxlbWVudCh0YWcpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2VudGVyIG9mIGxvYWRlZCBub2RlcyBhbmQgYWRqdXN0IHBhbiB0byBjZW50ZXIgdGhlbQ0KICAgICAgICAgICAgaWYgKGZsb3dEYXRhLm5vZGVzICYmIGZsb3dEYXRhLm5vZGVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICBjb25zdCBtaW5YID0gTWF0aC5taW4oLi4uZmxvd0RhdGEubm9kZXMubWFwKG4gPT4gbi54KSk7DQogICAgICAgICAgICAgICAgY29uc3QgbWF4WCA9IE1hdGgubWF4KC4uLmZsb3dEYXRhLm5vZGVzLm1hcChuID0+IG4ueCkpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG1pblkgPSBNYXRoLm1pbiguLi5mbG93RGF0YS5ub2Rlcy5tYXAobiA9PiBuLnkpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBtYXhZID0gTWF0aC5tYXgoLi4uZmxvd0RhdGEubm9kZXMubWFwKG4gPT4gbi55KSk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY29uc3QgY2VudGVyWCA9IChtaW5YICsgbWF4WCkgLyAyOw0KICAgICAgICAgICAgICAgIGNvbnN0IGNlbnRlclkgPSAobWluWSArIG1heFkpIC8gMjsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBHZXQgY2FudmFzIGNvbnRhaW5lciBkaW1lbnNpb25zDQogICAgICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBwYW4gb2Zmc2V0IHRvIGNlbnRlciB0aGUgbm9kZXMgaW4gdGhlIHZpZXdwb3J0DQogICAgICAgICAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IC1jZW50ZXJYICsgY29udGFpbmVyUmVjdC53aWR0aCAvIDI7DQogICAgICAgICAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IC1jZW50ZXJZICsgY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBGaW5hbCBjb25uZWN0aW9uIHJlZHJhdyBhZnRlciBhbGwgcG9zaXRpb25pbmcgaXMgY29tcGxldGUNCiAgICAgICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFVwZGF0ZSB0YWcgcGFuZWwNCiAgICAgICAgICAgIHdpbmRvdy50YWdNYW5hZ2VyLnVwZGF0ZVRhZ1BhbmVsKCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFVwZGF0ZSBjdXJyZW50IGZpbGUgcGF0aA0KICAgICAgICAgICAgZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGggPSBmaWxlUGF0aDsNCiAgICAgICAgICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKSB7DQogICAgICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZsb3cgbG9hZGVkIGZyb206ICR7ZmlsZVBhdGh9YCwgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24pIHsNCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignTm8gdmFsaWQgZmxvdyBkYXRhIGZvdW5kIGluIHRoZSBzZWxlY3RlZCBmaWxlLicsICd3YXJuaW5nJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBmbG93OicsIGVycm9yKTsNCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbikgew0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ0ZhaWxlZCB0byBsb2FkIGZsb3c6ICcgKyBlcnJvci5tZXNzYWdlLCAnZXJyb3InKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gVXBkYXRlIGZpbGVuYW1lIGRpc3BsYXkNCmZ1bmN0aW9uIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpIHsNCiAgICBjb25zdCBmaWxlbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VycmVudC1maWxlbmFtZScpOw0KICAgIGlmIChmaWxlbmFtZUVsZW1lbnQpIHsNCiAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBmbG93RWRpdG9yLmN1cnJlbnRGaWxlUGF0aCA/IGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoLnNwbGl0KCcvJykucG9wKCkgOiAndW50aXRsZWQuZmxvdyc7DQogICAgICAgIGZpbGVuYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IGZpbGVuYW1lOw0KICAgIH0NCn0NCg0KDQovLyBFeHBvcnQgdG8gZ2xvYmFsIHNjb3BlDQp3aW5kb3cuZmlsZU1hbmFnZXIgPSB7DQogICAgc2F2ZUZsb3csDQogICAgc2F2ZUZsb3dBcywNCiAgICBsb2FkRmxvdywNCiAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkNCn07DQoNCg0KLy8gUG9wdWxhdGUgdG9vbGJveCB3aXRoIGxvYWRlZCBub2Rlcw0KZnVuY3Rpb24gcG9wdWxhdGVUb29sYm94KCkgew0KICAgIGNvbnN0IHRvb2xib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmxvdy10b29sYm94Jyk7DQogICAgaWYgKCF0b29sYm94KSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Rvb2xib3ggbm90IGZvdW5kJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gQ2xlYXIgZXhpc3RpbmcgdG9vbGJveCBjb250ZW50DQogICAgY29uc3QgdG9vbGJveENvbnRlbnQgPSB0b29sYm94LnF1ZXJ5U2VsZWN0b3IoJy50b29sYm94LWNvbnRlbnQnKTsNCiAgICBpZiAodG9vbGJveENvbnRlbnQpIHsNCiAgICAgICAgdG9vbGJveENvbnRlbnQuaW5uZXJIVE1MID0gJyc7DQogICAgfQ0KICAgIA0KICAgIC8vIEdyb3VwIG5vZGVzIGJ5IGNhdGVnb3J5DQogICAgY29uc3QgY2F0ZWdvcmllcyA9IHt9Ow0KICAgIGNvbnN0IGFsbE5vZGVzID0gbm9kZVJlZ2lzdHJ5LmdldEFsbE5vZGVUeXBlcygpOw0KICAgIA0KICAgIA0KICAgIGFsbE5vZGVzLmZvckVhY2gobm9kZURlZiA9PiB7DQogICAgICAgIGNvbnN0IGNhdGVnb3J5ID0gbm9kZURlZi5jYXRlZ29yeSB8fCAnb3RoZXInOw0KICAgICAgICBpZiAoIWNhdGVnb3JpZXNbY2F0ZWdvcnldKSB7DQogICAgICAgICAgICBjYXRlZ29yaWVzW2NhdGVnb3J5XSA9IFtdOw0KICAgICAgICB9DQogICAgICAgIGNhdGVnb3JpZXNbY2F0ZWdvcnldLnB1c2gobm9kZURlZik7DQogICAgfSk7DQogICAgDQogICAgDQogICAgLy8gQ3JlYXRlIHRvb2xib3ggc2VjdGlvbnMgZm9yIGVhY2ggY2F0ZWdvcnkNCiAgICBPYmplY3QuZW50cmllcyhjYXRlZ29yaWVzKS5mb3JFYWNoKChbY2F0ZWdvcnksIG5vZGVzXSkgPT4gew0KICAgICAgICBjb25zdCBjYXRlZ29yeVNlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICAgICAgY2F0ZWdvcnlTZWN0aW9uLmNsYXNzTmFtZSA9ICdub2RlLWNhdGVnb3J5JzsNCiAgICAgICAgY2F0ZWdvcnlTZWN0aW9uLmlubmVySFRNTCA9IGANCiAgICAgICAgICAgIDxoNT4ke2NhdGVnb3J5LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgY2F0ZWdvcnkuc2xpY2UoMSl9PC9oNT4NCiAgICAgICAgICAgICR7bm9kZXMubWFwKG5vZGVEZWYgPT4gYA0KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InRvb2xib3gtbm9kZS1idG4iIGRhdGEtbm9kZS10eXBlPSIke25vZGVEZWYuaWR9IiB0aXRsZT0iJHtub2RlRGVmLmRlc2NyaXB0aW9ufSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSIke25vZGVEZWYuaWNvbn0iPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgPHNwYW4+JHtub2RlRGVmLm5hbWV9PC9zcGFuPg0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgYCkuam9pbignJyl9DQogICAgICAgIGA7DQogICAgICAgIA0KICAgICAgICBpZiAodG9vbGJveENvbnRlbnQpIHsNCiAgICAgICAgICAgIHRvb2xib3hDb250ZW50LmFwcGVuZENoaWxkKGNhdGVnb3J5U2VjdGlvbik7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICAvLyBSZS1hdHRhY2ggZXZlbnQgbGlzdGVuZXJzDQogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRvb2xib3gtbm9kZS1idG4nKS5mb3JFYWNoKGJ0biA9PiB7DQogICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICBjb25zdCBub2RlVHlwZSA9IGJ0bi5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS10eXBlJyk7DQogICAgICAgICAgICBpZiAobm9kZVR5cGUpIHsNCiAgICAgICAgICAgICAgICBhZGROb2RlKG5vZGVUeXBlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfSk7DQogICAgDQp9DQoNCi8vIFNldCB1cCBldmVudCBoYW5kbGVycw0KZnVuY3Rpb24gc2V0dXBFdmVudEhhbmRsZXJzKCkgew0KICAgIC8vIE5vdGU6IFRvb2xib3ggbm9kZSBidXR0b24gZXZlbnQgbGlzdGVuZXJzIGFyZSBzZXQgdXAgaW4gcG9wdWxhdGVUb29sYm94KCkNCiAgICAvLyB0byBhdm9pZCBkdXBsaWNhdGVzIHdoZW4gdGhlIHRvb2xib3ggaXMgcmVwb3B1bGF0ZWQNCiAgICANCiAgICAvLyBXb3JrZmxvdyBhY3Rpb25zDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3J1bi13b3JrZmxvdycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHJ1bldvcmtmbG93KTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcC13b3JrZmxvdycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN0b3BXb3JrZmxvdyk7DQogICAgLy8gTm90ZTogZGVsZXRlLXNlbGVjdGVkLCBjbGVhci1jYW52YXMsIHJlc2V0LXZpZXcsIGFuZCBhZGQtdGFnIGFyZSBub3cgaGFuZGxlZCBieSBoYW1idXJnZXIgbWVudQ0KICAgIA0KICAgIC8vIFpvb20gY29udHJvbHMNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9vbS1pbicpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnpvb21Jbik7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvb20tb3V0Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgd2luZG93LmNhbnZhc01hbmFnZXIuem9vbU91dCk7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvb20tZml0Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgd2luZG93LmNhbnZhc01hbmFnZXIuem9vbVRvRml0KTsNCiAgICANCiAgICAvLyBOb3RlOiBGaWxlIG9wZXJhdGlvbnMgKHNhdmUsIHNhdmUtYXMsIGxvYWQpIGFyZSBub3cgaGFuZGxlZCBieSBoYW1idXJnZXIgbWVudQ0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbGVhci1vdXRwdXQnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbGVhck91dHB1dCk7DQogICAgDQogICAgLy8gSGFtYnVyZ2VyIG1lbnUNCiAgICBzZXR1cEhhbWJ1cmdlck1lbnUoKTsNCiAgICANCiAgICAvLyBDb25maWcgcGFuZWwgdG9nZ2xlDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1jb25maWcnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVDb25maWdQYW5lbCk7DQogICAgDQogICAgLy8gSW5pdGlhbGl6ZSBjb25maWcgcGFuZWwgc3RhdGUgKHdpdGhvdXQgb3ZlcnJpZGluZyBpY29ucykNCiAgICBjb25zdCBjb25maWdQYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmbG93LWNvbmZpZy1wYW5lbCcpOw0KICAgIGlmIChjb25maWdQYW5lbCkgew0KICAgICAgICAvLyBEZWZhdWx0IGV4cGFuZGVkIChub3QgY29sbGFwc2VkKQ0KICAgICAgICBjb25maWdQYW5lbC5jbGFzc0xpc3QucmVtb3ZlKCdjb2xsYXBzZWQnKTsNCiAgICB9DQogICAgDQogICAgLy8gVG9vbGJveCB0b2dnbGUNCiAgICBjb25zdCB0b29sYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zsb3ctdG9vbGJveCcpOw0KICAgIGNvbnN0IHRvb2xib3hDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rvb2xib3gtY29udGVudCcpOw0KICAgIGNvbnN0IHRvZ2dsZVRvb2xib3hCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlLXRvb2xib3gnKTsNCiAgICBpZiAodG9vbGJveCAmJiB0b29sYm94Q29udGVudCAmJiB0b2dnbGVUb29sYm94QnRuKSB7DQogICAgICAgIC8vIERlZmF1bHQgZXhwYW5kZWQgKG5vdCBjb2xsYXBzZWQpDQogICAgICAgIHRvb2xib3guY2xhc3NMaXN0LnJlbW92ZSgnY29sbGFwc2VkJyk7DQogICAgICAgIHRvb2xib3hDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnJzsNCg0KICAgICAgICB0b2dnbGVUb29sYm94QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICB0b2dnbGVUb29sYm94KCk7DQogICAgICAgIH0pOw0KICAgIH0NCiAgICANCiAgICAvLyBPdXRwdXQgcGFuZWwgdG9nZ2xlDQogICAgY29uc3Qgb3V0cHV0UGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy1vdXRwdXQtcGFuZWwnKTsNCiAgICBjb25zdCBvdXRwdXRDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ291dHB1dC1jb250ZW50Jyk7DQogICAgY29uc3QgdG9nZ2xlT3V0cHV0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1vdXRwdXQnKTsNCiAgICBpZiAob3V0cHV0UGFuZWwgJiYgb3V0cHV0Q29udGVudCAmJiB0b2dnbGVPdXRwdXRCdG4pIHsNCiAgICAgICAgLy8gRGVmYXVsdCBjb2xsYXBzZWQNCiAgICAgICAgb3V0cHV0UGFuZWwuY2xhc3NMaXN0LmFkZCgnY29sbGFwc2VkJyk7DQogICAgICAgIG91dHB1dENvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgdG9nZ2xlT3V0cHV0QnRuLnF1ZXJ5U2VsZWN0b3IoJ2knKS5jbGFzc05hbWUgPSAnZmFzIGZhLWNoZXZyb24tZG93bic7DQoNCiAgICAgICAgdG9nZ2xlT3V0cHV0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICBjb25zdCBpc0NvbGxhcHNlZCA9IG91dHB1dFBhbmVsLmNsYXNzTGlzdC5jb250YWlucygnY29sbGFwc2VkJyk7DQogICAgICAgICAgICBpZiAoaXNDb2xsYXBzZWQpIHsNCiAgICAgICAgICAgICAgICBvdXRwdXRQYW5lbC5jbGFzc0xpc3QucmVtb3ZlKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgICAgICAgICBvdXRwdXRDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnJzsNCiAgICAgICAgICAgICAgICB0b2dnbGVPdXRwdXRCdG4ucXVlcnlTZWxlY3RvcignaScpLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi11cCc7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIG91dHB1dFBhbmVsLmNsYXNzTGlzdC5hZGQoJ2NvbGxhcHNlZCcpOw0KICAgICAgICAgICAgICAgIG91dHB1dENvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICB0b2dnbGVPdXRwdXRCdG4ucXVlcnlTZWxlY3RvcignaScpLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1kb3duJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfQ0KICAgIA0KICAgIC8vIENhbnZhcyBldmVudHMNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHdpbmRvdy5jYW52YXNNYW5hZ2VyLmhhbmRsZUNhbnZhc0NsaWNrKTsNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB3aW5kb3cuY2FudmFzTWFuYWdlci5zdGFydENhbnZhc1Bhbik7DQogICAgZmxvd0VkaXRvci5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCB3aW5kb3cuY2FudmFzTWFuYWdlci5oYW5kbGVNb3VzZVdoZWVsLCB7IHBhc3NpdmU6IGZhbHNlIH0pOw0KICAgIA0KICAgIC8vIERvY3VtZW50LWxldmVsIG1vdXNlIGV2ZW50cyBmb3Igc21vb3RoIGRyYWdnaW5nIGFuZCBwYW5uaW5nDQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgd2luZG93LmNhbnZhc01hbmFnZXIuaGFuZGxlRG9jdW1lbnRNb3VzZURvd24pOw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHdpbmRvdy5jYW52YXNNYW5hZ2VyLmhhbmRsZURvY3VtZW50TW91c2VNb3ZlKTsNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgd2luZG93LmNhbnZhc01hbmFnZXIuaGFuZGxlRG9jdW1lbnRNb3VzZVVwKTsNCiAgICANCiAgICAvLyBLZXlib2FyZCBzaG9ydGN1dHMNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlS2V5RG93bik7DQp9DQoNCi8vIFRvZ2dsZSBjb25maWcgcGFuZWwNCmZ1bmN0aW9uIHRvZ2dsZUNvbmZpZ1BhbmVsKCkgew0KICAgIGNvbnN0IGNvbmZpZ1BhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zsb3ctY29uZmlnLXBhbmVsJyk7DQogICAgY29uc3QgdG9nZ2xlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1jb25maWcnKTsNCiAgICBjb25zdCBpY29uID0gdG9nZ2xlQnRuLnF1ZXJ5U2VsZWN0b3IoJ2knKTsNCiAgICANCiAgICBpZiAoY29uZmlnUGFuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb2xsYXBzZWQnKSkgew0KICAgICAgICAvLyBFeHBhbmQNCiAgICAgICAgY29uZmlnUGFuZWwuY2xhc3NMaXN0LnJlbW92ZSgnY29sbGFwc2VkJyk7DQogICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ0NvbGxhcHNlIENvbmZpZ3VyYXRpb24gUGFuZWwnOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIENvbGxhcHNlDQogICAgICAgIGNvbmZpZ1BhbmVsLmNsYXNzTGlzdC5hZGQoJ2NvbGxhcHNlZCcpOw0KICAgICAgICBpY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1sZWZ0JzsNCiAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ0V4cGFuZCBDb25maWd1cmF0aW9uIFBhbmVsJzsNCiAgICB9DQp9DQoNCi8vIFRvZ2dsZSB0b29sYm94DQpmdW5jdGlvbiB0b2dnbGVUb29sYm94KCkgew0KICAgIGNvbnN0IHRvb2xib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy10b29sYm94Jyk7DQogICAgY29uc3QgdG9vbGJveENvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9vbGJveC1jb250ZW50Jyk7DQogICAgY29uc3QgdG9nZ2xlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS10b29sYm94Jyk7DQogICAgY29uc3QgaWNvbiA9IHRvZ2dsZUJ0bi5xdWVyeVNlbGVjdG9yKCdpJyk7DQogICAgDQogICAgaWYgKHRvb2xib3guY2xhc3NMaXN0LmNvbnRhaW5zKCdjb2xsYXBzZWQnKSkgew0KICAgICAgICAvLyBFeHBhbmQNCiAgICAgICAgdG9vbGJveC5jbGFzc0xpc3QucmVtb3ZlKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgdG9vbGJveENvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICcnOw0KICAgICAgICBpY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1sZWZ0JzsNCiAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ0NvbGxhcHNlIFRvb2xib3gnOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIENvbGxhcHNlDQogICAgICAgIHRvb2xib3guY2xhc3NMaXN0LmFkZCgnY29sbGFwc2VkJyk7DQogICAgICAgIHRvb2xib3hDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ0V4cGFuZCBUb29sYm94JzsNCiAgICB9DQp9DQoNCi8vIFNldHVwIGhhbWJ1cmdlciBtZW51IGZ1bmN0aW9uYWxpdHkNCmZ1bmN0aW9uIHNldHVwSGFtYnVyZ2VyTWVudSgpIHsNCiAgICBjb25zdCBoYW1idXJnZXJCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGFtYnVyZ2VyLW1lbnUnKTsNCiAgICBjb25zdCBkcm9wZG93bk1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGRvd24tbWVudScpOw0KICAgIA0KICAgIGlmICghaGFtYnVyZ2VyQnRuIHx8ICFkcm9wZG93bk1lbnUpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignSGFtYnVyZ2VyIG1lbnUgZWxlbWVudHMgbm90IGZvdW5kJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gVG9nZ2xlIG1lbnUgb24gaGFtYnVyZ2VyIGNsaWNrDQogICAgaGFtYnVyZ2VyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgDQogICAgICAgIC8vIFBvc2l0aW9uIHRoZSBkcm9wZG93biByZWxhdGl2ZSB0byB0aGUgaGFtYnVyZ2VyIGJ1dHRvbg0KICAgICAgICBpZiAoIWRyb3Bkb3duTWVudS5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKSkgew0KICAgICAgICAgICAgLy8gVXNlIHNjYWxlZCBtb3VzZSBjb29yZGluYXRlcyBmb3IgbW9yZSBpbnR1aXRpdmUgcG9zaXRpb25pbmcNCiAgICAgICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPyANCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOg0KICAgICAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gaGFtYnVyZ2VyQnRuLmNsb3Nlc3QoJy5mbG93LWVkaXRvciwgLmFwcC1jb250YWluZXInKTsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCAmJiBjb250YWluZXIpID8NCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOg0KICAgICAgICAgICAgICAgIChjb250YWluZXIgPyBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiB7IHRvcDogMCwgbGVmdDogMCB9KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUG9zaXRpb24gcmVsYXRpdmUgdG8gbW91c2UgY2xpY2ssIG9mZnNldCBzbGlnaHRseSB0byBhdm9pZCBjb3ZlcmluZyB0aGUgYnV0dG9uDQogICAgICAgICAgICBjb25zdCByZWxhdGl2ZVRvcCA9IG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcCArIDU7DQogICAgICAgICAgICBjb25zdCByZWxhdGl2ZUxlZnQgPSBtb3VzZUNvb3Jkcy54IC0gY29udGFpbmVyUmVjdC5sZWZ0IC0gMTgwIC0gMTAgKyAyMDsgLy8gTWVudSB3aWR0aCArIHNtYWxsIGdhcCwgdGhlbiAyMHB4IG1vcmUgdG8gdGhlIHJpZ2h0DQogICAgICAgICAgICANCiAgICAgICAgICAgIGRyb3Bkb3duTWVudS5zdHlsZS50b3AgPSByZWxhdGl2ZVRvcCArICdweCc7DQogICAgICAgICAgICBkcm9wZG93bk1lbnUuc3R5bGUubGVmdCA9IHJlbGF0aXZlTGVmdCArICdweCc7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGRyb3Bkb3duTWVudS5jbGFzc0xpc3QudG9nZ2xlKCdzaG93Jyk7DQogICAgfSk7DQogICAgDQogICAgLy8gQ2xvc2UgbWVudSB3aGVuIGNsaWNraW5nIG91dHNpZGUNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgIGlmICghZHJvcGRvd25NZW51LmNvbnRhaW5zKGUudGFyZ2V0KSAmJiAhaGFtYnVyZ2VyQnRuLmNvbnRhaW5zKGUudGFyZ2V0KSkgew0KICAgICAgICAgICAgZHJvcGRvd25NZW51LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIEhhbmRsZSBtZW51IGl0ZW0gY2xpY2tzIC0gT05MWSB0aGUgc3BlY2lmaWMgYWN0aW9ucyByZXF1ZXN0ZWQNCiAgICBkcm9wZG93bk1lbnUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICBjb25zdCBtZW51SXRlbSA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5tZW51LWl0ZW0nKTsNCiAgICAgICAgaWYgKCFtZW51SXRlbSkgcmV0dXJuOw0KICAgICAgICANCiAgICAgICAgY29uc3QgYWN0aW9uID0gbWVudUl0ZW0uZGF0YXNldC5hY3Rpb247DQogICAgICAgIGlmICghYWN0aW9uKSByZXR1cm47DQogICAgICAgIA0KICAgICAgICAvLyBDbG9zZSB0aGUgbWVudQ0KICAgICAgICBkcm9wZG93bk1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOw0KICAgICAgICANCiAgICAgICAgLy8gRXhlY3V0ZSBPTkxZIHRoZSByZXF1ZXN0ZWQgYWN0aW9uczogc2F2ZSwgc2F2ZS1hcywgbG9hZCwgZGVsZXRlLCBjbGVhci1hbGwsIHJlc2V0LXZpZXcsIGFkZC10YWcNCiAgICAgICAgc3dpdGNoIChhY3Rpb24pIHsNCiAgICAgICAgICAgIGNhc2UgJ3NhdmUtZmxvdyc6DQogICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5maWxlTWFuYWdlciAmJiB3aW5kb3cuZmlsZU1hbmFnZXIuc2F2ZUZsb3cpIHsNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LmZpbGVNYW5hZ2VyLnNhdmVGbG93KCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnc2F2ZS1mbG93LWFzJzoNCiAgICAgICAgICAgICAgICBpZiAod2luZG93LmZpbGVNYW5hZ2VyICYmIHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvd0FzKSB7DQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvd0FzKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbG9hZC1mbG93JzoNCiAgICAgICAgICAgICAgICBpZiAod2luZG93LmZpbGVNYW5hZ2VyICYmIHdpbmRvdy5maWxlTWFuYWdlci5sb2FkRmxvdykgew0KICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmlsZU1hbmFnZXIubG9hZEZsb3coKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdhZGQtdGFnJzoNCiAgICAgICAgICAgICAgICBpZiAod2luZG93LnRhZ01hbmFnZXIgJiYgd2luZG93LnRhZ01hbmFnZXIuYWRkVGFnKSB7DQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy50YWdNYW5hZ2VyLmFkZFRhZygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3Jlc2V0LXZpZXcnOg0KICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuY2FudmFzTWFuYWdlciAmJiB3aW5kb3cuY2FudmFzTWFuYWdlci5yZXNldENhbnZhc1Bhbikgew0KICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2FudmFzTWFuYWdlci5yZXNldENhbnZhc1BhbigpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZS1zZWxlY3RlZCc6DQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkZWxldGVTZWxlY3RlZE5vZGUgPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgICAgICAgICAgZGVsZXRlU2VsZWN0ZWROb2RlKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnY2xlYXItY2FudmFzJzoNCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNsZWFyQ2FudmFzID09PSAnZnVuY3Rpb24nKSB7DQogICAgICAgICAgICAgICAgICAgIGNsZWFyQ2FudmFzKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfSk7DQp9DQoNCi8vIEV4YW1wbGU6IHVpLW1hbmFnZXIuanMNCndpbmRvdy51aU1hbmFnZXIgPSB7DQogICAgcG9wdWxhdGVUb29sYm94LA0KICAgIHNldHVwRXZlbnRIYW5kbGVycywNCiAgICB0b2dnbGVDb25maWdQYW5lbCwNCiAgICB0b2dnbGVUb29sYm94DQp9Ow0KDQovLyBtYWluLmpzIC0gRW50cnkgcG9pbnQgZm9yIEZsb3cgRWRpdG9yDQoNCi8vIEdsb2JhbCB2YXJpYWJsZXMgKHNjb3BlZCB0byBhdm9pZCBnbG9iYWwgcG9sbHV0aW9uKQ0KbGV0IGZsb3dFZGl0b3IgPSB7DQogICAgbm9kZXM6IG5ldyBNYXAoKSwNCiAgICBjb25uZWN0aW9uczogbmV3IE1hcCgpLA0KICAgIHNlbGVjdGVkTm9kZTogbnVsbCwNCiAgICBkcmFnZ2luZ05vZGU6IG51bGwsDQogICAgY29ubmVjdGluZ0Zyb206IG51bGwsDQogICAgY2FudmFzOiBudWxsLA0KICAgIG5vZGVDb3VudGVyOiAwLA0KICAgIGlzUnVubmluZzogZmFsc2UsDQogICAgY3VycmVudEZpbGVQYXRoOiBudWxsLA0KICAgIGlzQWN0aXZlOiB0cnVlLA0KICAgIC8vIENhbnZhcyBwYW5uaW5nIHN0YXRlDQogICAgaXNQYW5uaW5nOiBmYWxzZSwNCiAgICBwYW5TdGFydDogeyB4OiAwLCB5OiAwIH0sDQogICAgcGFuT2Zmc2V0OiB7IHg6IC01MDAwLCB5OiAtNTAwMCB9LCAvLyBDZW50ZXIgdGhlIGxhcmdlIGNhbnZhcyBpbml0aWFsbHkNCiAgICBsYXN0UGFuT2Zmc2V0OiB7IHg6IC01MDAwLCB5OiAtNTAwMCB9LA0KICAgIC8vIFpvb20gc3RhdGUNCiAgICB6b29tTGV2ZWw6IDEuMCwNCiAgICBtaW5ab29tOiAwLjEsDQogICAgbWF4Wm9vbTogMy4wLA0KICAgIHpvb21TdGVwOiAwLjEsDQogICAgLy8gVGFnIHN5c3RlbQ0KICAgIHRhZ3M6IG5ldyBNYXAoKSwNCiAgICB0YWdDb3VudGVyOiAwLA0KICAgIGRyYWdnaW5nVGFnOiBudWxsLA0KICAgIHRhZ0RyYWdPZmZzZXQ6IG51bGwsDQogICAgdGFnVXBkYXRlVGltZW91dDogbnVsbCwNCiAgICAvLyBWaXN1YWwgcGVyZm9ybWFuY2UgZmxhZ3MNCiAgICB0cmFuc2Zvcm1VcGRhdGVSZXF1ZXN0ZWQ6IGZhbHNlLA0KICAgIGlzWm9vbWluZzogZmFsc2UsDQogICAgaXNSZXNldHRpbmc6IGZhbHNlLA0KICAgIHJlZHJhd0luUHJvZ3Jlc3M6IGZhbHNlLA0KICAgIGxhc3RXaGVlbFRpbWU6IDAsDQogICAgLy8gVGltZW91dCBJRHMgZm9yIGNsZWFudXANCiAgICB6b29tUmVkcmF3VGltZW91dDogbnVsbCwNCiAgICB6b29tRml0VGltZW91dDogbnVsbCwNCiAgICByZXNldFRpbWVvdXQ6IG51bGwNCn07DQoNCi8vIEluaXRpYWxpemUgd2hlbiBET00gaXMgcmVhZHkNCmFzeW5jIGZ1bmN0aW9uIGluaXRGbG93RWRpdG9yKCkgew0KICAgIA0KICAgIC8vIENoZWNrIGlmIFN5cG5leEFQSSBpcyBhdmFpbGFibGUgKGxvY2FsIHZhcmlhYmxlIGluIHNhbmRib3hlZCBlbnZpcm9ubWVudCkNCiAgICBpZiAodHlwZW9mIHN5cG5leEFQSSA9PT0gJ3VuZGVmaW5lZCcgfHwgIXN5cG5leEFQSSkgew0KICAgICAgICBjb25zb2xlLndhcm4oJ1N5cG5leEFQSSBub3QgYXZhaWxhYmxlIC0gcnVubmluZyBpbiBzdGFuZGFsb25lIG1vZGUnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgc2NhbGUgZGV0ZWN0aW9uIGZvciBhcHAgc2NhbGluZyBjb21wZW5zYXRpb24NCiAgICBpZiAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmluaXRTY2FsZURldGVjdGlvbikgew0KICAgICAgICBzeXBuZXhBUEkuaW5pdFNjYWxlRGV0ZWN0aW9uKChuZXdTY2FsZSwgb2xkU2NhbGUpID0+IHsNCiAgICAgICAgICAgIC8vIFJlZHJhdyBjb25uZWN0aW9ucyB3aGVuIHNjYWxlIGNoYW5nZXMNCiAgICAgICAgICAgIGlmICh0eXBlb2YgcmVkcmF3QWxsQ29ubmVjdGlvbnMgPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgDQogICAgLy8gVGVzdCBWRlMgQVBJDQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgdGVzdFJlc3VsdCA9IGF3YWl0IHN5cG5leEFQSS5saXN0VmlydHVhbEZpbGVzKCcvJyk7DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVkZTIEFQSSB0ZXN0IGZhaWxlZDonLCBlcnJvcik7DQogICAgfQ0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgY2FudmFzDQogICAgZmxvd0VkaXRvci5jYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy1jYW52YXMnKTsNCiAgICBpZiAoIWZsb3dFZGl0b3IuY2FudmFzKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Zsb3cgY2FudmFzIG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIENyZWF0ZSBTVkcgbWFya2VyIGRlZmluaXRpb25zIGZvciBjb25uZWN0aW9uIGFycm93cw0KICAgIGNvbnN0IGRlZnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2RlZnMnKTsNCiAgICBjb25zdCBtYXJrZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ21hcmtlcicpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2Fycm93aGVhZCcpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ21hcmtlcldpZHRoJywgJzEwJyk7DQogICAgbWFya2VyLnNldEF0dHJpYnV0ZSgnbWFya2VySGVpZ2h0JywgJzcnKTsNCiAgICBtYXJrZXIuc2V0QXR0cmlidXRlKCdyZWZYJywgJzknKTsNCiAgICBtYXJrZXIuc2V0QXR0cmlidXRlKCdyZWZZJywgJzMuNScpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ29yaWVudCcsICdhdXRvJyk7DQogICAgbWFya2VyLnNldEF0dHJpYnV0ZSgnbWFya2VyVW5pdHMnLCAnc3Ryb2tlV2lkdGgnKTsNCiAgICANCiAgICBjb25zdCBwb2x5Z29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwb2x5Z29uJyk7DQogICAgcG9seWdvbi5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICcwIDAsIDEwIDMuNSwgMCA3Jyk7DQogICAgcG9seWdvbi5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnIzRDQUY1MCcpOw0KICAgIA0KICAgIG1hcmtlci5hcHBlbmRDaGlsZChwb2x5Z29uKTsNCiAgICBkZWZzLmFwcGVuZENoaWxkKG1hcmtlcik7DQogICAgDQogICAgLy8gQ3JlYXRlIGEgdGVtcG9yYXJ5IFNWRyBjb250YWluZXIgZm9yIHRoZSBtYXJrZXIgZGVmaW5pdGlvbg0KICAgIGNvbnN0IG1hcmtlclN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7DQogICAgbWFya2VyU3ZnLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsNCiAgICBtYXJrZXJTdmcuc3R5bGUud2lkdGggPSAnMCc7DQogICAgbWFya2VyU3ZnLnN0eWxlLmhlaWdodCA9ICcwJzsNCiAgICBtYXJrZXJTdmcuYXBwZW5kQ2hpbGQoZGVmcyk7DQogICAgZmxvd0VkaXRvci5jYW52YXMuYXBwZW5kQ2hpbGQobWFya2VyU3ZnKTsNCiAgICANCiAgICAvLyBJbml0aWFsaXplIGNhbnZhcyB0cmFuc2Zvcm0gZm9yIHBhbm5pbmcNCiAgICB3aW5kb3cuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICANCiAgICAvLyBMb2FkIG5vZGVzIGZyb20gVkZTDQogICAgYXdhaXQgbm9kZVJlZ2lzdHJ5LmxvYWROb2Rlc0Zyb21WRlMoKTsNCiAgICANCiAgICAvLyBQb3B1bGF0ZSB0b29sYm94IHdpdGggbG9hZGVkIG5vZGVzDQogICAgd2luZG93LnVpTWFuYWdlci5wb3B1bGF0ZVRvb2xib3goKTsNCiAgICANCiAgICAvLyBTZXQgdXAgZXZlbnQgaGFuZGxlcnMNCiAgICB3aW5kb3cudWlNYW5hZ2VyLnNldHVwRXZlbnRIYW5kbGVycygpOw0KICAgIA0KICAgIC8vIENvbm5lY3QgdG8gV2ViU29ja2V0IGZvciByZWFsLXRpbWUgdXBkYXRlcw0KICAgIGNvbm5lY3RXZWJTb2NrZXQoKTsNCiAgICANCiAgICAvLyBIYW5kbGUgZnVsbHNjcmVlbiBjaGFuZ2VzIHRvIHByZXZlbnQgdmlzdWFsIGZsYXNoaW5nDQogICAgZnVuY3Rpb24gaGFuZGxlRnVsbHNjcmVlbkNoYW5nZSgpIHsNCiAgICAgICAgY29uc3QgaXNGdWxsc2NyZWVuID0gISEoZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQubW96RnVsbFNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQubXNGdWxsc2NyZWVuRWxlbWVudCk7DQogICAgICAgIA0KICAgICAgICBpZiAoaXNGdWxsc2NyZWVuKSB7DQogICAgICAgICAgICAvLyBBZGQgbm8tdHJhbnNpdGlvbnMgY2xhc3Mgd2hlbiBlbnRlcmluZyBmdWxsc2NyZWVuDQogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ25vLXRyYW5zaXRpb25zJyk7DQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ25vLXRyYW5zaXRpb25zJyk7DQogICAgICAgICAgICAgICAgLy8gUmVkcmF3IGNvbm5lY3Rpb25zIGFmdGVyIGZ1bGxzY3JlZW4gdHJhbnNpdGlvbg0KICAgICAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9LCA1MDApOyAvLyBBbGxvdyBmdWxsc2NyZWVuIHRyYW5zaXRpb24gdG8gY29tcGxldGUNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIEFkZCBuby10cmFuc2l0aW9ucyBjbGFzcyB3aGVuIGV4aXRpbmcgZnVsbHNjcmVlbg0KICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCduby10cmFuc2l0aW9ucycpOw0KICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCduby10cmFuc2l0aW9ucycpOw0KICAgICAgICAgICAgICAgIC8vIFJlZHJhdyBjb25uZWN0aW9ucyBhZnRlciBmdWxsc2NyZWVuIHRyYW5zaXRpb24NCiAgICAgICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSwgNTAwKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBMaXN0ZW4gZm9yIGZ1bGxzY3JlZW4gY2hhbmdlcw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2Z1bGxzY3JlZW5jaGFuZ2UnLCBoYW5kbGVGdWxsc2NyZWVuQ2hhbmdlKTsNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd3ZWJraXRmdWxsc2NyZWVuY2hhbmdlJywgaGFuZGxlRnVsbHNjcmVlbkNoYW5nZSk7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW96ZnVsbHNjcmVlbmNoYW5nZScsIGhhbmRsZUZ1bGxzY3JlZW5DaGFuZ2UpOw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ01TRnVsbHNjcmVlbkNoYW5nZScsIGhhbmRsZUZ1bGxzY3JlZW5DaGFuZ2UpOw0KICAgIA0KICAgIC8vIEhhbmRsZSB3aW5kb3cgcmVzaXplIHRvIHVwZGF0ZSBjb25uZWN0aW9ucyB3aXRoIGRlYm91bmNpbmcNCiAgICBsZXQgcmVzaXplVGltZW91dDsNCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4gew0KICAgICAgICAvLyBBZGQgbm8tdHJhbnNpdGlvbnMgY2xhc3MgZHVyaW5nIHJlc2l6ZSB0byBwcmV2ZW50IGZsYXNoaW5nDQogICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnbm8tdHJhbnNpdGlvbnMnKTsNCiAgICAgICAgDQogICAgICAgIC8vIERlYm91bmNlIHJlc2l6ZSBldmVudHMgdG8gcHJldmVudCBvdmVyd2hlbG1pbmcgdGhlIHN5c3RlbQ0KICAgICAgICBjbGVhclRpbWVvdXQocmVzaXplVGltZW91dCk7DQogICAgICAgIHJlc2l6ZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIC8vIFJlbW92ZSBuby10cmFuc2l0aW9ucyBjbGFzcw0KICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCduby10cmFuc2l0aW9ucycpOw0KICAgICAgICAgICAgLy8gVXNlIHJlcXVlc3RBbmltYXRpb25GcmFtZSBmb3Igc21vb3RoIHVwZGF0ZXMNCiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7DQogICAgICAgICAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9LCAxNTApOyAvLyAxNTBtcyBkZWJvdW5jZQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIEhhbmRsZSBhcHAgY2xlYW51cCB3aGVuIHdpbmRvdyBpcyB1bmxvYWRlZA0KICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCBjbGVhbnVwRmxvd0VkaXRvcik7DQogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BhZ2VoaWRlJywgY2xlYW51cEZsb3dFZGl0b3IpOw0KICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1bmxvYWQnLCBjbGVhbnVwRmxvd0VkaXRvcik7DQogICAgDQogICAgLy8gRmxvdyBFZGl0b3IgbG9hZGVkIHN1Y2Nlc3NmdWxseSAobm8gbm90aWZpY2F0aW9uIG5lZWRlZCkNCiAgICANCiAgICAvLyBVcGRhdGUgZmlsZW5hbWUgZGlzcGxheQ0KICAgIHdpbmRvdy5maWxlTWFuYWdlci51cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICANCn0NCg0KLy8gQ2xlYW51cCBmdW5jdGlvbiB0byByZW1vdmUgdG9vbHRpcHMgYW5kIGV2ZW50IGxpc3RlbmVycw0KZnVuY3Rpb24gY2xlYW51cEZsb3dFZGl0b3IoKSB7DQogICAgLy8gTWFyayBhcHAgYXMgaW5hY3RpdmUgdG8gcHJldmVudCBuZXcgdG9vbHRpcHMNCiAgICBmbG93RWRpdG9yLmlzQWN0aXZlID0gZmFsc2U7DQogICAgDQogICAgLy8gQ2xlYXIgYWxsIHRpbWVvdXRzIHRvIHByZXZlbnQgbWVtb3J5IGxlYWtzDQogICAgY2xlYXJUaW1lb3V0KGZsb3dFZGl0b3Iuem9vbVJlZHJhd1RpbWVvdXQpOw0KICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnpvb21GaXRUaW1lb3V0KTsNCiAgICBjbGVhclRpbWVvdXQoZmxvd0VkaXRvci5yZXNldFRpbWVvdXQpOw0KICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnRhZ1VwZGF0ZVRpbWVvdXQpOw0KICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQpOw0KICAgIA0KICAgIC8vIFJlbW92ZSBhbnkgbGluZ2VyaW5nIHRvb2x0aXBzIChjaGVjayBtdWx0aXBsZSBwb3NzaWJsZSBsb2NhdGlvbnMpDQogICAgY29uc3QgdG9vbHRpcHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29ubmVjdGlvbi10b29sdGlwLCAjY29ubmVjdGlvbi10b29sdGlwJyk7DQogICAgdG9vbHRpcHMuZm9yRWFjaCh0b29sdGlwID0+IHsNCiAgICAgICAgaWYgKHRvb2x0aXAucGFyZW50Tm9kZSkgew0KICAgICAgICAgICAgdG9vbHRpcC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRvb2x0aXApOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gUmVtb3ZlIGdsb2JhbCBldmVudCBsaXN0ZW5lcnMNCiAgICBpZiAod2luZG93LmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlcikgew0KICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyKTsNCiAgICAgICAgd2luZG93LmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlciA9IG51bGw7DQogICAgfQ0KICAgIA0KICAgIC8vIENsZWFyIGFueSBvdGhlciBnbG9iYWwgcmVmZXJlbmNlcw0KICAgIGlmICh3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyKSB7DQogICAgICAgIGRlbGV0ZSB3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyOw0KICAgIH0NCiAgICANCiAgICAvLyBSZXNldCB2aXN1YWwgc3RhdGUgZmxhZ3MNCiAgICBmbG93RWRpdG9yLnRyYW5zZm9ybVVwZGF0ZVJlcXVlc3RlZCA9IGZhbHNlOw0KICAgIGZsb3dFZGl0b3IuaXNab29taW5nID0gZmFsc2U7DQogICAgZmxvd0VkaXRvci5pc1Jlc2V0dGluZyA9IGZhbHNlOw0KICAgIGZsb3dFZGl0b3IucmVkcmF3SW5Qcm9ncmVzcyA9IGZhbHNlOw0KICAgIA0KICAgIC8vIEFsc28gcmVtb3ZlIGFueSB0b29sdGlwcyB0aGF0IG1pZ2h0IGJlIGluIHRoZSBib2R5DQogICAgY29uc3QgYm9keVRvb2x0aXBzID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yQWxsKCcuY29ubmVjdGlvbi10b29sdGlwJyk7DQogICAgYm9keVRvb2x0aXBzLmZvckVhY2godG9vbHRpcCA9PiB7DQogICAgICAgIGlmICh0b29sdGlwLnBhcmVudE5vZGUpIHsNCiAgICAgICAgICAgIHRvb2x0aXAucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0b29sdGlwKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KfQ0KDQovLyBDb25uZWN0IHRvIFdlYlNvY2tldCBzZXJ2ZXINCmFzeW5jIGZ1bmN0aW9uIGNvbm5lY3RXZWJTb2NrZXQoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgY29ubmVjdGVkID0gYXdhaXQgc3lwbmV4QVBJLmNvbm5lY3RTb2NrZXQoKTsNCiAgICAgICAgaWYgKGNvbm5lY3RlZCkgew0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBKb2luIGZsb3cgZWRpdG9yIHJvb20NCiAgICAgICAgICAgIHN5cG5leEFQSS5qb2luUm9vbSgnZmxvdy1lZGl0b3InKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTGlzdGVuIGZvciBtZXNzYWdlcw0KICAgICAgICAgICAgc3lwbmV4QVBJLm9uKCdmbG93X3VwZGF0ZScsIChkYXRhKSA9PiB7DQogICAgICAgICAgICAgICAgaGFuZGxlRmxvd1VwZGF0ZShkYXRhKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBTZW5kIGluaXRpYWwgY29ubmVjdGlvbiBtZXNzYWdlDQogICAgICAgICAgICBzeXBuZXhBUEkuc2VuZE1lc3NhZ2UoJ2Zsb3dfY29ubmVjdGVkJywgew0KICAgICAgICAgICAgICAgIGFwcElkOiBzeXBuZXhBUEkuZ2V0QXBwSWQoKSwNCiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCkNCiAgICAgICAgICAgIH0sICdmbG93LWVkaXRvcicpOw0KICAgICAgICAgICAgDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY29ubmVjdCB0byBXZWJTb2NrZXQgc2VydmVyJyk7DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdXZWJTb2NrZXQgY29ubmVjdGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgfQ0KfQ0KDQovLyBBZGQgYSBuZXcgbm9kZSB0byB0aGUgY2FudmFzIChkeW5hbWljIHZlcnNpb24pDQpmdW5jdGlvbiBhZGROb2RlKHR5cGUpIHsNCiAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKHR5cGUpOw0KICAgIGlmICghbm9kZURlZikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdVbmtub3duIG5vZGUgdHlwZTonLCB0eXBlKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBub2RlSWQgPSBgbm9kZV8keysrZmxvd0VkaXRvci5ub2RlQ291bnRlcn1gOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBwb3NpdGlvbiByZWxhdGl2ZSB0byBjdXJyZW50IHZpZXdwb3J0IGNlbnRlcg0KICAgIGNvbnN0IGNlbnRlciA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMgPyANCiAgICAgICAgd2luZG93LmZsb3dFZGl0b3JVdGlscy5nZXRWaWV3cG9ydENlbnRlckluQ2FudmFzKCkgOg0KICAgICAgICB7IHg6IDUwMDAsIHk6IDUwMDAgfTsgLy8gRmFsbGJhY2sgdG8gY2FudmFzIGNlbnRlcg0KICAgIA0KICAgIC8vIEFkZCBzb21lIHJhbmRvbSBvZmZzZXQgYXJvdW5kIHRoZSBjZW50ZXINCiAgICBjb25zdCBvZmZzZXRYID0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMjAwOyAvLyAtMTAwIHRvICsxMDANCiAgICBjb25zdCBvZmZzZXRZID0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMjAwOyAvLyAtMTAwIHRvICsxMDANCiAgICANCiAgICBjb25zdCBub2RlID0gew0KICAgICAgICBpZDogbm9kZUlkLA0KICAgICAgICB0eXBlOiB0eXBlLA0KICAgICAgICB4OiBjZW50ZXIueCArIG9mZnNldFgsDQogICAgICAgIHk6IGNlbnRlci55ICsgb2Zmc2V0WSwNCiAgICAgICAgY29uZmlnOiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG5vZGVEZWYuY29uZmlnKSksIC8vIERlZXAgY29weQ0KICAgICAgICBkYXRhOiB7fQ0KICAgIH07DQogICAgDQogICAgLy8gSW5pdGlhbGl6ZSBzcGVjaWFsIG5vZGUgc3RhdGVzDQogICAgaWYgKHR5cGUgPT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlID0gew0KICAgICAgICAgICAgY291bnQ6IDAsDQogICAgICAgICAgICBpbnRlcnZhbDogbnVsbCwNCiAgICAgICAgICAgIGlzUnVubmluZzogZmFsc2UNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgZmxvd0VkaXRvci5ub2Rlcy5zZXQobm9kZUlkLCBub2RlKTsNCiAgICANCiAgICAvLyBDcmVhdGUgbm9kZSBlbGVtZW50IHVzaW5nIHRoZSByZW5kZXJlcg0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gbm9kZVJlbmRlcmVyLmNyZWF0ZU5vZGVFbGVtZW50KG5vZGUpOw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFwcGVuZENoaWxkKG5vZGVFbGVtZW50KTsNCiAgICANCiAgICAvLyBTZW5kIHVwZGF0ZSB2aWEgV2ViU29ja2V0DQogICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2VuZE1lc3NhZ2UpIHsNCiAgICAgICAgc3lwbmV4QVBJLnNlbmRNZXNzYWdlKCdub2RlX2FkZGVkJywgew0KICAgICAgICAgICAgbm9kZUlkOiBub2RlSWQsDQogICAgICAgICAgICB0eXBlOiB0eXBlLA0KICAgICAgICAgICAgcG9zaXRpb246IHsgeDogbm9kZS54LCB5OiBub2RlLnkgfQ0KICAgICAgICB9LCAnZmxvdy1lZGl0b3InKTsNCiAgICB9DQogICAgDQp9DQoNCi8vIEhhbmRsZSBmbG93IHVwZGF0ZXMgZnJvbSBXZWJTb2NrZXQNCmZ1bmN0aW9uIGhhbmRsZUZsb3dVcGRhdGUoZGF0YSkgew0KICAgIC8vIEhhbmRsZSByZWFsLXRpbWUgdXBkYXRlcyBmcm9tIG90aGVyIGluc3RhbmNlcw0KfQ0KDQovLyBJbml0aWFsaXplIHdoZW4gRE9NIGlzIHJlYWR5DQppZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXRGbG93RWRpdG9yKTsNCn0gZWxzZSB7DQogICAgLy8gRE9NIGlzIGFscmVhZHkgbG9hZGVkDQogICAgaW5pdEZsb3dFZGl0b3IoKTsNCn0NCg0KDQo8L3NjcmlwdD4="
  },
  "package_info": {
    "format_version": "1.0",
    "created_at": "2025-08-07T14:39:41.950333",
    "packaged_by": "Sypnex OS App Packager",
    "source_directory": ".\\flow_editor"
  },
  "additional_files": [
    {
      "vfs_path": "/nodes/nodes-pack.json",
      "filename": "nodes-pack.json",
      "data": "ew0KICAidmVyc2lvbiI6ICIxLjAuMCIsDQogICJwYWNrZWRfYXQiOiAiMjAyNS0wNy0yN1QwNTowMDo0Ni44MjEwOTAiLA0KICAidG90YWxfbm9kZXMiOiAyMSwNCiAgIm5vZGVzIjogew0KICAgICJhcnJheSI6IHsNCiAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAibmFtZSI6ICJBcnJheSBPcGVyYXRpb25zIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQcm9jZXNzIGFycmF5cyBhbmQgbGlzdHMgd2l0aCBtYXAsIGZpbHRlciwgYW5kIG90aGVyIG9wZXJhdGlvbnMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWxpc3QiLA0KICAgICAgImNvbG9yIjogInByaW1hcnkiLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAgICAgIm5hbWUiOiAiQXJyYXkiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJvYmplY3QiLA0KICAgICAgICAgICJuYW1lIjogIk9iamVjdCIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInJlc3VsdCIsDQogICAgICAgICAgIm5hbWUiOiAiUmVzdWx0IiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJsZW5ndGgiLA0KICAgICAgICAgICJuYW1lIjogIkxlbmd0aCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpcnN0IiwNCiAgICAgICAgICAibmFtZSI6ICJGaXJzdCBJdGVtIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImxhc3QiLA0KICAgICAgICAgICJuYW1lIjogIkxhc3QgSXRlbSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJvcGVyYXRpb24iOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3BlcmF0aW9uIiwNCiAgICAgICAgICAidmFsdWUiOiAibWFwIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJtYXAiLA0KICAgICAgICAgICAgImZpbHRlciIsDQogICAgICAgICAgICAibGVuZ3RoIiwNCiAgICAgICAgICAgICJqb2luIiwNCiAgICAgICAgICAgICJmaXJzdCIsDQogICAgICAgICAgICAibGFzdCIsDQogICAgICAgICAgICAic2xpY2UiLA0KICAgICAgICAgICAgInJldmVyc2UiLA0KICAgICAgICAgICAgInNvcnQiLA0KICAgICAgICAgICAgInVuaXF1ZSIsDQogICAgICAgICAgICAib2JqZWN0X2tleXMiLA0KICAgICAgICAgICAgIm9iamVjdF92YWx1ZXMiLA0KICAgICAgICAgICAgIm9iamVjdF9lbnRyaWVzIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgImZpZWxkX3BhdGgiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkZpZWxkIFBhdGggKGZvciBtYXAvZmlsdGVyKSIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogImUuZy4sIG5hbWUsIHVzZXIuZW1haWwsIGlkIg0KICAgICAgICB9LA0KICAgICAgICAiZmlsdGVyX3ZhbHVlIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWx0ZXIgVmFsdWUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJWYWx1ZSB0byBmaWx0ZXIgYnkiDQogICAgICAgIH0sDQogICAgICAgICJmaWx0ZXJfb3BlcmF0b3IiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRmlsdGVyIE9wZXJhdG9yIiwNCiAgICAgICAgICAidmFsdWUiOiAiZXF1YWxzIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJlcXVhbHMiLA0KICAgICAgICAgICAgIm5vdF9lcXVhbHMiLA0KICAgICAgICAgICAgImNvbnRhaW5zIiwNCiAgICAgICAgICAgICJncmVhdGVyX3RoYW4iLA0KICAgICAgICAgICAgImxlc3NfdGhhbiIsDQogICAgICAgICAgICAic3RhcnRzX3dpdGgiLA0KICAgICAgICAgICAgImVuZHNfd2l0aCINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJqb2luX3NlcGFyYXRvciI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiSm9pbiBTZXBhcmF0b3IiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIsICIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlNlcGFyYXRvciBmb3Igam9pbiBvcGVyYXRpb24iDQogICAgICAgIH0sDQogICAgICAgICJzbGljZV9zdGFydCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJTbGljZSBTdGFydCIsDQogICAgICAgICAgInZhbHVlIjogMCwNCiAgICAgICAgICAibWluIjogMA0KICAgICAgICB9LA0KICAgICAgICAic2xpY2VfZW5kIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIlNsaWNlIEVuZCAoMCA9IGVuZCkiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDANCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJhcnJheV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAiYXVkaW8iOiB7DQogICAgICAiaWQiOiAiYXVkaW8iLA0KICAgICAgIm5hbWUiOiAiQXVkaW8gUGxheWVyIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5IGF1ZGlvIGZpbGVzIGFuZCBjb250cm9sIHBsYXliYWNrIiwNCiAgICAgICJpY29uIjogImZhcyBmYS12b2x1bWUtdXAiLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogIm1lZGlhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJmcm9udGVuZF9vbmx5IiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJiaW5hcnkiLA0KICAgICAgICAgICJuYW1lIjogIkJpbmFyeSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImF1ZGlvX2RhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkF1ZGlvIERhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ1cmwiLA0KICAgICAgICAgICJuYW1lIjogIlVSTCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhdWRpb19kYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJBdWRpbyBEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYXVkaW9fdXJsIiwNCiAgICAgICAgICAibmFtZSI6ICJBdWRpbyBVUkwiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZHVyYXRpb24iLA0KICAgICAgICAgICJuYW1lIjogIkR1cmF0aW9uIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAib3JpZ2luYWwiLA0KICAgICAgICAgICJuYW1lIjogIk9yaWdpbmFsIiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiYXV0b1BsYXkiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQXV0byBQbGF5IiwNCiAgICAgICAgICAidmFsdWUiOiAiZmFsc2UiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgInZvbHVtZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJWb2x1bWUgKDAtMSkiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgIm1heCI6IDEsDQogICAgICAgICAgInN0ZXAiOiAwLjENCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJhdWRpb19leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAiY29uZGl0aW9uIjogew0KICAgICAgImlkIjogImNvbmRpdGlvbiIsDQogICAgICAibmFtZSI6ICJDb25kaXRpb24iLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkNvbXBhcmUgaW5wdXQgdmFsdWUgdG8gYSBjb25kaXRpb24gYW5kIG91dHB1dCB0cnVlL2ZhbHNlIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1xdWVzdGlvbi1jaXJjbGUiLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogImxvZ2ljIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidmFsdWUiLA0KICAgICAgICAgICJuYW1lIjogIlZhbHVlIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAicmVzdWx0IiwNCiAgICAgICAgICAibmFtZSI6ICJSZXN1bHQiLA0KICAgICAgICAgICJ0eXBlIjogImJvb2xlYW4iDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAib3BlcmF0b3IiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3BlcmF0b3IiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJlcXVhbHMiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImVxdWFscyIsDQogICAgICAgICAgICAibm90X2VxdWFscyIsDQogICAgICAgICAgICAiZ3JlYXRlcl90aGFuIiwNCiAgICAgICAgICAgICJsZXNzX3RoYW4iLA0KICAgICAgICAgICAgImdyZWF0ZXJfdGhhbl9vcl9lcXVhbCIsDQogICAgICAgICAgICAibGVzc190aGFuX29yX2VxdWFsIiwNCiAgICAgICAgICAgICJjb250YWlucyIsDQogICAgICAgICAgICAibm90X2NvbnRhaW5zIiwNCiAgICAgICAgICAgICJzdGFydHNfd2l0aCIsDQogICAgICAgICAgICAiZW5kc193aXRoIiwNCiAgICAgICAgICAgICJpc19lbXB0eSIsDQogICAgICAgICAgICAiaXNfbm90X2VtcHR5Ig0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgImNvbXBhcmVfdmFsdWUiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkNvbXBhcmUgVG8iLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJWYWx1ZSB0byBjb21wYXJlIGFnYWluc3QiDQogICAgICAgIH0sDQogICAgICAgICJjYXNlX3NlbnNpdGl2ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJDYXNlIFNlbnNpdGl2ZSIsDQogICAgICAgICAgInZhbHVlIjogInRydWUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJjb25kaXRpb25fZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImRlbGF5Ijogew0KICAgICAgImlkIjogImRlbGF5IiwNCiAgICAgICJuYW1lIjogIkRlbGF5IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEZWxheXMgdGhlIGZsb3cgZXhlY3V0aW9uIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1jbG9jayIsDQogICAgICAiY29sb3IiOiAid2FybmluZyIsDQogICAgICAiY2F0ZWdvcnkiOiAiZmxvdyIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImV4ZWN1dG9yIjogImRlbGF5X2V4ZWN1dG9yIiwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJkZWxheV9tcyI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJEZWxheSAobWlsbGlzZWNvbmRzKSIsDQogICAgICAgICAgInZhbHVlIjogMTAwMCwNCiAgICAgICAgICAibWluIjogMCwNCiAgICAgICAgICAibWF4IjogNjAwMDAsDQogICAgICAgICAgInN0ZXAiOiAxMDANCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQogICAgImRpc3BsYXkiOiB7DQogICAgICAiaWQiOiAiZGlzcGxheSIsDQogICAgICAibmFtZSI6ICJEaXNwbGF5IFRleHQiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkRpc3BsYXkgdGV4dCBkYXRhIGluIHZhcmlvdXMgZm9ybWF0cyIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtZXllIiwNCiAgICAgICJjb2xvciI6ICJzdWNjZXNzIiwNCiAgICAgICJjYXRlZ29yeSI6ICJvdXRwdXQiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImZyb250ZW5kX29ubHkiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAianNvbiIsDQogICAgICAgICAgIm5hbWUiOiAiSlNPTiIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJiaW5hcnkiLA0KICAgICAgICAgICJuYW1lIjogIkJpbmFyeSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRpc3BsYXllZCIsDQogICAgICAgICAgIm5hbWUiOiAiRGlzcGxheWVkIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImlucHV0X3BvcnQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiSW5wdXQgUG9ydCIsDQogICAgICAgICAgInZhbHVlIjogImF1dG8iLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImF1dG8iLA0KICAgICAgICAgICAgInRleHQiLA0KICAgICAgICAgICAgImpzb24iLA0KICAgICAgICAgICAgImRhdGEiLA0KICAgICAgICAgICAgImJpbmFyeSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJmb3JtYXQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRm9ybWF0IiwNCiAgICAgICAgICAidmFsdWUiOiAidGV4dCIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidGV4dCIsDQogICAgICAgICAgICAianNvbiIsDQogICAgICAgICAgICAiaHRtbCINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJtYXhMZW5ndGgiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiTWF4IExlbmd0aCIsDQogICAgICAgICAgInZhbHVlIjogMTAwMCwNCiAgICAgICAgICAibWluIjogMSwNCiAgICAgICAgICAibWF4IjogMTAwMDAsDQogICAgICAgICAgInN0ZXAiOiAxMDANCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJkaXNwbGF5X2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJmb3JfZWFjaCI6IHsNCiAgICAgICJpZCI6ICJmb3JfZWFjaCIsDQogICAgICAibmFtZSI6ICJGb3IgRWFjaCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiSXRlcmF0ZSB0aHJvdWdoIGFuIGFycmF5IGFuZCBleGVjdXRlIGNvbm5lY3RlZCBub2RlcyBmb3IgZWFjaCBpdGVtIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1yZXBlYXQiLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogImZsb3ciLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImFycmF5IiwNCiAgICAgICAgICAibmFtZSI6ICJBcnJheSIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImN1cnJlbnRfaXRlbSIsDQogICAgICAgICAgIm5hbWUiOiAiQ3VycmVudCBJdGVtIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImN1cnJlbnRfaW5kZXgiLA0KICAgICAgICAgICJuYW1lIjogIkN1cnJlbnQgSW5kZXgiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjb21wbGV0ZWQiLA0KICAgICAgICAgICJuYW1lIjogIkNvbXBsZXRlZCIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJzdG9wX29uX2Vycm9yIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIlN0b3Agb24gRXJyb3IiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0cnVlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJpdGVyYXRpb25fZGVsYXkiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiSXRlcmF0aW9uIERlbGF5IChtcykiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgIm1heCI6IDYwMDAwLA0KICAgICAgICAgICJzdGVwIjogMTAwLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJEZWxheSBiZXR3ZWVuIGl0ZXJhdGlvbnMgaW4gbWlsbGlzZWNvbmRzIg0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImZvcl9lYWNoX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJodHRwIjogew0KICAgICAgImlkIjogImh0dHAiLA0KICAgICAgIm5hbWUiOiAiSFRUUCBSZXF1ZXN0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJNYWtlIEhUVFAgcmVxdWVzdHMgdG8gZXh0ZXJuYWwgQVBJcyBhbmQgc2VydmljZXMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWdsb2JlIiwNCiAgICAgICJjb2xvciI6ICJwcmltYXJ5IiwNCiAgICAgICJjYXRlZ29yeSI6ICJuZXR3b3JrIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImpzb24iLA0KICAgICAgICAgICJuYW1lIjogIkpTT04iLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJzdGF0dXNfY29kZSIsDQogICAgICAgICAgIm5hbWUiOiAiU3RhdHVzIENvZGUiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJoZWFkZXJzIiwNCiAgICAgICAgICAibmFtZSI6ICJIZWFkZXJzIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInVybCIsDQogICAgICAgICAgIm5hbWUiOiAiVVJMIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgInVybCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiVVJMIiwNCiAgICAgICAgICAidmFsdWUiOiAiaHR0cHM6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3Bvc3RzLzEiDQogICAgICAgIH0sDQogICAgICAgICJtZXRob2QiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiTWV0aG9kIiwNCiAgICAgICAgICAidmFsdWUiOiAiR0VUIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJHRVQiLA0KICAgICAgICAgICAgIlBPU1QiLA0KICAgICAgICAgICAgIlBVVCIsDQogICAgICAgICAgICAiREVMRVRFIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgImhlYWRlcnMiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dGFyZWEiLA0KICAgICAgICAgICJsYWJlbCI6ICJIZWFkZXJzIChKU09OKSIsDQogICAgICAgICAgInZhbHVlIjogIntcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIn0iDQogICAgICAgIH0sDQogICAgICAgICJib2R5Ijogew0KICAgICAgICAgICJ0eXBlIjogInRleHRhcmVhIiwNCiAgICAgICAgICAibGFiZWwiOiAiQm9keSAoSlNPTikiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ7XCJtZXNzYWdlXCI6IFwie3tWQUxVRX19XCIsIFwidGltZXN0YW1wXCI6IFwie3tKU09OOnRpbWVzdGFtcH19XCJ9Ig0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImh0dHBfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImltYWdlIjogew0KICAgICAgImlkIjogImltYWdlIiwNCiAgICAgICJuYW1lIjogIkltYWdlIERpc3BsYXkiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkRpc3BsYXkgaW1hZ2VzIGFuZCBjb250cm9sIHZpc3VhbGl6YXRpb24iLA0KICAgICAgImljb24iOiAiZmFzIGZhLWltYWdlIiwNCiAgICAgICJjb2xvciI6ICJpbmZvIiwNCiAgICAgICJjYXRlZ29yeSI6ICJtZWRpYSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiZnJvbnRlbmRfb25seSIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJpbWFnZV9kYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJJbWFnZSBEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidXJsIiwNCiAgICAgICAgICAibmFtZSI6ICJVUkwiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJpbmFyeSIsDQogICAgICAgICAgIm5hbWUiOiAiQmluYXJ5IiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiaW1hZ2VfZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiSW1hZ2UgRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImltYWdlX3VybCIsDQogICAgICAgICAgIm5hbWUiOiAiSW1hZ2UgVVJMIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRpbWVuc2lvbnMiLA0KICAgICAgICAgICJuYW1lIjogIkRpbWVuc2lvbnMiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAib3JpZ2luYWwiLA0KICAgICAgICAgICJuYW1lIjogIk9yaWdpbmFsIiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAibWF4X3ByZXZpZXdfc2l6ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJNYXggUHJldmlldyBTaXplIiwNCiAgICAgICAgICAidmFsdWUiOiAzMDAsDQogICAgICAgICAgIm1pbiI6IDUwLA0KICAgICAgICAgICJtYXgiOiA4MDAsDQogICAgICAgICAgInN0ZXAiOiA1MA0KICAgICAgICB9LA0KICAgICAgICAic2hvd19pbmZvIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIlNob3cgSW5mbyIsDQogICAgICAgICAgInZhbHVlIjogInRydWUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJpbWFnZV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAianNvbl9leHRyYWN0Ijogew0KICAgICAgImlkIjogImpzb25fZXh0cmFjdCIsDQogICAgICAibmFtZSI6ICJKU09OIEV4dHJhY3QiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkV4dHJhY3QgdmFsdWVzIGZyb20gSlNPTiBkYXRhIHVzaW5nIGRvdCBub3RhdGlvbiIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtY29kZS1icmFuY2giLA0KICAgICAgImNvbG9yIjogImluZm8iLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImpzb24iLA0KICAgICAgICAgICJuYW1lIjogIkpTT04iLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJqc29uIiwNCiAgICAgICAgICAibmFtZSI6ICJKU09OIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImV4dHJhY3RlZF92YWx1ZSIsDQogICAgICAgICAgIm5hbWUiOiAiRXh0cmFjdGVkIFZhbHVlIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpZWxkX3BhdGgiLA0KICAgICAgICAgICJuYW1lIjogIkZpZWxkIFBhdGgiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAib3JpZ2luYWwiLA0KICAgICAgICAgICJuYW1lIjogIk9yaWdpbmFsIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImZpZWxkX3BhdGgiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkZpZWxkIFBhdGgiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJkYXRhLml0ZW1zIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiVXNlIGRvdCBub3RhdGlvbiAoZS5nLiwgZGF0YS5pdGVtcy4wLm5hbWUpIg0KICAgICAgICB9LA0KICAgICAgICAiZGlzcGxheV9mb3JtYXQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRGlzcGxheSBGb3JtYXQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0ZXh0IiwNCiAgICAgICAgICAgICJqc29uIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJqc29uX2V4dHJhY3RfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImxsbV9jaGF0Ijogew0KICAgICAgImlkIjogImxsbV9jaGF0IiwNCiAgICAgICJuYW1lIjogIkxMTSBDaGF0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJDaGF0IHdpdGggTGFyZ2UgTGFuZ3VhZ2UgTW9kZWxzIHVzaW5nIE9sbGFtYSIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtcm9ib3QiLA0KICAgICAgImNvbG9yIjogImluZm8iLA0KICAgICAgImNhdGVnb3J5IjogImFpIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAicHJvbXB0IiwNCiAgICAgICAgICAibmFtZSI6ICJQcm9tcHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAic3lzdGVtX21lc3NhZ2UiLA0KICAgICAgICAgICJuYW1lIjogIlN5c3RlbSBNZXNzYWdlIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImNvbnRleHQiLA0KICAgICAgICAgICJuYW1lIjogIkNvbnRleHQiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJyZXNwb25zZSIsDQogICAgICAgICAgIm5hbWUiOiAiUmVzcG9uc2UiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidG9rZW5zX3VzZWQiLA0KICAgICAgICAgICJuYW1lIjogIlRva2VucyBVc2VkIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAibW9kZWxfdXNlZCIsDQogICAgICAgICAgIm5hbWUiOiAiTW9kZWwgVXNlZCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJmdWxsX3Jlc3BvbnNlIiwNCiAgICAgICAgICAibmFtZSI6ICJGdWxsIFJlc3BvbnNlIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImVuZHBvaW50Ijogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJPbGxhbWEgRW5kcG9pbnQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJodHRwOi8vMTI3LjAuMC4xOjExNDM0L3YxIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiaHR0cDovLzEyNy4wLjAuMToxMTQzNC92MSINCiAgICAgICAgfSwNCiAgICAgICAgIm1vZGVsIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJNb2RlbCBOYW1lIiwNCiAgICAgICAgICAidmFsdWUiOiAiSGFtbWVyQUkvbW4tbWFnLW1lbGwtcjE6bGF0ZXN0IiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAibGxhbWEyLCBjb2RlbGxhbWEsIGV0Yy4iDQogICAgICAgIH0sDQogICAgICAgICJ0ZW1wZXJhdHVyZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJUZW1wZXJhdHVyZSIsDQogICAgICAgICAgInZhbHVlIjogMC43LA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJtYXgiOiAyLA0KICAgICAgICAgICJzdGVwIjogMC4xDQogICAgICAgIH0sDQogICAgICAgICJtYXhfdG9rZW5zIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIk1heCBUb2tlbnMiLA0KICAgICAgICAgICJ2YWx1ZSI6IDIwNDgsDQogICAgICAgICAgIm1pbiI6IDEsDQogICAgICAgICAgIm1heCI6IDgxOTIsDQogICAgICAgICAgInN0ZXAiOiAxDQogICAgICAgIH0sDQogICAgICAgICJzeXN0ZW1fcHJvbXB0Ijogew0KICAgICAgICAgICJ0eXBlIjogInRleHRhcmVhIiwNCiAgICAgICAgICAibGFiZWwiOiAiU3lzdGVtIFByb21wdCIsDQogICAgICAgICAgInZhbHVlIjogIllvdSBhcmUgYSBoZWxwZnVsIEFJIGFzc2lzdGFudC4iLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJEZWZpbmUgdGhlIEFJJ3Mgcm9sZSBhbmQgYmVoYXZpb3IiDQogICAgICAgIH0sDQogICAgICAgICJpbmNsdWRlX2NvbnRleHQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiSW5jbHVkZSBDb250ZXh0IiwNCiAgICAgICAgICAidmFsdWUiOiAidHJ1ZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImxsbV9jaGF0X2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJsb2dpY2FsX2dhdGUiOiB7DQogICAgICAiaWQiOiAibG9naWNhbF9nYXRlIiwNCiAgICAgICJuYW1lIjogIkxvZ2ljYWwgR2F0ZSIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiT25seSBjb250aW51ZSBleGVjdXRpb24gaWYgaW5wdXQgaXMgdHJ1ZSIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtZmlsdGVyIiwNCiAgICAgICJjb2xvciI6ICJpbmZvIiwNCiAgICAgICJjYXRlZ29yeSI6ICJsb2dpYyIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImNvbmRpdGlvbiIsDQogICAgICAgICAgIm5hbWUiOiAiQ29uZGl0aW9uIiwNCiAgICAgICAgICAidHlwZSI6ICJib29sZWFuIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJpbnZlcnQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiSW52ZXJ0IExvZ2ljIiwNCiAgICAgICAgICAidmFsdWUiOiAiZmFsc2UiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgImRlc2NyaXB0aW9uIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJEZXNjcmlwdGlvbiIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIk9wdGlvbmFsIGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhpcyBnYXRlIGRvZXMiDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAibG9naWNhbF9nYXRlX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJtYXRoIjogew0KICAgICAgImlkIjogIm1hdGgiLA0KICAgICAgIm5hbWUiOiAiTWF0aCBPcGVyYXRpb25zIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQZXJmb3JtIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG9uIG51bWVyaWMgdmFsdWVzIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1jYWxjdWxhdG9yIiwNCiAgICAgICJjb2xvciI6ICJpbmZvIiwNCiAgICAgICJjYXRlZ29yeSI6ICJkYXRhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidmFsdWVfYSIsDQogICAgICAgICAgIm5hbWUiOiAiVmFsdWUgQSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ2YWx1ZV9iIiwNCiAgICAgICAgICAibmFtZSI6ICJWYWx1ZSBCIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm51bWJlcl9hIiwNCiAgICAgICAgICAibmFtZSI6ICJOdW1iZXIgQSIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm51bWJlcl9iIiwNCiAgICAgICAgICAibmFtZSI6ICJOdW1iZXIgQiIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAicmVzdWx0IiwNCiAgICAgICAgICAibmFtZSI6ICJSZXN1bHQiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZm9ybWF0dGVkIiwNCiAgICAgICAgICAibmFtZSI6ICJGb3JtYXR0ZWQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAib3BlcmF0aW9uIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk9wZXJhdGlvbiIsDQogICAgICAgICAgInZhbHVlIjogImFkZCIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAiYWRkIiwNCiAgICAgICAgICAgICJzdWJ0cmFjdCIsDQogICAgICAgICAgICAibXVsdGlwbHkiLA0KICAgICAgICAgICAgImRpdmlkZSIsDQogICAgICAgICAgICAibW9kdWxvIiwNCiAgICAgICAgICAgICJwb3dlciIsDQogICAgICAgICAgICAibWluIiwNCiAgICAgICAgICAgICJtYXgiLA0KICAgICAgICAgICAgImFicyIsDQogICAgICAgICAgICAicm91bmQiLA0KICAgICAgICAgICAgImZsb29yIiwNCiAgICAgICAgICAgICJjZWlsIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgInZhbHVlX2EiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiVmFsdWUgQSAoaWYgbm90IGNvbm5lY3RlZCkiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgInN0ZXAiOiAwLjAxDQogICAgICAgIH0sDQogICAgICAgICJ2YWx1ZV9iIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIlZhbHVlIEIgKGlmIG5vdCBjb25uZWN0ZWQpIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJzdGVwIjogMC4wMQ0KICAgICAgICB9LA0KICAgICAgICAiZGVjaW1hbF9wbGFjZXMiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiRGVjaW1hbCBQbGFjZXMiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgIm1heCI6IDEwLA0KICAgICAgICAgICJzdGVwIjogMQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogIm1hdGhfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgIm5vZGVfcmVmZXJlbmNlIjogew0KICAgICAgImlkIjogIm5vZGVfcmVmZXJlbmNlIiwNCiAgICAgICJuYW1lIjogIk5vZGUgUmVmZXJlbmNlIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJBY2Nlc3Mgb3V0cHV0IGRhdGEgZnJvbSBhbnkgcHJldmlvdXNseSBleGVjdXRlZCBub2RlIGluIHRoZSB3b3JrZmxvdyIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtbGluayIsDQogICAgICAiY29sb3IiOiAiaW5mbyIsDQogICAgICAiY2F0ZWdvcnkiOiAiZGF0YSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiLA0KICAgICAgICAgICJvcHRpb25hbCI6IHRydWUNCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJqc29uIiwNCiAgICAgICAgICAibmFtZSI6ICJKU09OIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm51bWJlciIsDQogICAgICAgICAgIm5hbWUiOiAiTnVtYmVyIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYm9vbGVhbiIsDQogICAgICAgICAgIm5hbWUiOiAiQm9vbGVhbiIsDQogICAgICAgICAgInR5cGUiOiAiYm9vbGVhbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJiaW5hcnkiLA0KICAgICAgICAgICJuYW1lIjogIkJpbmFyeSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm9yaWdpbmFsIiwNCiAgICAgICAgICAibmFtZSI6ICJPcmlnaW5hbCIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJzb3VyY2Vfbm9kZV9pZCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJTb3VyY2UgTm9kZSIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbXSwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiU2VsZWN0IGEgbm9kZSB0byByZWZlcmVuY2UiDQogICAgICAgIH0sDQogICAgICAgICJvdXRwdXRfcG9ydF9pZCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJPdXRwdXQgUG9ydCIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbXSwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiU2VsZWN0IGFuIG91dHB1dCBwb3J0Ig0KICAgICAgICB9LA0KICAgICAgICAiZmFsbGJhY2tfdmFsdWUiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkZhbGxiYWNrIFZhbHVlIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiVmFsdWUgdG8gdXNlIGlmIHJlZmVyZW5jZSBmYWlscyINCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJub2RlX3JlZmVyZW5jZV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAicmFuZG9tIjogew0KICAgICAgImlkIjogInJhbmRvbSIsDQogICAgICAibmFtZSI6ICJSYW5kb20gTnVtYmVyIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJHZW5lcmF0ZSByYW5kb20gbnVtYmVycyB3aXRoaW4gYSBzcGVjaWZpZWQgcmFuZ2UiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWRpY2UiLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIiwNCiAgICAgICAgICAib3B0aW9uYWwiOiB0cnVlDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJudW1iZXIiLA0KICAgICAgICAgICJuYW1lIjogIk51bWJlciIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJpbnRlZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJJbnRlZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZmxvYXQiLA0KICAgICAgICAgICJuYW1lIjogIkZsb2F0IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAibWluX3ZhbHVlIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIk1pbmltdW0gVmFsdWUiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgInN0ZXAiOiAwLjAxDQogICAgICAgIH0sDQogICAgICAgICJtYXhfdmFsdWUiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiTWF4aW11bSBWYWx1ZSIsDQogICAgICAgICAgInZhbHVlIjogMTAwLA0KICAgICAgICAgICJzdGVwIjogMC4wMQ0KICAgICAgICB9LA0KICAgICAgICAiZGVjaW1hbF9wbGFjZXMiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiRGVjaW1hbCBQbGFjZXMiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgIm1heCI6IDEwLA0KICAgICAgICAgICJzdGVwIjogMQ0KICAgICAgICB9LA0KICAgICAgICAib3V0cHV0X3R5cGUiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3V0cHV0IFR5cGUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJpbnRlZ2VyIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJpbnRlZ2VyIiwNCiAgICAgICAgICAgICJmbG9hdCINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAicmFuZG9tX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJyZXBlYXRlciI6IHsNCiAgICAgICJpZCI6ICJyZXBlYXRlciIsDQogICAgICAibmFtZSI6ICJSZXBlYXRlciIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiUmVwZWF0IGNvbm5lY3RlZCB3b3JrZmxvdyBhdCBpbnRlcnZhbHMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLXJlZG8iLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogInRyaWdnZXIiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjb3VudCIsDQogICAgICAgICAgIm5hbWUiOiAiQ291bnQiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJpbnRlcnZhbCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJJbnRlcnZhbCAobXMpIiwNCiAgICAgICAgICAidmFsdWUiOiAxMDAwLA0KICAgICAgICAgICJtaW4iOiAxMDAsDQogICAgICAgICAgIm1heCI6IDMwMDAwMCwNCiAgICAgICAgICAic3RlcCI6IDEwMA0KICAgICAgICB9LA0KICAgICAgICAiY291bnQiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiQ291bnQgKDAgPSBpbmZpbml0ZSkiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgInN0ZXAiOiAxDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAicmVwZWF0ZXJfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInN0cmluZyI6IHsNCiAgICAgICJpZCI6ICJzdHJpbmciLA0KICAgICAgIm5hbWUiOiAiU3RyaW5nIE9wZXJhdGlvbnMiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIk1hbmlwdWxhdGUgYW5kIHByb2Nlc3MgdGV4dCBzdHJpbmdzIHdpdGggdmFyaW91cyBvcGVyYXRpb25zIiwNCiAgICAgICJpY29uIjogImZhcyBmYS10ZXh0LXdpZHRoIiwNCiAgICAgICJjb2xvciI6ICJzZWNvbmRhcnkiLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHRfYiIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCBCIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJyZXN1bHQiLA0KICAgICAgICAgICJuYW1lIjogIlJlc3VsdCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImFycmF5IiwNCiAgICAgICAgICAibmFtZSI6ICJBcnJheSIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJsZW5ndGgiLA0KICAgICAgICAgICJuYW1lIjogIkxlbmd0aCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIndvcmRfY291bnQiLA0KICAgICAgICAgICJuYW1lIjogIldvcmQgQ291bnQiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJvcGVyYXRpb24iOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3BlcmF0aW9uIiwNCiAgICAgICAgICAidmFsdWUiOiAiY29uY2F0ZW5hdGUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImNvbmNhdGVuYXRlIiwNCiAgICAgICAgICAgICJzcGxpdCIsDQogICAgICAgICAgICAicmVwbGFjZSIsDQogICAgICAgICAgICAidHJpbSIsDQogICAgICAgICAgICAidXBwZXJjYXNlIiwNCiAgICAgICAgICAgICJsb3dlcmNhc2UiLA0KICAgICAgICAgICAgInN1YnN0cmluZyIsDQogICAgICAgICAgICAicmVnZXhfbWF0Y2giLA0KICAgICAgICAgICAgInJlZ2V4X3JlcGxhY2UiLA0KICAgICAgICAgICAgInN0YXJ0c193aXRoIiwNCiAgICAgICAgICAgICJlbmRzX3dpdGgiLA0KICAgICAgICAgICAgImNvbnRhaW5zIiwNCiAgICAgICAgICAgICJyZXBlYXQiLA0KICAgICAgICAgICAgImxhc3RfbGluZSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJ0ZXh0X2IiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIlRleHQgQiAoaWYgbm90IGNvbm5lY3RlZCkiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJTZWNvbmQgdGV4dCBpbnB1dCINCiAgICAgICAgfSwNCiAgICAgICAgInNlcGFyYXRvciI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiU2VwYXJhdG9yL0RlbGltaXRlciIsDQogICAgICAgICAgInZhbHVlIjogIiwiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJGb3Igc3BsaXQvam9pbiBvcGVyYXRpb25zIg0KICAgICAgICB9LA0KICAgICAgICAic2VhcmNoX3RleHQiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIlNlYXJjaCBUZXh0IiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiVGV4dCB0byBzZWFyY2gvcmVwbGFjZSINCiAgICAgICAgfSwNCiAgICAgICAgInJlcGxhY2VfdGV4dCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiUmVwbGFjZSBXaXRoIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiUmVwbGFjZW1lbnQgdGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgInN0YXJ0X2luZGV4Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIlN0YXJ0IEluZGV4IiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwDQogICAgICAgIH0sDQogICAgICAgICJlbmRfaW5kZXgiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiRW5kIEluZGV4ICgwID0gZW5kKSIsDQogICAgICAgICAgInZhbHVlIjogMCwNCiAgICAgICAgICAibWluIjogMA0KICAgICAgICB9LA0KICAgICAgICAicmVwZWF0X2NvdW50Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIlJlcGVhdCBDb3VudCIsDQogICAgICAgICAgInZhbHVlIjogMSwNCiAgICAgICAgICAibWluIjogMSwNCiAgICAgICAgICAibWF4IjogMTAwDQogICAgICAgIH0sDQogICAgICAgICJjYXNlX3NlbnNpdGl2ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJDYXNlIFNlbnNpdGl2ZSIsDQogICAgICAgICAgInZhbHVlIjogInRydWUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJzdHJpbmdfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInRleHQiOiB7DQogICAgICAiaWQiOiAidGV4dCIsDQogICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJPdXRwdXQgc3RhdGljIHRleHQgY29udGVudCIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtZm9udCIsDQogICAgICAiY29sb3IiOiAic2Vjb25kYXJ5IiwNCiAgICAgICJjYXRlZ29yeSI6ICJkYXRhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInVwcGVyY2FzZSIsDQogICAgICAgICAgIm5hbWUiOiAiVXBwZXJjYXNlIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImxvd2VyY2FzZSIsDQogICAgICAgICAgIm5hbWUiOiAiTG93ZXJjYXNlIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIndvcmRfY291bnQiLA0KICAgICAgICAgICJuYW1lIjogIldvcmQgQ291bnQiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJsZW5ndGgiLA0KICAgICAgICAgICJuYW1lIjogIkxlbmd0aCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgInRleHRfY29udGVudCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0YXJlYSIsDQogICAgICAgICAgImxhYmVsIjogIlRleHQgQ29udGVudCIsDQogICAgICAgICAgInZhbHVlIjogIkhlbGxvLCBXb3JsZCEiDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAidGV4dF9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAidGltZXIiOiB7DQogICAgICAiaWQiOiAidGltZXIiLA0KICAgICAgIm5hbWUiOiAiVGltZXIiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkRlbGF5IGV4ZWN1dGlvbiBmb3Igc3BlY2lmaWVkIG1pbGxpc2Vjb25kcyIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtY2xvY2siLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogInRyaWdnZXIiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGltZXN0YW1wIiwNCiAgICAgICAgICAibmFtZSI6ICJUaW1lc3RhbXAiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJlbGFwc2VkIiwNCiAgICAgICAgICAibmFtZSI6ICJFbGFwc2VkIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiaW50ZXJ2YWwiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiSW50ZXJ2YWwgKG1zKSIsDQogICAgICAgICAgInZhbHVlIjogMTAwMCwNCiAgICAgICAgICAibWluIjogMTAwLA0KICAgICAgICAgICJtYXgiOiA2MDAwMCwNCiAgICAgICAgICAic3RlcCI6IDEwMA0KICAgICAgICB9LA0KICAgICAgICAiY291bnQiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiQ291bnQiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEsDQogICAgICAgICAgIm1pbiI6IDEsDQogICAgICAgICAgIm1heCI6IDEwMCwNCiAgICAgICAgICAic3RlcCI6IDENCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJ0aW1lcl9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAidmZzX2RpcmVjdG9yeV9saXN0Ijogew0KICAgICAgImlkIjogInZmc19kaXJlY3RvcnlfbGlzdCIsDQogICAgICAibmFtZSI6ICJWRlMgRGlyZWN0b3J5IExpc3QiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkxpc3QgYWxsIGZpbGVzIGFuZCBkaXJlY3RvcmllcyBpbiBhIFZGUyBwYXRoIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1mb2xkZXItdHJlZSIsDQogICAgICAiY29sb3IiOiAicHJpbWFyeSIsDQogICAgICAiY2F0ZWdvcnkiOiAic3RvcmFnZSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGlyZWN0b3J5X3BhdGgiLA0KICAgICAgICAgICJuYW1lIjogIkRpcmVjdG9yeSBQYXRoIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZmlsZV9saXN0IiwNCiAgICAgICAgICAibmFtZSI6ICJGaWxlIExpc3QiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZmlsZV9wYXRocyIsDQogICAgICAgICAgIm5hbWUiOiAiRmlsZSBQYXRocyIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJmaWxlX25hbWVzIiwNCiAgICAgICAgICAibmFtZSI6ICJGaWxlIE5hbWVzIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImNvdW50IiwNCiAgICAgICAgICAibmFtZSI6ICJGaWxlIENvdW50IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGlyZWN0b3JpZXMiLA0KICAgICAgICAgICJuYW1lIjogIkRpcmVjdG9yaWVzIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpbGVzX29ubHkiLA0KICAgICAgICAgICJuYW1lIjogIkZpbGVzIE9ubHkiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiZGlyZWN0b3J5X3BhdGgiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkRpcmVjdG9yeSBQYXRoIiwNCiAgICAgICAgICAidmFsdWUiOiAiLyIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIi9hYnNvbHV0ZS9wYXRoL2luL3ZmcyINCiAgICAgICAgfSwNCiAgICAgICAgImZpbHRlcl9leHRlbnNpb25zIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWxlIEV4dGVuc2lvbnMgRmlsdGVyIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAidHh0LGpzb24sbWQgKGxlYXZlIGVtcHR5IGZvciBhbGwpIg0KICAgICAgICB9LA0KICAgICAgICAiaW5jbHVkZV9kaXJlY3RvcmllcyI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJJbmNsdWRlIERpcmVjdG9yaWVzIiwNCiAgICAgICAgICAidmFsdWUiOiAidHJ1ZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAicmVjdXJzaXZlIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIlJlY3Vyc2l2ZSIsDQogICAgICAgICAgInZhbHVlIjogImZhbHNlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAidmZzX2RpcmVjdG9yeV9saXN0X2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJ2ZnNfbG9hZCI6IHsNCiAgICAgICJpZCI6ICJ2ZnNfbG9hZCIsDQogICAgICAibmFtZSI6ICJWRlMgTG9hZCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiTG9hZCBkYXRhIGZyb20gdGhlIFZpcnR1YWwgRmlsZSBTeXN0ZW0iLA0KICAgICAgImljb24iOiAiZmFzIGZhLWZvbGRlci1vcGVuIiwNCiAgICAgICJjb2xvciI6ICJwcmltYXJ5IiwNCiAgICAgICJjYXRlZ29yeSI6ICJzdG9yYWdlIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZmlsZV9wYXRoIiwNCiAgICAgICAgICAibmFtZSI6ICJGaWxlIFBhdGgiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiZmlsZV9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWxlIFBhdGgiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIvbXlfZGF0YS5qc29uIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiL2Fic29sdXRlL3BhdGgvaW4vdmZzIg0KICAgICAgICB9LA0KICAgICAgICAiZm9ybWF0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkZvcm1hdCIsDQogICAgICAgICAgInZhbHVlIjogImpzb24iLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImpzb24iLA0KICAgICAgICAgICAgInRleHQiLA0KICAgICAgICAgICAgImJpbmFyeSIsDQogICAgICAgICAgICAiYmxvYiINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJhdXRvX3JlbG9hZCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJBdXRvIFJlbG9hZCBvbiBDaGFuZ2UiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJmYWxzZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInZmc19sb2FkX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJ2ZnNfc2F2ZSI6IHsNCiAgICAgICJpZCI6ICJ2ZnNfc2F2ZSIsDQogICAgICAibmFtZSI6ICJWRlMgU2F2ZSIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiU2F2ZSBkYXRhIHRvIHRoZSBWaXJ0dWFsIEZpbGUgU3lzdGVtIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1zYXZlIiwNCiAgICAgICJjb2xvciI6ICJwcmltYXJ5IiwNCiAgICAgICJjYXRlZ29yeSI6ICJzdG9yYWdlIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInN1Y2Nlc3MiLA0KICAgICAgICAgICJuYW1lIjogIlN1Y2Nlc3MiLA0KICAgICAgICAgICJ0eXBlIjogImJvb2xlYW4iDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiZmlsZV9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWxlIFBhdGgiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIvbXlfZGF0YS5qc29uIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiL2Fic29sdXRlL3BhdGgvaW4vdmZzIg0KICAgICAgICB9LA0KICAgICAgICAiZm9ybWF0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkZvcm1hdCIsDQogICAgICAgICAgInZhbHVlIjogImpzb24iLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImpzb24iLA0KICAgICAgICAgICAgInRleHQiLA0KICAgICAgICAgICAgImJpbmFyeSIsDQogICAgICAgICAgICAiYmxvYiINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJvdmVyd3JpdGUiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3ZlcndyaXRlIiwNCiAgICAgICAgICAidmFsdWUiOiAidHJ1ZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiYXBwZW5kIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkFwcGVuZCBNb2RlIiwNCiAgICAgICAgICAidmFsdWUiOiAiZmFsc2UiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJ2ZnNfc2F2ZV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfQ0KICB9DQp9",
      "size": 38145
    }
  ]
}