{
  "app_metadata": {
    "id": "flow_editor",
    "name": "Flow Editor",
    "description": "Visual node-based workflow editor for creating and executing data processing pipelines",
    "icon": "fas fa-project-diagram",
    "keywords": [
      "flow",
      "workflow",
      "nodes",
      "pipeline",
      "visual",
      "editor"
    ],
    "author": "Sypnex OS",
    "version": "1.1.7",
    "type": "user_app",
    "scripts": [
      "js/utils.js",
      "js/node-registry.js",
      "js/canvas.js",
      "js/node-config.js",
      "js/node-renderer.js",
      "js/data-executors.js",
      "js/http-executors.js",
      "js/media-executors.js",
      "js/flow-executors.js",
      "js/ai-executors.js",
      "js/execution-engine.js",
      "js/workflow.js",
      "js/canvas-manager.js",
      "js/tag-manager.js",
      "js/file-manager.js",
      "js/ui-manager.js",
      "js/main.js"
    ],
    "styles": [
      "css/layout.css",
      "css/nodes.css",
      "css/components.css",
      "css/node-types.css",
      "css/responsive.css",
      "css/performance.css",
      "css/os-theme.css"
    ],
    "additional_files": [
      {
        "vfs_path": "/apps/installed/flow_editor/nodes-pack.json",
        "source_file": "node-definitions/nodes-pack.json"
      }
    ],
    "settings": [
      {
        "key": "DEFAULT_HTTP_TIMEOUT",
        "name": "HTTP Timeout (ms)",
        "type": "number",
        "value": 30000,
        "description": "Default timeout for HTTP requests in milliseconds"
      },
      {
        "key": "AUTO_SAVE_INTERVAL",
        "name": "Auto Save Interval (s)",
        "type": "number",
        "value": 30,
        "description": "Auto save workflows every N seconds (0 = disabled)"
      },
      {
        "key": "MAX_NODES",
        "name": "Maximum Nodes",
        "type": "number",
        "value": 50,
        "description": "Maximum number of nodes allowed in a workflow"
      }
    ]
  },
  "files": {
    "flow_editor.app": "ew0KICAiaWQiOiAiZmxvd19lZGl0b3IiLA0KICAibmFtZSI6ICJGbG93IEVkaXRvciIsDQogICJkZXNjcmlwdGlvbiI6ICJWaXN1YWwgbm9kZS1iYXNlZCB3b3JrZmxvdyBlZGl0b3IgZm9yIGNyZWF0aW5nIGFuZCBleGVjdXRpbmcgZGF0YSBwcm9jZXNzaW5nIHBpcGVsaW5lcyIsDQogICJpY29uIjogImZhcyBmYS1wcm9qZWN0LWRpYWdyYW0iLA0KICAia2V5d29yZHMiOiBbImZsb3ciLCAid29ya2Zsb3ciLCAibm9kZXMiLCAicGlwZWxpbmUiLCAidmlzdWFsIiwgImVkaXRvciJdLA0KICAiYXV0aG9yIjogIlN5cG5leCBPUyIsDQogICJ2ZXJzaW9uIjogIjEuMS43IiwNCiAgInR5cGUiOiAidXNlcl9hcHAiLA0KICAic2NyaXB0cyI6IFsNCiAgICAianMvdXRpbHMuanMiLA0KICAgICJqcy9ub2RlLXJlZ2lzdHJ5LmpzIiwNCiAgICAianMvY2FudmFzLmpzIiwNCiAgICAianMvbm9kZS1jb25maWcuanMiLA0KICAgICJqcy9ub2RlLXJlbmRlcmVyLmpzIiwNCiAgICAianMvZGF0YS1leGVjdXRvcnMuanMiLA0KICAgICJqcy9odHRwLWV4ZWN1dG9ycy5qcyIsDQogICAgImpzL21lZGlhLWV4ZWN1dG9ycy5qcyIsDQogICAgImpzL2Zsb3ctZXhlY3V0b3JzLmpzIiwNCiAgICAianMvYWktZXhlY3V0b3JzLmpzIiwNCiAgICAianMvZXhlY3V0aW9uLWVuZ2luZS5qcyIsDQogICAgImpzL3dvcmtmbG93LmpzIiwNCiAgICAianMvY2FudmFzLW1hbmFnZXIuanMiLA0KICAgICJqcy90YWctbWFuYWdlci5qcyIsDQogICAgImpzL2ZpbGUtbWFuYWdlci5qcyIsDQogICAgImpzL3VpLW1hbmFnZXIuanMiLA0KICAgICJqcy9tYWluLmpzIg0KICBdLA0KICAic3R5bGVzIjogWw0KICAgICJjc3MvbGF5b3V0LmNzcyIsDQogICAgImNzcy9ub2Rlcy5jc3MiLA0KICAgICJjc3MvY29tcG9uZW50cy5jc3MiLA0KICAgICJjc3Mvbm9kZS10eXBlcy5jc3MiLA0KICAgICJjc3MvcmVzcG9uc2l2ZS5jc3MiLA0KICAgICJjc3MvcGVyZm9ybWFuY2UuY3NzIiwNCiAgICAiY3NzL29zLXRoZW1lLmNzcyINCiAgXSwNCiAgImFkZGl0aW9uYWxfZmlsZXMiOiBbDQogICAgew0KICAgICAgInZmc19wYXRoIjogIi9hcHBzL2luc3RhbGxlZC9mbG93X2VkaXRvci9ub2Rlcy1wYWNrLmpzb24iLA0KICAgICAgInNvdXJjZV9maWxlIjogIm5vZGUtZGVmaW5pdGlvbnMvbm9kZXMtcGFjay5qc29uIg0KICAgIH0NCiAgXSwNCiAgInNldHRpbmdzIjogWw0KICAgIHsNCiAgICAgICJrZXkiOiAiREVGQVVMVF9IVFRQX1RJTUVPVVQiLA0KICAgICAgIm5hbWUiOiAiSFRUUCBUaW1lb3V0IChtcykiLA0KICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICJ2YWx1ZSI6IDMwMDAwLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkRlZmF1bHQgdGltZW91dCBmb3IgSFRUUCByZXF1ZXN0cyBpbiBtaWxsaXNlY29uZHMiDQogICAgfSwNCiAgICB7DQogICAgICAia2V5IjogIkFVVE9fU0FWRV9JTlRFUlZBTCIsDQogICAgICAibmFtZSI6ICJBdXRvIFNhdmUgSW50ZXJ2YWwgKHMpIiwNCiAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAidmFsdWUiOiAzMCwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJBdXRvIHNhdmUgd29ya2Zsb3dzIGV2ZXJ5IE4gc2Vjb25kcyAoMCA9IGRpc2FibGVkKSINCiAgICB9LA0KICAgIHsNCiAgICAgICJrZXkiOiAiTUFYX05PREVTIiwNCiAgICAgICJuYW1lIjogIk1heGltdW0gTm9kZXMiLA0KICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICJ2YWx1ZSI6IDUwLA0KICAgICAgImRlc2NyaXB0aW9uIjogIk1heGltdW0gbnVtYmVyIG9mIG5vZGVzIGFsbG93ZWQgaW4gYSB3b3JrZmxvdyINCiAgICB9DQogIF0NCn0=",
    "flow_editor.html": "PHN0eWxlIHR5cGU9InRleHQvY3NzIj4vKiA9PT09PSBTdHlsZTogY3NzL2xheW91dC5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIExheW91dCAmIFN0cnVjdHVyZSAqLw0KLyogRW5zdXJlIGFwcC1jb250YWluZXIgdXNlcyBmdWxsIGhlaWdodCBhbmQgcHJldmVudCB2aXN1YWwgZmxhc2hpbmcgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcHAtY29udGFpbmVyIHsNCiAgICBoZWlnaHQ6IDEwMHZoOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIC8qIFByZXZlbnQgdmlzdWFsIGFydGlmYWN0cyBkdXJpbmcgZnVsbHNjcmVlbiB0cmFuc2l0aW9ucyAqLw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIHRyYW5zaXRpb246IG5vbmUgIWltcG9ydGFudA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcHAtY29udGVudCB7DQogICAgZmxleDogMTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBnYXA6IDEwcHg7DQogICAgcGFkZGluZzogMTBweDsNCiAgICBtaW4taGVpZ2h0OiAwOw0KICAgIC8qIFByZXZlbnQgZmxhc2hpbmcgZHVyaW5nIHJlc2l6ZSAqLw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpDQogICAgfQ0KLyogRmxvdyBFZGl0b3IgTGF5b3V0ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1lZGl0b3Igew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleDogMTsNCiAgICBnYXA6IDA7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBtaW4taGVpZ2h0OiAwOw0KICAgIC8qIEVuaGFuY2VkIHZpc3VhbCBzdGFiaWxpdHkgKi8NCiAgICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW4NCiAgICB9DQovKiBMZWZ0IFRvb2xib3ggKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xib3ggew0KICAgIHdpZHRoOiAyNTBweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBmbGV4LXNocmluazogMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LWhlYWRlciB7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtaGVhZGVyIGg0IHsNCiAgICBtYXJnaW46IDA7DQogICAgZm9udC1zaXplOiAxNnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdICN0b2dnbGUtdG9vbGJveCB7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdG9nZ2xlLXRvb2xib3g6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQovKiBDb2xsYXBzZWQgc3RhdGUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xib3guY29sbGFwc2VkIHsNCiAgICB3aWR0aDogNTBweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xib3guY29sbGFwc2VkIC50b29sYm94LWNvbnRlbnQgew0KICAgIGRpc3BsYXk6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYm94LmNvbGxhcHNlZCAudG9vbGJveC1oZWFkZXIgaDQgew0KICAgIGRpc3BsYXk6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1jb250ZW50IHsNCiAgICBmbGV4OiAxOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgcGFkZGluZzogMTBweA0KICAgIH0NCi8qIE1haW4gV29ya3NwYWNlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy13b3Jrc3BhY2Ugew0KICAgIGZsZXg6IDE7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIG1pbi13aWR0aDogMA0KICAgIH0NCi8qIFRvb2xiYXIgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgcGFkZGluZzogMTJweCAyMHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGZsZXgtc2hyaW5rOiAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xiYXItbGVmdCB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDEwcHg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jdXJyZW50LWZpbGUtaW5mbyB7DQogICAgbWFyZ2luLWxlZnQ6IDE1cHg7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmN1cnJlbnQtZmlsZW5hbWUgew0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xiYXItcmlnaHQgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZ2FwOiA4cHg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmUNCiAgICB9DQovKiBab29tIENvbnRyb2xzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuem9vbS1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogNHB4Ow0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuem9vbS1sZXZlbCB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIG1pbi13aWR0aDogNDBweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgdXNlci1zZWxlY3Q6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuem9vbS1jb250cm9scyBidXR0b24gew0KICAgIHBhZGRpbmc6IDRweCA2cHg7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWNvbnRyb2xzIGJ1dHRvbjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWNvbnRyb2xzIGJ1dHRvbjphY3RpdmUgew0KICAgIHRyYW5zZm9ybTogc2NhbGUoMC45NSkNCiAgICB9DQovKiBDYW52YXMgQ29udGFpbmVyICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jYW52YXMtY29udGFpbmVyIHsNCiAgICBmbGV4OiAxOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIC8qIFByZXZlbnQgdmlzdWFsIGFydGlmYWN0cyBhbmQgZmxhc2hpbmcgKi8NCiAgICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLyogSW1wcm92ZSByZW5kZXJpbmcgcGVyZm9ybWFuY2UgKi8NCiAgICBjb250YWluOiBsYXlvdXQgc3R5bGUgcGFpbnQ7DQogICAgd2lsbC1jaGFuZ2U6IGF1dG8NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jYW52YXMgew0KICAgIHdpZHRoOiAxMDAwMHB4Ow0KICAgIGhlaWdodDogMTAwMDBweDsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCAyMHB4IDIwcHgsIHZhcigtLWJvcmRlci1jb2xvcikgMXB4LCB0cmFuc3BhcmVudCAxcHgpLCByYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDQwcHggNDBweCwgdmFyKC0tYm9yZGVyLWNvbG9yKSAxcHgsIHRyYW5zcGFyZW50IDFweCk7DQogICAgYmFja2dyb3VuZC1zaXplOiA0MHB4IDQwcHg7DQogICAgY3Vyc29yOiBncmFiOw0KICAgIHRyYW5zZm9ybS1vcmlnaW46IDAgMDsNCiAgICB3aWxsLWNoYW5nZTogdHJhbnNmb3JtOw0KICAgIC8qIEVuaGFuY2VkIEdQVSBhY2NlbGVyYXRpb24gZm9yIHNtb290aGVyIHRyYW5zZm9ybXMgKi8NCiAgICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgcGVyc3BlY3RpdmU6IDEwMDBweDsNCiAgICAtd2Via2l0LXBlcnNwZWN0aXZlOiAxMDAwcHg7DQogICAgdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZDsNCiAgICAtd2Via2l0LXRyYW5zZm9ybS1zdHlsZTogcHJlc2VydmUtM2Q7DQogICAgLyogUHJldmVudCB2aXN1YWwgYXJ0aWZhY3RzIGR1cmluZyB6b29tICovDQogICAgaW1hZ2UtcmVuZGVyaW5nOiBhdXRvOw0KICAgIC13ZWJraXQtZm9udC1zbW9vdGhpbmc6IHN1YnBpeGVsLWFudGlhbGlhc2VkOw0KICAgIC8qIEltcHJvdmUgYmFja2dyb3VuZCBwYXR0ZXJuIHNjYWxpbmcgKi8NCiAgICBiYWNrZ3JvdW5kLWF0dGFjaG1lbnQ6IGxvY2FsDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY2FudmFzOmFjdGl2ZSB7DQogICAgY3Vyc29yOiBncmFiYmluZw0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNhbnZhcy5wYW5uaW5nIHsNCiAgICBjdXJzb3I6IGdyYWJiaW5nDQogICAgfQ0KLyogQ29uZmlndXJhdGlvbiBQYW5lbCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLXBhbmVsIHsNCiAgICB3aWR0aDogMzAwcHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBmbGV4LXNocmluazogMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctaGVhZGVyIHsNCiAgICBwYWRkaW5nOiAxNXB4Ow0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWhlYWRlciBoNCB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdG9nZ2xlLWNvbmZpZyB7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdG9nZ2xlLWNvbmZpZzpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCi8qIENvbGxhcHNlZCBzdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLXBhbmVsLmNvbGxhcHNlZCB7DQogICAgd2lkdGg6IDUwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25maWctcGFuZWwuY29sbGFwc2VkIC5jb25maWctY29udGVudCB7DQogICAgZGlzcGxheTogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbmZpZy1wYW5lbC5jb2xsYXBzZWQgLmNvbmZpZy1oZWFkZXIgaDQgew0KICAgIGRpc3BsYXk6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWNvbnRlbnQgew0KICAgIGZsZXg6IDE7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBwYWRkaW5nOiAxNXB4DQogICAgfQ0KLyogT3V0cHV0IFBhbmVsICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1vdXRwdXQtcGFuZWwgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgZmxleC1zaHJpbms6IDA7DQogICAgbWF4LWhlaWdodDogMzAwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAxMnB4IDE1cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LWhlYWRlciBoNCB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LWNvbnRlbnQgew0KICAgIHBhZGRpbmc6IDE1cHg7DQogICAgbWF4LWhlaWdodDogMjUwcHg7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBvdmVyZmxvdy14OiBoaWRkZW4NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1vdXRwdXQtcGFuZWwuY29sbGFwc2VkIC5vdXRwdXQtY29udGVudCB7DQogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctb3V0cHV0LXBhbmVsIC5vdXRwdXQtaGVhZGVyIHsNCiAgICBjdXJzb3I6IHBvaW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1vdXRwdXQtcGFuZWwgLm91dHB1dC1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDhweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyDQogICAgfQ0KLyogPT09PT0gU3R5bGU6IGNzcy9ub2Rlcy5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIE5vZGVzICYgQ29ubmVjdGlvbnMgKi8NCi8qIE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgbWluLXdpZHRoOiAxNTBweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIGN1cnNvcjogZ3JhYjsNCiAgICB1c2VyLXNlbGVjdDogbm9uZTsNCiAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjEpOw0KICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4ycyBlYXNlLCB0cmFuc2Zvcm0gMC4xcyBlYXNlOw0KICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm07DQogICAgLyogRW5oYW5jZWQgdmlzdWFsIHN0YWJpbGl0eSBkdXJpbmcgem9vbSAqLw0KICAgIGJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjsNCiAgICAtd2Via2l0LWJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjsNCiAgICAvKiBJbXByb3ZlIHJlbmRlcmluZyBxdWFsaXR5IGF0IGRpZmZlcmVudCB6b29tIGxldmVscyAqLw0KICAgIGltYWdlLXJlbmRlcmluZzogYXV0bzsNCiAgICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBzdWJwaXhlbC1hbnRpYWxpYXNlZDsNCiAgICB0cmFuc2Zvcm0tc3R5bGU6IHByZXNlcnZlLTNkOw0KICAgIC8qIERvIE5PVCB1c2UgJ2NvbnRhaW4nIHByb3BlcnR5IGFzIGl0IGhpZGVzIHRoZSBwb3J0cyB3aGljaCBhcmUgcG9zaXRpb25lZCBvdXRzaWRlICovDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZTphY3RpdmUgew0KICAgIGN1cnNvcjogZ3JhYmJpbmc7DQogICAgdHJhbnNpdGlvbjogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGU6aG92ZXIgew0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjE1KTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTFweCkgdHJhbnNsYXRleigwKTsNCiAgICAvKiBGb3JjZSBoYXJkd2FyZSBhY2NlbGVyYXRpb24gKi8NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLnNlbGVjdGVkIHsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXByaW1hcnktY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1oZWFkZXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweDsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5ub2RlLWRlbGV0ZS1idG4gew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICByaWdodDogLTVweDsNCiAgICB0b3A6IC01cHg7DQogICAgd2lkdGg6IDIwcHg7DQogICAgaGVpZ2h0OiAyMHB4Ow0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMTBweDsNCiAgICBvcGFjaXR5OiAwOw0KICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC4ycyBlYXNlOw0KICAgIHotaW5kZXg6IDEwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZTpob3ZlciAubm9kZS1kZWxldGUtYnRuIHsNCiAgICBvcGFjaXR5OiAxDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm5vZGUtZGVsZXRlLWJ0bjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogI2QzMmYyZjsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLXR5cGUgew0KICAgIHBhZGRpbmc6IDJweCA2cHg7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBmb250LXdlaWdodDogbm9ybWFsOw0KICAgIGJhY2tncm91bmQ6ICM2Yzc1N2Q7DQogICAgY29sb3I6IHdoaXRlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1jb250ZW50IHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1wb3J0cyB7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGhlaWdodDogMTAwJTsNCiAgICBwb2ludGVyLWV2ZW50czogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtcG9ydCB7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHdpZHRoOiAxMnB4Ow0KICAgIGhlaWdodDogMTJweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgcG9pbnRlci1ldmVudHM6IGFsbDsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1wb3J0OmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIHRyYW5zZm9ybTogc2NhbGUoMS4yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtcG9ydC5pbnB1dCB7DQogICAgbGVmdDogLTZweDsNCiAgICB0b3A6IDUwJTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTUwJSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLXBvcnQub3V0cHV0IHsNCiAgICByaWdodDogLTZweDsNCiAgICB0b3A6IDUwJTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTUwJSkNCiAgICB9DQovKiBDb25uZWN0aW9uIExpbmVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25uZWN0aW9uIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgcG9pbnRlci1ldmVudHM6IG5vbmU7DQogICAgei1pbmRleDogMTsNCiAgICAvKiBPcHRpbWl6ZSBTVkcgcmVuZGVyaW5nIHBlcmZvcm1hbmNlICovDQogICAgd2lsbC1jaGFuZ2U6IGF1dG87DQogICAgY29udGFpbjogbGF5b3V0IHN0eWxlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29ubmVjdGlvbi1saW5lIHsNCiAgICBzdHJva2U6IHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgc3Ryb2tlLXdpZHRoOiA4Ow0KICAgIGZpbGw6IG5vbmU7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICBvcGFjaXR5OiAwLjY7DQogICAgLyogU2xpZ2h0bHkgdHJhbnNwYXJlbnQgYnkgZGVmYXVsdCAqLw0KICAgIC8qIEltcHJvdmUgU1ZHIHJlbmRlcmluZyBxdWFsaXR5IGF0IGRpZmZlcmVudCB6b29tIGxldmVscyAqLw0KICAgIHNoYXBlLXJlbmRlcmluZzogZ2VvbWV0cmljUHJlY2lzaW9uOw0KICAgIHZlY3Rvci1lZmZlY3Q6IG5vbi1zY2FsaW5nLXN0cm9rZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbm5lY3Rpb24tbGluZTpob3ZlciB7DQogICAgc3Ryb2tlOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBvcGFjaXR5OiAxOw0KICAgIHN0cm9rZS13aWR0aDogMTANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25uZWN0aW9uLWxpbmUuY29ubmVjdGVkIHsNCiAgICBzdHJva2U6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIG9wYWNpdHk6IDAuOA0KICAgIH0NCi8qIFJ1bm5pbmcgU3RhdGUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUucnVubmluZyB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsNCiAgICBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlDQogICAgfQ0KLyogV2FpdGluZyBmb3IgSW5wdXRzIFN0YXRlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLndhaXRpbmctaW5wdXRzIHsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXdhcm5pbmctY29sb3IpOw0KICAgIGFuaW1hdGlvbjogd2FpdGluZy1wdWxzZSAycyBpbmZpbml0ZQ0KICAgIH0NCi8qIENvbXBsZXRlZCBTdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5jb21wbGV0ZWQgew0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tc3VjY2Vzcy1jb2xvcikNCiAgICB9DQovKiBFcnJvciBTdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5lcnJvciB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQpAa2V5ZnJhbWVzIHB1bHNlIHsNCiAgICAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS1zdWNjZXNzLWNvbG9yLXJnYiksIDAuNCk7DQogICAgICAgIH0gNzAlIHsNCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDAgMTBweCByZ2JhKHZhcigtLXN1Y2Nlc3MtY29sb3ItcmdiKSwgMCk7DQogICAgICAgIH0gMTAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS1zdWNjZXNzLWNvbG9yLXJnYiksIDApOw0KICAgICAgICB9DQogICAgfQ0KQGtleWZyYW1lcyB3YWl0aW5nLXB1bHNlIHsNCiAgICAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS13YXJuaW5nLWNvbG9yLXJnYiksIDAuNCk7DQogICAgICAgIH0gNzAlIHsNCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDAgMTBweCByZ2JhKHZhcigtLXdhcm5pbmctY29sb3ItcmdiKSwgMCk7DQogICAgICAgIH0gMTAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS13YXJuaW5nLWNvbG9yLXJnYiksIDApOw0KICAgICAgICB9DQogICAgfQ0KLyogPT09PT0gU3R5bGU6IGNzcy9jb21wb25lbnRzLmNzcyA9PT09PSAqLw0KLyogRmxvdyBFZGl0b3IgVUkgQ29tcG9uZW50cyAqLw0KLyogTm9kZSBDYXRlZ29yeSBUb29sYm94ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubm9kZS1jYXRlZ29yeSB7DQogICAgbWFyZ2luLWJvdHRvbTogMjBweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5ub2RlLWNhdGVnb3J5IGg1IHsNCiAgICBtYXJnaW46IDAgMCAxMHB4IDA7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7DQogICAgbGV0dGVyLXNwYWNpbmc6IDAuNXB4Ow0KICAgIHBhZGRpbmc6IDAgNXB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtbm9kZS1idG4gew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDEwcHg7DQogICAgcGFkZGluZzogMTJweCAxNXB4Ow0KICAgIG1hcmdpbi1ib3R0b206IDVweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBjdXJzb3I6IGdyYWI7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICB0ZXh0LWFsaWduOiBsZWZ0Ow0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1ub2RlLWJ0bjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KC0xcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1ub2RlLWJ0bjphY3RpdmUgew0KICAgIGN1cnNvcjogZ3JhYmJpbmc7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KDApDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtbm9kZS1idG4gaSB7DQogICAgZm9udC1zaXplOiAxNnB4Ow0KICAgIHdpZHRoOiAyMHB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LW5vZGUtYnRuIHNwYW4gew0KICAgIGZsZXg6IDE7DQogICAgZm9udC13ZWlnaHQ6IDUwMA0KICAgIH0NCi8qIEJ1dHRvbnMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0biB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogNnB4Ow0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQogICAgdGV4dC1kZWNvcmF0aW9uOiBub25lDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTFweCk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwgMCwgMCwgMC4xKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0bi1vdXRsaW5lLWRhbmdlciB7DQogICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4tb3V0bGluZS1kYW5nZXI6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4tb3V0bGluZS1zZWNvbmRhcnkgew0KICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuLW91dGxpbmUtc2Vjb25kYXJ5OmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKQ0KICAgIH0NCi8qIENvbmZpZ3VyYXRpb24gU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWdyb3VwIHsNCiAgICBtYXJnaW4tYm90dG9tOiAxNXB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1ncm91cCBsYWJlbCB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgbWFyZ2luLWJvdHRvbTogNXB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgaW5wdXQgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgdHJhbnNpdGlvbjogYm9yZGVyLWNvbG9yIDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgc2VsZWN0IHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOw0KICAgIGN1cnNvcjogcG9pbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgaW5wdXQ6Zm9jdXMgew0KICAgIG91dGxpbmU6IG5vbmU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgc2VsZWN0OmZvY3VzIHsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDIxMiwgMjU1LCAwLjA1KQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgc2VsZWN0IG9wdGlvbiB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1ncm91cCBzZWxlY3Qgb3B0aW9uOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZykNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWdyb3VwIHRleHRhcmVhIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHJlc2l6ZTogdmVydGljYWw7DQogICAgbWluLWhlaWdodDogODBweDsNCiAgICBmb250LWZhbWlseTogbW9ub3NwYWNlDQogICAgfQ0KLyogVGFnIFBhbmVsICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdGFnLXBhbmVsIHsNCiAgICBtYXJnaW4tdG9wOiAyMHB4Ow0KICAgIHBhZGRpbmctdG9wOiAyMHB4Ow0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gI3RhZy1wYW5lbCBoNSB7DQogICAgbWFyZ2luOiAwIDAgMTVweCAwOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDEwcHg7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQogICAgbWFyZ2luLWJvdHRvbTogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctY29sb3Igew0KICAgIHdpZHRoOiAxMnB4Ow0KICAgIGhlaWdodDogMTJweDsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgZmxleC1zaHJpbms6IDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWluZm8gew0KICAgIGZsZXg6IDE7DQogICAgbWluLXdpZHRoOiAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1uYW1lIHsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIGZvbnQtc2l6ZTogMTNweDsNCiAgICBtYXJnaW4tYm90dG9tOiAycHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWRlc2NyaXB0aW9uIHsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgb3BhY2l0eTogMC43DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1kZWxldGUgew0KICAgIGJhY2tncm91bmQ6IG5vbmU7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGNvbG9yOiBpbmhlcml0Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBwYWRkaW5nOiA0cHg7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG9wYWNpdHk6IDAuNjsNCiAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctZGVsZXRlOmhvdmVyIHsNCiAgICBvcGFjaXR5OiAxOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKQ0KICAgIH0NCi8qIE91dHB1dCBTdHlsZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leGVjdXRpb24tb3V0cHV0IHsNCiAgICBmb250LWZhbWlseTogbW9ub3NwYWNlOw0KICAgIGZvbnQtc2l6ZTogMTNweDsNCiAgICBsaW5lLWhlaWdodDogMS40Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leGVjdXRpb24tb3V0cHV0IC5sb2ctZW50cnkgew0KICAgIG1hcmdpbi1ib3R0b206IDVweDsNCiAgICBwYWRkaW5nOiA0cHggMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leGVjdXRpb24tb3V0cHV0IC5sb2ctZW50cnkuaW5mbyB7DQogICAgY29sb3I6IHZhcigtLWluZm8tY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmV4ZWN1dGlvbi1vdXRwdXQgLmxvZy1lbnRyeS5zdWNjZXNzIHsNCiAgICBjb2xvcjogdmFyKC0tc3VjY2Vzcy1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZXhlY3V0aW9uLW91dHB1dCAubG9nLWVudHJ5LmVycm9yIHsNCiAgICBjb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmV4ZWN1dGlvbi1vdXRwdXQgLmxvZy1lbnRyeS53YXJuaW5nIHsNCiAgICBjb2xvcjogdmFyKC0td2FybmluZy1jb2xvcikNCiAgICB9DQovKiBJbnB1dC9PdXRwdXQgTWFwcGluZ3MgQ29uZmlndXJhdGlvbiBTdHlsZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5ncy1jb25maWcsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5vdXRwdXQtbWFwcGluZ3MtY29uZmlnIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgbWFyZ2luLXRvcDogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmctY29uZmlnLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmctY29uZmlnIHsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICBib3JkZXItbGVmdDogM3B4IHNvbGlkIHZhcigtLXByaW1hcnktY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmctY29uZmlnOmxhc3QtY2hpbGQsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5vdXRwdXQtbWFwcGluZy1jb25maWc6bGFzdC1jaGlsZCB7DQogICAgbWFyZ2luLWJvdHRvbTogMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5nLWNvbmZpZyBsYWJlbCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm91dHB1dC1tYXBwaW5nLWNvbmZpZyBsYWJlbCB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIG1hcmdpbi1ib3R0b206IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5nLXNlbGVjdCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm91dHB1dC1tYXBwaW5nLXNlbGVjdCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LXRhcmdldC1zZWxlY3Qgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQogICAgY3Vyc29yOiBwb2ludGVyDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmctc2VsZWN0OmZvY3VzLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmctc2VsZWN0OmZvY3VzLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtdGFyZ2V0LXNlbGVjdDpmb2N1cyB7DQogICAgb3V0bGluZTogbm9uZTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAyMTIsIDI1NSwgMC4wNSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZy1zZWxlY3Qgb3B0aW9uLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmctc2VsZWN0IG9wdGlvbiwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LXRhcmdldC1zZWxlY3Qgb3B0aW9uIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWJnKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgcGFkZGluZzogOHB4IDEycHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZy1zZWxlY3Qgb3B0aW9uOmhvdmVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmctc2VsZWN0IG9wdGlvbjpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LXRhcmdldC1zZWxlY3Qgb3B0aW9uOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZykNCiAgICB9DQovKiBMZWdhY3kgc3R5bGVzIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZ3Mgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBtYXJnaW4tdG9wOiA0cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZyB7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBtYXJnaW4tYm90dG9tOiA0cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgbGluZS1oZWlnaHQ6IDEuMg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5nOmxhc3QtY2hpbGQgew0KICAgIG1hcmdpbi1ib3R0b206IDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZyAuc291cmNlLW5vZGUgew0KICAgIGZvbnQtd2VpZ2h0OiA2MDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZyAuc291cmNlLXBvcnQgew0KICAgIG9wYWNpdHk6IDAuODsNCiAgICBmb250LXN0eWxlOiBpdGFsaWMNCiAgICB9DQovKiBDb2xsYXBzaWJsZSBDb25maWd1cmF0aW9uIFNlY3Rpb25zIC0gVXNpbmcgZXhpc3RpbmcgT1MgdGhlbWUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbiB7DQogICAgbWFyZ2luLWJvdHRvbTogMTVweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1zZWN0aW9uLWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIHBhZGRpbmc6IDEycHggMTVweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICB1c2VyLXNlbGVjdDogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbi1oZWFkZXI6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLXNlY3Rpb24taGVhZGVyLmNvbGxhcHNlZCB7DQogICAgYm9yZGVyLWJvdHRvbTogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbi1oZWFkZXIgaSB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1zZWN0aW9uLWhlYWRlciBzcGFuIHsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBmb250LXNpemU6IDE0cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWNvdW50IHsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7DQogICAgbWFyZ2luLWxlZnQ6IGF1dG8NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLXNlY3Rpb24tY29udGVudCB7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbi1oZWFkZXIuY29sbGFwc2VkICsgLmNvbmZpZy1zZWN0aW9uLWNvbnRlbnQgew0KICAgIGJvcmRlci10b3A6IG5vbmUNCiAgICB9DQovKiBBZGp1c3QgZXhpc3RpbmcgY29uZmlnIGdyb3VwcyB3aXRoaW4gc2VjdGlvbnMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbiAuY29uZmlnLWdyb3VwIHsNCiAgICBtYXJnaW4tYm90dG9tOiAxMnB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1zZWN0aW9uIC5jb25maWctZ3JvdXA6bGFzdC1jaGlsZCB7DQogICAgbWFyZ2luLWJvdHRvbTogMA0KICAgIH0NCi8qID09PT09IFN0eWxlOiBjc3Mvbm9kZS10eXBlcy5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIE5vZGUgVHlwZSBTcGVjaWZpYyBTdHlsZXMgKi8NCi8qIERpc3BsYXkgTm9kZSBDb250ZW50ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZGlzcGxheS1jb250ZW50IHsNCiAgICBwYWRkaW5nOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZGlzcGxheS10ZXh0IHsNCiAgICBtaW4taGVpZ2h0OiA0MHB4Ow0KICAgIG1heC1oZWlnaHQ6IDIwMHB4Ow0KICAgIHdpZHRoOiAyMjBweDsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgcmVzaXplOiBub25lOw0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3gNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZGlzcGxheS10ZXh0IHByZSB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7DQogICAgd2hpdGUtc3BhY2U6IHByZS13cmFwOw0KICAgIHdvcmQtYnJlYWs6IGJyZWFrLXdvcmQ7DQogICAgdXNlci1zZWxlY3Q6IHRleHQNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZGlzcGxheS1mb3JtYXQgew0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpDQogICAgfQ0KLyogQXVkaW8gUGxheWVyIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmF1ZGlvLWNvbnRyb2xzIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxMHB4Ow0KICAgIG1hcmdpbi10b3A6IDEwcHg7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmF1ZGlvLXBsYXktYnRuLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXVkaW8tc3RvcC1idG4gew0KICAgIHdpZHRoOiAzMnB4Ow0KICAgIGhlaWdodDogMzJweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXVkaW8tcGxheS1idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1Y2Nlc3MtY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hdWRpby1zdG9wLWJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hdWRpby1wbGF5LWJ0bjpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmF1ZGlvLXN0b3AtYnRuOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwgMCwgMCwgMC4yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hdWRpby1zdGF0dXMgew0KICAgIGZsZXg6IDE7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXINCiAgICB9DQovKiBKU09OIEV4dHJhY3QgRGlzcGxheSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmpzb24tZXh0cmFjdC1kaXNwbGF5IHsNCiAgICBtYXJnaW4tdG9wOiAxMHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuMDUpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leHRyYWN0LWxhYmVsIHsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIG1hcmdpbi1ib3R0b206IDRweDsNCiAgICBmb250LXdlaWdodDogNTAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmV4dHJhY3QtdmFsdWUgew0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiAzcHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leHRyYWN0LXZhbHVlLnN1Y2Nlc3Mgew0KICAgIGNvbG9yOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXN1Y2Nlc3MtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmV4dHJhY3QtdmFsdWUuZXJyb3Igew0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQovKiBSZXBlYXRlciBOb2RlIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLWNvbnRlbnQgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIHBhZGRpbmc6IDhweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5yZXBlYXRlci1zdGF0dXMgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBtaW4td2lkdGg6IDgwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAucmVwZWF0ZXItc3RhdHVzLnN0b3BwZWQgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4xKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAucmVwZWF0ZXItc3RhdHVzLnJ1bm5pbmcgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1Y2Nlc3MtY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLWNvbnRyb2xzIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGdhcDogOHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0YXJ0LWJ0biwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0b3AtYnRuIHsNCiAgICB3aWR0aDogMjhweDsNCiAgICBoZWlnaHQ6IDI4cHg7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0YXJ0LWJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VjY2Vzcy1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0b3AtYnRuIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0YXJ0LWJ0bjpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0b3AtYnRuOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwgMCwgMCwgMC4yKQ0KICAgIH0NCi8qIEltYWdlIE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtY29udGFpbmVyIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgbWluLWhlaWdodDogMTIwcHg7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtdGh1bWJuYWlsIHsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBvYmplY3QtZml0OiBjb250YWluOw0KICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtdGh1bWJuYWlsOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMDUpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtaW5mbyB7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMTFweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICB3aWR0aDogMTAwJQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbWFnZS1lcnJvciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA0cHg7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtZXJyb3IgaSB7DQogICAgZm9udC1zaXplOiAxNnB4DQogICAgfQ0KLyogSW1hZ2UgTW9kYWwgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwgew0KICAgIHBvc2l0aW9uOiBmaXhlZDsNCiAgICB0b3A6IDA7DQogICAgbGVmdDogMDsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjgpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICB6LWluZGV4OiAxMDAwOw0KICAgIHBhZGRpbmc6IDIwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtY29udGVudCB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIG1heC13aWR0aDogOTAlOw0KICAgIG1heC1oZWlnaHQ6IDkwJTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDIwcHggcmdiYSgwLCAwLCAwLCAwLjMpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLW1vZGFsLWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAxNXB4IDIwcHg7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtaGVhZGVyIHNwYW4gew0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLW1vZGFsLWNsb3NlIHsNCiAgICBiYWNrZ3JvdW5kOiBub25lOw0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBmb250LXNpemU6IDI0cHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBwYWRkaW5nOiAwOw0KICAgIHdpZHRoOiAzMHB4Ow0KICAgIGhlaWdodDogMzBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtY2xvc2U6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4xKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtYm9keSB7DQogICAgcGFkZGluZzogMjBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDE1cHg7DQogICAgbWF4LWhlaWdodDogY2FsYyg5MHZoIC0gMTAwcHgpOw0KICAgIG92ZXJmbG93LXk6IGF1dG8NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtaW1hZ2Ugew0KICAgIG1heC13aWR0aDogMTAwJTsNCiAgICBtYXgtaGVpZ2h0OiA3MHZoOw0KICAgIG9iamVjdC1maXQ6IGNvbnRhaW47DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtaW5mbyB7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIHBhZGRpbmc6IDEwcHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgd2lkdGg6IDEwMCUNCiAgICB9DQovKiBSYW5kb20gUXVvdGUgTm9kZSBTdHlsZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5xdW90ZS1jb250ZW50IHsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5xdW90ZS10ZXh0IHsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgbWluLWhlaWdodDogNDBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAucXVvdGUtZGlzcGxheSB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZm9udC1zaXplOiAxM3B4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjQ7DQogICAgbWF4LXdpZHRoOiAxMDAlOw0KICAgIHdvcmQtd3JhcDogYnJlYWstd29yZA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5xdW90ZS1pbmZvIHsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIHBhZGRpbmctdG9wOiA4cHgNCiAgICB9DQovKiBMTE0gQ2hhdCBOb2RlIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmxsbS1yZXNwb25zZSB7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjMsIDE2MiwgMTg0LCAwLjEpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBtYXJnaW46IDRweCAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlc3BvbnNlLXByZXZpZXcgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBsaW5lLWhlaWdodDogMS4zOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgbWFyZ2luLWJvdHRvbTogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnVzYWdlLWluZm8gew0KICAgIGZvbnQtc2l6ZTogMTBweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHJnYmEoMCwgMCwgMCwgMC4xKTsNCiAgICBwYWRkaW5nLXRvcDogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmxsbS1lcnJvciB7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjIwLCA1MywgNjksIDAuMSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG1hcmdpbjogNHB4IDA7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogNnB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmxsbS1lcnJvciBpIHsNCiAgICBmb250LXNpemU6IDE0cHgNCiAgICB9DQovKiBUZXh0IE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGV4dC1jb250ZW50IHsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgxMDgsIDExNywgMTI1LCAwLjEpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBtYXJnaW46IDRweCAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRleHQtcHJldmlldyB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjM7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsNCiAgICBtYXJnaW4tYm90dG9tOiA0cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGV4dC1pbmZvIHsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMSk7DQogICAgcGFkZGluZy10b3A6IDRweA0KICAgIH0NCi8qIE5vZGUgU3RhdHVzIERpc3BsYXkgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5ub2RlLXN0YXR1cyB7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG1hcmdpbjogNHB4IDA7DQogICAgdGV4dC1hbGlnbjogY2VudGVyDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnN0YXR1cy10ZXh0IHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgbWFyZ2luLWJvdHRvbTogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnN0YXR1cy1pbmZvIHsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpDQogICAgfQ0KLyogQ29udGVudCBEaXNwbGF5IGluIENvbmZpZyBQYW5lbCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbnRlbnQtZGlzcGxheSB7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgcGFkZGluZzogMTJweDsNCiAgICBtYXJnaW4tdG9wOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29udGVudC10ZXh0IHsNCiAgICBtYXJnaW46IDA7DQogICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgbGluZS1oZWlnaHQ6IDEuNDsNCiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7DQogICAgd29yZC1icmVhazogYnJlYWstd29yZDsNCiAgICBtYXgtaGVpZ2h0OiAzMDBweDsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogM3B4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICB1c2VyLXNlbGVjdDogdGV4dA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb250ZW50LWluZm8gew0KICAgIG1hcmdpbi10b3A6IDhweDsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgIH0NCi8qIFRlcm1pbmFsIE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGVybWluYWwtZXJyb3Igew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDIyMCwgNTMsIDY5LCAwLjEpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgbWFyZ2luLXRvcDogOHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRlcm1pbmFsLWVycm9yIGkgew0KICAgIG1hcmdpbi1yaWdodDogOHB4Ow0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQovKiA9PT09PSBTdHlsZTogY3NzL3Jlc3BvbnNpdmUuY3NzID09PT09ICovDQovKiBGbG93IEVkaXRvciBSZXNwb25zaXZlIERlc2lnbiAmIEVmZmVjdHMgKi8NCi8qIEhhbWJ1cmdlciBNZW51IFN0eWxlcyAtIEFsd2F5cyB2aXNpYmxlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaGFtYnVyZ2VyLWJ0biB7DQogICAgcGFkZGluZzogOHB4IDEycHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZHJvcGRvd24tbWVudSB7DQogICAgZGlzcGxheTogbm9uZTsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMik7DQogICAgei1pbmRleDogOTk5OTsNCiAgICBtaW4td2lkdGg6IDE4MHB4Ow0KICAgIHdpZHRoOiAxODBweDsNCiAgICBtYXgtaGVpZ2h0OiA3MHZoOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgcGFkZGluZzogMDsNCiAgICBtYXJnaW46IDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZHJvcGRvd24tbWVudS5zaG93IHsNCiAgICBkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm1lbnUtc2VjdGlvbiB7DQogICAgcGFkZGluZzogOHB4IDA7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1zZWN0aW9uOmxhc3QtY2hpbGQgew0KICAgIGJvcmRlci1ib3R0b206IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1zZWN0aW9uLXRpdGxlIHsNCiAgICBwYWRkaW5nOiA4cHggMTZweDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsNCiAgICBsZXR0ZXItc3BhY2luZzogMC41cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1pdGVtIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxMHB4Ow0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDEwcHggMTZweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAwLjJzIGVhc2U7DQogICAgdGV4dC1hbGlnbjogbGVmdA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5tZW51LWl0ZW06aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1pdGVtLmRhbmdlciB7DQogICAgY29sb3I6ICNmZjZiNmINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1pdGVtLmRhbmdlcjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDEwNywgMTA3LCAwLjEpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm1lbnUtem9vbS1jb250cm9scyB7DQogICAgcGFkZGluZzogMCAxNnB4Ow0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBnYXA6IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5tZW51LXpvb20tbGV2ZWwgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgcGFkZGluZzogNHB4IDA7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgbWFyZ2luOiA0cHggMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWJ0biB7DQogICAgcGFkZGluZzogNnB4IDEycHggIWltcG9ydGFudDsNCiAgICBmb250LXNpemU6IDEycHggIWltcG9ydGFudA0KICAgIH0NCi8qIFJlc3BvbnNpdmUgRGVzaWduICovDQpAbWVkaWEgKG1heC13aWR0aDogMTIwMHB4KSB7DQogICAgLmZsb3ctZWRpdG9yIHsNCiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgbWluLWhlaWdodDogMA0KICAgICAgICB9DQogICAgLmZsb3ctdG9vbGJveCB7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICBoZWlnaHQ6IGF1dG87DQogICAgICAgIGJvcmRlci1yaWdodDogbm9uZTsNCiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgICAgIGZsZXgtc2hyaW5rOiAwOw0KICAgICAgICBtYXgtaGVpZ2h0OiAyMDBweA0KICAgICAgICB9DQogICAgLnRvb2xib3gtY29udGVudCB7DQogICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgIGZsZXgtd3JhcDogd3JhcDsNCiAgICAgICAgZ2FwOiAxMHB4Ow0KICAgICAgICBwYWRkaW5nOiAxNXB4Ow0KICAgICAgICBvdmVyZmxvdy15OiBhdXRvDQogICAgICAgIH0NCiAgICAubm9kZS1jYXRlZ29yeSB7DQogICAgICAgIG1hcmdpbi1ib3R0b206IDA7DQogICAgICAgIGZsZXg6IDE7DQogICAgICAgIG1pbi13aWR0aDogMjAwcHgNCiAgICAgICAgfQ0KICAgIC5mbG93LXdvcmtzcGFjZSB7DQogICAgICAgIGZsZXg6IDE7DQogICAgICAgIG1pbi1oZWlnaHQ6IDANCiAgICAgICAgfQ0KICAgIC5mbG93LWNvbmZpZy1wYW5lbCB7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICBib3JkZXItbGVmdDogbm9uZTsNCiAgICAgICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgICAgIGZsZXgtc2hyaW5rOiAwOw0KICAgICAgICBtYXgtaGVpZ2h0OiAzMDBweA0KICAgICAgICB9DQogICAgLmZsb3ctb3V0cHV0LXBhbmVsIHsNCiAgICAgICAgbWF4LWhlaWdodDogMjAwcHgNCiAgICAgICAgfQ0KICAgIC5vdXRwdXQtY29udGVudCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4DQogICAgICAgIH0NCiAgICB9DQpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsNCiAgICAuYXBwLWNvbnRlbnQgew0KICAgICAgICBwYWRkaW5nOiA1cHg7DQogICAgICAgIGdhcDogNXB4DQogICAgICAgIH0NCiAgICAuZmxvdy10b29sYmFyIHsNCiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgZ2FwOiAxMHB4Ow0KICAgICAgICBwYWRkaW5nOiA4cHggMTVweA0KICAgICAgICB9DQogICAgLnRvb2xiYXItbGVmdCwgLnRvb2xiYXItcmlnaHQgew0KICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgIGZsZXgtd3JhcDogd3JhcA0KICAgICAgICB9DQogICAgLmZsb3ctdG9vbGJhciAuYnRuIHsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgICAgICBwYWRkaW5nOiA2cHggMTBweA0KICAgICAgICB9DQogICAgLmZsb3ctdG9vbGJveCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4DQogICAgICAgIH0NCiAgICAuZmxvdy1jb25maWctcGFuZWwgew0KICAgICAgICBtYXgtaGVpZ2h0OiAyNTBweA0KICAgICAgICB9DQogICAgLmZsb3ctb3V0cHV0LXBhbmVsIHsNCiAgICAgICAgbWF4LWhlaWdodDogMTUwcHgNCiAgICAgICAgfQ0KICAgIC5vdXRwdXQtY29udGVudCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDEwMHB4Ow0KICAgICAgICBwYWRkaW5nOiAxMHB4DQogICAgICAgIH0NCiAgICB9DQpAbWVkaWEgKG1heC13aWR0aDogNDgwcHgpIHsNCiAgICAudG9vbGJhci1sZWZ0LCAudG9vbGJhci1yaWdodCB7DQogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICAgIGdhcDogNXB4Ow0KICAgICAgICBhbGlnbi1pdGVtczogc3RyZXRjaA0KICAgICAgICB9DQogICAgLmZsb3ctdG9vbGJhciAuYnRuIHsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgICAgICB9DQogICAgLnpvb20tY29udHJvbHMgew0KICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcg0KICAgICAgICB9DQogICAgfQ0KLyogPT09PT0gU3R5bGU6IGNzcy9wZXJmb3JtYW5jZS5jc3MgPT09PT0gKi8NCi8qIFBlcmZvcm1hbmNlIG9wdGltaXphdGlvbnMgYW5kIGFudGktZmxhc2hpbmcgbWVhc3VyZXMgZm9yIEZsb3cgRWRpdG9yICovDQovKiBQcmV2ZW50IHZpc3VhbCBhcnRpZmFjdHMgZHVyaW5nIGZ1bGxzY3JlZW4gdHJhbnNpdGlvbnMgYW5kIHNjYWxpbmcgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5uby10cmFuc2l0aW9ucyAqIHsNCiAgICB0cmFuc2l0aW9uOiBub25lICFpbXBvcnRhbnQ7DQogICAgYW5pbWF0aW9uOiBub25lICFpbXBvcnRhbnQNCiAgICB9DQovKiBJbXByb3ZlIG92ZXJhbGwgcmVuZGVyaW5nIHBlcmZvcm1hbmNlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1lZGl0b3IgKiB7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveA0KICAgIH0NCi8qIFJlZHVjZSBsYXlvdXQgdGhyYXNoaW5nIGR1cmluZyB6b29tIG9wZXJhdGlvbnMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNhbnZhcywgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29ubmVjdGlvbiB7DQogICAgY29udGFpbjogbGF5b3V0IHN0eWxlIHBhaW50DQogICAgfQ0KLyogT3B0aW1pemUgZm9yIGhhcmR3YXJlIGFjY2VsZXJhdGlvbiAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY2FudmFzLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25uZWN0aW9uIHsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXooMCkNCiAgICB9DQovKiBQcmV2ZW50IGZvbnQgc21vb3RoaW5nIGlzc3VlcyBhdCBkaWZmZXJlbnQgem9vbSBsZXZlbHMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUgKiB7DQogICAgLXdlYmtpdC1mb250LXNtb290aGluZzogc3VicGl4ZWwtYW50aWFsaWFzZWQ7DQogICAgLW1vei1vc3gtZm9udC1zbW9vdGhpbmc6IGF1dG87DQogICAgdGV4dC1yZW5kZXJpbmc6IG9wdGltaXplU3BlZWQNCiAgICB9DQovKiBSZWR1Y2UgcGFpbnQgY29tcGxleGl0eSBkdXJpbmcgem9vbSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZTpub3QoOmhvdmVyKTpub3QoLnNlbGVjdGVkKSB7DQogICAgd2lsbC1jaGFuZ2U6IGF1dG8NCiAgICB9DQovKiBPbmx5IGVuYWJsZSB3aWxsLWNoYW5nZSB3aGVuIGFjdHVhbGx5IG5lZWRlZCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZTpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5zZWxlY3RlZCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5kcmFnZ2luZyB7DQogICAgd2lsbC1jaGFuZ2U6IHRyYW5zZm9ybQ0KICAgIH0NCi8qIEltcHJvdmUgcGVyZm9ybWFuY2Ugb2YgYW5pbWF0aW9ucyAqLw0KQG1lZGlhIChwcmVmZXJzLXJlZHVjZWQtbW90aW9uOiByZWR1Y2UpIHsNCiAgICAuZmxvdy1ub2RlLCAuZmxvdy1jb25uZWN0aW9uLWxpbmUgew0KICAgICAgICB0cmFuc2l0aW9uOiBub25lICFpbXBvcnRhbnQ7DQogICAgICAgIGFuaW1hdGlvbjogbm9uZSAhaW1wb3J0YW50DQogICAgICAgIH0NCiAgICB9DQovKiBGb3JjZSBjb21wb3NpdGluZyBsYXllciBmb3Igc21vb3RoZXIgdHJhbnNmb3JtcyBkdXJpbmcgem9vbSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY2FudmFzLnpvb21pbmcgew0KICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm07DQogICAgdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZA0KICAgIH0NCi8qIFJlbW92ZSBjb21wb3NpdGluZyBsYXllciB3aGVuIG5vdCB6b29taW5nICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jYW52YXM6bm90KC56b29taW5nKSB7DQogICAgd2lsbC1jaGFuZ2U6IGF1dG8NCiAgICB9DQovKiA9PT09PSBTdHlsZTogY3NzL29zLXRoZW1lLmNzcyA9PT09PSAqLw0KLyogRmxvdyBFZGl0b3IgLSBTeXBuZXhPUyBUaGVtZSBJbnRlZ3JhdGlvbiAqLw0KLyogVGhpcyBmaWxlIGVuc3VyZXMgdGhlIGZsb3cgZWRpdG9yIG1hdGNoZXMgdGhlIE9TIGFlc3RoZXRpYyBwZXJmZWN0bHkgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIHsNCiAgICAvKiBPdmVycmlkZSBmbG93IGVkaXRvciB2YXJpYWJsZXMgd2l0aCBPUyB2YXJpYWJsZXMgKi8NCiAgICAtLXN1cmZhY2UtY29sb3I6IHZhcigtLWdsYXNzLWJnKTsNCiAgICAtLWJvcmRlci1jb2xvcjogdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICAtLXRleHQtY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7DQogICAgLS10ZXh0LW11dGVkOiB2YXIoLS10ZXh0LXNlY29uZGFyeSk7DQogICAgLS1wcmltYXJ5LWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIC0tcHJpbWFyeS1jb2xvci1yZ2I6IDAsIDIxMiwgMjU1Ow0KICAgIC0tZXJyb3ItY29sb3I6ICNmZjQ3NTc7DQogICAgLS1zdWNjZXNzLWNvbG9yOiAjMmVkNTczOw0KICAgIC0td2FybmluZy1jb2xvcjogI2ZmYTUwMg0KICAgIH0NCi8qIEVuaGFuY2VkIGdsYXNzIG1vcnBoaXNtIGZvciBmbG93IGVkaXRvciAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctZWRpdG9yIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3JkZXItcmFkaXVzOiAxMnB4Ow0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KTsNCiAgICBib3gtc2hhZG93OiAwIDhweCAzMnB4IHJnYmEoMCwgMCwgMCwgMC4zKQ0KICAgIH0NCi8qIFRvb2xib3ggd2l0aCBiZXR0ZXIgZ2xhc3MgZWZmZWN0ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYm94IHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI2LCAyNiwgMjYsIDAuOSk7DQogICAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTVweCkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1oZWFkZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMTAsIDEwLCAxMCwgMC44KTsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LWhlYWRlciBoNCB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgdGV4dC1zaGFkb3c6IDAgMCAxMHB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMykNCiAgICB9DQovKiBFbmhhbmNlZCBub2RlIHN0eWxpbmcgd2l0aCBnbGFzcyBtb3JwaGlzbSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZSB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm9yZGVyLXJhZGl1czogMTJweDsNCiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTBweCk7DQogICAgYm94LXNoYWRvdzogMCA0cHggMjBweCByZ2JhKDAsIDAsIDAsIDAuMik7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGU6aG92ZXIgew0KICAgIGJveC1zaGFkb3c6IDAgOHB4IDMycHggcmdiYSgwLCAyMTIsIDI1NSwgMC4yKTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTJweCk7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5zZWxlY3RlZCB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGJveC1zaGFkb3c6IDAgMCAwIDNweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjMpOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMjEyLCAyNTUsIDAuMDUpDQogICAgfQ0KLyogTm9kZSBwb3J0cyB3aXRoIG5lb24gZ2xvdyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1wb3J0IHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3gtc2hhZG93OiAwIDAgMTBweCByZ2JhKDAsIDAsIDAsIDAuNSk7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtcG9ydDpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgYm94LXNoYWRvdzogMCAwIDE1cHggcmdiYSgwLCAyMTIsIDI1NSwgMC44KTsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMykNCiAgICB9DQovKiBDb25uZWN0aW9uIGxpbmVzIHdpdGggbmVvbiBlZmZlY3QgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbm5lY3Rpb24tbGluZSB7DQogICAgc3Ryb2tlOiB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIHN0cm9rZS13aWR0aDogMzsNCiAgICBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCAzcHggcmdiYSgwLCAyMTIsIDI1NSwgMC4zKSk7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbm5lY3Rpb24tbGluZTpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29ubmVjdGlvbi1saW5lLmNvbm5lY3RlZCB7DQogICAgc3Ryb2tlOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIHN0cm9rZS13aWR0aDogNDsNCiAgICBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCA4cHggcmdiYSgwLCAyMTIsIDI1NSwgMC44KSkNCiAgICB9DQovKiBUb29sYmFyIHdpdGggZ2xhc3MgZWZmZWN0ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDEwLCAxMCwgMTAsIDAuOSk7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDE1cHgpDQogICAgfQ0KLyogRW5oYW5jZWQgYnV0dG9uIHN0eWxpbmcgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LW5vZGUtYnRuIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LW5vZGUtYnRuOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDIxMiwgMjU1LCAwLjEpOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTFweCk7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTVweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjIpOw0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpDQogICAgfQ0KLyogRmxvdyB0b29sYmFyIGJ1dHRvbnMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDIxMiwgMjU1LCAwLjEpOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTFweCk7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTVweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjIpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuLXN1Y2Nlc3Mgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0bi1zdWNjZXNzOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtaG92ZXIpOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDIwcHggcmdiYSgwLCAyMTIsIDI1NSwgMC40KQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0bi1kYW5nZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4tZGFuZ2VyOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiAjZmYzNzQyOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDIwcHggcmdiYSgyNTUsIDcxLCA4NywgMC40KQ0KICAgIH0NCi8qIE5vZGUgdHlwZSBzdHlsaW5nICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLXR5cGUgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXByaW1hcnktYmcpOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgdGV4dC1zaGFkb3c6IG5vbmU7DQogICAgYm9yZGVyLXJhZGl1czogNnB4DQogICAgfQ0KLyogTm9kZSBkZWxldGUgYnV0dG9uICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubm9kZS1kZWxldGUtYnRuIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgYm9yZGVyOiAycHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDEwcHggcmdiYSgyNTUsIDcxLCA4NywgMC4zKTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm5vZGUtZGVsZXRlLWJ0bjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogI2ZmMzc0MjsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTVweCByZ2JhKDI1NSwgNzEsIDg3LCAwLjUpDQogICAgfQ0KLyogQ3VycmVudCBmaWxlbmFtZSBzdHlsaW5nICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY3VycmVudC1maWxlbmFtZSB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICB0ZXh0LXNoYWRvdzogMCAwIDVweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjMpDQogICAgfQ0KLyogWm9vbSBjb250cm9scyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnpvb20tY29udHJvbHMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgcGFkZGluZzogNHB4Ow0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWxldmVsIHsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIG1pbi13aWR0aDogNDVweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgZm9udC1zaXplOiAxMnB4DQogICAgfQ0KLyogTG9hZGluZyBzdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmxvYWRpbmctbm9kZXMgew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXNlY29uZGFyeSk7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIHBhZGRpbmc6IDIwcHg7DQogICAgZm9udC1zdHlsZTogaXRhbGljDQogICAgfQ0KLyogTm9kZSBjYXRlZ29yaWVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubm9kZS1jYXRlZ29yeSBoNSB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsNCiAgICBsZXR0ZXItc3BhY2luZzogMXB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA3MDA7DQogICAgZm9udC1zaXplOiAxMXB4DQogICAgfQ0KLyogQ2FudmFzIHRhZ3MgYW5kIGNvbmZpZ3VyYXRpb24gbGlzdCB0YWdzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10YWcsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcmVhLXRhZywgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY2FudmFzLXRhZyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50Ow0KICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWJnKSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudDsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgYm94LXNoYWRvdzogMCAycHggMTBweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjMpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10YWc6aG92ZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcmVhLXRhZzpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtOmhvdmVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY2FudmFzLXRhZzpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWhvdmVyKSAhaW1wb3J0YW50Ow0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDE1cHggcmdiYSgwLCAyMTIsIDI1NSwgMC41KTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTFweCkNCiAgICB9DQovKiBUYWcgdGV4dCBhbmQgaWNvbnMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRhZyAudGFnLXRleHQsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcmVhLXRhZyAudGFnLXRleHQsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbSAudGFnLXRleHQsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jYW52YXMtdGFnIC50YWctdGV4dCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdGFnIGksIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcmVhLXRhZyBpLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gaSwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNhbnZhcy10YWcgaSB7DQogICAgY29sb3I6IHZhcigtLXByaW1hcnktYmcpICFpbXBvcnRhbnQNCiAgICB9DQovKiBUYWcgaW5kaWNhdG9yIGNpcmNsZXMvZG90cyBpbiBjb25maWd1cmF0aW9uIGFyZWEgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaW5kaWNhdG9yLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWNvbG9yLWluZGljYXRvciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1jaXJjbGUsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctZG90LCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXJlYS10YWctaW5kaWNhdG9yLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWNvbG9yIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQ7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50DQogICAgfQ0KLyogVGFnIGl0ZW1zIGluIGNvbmZpZ3VyYXRpb24gbGlzdCAtIG1hdGNoIG5vZGUgbGlzdCBzdHlsaW5nICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcikgIWltcG9ydGFudDsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSkgIWltcG9ydGFudA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbTpob3ZlciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAyMTIsIDI1NSwgMC4xKSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50Ow0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRleSgtMXB4KTsNCiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gLnRhZy1uYW1lIHsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KSAhaW1wb3J0YW50DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtIC50YWctaW5mbyB7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSkgIWltcG9ydGFudA0KICAgIH0NCi8qIFRhZyBkZWxldGUgYnV0dG9uIHN0eWxpbmcgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctZGVsZXRlLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gLnRhZy1kZWxldGUgew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpICFpbXBvcnRhbnQ7DQogICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQgIWltcG9ydGFudDsNCiAgICBib3JkZXI6IG5vbmUgIWltcG9ydGFudA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctZGVsZXRlOmhvdmVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gLnRhZy1kZWxldGU6aG92ZXIgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWRlbGV0ZSBpLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gLnRhZy1kZWxldGUgaSB7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSkgIWltcG9ydGFudA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctZGVsZXRlOmhvdmVyIGksIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbSAudGFnLWRlbGV0ZTpob3ZlciBpIHsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50DQogICAgfQ0KLyogQ29uZmlndXJhdGlvbiBhcmVhIGhlYWRlciB0ZXh0ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWhlYWRlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZ3VyYXRpb24taGVhZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25maWctaGVhZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLXBsYWNlaG9sZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlndXJhdGlvbi1wbGFjZWhvbGRlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLWFyZWEgcCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLWFyZWEgLnBsYWNlaG9sZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25maWctYXJlYSAuY29uZmlnLW1lc3NhZ2UsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctYXJlYSBwLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWFyZWEgLnBsYWNlaG9sZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWFyZWEgLmNvbmZpZy1tZXNzYWdlLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25maWd1cmF0aW9uIHAsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbmZpZ3VyYXRpb24gLnBsYWNlaG9sZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGV4dC1tdXRlZCB7DQogICAgY29sb3I6IHZhcigtLXRleHQtc2Vjb25kYXJ5KSAhaW1wb3J0YW50DQogICAgfQ0KLyogUnVubmluZyBzdGF0ZSB3aXRoIHB1bHNpbmcgZWZmZWN0ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLnJ1bm5pbmcgew0KICAgIGFuaW1hdGlvbjogcHVsc2UtbmVvbiAycyBpbmZpbml0ZTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXN1Y2Nlc3MtY29sb3IpDQogICAgfQ0KQGtleWZyYW1lcyBwdWxzZS1uZW9uIHsNCiAgICAwJSwgMTAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCA1cHggcmdiYSg0NiwgMjEzLCAxMTUsIDAuNSk7DQogICAgICAgIH0gNTAlIHsNCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDIwcHggcmdiYSg0NiwgMjEzLCAxMTUsIDAuOCksIDAgMCAzMHB4IHJnYmEoNDYsIDIxMywgMTE1LCAwLjQpOw0KICAgICAgICB9DQogICAgfQ0KLyogRXJyb3Igc3RhdGUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUuZXJyb3Igew0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGFuaW1hdGlvbjogcHVsc2UtZXJyb3ItbmVvbiAxcyBpbmZpbml0ZQ0KICAgIH0NCkBrZXlmcmFtZXMgcHVsc2UtZXJyb3ItbmVvbiB7DQogICAgMCUsIDEwMCUgew0KICAgICAgICBib3gtc2hhZG93OiAwIDAgNXB4IHJnYmEoMjU1LCA3MSwgODcsIDAuNSk7DQogICAgICAgIH0gNTAlIHsNCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDIwcHggcmdiYSgyNTUsIDcxLCA4NywgMC44KSwgMCAwIDMwcHggcmdiYSgyNTUsIDcxLCA4NywgMC40KTsNCiAgICAgICAgfQ0KICAgIH0NCi8qIFJlc3BvbnNpdmUgYWRqdXN0bWVudHMgKi8NCkBtZWRpYSAobWF4LXdpZHRoOiA3NjhweCkgew0KICAgIC5mbG93LXRvb2xib3ggew0KICAgICAgICB3aWR0aDogMjAwcHgNCiAgICAgICAgfQ0KICAgIC5mbG93LW5vZGUgew0KICAgICAgICBtaW4td2lkdGg6IDEyMHB4Ow0KICAgICAgICBmb250LXNpemU6IDEycHgNCiAgICAgICAgfQ0KICAgIC50b29sYm94LW5vZGUtYnRuIHsNCiAgICAgICAgcGFkZGluZzogOHB4IDEwcHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTJweA0KICAgICAgICB9DQogICAgfTwvc3R5bGU+PGRpdiBjbGFzcz0iYXBwLWNvbnRhaW5lciIgZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiPg0KPGRpdiBjbGFzcz0iYXBwLWNvbnRlbnQiPg0KPGRpdiBjbGFzcz0iZmxvdy1lZGl0b3IiPg0KPCEtLSBMZWZ0IFRvb2xib3ggLS0+DQo8ZGl2IGNsYXNzPSJmbG93LXRvb2xib3giIGlkPSJmbG93LXRvb2xib3giPg0KPGRpdiBjbGFzcz0idG9vbGJveC1oZWFkZXIiPg0KPGg0PjxpIGNsYXNzPSJmYXMgZmEtdG9vbHMiPjwvaT4gTm9kZXM8L2g0Pg0KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tb3V0bGluZS1zZWNvbmRhcnkiIGlkPSJ0b2dnbGUtdG9vbGJveCIgdGl0bGU9IkNvbGxhcHNlIFRvb2xib3giPg0KPGkgY2xhc3M9ImZhcyBmYS1jaGV2cm9uLWxlZnQiPjwvaT4NCjwvYnV0dG9uPg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJ0b29sYm94LWNvbnRlbnQiIGlkPSJ0b29sYm94LWNvbnRlbnQiPg0KPCEtLSBOb2RlcyB3aWxsIGJlIGxvYWRlZCBkeW5hbWljYWxseSBmcm9tIFZGUyAtLT4NCjxkaXYgY2xhc3M9ImxvYWRpbmctbm9kZXMiPg0KPHAgY2xhc3M9InRleHQtbXV0ZWQiPkxvYWRpbmcgbm9kZXMuLi48L3A+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQo8IS0tIE1haW4gd29ya3NwYWNlIC0tPg0KPGRpdiBjbGFzcz0iZmxvdy13b3Jrc3BhY2UiPg0KPCEtLSBUb29sYmFyIC0tPg0KPGRpdiBjbGFzcz0iZmxvdy10b29sYmFyIj4NCjxkaXYgY2xhc3M9InRvb2xiYXItbGVmdCI+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXN1Y2Nlc3MiIGlkPSJydW4td29ya2Zsb3ciPg0KPGkgY2xhc3M9ImZhcyBmYS1wbGF5Ij48L2k+IDxzcGFuIGNsYXNzPSJidG4tdGV4dCI+UnVuIFdvcmtmbG93PC9zcGFuPg0KPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLWRhbmdlciIgaWQ9InN0b3Atd29ya2Zsb3ciIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQo8aSBjbGFzcz0iZmFzIGZhLXN0b3AiPjwvaT4gPHNwYW4gY2xhc3M9ImJ0bi10ZXh0Ij5TdG9wPC9zcGFuPg0KPC9idXR0b24+DQo8ZGl2IGNsYXNzPSJjdXJyZW50LWZpbGUtaW5mbyI+DQo8c3BhbiBjbGFzcz0iY3VycmVudC1maWxlbmFtZSIgaWQ9ImN1cnJlbnQtZmlsZW5hbWUiPnVudGl0bGVkLmZsb3c8L3NwYW4+DQo8L2Rpdj4NCjwvZGl2Pg0KPGRpdiBjbGFzcz0idG9vbGJhci1yaWdodCI+DQo8IS0tIFpvb20gY29udHJvbHMgc3RheSB2aXNpYmxlIC0tPg0KPGRpdiBjbGFzcz0iem9vbS1jb250cm9scyI+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiBpZD0iem9vbS1vdXQiIHRpdGxlPSJab29tIE91dCI+DQo8aSBjbGFzcz0iZmFzIGZhLXNlYXJjaC1taW51cyI+PC9pPg0KPC9idXR0b24+DQo8c3BhbiBjbGFzcz0iem9vbS1sZXZlbCIgaWQ9Inpvb20tbGV2ZWwiPjEwMCU8L3NwYW4+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiBpZD0iem9vbS1pbiIgdGl0bGU9Ilpvb20gSW4iPg0KPGkgY2xhc3M9ImZhcyBmYS1zZWFyY2gtcGx1cyI+PC9pPg0KPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiBpZD0iem9vbS1maXQiIHRpdGxlPSJab29tIHRvIEZpdCI+DQo8aSBjbGFzcz0iZmFzIGZhLWV4cGFuZC1hcnJvd3MtYWx0Ij48L2k+DQo8L2J1dHRvbj4NCjwvZGl2Pg0KPCEtLSBIYW1idXJnZXIgTWVudSBCdXR0b24gLS0+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IGhhbWJ1cmdlci1idG4iIGlkPSJoYW1idXJnZXItbWVudSIgdGl0bGU9Ik1lbnUiPg0KPGkgY2xhc3M9ImZhcyBmYS1iYXJzIj48L2k+DQo8L2J1dHRvbj4NCjwvZGl2Pg0KPC9kaXY+DQo8IS0tIERyb3Bkb3duIE1lbnUgLSBPbmx5IGZpbGUgb3BlcmF0aW9ucyBhbmQgZGVsZXRlL2NsZWFyIGFjdGlvbnMgLS0+DQo8ZGl2IGNsYXNzPSJkcm9wZG93bi1tZW51IiBpZD0iZHJvcGRvd24tbWVudSI+DQo8ZGl2IGNsYXNzPSJtZW51LXNlY3Rpb24iPg0KPGRpdiBjbGFzcz0ibWVudS1zZWN0aW9uLXRpdGxlIj5GaWxlIEFjdGlvbnM8L2Rpdj4NCjxidXR0b24gY2xhc3M9Im1lbnUtaXRlbSIgZGF0YS1hY3Rpb249InNhdmUtZmxvdyI+DQo8aSBjbGFzcz0iZmFzIGZhLXNhdmUiPjwvaT4gU2F2ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0iIGRhdGEtYWN0aW9uPSJzYXZlLWZsb3ctYXMiPg0KPGkgY2xhc3M9ImZhcyBmYS1zYXZlIj48L2k+IFNhdmUgQXMNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIiBkYXRhLWFjdGlvbj0ibG9hZC1mbG93Ij4NCjxpIGNsYXNzPSJmYXMgZmEtZm9sZGVyLW9wZW4iPjwvaT4gTG9hZA0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQo8L2Rpdj4NCjxkaXYgY2xhc3M9Im1lbnUtc2VjdGlvbiI+DQo8ZGl2IGNsYXNzPSJtZW51LXNlY3Rpb24tdGl0bGUiPlZpZXcgQWN0aW9uczwvZGl2Pg0KPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIiBkYXRhLWFjdGlvbj0iYWRkLXRhZyI+DQo8aSBjbGFzcz0iZmFzIGZhLXRhZyI+PC9pPiBBZGQgVGFnDQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCjxidXR0b24gY2xhc3M9Im1lbnUtaXRlbSIgZGF0YS1hY3Rpb249InJlc2V0LXZpZXciPg0KPGkgY2xhc3M9ImZhcyBmYS1jcm9zc2hhaXJzIj48L2k+IFJlc2V0IFZpZXcNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJtZW51LXNlY3Rpb24iPg0KPGRpdiBjbGFzcz0ibWVudS1zZWN0aW9uLXRpdGxlIj5FZGl0IEFjdGlvbnM8L2Rpdj4NCjxidXR0b24gY2xhc3M9Im1lbnUtaXRlbSBkYW5nZXIiIGRhdGEtYWN0aW9uPSJkZWxldGUtc2VsZWN0ZWQiPg0KPGkgY2xhc3M9ImZhcyBmYS10cmFzaCI+PC9pPiBEZWxldGUgU2VsZWN0ZWQNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIGRhbmdlciIgZGF0YS1hY3Rpb249ImNsZWFyLWNhbnZhcyI+DQo8aSBjbGFzcz0iZmFzIGZhLXRyYXNoLWFsdCI+PC9pPiBDbGVhciBBbGwNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPC9kaXY+DQo8L2Rpdj4NCjwhLS0gTWFpbiBjYW52YXMgYXJlYSAtLT4NCjxkaXYgY2xhc3M9ImZsb3ctY2FudmFzLWNvbnRhaW5lciI+DQo8ZGl2IGNsYXNzPSJmbG93LWNhbnZhcyIgaWQ9ImZsb3ctY2FudmFzIj4NCjwhLS0gTm9kZXMgd2lsbCBiZSBhZGRlZCBoZXJlIGR5bmFtaWNhbGx5IC0tPg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KPCEtLSBDb25maWd1cmF0aW9uIHBhbmVsIC0tPg0KPGRpdiBjbGFzcz0iZmxvdy1jb25maWctcGFuZWwiIGlkPSJmbG93LWNvbmZpZy1wYW5lbCI+DQo8ZGl2IGNsYXNzPSJjb25maWctaGVhZGVyIj4NCjxoND48aSBjbGFzcz0iZmFzIGZhLWNvZyI+PC9pPiBDb25maWd1cmF0aW9uPC9oND4NCjxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiBpZD0idG9nZ2xlLWNvbmZpZyIgdGl0bGU9IkNvbGxhcHNlIENvbmZpZ3VyYXRpb24gUGFuZWwiPg0KPGkgY2xhc3M9ImZhcyBmYS1jaGV2cm9uLXJpZ2h0Ij48L2k+DQo8L2J1dHRvbj4NCjwvZGl2Pg0KPGRpdiBjbGFzcz0iY29uZmlnLWNvbnRlbnQiIGlkPSJjb25maWctY29udGVudCI+DQo8ZGl2IGlkPSJub2RlLWNvbmZpZyI+DQo8cCBjbGFzcz0idGV4dC1tdXRlZCI+U2VsZWN0IGEgbm9kZSB0byBjb25maWd1cmUgaXQ8L3A+DQo8L2Rpdj4NCjxkaXYgaWQ9InRhZy1wYW5lbCI+DQo8aDU+PGkgY2xhc3M9ImZhcyBmYS10YWdzIj48L2k+IEFyZWEgVGFnczwvaDU+DQo8cCBjbGFzcz0idGV4dC1tdXRlZCI+Tm8gdGFncyB5ZXQ8L3A+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCjwhLS0gT3V0cHV0IHBhbmVsIC0tPg0KPGRpdiBjbGFzcz0iZmxvdy1vdXRwdXQtcGFuZWwgY29sbGFwc2VkIiBpZD0iZmxvdy1vdXRwdXQtcGFuZWwiPg0KPGRpdiBjbGFzcz0ib3V0cHV0LWhlYWRlciI+DQo8aDQ+PGkgY2xhc3M9ImZhcyBmYS10ZXJtaW5hbCI+PC9pPiBFeGVjdXRpb24gT3V0cHV0PC9oND4NCjxkaXYgY2xhc3M9Im91dHB1dC1jb250cm9scyI+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSIgaWQ9InRvZ2dsZS1vdXRwdXQiIHRpdGxlPSJTaG93L0hpZGUgT3V0cHV0Ij4NCjxpIGNsYXNzPSJmYXMgZmEtY2hldnJvbi1kb3duIj48L2k+DQo8L2J1dHRvbj4NCjxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiBpZD0iY2xlYXItb3V0cHV0Ij4NCjxpIGNsYXNzPSJmYXMgZmEtdHJhc2giPjwvaT4gQ2xlYXINCiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQo8L2Rpdj4NCjwvZGl2Pg0KPGRpdiBjbGFzcz0ib3V0cHV0LWNvbnRlbnQiIGlkPSJvdXRwdXQtY29udGVudCIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4NCjxkaXYgY2xhc3M9ImV4ZWN1dGlvbi1vdXRwdXQiIGlkPSJleGVjdXRpb24tb3V0cHV0Ij4NCjxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5Xb3JrZmxvdyBvdXRwdXQgd2lsbCBhcHBlYXIgaGVyZTwvcD4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQoNCjxzY3JpcHQ+Ly8gPT09PT0gU2NyaXB0OiBqcy91dGlscy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvbm9kZS1yZWdpc3RyeS5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvY2FudmFzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9ub2RlLWNvbmZpZy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvbm9kZS1yZW5kZXJlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvZGF0YS1leGVjdXRvcnMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2h0dHAtZXhlY3V0b3JzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9tZWRpYS1leGVjdXRvcnMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2Zsb3ctZXhlY3V0b3JzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9haS1leGVjdXRvcnMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2V4ZWN1dGlvbi1lbmdpbmUuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL3dvcmtmbG93LmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9jYW52YXMtbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvdGFnLW1hbmFnZXIuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2ZpbGUtbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvdWktbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvbWFpbi5qcyA9PT09PQ0KDQoNCi8vIHV0aWxzLmpzIC0gVXRpbGl0eSBmdW5jdGlvbnMgZm9yIEZsb3cgRWRpdG9yDQoNCi8vIENhbnZhcy1zcGVjaWZpYyBjb29yZGluYXRlIHRyYW5zZm9ybWF0aW9uIHV0aWxpdGllcw0KLy8gKEFwcCBzY2FsaW5nIHV0aWxpdGllcyBhcmUgbm93IGNlbnRyYWxpemVkIGluIHN5cG5leEFQSS5zY2FsaW5nKQ0KDQovLyBVdGlsaXR5IGZ1bmN0aW9uIHRvIGVzY2FwZSBIVE1MDQpmdW5jdGlvbiBlc2NhcGVIdG1sKHRleHQpIHsNCiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBkaXYudGV4dENvbnRlbnQgPSB0ZXh0Ow0KICAgIHJldHVybiBkaXYuaW5uZXJIVE1MOw0KfQ0KDQovLyBVdGlsaXR5IGZ1bmN0aW9uIHRvIGZvcm1hdCBmaWxlIHNpemUNCmZ1bmN0aW9uIGZvcm1hdEZpbGVTaXplKGJ5dGVzKSB7DQogICAgaWYgKGJ5dGVzID09PSAwKSByZXR1cm4gJzAgQnl0ZXMnOw0KICAgIGNvbnN0IGsgPSAxMDI0Ow0KICAgIGNvbnN0IHNpemVzID0gWydCeXRlcycsICdLQicsICdNQicsICdHQiddOw0KICAgIGNvbnN0IGkgPSBNYXRoLmZsb29yKE1hdGgubG9nKGJ5dGVzKSAvIE1hdGgubG9nKGspKTsNCiAgICByZXR1cm4gcGFyc2VGbG9hdCgoYnl0ZXMgLyBNYXRoLnBvdyhrLCBpKSkudG9GaXhlZCgyKSkgKyAnICcgKyBzaXplc1tpXTsNCn0NCg0KLy8gVXRpbGl0eSBmdW5jdGlvbiB0byBkZWJvdW5jZSBmdW5jdGlvbiBjYWxscw0KZnVuY3Rpb24gZGVib3VuY2UoZnVuYywgd2FpdCkgew0KICAgIGxldCB0aW1lb3V0Ow0KICAgIHJldHVybiBmdW5jdGlvbiBleGVjdXRlZEZ1bmN0aW9uKC4uLmFyZ3MpIHsNCiAgICAgICAgY29uc3QgbGF0ZXIgPSAoKSA9PiB7DQogICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7DQogICAgICAgICAgICBmdW5jKC4uLmFyZ3MpOw0KICAgICAgICB9Ow0KICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7DQogICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTsNCiAgICB9Ow0KfQ0KDQoNCi8vIEhlbHBlciBtZXRob2QgZm9yIHRlbXBsYXRlIHByb2Nlc3NpbmcNCmZ1bmN0aW9uIHByb2Nlc3NUZW1wbGF0ZXModGVtcGxhdGUsIGRhdGEpIHsNCiAgICBsZXQgcmVzdWx0ID0gdGVtcGxhdGU7DQogICAgaWYgKHR5cGVvZiBkYXRhID09PSAnb2JqZWN0JyAmJiBkYXRhICE9PSBudWxsKSB7DQogICAgICAgIC8vIENoZWNrIGlmIGRhdGEuZGF0YSBpcyBhIEpTT04gc3RyaW5nIGFuZCB0cnkgdG8gcGFyc2UgaXQNCiAgICAgICAgbGV0IHRlbXBsYXRlRGF0YSA9IGRhdGE7DQogICAgICAgIGlmIChkYXRhLmRhdGEgJiYgdHlwZW9mIGRhdGEuZGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkRGF0YSA9IEpTT04ucGFyc2UoZGF0YS5kYXRhKTsNCiAgICAgICAgICAgICAgICAvLyBNZXJnZSB0aGUgcGFyc2VkIEpTT04gd2l0aCB0aGUgb3JpZ2luYWwgZGF0YSBvYmplY3QNCiAgICAgICAgICAgICAgICB0ZW1wbGF0ZURhdGEgPSB7IC4uLmRhdGEsIC4uLnBhcnNlZERhdGEgfTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAvLyBJZiBwYXJzaW5nIGZhaWxzLCBqdXN0IHVzZSB0aGUgb3JpZ2luYWwgZGF0YQ0KICAgICAgICAgICAgICAgIHRlbXBsYXRlRGF0YSA9IGRhdGE7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEZpbmQgYWxsIHRlbXBsYXRlIHBhdHRlcm5zIGxpa2Uge3trZXl9fSBvciB7e3BhdGgudG8udmFsdWV9fQ0KICAgICAgICBjb25zdCB0ZW1wbGF0ZVBhdHRlcm4gPSAvXHtceyhbXn1dKylcfVx9L2c7DQogICAgICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKHRlbXBsYXRlUGF0dGVybiwgKG1hdGNoLCBwYXRoKSA9PiB7DQogICAgICAgICAgICAvLyBUcnkgdG8gZ2V0IG5lc3RlZCB2YWx1ZSB1c2luZyBkb3Qgbm90YXRpb24NCiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZXh0cmFjdE5lc3RlZFZhbHVlKHRlbXBsYXRlRGF0YSwgcGF0aCk7DQogICAgICAgICAgICAvLyBSZXR1cm4gdGhlIHZhbHVlIGlmIGZvdW5kLCBvdGhlcndpc2Uga2VlcCB0aGUgb3JpZ2luYWwgdGVtcGxhdGUNCiAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiBtYXRjaDsNCiAgICAgICAgfSk7DQogICAgfQ0KICAgIHJldHVybiByZXN1bHQ7DQp9DQoNCi8vIEhlbHBlciBtZXRob2QgZm9yIGV4dHJhY3RpbmcgbmVzdGVkIEpTT04gdmFsdWVzDQpmdW5jdGlvbiBleHRyYWN0TmVzdGVkVmFsdWUob2JqLCBwYXRoKSB7DQogICAgY29uc3Qga2V5cyA9IHBhdGguc3BsaXQoJy4nKTsNCiAgICBsZXQgY3VycmVudCA9IG9iajsNCg0KICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHsNCiAgICAgICAgaWYgKGN1cnJlbnQgPT09IG51bGwgfHwgY3VycmVudCA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEhhbmRsZSBhcnJheSBhY2Nlc3MgbGlrZSAiaXRlbXNbMF0ubmFtZSINCiAgICAgICAgY29uc3QgYXJyYXlNYXRjaCA9IGtleS5tYXRjaCgvXiguKylcWyhcZCspXF0kLyk7DQogICAgICAgIGlmIChhcnJheU1hdGNoKSB7DQogICAgICAgICAgICBjb25zdCBhcnJheUtleSA9IGFycmF5TWF0Y2hbMV07DQogICAgICAgICAgICBjb25zdCBhcnJheUluZGV4ID0gcGFyc2VJbnQoYXJyYXlNYXRjaFsyXSk7DQoNCiAgICAgICAgICAgIGlmIChjdXJyZW50W2FycmF5S2V5XSAmJiBBcnJheS5pc0FycmF5KGN1cnJlbnRbYXJyYXlLZXldKSkgew0KICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50W2FycmF5S2V5XVthcnJheUluZGV4XTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFtrZXldOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcmV0dXJuIGN1cnJlbnQ7DQp9DQoNCi8vIEhlbHBlciBtZXRob2QgdG8gZGV0ZWN0IGltYWdlIHR5cGUgZnJvbSBiYXNlNjQgZGF0YQ0KZnVuY3Rpb24gZGV0ZWN0SW1hZ2VUeXBlRnJvbUJhc2U2NChiYXNlNjREYXRhKSB7DQogICAgLy8gQ2hlY2sgdGhlIGZpcnN0IGZldyBieXRlcyB0byBkZXRlcm1pbmUgaW1hZ2UgdHlwZQ0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IGJpbmFyeVN0cmluZyA9IGF0b2IoYmFzZTY0RGF0YSk7DQogICAgICAgIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYmluYXJ5U3RyaW5nLmxlbmd0aCk7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmluYXJ5U3RyaW5nLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBieXRlc1tpXSA9IGJpbmFyeVN0cmluZy5jaGFyQ29kZUF0KGkpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQ2hlY2sgZmlsZSBzaWduYXR1cmVzDQogICAgICAgIGlmIChieXRlc1swXSA9PT0gMHhGRiAmJiBieXRlc1sxXSA9PT0gMHhEOCAmJiBieXRlc1syXSA9PT0gMHhGRikgew0KICAgICAgICAgICAgcmV0dXJuICdpbWFnZS9qcGVnJzsNCiAgICAgICAgfSBlbHNlIGlmIChieXRlc1swXSA9PT0gMHg4OSAmJiBieXRlc1sxXSA9PT0gMHg1MCAmJiBieXRlc1syXSA9PT0gMHg0RSAmJiBieXRlc1szXSA9PT0gMHg0Nykgew0KICAgICAgICAgICAgcmV0dXJuICdpbWFnZS9wbmcnOw0KICAgICAgICB9IGVsc2UgaWYgKGJ5dGVzWzBdID09PSAweDQ3ICYmIGJ5dGVzWzFdID09PSAweDQ5ICYmIGJ5dGVzWzJdID09PSAweDQ2KSB7DQogICAgICAgICAgICByZXR1cm4gJ2ltYWdlL2dpZic7DQogICAgICAgIH0gZWxzZSBpZiAoYnl0ZXNbMF0gPT09IDB4NTIgJiYgYnl0ZXNbMV0gPT09IDB4NDkgJiYgYnl0ZXNbMl0gPT09IDB4NDYgJiYgYnl0ZXNbM10gPT09IDB4NDYpIHsNCiAgICAgICAgICAgIHJldHVybiAnaW1hZ2Uvd2VicCc7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBEZWZhdWx0IHRvIFBORyBpZiB3ZSBjYW4ndCBkZXRlcm1pbmUNCiAgICAgICAgICAgIHJldHVybiAnaW1hZ2UvcG5nJzsNCiAgICAgICAgfQ0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgLy8gRGVmYXVsdCB0byBQTkcgaWYgdGhlcmUncyBhbiBlcnJvcg0KICAgICAgICByZXR1cm4gJ2ltYWdlL3BuZyc7DQogICAgfQ0KfQ0KDQovLyBDb252ZXJ0IHZpZXdwb3J0IGNvb3JkaW5hdGVzIHRvIGNhbnZhcyBjb29yZGluYXRlcyAoYWNjb3VudGluZyBmb3IgcGFuIGFuZCB6b29tKQ0KZnVuY3Rpb24gdmlld3BvcnRUb0NhbnZhc0Nvb3Jkcyh2aWV3cG9ydFgsIHZpZXdwb3J0WSkgew0KICAgIGlmICh0eXBlb2YgZmxvd0VkaXRvciA9PT0gJ3VuZGVmaW5lZCcpIHsNCiAgICAgICAgcmV0dXJuIHsgeDogdmlld3BvcnRYLCB5OiB2aWV3cG9ydFkgfTsNCiAgICB9DQogICAgDQogICAgcmV0dXJuIHsNCiAgICAgICAgeDogKHZpZXdwb3J0WCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWwsDQogICAgICAgIHk6ICh2aWV3cG9ydFkgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsDQogICAgfTsNCn0NCg0KLy8gQ29udmVydCBjYW52YXMgY29vcmRpbmF0ZXMgdG8gdmlld3BvcnQgY29vcmRpbmF0ZXMgKGFjY291bnRpbmcgZm9yIHBhbiBhbmQgem9vbSkNCmZ1bmN0aW9uIGNhbnZhc1RvVmlld3BvcnRDb29yZHMoY2FudmFzWCwgY2FudmFzWSkgew0KICAgIGlmICh0eXBlb2YgZmxvd0VkaXRvciA9PT0gJ3VuZGVmaW5lZCcpIHsNCiAgICAgICAgcmV0dXJuIHsgeDogY2FudmFzWCwgeTogY2FudmFzWSB9Ow0KICAgIH0NCiAgICANCiAgICByZXR1cm4gew0KICAgICAgICB4OiAoY2FudmFzWCAqIGZsb3dFZGl0b3Iuem9vbUxldmVsKSArIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngsDQogICAgICAgIHk6IChjYW52YXNZICogZmxvd0VkaXRvci56b29tTGV2ZWwpICsgZmxvd0VkaXRvci5wYW5PZmZzZXQueQ0KICAgIH07DQp9DQoNCi8vIEdldCB0aGUgY2VudGVyIG9mIHRoZSBjdXJyZW50IHZpZXdwb3J0IGluIGNhbnZhcyBjb29yZGluYXRlcw0KZnVuY3Rpb24gZ2V0Vmlld3BvcnRDZW50ZXJJbkNhbnZhcygpIHsNCiAgICBpZiAodHlwZW9mIGZsb3dFZGl0b3IgPT09ICd1bmRlZmluZWQnIHx8ICFmbG93RWRpdG9yLmNhbnZhcykgew0KICAgICAgICByZXR1cm4geyB4OiAwLCB5OiAwIH07DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgaWYgKCFjb250YWluZXIpIHsNCiAgICAgICAgcmV0dXJuIHsgeDogMCwgeTogMCB9Ow0KICAgIH0NCiAgICANCiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOw0KICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICANCiAgICByZXR1cm4gdmlld3BvcnRUb0NhbnZhc0Nvb3Jkcyh2aWV3cG9ydENlbnRlclgsIHZpZXdwb3J0Q2VudGVyWSk7DQp9DQoNCi8vIENlbnRlciB0aGUgdmlld3BvcnQgb24gc3BlY2lmaWMgY2FudmFzIGNvb3JkaW5hdGVzDQpmdW5jdGlvbiBjZW50ZXJWaWV3cG9ydE9uQ2FudmFzKGNhbnZhc1gsIGNhbnZhc1kpIHsNCiAgICBpZiAodHlwZW9mIGZsb3dFZGl0b3IgPT09ICd1bmRlZmluZWQnIHx8ICFmbG93RWRpdG9yLmNhbnZhcykgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgaWYgKCFjb250YWluZXIpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOw0KICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICANCiAgICAvLyBDYWxjdWxhdGUgcGFuIG9mZnNldCB0byBjZW50ZXIgdGhlIHNwZWNpZmllZCBjYW52YXMgY29vcmRpbmF0ZXMgaW4gdGhlIHZpZXdwb3J0DQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IHZpZXdwb3J0Q2VudGVyWCAtIChjYW52YXNYICogZmxvd0VkaXRvci56b29tTGV2ZWwpOw0KICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSB2aWV3cG9ydENlbnRlclkgLSAoY2FudmFzWSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsKTsNCiAgICANCiAgICAvLyBVcGRhdGUgdGhlIHRyYW5zZm9ybQ0KICAgIGlmIChzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlciAmJiBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0pIHsNCiAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgfQ0KfQ0KDQovLyBFeHBvcnQgdXRpbGl0aWVzIGZvciB1c2UgaW4gb3RoZXIgbW9kdWxlcw0KLy8gQ2FudmFzLXNwZWNpZmljIHV0aWxpdGllcyBvbmx5IC0gc2NhbGluZyB1dGlsaXRpZXMgYXJlIG5vdyBpbiBzeXBuZXhBUEkuc2NhbGluZw0Kc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JVdGlscyA9IHsNCiAgICAvLyBDYW52YXMtc3BlY2lmaWMgY29vcmRpbmF0ZSB0cmFuc2Zvcm1hdGlvbnMNCiAgICB2aWV3cG9ydFRvQ2FudmFzQ29vcmRzLA0KICAgIGNhbnZhc1RvVmlld3BvcnRDb29yZHMsDQogICAgZ2V0Vmlld3BvcnRDZW50ZXJJbkNhbnZhcywNCiAgICBjZW50ZXJWaWV3cG9ydE9uQ2FudmFzLA0KICAgIA0KICAgIC8vIEdlbmVyYWwgdXRpbGl0aWVzDQogICAgZXNjYXBlSHRtbCwNCiAgICBmb3JtYXRGaWxlU2l6ZSwNCiAgICBkZWJvdW5jZSwNCiAgICBwcm9jZXNzVGVtcGxhdGVzLA0KICAgIGV4dHJhY3ROZXN0ZWRWYWx1ZSwNCiAgICBkZXRlY3RJbWFnZVR5cGVGcm9tQmFzZTY0DQp9Ow0KDQovLyBSZXBsYWNlIHRlbXBsYXRlIHBsYWNlaG9sZGVycyBpbiBKU09OIGJvZHkNCmZ1bmN0aW9uIHJlcGxhY2VUZW1wbGF0ZVBsYWNlaG9sZGVycyhib2R5LCB0ZW1wbGF0ZURhdGEpIHsNCg0KICAgIGlmICghYm9keSkgew0KICAgICAgICByZXR1cm4gYm9keTsNCiAgICB9DQoNCiAgICAvLyBIYW5kbGUgYm90aCBzdHJpbmcgYW5kIG9iamVjdCBpbnB1dHMNCiAgICBsZXQgYm9keVN0cmluZzsNCiAgICBsZXQgaXNKc29uU3RyaW5nID0gZmFsc2U7DQoNCiAgICBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7DQogICAgICAgIGJvZHlTdHJpbmcgPSBib2R5Ow0KICAgICAgICAvLyBDaGVjayBpZiBpdCdzIGFscmVhZHkgYSBKU09OIHN0cmluZw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgSlNPTi5wYXJzZShib2R5KTsNCiAgICAgICAgICAgIGlzSnNvblN0cmluZyA9IHRydWU7DQogICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgIC8vIE5vdCBhIEpTT04gc3RyaW5nLCB0cmVhdCBhcyByZWd1bGFyIHN0cmluZw0KICAgICAgICB9DQogICAgfSBlbHNlIGlmICh0eXBlb2YgYm9keSA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgYm9keVN0cmluZyA9IEpTT04uc3RyaW5naWZ5KGJvZHkpOw0KICAgICAgICBpc0pzb25TdHJpbmcgPSB0cnVlOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBib2R5Ow0KICAgIH0NCg0KDQogICAgLy8gUmVwbGFjZSBwbGFjZWhvbGRlcnMgd2l0aCB0ZW1wbGF0ZSBkYXRhDQogICAgaWYgKHRlbXBsYXRlRGF0YSAhPT0gdW5kZWZpbmVkICYmIHRlbXBsYXRlRGF0YSAhPT0gbnVsbCkgew0KICAgICAgICBjb25zdCBiZWZvcmVSZXBsYWNlID0gYm9keVN0cmluZzsNCg0KDQogICAgICAgIC8vIFNpbXBsZSBKU09OIGZpZWxkIHJlcGxhY2VtZW50IC0ganVzdCB7e2ZpZWxkfX0gb3Ige3tuZXN0ZWQuZmllbGR9fQ0KICAgICAgICBpZiAodHlwZW9mIHRlbXBsYXRlRGF0YSA9PT0gJ29iamVjdCcpIHsNCg0KICAgICAgICAgICAgLy8gVXNlIGEgc2ltcGxlciwgbW9yZSBleHBsaWNpdCByZWdleA0KICAgICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXJSZWdleCA9IC9ce1x7KFtefV0rKVx9XH0vZzsNCg0KICAgICAgICAgICAgLy8gVGVzdCBpZiB0aGUgcmVnZXggZmluZHMgYW55dGhpbmcNCiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBib2R5U3RyaW5nLm1hdGNoKHBsYWNlaG9sZGVyUmVnZXgpOw0KDQogICAgICAgICAgICBib2R5U3RyaW5nID0gYm9keVN0cmluZy5yZXBsYWNlKHBsYWNlaG9sZGVyUmVnZXgsIChtYXRjaCwgZmllbGRQYXRoKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBnZXROZXN0ZWRWYWx1ZSh0ZW1wbGF0ZURhdGEsIGZpZWxkUGF0aCk7DQogICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgbGV0IHJlcGxhY2VtZW50Ow0KICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWx3YXlzIGVzY2FwZSB0aGUgc3RyaW5nIHByb3Blcmx5IGZvciBKU09OIGNvbnRleHQNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50ID0gdmFsdWUucmVwbGFjZSgvXFwvZywgJ1xcXFwnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC8iL2csICdcXCInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cbi9nLCAnXFxuJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXHIvZywgJ1xccicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1x0L2csICdcXHQnKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBub24tc3RyaW5ncywgY29udmVydCB0byBKU09OIHN0cmluZw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnQgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcGxhY2VtZW50Ow0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXRjaDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdGVtcGxhdGVEYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgLy8gRm9yIHN0cmluZ3MsIGp1c3QgcmVwbGFjZSB7e1ZBTFVFfX0gYXMgYSBmYWxsYmFjaw0KICAgICAgICAgICAgYm9keVN0cmluZyA9IGJvZHlTdHJpbmcucmVwbGFjZSgve3tWQUxVRX19L2csIEpTT04uc3RyaW5naWZ5KHRlbXBsYXRlRGF0YSkpOw0KICAgICAgICB9DQoNCiAgICB9IGVsc2Ugew0KICAgIH0NCg0KICAgIGlmICh0eXBlb2YgYm9keSA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKGJvZHlTdHJpbmcpOw0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIHRlbXBsYXRlLXJlcGxhY2VkIGJvZHk6JywgZXJyb3IpOw0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignQm9keSBzdHJpbmcgd2FzOicsIGJvZHlTdHJpbmcpOw0KICAgICAgICAgICAgcmV0dXJuIGJvZHk7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gYm9keVN0cmluZzsNCiAgICB9DQp9DQoNCi8vIEdldCBuZXN0ZWQgdmFsdWUgZnJvbSBvYmplY3QgdXNpbmcgZG90IG5vdGF0aW9uDQpmdW5jdGlvbiBnZXROZXN0ZWRWYWx1ZShvYmosIHBhdGgpIHsNCiAgICBjb25zdCByZXN1bHQgPSBwYXRoLnNwbGl0KCcuJykucmVkdWNlKChjdXJyZW50LCBrZXkpID0+IHsNCiAgICAgICAgY29uc3QgdmFsdWUgPSBjdXJyZW50ICYmIGN1cnJlbnRba2V5XSAhPT0gdW5kZWZpbmVkID8gY3VycmVudFtrZXldIDogdW5kZWZpbmVkOw0KICAgICAgICByZXR1cm4gdmFsdWU7DQogICAgfSwgb2JqKTsNCiAgICByZXR1cm4gcmVzdWx0Ow0KfQ0KDQoNCi8vIFVwZGF0ZSBKU09OIGV4dHJhY3Qgbm9kZSBkaXNwbGF5DQpmdW5jdGlvbiB1cGRhdGVKc29uRXh0cmFjdERpc3BsYXkobm9kZUlkLCBsYWJlbCwgdmFsdWUsIHN0YXR1cyA9ICdub3JtYWwnKSB7DQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICBjb25zdCBjb250ZW50RWxlbWVudCA9IG5vZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mbG93LW5vZGUtY29udGVudCcpOw0KICAgICAgICBpZiAoY29udGVudEVsZW1lbnQpIHsNCiAgICAgICAgICAgIGNvbnN0IHN0YXR1c0NsYXNzID0gc3RhdHVzID09PSAnZXJyb3InID8gJ3RleHQtZGFuZ2VyJyA6IHN0YXR1cyA9PT0gJ3N1Y2Nlc3MnID8gJ3RleHQtc3VjY2VzcycgOiAndGV4dC1tdXRlZCc7DQoNCiAgICAgICAgICAgIC8vIFNob3cganVzdCBhIHN0YXR1cyBvbiB0aGUgbm9kZSwgZnVsbCBjb250ZW50IHdpbGwgYmUgaW4gY29uZmlnIHBhbmVsDQogICAgICAgICAgICBjb25zdCB0cnVuY2F0ZWRWYWx1ZSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUubGVuZ3RoID4gNTAgPw0KICAgICAgICAgICAgICAgIHZhbHVlLnN1YnN0cmluZygwLCA1MCkgKyAnLi4uJyA6IHZhbHVlOw0KDQogICAgICAgICAgICBjb250ZW50RWxlbWVudC5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibm9kZS1zdGF0dXMiPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0dXMtdGV4dCI+VmFsdWUgZXh0cmFjdGVkPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXR1cy1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD4ke2xhYmVsfTogJHtlc2NhcGVIdG1sKFN0cmluZyh0cnVuY2F0ZWRWYWx1ZSkpfTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gQWRkIGV4ZWN1dGlvbiBsb2cgZW50cnkNCmZ1bmN0aW9uIGFkZEV4ZWN1dGlvbkxvZyhtZXNzYWdlLCB0eXBlID0gJ2luZm8nKSB7DQogICAgY29uc3Qgb3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4ZWN1dGlvbi1vdXRwdXQnKTsNCiAgICBpZiAob3V0cHV0KSB7DQogICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCk7DQogICAgICAgIG91dHB1dC5pbm5lckhUTUwgKz0gYDxkaXYgY2xhc3M9ImxvZy1lbnRyeSAke3R5cGV9Ij5bJHt0aW1lc3RhbXB9XSAke21lc3NhZ2V9PC9kaXY+YDsNCiAgICAgICAgb3V0cHV0LnNjcm9sbFRvcCA9IG91dHB1dC5zY3JvbGxIZWlnaHQ7DQogICAgfQ0KfQ0KDQovLyBDbGVhciBleGVjdXRpb24gb3V0cHV0DQpmdW5jdGlvbiBjbGVhck91dHB1dCgpIHsNCiAgICBjb25zdCBvdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhlY3V0aW9uLW91dHB1dCcpOw0KICAgIGlmIChvdXRwdXQpIHsNCiAgICAgICAgb3V0cHV0LmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPSJsb2ctZW50cnkgaW5mbyI+T3V0cHV0IGNsZWFyZWQ8L2Rpdj4nOw0KICAgIH0NCn0NCg0KDQovLyBJbnRlcmFjdGl2ZSBoZWxwZXIgZnVuY3Rpb25zIGZvciBzcGVjaWFsIG5vZGUgdHlwZXMNCg0KLy8gQXVkaW8gY29udHJvbCBmdW5jdGlvbnMNCmZ1bmN0aW9uIHBsYXlBdWRpbyhub2RlSWQpIHsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUgfHwgIW5vZGUubGFzdEF1ZGlvVXJsKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIGF1ZGlvIGRhdGEgYXZhaWxhYmxlIGZvciBub2RlOicsIG5vZGVJZCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBDcmVhdGUgb3IgcmV1c2UgYXVkaW8gZWxlbWVudA0KICAgIGlmICghbm9kZS5hdWRpb0VsZW1lbnQpIHsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQgPSBuZXcgQXVkaW8obm9kZS5sYXN0QXVkaW9VcmwpOw0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC52b2x1bWUgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLnZvbHVtZS52YWx1ZSk7DQogICAgfQ0KDQogICAgbm9kZS5hdWRpb0VsZW1lbnQucGxheSgpLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBsYXkgYXVkaW86JywgZXJyb3IpOw0KICAgIH0pOw0KDQp9DQoNCmZ1bmN0aW9uIHN0b3BBdWRpbyhub2RlSWQpIHsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUgfHwgIW5vZGUuYXVkaW9FbGVtZW50KSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIGF1ZGlvIGVsZW1lbnQgZm91bmQgZm9yIG5vZGU6Jywgbm9kZUlkKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIG5vZGUuYXVkaW9FbGVtZW50LnBhdXNlKCk7DQogICAgbm9kZS5hdWRpb0VsZW1lbnQuY3VycmVudFRpbWUgPSAwOw0KDQp9DQoNCi8vIEltYWdlIGRpc3BsYXkgZnVuY3Rpb25zDQpmdW5jdGlvbiBzaG93RnVsbEltYWdlKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCAhbm9kZS5sYXN0SW1hZ2VVcmwpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTm8gaW1hZ2UgZGF0YSBhdmFpbGFibGUgZm9yIG5vZGU6Jywgbm9kZUlkKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIENyZWF0ZSBhIG1vZGFsIHRvIHNob3cgdGhlIGZ1bGwgaW1hZ2UNCiAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIG1vZGFsLmNsYXNzTmFtZSA9ICdpbWFnZS1tb2RhbCc7DQogICAgbW9kYWwuc3R5bGUuY3NzVGV4dCA9IGANCiAgICAgICAgcG9zaXRpb246IGZpeGVkOw0KICAgICAgICB0b3A6IDA7DQogICAgICAgIGxlZnQ6IDA7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICBoZWlnaHQ6IDEwMCU7DQogICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC44KTsNCiAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICAgIHotaW5kZXg6IDEwMDAwOw0KICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgYDsNCg0KICAgIGNvbnN0IGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpOw0KICAgIGltZy5zcmMgPSBub2RlLmxhc3RJbWFnZVVybDsNCiAgICBpbWcuc3R5bGUuY3NzVGV4dCA9IGANCiAgICAgICAgbWF4LXdpZHRoOiA5MCU7DQogICAgICAgIG1heC1oZWlnaHQ6IDkwJTsNCiAgICAgICAgb2JqZWN0LWZpdDogY29udGFpbjsNCiAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgICAgICBib3gtc2hhZG93OiAwIDRweCAyMHB4IHJnYmEoMCwgMCwgMCwgMC41KTsNCiAgICBgOw0KDQogICAgbW9kYWwuYXBwZW5kQ2hpbGQoaW1nKTsNCiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vZGFsKTsNCg0KICAgIC8vIENsb3NlIG1vZGFsIG9uIGNsaWNrDQogICAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobW9kYWwpOw0KICAgIH0pOw0KDQp9DQoNCi8vIFJlcGVhdGVyIGNvbnRyb2wgZnVuY3Rpb25zDQpmdW5jdGlvbiBzdGFydFJlcGVhdGVyKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCBub2RlLnR5cGUgIT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignSW52YWxpZCByZXBlYXRlciBub2RlOicsIG5vZGVJZCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBFeGVjdXRlIHRoZSByZXBlYXRlciBub2RlIHRvIHN0YXJ0IGl0DQogICAgZXhlY3V0aW9uRW5naW5lLmV4ZWN1dGVOb2RlKG5vZGUsIHt9LCBuZXcgU2V0KCkpLnRoZW4oKCkgPT4gew0KICAgICAgICAvLyBSZWZyZXNoIHRoZSBjb25maWcgcGFuZWwgdG8gdXBkYXRlIHRoZSBVSQ0KICAgICAgICBzaG93Tm9kZUNvbmZpZyhub2RlSWQpOw0KICAgIH0pLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHN0YXJ0IHJlcGVhdGVyOicsIGVycm9yKTsNCiAgICB9KTsNCn0NCg0KZnVuY3Rpb24gc3RvcFJlcGVhdGVyKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCBub2RlLnR5cGUgIT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignSW52YWxpZCByZXBlYXRlciBub2RlOicsIG5vZGVJZCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBTdG9wIHRoZSByZXBlYXRlciB1c2luZyB0aGUgZXhlY3V0aW9uIGVuZ2luZSBtZXRob2QNCiAgICBleGVjdXRpb25FbmdpbmUuc3RvcFJlcGVhdGVyKG5vZGUpOw0KDQogICAgLy8gUmVmcmVzaCB0aGUgY29uZmlnIHBhbmVsIHRvIHVwZGF0ZSB0aGUgVUkNCiAgICBzaG93Tm9kZUNvbmZpZyhub2RlSWQpOw0KfQ0KDQoNCg0KLy8gVXBkYXRlIGlucHV0IG1hcHBpbmcgd2hlbiB1c2VyIHNlbGVjdHMgYSBkaWZmZXJlbnQgb3V0cHV0IHBvcnQNCmZ1bmN0aW9uIHVwZGF0ZUlucHV0TWFwcGluZyhub2RlSWQsIGlucHV0UG9ydCwgc2VsZWN0ZWRPdXRwdXRQb3J0KSB7DQogICAgLy8gRmluZCB0aGUgY29ubmVjdGlvbiB0aGF0IGdvZXMgdG8gdGhpcyBpbnB1dCBwb3J0IChpZ25vcmUgZnJvbS5wb3J0TmFtZSkNCiAgICBjb25zdCBjb25uZWN0aW9uID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5maW5kKGNvbm4gPT4NCiAgICAgICAgY29ubi50by5ub2RlSWQgPT09IG5vZGVJZCAmJiBjb25uLnRvLnBvcnROYW1lID09PSBpbnB1dFBvcnQNCiAgICApOw0KICAgIGlmIChjb25uZWN0aW9uKSB7DQogICAgICAgIC8vIFJlbW92ZSB0aGUgb2xkIGNvbm5lY3Rpb24NCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5kZWxldGUoY29ubmVjdGlvbi5pZCk7DQogICAgICAgIGlmIChjb25uZWN0aW9uLnN2ZykgY29ubmVjdGlvbi5zdmcucmVtb3ZlKCk7DQogICAgICAgIC8vIENyZWF0ZSBhIG5ldyBjb25uZWN0aW9uIHdpdGggdGhlIHVwZGF0ZWQgcG9ydCBuYW1lIGFuZCBuZXcgSUQNCiAgICAgICAgY29uc3QgbmV3Q29ubmVjdGlvbklkID0gYGNvbm5fJHtjb25uZWN0aW9uLmZyb20ubm9kZUlkfV8ke3NlbGVjdGVkT3V0cHV0UG9ydH1fJHtjb25uZWN0aW9uLnRvLm5vZGVJZH1fJHtjb25uZWN0aW9uLnRvLnBvcnROYW1lfWA7DQogICAgICAgIGNvbnN0IG5ld0Nvbm5lY3Rpb24gPSB7DQogICAgICAgICAgICBpZDogbmV3Q29ubmVjdGlvbklkLA0KICAgICAgICAgICAgZnJvbTogeyBub2RlSWQ6IGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQsIHBvcnROYW1lOiBzZWxlY3RlZE91dHB1dFBvcnQgfSwNCiAgICAgICAgICAgIHRvOiB7IG5vZGVJZDogY29ubmVjdGlvbi50by5ub2RlSWQsIHBvcnROYW1lOiBjb25uZWN0aW9uLnRvLnBvcnROYW1lIH0NCiAgICAgICAgfTsNCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5zZXQobmV3Q29ubmVjdGlvbklkLCBuZXdDb25uZWN0aW9uKTsNCiAgICAgICAgZHJhd0Nvbm5lY3Rpb24obmV3Q29ubmVjdGlvbik7DQogICAgICAgIC8vIFJlZnJlc2ggdGhlIG5vZGUgY29uZmlnIHBhbmVsIHRvIHNob3cgdXBkYXRlZCBzdGF0ZQ0KICAgICAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPT09IG5vZGVJZCkgew0KICAgICAgICAgICAgc2hvd05vZGVDb25maWcobm9kZUlkKTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBBdXRvLXNhdmUgdGhlIHdvcmtmbG93IHRvIHBlcnNpc3QgdGhlIG1hcHBpbmcgY2hhbmdlDQogICAgICAgIGlmIChzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmlsZU1hbmFnZXIuc2F2ZUZsb3cpIHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci5zYXZlRmxvdygpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBVcGRhdGUgb3V0cHV0IG1hcHBpbmcgd2hlbiB1c2VyIHNlbGVjdHMgYSBkaWZmZXJlbnQgb3V0cHV0IHBvcnQNCmZ1bmN0aW9uIHVwZGF0ZU91dHB1dE1hcHBpbmcobm9kZUlkLCBvdXRwdXRQb3J0LCB0YXJnZXROb2RlSWQsIHNlbGVjdGVkT3V0cHV0UG9ydCkgew0KICAgIC8vIFJlbW92ZSBhbGwgY29ubmVjdGlvbnMgZnJvbSB0aGlzIG5vZGUgdG8gdGhlIHRhcmdldCBub2RlIChyZWdhcmRsZXNzIG9mIHBvcnQpDQogICAgY29uc3QgY29ubmVjdGlvbnNUb1JlbW92ZSA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkuZmlsdGVyKGNvbm4gPT4NCiAgICAgICAgY29ubi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkICYmIGNvbm4udG8ubm9kZUlkID09PSB0YXJnZXROb2RlSWQNCiAgICApOw0KICAgIGNvbm5lY3Rpb25zVG9SZW1vdmUuZm9yRWFjaChjb25uID0+IHsNCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5kZWxldGUoY29ubi5pZCk7DQogICAgICAgIGlmIChjb25uLnN2ZykgY29ubi5zdmcucmVtb3ZlKCk7DQogICAgfSk7DQogICAgLy8gQWRkIHRoZSBuZXcgY29ubmVjdGlvbg0KICAgIGNvbnN0IG5ld0Nvbm5lY3Rpb25JZCA9IGBjb25uXyR7bm9kZUlkfV8ke3NlbGVjdGVkT3V0cHV0UG9ydH1fJHt0YXJnZXROb2RlSWR9YDsNCiAgICBjb25zdCBuZXdDb25uZWN0aW9uID0gew0KICAgICAgICBpZDogbmV3Q29ubmVjdGlvbklkLA0KICAgICAgICBmcm9tOiB7IG5vZGVJZDogbm9kZUlkLCBwb3J0TmFtZTogc2VsZWN0ZWRPdXRwdXRQb3J0IH0sDQogICAgICAgIHRvOiB7IG5vZGVJZDogdGFyZ2V0Tm9kZUlkLCBwb3J0TmFtZTogY29ubmVjdGlvbnNUb1JlbW92ZVswXT8udG8ucG9ydE5hbWUgfHwgJ2RhdGEnIH0NCiAgICB9Ow0KICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuc2V0KG5ld0Nvbm5lY3Rpb25JZCwgbmV3Q29ubmVjdGlvbik7DQogICAgZHJhd0Nvbm5lY3Rpb24obmV3Q29ubmVjdGlvbik7DQogICAgLy8gUmVmcmVzaCB0aGUgdGFyZ2V0IG5vZGUgaWYgc2VsZWN0ZWQNCiAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPT09IHRhcmdldE5vZGVJZCkgew0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIHNob3dOb2RlQ29uZmlnKHRhcmdldE5vZGVJZCk7DQogICAgICAgIH0sIDEwKTsNCiAgICB9DQogICAgLy8gQXV0by1zYXZlDQogICAgaWYgKHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci5zYXZlRmxvdykgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLnNhdmVGbG93KCk7DQp9DQoNCg0KLy8gbm9kZS1yZWdpc3RyeS5qcyAtIER5bmFtaWMgbm9kZSByZWdpc3RyeSBmb3IgRmxvdyBFZGl0b3INCg0KY2xhc3MgTm9kZVJlZ2lzdHJ5IHsNCiAgICBjb25zdHJ1Y3RvcigpIHsNCiAgICAgICAgdGhpcy5ub2RlVHlwZXMgPSBuZXcgTWFwKCk7DQogICAgICAgIHRoaXMuZXhlY3V0b3JzID0gbmV3IE1hcCgpOw0KICAgICAgICB0aGlzLmxvYWRlZCA9IGZhbHNlOw0KICAgIH0NCiAgICANCiAgICBhc3luYyBsb2FkTm9kZXNGcm9tVkZTKCkgew0KICAgICAgICBpZiAodGhpcy5sb2FkZWQpIHJldHVybjsNCiAgICAgICAgDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIExvYWQgdGhlIHBhY2tlZCBub2RlcyBmaWxlIGRpcmVjdGx5DQogICAgICAgICAgICBjb25zdCBwYWNrRmlsZVBhdGggPSAnL2FwcHMvaW5zdGFsbGVkL2Zsb3dfZWRpdG9yL25vZGVzLXBhY2suanNvbic7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlVGV4dChwYWNrRmlsZVBhdGgpOw0KICAgICAgICAgICAgY29uc3QgcGFja0RhdGEgPSBKU09OLnBhcnNlKGNvbnRlbnQpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFJlZ2lzdGVyIGFsbCBub2RlcyBmcm9tIHRoZSBwYWNrDQogICAgICAgICAgICBmb3IgKGNvbnN0IFtub2RlSWQsIG5vZGVEZWZdIG9mIE9iamVjdC5lbnRyaWVzKHBhY2tEYXRhLm5vZGVzKSkgew0KICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJOb2RlKG5vZGVEZWYpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICB0aGlzLmxvYWRlZCA9IHRydWU7DQogICAgICAgICAgICANCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIG5vZGVzIGZyb20gVkZTIHBhY2tlZCBmaWxlOicsIGVycm9yKTsNCiAgICAgICAgICAgIHRocm93IGVycm9yOyAvLyBSZS10aHJvdyB0byBpbmRpY2F0ZSBmYWlsdXJlDQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgYXN5bmMgbG9hZE5vZGVGaWxlKGZpbGVQYXRoKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZVRleHQoZmlsZVBhdGgpOw0KICAgICAgICAgICAgY29uc3Qgbm9kZURlZiA9IEpTT04ucGFyc2UoY29udGVudCk7DQogICAgICAgICAgICB0aGlzLnJlZ2lzdGVyTm9kZShub2RlRGVmKTsNCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBsb2FkIG5vZGUgZnJvbSAke2ZpbGVQYXRofTpgLCBlcnJvcik7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmVnaXN0ZXJOb2RlKG5vZGVEZWYpIHsNCiAgICAgICAgdGhpcy5ub2RlVHlwZXMuc2V0KG5vZGVEZWYuaWQsIG5vZGVEZWYpOw0KICAgIH0NCiAgICANCiAgICByZWdpc3RlckV4ZWN1dG9yKG5hbWUsIGV4ZWN1dG9yKSB7DQogICAgICAgIHRoaXMuZXhlY3V0b3JzLnNldChuYW1lLCBleGVjdXRvcik7DQogICAgfQ0KICAgIA0KICAgIGdldE5vZGVUeXBlKGlkKSB7DQogICAgICAgIHJldHVybiB0aGlzLm5vZGVUeXBlcy5nZXQoaWQpOw0KICAgIH0NCiAgICANCiAgICBnZXRFeGVjdXRvcihuYW1lKSB7DQogICAgICAgIHJldHVybiB0aGlzLmV4ZWN1dG9ycy5nZXQobmFtZSk7DQogICAgfQ0KICAgIA0KICAgIGdldEFsbE5vZGVUeXBlcygpIHsNCiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5ub2RlVHlwZXMudmFsdWVzKCkpOw0KICAgIH0NCiAgICANCiAgICBnZXROb2RlVHlwZXNCeUNhdGVnb3J5KGNhdGVnb3J5KSB7DQogICAgICAgIHJldHVybiB0aGlzLmdldEFsbE5vZGVUeXBlcygpLmZpbHRlcihub2RlID0+IG5vZGUuY2F0ZWdvcnkgPT09IGNhdGVnb3J5KTsNCiAgICB9DQp9DQoNCi8vIEdsb2JhbCBub2RlIHJlZ2lzdHJ5IGluc3RhbmNlDQpjb25zdCBub2RlUmVnaXN0cnkgPSBuZXcgTm9kZVJlZ2lzdHJ5KCk7DQoNCg0KLy8gY2FudmFzLmpzIC0gQ2FudmFzIGV2ZW50IGhhbmRsZXJzIGFuZCBkcmF3aW5nIGxvZ2ljIGZvciBGbG93IEVkaXRvcg0KDQovLyBTdGFydCBkcmFnZ2luZyBhIG5vZGUNCmZ1bmN0aW9uIHN0YXJ0RHJhZ2dpbmdOb2RlKG5vZGVJZCwgZSkgew0KICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgIA0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSkgcmV0dXJuOw0KICAgIA0KICAgIGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlID0gbm9kZUlkOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBvZmZzZXQgZnJvbSBtb3VzZSB0byBub2RlIGNvcm5lciB1c2luZyBzY2FsZWQgY29vcmRpbmF0ZXMNCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgY29uc3QgcmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/IA0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KG5vZGVFbGVtZW50KSA6IA0KICAgICAgICBub2RlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8gDQogICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6IA0KICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgDQogICAgZmxvd0VkaXRvci5kcmFnT2Zmc2V0ID0gew0KICAgICAgICB4OiBtb3VzZUNvb3Jkcy54IC0gcmVjdC5sZWZ0LA0KICAgICAgICB5OiBtb3VzZUNvb3Jkcy55IC0gcmVjdC50b3ANCiAgICB9Ow0KICAgIA0KICAgIG5vZGVFbGVtZW50LnN0eWxlLmN1cnNvciA9ICdncmFiYmluZyc7DQogICAgbm9kZUVsZW1lbnQuc3R5bGUuekluZGV4ID0gJzEwMDAnOyAvLyBCcmluZyB0byBmcm9udCB3aGlsZSBkcmFnZ2luZw0KICAgIA0KICAgIC8vIENhY2hlIGNhbnZhcyByZWN0IGZvciBwZXJmb3JtYW5jZSAoc2NhbGVkKQ0KICAgIGZsb3dFZGl0b3IuY2FudmFzUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/IA0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGZsb3dFZGl0b3IuY2FudmFzKSA6IA0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCn0NCg0KLy8gU2VsZWN0IGEgbm9kZQ0KZnVuY3Rpb24gc2VsZWN0Tm9kZShub2RlSWQpIHsNCiAgICAvLyBSZW1vdmUgcHJldmlvdXMgc2VsZWN0aW9uDQogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZsb3ctbm9kZS5zZWxlY3RlZCcpLmZvckVhY2gobm9kZSA9PiB7DQogICAgICAgIG5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTsNCiAgICB9KTsNCiAgICANCiAgICAvLyBTZWxlY3QgbmV3IG5vZGUNCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7DQogICAgICAgIGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlID0gbm9kZUlkOw0KICAgICAgICBzaG93Tm9kZUNvbmZpZyhub2RlSWQpOw0KICAgIH0NCn0NCg0KDQovLyBTdGFydCBhIGNvbm5lY3Rpb24gZnJvbSBhIHBvcnQNCmZ1bmN0aW9uIHN0YXJ0Q29ubmVjdGlvbihub2RlSWQsIHBvcnROYW1lLCBpc091dHB1dCkgew0KICAgIGlmIChpc091dHB1dCkgew0KICAgICAgICAvLyBTdGFydGluZyBmcm9tIG91dHB1dCBwb3J0DQogICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20gPSB7DQogICAgICAgICAgICBub2RlSWQ6IG5vZGVJZCwNCiAgICAgICAgICAgIHBvcnROYW1lOiBwb3J0TmFtZSwNCiAgICAgICAgICAgIGlzT3V0cHV0OiB0cnVlDQogICAgICAgIH07DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gU3RhcnRpbmcgZnJvbSBpbnB1dCBwb3J0IC0gY2hlY2sgaWYgd2UgaGF2ZSBhIHBlbmRpbmcgY29ubmVjdGlvbg0KICAgICAgICBpZiAoZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbSAmJiBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tLmlzT3V0cHV0KSB7DQogICAgICAgICAgICAvLyBDb21wbGV0ZSB0aGUgY29ubmVjdGlvbg0KICAgICAgICAgICAgY29uc3QgZnJvbU5vZGVJZCA9IGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20ubm9kZUlkOw0KICAgICAgICAgICAgY29uc3QgZnJvbVBvcnQgPSBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tLnBvcnROYW1lOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjcmVhdGVDb25uZWN0aW9uKGZyb21Ob2RlSWQsIGZyb21Qb3J0LCBub2RlSWQsIHBvcnROYW1lKTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20gPSBudWxsOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBVcGRhdGUgY29ubmVjdGlvbnMgZm9yIGEgc3BlY2lmaWMgbm9kZQ0KZnVuY3Rpb24gdXBkYXRlQ29ubmVjdGlvbnNGb3JOb2RlKG5vZGVJZCkgew0KICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBub2RlSWQgfHwgY29ubmVjdGlvbi50by5ub2RlSWQgPT09IG5vZGVJZCkgew0KICAgICAgICAgICAgdXBkYXRlQ29ubmVjdGlvbihjb25uZWN0aW9uKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gVXBkYXRlIGEgc2luZ2xlIGNvbm5lY3Rpb24NCmZ1bmN0aW9uIHVwZGF0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbikgew0KICAgIGNvbnN0IGZyb21Ob2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCk7DQogICAgY29uc3QgdG9Ob2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgIA0KICAgIGlmICghZnJvbU5vZGUgfHwgIXRvTm9kZSB8fCAhY29ubmVjdGlvbi5zdmcpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBHZXQgbm9kZSBkYXRhIHBvc2l0aW9ucw0KICAgIGNvbnN0IGZyb21Ob2RlRGF0YSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQpOw0KICAgIGNvbnN0IHRvTm9kZURhdGEgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgDQogICAgaWYgKCFmcm9tTm9kZURhdGEgfHwgIXRvTm9kZURhdGEpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBHZXQgYWN0dWFsIG5vZGUgZGltZW5zaW9ucyBmcm9tIGNvbXB1dGVkIHN0eWxlcw0KICAgIGNvbnN0IGZyb21TdHlsZXMgPSBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZ2V0Q29tcHV0ZWRTdHlsZShmcm9tTm9kZSk7DQogICAgY29uc3QgdG9TdHlsZXMgPSBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZ2V0Q29tcHV0ZWRTdHlsZSh0b05vZGUpOw0KICAgIA0KICAgIGNvbnN0IGZyb21XaWR0aCA9IHBhcnNlRmxvYXQoZnJvbVN0eWxlcy53aWR0aCkgfHwgMjAwOw0KICAgIGNvbnN0IGZyb21IZWlnaHQgPSBwYXJzZUZsb2F0KGZyb21TdHlsZXMuaGVpZ2h0KSB8fCA4MDsNCiAgICBjb25zdCB0b1dpZHRoID0gcGFyc2VGbG9hdCh0b1N0eWxlcy53aWR0aCkgfHwgMjAwOw0KICAgIGNvbnN0IHRvSGVpZ2h0ID0gcGFyc2VGbG9hdCh0b1N0eWxlcy5oZWlnaHQpIHx8IDgwOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBjb25uZWN0aW9uIHBvc2l0aW9ucyBkaXJlY3RseSBmcm9tIG5vZGUgZGF0YSAobm8gZXh0cmEgdHJhbnNmb3JtcykNCiAgICAvLyBGcm9tIG91dHB1dCBwb3J0IChyaWdodCBzaWRlIG9mIGZyb20gbm9kZSwgbWlkZGxlIHZlcnRpY2FsbHkpDQogICAgY29uc3QgZnJvbVggPSBmcm9tTm9kZURhdGEueCArIGZyb21XaWR0aDsNCiAgICBjb25zdCBmcm9tWSA9IGZyb21Ob2RlRGF0YS55ICsgZnJvbUhlaWdodCAvIDI7DQogICAgDQogICAgLy8gVG8gaW5wdXQgcG9ydCAobGVmdCBzaWRlIG9mIHRvIG5vZGUsIG1pZGRsZSB2ZXJ0aWNhbGx5KSAgDQogICAgY29uc3QgdG9YID0gdG9Ob2RlRGF0YS54Ow0KICAgIGNvbnN0IHRvWSA9IHRvTm9kZURhdGEueSArIHRvSGVpZ2h0IC8gMjsNCiAgICANCiAgICANCiAgICAvLyBVcGRhdGUgdGhlIHBhdGgNCiAgICBjb25zdCBwYXRoID0gY29ubmVjdGlvbi5zdmcucXVlcnlTZWxlY3RvcigncGF0aCcpOw0KICAgIGlmIChwYXRoKSB7DQogICAgICAgIGNvbnN0IGNvbnRyb2xQb2ludDFYID0gZnJvbVggKyAodG9YIC0gZnJvbVgpICogMC41Ow0KICAgICAgICBjb25zdCBjb250cm9sUG9pbnQyWCA9IGZyb21YICsgKHRvWCAtIGZyb21YKSAqIDAuNTsNCiAgICAgICAgY29uc3QgcGF0aEQgPSBgTSAke2Zyb21YfSAke2Zyb21ZfSBDICR7Y29udHJvbFBvaW50MVh9ICR7ZnJvbVl9ICR7Y29udHJvbFBvaW50Mlh9ICR7dG9ZfSAke3RvWH0gJHt0b1l9YDsNCiAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ2QnLCBwYXRoRCk7DQogICAgfSBlbHNlIHsNCiAgICB9DQp9DQoNCi8vIFJlZHJhdyBhbGwgY29ubmVjdGlvbnMgKGZvciB3aW5kb3cgcmVzaXplLCBldGMuKQ0KZnVuY3Rpb24gcmVkcmF3QWxsQ29ubmVjdGlvbnMoKSB7DQogICAgLy8gUHJldmVudCBvdmVyd2hlbG1pbmcgdGhlIHN5c3RlbSB3aXRoIHRvbyBtYW55IHJlZHJhd3MNCiAgICBpZiAoZmxvd0VkaXRvci5yZWRyYXdJblByb2dyZXNzKSByZXR1cm47DQogICAgZmxvd0VkaXRvci5yZWRyYXdJblByb2dyZXNzID0gdHJ1ZTsNCiAgICANCiAgICAvLyBVc2UgcmVxdWVzdEFuaW1hdGlvbkZyYW1lIGZvciBzbW9vdGggcmVkcmF3aW5nDQogICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHsNCiAgICAgICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgICAgIHVwZGF0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbik7DQogICAgICAgIH0NCiAgICAgICAgZmxvd0VkaXRvci5yZWRyYXdJblByb2dyZXNzID0gZmFsc2U7DQogICAgfSk7DQp9DQoNCi8vIERlbGV0ZSBhIG5vZGUgYW5kIGFsbCBpdHMgY29ubmVjdGlvbnMNCmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZU5vZGUobm9kZUlkKSB7DQogICAgY29uc3QgY29uZmlybWVkID0gYXdhaXQgc3lwbmV4QVBJLnNob3dDb25maXJtYXRpb24oDQogICAgICAgICdEZWxldGUgTm9kZScsDQogICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgbm9kZT8nLA0KICAgICAgICB7DQogICAgICAgICAgICB0eXBlOiAnZGFuZ2VyJywNCiAgICAgICAgICAgIGNvbmZpcm1UZXh0OiAnRGVsZXRlJywNCiAgICAgICAgICAgIGNhbmNlbFRleHQ6ICdDYW5jZWwnLA0KICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS1jdWJlJw0KICAgICAgICB9DQogICAgKTsNCiAgICANCiAgICBpZiAoY29uZmlybWVkKSB7DQogICAgICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYW4gdXAgYXVkaW8gZWxlbWVudHMgaWYgdGhpcyBpcyBhbiBhdWRpbyBub2RlDQogICAgICAgIGlmIChub2RlICYmIG5vZGUudHlwZSA9PT0gJ2F1ZGlvJyAmJiBub2RlLmF1ZGlvRWxlbWVudCkgew0KICAgICAgICAgICAgLy8gUGF1c2UgYW5kIHN0b3AgdGhlIGF1ZGlvDQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5wYXVzZSgpOw0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuY3VycmVudFRpbWUgPSAwOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBSZW1vdmUgZXZlbnQgbGlzdGVuZXJzIHByb3Blcmx5DQogICAgICAgICAgICBpZiAobm9kZS5hdWRpb0V2ZW50TGlzdGVuZXJzKSB7DQogICAgICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZW5kZWQnLCBub2RlLmF1ZGlvRXZlbnRMaXN0ZW5lcnMuZW5kZWQpOw0KICAgICAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgbm9kZS5hdWRpb0V2ZW50TGlzdGVuZXJzLmVycm9yKTsNCiAgICAgICAgICAgICAgICBub2RlLmF1ZGlvRXZlbnRMaXN0ZW5lcnMgPSBudWxsOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBTdG9yZSB0aGUgc3JjIGJlZm9yZSBjbGVhcmluZyBpdCBmb3IgY2xlYW51cA0KICAgICAgICAgICAgY29uc3QgYXVkaW9TcmMgPSBub2RlLmF1ZGlvRWxlbWVudC5zcmM7DQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zcmMgPSAnJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUmV2b2tlIGJsb2IgVVJMIGlmIGl0IGV4aXN0cw0KICAgICAgICAgICAgaWYgKGF1ZGlvU3JjICYmIGF1ZGlvU3JjLnN0YXJ0c1dpdGgoJ2Jsb2I6JykpIHsNCiAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKGF1ZGlvU3JjKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIGF1ZGlvIGVsZW1lbnQgcmVmZXJlbmNlDQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudCA9IG51bGw7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFJlbW92ZSBhbGwgY29ubmVjdGlvbnMgaW52b2x2aW5nIHRoaXMgbm9kZQ0KICAgICAgICBjb25zdCBjb25uZWN0aW9uc1RvRGVsZXRlID0gW107DQogICAgICAgIGZvciAoY29uc3QgW2Nvbm5lY3Rpb25JZCwgY29ubmVjdGlvbl0gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5lbnRyaWVzKCkpIHsNCiAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBub2RlSWQgfHwgY29ubmVjdGlvbi50by5ub2RlSWQgPT09IG5vZGVJZCkgew0KICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25zVG9EZWxldGUucHVzaChjb25uZWN0aW9uSWQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBEZWxldGUgY29ubmVjdGlvbnMNCiAgICAgICAgZm9yIChjb25zdCBjb25uZWN0aW9uSWQgb2YgY29ubmVjdGlvbnNUb0RlbGV0ZSkgew0KICAgICAgICAgICAgZGVsZXRlQ29ubmVjdGlvbihjb25uZWN0aW9uSWQpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBSZW1vdmUgbm9kZSBmcm9tIGRhdGEgc3RydWN0dXJlDQogICAgICAgIGZsb3dFZGl0b3Iubm9kZXMuZGVsZXRlKG5vZGVJZCk7DQogICAgICAgIA0KICAgICAgICAvLyBSZW1vdmUgbm9kZSBlbGVtZW50IGZyb20gRE9NDQogICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICBub2RlRWxlbWVudC5yZW1vdmUoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gRGVzZWxlY3QgaWYgdGhpcyB3YXMgdGhlIHNlbGVjdGVkIG5vZGUNCiAgICAgICAgaWYgKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlID09PSBub2RlSWQpIHsNCiAgICAgICAgICAgIGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlID0gbnVsbDsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlLWNvbmZpZycpLmlubmVySFRNTCA9ICc8cCBjbGFzcz0idGV4dC1tdXRlZCI+U2VsZWN0IGEgbm9kZSB0byBjb25maWd1cmUgaXQ8L3A+JzsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICB9DQp9DQoNCi8vIERlbGV0ZSBhIGNvbm5lY3Rpb24NCmZ1bmN0aW9uIGRlbGV0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbklkKSB7DQogICAgY29uc3QgY29ubmVjdGlvbiA9IGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuZ2V0KGNvbm5lY3Rpb25JZCk7DQogICAgaWYgKGNvbm5lY3Rpb24gJiYgY29ubmVjdGlvbi5zdmcpIHsNCiAgICAgICAgY29ubmVjdGlvbi5zdmcucmVtb3ZlKCk7DQogICAgfQ0KICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuZGVsZXRlKGNvbm5lY3Rpb25JZCk7DQp9DQoNCi8vIERlbGV0ZSBzZWxlY3RlZCBub2RlDQphc3luYyBmdW5jdGlvbiBkZWxldGVTZWxlY3RlZE5vZGUoKSB7DQogICAgaWYgKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlKSB7DQogICAgICAgIGF3YWl0IGRlbGV0ZU5vZGUoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpOw0KICAgIH0NCn0NCg0KLy8gSGFuZGxlIHBvcnQgbW91c2UgZXZlbnRzIGZvciBjb25uZWN0aW9ucw0KZnVuY3Rpb24gaGFuZGxlUG9ydE1vdXNlRG93bihlLCBub2RlSWQsIHBvcnROYW1lLCBpc091dHB1dCkgew0KICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgIA0KICAgIGlmIChpc091dHB1dCkgew0KICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tID0geyBub2RlSWQsIHBvcnROYW1lIH07DQogICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2Nvbm5lY3RpbmcnKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBpZiAoZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbSkgew0KICAgICAgICAgICAgY3JlYXRlQ29ubmVjdGlvbihmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tLm5vZGVJZCwgZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbS5wb3J0TmFtZSwgbm9kZUlkLCBwb3J0TmFtZSk7DQogICAgICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tID0gbnVsbDsNCiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mbG93LW5vZGUtcG9ydCcpLmZvckVhY2gocG9ydCA9PiBwb3J0LmNsYXNzTGlzdC5yZW1vdmUoJ2Nvbm5lY3RpbmcnKSk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIENyZWF0ZSBhIGNvbm5lY3Rpb24gYmV0d2VlbiBub2Rlcw0KZnVuY3Rpb24gY3JlYXRlQ29ubmVjdGlvbihmcm9tTm9kZUlkLCBmcm9tUG9ydCwgdG9Ob2RlSWQsIHRvUG9ydCkgew0KICAgIC8vIENoZWNrIGlmIGNvbm5lY3Rpb24gYWxyZWFkeSBleGlzdHMNCiAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gZnJvbU5vZGVJZCAmJiANCiAgICAgICAgICAgIGNvbm5lY3Rpb24uZnJvbS5wb3J0TmFtZSA9PT0gZnJvbVBvcnQgJiYNCiAgICAgICAgICAgIGNvbm5lY3Rpb24udG8ubm9kZUlkID09PSB0b05vZGVJZCAmJiANCiAgICAgICAgICAgIGNvbm5lY3Rpb24udG8ucG9ydE5hbWUgPT09IHRvUG9ydCkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGNvbm5lY3Rpb25JZCA9IGBjb25uXyR7ZnJvbU5vZGVJZH1fJHtmcm9tUG9ydH1fJHt0b05vZGVJZH1fJHt0b1BvcnR9YDsNCiAgICBjb25zdCBjb25uZWN0aW9uID0gew0KICAgICAgICBpZDogY29ubmVjdGlvbklkLA0KICAgICAgICBmcm9tOiB7IG5vZGVJZDogZnJvbU5vZGVJZCwgcG9ydE5hbWU6IGZyb21Qb3J0IH0sDQogICAgICAgIHRvOiB7IG5vZGVJZDogdG9Ob2RlSWQsIHBvcnROYW1lOiB0b1BvcnQgfQ0KICAgIH07DQogICAgDQogICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5zZXQoY29ubmVjdGlvbklkLCBjb25uZWN0aW9uKTsNCiAgICBkcmF3Q29ubmVjdGlvbihjb25uZWN0aW9uKTsNCiAgICANCn0NCg0KLy8gRHJhdyBhIGNvbm5lY3Rpb24gb24gdGhlIGNhbnZhcw0KZnVuY3Rpb24gZHJhd0Nvbm5lY3Rpb24oY29ubmVjdGlvbikgew0KICAgIGNvbnN0IGZyb21Ob2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCk7DQogICAgY29uc3QgdG9Ob2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgIA0KICAgIGlmICghZnJvbU5vZGUgfHwgIXRvTm9kZSkgcmV0dXJuOw0KICAgIA0KICAgIC8vIENyZWF0ZSBTVkcgZWxlbWVudCBmb3IgdGhlIGNvbm5lY3Rpb24NCiAgICBjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpOw0KICAgIHN2Zy5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7DQogICAgc3ZnLnN0eWxlLnRvcCA9ICcwJzsNCiAgICBzdmcuc3R5bGUubGVmdCA9ICcwJzsNCiAgICBzdmcuc3R5bGUud2lkdGggPSAnMTAwJSc7DQogICAgc3ZnLnN0eWxlLmhlaWdodCA9ICcxMDAlJzsNCiAgICBzdmcuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJzsgLy8gRG9uJ3QgY2FwdHVyZSBldmVudHMgYnkgZGVmYXVsdA0KICAgIHN2Zy5zdHlsZS56SW5kZXggPSAnMSc7DQogICAgc3ZnLmRhdGFzZXQuY29ubmVjdGlvbklkID0gY29ubmVjdGlvbi5pZDsNCiAgICANCiAgICBjb25zdCBwYXRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwYXRoJyk7DQogICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICcjNENBRjUwJyk7DQogICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7DQogICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnbm9uZScpOw0KICAgIHBhdGguc2V0QXR0cmlidXRlKCdtYXJrZXItZW5kJywgJ3VybCgjYXJyb3doZWFkKScpOw0KICAgIHBhdGguc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInOw0KICAgIHBhdGguc3R5bGUucG9pbnRlckV2ZW50cyA9ICdhdXRvJzsgLy8gT25seSB0aGUgcGF0aCBjYXB0dXJlcyBldmVudHMNCiAgICANCiAgICAvLyBBZGQgaG92ZXIgZWZmZWN0cw0KICAgIHBhdGguYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHsNCiAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICc0Jyk7DQogICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCdzdHJva2UnLCAnI2ZmNmI2YicpOw0KICAgICAgICAvLyBTaG93IGRlbGV0ZSB0b29sdGlwDQogICAgICAgIHNob3dDb25uZWN0aW9uVG9vbHRpcChjb25uZWN0aW9uLmlkLCAnQ2xpY2sgdG8gZGVsZXRlIGNvbm5lY3Rpb24nKTsNCiAgICB9KTsNCiAgICANCiAgICBwYXRoLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7DQogICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMicpOw0KICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJyM0Q0FGNTAnKTsNCiAgICAgICAgaGlkZUNvbm5lY3Rpb25Ub29sdGlwKCk7DQogICAgfSk7DQogICAgDQogICAgLy8gQWRkIGNsaWNrIHRvIGRlbGV0ZQ0KICAgIHBhdGguYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZSkgPT4gew0KICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICBjb25zdCBjb25maXJtZWQgPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0NvbmZpcm1hdGlvbigNCiAgICAgICAgICAgICdEZWxldGUgQ29ubmVjdGlvbicsDQogICAgICAgICAgICAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIGNvbm5lY3Rpb24/JywNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0eXBlOiAnZGFuZ2VyJywNCiAgICAgICAgICAgICAgICBjb25maXJtVGV4dDogJ0RlbGV0ZScsDQogICAgICAgICAgICAgICAgY2FuY2VsVGV4dDogJ0NhbmNlbCcsDQogICAgICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS1saW5rJw0KICAgICAgICAgICAgfQ0KICAgICAgICApOw0KICAgICAgICANCiAgICAgICAgaWYgKGNvbmZpcm1lZCkgew0KICAgICAgICAgICAgZGVsZXRlQ29ubmVjdGlvbihjb25uZWN0aW9uLmlkKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIHN2Zy5hcHBlbmRDaGlsZChwYXRoKTsNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5hcHBlbmRDaGlsZChzdmcpOw0KICAgIA0KICAgIC8vIFN0b3JlIFNWRyByZWZlcmVuY2UNCiAgICBjb25uZWN0aW9uLnN2ZyA9IHN2ZzsNCiAgICANCiAgICAvLyBVcGRhdGUgY29ubmVjdGlvbiBwb3NpdGlvbg0KICAgIHVwZGF0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbik7DQp9DQoNCi8vIFNob3cgY29ubmVjdGlvbiB0b29sdGlwDQpmdW5jdGlvbiBzaG93Q29ubmVjdGlvblRvb2x0aXAoY29ubmVjdGlvbklkLCBtZXNzYWdlKSB7DQogICAgLy8gQ2hlY2sgaWYgYXBwIGlzIHN0aWxsIGFjdGl2ZQ0KICAgIGlmICghZmxvd0VkaXRvci5pc0FjdGl2ZSkgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIFJlbW92ZSBleGlzdGluZyB0b29sdGlwDQogICAgaGlkZUNvbm5lY3Rpb25Ub29sdGlwKCk7DQogICAgDQogICAgY29uc3QgdG9vbHRpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIHRvb2x0aXAuY2xhc3NOYW1lID0gJ2Nvbm5lY3Rpb24tdG9vbHRpcCc7DQogICAgdG9vbHRpcC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7DQogICAgdG9vbHRpcC5zdHlsZS5jc3NUZXh0ID0gYA0KICAgICAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC44KTsNCiAgICAgICAgY29sb3I6IHdoaXRlOw0KICAgICAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7DQogICAgICAgIHotaW5kZXg6IDEwMDAwOw0KICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOw0KICAgICAgICBkaXNwbGF5OiBub25lOw0KICAgIGA7DQogICAgDQogICAgdG9vbHRpcC5pZCA9ICdjb25uZWN0aW9uLXRvb2x0aXAnOw0KICAgIA0KICAgIC8vIFRyeSB0byBhcHBlbmQgdG8gYXBwIGNvbnRhaW5lciBmaXJzdCwgZmFsbGJhY2sgdG8gYm9keQ0KICAgIGNvbnN0IGFwcENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcHAtY29udGFpbmVyJyk7DQogICAgY29uc3QgY29udGFpbmVyID0gYXBwQ29udGFpbmVyIHx8IGRvY3VtZW50LmJvZHk7DQogICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRvb2x0aXApOw0KICAgIA0KICAgIC8vIFBvc2l0aW9uIHRvb2x0aXAgbmVhciBtb3VzZSAod2lsbCBiZSB1cGRhdGVkIG9uIG1vdXNlbW92ZSkNCiAgICBjb25zdCB0b29sdGlwTW91c2VNb3ZlSGFuZGxlciA9IChlKSA9PiB1cGRhdGVUb29sdGlwUG9zaXRpb24oZSk7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdG9vbHRpcE1vdXNlTW92ZUhhbmRsZXIpOw0KICAgIA0KICAgIC8vIFN0b3JlIHRoZSBoYW5kbGVyIHJlZmVyZW5jZSBmb3IgY2xlYW51cA0KICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIgPSB0b29sdGlwTW91c2VNb3ZlSGFuZGxlcjsNCiAgICANCiAgICAvLyBTaG93IHRoZSB0b29sdGlwIGFmdGVyIGEgc21hbGwgZGVsYXkgdG8gcHJldmVudCBmbGlja2VyaW5nDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGlmICh0b29sdGlwLnBhcmVudE5vZGUgJiYgZmxvd0VkaXRvci5pc0FjdGl2ZSkgew0KICAgICAgICAgICAgdG9vbHRpcC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgfQ0KICAgIH0sIDEwKTsNCn0NCg0KLy8gVXBkYXRlIHRvb2x0aXAgcG9zaXRpb24NCmZ1bmN0aW9uIHVwZGF0ZVRvb2x0aXBQb3NpdGlvbihlKSB7DQogICAgY29uc3QgdG9vbHRpcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25uZWN0aW9uLXRvb2x0aXAnKTsNCiAgICBpZiAodG9vbHRpcCkgew0KICAgICAgICAvLyBVc2Ugc2NhbGVkIGNvb3JkaW5hdGVzIGZvciB0b29sdGlwIHBvc2l0aW9uaW5nDQogICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPyANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6IA0KICAgICAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgICAgICB0b29sdGlwLnN0eWxlLmxlZnQgPSAobW91c2VDb29yZHMueCArIDEwKSArICdweCc7DQogICAgICAgIHRvb2x0aXAuc3R5bGUudG9wID0gKG1vdXNlQ29vcmRzLnkgLSAxMCkgKyAncHgnOw0KICAgIH0NCn0NCg0KLy8gSGlkZSBjb25uZWN0aW9uIHRvb2x0aXANCmZ1bmN0aW9uIGhpZGVDb25uZWN0aW9uVG9vbHRpcCgpIHsNCiAgICBjb25zdCB0b29sdGlwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nvbm5lY3Rpb24tdG9vbHRpcCcpOw0KICAgIGlmICh0b29sdGlwKSB7DQogICAgICAgIC8vIFJlbW92ZSB0aGUgc3BlY2lmaWMgZXZlbnQgbGlzdGVuZXIgd2UgYWRkZWQNCiAgICAgICAgaWYgKHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIpIHsNCiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIpOw0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlciA9IG51bGw7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEhpZGUgYW5kIHJlbW92ZSB0aGUgdG9vbHRpcA0KICAgICAgICB0b29sdGlwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIGlmICh0b29sdGlwLnBhcmVudE5vZGUpIHsNCiAgICAgICAgICAgIHRvb2x0aXAucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0b29sdGlwKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gQ2xlYXIgdGhlIGNhbnZhcw0KYXN5bmMgZnVuY3Rpb24gY2xlYXJDYW52YXMoKSB7DQogICAgY29uc3QgY29uZmlybWVkID0gYXdhaXQgc3lwbmV4QVBJLnNob3dDb25maXJtYXRpb24oDQogICAgICAgICdDbGVhciBDYW52YXMnLA0KICAgICAgICAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNsZWFyIHRoZSBjYW52YXM/IFRoaXMgd2lsbCBkZWxldGUgYWxsIG5vZGVzIGFuZCBjb25uZWN0aW9ucy4nLA0KICAgICAgICB7DQogICAgICAgICAgICB0eXBlOiAnZGFuZ2VyJywNCiAgICAgICAgICAgIGNvbmZpcm1UZXh0OiAnQ2xlYXIgQWxsJywNCiAgICAgICAgICAgIGNhbmNlbFRleHQ6ICdDYW5jZWwnLA0KICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS10cmFzaC1hbHQnDQogICAgICAgIH0NCiAgICApOw0KICAgIA0KICAgIGlmIChjb25maXJtZWQpIHsNCiAgICAgICAgY2xlYXJDYW52YXNTaWxlbnQoKTsNCiAgICB9DQp9DQoNCi8vIENsZWFyIHRoZSBjYW52YXMgd2l0aG91dCBjb25maXJtYXRpb24gKHVzZWQgaW50ZXJuYWxseSkNCmZ1bmN0aW9uIGNsZWFyQ2FudmFzU2lsZW50KCkgew0KICAgIC8vIEhpZGUgYW55IGFjdGl2ZSB0b29sdGlwcw0KICAgIGhpZGVDb25uZWN0aW9uVG9vbHRpcCgpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgYWxsIGNvbm5lY3Rpb25zDQogICAgICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5zdmcpIHsNCiAgICAgICAgICAgICAgICBjb25uZWN0aW9uLnN2Zy5yZW1vdmUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmNsZWFyKCk7DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciBhbGwgbm9kZXMNCiAgICAgICAgZm9yIChjb25zdCBub2RlSWQgb2YgZmxvd0VkaXRvci5ub2Rlcy5rZXlzKCkpIHsNCiAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LnJlbW92ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGZsb3dFZGl0b3Iubm9kZXMuY2xlYXIoKTsNCiAgICAgICAgDQogICAgICAgIC8vIENsZWFyIGFsbCB0YWdzDQogICAgICAgIGZvciAoY29uc3QgdGFnSWQgb2YgZmxvd0VkaXRvci50YWdzLmtleXMoKSkgew0KICAgICAgICAgICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhZ0lkKTsNCiAgICAgICAgICAgIGlmICh0YWdFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgdGFnRWxlbWVudC5yZW1vdmUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBmbG93RWRpdG9yLnRhZ3MuY2xlYXIoKTsNCiAgICAgICAgDQogICAgICAgIC8vIFVwZGF0ZSB0YWcgcGFuZWwgdG8gcmVmbGVjdCBjbGVhcmVkIHRhZ3MNCiAgICAgICAgaWYgKHR5cGVvZiBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkudGFnTWFuYWdlci51cGRhdGVUYWdQYW5lbCA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLnRhZ01hbmFnZXIudXBkYXRlVGFnUGFuZWwoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gUmVzZXQgY291bnRlcnMNCiAgICAgICAgZmxvd0VkaXRvci5ub2RlQ291bnRlciA9IDA7DQogICAgICAgIGZsb3dFZGl0b3IudGFnQ291bnRlciA9IDA7DQogICAgICAgIGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlID0gbnVsbDsNCiAgICAgICAgDQogICAgICAgIC8vIENsZWFyIGN1cnJlbnQgZmlsZSBwYXRoDQogICAgICAgIGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoID0gbnVsbDsNCiAgICAgICAgDQogICAgICAgIC8vIFJlc2V0IHBhbiBvZmZzZXQgdG8gY2VudGVyIG9mIGxhcmdlIGNhbnZhcw0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldCA9IHsgeDogLTUwMDAsIHk6IC01MDAwIH07DQogICAgICAgIA0KICAgICAgICAvLyBSZXNldCB6b29tIGxldmVsDQogICAgICAgIGZsb3dFZGl0b3Iuem9vbUxldmVsID0gMS4wOw0KICAgICAgICANCiAgICAgICAgaWYgKHR5cGVvZiBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0gPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBVcGRhdGUgZmlsZW5hbWUgZGlzcGxheQ0KICAgICAgICBpZiAodHlwZW9mIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci51cGRhdGVGaWxlbmFtZURpc3BsYXkgPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci51cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgY29uZmlnIHBhbmVsDQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlLWNvbmZpZycpLmlubmVySFRNTCA9ICc8cCBjbGFzcz0idGV4dC1tdXRlZCI+U2VsZWN0IGEgbm9kZSB0byBjb25maWd1cmUgaXQ8L3A+JzsNCn0gDQoNCg0KLy8gU2hvdyBub2RlIGNvbmZpZ3VyYXRpb24NCmFzeW5jIGZ1bmN0aW9uIHNob3dOb2RlQ29uZmlnKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSkgcmV0dXJuOw0KICAgIA0KICAgIGNvbnN0IG5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICBpZiAoIW5vZGVEZWYpIHJldHVybjsNCg0KICAgIC8vIExvYWQgc2F2ZWQgY29uZmlndXJhdGlvbiBzZWN0aW9uIHN0YXRlcw0KICAgIGxldCBzZWN0aW9uU3RhdGVzID0ge307DQogICAgdHJ5IHsNCiAgICAgICAgaWYgKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTZXR0aW5nKSB7DQogICAgICAgICAgICAvLyBMb2FkIHN0YXRlcyBmb3IgYWxsIHBvc3NpYmxlIHNlY3Rpb25zDQogICAgICAgICAgICBjb25zdCBzZWN0aW9ucyA9IFsnbm9kZS1jb250ZW50JywgJ2lucHV0LWNvbm5lY3Rpb25zJywgJ291dHB1dC1jb25uZWN0aW9ucycsICdub2RlLXNldHRpbmdzJywgJ291dHB1dC1kYXRhJ107DQogICAgICAgICAgICBmb3IgKGNvbnN0IHNlY3Rpb25JZCBvZiBzZWN0aW9ucykgew0KICAgICAgICAgICAgICAgIC8vIERlZmF1bHQgdG8gZXhwYW5kZWQgZm9yIG5vZGUtY29udGVudCwgY29sbGFwc2VkIGZvciBvdGhlcnMNCiAgICAgICAgICAgICAgICBjb25zdCBkZWZhdWx0RXhwYW5kZWQgPSBzZWN0aW9uSWQgPT09ICdub2RlLWNvbnRlbnQnOw0KICAgICAgICAgICAgICAgIHNlY3Rpb25TdGF0ZXNbc2VjdGlvbklkXSA9IGF3YWl0IHN5cG5leEFQSS5nZXRTZXR0aW5nKGBjb25maWdfc2VjdGlvbl8ke3NlY3Rpb25JZH1gLCBkZWZhdWx0RXhwYW5kZWQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gbG9hZCBjb25maWcgc2VjdGlvbiBzdGF0ZXM6JywgZXJyb3IpOw0KICAgICAgICAvLyBVc2UgZGVmYXVsdHMgaWYgbG9hZGluZyBmYWlscw0KICAgICAgICBzZWN0aW9uU3RhdGVzID0gew0KICAgICAgICAgICAgJ25vZGUtY29udGVudCc6IHRydWUsDQogICAgICAgICAgICAnaW5wdXQtY29ubmVjdGlvbnMnOiBmYWxzZSwNCiAgICAgICAgICAgICdvdXRwdXQtY29ubmVjdGlvbnMnOiBmYWxzZSwNCiAgICAgICAgICAgICdub2RlLXNldHRpbmdzJzogZmFsc2UsDQogICAgICAgICAgICAnb3V0cHV0LWRhdGEnOiBmYWxzZQ0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICAvLyBTaG93IGNvbmZpZyBwYW5lbCB3aXRoIG5vZGUgY29uZmlndXJhdGlvbg0KICAgIGNvbnN0IGNvbmZpZ1BhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUtY29uZmlnJyk7DQogICAgaWYgKGNvbmZpZ1BhbmVsKSB7DQogICAgICAgIGxldCBjb25maWdIdG1sID0gYDxoND4ke25vZGVEZWYubmFtZX0gQ29uZmlndXJhdGlvbjwvaDQ+YDsNCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBzcGVjaWFsIGNvbnRlbnQgZGlzcGxheSBmb3IgZGlmZmVyZW50IG5vZGUgdHlwZXMNCiAgICAgICAgbGV0IGhhc1NwZWNpYWxDb250ZW50ID0gZmFsc2U7DQogICAgICAgIGxldCBzcGVjaWFsQ29udGVudEh0bWwgPSAnJzsNCiAgICAgICAgDQogICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdkaXNwbGF5JyAmJiBub2RlLmxhc3RDb250ZW50KSB7DQogICAgICAgICAgICBoYXNTcGVjaWFsQ29udGVudCA9IHRydWU7DQogICAgICAgICAgICBzcGVjaWFsQ29udGVudEh0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5MYXN0IENvbnRlbnQ8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50LWRpc3BsYXkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHByZSBjbGFzcz0iY29udGVudC10ZXh0Ij4ke2VzY2FwZUh0bWwobm9kZS5sYXN0Q29udGVudCl9PC9wcmU+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50LWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5Gb3JtYXQ6ICR7bm9kZS5sYXN0Rm9ybWF0fSDigKIgTGVuZ3RoOiAke25vZGUubGFzdENvbnRlbnQubGVuZ3RofSBjaGFyczwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9IGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ2ltYWdlJyAmJiBub2RlLmxhc3RJbWFnZURhdGEpIHsNCiAgICAgICAgICAgIGhhc1NwZWNpYWxDb250ZW50ID0gdHJ1ZTsNCiAgICAgICAgICAgIHNwZWNpYWxDb250ZW50SHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkltYWdlIFByZXZpZXc8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbWFnZS1kaXNwbGF5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSIke25vZGUubGFzdEltYWdlVXJsfSIgYWx0PSJJbWFnZSBwcmV2aWV3IiBzdHlsZT0ibWF4LXdpZHRoOiAyMDBweDsgbWF4LWhlaWdodDogMTUwcHg7IGJvcmRlcjogMXB4IHNvbGlkICNjY2M7IGJvcmRlci1yYWRpdXM6IDRweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW1hZ2UtaW5mbyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPlNpemU6ICR7bm9kZS5sYXN0SW1hZ2VJbmZvPy53aWR0aCB8fCAnPyd9eCR7bm9kZS5sYXN0SW1hZ2VJbmZvPy5oZWlnaHQgfHwgJz8nfSDigKIgRm9ybWF0OiAke25vZGUubGFzdEltYWdlSW5mbz8uZm9ybWF0IHx8ICc/J308L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1wcmltYXJ5IG10LTIgdmlldy1mdWxsLWltYWdlLWJ0biIgZGF0YS1ub2RlLWlkPSIke25vZGVJZH0iPlZpZXcgRnVsbCBJbWFnZTwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0gZWxzZSBpZiAobm9kZS50eXBlID09PSAnYXVkaW8nICYmIG5vZGUubGFzdEF1ZGlvRGF0YSkgew0KICAgICAgICAgICAgaGFzU3BlY2lhbENvbnRlbnQgPSB0cnVlOw0KICAgICAgICAgICAgc3BlY2lhbENvbnRlbnRIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+QXVkaW8gQ29udHJvbHM8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhdWRpby1kaXNwbGF5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImF1ZGlvLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5BdWRpbyBsb2FkZWQgc3VjY2Vzc2Z1bGx5PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXVkaW8tY29udHJvbHMgbXQtMiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tc3VjY2VzcyBwbGF5LWF1ZGlvLWJ0biIgZGF0YS1ub2RlLWlkPSIke25vZGVJZH0iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXBsYXkiPjwvaT4gUGxheQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLWRhbmdlciBzdG9wLWF1ZGlvLWJ0biIgZGF0YS1ub2RlLWlkPSIke25vZGVJZH0iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXN0b3AiPjwvaT4gU3RvcA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09ICd2ZnNfbG9hZCcpIHsNCiAgICAgICAgICAgIGhhc1NwZWNpYWxDb250ZW50ID0gdHJ1ZTsNCiAgICAgICAgICAgIHNwZWNpYWxDb250ZW50SHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlZGUyBMb2FkIFN0YXR1czwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InZmcy1sb2FkLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPkxhc3QgbG9hZGVkOiAke25vZGUubGFzdExvYWRlZEZpbGUgfHwgJ05vbmUnfTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09ICdsbG1fY2hhdCcgJiYgbm9kZS5sYXN0UmVzcG9uc2UpIHsNCiAgICAgICAgICAgIGhhc1NwZWNpYWxDb250ZW50ID0gdHJ1ZTsNCiAgICAgICAgICAgIHNwZWNpYWxDb250ZW50SHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkxhc3QgUmVzcG9uc2U8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50LWRpc3BsYXkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHByZSBjbGFzcz0iY29udGVudC10ZXh0Ij4ke2VzY2FwZUh0bWwobm9kZS5sYXN0UmVzcG9uc2UpfTwvcHJlPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udGVudC1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+VG9rZW5zOiAke25vZGUubGFzdFVzYWdlPy50b3RhbF90b2tlbnMgfHwgMH0g4oCiIE1vZGVsOiAke25vZGUubGFzdE1vZGVsIHx8ICdVbmtub3duJ308L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgICAgIGhhc1NwZWNpYWxDb250ZW50ID0gdHJ1ZTsNCiAgICAgICAgICAgIGNvbnN0IGlzUnVubmluZyA9IG5vZGUucmVwZWF0ZXJTdGF0ZSAmJiBub2RlLnJlcGVhdGVyU3RhdGUuaXNSdW5uaW5nOw0KICAgICAgICAgICAgY29uc3QgY291bnQgPSBub2RlLnJlcGVhdGVyU3RhdGUgPyBub2RlLnJlcGVhdGVyU3RhdGUuY291bnQgOiAwOw0KICAgICAgICAgICAgc3BlY2lhbENvbnRlbnRIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+UmVwZWF0ZXIgQ29udHJvbHM8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyZXBlYXRlci1kaXNwbGF5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJlcGVhdGVyLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5TdGF0dXM6ICR7aXNSdW5uaW5nID8gJ1J1bm5pbmcnIDogJ1N0b3BwZWQnfSDigKIgQ291bnQ6ICR7Y291bnR9PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmVwZWF0ZXItY29udHJvbHMgbXQtMiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tc3VjY2VzcyBzdGFydC1yZXBlYXRlci1idG4iIGRhdGEtbm9kZS1pZD0iJHtub2RlSWR9IiAke2lzUnVubmluZyA/ICdkaXNhYmxlZCcgOiAnJ30+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtcGxheSI+PC9pPiBTdGFydA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLWRhbmdlciBzdG9wLXJlcGVhdGVyLWJ0biIgZGF0YS1ub2RlLWlkPSIke25vZGVJZH0iICR7IWlzUnVubmluZyA/ICdkaXNhYmxlZCcgOiAnJ30+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc3RvcCI+PC9pPiBTdG9wDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBXcmFwIHNwZWNpYWwgY29udGVudCBpbiBhIGNvbGxhcHNpYmxlIHNlY3Rpb24gaWYgcHJlc2VudA0KICAgICAgICBpZiAoaGFzU3BlY2lhbENvbnRlbnQpIHsNCiAgICAgICAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSBzZWN0aW9uU3RhdGVzWydub2RlLWNvbnRlbnQnXTsNCiAgICAgICAgICAgIGNvbnN0IGhlYWRlckNsYXNzID0gaXNFeHBhbmRlZCA/ICcnIDogJ2NvbGxhcHNlZCc7DQogICAgICAgICAgICBjb25zdCBpY29uQ2xhc3MgPSBpc0V4cGFuZGVkID8gJ2ZhcyBmYS1jaGV2cm9uLWRvd24nIDogJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRTdHlsZSA9IGlzRXhwYW5kZWQgPyAnJyA6ICcgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Iic7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uIj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24taGVhZGVyICR7aGVhZGVyQ2xhc3N9IiBkYXRhLXNlY3Rpb249Im5vZGUtY29udGVudCI+DQogICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iJHtpY29uQ2xhc3N9Ij48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5Ob2RlIENvbnRlbnQ8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbi1jb250ZW50IiBpZD0ibm9kZS1jb250ZW50LWNvbnRlbnQiJHtjb250ZW50U3R5bGV9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgJHtzcGVjaWFsQ29udGVudEh0bWx9DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gU2hvdyBpbnB1dCBtYXBwaW5ncyBjb25maWd1cmF0aW9uICh3aGF0IHRoaXMgbm9kZSByZWNlaXZlcyBmcm9tIG90aGVyIG5vZGVzKQ0KICAgICAgICBjb25zdCBpbnB1dENvbm5lY3Rpb25zID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKQ0KICAgICAgICAgICAgLmZpbHRlcihjb25uID0+IGNvbm4udG8ubm9kZUlkID09PSBub2RlSWQpOw0KICAgICAgICANCiAgICAgICAgaWYgKGlucHV0Q29ubmVjdGlvbnMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9IHNlY3Rpb25TdGF0ZXNbJ2lucHV0LWNvbm5lY3Rpb25zJ107DQogICAgICAgICAgICBjb25zdCBoZWFkZXJDbGFzcyA9IGlzRXhwYW5kZWQgPyAnJyA6ICdjb2xsYXBzZWQnOw0KICAgICAgICAgICAgY29uc3QgaWNvbkNsYXNzID0gaXNFeHBhbmRlZCA/ICdmYXMgZmEtY2hldnJvbi1kb3duJyA6ICdmYXMgZmEtY2hldnJvbi1yaWdodCc7DQogICAgICAgICAgICBjb25zdCBjb250ZW50U3R5bGUgPSBpc0V4cGFuZGVkID8gJycgOiAnIHN0eWxlPSJkaXNwbGF5OiBub25lOyInOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWhlYWRlciAke2hlYWRlckNsYXNzfSIgZGF0YS1zZWN0aW9uPSJpbnB1dC1jb25uZWN0aW9ucyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iJHtpY29uQ2xhc3N9Ij48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5JbnB1dCBDb25uZWN0aW9uczwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbCBjbGFzcz0iY29uZmlnLWNvdW50Ij4oJHtpbnB1dENvbm5lY3Rpb25zLmxlbmd0aH0pPC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWNvbnRlbnQiIGlkPSJpbnB1dC1jb25uZWN0aW9ucy1jb250ZW50IiR7Y29udGVudFN0eWxlfT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImlucHV0LW1hcHBpbmdzLWNvbmZpZyI+DQogICAgICAgICAgICBgOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm4gb2YgaW5wdXRDb25uZWN0aW9ucykgew0KICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZU5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uLmZyb20ubm9kZUlkKTsNCiAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2VOb2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKHNvdXJjZU5vZGU/LnR5cGUgfHwgJ3Vua25vd24nKTsNCiAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2VOb2RlTmFtZSA9IHNvdXJjZU5vZGVEZWY/Lm5hbWUgfHwgc291cmNlTm9kZT8udHlwZSB8fCAndW5rbm93bic7DQogICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRPdXRwdXQgPSBzb3VyY2VOb2RlRGVmPy5vdXRwdXRzPy5maW5kKG91dHB1dCA9PiBvdXRwdXQuaWQgPT09IGNvbm4uZnJvbS5wb3J0TmFtZSk7DQogICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0TmFtZSA9IHNlbGVjdGVkT3V0cHV0ID8gc2VsZWN0ZWRPdXRwdXQubmFtZSA6IGNvbm4uZnJvbS5wb3J0TmFtZTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBTaW1wbGU6IFNob3cgd2hhdCBJJ20gcmVjZWl2aW5nIGFuZCBsZXQgbWUgY2hvb3NlIG15IGlucHV0IHBvcnQNCiAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5wdXQtbWFwcGluZy1jb25maWciPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29ubmVjdGlvbi1oZWFkZXIiPkZyb20gJHtzb3VyY2VOb2RlTmFtZX0gKCR7b3V0cHV0TmFtZX0pPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25uZWN0aW9uLWNvbnRyb2xzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250cm9sLXJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5UbyBteSBpbnB1dDo8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPSJpbnB1dF90YXJnZXRfJHtub2RlSWR9fCR7Y29ubi50by5wb3J0TmFtZX0iIGNsYXNzPSJpbnB1dC10YXJnZXQtc2VsZWN0Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IiI+U2VsZWN0Li4uPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke25vZGVEZWYuaW5wdXRzLm1hcChpbnB1dCA9PiANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgPG9wdGlvbiB2YWx1ZT0iJHtpbnB1dC5pZH0iICR7Y29ubi50by5wb3J0TmFtZSA9PT0gaW5wdXQuaWQgPyAnc2VsZWN0ZWQnIDogJyd9PiR7aW5wdXQubmFtZX08L29wdGlvbj5gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmpvaW4oJycpfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFNob3cgb3V0cHV0IG1hcHBpbmdzIGNvbmZpZ3VyYXRpb24gKHdoYXQgb3RoZXIgbm9kZXMgcmVjZWl2ZSBmcm9tIHRoaXMgbm9kZSkNCiAgICAgICAgY29uc3Qgb3V0cHV0Q29ubmVjdGlvbnMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpDQogICAgICAgICAgICAuZmlsdGVyKGNvbm4gPT4gY29ubi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkKTsNCiAgICAgICAgDQogICAgICAgIGlmIChvdXRwdXRDb25uZWN0aW9ucy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gc2VjdGlvblN0YXRlc1snb3V0cHV0LWNvbm5lY3Rpb25zJ107DQogICAgICAgICAgICBjb25zdCBoZWFkZXJDbGFzcyA9IGlzRXhwYW5kZWQgPyAnJyA6ICdjb2xsYXBzZWQnOw0KICAgICAgICAgICAgY29uc3QgaWNvbkNsYXNzID0gaXNFeHBhbmRlZCA/ICdmYXMgZmEtY2hldnJvbi1kb3duJyA6ICdmYXMgZmEtY2hldnJvbi1yaWdodCc7DQogICAgICAgICAgICBjb25zdCBjb250ZW50U3R5bGUgPSBpc0V4cGFuZGVkID8gJycgOiAnIHN0eWxlPSJkaXNwbGF5OiBub25lOyInOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWhlYWRlciAke2hlYWRlckNsYXNzfSIgZGF0YS1zZWN0aW9uPSJvdXRwdXQtY29ubmVjdGlvbnMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9IiR7aWNvbkNsYXNzfSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+T3V0cHV0IENvbm5lY3Rpb25zPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsIGNsYXNzPSJjb25maWctY291bnQiPigke291dHB1dENvbm5lY3Rpb25zLmxlbmd0aH0pPC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWNvbnRlbnQiIGlkPSJvdXRwdXQtY29ubmVjdGlvbnMtY29udGVudCIke2NvbnRlbnRTdHlsZX0+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJvdXRwdXQtbWFwcGluZ3MtY29uZmlnIj4NCiAgICAgICAgICAgIGA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGZvciAoY29uc3QgY29ubiBvZiBvdXRwdXRDb25uZWN0aW9ucykgew0KICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uLnRvLm5vZGVJZCk7DQogICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Tm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZSh0YXJnZXROb2RlPy50eXBlIHx8ICd1bmtub3duJyk7DQogICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Tm9kZU5hbWUgPSB0YXJnZXROb2RlRGVmPy5uYW1lIHx8IHRhcmdldE5vZGU/LnR5cGUgfHwgJ3Vua25vd24nOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIEdldCBhdmFpbGFibGUgb3V0cHV0cyBmcm9tIFRISVMgbm9kZSAoc291cmNlIG5vZGUpDQogICAgICAgICAgICAgICAgY29uc3Qgc291cmNlTm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShub2RlLnR5cGUpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGF2YWlsYWJsZU91dHB1dHMgPSBzb3VyY2VOb2RlRGVmPy5vdXRwdXRzIHx8IFtdOw0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJvdXRwdXQtbWFwcGluZy1jb25maWciPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29ubmVjdGlvbi1oZWFkZXIiPlRvICR7dGFyZ2V0Tm9kZU5hbWV9PC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25uZWN0aW9uLWNvbnRyb2xzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250cm9sLXJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5TZW5kIG91dHB1dDo8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPSJvdXRwdXRfbWFwcGluZ18ke25vZGVJZH18JHtjb25uLmZyb20ucG9ydE5hbWV9fCR7Y29ubi50by5ub2RlSWR9IiBjbGFzcz0ib3V0cHV0LW1hcHBpbmctc2VsZWN0Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IiI+U2VsZWN0Li4uPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2F2YWlsYWJsZU91dHB1dHMubWFwKG91dHB1dCA9PiANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgPG9wdGlvbiB2YWx1ZT0iJHtvdXRwdXQuaWR9IiAke2Nvbm4uZnJvbS5wb3J0TmFtZSA9PT0gb3V0cHV0LmlkID8gJ3NlbGVjdGVkJyA6ICcnfT4ke291dHB1dC5uYW1lfTwvb3B0aW9uPmANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuam9pbignJyl9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gR2VuZXJhdGUgY29uZmlndXJhdGlvbiBmaWVsZHMgLSBncm91cGVkIGZvciBiZXR0ZXIgb3JnYW5pemF0aW9uDQogICAgICAgIGNvbnN0IGNvbmZpZ0VudHJpZXMgPSBPYmplY3QuZW50cmllcyhub2RlRGVmLmNvbmZpZyk7DQogICAgICAgIGlmIChjb25maWdFbnRyaWVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSBzZWN0aW9uU3RhdGVzWydub2RlLXNldHRpbmdzJ107DQogICAgICAgICAgICBjb25zdCBoZWFkZXJDbGFzcyA9IGlzRXhwYW5kZWQgPyAnJyA6ICdjb2xsYXBzZWQnOw0KICAgICAgICAgICAgY29uc3QgaWNvbkNsYXNzID0gaXNFeHBhbmRlZCA/ICdmYXMgZmEtY2hldnJvbi1kb3duJyA6ICdmYXMgZmEtY2hldnJvbi1yaWdodCc7DQogICAgICAgICAgICBjb25zdCBjb250ZW50U3R5bGUgPSBpc0V4cGFuZGVkID8gJycgOiAnIHN0eWxlPSJkaXNwbGF5OiBub25lOyInOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWhlYWRlciAke2hlYWRlckNsYXNzfSIgZGF0YS1zZWN0aW9uPSJub2RlLXNldHRpbmdzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSIke2ljb25DbGFzc30iPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPk5vZGUgU2V0dGluZ3M8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c21hbGwgY2xhc3M9ImNvbmZpZy1jb3VudCI+KCR7Y29uZmlnRW50cmllcy5sZW5ndGh9KTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbi1jb250ZW50IiBpZD0ibm9kZS1zZXR0aW5ncy1jb250ZW50IiR7Y29udGVudFN0eWxlfT4NCiAgICAgICAgICAgIGA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgY29uZmlnXSBvZiBjb25maWdFbnRyaWVzKSB7DQogICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJjb25maWdfJHtub2RlSWR9XyR7a2V5fSI+JHtjb25maWcubGFiZWx9PC9sYWJlbD4NCiAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChjb25maWcudHlwZSA9PT0gJ3NlbGVjdCcpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPHNlbGVjdCBpZD0iY29uZmlnXyR7bm9kZUlkfV8ke2tleX0iPmA7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBub2RlX3JlZmVyZW5jZSBub2RlDQogICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdub2RlX3JlZmVyZW5jZScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT09ICdzb3VyY2Vfbm9kZV9pZCcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQb3B1bGF0ZSB3aXRoIGFsbCBhdmFpbGFibGUgbm9kZXMgKGV4Y2x1ZGluZyB0aGlzIG5vZGUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3QgYSBub2RlLi4uPC9vcHRpb24+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFthdmFpbGFibGVOb2RlSWQsIGF2YWlsYWJsZU5vZGVdIG9mIGZsb3dFZGl0b3Iubm9kZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF2YWlsYWJsZU5vZGVJZCAhPT0gbm9kZUlkKSB7IC8vIERvbid0IGluY2x1ZGUgc2VsZg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXZhaWxhYmxlTm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShhdmFpbGFibGVOb2RlLnR5cGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZU5hbWUgPSBhdmFpbGFibGVOb2RlRGVmID8gYXZhaWxhYmxlTm9kZURlZi5uYW1lIDogYXZhaWxhYmxlTm9kZS50eXBlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBub2RlLmNvbmZpZ1trZXldLnZhbHVlID09PSBhdmFpbGFibGVOb2RlSWQgPyAnc2VsZWN0ZWQnIDogJyc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8b3B0aW9uIHZhbHVlPSIke2F2YWlsYWJsZU5vZGVJZH0iICR7c2VsZWN0ZWR9PiR7bm9kZU5hbWV9ICgke2F2YWlsYWJsZU5vZGVJZH0pPC9vcHRpb24+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSAnb3V0cHV0X3BvcnRfaWQnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUG9wdWxhdGUgd2l0aCBvdXRwdXQgcG9ydHMgb2YgdGhlIHNlbGVjdGVkIHNvdXJjZSBub2RlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3Qgb3V0cHV0IHBvcnQuLi48L29wdGlvbj5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkTm9kZUlkID0gbm9kZS5jb25maWcuc291cmNlX25vZGVfaWQudmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZUlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkTm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KHNlbGVjdGVkTm9kZUlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWROb2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKHNlbGVjdGVkTm9kZS50eXBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZE5vZGVEZWYgJiYgc2VsZWN0ZWROb2RlRGVmLm91dHB1dHMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG91dHB1dCBvZiBzZWxlY3RlZE5vZGVEZWYub3V0cHV0cykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZCA9IG5vZGUuY29uZmlnW2tleV0udmFsdWUgPT09IG91dHB1dC5pZCA/ICdzZWxlY3RlZCcgOiAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPG9wdGlvbiB2YWx1ZT0iJHtvdXRwdXQuaWR9IiAke3NlbGVjdGVkfT4ke291dHB1dC5uYW1lfSAoJHtvdXRwdXQudHlwZX0pPC9vcHRpb24+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlZ3VsYXIgc2VsZWN0IGZpZWxkDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLm9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZCA9IG5vZGUuY29uZmlnW2tleV0udmFsdWUgPT09IG9wdGlvbiA/ICdzZWxlY3RlZCcgOiAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPG9wdGlvbiB2YWx1ZT0iJHtvcHRpb259IiAke3NlbGVjdGVkfT4ke29wdGlvbn08L29wdGlvbj5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVndWxhciBzZWxlY3QgZmllbGQgZm9yIG90aGVyIG5vZGVzDQogICAgICAgICAgICAgICAgICAgICAgICBjb25maWcub3B0aW9ucy5mb3JFYWNoKG9wdGlvbiA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBub2RlLmNvbmZpZ1trZXldLnZhbHVlID09PSBvcHRpb24gPyAnc2VsZWN0ZWQnIDogJyc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPG9wdGlvbiB2YWx1ZT0iJHtvcHRpb259IiAke3NlbGVjdGVkfT4ke29wdGlvbn08L29wdGlvbj5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDwvc2VsZWN0PmA7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb25maWcudHlwZSA9PT0gJ3RleHRhcmVhJykgew0KICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8dGV4dGFyZWEgaWQ9ImNvbmZpZ18ke25vZGVJZH1fJHtrZXl9Ij4ke25vZGUuY29uZmlnW2tleV0udmFsdWV9PC90ZXh0YXJlYT5gOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnR5cGUgPT09ICdudW1iZXInKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbiA9IGNvbmZpZy5taW4gPyBgIG1pbj0iJHtjb25maWcubWlufSJgIDogJyc7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1heCA9IGNvbmZpZy5tYXggPyBgIG1heD0iJHtjb25maWcubWF4fSJgIDogJyc7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0ZXAgPSBjb25maWcuc3RlcCA/IGAgc3RlcD0iJHtjb25maWcuc3RlcH0iYCA6ICcnOw0KICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8aW5wdXQgdHlwZT0ibnVtYmVyIiBpZD0iY29uZmlnXyR7bm9kZUlkfV8ke2tleX0iIHZhbHVlPSIke25vZGUuY29uZmlnW2tleV0udmFsdWV9IiR7bWlufSR7bWF4fSR7c3RlcH0+YDsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBmaWVsZCBzaG91bGQgYmUgZW5jcnlwdGVkIChwYXNzd29yZCBtYXNrZWQpDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0VHlwZSA9IGNvbmZpZy5lbmNyeXB0ID09PSB0cnVlID8gJ3Bhc3N3b3JkJyA6IGNvbmZpZy50eXBlOw0KICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8aW5wdXQgdHlwZT0iJHtpbnB1dFR5cGV9IiBpZD0iY29uZmlnXyR7bm9kZUlkfV8ke2tleX0iIHZhbHVlPSIke25vZGUuY29uZmlnW2tleV0udmFsdWV9Ij5gOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8L2Rpdj5gOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBTaG93IG91dHB1dCBkYXRhIGZvciBhbGwgcG9ydHMgKGlmIG5vZGUgaGFzIGJlZW4gZXhlY3V0ZWQpIC0gYXQgdGhlIGJvdHRvbQ0KICAgICAgICBpZiAobm9kZS5sYXN0T3V0cHV0RGF0YSAmJiBub2RlLmxhc3RFeGVjdXRpb25UaW1lKSB7DQogICAgICAgICAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgICAgICAgICBjb25zdCBvdXRwdXRzID0gbm9kZURlZi5vdXRwdXRzIHx8IFtdOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAob3V0cHV0cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9IHNlY3Rpb25TdGF0ZXNbJ291dHB1dC1kYXRhJ107DQogICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyQ2xhc3MgPSBpc0V4cGFuZGVkID8gJycgOiAnY29sbGFwc2VkJzsNCiAgICAgICAgICAgICAgICBjb25zdCBpY29uQ2xhc3MgPSBpc0V4cGFuZGVkID8gJ2ZhcyBmYS1jaGV2cm9uLWRvd24nIDogJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50U3R5bGUgPSBpc0V4cGFuZGVkID8gJycgOiAnIHN0eWxlPSJkaXNwbGF5OiBub25lOyInOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbi1oZWFkZXIgJHtoZWFkZXJDbGFzc30iIGRhdGEtc2VjdGlvbj0ib3V0cHV0LWRhdGEiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSIke2ljb25DbGFzc30iPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5PdXRwdXQgRGF0YTwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGwgY2xhc3M9ImNvbmZpZy1jb3VudCI+KCR7b3V0cHV0cy5sZW5ndGh9IHBvcnRzKTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWNvbnRlbnQiIGlkPSJvdXRwdXQtZGF0YS1jb250ZW50IiR7Y29udGVudFN0eWxlfT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDEycHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgbWFyZ2luLWJvdHRvbTogOHB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExhc3QgZXhlY3V0ZWQ6ICR7bmV3IERhdGUobm9kZS5sYXN0RXhlY3V0aW9uVGltZSkudG9Mb2NhbGVTdHJpbmcoKX0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgb3V0cHV0IG9mIG91dHB1dHMpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0RGF0YSA9IGdldE91dHB1dFBvcnREYXRhKG5vZGUuaWQsIG91dHB1dC5pZCk7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdERhdGFQcmV2aWV3KG91dHB1dERhdGEpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50LWRpc3BsYXkiIHN0eWxlPSJtYXJnaW4tYm90dG9tOiA4cHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXdlaWdodDogNTAwOyBtYXJnaW4tYm90dG9tOiA2cHg7IGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsgZm9udC1zaXplOiAxM3B4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7b3V0cHV0Lm5hbWV9IDxzcGFuIHN0eWxlPSJjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtd2VpZ2h0OiBub3JtYWw7IGZvbnQtc2l6ZTogMTFweDsiPigke2Zvcm1hdHRlZC50eXBlfSk8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHByZSBjbGFzcz0iY29udGVudC10ZXh0IiBzdHlsZT0ibWFyZ2luLWJvdHRvbTogNHB4OyBtYXgtaGVpZ2h0OiA4MHB4OyI+JHtlc2NhcGVIdG1sKGZvcm1hdHRlZC5wcmV2aWV3KX08L3ByZT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2Zvcm1hdHRlZC5sZW5ndGggIT09IHVuZGVmaW5lZCA/IGA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDExcHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsiPkxlbmd0aDogJHtmb3JtYXR0ZWQubGVuZ3RofTwvZGl2PmAgOiAnJ30NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2Zvcm1hdHRlZC5rZXlzICE9PSB1bmRlZmluZWQgPyBgPGRpdiBzdHlsZT0iZm9udC1zaXplOiAxMXB4OyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7Ij5LZXlzOiAke2Zvcm1hdHRlZC5rZXlzfTwvZGl2PmAgOiAnJ30NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2Zvcm1hdHRlZC5zaXplICE9PSB1bmRlZmluZWQgPyBgPGRpdiBzdHlsZT0iZm9udC1zaXplOiAxMXB4OyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7Ij5TaXplOiAkeyhmb3JtYXR0ZWQuc2l6ZSAvIDEwMjQpLnRvRml4ZWQoMil9IEtCPC9kaXY+YCA6ICcnfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7Zm9ybWF0dGVkLmVzdGltYXRlZFNpemUgIT09IHVuZGVmaW5lZCA/IGA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDExcHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsiPkVzdC4gU2l6ZTogJHsoZm9ybWF0dGVkLmVzdGltYXRlZFNpemUgLyAxMDI0KS50b0ZpeGVkKDIpfSBLQjwvZGl2PmAgOiAnJ30NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25maWdQYW5lbC5pbm5lckhUTUwgPSBjb25maWdIdG1sOw0KICAgICAgICANCiAgICAgICAgLy8gQWRkIGV2ZW50IGxpc3RlbmVycyBmb3IgbWFwcGluZyBzZWxlY3RzDQogICAgICAgIC8vIE5vIGlucHV0IG1hcHBpbmcgc2VsZWN0cyBhbnltb3JlIC0gbm9kZXMgY2FuJ3QgY29udHJvbCB3aGF0IHRoZXkgcmVjZWl2ZQ0KICAgICAgICANCiAgICAgICAgY29uc3QgaW5wdXRUYXJnZXRTZWxlY3RzID0gY29uZmlnUGFuZWwucXVlcnlTZWxlY3RvckFsbCgnLmlucHV0LXRhcmdldC1zZWxlY3QnKTsNCiAgICAgICAgaW5wdXRUYXJnZXRTZWxlY3RzLmZvckVhY2goc2VsZWN0ID0+IHsNCiAgICAgICAgICAgIHNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IFtub2RlSWQsIGN1cnJlbnRJbnB1dFBvcnRdID0gZS50YXJnZXQuaWQucmVwbGFjZSgnaW5wdXRfdGFyZ2V0XycsICcnKS5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkSW5wdXRQb3J0ID0gZS50YXJnZXQudmFsdWU7DQogICAgICAgICAgICAgICAgLy8gRmluZCB0aGUgY29ubmVjdGlvbg0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLmZpbmQoY29ubiA9Pg0KICAgICAgICAgICAgICAgICAgICBjb25uLnRvLm5vZGVJZCA9PT0gbm9kZUlkICYmIGNvbm4udG8ucG9ydE5hbWUgPT09IGN1cnJlbnRJbnB1dFBvcnQNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uICYmIHNlbGVjdGVkSW5wdXRQb3J0KSB7DQogICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBhbGwgY29ubmVjdGlvbnMgZnJvbSB0aGUgc2FtZSBmcm9tTm9kZSB0byB0aGlzIG5vZGUgKHJlZ2FyZGxlc3Mgb2YgcG9ydCkNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbnNUb1JlbW92ZSA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkuZmlsdGVyKGNvbm4gPT4NCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbm4uZnJvbS5ub2RlSWQgPT09IGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgJiYgY29ubi50by5ub2RlSWQgPT09IG5vZGVJZA0KICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICBjb25uZWN0aW9uc1RvUmVtb3ZlLmZvckVhY2goY29ubiA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmRlbGV0ZShjb25uLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25uLnN2ZykgY29ubi5zdmcucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIG5ldyBjb25uZWN0aW9uDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0Nvbm5lY3Rpb25JZCA9IGBjb25uXyR7Y29ubmVjdGlvbi5mcm9tLm5vZGVJZH1fJHtjb25uZWN0aW9uLmZyb20ucG9ydE5hbWV9XyR7bm9kZUlkfV8ke3NlbGVjdGVkSW5wdXRQb3J0fWA7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0Nvbm5lY3Rpb24gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZDogbmV3Q29ubmVjdGlvbklkLA0KICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogeyBub2RlSWQ6IGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQsIHBvcnROYW1lOiBjb25uZWN0aW9uLmZyb20ucG9ydE5hbWUgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvOiB7IG5vZGVJZDogbm9kZUlkLCBwb3J0TmFtZTogc2VsZWN0ZWRJbnB1dFBvcnQgfQ0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnNldChuZXdDb25uZWN0aW9uSWQsIG5ld0Nvbm5lY3Rpb24pOw0KICAgICAgICAgICAgICAgICAgICBkcmF3Q29ubmVjdGlvbihuZXdDb25uZWN0aW9uKTsNCiAgICAgICAgICAgICAgICAgICAgLy8gQXV0by1zYXZlDQogICAgICAgICAgICAgICAgICAgIGlmIChzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuc2F2ZUZsb3cpIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5zYXZlRmxvdygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IG91dHB1dE1hcHBpbmdTZWxlY3RzID0gY29uZmlnUGFuZWwucXVlcnlTZWxlY3RvckFsbCgnLm91dHB1dC1tYXBwaW5nLXNlbGVjdCcpOw0KICAgICAgICBvdXRwdXRNYXBwaW5nU2VsZWN0cy5mb3JFYWNoKHNlbGVjdCA9PiB7DQogICAgICAgICAgICBzZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IGUudGFyZ2V0LmlkLnJlcGxhY2UoJ291dHB1dF9tYXBwaW5nXycsICcnKS5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IHBhcnRzWzBdOw0KICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dFBvcnQgPSBwYXJ0c1sxXTsNCiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlSWQgPSBwYXJ0c1syXTsNCiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZE91dHB1dFBvcnQgPSBlLnRhcmdldC52YWx1ZTsNCiAgICAgICAgICAgICAgICB1cGRhdGVPdXRwdXRNYXBwaW5nKG5vZGVJZCwgb3V0cHV0UG9ydCwgdGFyZ2V0Tm9kZUlkLCBzZWxlY3RlZE91dHB1dFBvcnQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgLy8gQWRkIGV2ZW50IGxpc3RlbmVycyBmb3Igc3BlY2lhbCBidXR0b25zDQogICAgICAgIGNvbnN0IHZpZXdGdWxsSW1hZ2VCdG4gPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yKCcudmlldy1mdWxsLWltYWdlLWJ0bicpOw0KICAgICAgICBpZiAodmlld0Z1bGxJbWFnZUJ0bikgew0KICAgICAgICAgICAgdmlld0Z1bGxJbWFnZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW5vZGUtaWQnKTsNCiAgICAgICAgICAgICAgICBzaG93RnVsbEltYWdlKG5vZGVJZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgY29uc3QgcGxheUF1ZGlvQnRuID0gY29uZmlnUGFuZWwucXVlcnlTZWxlY3RvcignLnBsYXktYXVkaW8tYnRuJyk7DQogICAgICAgIGlmIChwbGF5QXVkaW9CdG4pIHsNCiAgICAgICAgICAgIHBsYXlBdWRpb0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW5vZGUtaWQnKTsNCiAgICAgICAgICAgICAgICBwbGF5QXVkaW8obm9kZUlkKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25zdCBzdG9wQXVkaW9CdG4gPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yKCcuc3RvcC1hdWRpby1idG4nKTsNCiAgICAgICAgaWYgKHN0b3BBdWRpb0J0bikgew0KICAgICAgICAgICAgc3RvcEF1ZGlvQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS1pZCcpOw0KICAgICAgICAgICAgICAgIHN0b3BBdWRpbyhub2RlSWQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHN0YXJ0UmVwZWF0ZXJCdG4gPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yKCcuc3RhcnQtcmVwZWF0ZXItYnRuJyk7DQogICAgICAgIGlmIChzdGFydFJlcGVhdGVyQnRuKSB7DQogICAgICAgICAgICBzdGFydFJlcGVhdGVyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS1pZCcpOw0KICAgICAgICAgICAgICAgIHN0YXJ0UmVwZWF0ZXIobm9kZUlkKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25zdCBzdG9wUmVwZWF0ZXJCdG4gPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yKCcuc3RvcC1yZXBlYXRlci1idG4nKTsNCiAgICAgICAgaWYgKHN0b3BSZXBlYXRlckJ0bikgew0KICAgICAgICAgICAgc3RvcFJlcGVhdGVyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS1pZCcpOw0KICAgICAgICAgICAgICAgIHN0b3BSZXBlYXRlcihub2RlSWQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBjaGFuZ2UgbGlzdGVuZXJzDQogICAgICAgIGZvciAoY29uc3QgW2tleSwgY29uZmlnXSBvZiBPYmplY3QuZW50cmllcyhub2RlRGVmLmNvbmZpZykpIHsNCiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgY29uZmlnXyR7bm9kZUlkfV8ke2tleX1gKTsNCiAgICAgICAgICAgIGlmIChlbGVtZW50KSB7DQogICAgICAgICAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgICAgICBub2RlLmNvbmZpZ1trZXldLnZhbHVlID0gZS50YXJnZXQudmFsdWU7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBkaXNwbGF5IG5vZGUgZm9ybWF0IGNoYW5nZXMNCiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ2Rpc3BsYXknICYmIGtleSA9PT0gJ2Zvcm1hdCcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgZGlzcGxheS1mb3JtYXQtJHtub2RlSWR9YCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybWF0RWxlbWVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdEVsZW1lbnQudGV4dENvbnRlbnQgPSBlLnRhcmdldC52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3Igbm9kZV9yZWZlcmVuY2Ugc291cmNlIG5vZGUgY2hhbmdlcw0KICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnbm9kZV9yZWZlcmVuY2UnICYmIGtleSA9PT0gJ3NvdXJjZV9ub2RlX2lkJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBvdXRwdXQgcG9ydCBkcm9wZG93biB3aGVuIHNvdXJjZSBub2RlIGNoYW5nZXMNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dFBvcnRTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgY29uZmlnXyR7bm9kZUlkfV9vdXRwdXRfcG9ydF9pZGApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG91dHB1dFBvcnRTZWxlY3QpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDbGVhciBhbmQgcmVwb3B1bGF0ZSBvdXRwdXQgcG9ydCBvcHRpb25zDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0UG9ydFNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3Qgb3V0cHV0IHBvcnQuLi48L29wdGlvbj4nOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkTm9kZUlkID0gZS50YXJnZXQudmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZUlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkTm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KHNlbGVjdGVkTm9kZUlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWROb2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKHNlbGVjdGVkTm9kZS50eXBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZE5vZGVEZWYgJiYgc2VsZWN0ZWROb2RlRGVmLm91dHB1dHMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG91dHB1dCBvZiBzZWxlY3RlZE5vZGVEZWYub3V0cHV0cykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uLnZhbHVlID0gb3V0cHV0LmlkOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb24udGV4dENvbnRlbnQgPSBgJHtvdXRwdXQubmFtZX0gKCR7b3V0cHV0LnR5cGV9KWA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFBvcnRTZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVzZXQgdGhlIG91dHB1dCBwb3J0IHZhbHVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5jb25maWcub3V0cHV0X3BvcnRfaWQudmFsdWUgPSAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBBZGQgY29sbGFwc2libGUgc2VjdGlvbiBmdW5jdGlvbmFsaXR5IHdpdGggcGVyc2lzdGVuY2UNCiAgICAgICAgY29uc3Qgc2VjdGlvbkhlYWRlcnMgPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcuY29uZmlnLXNlY3Rpb24taGVhZGVyJyk7DQogICAgICAgIHNlY3Rpb25IZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IHsNCiAgICAgICAgICAgIGhlYWRlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7DQogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb25JZCA9IGhlYWRlci5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2VjdGlvbicpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHtzZWN0aW9uSWR9LWNvbnRlbnRgKTsNCiAgICAgICAgICAgICAgICBjb25zdCBpY29uID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJ2knKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAoY29udGVudCAmJiBpY29uKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQ29sbGFwc2VkID0gaGVhZGVyLmNsYXNzTGlzdC5jb250YWlucygnY29sbGFwc2VkJyk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAoaXNDb2xsYXBzZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEV4cGFuZA0KICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2NvbGxhcHNlZCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudC5zdHlsZS5kaXNwbGF5ID0gJyc7DQogICAgICAgICAgICAgICAgICAgICAgICBpY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1kb3duJzsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbGxhcHNlDQogICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXIuY2xhc3NMaXN0LmFkZCgnY29sbGFwc2VkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgICAgICAgICBpY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1yaWdodCc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIFNhdmUgdGhlIHN0YXRlIHRvIGFwcCBzZXR0aW5ncyAodHJ1ZSA9IGV4cGFuZGVkLCBmYWxzZSA9IGNvbGxhcHNlZCkNCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuc2V0U2V0dGluZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSAhaGVhZGVyLmNsYXNzTGlzdC5jb250YWlucygnY29sbGFwc2VkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc3lwbmV4QVBJLnNldFNldHRpbmcoYGNvbmZpZ19zZWN0aW9uXyR7c2VjdGlvbklkfWAsIGlzRXhwYW5kZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gc2F2ZSBjb25maWcgc2VjdGlvbiBzdGF0ZTonLCBlcnJvcik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgfQ0KfQ0KDQovLyBub2RlLXJlbmRlcmVyLmpzIC0gRHluYW1pYyBub2RlIHJlbmRlcmluZyBmb3IgRmxvdyBFZGl0b3INCg0KY2xhc3MgTm9kZVJlbmRlcmVyIHsNCiAgICBjb25zdHJ1Y3RvcigpIHsNCiAgICAgICAgdGhpcy50ZW1wbGF0ZXMgPSBuZXcgTWFwKCk7DQogICAgICAgIHRoaXMuc2V0dXBTdGFuZGFyZFRlbXBsYXRlKCk7DQogICAgfQ0KICAgIA0KICAgIHNldHVwU3RhbmRhcmRUZW1wbGF0ZSgpIHsNCiAgICAgICAgdGhpcy50ZW1wbGF0ZXMuc2V0KCdzdGFuZGFyZCcsIHsNCiAgICAgICAgICAgIHJlbmRlcjogKG5vZGUsIG5vZGVEZWYpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dHMgPSBub2RlRGVmLmlucHV0cyB8fCBbXTsNCiAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXRzID0gbm9kZURlZi5vdXRwdXRzIHx8IFtdOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIHJldHVybiBgDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsb3ctbm9kZS1oZWFkZXIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9IiR7bm9kZURlZi5pY29ufSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+JHtub2RlRGVmLm5hbWV9PC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9ImZsb3ctbm9kZS10eXBlICR7bm9kZS50eXBlfSI+JHtub2RlLnR5cGUudG9VcHBlckNhc2UoKX08L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJub2RlLWRlbGV0ZS1idG4iIHRpdGxlPSJEZWxldGUgbm9kZSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS10aW1lcyI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LW5vZGUtY29udGVudCI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJub2RlLWRlZmF1bHQtY29udGVudCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsIGNsYXNzPSJ0ZXh0LW11dGVkIj4ke25vZGVEZWYuZGVzY3JpcHRpb259PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmxvdy1ub2RlLXBvcnRzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICR7aW5wdXRzLm1hcChpbnB1dCA9PiANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgPGRpdiBjbGFzcz0iZmxvdy1ub2RlLXBvcnQgaW5wdXQiIGRhdGEtcG9ydD0iJHtpbnB1dC5pZH0iPjwvZGl2PmANCiAgICAgICAgICAgICAgICAgICAgICAgICkuam9pbignJyl9DQogICAgICAgICAgICAgICAgICAgICAgICAke291dHB1dHMubWFwKG91dHB1dCA9PiANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgPGRpdiBjbGFzcz0iZmxvdy1ub2RlLXBvcnQgb3V0cHV0IiBkYXRhLXBvcnQ9IiR7b3V0cHV0LmlkfSI+PC9kaXY+YA0KICAgICAgICAgICAgICAgICAgICAgICAgKS5qb2luKCcnKX0NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfQ0KICAgIA0KICAgIHJlZ2lzdGVyVGVtcGxhdGUobmFtZSwgdGVtcGxhdGUpIHsNCiAgICAgICAgdGhpcy50ZW1wbGF0ZXMuc2V0KG5hbWUsIHRlbXBsYXRlKTsNCiAgICB9DQogICAgDQogICAgcmVuZGVyTm9kZShub2RlKSB7DQogICAgICAgIGNvbnN0IG5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICAgICAgaWYgKCFub2RlRGVmKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKGBObyBub2RlIGRlZmluaXRpb24gZm91bmQgZm9yIHR5cGU6ICR7bm9kZS50eXBlfWApOw0KICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25zdCB0ZW1wbGF0ZU5hbWUgPSBub2RlRGVmLnRlbXBsYXRlIHx8ICdzdGFuZGFyZCc7DQogICAgICAgIGNvbnN0IHRlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZXMuZ2V0KHRlbXBsYXRlTmFtZSk7DQogICAgICAgIA0KICAgICAgICBpZiAoIXRlbXBsYXRlKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKGBObyB0ZW1wbGF0ZSBmb3VuZDogJHt0ZW1wbGF0ZU5hbWV9YCk7DQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHJldHVybiB0ZW1wbGF0ZS5yZW5kZXIobm9kZSwgbm9kZURlZik7DQogICAgfQ0KICAgIA0KICAgIGNyZWF0ZU5vZGVFbGVtZW50KG5vZGUpIHsNCiAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NOYW1lID0gYGZsb3ctbm9kZSAke25vZGUudHlwZX0tbm9kZWA7DQogICAgICAgIG5vZGVFbGVtZW50LmlkID0gbm9kZS5pZDsNCiAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUubGVmdCA9IG5vZGUueCArICdweCc7DQogICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLnRvcCA9IG5vZGUueSArICdweCc7DQogICAgICAgIA0KICAgICAgICAvLyBSZW5kZXIgdGhlIG5vZGUgY29udGVudA0KICAgICAgICBub2RlRWxlbWVudC5pbm5lckhUTUwgPSB0aGlzLnJlbmRlck5vZGUobm9kZSk7DQogICAgICAgIA0KICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzIGFuZCBnZXQgdGhlIHVwZGF0ZWQgZWxlbWVudA0KICAgICAgICBjb25zdCBmaW5hbEVsZW1lbnQgPSB0aGlzLmFkZE5vZGVFdmVudExpc3RlbmVycyhub2RlRWxlbWVudCwgbm9kZSk7DQogICAgICAgIA0KICAgICAgICByZXR1cm4gZmluYWxFbGVtZW50Ow0KICAgIH0NCiAgICANCiAgICBhZGROb2RlRXZlbnRMaXN0ZW5lcnMobm9kZUVsZW1lbnQsIG5vZGUpIHsNCiAgICAgICAgLy8gRGVsZXRlIGJ1dHRvbg0KICAgICAgICBjb25zdCBkZWxldGVCdG4gPSBub2RlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubm9kZS1kZWxldGUtYnRuJyk7DQogICAgICAgIGlmIChkZWxldGVCdG4pIHsNCiAgICAgICAgICAgIGRlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgICAgICBkZWxldGVOb2RlKG5vZGUuaWQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIE5vZGUgc2VsZWN0aW9uDQogICAgICAgIG5vZGVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KCcubm9kZS1kZWxldGUtYnRuJykpIHJldHVybjsNCiAgICAgICAgICAgIHNlbGVjdE5vZGUobm9kZS5pZCk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgLy8gTm9kZSBkcmFnZ2luZw0KICAgICAgICBub2RlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZSkgPT4gew0KICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy5ub2RlLWRlbGV0ZS1idG4nKSkgcmV0dXJuOw0KICAgICAgICAgICAgc3RhcnREcmFnZ2luZ05vZGUobm9kZS5pZCwgZSk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgLy8gUG9ydCBjb25uZWN0aW9ucw0KICAgICAgICBjb25zdCBwb3J0cyA9IG5vZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mbG93LW5vZGUtcG9ydCcpOw0KICAgICAgICBwb3J0cy5mb3JFYWNoKHBvcnQgPT4gew0KICAgICAgICAgICAgcG9ydC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICAgICAgc3RhcnRDb25uZWN0aW9uKG5vZGUuaWQsIHBvcnQuZGF0YXNldC5wb3J0LCBwb3J0LmNsYXNzTGlzdC5jb250YWlucygnb3V0cHV0JykpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIG5vZGVFbGVtZW50Ow0KICAgIH0NCn0NCg0KLy8gR2xvYmFsIG5vZGUgcmVuZGVyZXIgaW5zdGFuY2UNCmNvbnN0IG5vZGVSZW5kZXJlciA9IG5ldyBOb2RlUmVuZGVyZXIoKTsNCg0KDQovLyBUZXh0IE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVUZXh0Tm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCB0ZXh0Q29udGVudCA9IG5vZGUuY29uZmlnLnRleHRfY29udGVudC52YWx1ZTsNCg0KICAgIHJldHVybiB7IHRleHQ6IHRleHRDb250ZW50IH07DQp9DQoNCg0KLy8gSlNPTiBFeHRyYWN0IE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVKc29uRXh0cmFjdE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgZmllbGRQYXRoID0gbm9kZS5jb25maWcuZmllbGRfcGF0aC52YWx1ZTsNCiAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBub2RlLmNvbmZpZy5kZWZhdWx0X3ZhbHVlPy52YWx1ZSB8fCAnJzsNCg0KICAgIC8vIEFjY2VwdCBhbnkgaW5wdXQgZGF0YSwgbm90IGp1c3QganNvbl9kYXRhDQogICAgbGV0IGpzb25EYXRhID0gbnVsbDsNCg0KICAgIC8vIFRyeSB0byBmaW5kIEpTT04gZGF0YSBmcm9tIGFueSBpbnB1dA0KICAgIGlmIChpbnB1dERhdGEuanNvbl9kYXRhKSB7DQogICAgICAgIGpzb25EYXRhID0gaW5wdXREYXRhLmpzb25fZGF0YTsNCiAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS5kYXRhKSB7DQogICAgICAgIGpzb25EYXRhID0gaW5wdXREYXRhLmRhdGE7DQogICAgfSBlbHNlIGlmIChpbnB1dERhdGEudGV4dCkgew0KICAgICAgICBqc29uRGF0YSA9IGlucHV0RGF0YS50ZXh0Ow0KICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLnJlc3BvbnNlKSB7DQogICAgICAgIGpzb25EYXRhID0gaW5wdXREYXRhLnJlc3BvbnNlOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIFVzZSB0aGUgZmlyc3QgYXZhaWxhYmxlIGlucHV0DQogICAgICAgIGNvbnN0IGZpcnN0SW5wdXQgPSBPYmplY3QudmFsdWVzKGlucHV0RGF0YSlbMF07DQogICAgICAgIGpzb25EYXRhID0gZmlyc3RJbnB1dDsNCiAgICB9DQoNCg0KICAgIGxldCBleHRyYWN0ZWRWYWx1ZSA9IG51bGw7DQoNCiAgICB0cnkgew0KICAgICAgICAvLyBQYXJzZSBKU09OIGlmIGl0J3MgYSBzdHJpbmcNCiAgICAgICAgaWYgKHR5cGVvZiBqc29uRGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIGpzb25EYXRhID0gSlNPTi5wYXJzZShqc29uRGF0YSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBFeHRyYWN0IHZhbHVlIHVzaW5nIGRvdCBub3RhdGlvbg0KICAgICAgICBleHRyYWN0ZWRWYWx1ZSA9IHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVXRpbHMuZXh0cmFjdE5lc3RlZFZhbHVlKGpzb25EYXRhLCBmaWVsZFBhdGgpOw0KDQogICAgICAgIC8vIFVzZSBkZWZhdWx0IHZhbHVlIGlmIGV4dHJhY3Rpb24gZmFpbGVkDQogICAgICAgIGlmIChleHRyYWN0ZWRWYWx1ZSA9PT0gbnVsbCB8fCBleHRyYWN0ZWRWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBleHRyYWN0ZWRWYWx1ZSA9IGRlZmF1bHRWYWx1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEZvcm1hdCB0aGUgb3V0cHV0IGFzIHN0cmluZyBmb3IgY29uc2lzdGVuY3kNCiAgICAgICAgbGV0IGZvcm1hdHRlZFZhbHVlID0gU3RyaW5nKGV4dHJhY3RlZFZhbHVlKTsNCg0KICAgICAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgbm9kZS5sYXN0RXh0cmFjdGVkVmFsdWUgPSBmb3JtYXR0ZWRWYWx1ZTsNCiAgICAgICAgbm9kZS5sYXN0RmllbGRQYXRoID0gZmllbGRQYXRoOw0KDQogICAgICAgIC8vIERlYnVnIGxvZ2dpbmcNCg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgZGF0YTogZm9ybWF0dGVkVmFsdWUsDQogICAgICAgICAgICB0ZXh0OiBmb3JtYXR0ZWRWYWx1ZSwNCiAgICAgICAgICAgIGpzb246IGV4dHJhY3RlZFZhbHVlLA0KICAgICAgICAgICAgZXh0cmFjdGVkX3ZhbHVlOiBmb3JtYXR0ZWRWYWx1ZSwNCiAgICAgICAgICAgIGZpZWxkX3BhdGg6IGZpZWxkUGF0aCwNCiAgICAgICAgICAgIG9yaWdpbmFsOiBqc29uRGF0YQ0KICAgICAgICB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04gRXh0cmFjdCBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkYXRhOiBkZWZhdWx0VmFsdWUsDQogICAgICAgICAgICB0ZXh0OiBkZWZhdWx0VmFsdWUsDQogICAgICAgICAgICBqc29uOiBudWxsLA0KICAgICAgICAgICAgZXh0cmFjdGVkX3ZhbHVlOiBkZWZhdWx0VmFsdWUsDQogICAgICAgICAgICBmaWVsZF9wYXRoOiBmaWVsZFBhdGgsDQogICAgICAgICAgICBvcmlnaW5hbDoganNvbkRhdGEsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KDQovLyBSYW5kb20gTGluZSBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlUmFuZG9tUXVvdGVOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IHNraXBFbXB0eSA9IG5vZGUuY29uZmlnLnNraXBfZW1wdHkudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCB0cmltV2hpdGVzcGFjZSA9IG5vZGUuY29uZmlnLnRyaW1fd2hpdGVzcGFjZS52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IG1heExlbmd0aCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLm1heF9sZW5ndGgudmFsdWUpOw0KDQoNCiAgICBsZXQgdGV4dCA9IGlucHV0RGF0YS50ZXh0Ow0KICAgIGlmICh0eXBlb2YgdGV4dCAhPT0gJ3N0cmluZycpIHsNCiAgICAgICAgdGV4dCA9IEpTT04uc3RyaW5naWZ5KHRleHQpOw0KICAgIH0NCg0KDQogICAgY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KCdcbicpOw0KDQogICAgbGV0IHZhbGlkTGluZXMgPSBsaW5lczsNCg0KICAgIGlmIChza2lwRW1wdHkpIHsNCiAgICAgICAgdmFsaWRMaW5lcyA9IGxpbmVzLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpLmxlbmd0aCA+IDApOw0KICAgIH0NCg0KICAgIGlmICh0cmltV2hpdGVzcGFjZSkgew0KICAgICAgICB2YWxpZExpbmVzID0gdmFsaWRMaW5lcy5tYXAobGluZSA9PiBsaW5lLnRyaW0oKSk7DQogICAgfQ0KDQogICAgaWYgKHZhbGlkTGluZXMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIHJldHVybiB7IHJhbmRvbV9saW5lOiBudWxsLCBsaW5lX251bWJlcjogMCwgdG90YWxfbGluZXM6IDAgfTsNCiAgICB9DQoNCiAgICBjb25zdCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHZhbGlkTGluZXMubGVuZ3RoKTsNCiAgICBsZXQgcmFuZG9tTGluZSA9IHZhbGlkTGluZXNbcmFuZG9tSW5kZXhdOw0KDQoNCiAgICBpZiAobWF4TGVuZ3RoID4gMCAmJiByYW5kb21MaW5lLmxlbmd0aCA+IG1heExlbmd0aCkgew0KICAgICAgICByYW5kb21MaW5lID0gcmFuZG9tTGluZS5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKSArICcuLi4nOw0KICAgIH0NCg0KICAgIGNvbnN0IHJlc3VsdCA9IHsNCiAgICAgICAgcmFuZG9tX2xpbmU6IHJhbmRvbUxpbmUsDQogICAgICAgIGxpbmVfbnVtYmVyOiByYW5kb21JbmRleCArIDEsDQogICAgICAgIHRvdGFsX2xpbmVzOiB2YWxpZExpbmVzLmxlbmd0aA0KICAgIH07DQoNCiAgICByZXR1cm4gcmVzdWx0Ow0KfQ0KDQovLyBNYXRoIE9wZXJhdGlvbnMgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZU1hdGhOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IG9wZXJhdGlvbiA9IG5vZGUuY29uZmlnLm9wZXJhdGlvbi52YWx1ZTsNCiAgICBjb25zdCBjb25maWdWYWx1ZUEgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLnZhbHVlX2EudmFsdWUpIHx8IDA7DQogICAgY29uc3QgY29uZmlnVmFsdWVCID0gcGFyc2VGbG9hdChub2RlLmNvbmZpZy52YWx1ZV9iLnZhbHVlKSB8fCAwOw0KICAgIGxldCBkZWNpbWFsUGxhY2VzID0gcGFyc2VJbnQobm9kZS5jb25maWcuZGVjaW1hbF9wbGFjZXMudmFsdWUpOw0KICAgIGlmIChpc05hTihkZWNpbWFsUGxhY2VzKSkgZGVjaW1hbFBsYWNlcyA9IDA7IC8vIERlZmF1bHQgdG8gMCBpZiBub3QgYSBudW1iZXINCg0KICAgIC8vIEdldCB2YWx1ZXMgZnJvbSBpbnB1dHMgb3IgY29uZmlnDQogICAgbGV0IHZhbHVlQSA9IGlucHV0RGF0YS52YWx1ZV9hICE9PSB1bmRlZmluZWQgPyBpbnB1dERhdGEudmFsdWVfYSA6IA0KICAgICAgICAgICAgICAgICBpbnB1dERhdGEubnVtYmVyX2EgIT09IHVuZGVmaW5lZCA/IGlucHV0RGF0YS5udW1iZXJfYSA6IGNvbmZpZ1ZhbHVlQTsNCiAgICBsZXQgdmFsdWVCID0gaW5wdXREYXRhLnZhbHVlX2IgIT09IHVuZGVmaW5lZCA/IGlucHV0RGF0YS52YWx1ZV9iIDogDQogICAgICAgICAgICAgICAgIGlucHV0RGF0YS5udW1iZXJfYiAhPT0gdW5kZWZpbmVkID8gaW5wdXREYXRhLm51bWJlcl9iIDogY29uZmlnVmFsdWVCOw0KDQogICAgLy8gQ29udmVydCB0byBudW1iZXJzDQogICAgaWYgKHR5cGVvZiB2YWx1ZUEgPT09ICdzdHJpbmcnKSB2YWx1ZUEgPSBwYXJzZUZsb2F0KHZhbHVlQSkgfHwgMDsNCiAgICBpZiAodHlwZW9mIHZhbHVlQiA9PT0gJ3N0cmluZycpIHZhbHVlQiA9IHBhcnNlRmxvYXQodmFsdWVCKSB8fCAwOw0KICAgIGlmICh0eXBlb2YgdmFsdWVBID09PSAnb2JqZWN0JyAmJiB2YWx1ZUEgIT09IG51bGwpIHsNCiAgICAgICAgLy8gVHJ5IHRvIGV4dHJhY3QgbnVtZXJpYyB2YWx1ZSBmcm9tIG9iamVjdA0KICAgICAgICB2YWx1ZUEgPSBwYXJzZUZsb2F0KHZhbHVlQS52YWx1ZSB8fCB2YWx1ZUEucmVzdWx0IHx8IHZhbHVlQS5kYXRhIHx8IDApOw0KICAgIH0NCiAgICBpZiAodHlwZW9mIHZhbHVlQiA9PT0gJ29iamVjdCcgJiYgdmFsdWVCICE9PSBudWxsKSB7DQogICAgICAgIHZhbHVlQiA9IHBhcnNlRmxvYXQodmFsdWVCLnZhbHVlIHx8IHZhbHVlQi5yZXN1bHQgfHwgdmFsdWVCLmRhdGEgfHwgMCk7DQogICAgfQ0KDQogICAgbGV0IHJlc3VsdCA9IDA7DQoNCiAgICB0cnkgew0KICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbikgew0KICAgICAgICAgICAgY2FzZSAnYWRkJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZUEgKyB2YWx1ZUI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzdWJ0cmFjdCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWVBIC0gdmFsdWVCOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbXVsdGlwbHknOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlQSAqIHZhbHVlQjsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2RpdmlkZSc6DQogICAgICAgICAgICAgICAgaWYgKHZhbHVlQiA9PT0gMCkgdGhyb3cgbmV3IEVycm9yKCdEaXZpc2lvbiBieSB6ZXJvJyk7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWVBIC8gdmFsdWVCOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbW9kdWxvJzoNCiAgICAgICAgICAgICAgICBpZiAodmFsdWVCID09PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ01vZHVsbyBieSB6ZXJvJyk7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWVBICUgdmFsdWVCOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAncG93ZXInOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGgucG93KHZhbHVlQSwgdmFsdWVCKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ21pbic6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5taW4odmFsdWVBLCB2YWx1ZUIpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbWF4JzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLm1heCh2YWx1ZUEsIHZhbHVlQik7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdhYnMnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGguYWJzKHZhbHVlQSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdyb3VuZCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5yb3VuZCh2YWx1ZUEpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZmxvb3InOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGguZmxvb3IodmFsdWVBKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2NlaWwnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGguY2VpbCh2YWx1ZUEpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZUE7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBSb3VuZCB0byBzcGVjaWZpZWQgZGVjaW1hbCBwbGFjZXMNCiAgICAgICAgaWYgKGRlY2ltYWxQbGFjZXMgPj0gMCkgew0KICAgICAgICAgICAgcmVzdWx0ID0gcGFyc2VGbG9hdChyZXN1bHQudG9GaXhlZChkZWNpbWFsUGxhY2VzKSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgbm9kZS5sYXN0VmFsdWVBID0gdmFsdWVBOw0KICAgICAgICBub2RlLmxhc3RWYWx1ZUIgPSB2YWx1ZUI7DQogICAgICAgIG5vZGUubGFzdFJlc3VsdCA9IHJlc3VsdDsNCiAgICAgICAgbm9kZS5sYXN0T3BlcmF0aW9uID0gb3BlcmF0aW9uOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXN1bHQ6IHJlc3VsdCwNCiAgICAgICAgICAgIGRhdGE6IHJlc3VsdCwNCiAgICAgICAgICAgIHRleHQ6IHJlc3VsdC50b1N0cmluZygpLA0KICAgICAgICAgICAgZm9ybWF0dGVkOiBkZWNpbWFsUGxhY2VzID09PSAwID8gcmVzdWx0LnRvU3RyaW5nKCkgOiByZXN1bHQudG9GaXhlZChkZWNpbWFsUGxhY2VzKQ0KICAgICAgICB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ01hdGggb3BlcmF0aW9uIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHJlc3VsdDogMCwNCiAgICAgICAgICAgIGRhdGE6IDAsDQogICAgICAgICAgICB0ZXh0OiAiMCIsDQogICAgICAgICAgICBmb3JtYXR0ZWQ6IGRlY2ltYWxQbGFjZXMgPT09IDAgPyAiMCIgOiAiMC4wMCIsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gQXJyYXkgT3BlcmF0aW9ucyBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlQXJyYXlOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IG9wZXJhdGlvbiA9IG5vZGUuY29uZmlnLm9wZXJhdGlvbi52YWx1ZTsNCiAgICBjb25zdCBmaWVsZFBhdGggPSBub2RlLmNvbmZpZy5maWVsZF9wYXRoLnZhbHVlOw0KICAgIGNvbnN0IGZpbHRlclZhbHVlID0gbm9kZS5jb25maWcuZmlsdGVyX3ZhbHVlLnZhbHVlOw0KICAgIGNvbnN0IGZpbHRlck9wZXJhdG9yID0gbm9kZS5jb25maWcuZmlsdGVyX29wZXJhdG9yLnZhbHVlOw0KICAgIGNvbnN0IGpvaW5TZXBhcmF0b3IgPSBub2RlLmNvbmZpZy5qb2luX3NlcGFyYXRvci52YWx1ZSB8fCAnLCAnOw0KICAgIGNvbnN0IHNsaWNlU3RhcnQgPSBwYXJzZUludChub2RlLmNvbmZpZy5zbGljZV9zdGFydC52YWx1ZSkgfHwgMDsNCiAgICBjb25zdCBzbGljZUVuZCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLnNsaWNlX2VuZC52YWx1ZSkgfHwgMDsNCg0KICAgIC8vIEdldCBhcnJheSBmcm9tIGlucHV0DQogICAgbGV0IGFycmF5ID0gaW5wdXREYXRhLmFycmF5IHx8IGlucHV0RGF0YS5kYXRhOw0KICAgIGxldCBvYmplY3QgPSBpbnB1dERhdGEub2JqZWN0IHx8IGlucHV0RGF0YS5kYXRhOw0KICAgIA0KICAgIC8vIEZvciBvYmplY3Qgb3BlcmF0aW9ucywgd2Ugd29yayB3aXRoIG9iamVjdHMgaW5zdGVhZCBvZiBhcnJheXMNCiAgICBpZiAoWydvYmplY3Rfa2V5cycsICdvYmplY3RfdmFsdWVzJywgJ29iamVjdF9lbnRyaWVzJ10uaW5jbHVkZXMob3BlcmF0aW9uKSkgew0KICAgICAgICAvLyBQYXJzZSBvYmplY3QgaWYgaXQncyBhIHN0cmluZw0KICAgICAgICBpZiAodHlwZW9mIG9iamVjdCA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgb2JqZWN0ID0gSlNPTi5wYXJzZShvYmplY3QpOw0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSBvYmplY3Q6JywgZSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBudWxsLCBlcnJvcjogJ0ludmFsaWQgb2JqZWN0IGRhdGEnIH07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAodHlwZW9mIG9iamVjdCAhPT0gJ29iamVjdCcgfHwgQXJyYXkuaXNBcnJheShvYmplY3QpIHx8IG9iamVjdCA9PT0gbnVsbCkgew0KICAgICAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBudWxsLCBlcnJvcjogJ0lucHV0IGlzIG5vdCBhbiBvYmplY3QnIH07DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBQYXJzZSBhcnJheSBpZiBpdCdzIGEgc3RyaW5nIChleGlzdGluZyBsb2dpYykNCiAgICAgICAgaWYgKHR5cGVvZiBhcnJheSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgYXJyYXkgPSBKU09OLnBhcnNlKGFycmF5KTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGFyc2UgYXJyYXk6JywgZSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBudWxsLCBlcnJvcjogJ0ludmFsaWQgYXJyYXkgZGF0YScgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICghQXJyYXkuaXNBcnJheShhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiB7IHJlc3VsdDogbnVsbCwgZXJyb3I6ICdJbnB1dCBpcyBub3QgYW4gYXJyYXknIH07DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBsZXQgcmVzdWx0ID0gbnVsbDsNCg0KICAgIHRyeSB7DQogICAgICAgIHN3aXRjaCAob3BlcmF0aW9uKSB7DQogICAgICAgICAgICBjYXNlICdtYXAnOg0KICAgICAgICAgICAgICAgIGlmIChmaWVsZFBhdGgpIHsNCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkubWFwKGl0ZW0gPT4gc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JVdGlscy5leHRyYWN0TmVzdGVkVmFsdWUoaXRlbSwgZmllbGRQYXRoKSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkuc2xpY2UoKTsgLy8gUmV0dXJuIGNvcHkgb2YgYXJyYXkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdmaWx0ZXInOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5LmZpbHRlcihpdGVtID0+IHsNCiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gZmllbGRQYXRoID8gc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JVdGlscy5leHRyYWN0TmVzdGVkVmFsdWUoaXRlbSwgZmllbGRQYXRoKSA6IGl0ZW07DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBwZXJmb3JtRmlsdGVyT3BlcmF0aW9uKHZhbHVlLCBmaWx0ZXJWYWx1ZSwgZmlsdGVyT3BlcmF0b3IpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbGVuZ3RoJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5sZW5ndGg7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdqb2luJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5tYXAoaXRlbSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGlmIChmaWVsZFBhdGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShpdGVtLCBmaWVsZFBhdGgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgPyBKU09OLnN0cmluZ2lmeShpdGVtKSA6IFN0cmluZyhpdGVtKTsNCiAgICAgICAgICAgICAgICB9KS5qb2luKGpvaW5TZXBhcmF0b3IpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZmlyc3QnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5Lmxlbmd0aCA+IDAgPyBhcnJheVswXSA6IG51bGw7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdsYXN0JzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5sZW5ndGggPiAwID8gYXJyYXlbYXJyYXkubGVuZ3RoIC0gMV0gOiBudWxsOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAncmFuZG9tJzoNCiAgICAgICAgICAgICAgICBpZiAoYXJyYXkubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG51bGw7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhcnJheS5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheVtyYW5kb21JbmRleF07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnc2xpY2UnOg0KICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHNsaWNlRW5kID4gMCA/IHNsaWNlRW5kIDogYXJyYXkubGVuZ3RoOw0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5LnNsaWNlKHNsaWNlU3RhcnQsIGVuZCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdyZXZlcnNlJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5zbGljZSgpLnJldmVyc2UoKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3NvcnQnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5LnNsaWNlKCkuc29ydCgoYSwgYikgPT4gew0KICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWVBID0gZmllbGRQYXRoID8gc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JVdGlscy5leHRyYWN0TmVzdGVkVmFsdWUoYSwgZmllbGRQYXRoKSA6IGE7DQogICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZUIgPSBmaWVsZFBhdGggPyBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShiLCBmaWVsZFBhdGgpIDogYjsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlQSA8IHZhbHVlQiA/IC0xIDogdmFsdWVBID4gdmFsdWVCID8gMSA6IDA7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICd1bmlxdWUnOg0KICAgICAgICAgICAgICAgIGlmIChmaWVsZFBhdGgpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VlbiA9IG5ldyBTZXQoKTsNCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkuZmlsdGVyKGl0ZW0gPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShpdGVtLCBmaWVsZFBhdGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlZW4uaGFzKHZhbHVlKSkgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2Vlbi5hZGQodmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFsuLi5uZXcgU2V0KGFycmF5KV07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnb2JqZWN0X2tleXMnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE9iamVjdC5rZXlzKG9iamVjdCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdvYmplY3RfdmFsdWVzJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBPYmplY3QudmFsdWVzKG9iamVjdCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdvYmplY3RfZW50cmllcyc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gT2JqZWN0LmVudHJpZXMob2JqZWN0KS5tYXAoKFtrZXksIHZhbHVlXSkgPT4gKHsNCiAgICAgICAgICAgICAgICAgICAga2V5OiBrZXksDQogICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZQ0KICAgICAgICAgICAgICAgIH0pKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgaWYgKFsnb2JqZWN0X2tleXMnLCAnb2JqZWN0X3ZhbHVlcycsICdvYmplY3RfZW50cmllcyddLmluY2x1ZGVzKG9wZXJhdGlvbikpIHsNCiAgICAgICAgICAgIG5vZGUubGFzdEFycmF5ID0gb2JqZWN0Ow0KICAgICAgICAgICAgbm9kZS5sYXN0T2JqZWN0ID0gb2JqZWN0Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgbm9kZS5sYXN0QXJyYXkgPSBhcnJheTsNCiAgICAgICAgfQ0KICAgICAgICBub2RlLmxhc3RSZXN1bHQgPSByZXN1bHQ7DQogICAgICAgIG5vZGUubGFzdE9wZXJhdGlvbiA9IG9wZXJhdGlvbjsNCg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgcmVzdWx0OiByZXN1bHQsDQogICAgICAgICAgICBkYXRhOiByZXN1bHQsDQogICAgICAgICAgICB0ZXh0OiBBcnJheS5pc0FycmF5KHJlc3VsdCkgPyBKU09OLnN0cmluZ2lmeShyZXN1bHQpIDogU3RyaW5nKHJlc3VsdCksDQogICAgICAgICAgICBsZW5ndGg6IEFycmF5LmlzQXJyYXkocmVzdWx0KSA/IHJlc3VsdC5sZW5ndGggOiBBcnJheS5pc0FycmF5KGFycmF5KSA/IGFycmF5Lmxlbmd0aCA6IDAsDQogICAgICAgICAgICBmaXJzdDogQXJyYXkuaXNBcnJheShhcnJheSkgJiYgYXJyYXkubGVuZ3RoID4gMCA/IGFycmF5WzBdIDogbnVsbCwNCiAgICAgICAgICAgIGxhc3Q6IEFycmF5LmlzQXJyYXkoYXJyYXkpICYmIGFycmF5Lmxlbmd0aCA+IDAgPyBhcnJheVthcnJheS5sZW5ndGggLSAxXSA6IG51bGwNCiAgICAgICAgfTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdBcnJheSBvcGVyYXRpb24gZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgcmVzdWx0OiBudWxsLA0KICAgICAgICAgICAgZGF0YTogbnVsbCwNCiAgICAgICAgICAgIHRleHQ6ICIiLA0KICAgICAgICAgICAgbGVuZ3RoOiAwLA0KICAgICAgICAgICAgZmlyc3Q6IG51bGwsDQogICAgICAgICAgICBsYXN0OiBudWxsLA0KICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UNCiAgICAgICAgfTsNCiAgICB9DQp9DQoNCi8vIEhlbHBlciBmdW5jdGlvbiBmb3IgYXJyYXkgZmlsdGVyaW5nDQpmdW5jdGlvbiBwZXJmb3JtRmlsdGVyT3BlcmF0aW9uKHZhbHVlLCBmaWx0ZXJWYWx1ZSwgb3BlcmF0b3IpIHsNCiAgICBjb25zdCB2YWx1ZVN0ciA9IFN0cmluZyh2YWx1ZSkudG9Mb3dlckNhc2UoKTsNCiAgICBjb25zdCBmaWx0ZXJTdHIgPSBTdHJpbmcoZmlsdGVyVmFsdWUpLnRvTG93ZXJDYXNlKCk7DQogICAgDQogICAgc3dpdGNoIChvcGVyYXRvcikgew0KICAgICAgICBjYXNlICdlcXVhbHMnOg0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlID09IGZpbHRlclZhbHVlOw0KICAgICAgICBjYXNlICdub3RfZXF1YWxzJzoNCiAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPSBmaWx0ZXJWYWx1ZTsNCiAgICAgICAgY2FzZSAnY29udGFpbnMnOg0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlU3RyLmluY2x1ZGVzKGZpbHRlclN0cik7DQogICAgICAgIGNhc2UgJ2dyZWF0ZXJfdGhhbic6DQogICAgICAgICAgICByZXR1cm4gTnVtYmVyKHZhbHVlKSA+IE51bWJlcihmaWx0ZXJWYWx1ZSk7DQogICAgICAgIGNhc2UgJ2xlc3NfdGhhbic6DQogICAgICAgICAgICByZXR1cm4gTnVtYmVyKHZhbHVlKSA8IE51bWJlcihmaWx0ZXJWYWx1ZSk7DQogICAgICAgIGNhc2UgJ3N0YXJ0c193aXRoJzoNCiAgICAgICAgICAgIHJldHVybiB2YWx1ZVN0ci5zdGFydHNXaXRoKGZpbHRlclN0cik7DQogICAgICAgIGNhc2UgJ2VuZHNfd2l0aCc6DQogICAgICAgICAgICByZXR1cm4gdmFsdWVTdHIuZW5kc1dpdGgoZmlsdGVyU3RyKTsNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCn0NCg0KLy8gU3RyaW5nIE9wZXJhdGlvbnMgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVN0cmluZ05vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgb3BlcmF0aW9uID0gbm9kZS5jb25maWcub3BlcmF0aW9uLnZhbHVlOw0KICAgIGNvbnN0IGNvbmZpZ1RleHRCID0gbm9kZS5jb25maWcudGV4dF9iLnZhbHVlOw0KICAgIA0KICAgIC8vIFByb2Nlc3MgZXNjYXBlIHNlcXVlbmNlcyBpbiBzZXBhcmF0b3IgKGUuZy4sIFxuLCBcclxuLCBcdCwgZXRjLikNCiAgICBsZXQgc2VwYXJhdG9yID0gbm9kZS5jb25maWcuc2VwYXJhdG9yLnZhbHVlIHx8ICcsJzsNCiAgICBzZXBhcmF0b3IgPSBzZXBhcmF0b3INCiAgICAgICAgLnJlcGxhY2UoL1xcbi9nLCAnXG4nKQ0KICAgICAgICAucmVwbGFjZSgvXFxyL2csICdccicpDQogICAgICAgIC5yZXBsYWNlKC9cXHQvZywgJ1x0JykNCiAgICAgICAgLnJlcGxhY2UoL1xcXFwvZywgJ1xcJyk7DQogICAgDQogICAgY29uc3Qgc2VhcmNoVGV4dCA9IG5vZGUuY29uZmlnLnNlYXJjaF90ZXh0LnZhbHVlOw0KICAgIGNvbnN0IHJlcGxhY2VUZXh0ID0gbm9kZS5jb25maWcucmVwbGFjZV90ZXh0LnZhbHVlOw0KICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBwYXJzZUludChub2RlLmNvbmZpZy5zdGFydF9pbmRleC52YWx1ZSkgfHwgMDsNCiAgICBjb25zdCBlbmRJbmRleCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLmVuZF9pbmRleC52YWx1ZSkgfHwgMDsNCiAgICBjb25zdCByZXBlYXRDb3VudCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLnJlcGVhdF9jb3VudC52YWx1ZSkgfHwgMTsNCiAgICBjb25zdCBjYXNlU2Vuc2l0aXZlID0gbm9kZS5jb25maWcuY2FzZV9zZW5zaXRpdmUudmFsdWUgPT09ICd0cnVlJzsNCg0KICAgIC8vIEdldCB0ZXh0IGlucHV0cw0KICAgIGxldCB0ZXh0QSA9IGlucHV0RGF0YS50ZXh0IHx8IGlucHV0RGF0YS5kYXRhIHx8ICcnOw0KICAgIGxldCB0ZXh0QiA9IGlucHV0RGF0YS50ZXh0X2IgfHwgY29uZmlnVGV4dEIgfHwgJyc7DQoNCg0KDQogICAgLy8gQ29udmVydCB0byBzdHJpbmdzDQogICAgaWYgKHR5cGVvZiB0ZXh0QSAhPT0gJ3N0cmluZycpIHRleHRBID0gU3RyaW5nKHRleHRBKTsNCiAgICBpZiAodHlwZW9mIHRleHRCICE9PSAnc3RyaW5nJykgdGV4dEIgPSBTdHJpbmcodGV4dEIpOw0KDQogICAgbGV0IHJlc3VsdCA9ICcnOw0KDQogICAgdHJ5IHsNCiAgICAgICAgc3dpdGNoIChvcGVyYXRpb24pIHsNCiAgICAgICAgICAgIGNhc2UgJ2NvbmNhdGVuYXRlJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QSArIHNlcGFyYXRvciArIHRleHRCOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnc3BsaXQnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnNwbGl0KHNlcGFyYXRvcik7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdyZXBsYWNlJzoNCiAgICAgICAgICAgICAgICBpZiAoY2FzZVNlbnNpdGl2ZSkgew0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS5yZXBsYWNlKG5ldyBSZWdFeHAoZXNjYXBlUmVnZXgoc2VhcmNoVGV4dCksICdnJyksIHJlcGxhY2VUZXh0KTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS5yZXBsYWNlKG5ldyBSZWdFeHAoZXNjYXBlUmVnZXgoc2VhcmNoVGV4dCksICdnaScpLCByZXBsYWNlVGV4dCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAndHJpbSc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdGV4dEEudHJpbSgpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAndXBwZXJjYXNlJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbG93ZXJjYXNlJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnc3Vic3RyaW5nJzoNCiAgICAgICAgICAgICAgICBjb25zdCBlbmQgPSBlbmRJbmRleCA+IDAgPyBlbmRJbmRleCA6IHRleHRBLmxlbmd0aDsNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS5zdWJzdHJpbmcoc3RhcnRJbmRleCwgZW5kKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JlZ2V4X21hdGNoJzoNCiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaEZsYWdzID0gY2FzZVNlbnNpdGl2ZSA/ICdnJyA6ICdnaSc7DQogICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHRleHRBLm1hdGNoKG5ldyBSZWdFeHAoc2VhcmNoVGV4dCwgbWF0Y2hGbGFncykpOw0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IG1hdGNoZXMgfHwgW107DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdyZWdleF9yZXBsYWNlJzoNCiAgICAgICAgICAgICAgICBjb25zdCByZXBsYWNlRmxhZ3MgPSBjYXNlU2Vuc2l0aXZlID8gJ2cnIDogJ2dpJzsNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS5yZXBsYWNlKG5ldyBSZWdFeHAoc2VhcmNoVGV4dCwgcmVwbGFjZUZsYWdzKSwgcmVwbGFjZVRleHQpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnc3RhcnRzX3dpdGgnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGNhc2VTZW5zaXRpdmUgPyB0ZXh0QS5zdGFydHNXaXRoKHNlYXJjaFRleHQpIDogDQogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2VuZHNfd2l0aCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gY2FzZVNlbnNpdGl2ZSA/IHRleHRBLmVuZHNXaXRoKHNlYXJjaFRleHQpIDogDQogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QS50b0xvd2VyQ2FzZSgpLmVuZHNXaXRoKHNlYXJjaFRleHQudG9Mb3dlckNhc2UoKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdjb250YWlucyc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gY2FzZVNlbnNpdGl2ZSA/IHRleHRBLmluY2x1ZGVzKHNlYXJjaFRleHQpIDogDQogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaFRleHQudG9Mb3dlckNhc2UoKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdyZXBlYXQnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnJlcGVhdChNYXRoLm1heCgwLCBNYXRoLm1pbihyZXBlYXRDb3VudCwgMTAwKSkpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbGFzdF9saW5lJzoNCiAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IHRleHRBLnNwbGl0KCdcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpLmxlbmd0aCA+IDApOw0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGxpbmVzLmxlbmd0aCA+IDAgPyBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXSA6ICcnOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBub2RlLmxhc3RUZXh0QSA9IHRleHRBOw0KICAgICAgICBub2RlLmxhc3RUZXh0QiA9IHRleHRCOw0KICAgICAgICBub2RlLmxhc3RSZXN1bHQgPSByZXN1bHQ7DQogICAgICAgIG5vZGUubGFzdE9wZXJhdGlvbiA9IG9wZXJhdGlvbjsNCg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgcmVzdWx0OiBBcnJheS5pc0FycmF5KHJlc3VsdCkgPyByZXN1bHQgOiBTdHJpbmcocmVzdWx0KSwNCiAgICAgICAgICAgIGRhdGE6IHJlc3VsdCwNCiAgICAgICAgICAgIGFycmF5OiBBcnJheS5pc0FycmF5KHJlc3VsdCkgPyByZXN1bHQgOiBudWxsLA0KICAgICAgICAgICAgbGVuZ3RoOiBTdHJpbmcocmVzdWx0KS5sZW5ndGgsDQogICAgICAgICAgICB3b3JkX2NvdW50OiBTdHJpbmcocmVzdWx0KS50cmltKCkuc3BsaXQoL1xzKy8pLmZpbHRlcih3b3JkID0+IHdvcmQubGVuZ3RoID4gMCkubGVuZ3RoDQogICAgICAgIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignU3RyaW5nIG9wZXJhdGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXN1bHQ6ICcnLA0KICAgICAgICAgICAgZGF0YTogJycsDQogICAgICAgICAgICBhcnJheTogbnVsbCwNCiAgICAgICAgICAgIGxlbmd0aDogMCwNCiAgICAgICAgICAgIHdvcmRfY291bnQ6IDAsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGVzY2FwZSByZWdleCBzcGVjaWFsIGNoYXJhY3RlcnMNCmZ1bmN0aW9uIGVzY2FwZVJlZ2V4KHN0cmluZykgew0KICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xdXFxdL2csICdcXCQmJyk7DQp9DQoNCi8vIE5vZGUgUmVmZXJlbmNlIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVOb2RlUmVmZXJlbmNlTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBzb3VyY2VOb2RlSWQgPSBub2RlLmNvbmZpZy5zb3VyY2Vfbm9kZV9pZC52YWx1ZTsNCiAgICBjb25zdCBvdXRwdXRQb3J0SWQgPSBub2RlLmNvbmZpZy5vdXRwdXRfcG9ydF9pZC52YWx1ZTsNCiAgICBjb25zdCBmYWxsYmFja1ZhbHVlID0gbm9kZS5jb25maWcuZmFsbGJhY2tfdmFsdWUudmFsdWUgfHwgbnVsbDsNCg0KICAgIC8vIFZhbGlkYXRlIGlucHV0cw0KICAgIGlmICghc291cmNlTm9kZUlkKSB7DQogICAgICAgIGNvbnNvbGUud2FybignTm9kZSBSZWZlcmVuY2U6IE5vIHNvdXJjZSBub2RlIHNlbGVjdGVkJyk7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkYXRhOiBmYWxsYmFja1ZhbHVlLA0KICAgICAgICAgICAgdGV4dDogU3RyaW5nKGZhbGxiYWNrVmFsdWUgfHwgJycpLA0KICAgICAgICAgICAganNvbjogZmFsbGJhY2tWYWx1ZSwNCiAgICAgICAgICAgIG51bWJlcjogaXNOYU4oTnVtYmVyKGZhbGxiYWNrVmFsdWUpKSA/IDAgOiBOdW1iZXIoZmFsbGJhY2tWYWx1ZSksDQogICAgICAgICAgICBib29sZWFuOiBCb29sZWFuKGZhbGxiYWNrVmFsdWUpLA0KICAgICAgICAgICAgYmluYXJ5OiBudWxsLA0KICAgICAgICAgICAgb3JpZ2luYWw6IGZhbGxiYWNrVmFsdWUsDQogICAgICAgICAgICBlcnJvcjogJ05vIHNvdXJjZSBub2RlIHNlbGVjdGVkJw0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgIGlmICghb3V0cHV0UG9ydElkKSB7DQogICAgICAgIGNvbnNvbGUud2FybignTm9kZSBSZWZlcmVuY2U6IE5vIG91dHB1dCBwb3J0IHNlbGVjdGVkJyk7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkYXRhOiBmYWxsYmFja1ZhbHVlLA0KICAgICAgICAgICAgdGV4dDogU3RyaW5nKGZhbGxiYWNrVmFsdWUgfHwgJycpLA0KICAgICAgICAgICAganNvbjogZmFsbGJhY2tWYWx1ZSwNCiAgICAgICAgICAgIG51bWJlcjogaXNOYU4oTnVtYmVyKGZhbGxiYWNrVmFsdWUpKSA/IDAgOiBOdW1iZXIoZmFsbGJhY2tWYWx1ZSksDQogICAgICAgICAgICBib29sZWFuOiBCb29sZWFuKGZhbGxiYWNrVmFsdWUpLA0KICAgICAgICAgICAgYmluYXJ5OiBudWxsLA0KICAgICAgICAgICAgb3JpZ2luYWw6IGZhbGxiYWNrVmFsdWUsDQogICAgICAgICAgICBlcnJvcjogJ05vIG91dHB1dCBwb3J0IHNlbGVjdGVkJw0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgIHRyeSB7DQogICAgICAgIC8vIEdldCB0aGUgcmVmZXJlbmNlZCBkYXRhIHVzaW5nIHRoZSBleGlzdGluZyBmdW5jdGlvbg0KICAgICAgICBjb25zdCByZWZlcmVuY2VkRGF0YSA9IGdldE91dHB1dFBvcnREYXRhKHNvdXJjZU5vZGVJZCwgb3V0cHV0UG9ydElkKTsNCiAgICAgICAgDQogICAgICAgIGlmIChyZWZlcmVuY2VkRGF0YSA9PT0gbnVsbCB8fCByZWZlcmVuY2VkRGF0YSA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBjb25zb2xlLndhcm4oYE5vZGUgUmVmZXJlbmNlOiBObyBkYXRhIGZvdW5kIGZvciBub2RlICR7c291cmNlTm9kZUlkfSwgcG9ydCAke291dHB1dFBvcnRJZH1gKTsNCiAgICAgICAgICAgIGNvbnN0IGZhbGxiYWNrID0gZmFsbGJhY2tWYWx1ZSAhPT0gJycgPyBmYWxsYmFja1ZhbHVlIDogbnVsbDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBkYXRhOiBmYWxsYmFjaywNCiAgICAgICAgICAgICAgICB0ZXh0OiBTdHJpbmcoZmFsbGJhY2sgfHwgJycpLA0KICAgICAgICAgICAgICAgIGpzb246IGZhbGxiYWNrLA0KICAgICAgICAgICAgICAgIG51bWJlcjogaXNOYU4oTnVtYmVyKGZhbGxiYWNrKSkgPyAwIDogTnVtYmVyKGZhbGxiYWNrKSwNCiAgICAgICAgICAgICAgICBib29sZWFuOiBCb29sZWFuKGZhbGxiYWNrKSwNCiAgICAgICAgICAgICAgICBiaW5hcnk6IG51bGwsDQogICAgICAgICAgICAgICAgb3JpZ2luYWw6IGZhbGxiYWNrLA0KICAgICAgICAgICAgICAgIGVycm9yOiBgTm8gZGF0YSBmb3VuZCBmb3Igbm9kZSAke3NvdXJjZU5vZGVJZH0sIHBvcnQgJHtvdXRwdXRQb3J0SWR9YA0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN1Y2Nlc3NmdWxseSBnb3QgdGhlIGRhdGEgLSBmb3JtYXQgaXQgZm9yIGFsbCBvdXRwdXQgdHlwZXMNCiAgICAgICAgbGV0IHRleHRWYWx1ZSA9IFN0cmluZyhyZWZlcmVuY2VkRGF0YSk7DQogICAgICAgIGxldCBqc29uVmFsdWUgPSByZWZlcmVuY2VkRGF0YTsNCiAgICAgICAgbGV0IG51bWJlclZhbHVlID0gMDsNCiAgICAgICAgbGV0IGJvb2xlYW5WYWx1ZSA9IEJvb2xlYW4ocmVmZXJlbmNlZERhdGEpOw0KDQogICAgICAgIC8vIEhhbmRsZSBkaWZmZXJlbnQgZGF0YSB0eXBlcyBhcHByb3ByaWF0ZWx5DQogICAgICAgIGlmICh0eXBlb2YgcmVmZXJlbmNlZERhdGEgPT09ICdudW1iZXInKSB7DQogICAgICAgICAgICBudW1iZXJWYWx1ZSA9IHJlZmVyZW5jZWREYXRhOw0KICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiByZWZlcmVuY2VkRGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IE51bWJlcihyZWZlcmVuY2VkRGF0YSk7DQogICAgICAgICAgICBudW1iZXJWYWx1ZSA9IGlzTmFOKHBhcnNlZCkgPyAwIDogcGFyc2VkOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gRm9yIEpTT04gb3V0cHV0LCB0cnkgdG8gcHJlc2VydmUgb2JqZWN0IHN0cnVjdHVyZQ0KICAgICAgICBpZiAodHlwZW9mIHJlZmVyZW5jZWREYXRhID09PSAnb2JqZWN0Jykgew0KICAgICAgICAgICAganNvblZhbHVlID0gcmVmZXJlbmNlZERhdGE7DQogICAgICAgICAgICB0ZXh0VmFsdWUgPSBKU09OLnN0cmluZ2lmeShyZWZlcmVuY2VkRGF0YSwgbnVsbCwgMik7DQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHJlZmVyZW5jZWREYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgSlNPTg0KICAgICAgICAgICAgICAgIGpzb25WYWx1ZSA9IEpTT04ucGFyc2UocmVmZXJlbmNlZERhdGEpOw0KICAgICAgICAgICAgfSBjYXRjaCB7DQogICAgICAgICAgICAgICAgLy8gTm90IHZhbGlkIEpTT04sIGtlZXAgYXMgc3RyaW5nDQogICAgICAgICAgICAgICAganNvblZhbHVlID0gcmVmZXJlbmNlZERhdGE7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkYXRhOiByZWZlcmVuY2VkRGF0YSwNCiAgICAgICAgICAgIHRleHQ6IHRleHRWYWx1ZSwNCiAgICAgICAgICAgIGpzb246IGpzb25WYWx1ZSwNCiAgICAgICAgICAgIG51bWJlcjogbnVtYmVyVmFsdWUsDQogICAgICAgICAgICBib29sZWFuOiBib29sZWFuVmFsdWUsDQogICAgICAgICAgICBiaW5hcnk6IChyZWZlcmVuY2VkRGF0YSBpbnN0YW5jZW9mIEJsb2IgfHwgcmVmZXJlbmNlZERhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgPyByZWZlcmVuY2VkRGF0YSA6IG51bGwsDQogICAgICAgICAgICBvcmlnaW5hbDogcmVmZXJlbmNlZERhdGENCiAgICAgICAgfTsNCg0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vZGUgUmVmZXJlbmNlIGV4ZWN1dGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIGNvbnN0IGZhbGxiYWNrID0gZmFsbGJhY2tWYWx1ZSAhPT0gJycgPyBmYWxsYmFja1ZhbHVlIDogbnVsbDsNCiAgICAgICAgDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkYXRhOiBmYWxsYmFjaywNCiAgICAgICAgICAgIHRleHQ6IFN0cmluZyhmYWxsYmFjayB8fCAnJyksDQogICAgICAgICAgICBqc29uOiBmYWxsYmFjaywNCiAgICAgICAgICAgIG51bWJlcjogaXNOYU4oTnVtYmVyKGZhbGxiYWNrKSkgPyAwIDogTnVtYmVyKGZhbGxiYWNrKSwNCiAgICAgICAgICAgIGJvb2xlYW46IEJvb2xlYW4oZmFsbGJhY2spLA0KICAgICAgICAgICAgYmluYXJ5OiBudWxsLA0KICAgICAgICAgICAgb3JpZ2luYWw6IGZhbGxiYWNrLA0KICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UNCiAgICAgICAgfTsNCiAgICB9DQp9DQoNCi8vIFJhbmRvbSBOdW1iZXIgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVJhbmRvbU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgbWluVmFsdWUgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLm1pbl92YWx1ZS52YWx1ZSkgfHwgMDsNCiAgICBjb25zdCBtYXhWYWx1ZSA9IHBhcnNlRmxvYXQobm9kZS5jb25maWcubWF4X3ZhbHVlLnZhbHVlKSB8fCAxMDA7DQogICAgY29uc3QgZGVjaW1hbFBsYWNlcyA9IHBhcnNlSW50KG5vZGUuY29uZmlnLmRlY2ltYWxfcGxhY2VzLnZhbHVlKSB8fCAwOw0KICAgIGNvbnN0IG91dHB1dFR5cGUgPSBub2RlLmNvbmZpZy5vdXRwdXRfdHlwZS52YWx1ZSB8fCAnaW50ZWdlcic7DQoNCiAgICAvLyBWYWxpZGF0ZSByYW5nZQ0KICAgIGlmIChtaW5WYWx1ZSA+PSBtYXhWYWx1ZSkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdSYW5kb206IE1pbmltdW0gdmFsdWUgbXVzdCBiZSBsZXNzIHRoYW4gbWF4aW11bSB2YWx1ZScpOw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgbnVtYmVyOiAwLA0KICAgICAgICAgICAgdGV4dDogJzAnLA0KICAgICAgICAgICAgZGF0YTogJzAnLA0KICAgICAgICAgICAgaW50ZWdlcjogMCwNCiAgICAgICAgICAgIGZsb2F0OiAwLjAsDQogICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgcmFuZ2U6IG1pbmltdW0gbXVzdCBiZSBsZXNzIHRoYW4gbWF4aW11bScNCiAgICAgICAgfTsNCiAgICB9DQoNCiAgICB0cnkgew0KICAgICAgICAvLyBHZW5lcmF0ZSByYW5kb20gbnVtYmVyIGJldHdlZW4gbWluIGFuZCBtYXgNCiAgICAgICAgbGV0IHJhbmRvbVZhbHVlID0gTWF0aC5yYW5kb20oKSAqIChtYXhWYWx1ZSAtIG1pblZhbHVlKSArIG1pblZhbHVlOw0KDQogICAgICAgIC8vIEFwcGx5IG91dHB1dCB0eXBlIGFuZCBkZWNpbWFsIHBsYWNlcw0KICAgICAgICBpZiAob3V0cHV0VHlwZSA9PT0gJ2ludGVnZXInIHx8IGRlY2ltYWxQbGFjZXMgPT09IDApIHsNCiAgICAgICAgICAgIHJhbmRvbVZhbHVlID0gTWF0aC5yb3VuZChyYW5kb21WYWx1ZSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByYW5kb21WYWx1ZSA9IHBhcnNlRmxvYXQocmFuZG9tVmFsdWUudG9GaXhlZChkZWNpbWFsUGxhY2VzKSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgbm9kZS5sYXN0UmFuZG9tVmFsdWUgPSByYW5kb21WYWx1ZTsNCiAgICAgICAgbm9kZS5sYXN0UmFuZ2UgPSBgJHttaW5WYWx1ZX0gLSAke21heFZhbHVlfWA7DQogICAgICAgIG5vZGUubGFzdE91dHB1dFR5cGUgPSBvdXRwdXRUeXBlOw0KDQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIG51bWJlcjogcmFuZG9tVmFsdWUsDQogICAgICAgICAgICB0ZXh0OiBTdHJpbmcocmFuZG9tVmFsdWUpLCAvLyBDb252ZXJ0IHRvIHN0cmluZyBmb3IgVkZTIGNvbXBhdGliaWxpdHkNCiAgICAgICAgICAgIGRhdGE6IFN0cmluZyhyYW5kb21WYWx1ZSksIC8vIENvbnZlcnQgdG8gc3RyaW5nIGZvciBWRlMgY29tcGF0aWJpbGl0eSAgDQogICAgICAgICAgICBpbnRlZ2VyOiBNYXRoLnJvdW5kKHJhbmRvbVZhbHVlKSwNCiAgICAgICAgICAgIGZsb2F0OiBwYXJzZUZsb2F0KHJhbmRvbVZhbHVlLnRvRml4ZWQoTWF0aC5tYXgoZGVjaW1hbFBsYWNlcywgMSkpKQ0KICAgICAgICB9Ow0KDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignUmFuZG9tIGV4ZWN1dGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBudW1iZXI6IDAsDQogICAgICAgICAgICB0ZXh0OiAnMCcsDQogICAgICAgICAgICBkYXRhOiAnMCcsDQogICAgICAgICAgICBpbnRlZ2VyOiAwLA0KICAgICAgICAgICAgZmxvYXQ6IDAuMCwNCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQovLyBFeHBvcnQgdG8gZ2xvYmFsIHNjb3BlDQpzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZGF0YUV4ZWN1dG9ycyA9IHsNCiAgICBleGVjdXRlVGV4dE5vZGUsDQogICAgZXhlY3V0ZUpzb25FeHRyYWN0Tm9kZSwNCiAgICBleGVjdXRlUmFuZG9tUXVvdGVOb2RlLA0KICAgIGV4ZWN1dGVNYXRoTm9kZSwNCiAgICBleGVjdXRlQXJyYXlOb2RlLA0KICAgIGV4ZWN1dGVTdHJpbmdOb2RlLA0KICAgIGV4ZWN1dGVOb2RlUmVmZXJlbmNlTm9kZSwNCiAgICBleGVjdXRlUmFuZG9tTm9kZQ0KfTsNCg0KDQovLyBIVFRQIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVIdHRwTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCB1cmwgPSBub2RlLmNvbmZpZy51cmwudmFsdWU7DQogICAgY29uc3QgbWV0aG9kID0gbm9kZS5jb25maWcubWV0aG9kLnZhbHVlOw0KICAgIGNvbnN0IGhlYWRlcnMgPSBKU09OLnBhcnNlKG5vZGUuY29uZmlnLmhlYWRlcnMudmFsdWUgfHwgJ3t9Jyk7DQogICAgY29uc3QgYm9keSA9IG5vZGUuY29uZmlnLmJvZHkudmFsdWU7DQogICAgY29uc3QgdXNlVGVtcGxhdGUgPSB0cnVlOyAvLyBBbHdheXMgZW5hYmxlIHRlbXBsYXRlIHByb2Nlc3NpbmcNCg0KICAgIGxldCBwcm9jZXNzZWRCb2R5ID0gYm9keTsNCg0KDQoNCiAgICAvLyBQcm9jZXNzIHRlbXBsYXRlcyBmaXJzdCBvbiB0aGUgc3RyaW5nIGJvZHkNCiAgICBpZiAodXNlVGVtcGxhdGUgJiYgaW5wdXREYXRhKSB7DQogICAgICAgIHByb2Nlc3NlZEJvZHkgPSBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzLnByb2Nlc3NUZW1wbGF0ZXMocHJvY2Vzc2VkQm9keSwgaW5wdXREYXRhKTsNCg0KICAgIH0NCg0KICAgIC8vIFRoZW4gcGFyc2UgYXMgSlNPTiBpZiBpdCdzIGEgc3RyaW5nIGFuZCBsb29rcyBsaWtlIEpTT04NCiAgICBpZiAodHlwZW9mIHByb2Nlc3NlZEJvZHkgPT09ICdzdHJpbmcnICYmIHByb2Nlc3NlZEJvZHkudHJpbSgpLnN0YXJ0c1dpdGgoJ3snKSkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgcHJvY2Vzc2VkQm9keSA9IEpTT04ucGFyc2UocHJvY2Vzc2VkQm9keSk7DQogICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHBhcnNlIGJvZHkgYXMgSlNPTiwgdXNpbmcgYXMgc3RyaW5nOicsIGUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gVXNlIE9TIHByb3h5IHRvIGJ5cGFzcyBDT1JTDQogICAgY29uc3QgcHJveHlSZXF1ZXN0ID0gew0KICAgICAgICB1cmw6IHVybCwNCiAgICAgICAgbWV0aG9kOiBtZXRob2QsDQogICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsDQogICAgICAgIGJvZHk6IHByb2Nlc3NlZEJvZHksDQogICAgICAgIHRpbWVvdXQ6IDMwDQogICAgfTsNCg0KDQogICAgY29uc3QgcHJveHlSZXNwb25zZSA9IGF3YWl0IHN5cG5leEFQSS5wcm94eUhUVFAocHJveHlSZXF1ZXN0KTsNCg0KICAgIGlmICghcHJveHlSZXNwb25zZSB8fCBwcm94eVJlc3BvbnNlLnN0YXR1cyA8IDIwMCB8fCBwcm94eVJlc3BvbnNlLnN0YXR1cyA+PSAzMDApIHsNCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQcm94eSByZXF1ZXN0IGZhaWxlZDogJHtwcm94eVJlc3BvbnNlPy5zdGF0dXMgfHwgJ1Vua25vd24gZXJyb3InfWApOw0KICAgIH0NCg0KICAgIGNvbnN0IHByb3h5RGF0YSA9IHByb3h5UmVzcG9uc2U7DQoNCiAgICBpZiAocHJveHlEYXRhLmVycm9yKSB7DQogICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCByZXF1ZXN0IGZhaWxlZDogJHtwcm94eURhdGEuZXJyb3J9YCk7DQogICAgfQ0KDQogICAgLy8gQ2hlY2sgaWYgcmVzcG9uc2UgaXMgYmluYXJ5IChhdWRpbywgaW1hZ2UsIGV0Yy4pDQogICAgaWYgKHByb3h5RGF0YS5pc19iaW5hcnkpIHsNCg0KICAgICAgICAvLyBDb252ZXJ0IGJhc2U2NCBjb250ZW50IHRvIGJsb2IgZm9yIGJpbmFyeSBkYXRhDQogICAgICAgIGNvbnN0IGJpbmFyeURhdGEgPSBhdG9iKHByb3h5RGF0YS5jb250ZW50KTsNCiAgICAgICAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheShiaW5hcnlEYXRhLmxlbmd0aCk7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmluYXJ5RGF0YS5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgYnl0ZXNbaV0gPSBiaW5hcnlEYXRhLmNoYXJDb2RlQXQoaSk7DQogICAgICAgIH0NCiAgICAgICAgY29uc3QgY29udGVudFR5cGUgPSBwcm94eURhdGEuaGVhZGVyc1snY29udGVudC10eXBlJ10gfHwgcHJveHlEYXRhLmhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddIHx8ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nOw0KICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2J5dGVzXSwgeyB0eXBlOiBjb250ZW50VHlwZSB9KTsNCg0KICAgICAgICAvLyBSZXR1cm4gc3RydWN0dXJlZCBvdXRwdXQgZm9yIGJpbmFyeSByZXNwb25zZXMgd2l0aCBhbGwgcG9ydHMNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIG9yaWdpbmFsX2RhdGE6IGJsb2IsDQogICAgICAgICAgICBwcm9jZXNzZWRfZGF0YTogYmxvYiwNCiAgICAgICAgICAgIHJlc3BvbnNlOiBibG9iLA0KICAgICAgICAgICAgc3RhdHVzX2NvZGU6IHByb3h5RGF0YS5zdGF0dXMgfHwgMjAwLA0KICAgICAgICAgICAgaGVhZGVyczogcHJveHlEYXRhLmhlYWRlcnMgfHwge30sDQogICAgICAgICAgICBwYXJzZWRfanNvbjogbnVsbCwNCiAgICAgICAgICAgIC8vIEFsc28gcHJvdmlkZSB0aGUgcmF3IHJlc3BvbnNlIGFzICdkYXRhJyBmb3IgY29tcGF0aWJpbGl0eQ0KICAgICAgICAgICAgZGF0YTogYmxvYiwNCiAgICAgICAgICAgIC8vIEFkZCB0aGUgbWlzc2luZyBvdXRwdXQgcG9ydHMgZnJvbSBub2RlIGRlZmluaXRpb24NCiAgICAgICAgICAgIHRleHQ6IG51bGwsDQogICAgICAgICAgICBqc29uOiBudWxsLA0KICAgICAgICAgICAgdXJsOiB1cmwsDQogICAgICAgICAgICBiaW5hcnk6IGJ5dGVzLCAgLy8gUmF3IGJpbmFyeSBkYXRhIGFzIFVpbnQ4QXJyYXkNCiAgICAgICAgICAgIGJsb2I6IGJsb2IgICAgICAvLyBCbG9iIG9iamVjdCBmb3IgY29tcGF0aWJpbGl0eQ0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgIC8vIEZvciB0ZXh0IHJlc3BvbnNlcywgdHJ5IHRvIHBhcnNlIGFzIEpTT04gYW5kIHJldHVybiBzdHJ1Y3R1cmVkIG91dHB1dA0KDQogICAgbGV0IHBhcnNlZEpzb24gPSBudWxsOw0KICAgIHRyeSB7DQogICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBKU09ODQogICAgICAgIHBhcnNlZEpzb24gPSBKU09OLnBhcnNlKHByb3h5RGF0YS5jb250ZW50KTsNCiAgICB9IGNhdGNoIChlKSB7DQogICAgfQ0KDQogICAgLy8gUmV0dXJuIHN0cnVjdHVyZWQgb3V0cHV0IGZvciB0ZXh0IHJlc3BvbnNlcyBtYXRjaGluZyBuZXcgbm9kZSBhcmNoaXRlY3R1cmUNCiAgICByZXR1cm4gew0KICAgICAgICBvcmlnaW5hbF9kYXRhOiBwcm94eURhdGEuY29udGVudCwNCiAgICAgICAgcHJvY2Vzc2VkX2RhdGE6IHBhcnNlZEpzb24gfHwgcHJveHlEYXRhLmNvbnRlbnQsDQogICAgICAgIHJlc3BvbnNlOiBwcm94eURhdGEuY29udGVudCwNCiAgICAgICAgc3RhdHVzX2NvZGU6IHByb3h5RGF0YS5zdGF0dXMgfHwgMjAwLA0KICAgICAgICBoZWFkZXJzOiBwcm94eURhdGEuaGVhZGVycyB8fCB7fSwNCiAgICAgICAgcGFyc2VkX2pzb246IHBhcnNlZEpzb24sDQogICAgICAgIC8vIEFsc28gcHJvdmlkZSB0aGUgcmF3IHJlc3BvbnNlIGFzICdkYXRhJyBmb3IgY29tcGF0aWJpbGl0eQ0KICAgICAgICBkYXRhOiBwcm94eURhdGEuY29udGVudCwNCiAgICAgICAgLy8gQWRkIHRoZSBtaXNzaW5nIG91dHB1dCBwb3J0cyBmcm9tIG5vZGUgZGVmaW5pdGlvbg0KICAgICAgICB0ZXh0OiBwcm94eURhdGEuY29udGVudCwNCiAgICAgICAganNvbjogcGFyc2VkSnNvbiwNCiAgICAgICAgdXJsOiB1cmwNCiAgICB9Ow0KfQ0KDQovLyBWRlMgTG9hZCBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlVmZzTG9hZE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgbGV0IGZpbGVQYXRoID0gbm9kZS5jb25maWcuZmlsZV9wYXRoLnZhbHVlOw0KICAgIGNvbnN0IGZvcm1hdCA9IG5vZGUuY29uZmlnLmZvcm1hdC52YWx1ZTsNCg0KICAgIC8vIFByb2Nlc3MgdGVtcGxhdGUgdmFyaWFibGVzIGluIGZpbGUgcGF0aA0KICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTsNCiAgICBjb25zdCBkYXRlVGVtcGxhdGVzID0gew0KICAgICAgICAne3tEQVRFfX0nOiBjdXJyZW50RGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sIC8vIFlZWVktTU0tREQNCiAgICAgICAgJ3t7WVlZWX19JzogY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpLA0KICAgICAgICAne3tNTX19JzogKGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyksDQogICAgICAgICd7e0REfX0nOiBjdXJyZW50RGF0ZS5nZXREYXRlKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpLA0KICAgICAgICAne3tUSU1FU1RBTVB9fSc6IGN1cnJlbnREYXRlLmdldFRpbWUoKS50b1N0cmluZygpLA0KICAgICAgICAne3tJU09fREFURX19JzogY3VycmVudERhdGUudG9JU09TdHJpbmcoKQ0KICAgIH07DQoNCiAgICAvLyBSZXBsYWNlIGFsbCB0ZW1wbGF0ZSB2YXJpYWJsZXMgdXNpbmcgc2ltcGxlIHN0cmluZyByZXBsYWNlbWVudA0KICAgIGZvciAoY29uc3QgW3RlbXBsYXRlLCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZGF0ZVRlbXBsYXRlcykpIHsNCiAgICAgICAgZmlsZVBhdGggPSBmaWxlUGF0aC5yZXBsYWNlQWxsKHRlbXBsYXRlLCB2YWx1ZSk7DQogICAgfQ0KDQoNCiAgICB0cnkgew0KICAgICAgICBsZXQgZGF0YSA9IG51bGw7DQoNCg0KICAgICAgICBpZiAoZm9ybWF0ID09PSAnanNvbicpIHsNCiAgICAgICAgICAgIGRhdGEgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlSlNPTihmaWxlUGF0aCk7DQogICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAndGV4dCcpIHsNCiAgICAgICAgICAgIGRhdGEgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlVGV4dChmaWxlUGF0aCk7DQogICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAnYmxvYicpIHsNCiAgICAgICAgICAgIC8vIEZvciBibG9iIGZvcm1hdCwgcmVhZCBhcyB0ZXh0IChkYXRhIFVSTHMgYXJlIHN0b3JlZCBhcyB0ZXh0KQ0KICAgICAgICAgICAgZGF0YSA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVUZXh0KGZpbGVQYXRoKTsNCiAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09ICdiaW5hcnknKSB7DQogICAgICAgICAgICAvLyBGb3IgYmluYXJ5IGZpbGVzLCB1c2UgdGhlIG5ldyBTeXBuZXhBUEkgbWV0aG9kIHRvIGdldCBCbG9iDQogICAgICAgICAgICBkYXRhID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZUJsb2IoZmlsZVBhdGgpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIGZvcm1hdDogJyArIGZvcm1hdCArICcuIFN1cHBvcnRlZCBmb3JtYXRzIGFyZToganNvbiwgdGV4dCwgYmxvYiwgYmluYXJ5Jyk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBTdG9yZSB0aGUgbG9hZGVkIGRhdGEgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgICAgIG5vZGUubGFzdExvYWRlZEZpbGUgPSBmaWxlUGF0aDsNCiAgICAgICAgbm9kZS5sYXN0TG9hZGVkRGF0YSA9IGRhdGE7DQoNCg0KICAgICAgICAvLyBSZXR1cm4gc3RydWN0dXJlZCBvdXRwdXQgd2l0aCBhcHByb3ByaWF0ZSBwb3J0IG5hbWVzDQogICAgICAgIGNvbnN0IHJlc3VsdCA9IHsNCiAgICAgICAgICAgIGRhdGE6IGRhdGEsDQogICAgICAgICAgICBmaWxlX3BhdGg6IGZpbGVQYXRoLCAgLy8gUmV0dXJuIHRoZSBhY3R1YWwgcHJvY2Vzc2VkIGZpbGUgcGF0aCBzdHJpbmcNCiAgICAgICAgICAgIGpzb25fZGF0YTogZm9ybWF0ID09PSAnanNvbicgPyBkYXRhIDogbnVsbA0KICAgICAgICB9Ow0KICAgICAgICByZXR1cm4gcmVzdWx0Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1ZGUyBMb2FkIGVycm9yOicsIHsNCiAgICAgICAgICAgIG9yaWdpbmFsUGF0aDogbm9kZS5jb25maWcuZmlsZV9wYXRoLnZhbHVlLA0KICAgICAgICAgICAgcHJvY2Vzc2VkUGF0aDogZmlsZVBhdGgsDQogICAgICAgICAgICBmb3JtYXQ6IGZvcm1hdCwNCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLA0KICAgICAgICAgICAgZXJyb3JTdGFjazogZXJyb3Iuc3RhY2sNCiAgICAgICAgfSk7DQogICAgICAgIHJldHVybiB7IGRhdGE6IG51bGwsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07DQogICAgfQ0KfQ0KDQoNCi8vIFZGUyBTYXZlIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVWZnNTYXZlTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBmaWxlUGF0aCA9IG5vZGUuY29uZmlnLmZpbGVfcGF0aC52YWx1ZTsNCiAgICBjb25zdCBmb3JtYXQgPSBub2RlLmNvbmZpZy5mb3JtYXQudmFsdWU7DQogICAgY29uc3Qgb3ZlcndyaXRlID0gbm9kZS5jb25maWcub3ZlcndyaXRlLnZhbHVlID09PSAndHJ1ZSc7DQogICAgY29uc3QgYXBwZW5kID0gbm9kZS5jb25maWcuYXBwZW5kLnZhbHVlID09PSAndHJ1ZSc7DQoNCiAgICB0cnkgew0KICAgICAgICBsZXQgZGF0YSA9IGlucHV0RGF0YS5kYXRhOw0KICAgICAgICBsZXQgc3VjY2VzcyA9IGZhbHNlOw0KDQoNCg0KICAgICAgICBpZiAoZm9ybWF0ID09PSAnanNvbicpIHsNCiAgICAgICAgICAgIC8vIEZvciBKU09OIGZvcm1hdCB3aXRoIGFwcGVuZCBtb2RlLCB3ZSBuZWVkIHRvIGhhbmRsZSBpdCBzcGVjaWFsbHkNCiAgICAgICAgICAgIGlmIChhcHBlbmQgJiYgIW92ZXJ3cml0ZSkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIC8vIFRyeSB0byByZWFkIGV4aXN0aW5nIGZpbGUgZmlyc3QNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdEYXRhID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZUpTT04oZmlsZVBhdGgpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShleGlzdGluZ0RhdGEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBleGlzdGluZyBkYXRhIGlzIGFuIGFycmF5LCBhcHBlbmQgdG8gaXQNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nRGF0YS5wdXNoKGRhdGEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGV4aXN0aW5nRGF0YTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIGV4aXN0aW5nIGRhdGEgaXMgbm90IGFuIGFycmF5LCBjcmVhdGUgYSBuZXcgYXJyYXkNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBbZXhpc3RpbmdEYXRhLCBkYXRhXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIEZpbGUgZG9lc24ndCBleGlzdCBvciBjYW4ndCBiZSByZWFkLCBjcmVhdGUgbmV3IGFycmF5DQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBbZGF0YV07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgc3VjY2VzcyA9IGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlSlNPTihmaWxlUGF0aCwgZGF0YSk7DQogICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAndGV4dCcpIHsNCiAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgICAgICAvLyBGb3IgdGV4dCBmb3JtYXQgd2l0aCBhcHBlbmQgbW9kZQ0KICAgICAgICAgICAgICAgIGlmIChhcHBlbmQgJiYgIW92ZXJ3cml0ZSkgew0KICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IHRvIHJlYWQgZXhpc3RpbmcgZmlsZSBmaXJzdA0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdUZXh0ID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZVRleHQoZmlsZVBhdGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGV4aXN0aW5nVGV4dCArICdcbicgKyBkYXRhOw0KICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmlsZSBkb2Vzbid0IGV4aXN0LCB1c2UgZGF0YSBhcy1pcw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZShmaWxlUGF0aCwgZGF0YSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGV4dCBmb3JtYXQgcmVxdWlyZXMgc3RyaW5nIGRhdGEsIHJlY2VpdmVkOiAnICsgdHlwZW9mIGRhdGEgKyAnLiBVc2UgSlNPTiBmb3JtYXQgZm9yIG9iamVjdHMuJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAnYmluYXJ5Jykgew0KICAgICAgICAgICAgLy8gSGFuZGxlIGJpbmFyeSBkYXRhIHByb3Blcmx5IHVzaW5nIHRoZSBiaW5hcnkgdXBsb2FkIGVuZHBvaW50DQogICAgICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHsNCiAgICAgICAgICAgICAgICAvLyBVc2UgdGhlIGJpbmFyeSB1cGxvYWQgbWV0aG9kIGZvciByYXcgYmluYXJ5IGRhdGENCiAgICAgICAgICAgICAgICBzdWNjZXNzID0gYXdhaXQgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGVCaW5hcnkoZmlsZVBhdGgsIGRhdGEpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvLyBCaW5hcnkgZm9ybWF0IG9ubHkgc3VwcG9ydHMgVWludDhBcnJheSBmb3IgcmF3IGJpbmFyeSBkYXRhDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCaW5hcnkgZm9ybWF0IHJlcXVpcmVzIFVpbnQ4QXJyYXkgZGF0YSBmb3IgcmF3IGJpbmFyeSwgcmVjZWl2ZWQ6ICcgKyB0eXBlb2YgZGF0YSArICcuIFVzZSBibG9iIGZvcm1hdCBmb3IgQmxvYiBkYXRhLicpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ2Jsb2InKSB7DQogICAgICAgICAgICAvLyBIYW5kbGUgQmxvYiB0byBkYXRhIFVSTCBjb252ZXJzaW9uDQogICAgICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEJsb2IpIHsNCiAgICAgICAgICAgICAgICAvLyBDb252ZXJ0IEJsb2IgdG8gZGF0YSBVUkwNCiAgICAgICAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFVcmwgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7DQogICAgICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoKSA9PiByZXNvbHZlKHJlYWRlci5yZXN1bHQpOw0KICAgICAgICAgICAgICAgICAgICByZWFkZXIub25lcnJvciA9IHJlamVjdDsNCiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZGF0YSk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgc3VjY2VzcyA9IGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlKGZpbGVQYXRoLCBkYXRhVXJsKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCbG9iIGZvcm1hdCByZXF1aXJlcyBCbG9iIGRhdGEsIHJlY2VpdmVkOiAnICsgdHlwZW9mIGRhdGEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gVW5rbm93biBmb3JtYXQNCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biBmb3JtYXQ6ICcgKyBmb3JtYXQgKyAnLiBTdXBwb3J0ZWQgZm9ybWF0cyBhcmU6IGpzb24sIHRleHQsIGJpbmFyeSwgYmxvYicpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHsgc3VjY2Vzczogc3VjY2VzcyB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1ZGUyBTYXZlIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07DQogICAgfQ0KfQ0KDQovLyBWRlMgRGlyZWN0b3J5IExpc3QgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVZmc0RpcmVjdG9yeUxpc3ROb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGxldCBkaXJlY3RvcnlQYXRoID0gbm9kZS5jb25maWcuZGlyZWN0b3J5X3BhdGgudmFsdWU7DQogICAgY29uc3QgZmlsdGVyRXh0ZW5zaW9ucyA9IG5vZGUuY29uZmlnLmZpbHRlcl9leHRlbnNpb25zLnZhbHVlOw0KICAgIGNvbnN0IGluY2x1ZGVEaXJlY3RvcmllcyA9IG5vZGUuY29uZmlnLmluY2x1ZGVfZGlyZWN0b3JpZXMudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCByZWN1cnNpdmUgPSBub2RlLmNvbmZpZy5yZWN1cnNpdmUudmFsdWUgPT09ICd0cnVlJzsNCg0KDQoNCiAgICAvLyBVc2UgaW5wdXQgcGF0aCBpZiBwcm92aWRlZCwgb3RoZXJ3aXNlIHVzZSBjb25maWcNCiAgICBpZiAoaW5wdXREYXRhICYmIGlucHV0RGF0YS5kaXJlY3RvcnlfcGF0aCkgew0KICAgICAgICBkaXJlY3RvcnlQYXRoID0gaW5wdXREYXRhLmRpcmVjdG9yeV9wYXRoOw0KDQogICAgfQ0KDQogICAgLy8gRW5zdXJlIGRpcmVjdG9yeVBhdGggaXMgYSBzdHJpbmcgYW5kIG5vdCBlbXB0eQ0KICAgIGlmICh0eXBlb2YgZGlyZWN0b3J5UGF0aCAhPT0gJ3N0cmluZycgfHwgIWRpcmVjdG9yeVBhdGgpIHsNCiAgICAgICAgZGlyZWN0b3J5UGF0aCA9ICcvJzsNCg0KICAgIH0NCg0KICAgIC8vIFByb2Nlc3MgdGVtcGxhdGUgdmFyaWFibGVzIGluIGRpcmVjdG9yeSBwYXRoDQogICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpOw0KICAgIGNvbnN0IGRhdGVUZW1wbGF0ZXMgPSB7DQogICAgICAgICd7e0RBVEV9fSc6IGN1cnJlbnREYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSwNCiAgICAgICAgJ3t7WVlZWX19JzogY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpLA0KICAgICAgICAne3tNTX19JzogKGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyksDQogICAgICAgICd7e0REfX0nOiBjdXJyZW50RGF0ZS5nZXREYXRlKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpLA0KICAgICAgICAne3tUSU1FU1RBTVB9fSc6IGN1cnJlbnREYXRlLmdldFRpbWUoKS50b1N0cmluZygpLA0KICAgICAgICAne3tJU09fREFURX19JzogY3VycmVudERhdGUudG9JU09TdHJpbmcoKQ0KICAgIH07DQoNCiAgICBmb3IgKGNvbnN0IFt0ZW1wbGF0ZSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGVUZW1wbGF0ZXMpKSB7DQogICAgICAgIGRpcmVjdG9yeVBhdGggPSBkaXJlY3RvcnlQYXRoLnJlcGxhY2VBbGwodGVtcGxhdGUsIHZhbHVlKTsNCiAgICB9DQoNCg0KDQogICAgdHJ5IHsNCiAgICAgICAgLy8gVXNlIHRoZSBleGlzdGluZyBzeXBuZXhBUEkubGlzdFZpcnR1YWxGaWxlcyBtZXRob2QNCiAgICAgICAgY29uc3QgZmlsZUxpc3REYXRhID0gYXdhaXQgc3lwbmV4QVBJLmxpc3RWaXJ0dWFsRmlsZXMoZGlyZWN0b3J5UGF0aCk7DQogICAgICAgIA0KICAgICAgICBpZiAoIWZpbGVMaXN0RGF0YSB8fCAhZmlsZUxpc3REYXRhLml0ZW1zKSB7DQogICAgICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgICAgICBlcnJvcjogYERpcmVjdG9yeSBub3QgZm91bmQgb3IgZW1wdHk6ICR7ZGlyZWN0b3J5UGF0aH1gLA0KICAgICAgICAgICAgICAgIGZpbGVfbGlzdDogW10sDQogICAgICAgICAgICAgICAgZmlsZV9wYXRoczogW10sDQogICAgICAgICAgICAgICAgZmlsZV9uYW1lczogW10sDQogICAgICAgICAgICAgICAgY291bnQ6IDAsDQogICAgICAgICAgICAgICAgZGlyZWN0b3JpZXM6IFtdLA0KICAgICAgICAgICAgICAgIGZpbGVzX29ubHk6IFtdDQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQoNCiAgICAgICAgbGV0IGFsbEl0ZW1zID0gZmlsZUxpc3REYXRhLml0ZW1zOw0KICAgICAgICANCiAgICAgICAgLy8gSGFuZGxlIHJlY3Vyc2l2ZSBsaXN0aW5nIGlmIGVuYWJsZWQNCiAgICAgICAgaWYgKHJlY3Vyc2l2ZSkgew0KICAgICAgICAgICAgY29uc3QgZ2V0QWxsRmlsZXNSZWN1cnNpdmUgPSBhc3luYyAoaXRlbXMsIGJhc2VQYXRoKSA9PiB7DQogICAgICAgICAgICAgICAgbGV0IGFsbEZpbGVzID0gW107DQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLmlzX2RpcmVjdG9yeSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3ViUGF0aCA9IGJhc2VQYXRoICsgKGJhc2VQYXRoLmVuZHNXaXRoKCcvJykgPyAnJyA6ICcvJykgKyBpdGVtLm5hbWU7DQogICAgICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1YkRpckRhdGEgPSBhd2FpdCBzeXBuZXhBUEkubGlzdFZpcnR1YWxGaWxlcyhzdWJQYXRoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViRGlyRGF0YSAmJiBzdWJEaXJEYXRhLml0ZW1zKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1YkZpbGVzID0gYXdhaXQgZ2V0QWxsRmlsZXNSZWN1cnNpdmUoc3ViRGlyRGF0YS5pdGVtcywgc3ViUGF0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbEZpbGVzID0gYWxsRmlsZXMuY29uY2F0KHN1YkZpbGVzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYENvdWxkIG5vdCByZWFkIHN1YmRpcmVjdG9yeSAke3N1YlBhdGh9OmAsIGVycik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgYWxsRmlsZXMucHVzaCh7Li4uaXRlbSwgZnVsbFBhdGg6IGJhc2VQYXRoICsgKGJhc2VQYXRoLmVuZHNXaXRoKCcvJykgPyAnJyA6ICcvJykgKyBpdGVtLm5hbWV9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuIGFsbEZpbGVzOw0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgYWxsSXRlbXMgPSBhd2FpdCBnZXRBbGxGaWxlc1JlY3Vyc2l2ZShhbGxJdGVtcywgZGlyZWN0b3J5UGF0aCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBBZGQgZnVsbCBwYXRoIGZvciBub24tcmVjdXJzaXZlDQogICAgICAgICAgICBhbGxJdGVtcyA9IGFsbEl0ZW1zLm1hcChpdGVtID0+ICh7DQogICAgICAgICAgICAgICAgLi4uaXRlbSwgDQogICAgICAgICAgICAgICAgZnVsbFBhdGg6IGRpcmVjdG9yeVBhdGggKyAoZGlyZWN0b3J5UGF0aC5lbmRzV2l0aCgnLycpID8gJycgOiAnLycpICsgaXRlbS5uYW1lDQogICAgICAgICAgICB9KSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBGaWx0ZXIgYnkgZmlsZSBleHRlbnNpb25zIGlmIHNwZWNpZmllZA0KICAgICAgICBsZXQgZmlsdGVyZWRJdGVtcyA9IGFsbEl0ZW1zOw0KICAgICAgICBpZiAoZmlsdGVyRXh0ZW5zaW9ucyAmJiBmaWx0ZXJFeHRlbnNpb25zLnRyaW0oKSkgew0KICAgICAgICAgICAgY29uc3QgZXh0ZW5zaW9ucyA9IGZpbHRlckV4dGVuc2lvbnMuc3BsaXQoJywnKS5tYXAoZXh0ID0+IGV4dC50cmltKCkudG9Mb3dlckNhc2UoKSk7DQogICAgICAgICAgICBmaWx0ZXJlZEl0ZW1zID0gYWxsSXRlbXMuZmlsdGVyKGl0ZW0gPT4gew0KICAgICAgICAgICAgICAgIC8vIEFsd2F5cyBpbmNsdWRlIGRpcmVjdG9yaWVzIGlmIGluY2x1ZGVEaXJlY3RvcmllcyBpcyB0cnVlDQogICAgICAgICAgICAgICAgaWYgKGl0ZW0uaXNfZGlyZWN0b3J5KSByZXR1cm4gaW5jbHVkZURpcmVjdG9yaWVzOw0KICAgICAgICAgICAgICAgIC8vIEZvciBmaWxlcywgY2hlY2sgdGhlIGV4dGVuc2lvbg0KICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1FeHQgPSBpdGVtLm5hbWUuc3BsaXQoJy4nKS5wb3AoKT8udG9Mb3dlckNhc2UoKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gZXh0ZW5zaW9ucy5pbmNsdWRlcyhpdGVtRXh0KTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICANCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFNlcGFyYXRlIGZpbGVzIGFuZCBkaXJlY3Rvcmllcw0KICAgICAgICBjb25zdCBmaWxlcyA9IGZpbHRlcmVkSXRlbXMuZmlsdGVyKGl0ZW0gPT4gIWl0ZW0uaXNfZGlyZWN0b3J5KTsNCiAgICAgICAgY29uc3QgZGlyZWN0b3JpZXMgPSBmaWx0ZXJlZEl0ZW1zLmZpbHRlcihpdGVtID0+IGl0ZW0uaXNfZGlyZWN0b3J5KTsNCiAgICAgICAgDQogICAgICAgIC8vIENyZWF0ZSBvdXRwdXQgYXJyYXlzDQogICAgICAgIGNvbnN0IGZpbGVQYXRocyA9IGZpbGVzLm1hcChmaWxlID0+IGZpbGUuZnVsbFBhdGgpOw0KICAgICAgICBjb25zdCBmaWxlTmFtZXMgPSBmaWxlcy5tYXAoZmlsZSA9PiBmaWxlLm5hbWUpOw0KICAgICAgICBjb25zdCBkaXJlY3RvcnlQYXRocyA9IGRpcmVjdG9yaWVzLm1hcChkaXIgPT4gZGlyLmZ1bGxQYXRoKTsNCg0KICAgICAgICAvLyBGaW5hbCBmaWxlIGxpc3QgYmFzZWQgb24gaW5jbHVkZURpcmVjdG9yaWVzIHNldHRpbmcNCiAgICAgICAgLy8gSWYgaW5jbHVkZURpcmVjdG9yaWVzIGlzIHRydWUsIHJldHVybiBhbGwgZmlsdGVyZWQgaXRlbXMgKGZpbGVzICsgZGlyZWN0b3JpZXMpDQogICAgICAgIC8vIElmIGluY2x1ZGVEaXJlY3RvcmllcyBpcyBmYWxzZSwgcmV0dXJuIG9ubHkgZmlsZXMNCiAgICAgICAgY29uc3QgZmluYWxGaWxlTGlzdCA9IGluY2x1ZGVEaXJlY3RvcmllcyA/IGZpbHRlcmVkSXRlbXMgOiBmaWxlczsNCg0KDQoNCiAgICAgICAgLy8gU3RvcmUgcmVzdWx0cyBmb3IgY29uZmlnIHBhbmVsIGRpc3BsYXkNCiAgICAgICAgbm9kZS5sYXN0RGlyZWN0b3J5UGF0aCA9IGRpcmVjdG9yeVBhdGg7DQogICAgICAgIG5vZGUubGFzdEZpbGVDb3VudCA9IGZpbmFsRmlsZUxpc3QubGVuZ3RoOw0KICAgICAgICBub2RlLmxhc3RGaWxlTGlzdCA9IGZpbmFsRmlsZUxpc3Q7DQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGZpbGVfbGlzdDogZmluYWxGaWxlTGlzdCwNCiAgICAgICAgICAgIGZpbGVfcGF0aHM6IGZpbGVQYXRocywNCiAgICAgICAgICAgIGZpbGVfbmFtZXM6IGZpbGVOYW1lcywNCiAgICAgICAgICAgIGNvdW50OiBmaW5hbEZpbGVMaXN0Lmxlbmd0aCwNCiAgICAgICAgICAgIGRpcmVjdG9yaWVzOiBkaXJlY3RvcnlQYXRocywNCiAgICAgICAgICAgIGZpbGVzX29ubHk6IGZpbGVzDQogICAgICAgIH07DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1ZGUyBEaXJlY3RvcnkgTGlzdCBlcnJvcjonLCB7DQogICAgICAgICAgICBkaXJlY3RvcnlQYXRoOiBkaXJlY3RvcnlQYXRoLA0KICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsDQogICAgICAgICAgICBlcnJvclN0YWNrOiBlcnJvci5zdGFjaw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSwNCiAgICAgICAgICAgIGZpbGVfbGlzdDogW10sDQogICAgICAgICAgICBmaWxlX3BhdGhzOiBbXSwNCiAgICAgICAgICAgIGZpbGVfbmFtZXM6IFtdLA0KICAgICAgICAgICAgY291bnQ6IDAsDQogICAgICAgICAgICBkaXJlY3RvcmllczogW10sDQogICAgICAgICAgICBmaWxlc19vbmx5OiBbXQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gRXhwb3J0IHRvIGdsb2JhbCBzY29wZQ0Kc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmh0dHBFeGVjdXRvcnMgPSB7DQogICAgZXhlY3V0ZUh0dHBOb2RlLA0KICAgIGV4ZWN1dGVWZnNMb2FkTm9kZSwNCiAgICBleGVjdXRlVmZzU2F2ZU5vZGUsDQogICAgZXhlY3V0ZVZmc0RpcmVjdG9yeUxpc3ROb2RlDQp9Ow0KDQovLyBJbWFnZSBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlSW1hZ2VOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IG1heFByZXZpZXdTaXplID0gbm9kZS5jb25maWcubWF4X3ByZXZpZXdfc2l6ZS52YWx1ZTsNCiAgICBjb25zdCBzaG93SW5mbyA9IG5vZGUuY29uZmlnLnNob3dfaW5mby52YWx1ZSA9PT0gJ3RydWUnOw0KDQogICAgbGV0IGltYWdlRGF0YSA9IGlucHV0RGF0YS5pbWFnZV9kYXRhOw0KICAgIGxldCBpbWFnZVVybCA9IG51bGw7DQogICAgbGV0IGltYWdlSW5mbyA9IG51bGw7DQoNCiAgICAvLyBIYW5kbGUgZGlmZmVyZW50IHR5cGVzIG9mIGltYWdlIGRhdGENCiAgICBpZiAoaW1hZ2VEYXRhIGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICAvLyBDcmVhdGUgb2JqZWN0IFVSTCBmb3IgQmxvYiBkYXRhDQogICAgICAgIGltYWdlVXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChpbWFnZURhdGEpOw0KICAgICAgICBpbWFnZUluZm8gPSB7DQogICAgICAgICAgICB0eXBlOiBpbWFnZURhdGEudHlwZSB8fCAnaW1hZ2UnLA0KICAgICAgICAgICAgc2l6ZTogaW1hZ2VEYXRhLnNpemUNCiAgICAgICAgfTsNCiAgICB9IGVsc2UgaWYgKHR5cGVvZiBpbWFnZURhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgIC8vIENoZWNrIGlmIGl0J3MgYmFzZTY0IGRhdGENCiAgICAgICAgaWYgKGltYWdlRGF0YS5zdGFydHNXaXRoKCdkYXRhOmltYWdlLycpIHx8IGltYWdlRGF0YS5zdGFydHNXaXRoKCdkYXRhOmFwcGxpY2F0aW9uLycpKSB7DQogICAgICAgICAgICAvLyBBbHJlYWR5IGEgZGF0YSBVUkwNCiAgICAgICAgICAgIGltYWdlVXJsID0gaW1hZ2VEYXRhOw0KICAgICAgICB9IGVsc2UgaWYgKGltYWdlRGF0YS5tYXRjaCgvXltBLVphLXowLTkrL10qPXswLDJ9JC8pKSB7DQogICAgICAgICAgICAvLyBMb29rcyBsaWtlIGJhc2U2NCBkYXRhLCBjb252ZXJ0IHRvIGRhdGEgVVJMDQogICAgICAgICAgICAvLyBUcnkgdG8gZGV0ZWN0IGltYWdlIHR5cGUgZnJvbSB0aGUgZGF0YQ0KICAgICAgICAgICAgY29uc3QgaW1hZ2VUeXBlID0gc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JVdGlscy5kZXRlY3RJbWFnZVR5cGVGcm9tQmFzZTY0KGltYWdlRGF0YSk7DQogICAgICAgICAgICBpbWFnZVVybCA9IGBkYXRhOiR7aW1hZ2VUeXBlfTtiYXNlNjQsJHtpbWFnZURhdGF9YDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIEFzc3VtZSBpdCdzIGEgcmVndWxhciBVUkwNCiAgICAgICAgICAgIGltYWdlVXJsID0gaW1hZ2VEYXRhOw0KICAgICAgICB9DQogICAgfSBlbHNlIGlmIChpbWFnZURhdGEgJiYgdHlwZW9mIGltYWdlRGF0YSA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgLy8gSGFuZGxlIG9iamVjdCB3aXRoIGltYWdlIGRhdGENCiAgICAgICAgaWYgKGltYWdlRGF0YS51cmwpIHsNCiAgICAgICAgICAgIGltYWdlVXJsID0gaW1hZ2VEYXRhLnVybDsNCiAgICAgICAgfSBlbHNlIGlmIChpbWFnZURhdGEuZGF0YSkgew0KICAgICAgICAgICAgaW1hZ2VVcmwgPSBpbWFnZURhdGEuZGF0YTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpbWFnZURhdGEuaW5mbykgew0KICAgICAgICAgICAgaW1hZ2VJbmZvID0gaW1hZ2VEYXRhLmluZm87DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBOb3RlOiBSZW1vdmVkIGltYWdlIGRpbWVuc2lvbiBkZXRlY3Rpb24gYXMgaXQncyBub3QgbmVlZGVkDQoNCiAgICAvLyBTdG9yZSBpbWFnZSBkYXRhIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgIG5vZGUubGFzdEltYWdlRGF0YSA9IGltYWdlRGF0YTsNCiAgICBub2RlLmxhc3RJbWFnZVVybCA9IGltYWdlVXJsOw0KICAgIG5vZGUubGFzdEltYWdlSW5mbyA9IGltYWdlSW5mbzsNCg0KICAgIHJldHVybiB7DQogICAgICAgIGltYWdlX2RhdGE6IGltYWdlRGF0YSwNCiAgICAgICAgaW1hZ2VfdXJsOiBpbWFnZVVybCwNCiAgICAgICAgaW1hZ2VfaW5mbzogaW1hZ2VJbmZvLA0KICAgICAgICBkYXRhOiBpbWFnZURhdGENCiAgICB9Ow0KfQ0KDQovLyBBdWRpbyBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlQXVkaW9Ob2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGF1dG9QbGF5ID0gbm9kZS5jb25maWcuYXV0b1BsYXkudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCB2b2x1bWUgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLnZvbHVtZS52YWx1ZSk7DQoNCiAgICBsZXQgYXVkaW9EYXRhID0gaW5wdXREYXRhLmF1ZGlvX2RhdGE7DQoNCg0KICAgIGlmICghYXVkaW9EYXRhKSB7DQogICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYXVkaW8gZGF0YSBwcm92aWRlZCcpOw0KICAgIH0NCg0KICAgIC8vIFN0b3JlIGF1ZGlvIGRhdGEgZm9yIG1hbnVhbCBwbGF5IGJ1dHRvbiBzeXN0ZW0gKGxpa2Ugb2xkIHN5c3RlbSkNCiAgICBub2RlLmF1ZGlvRGF0YSA9IGF1ZGlvRGF0YTsNCiAgICBub2RlLnZvbHVtZSA9IHZvbHVtZTsNCg0KICAgIC8vIENyZWF0ZSBhdWRpbyBlbGVtZW50IGlmIGl0IGRvZXNuJ3QgZXhpc3QgKGxpa2Ugb2xkIHN5c3RlbSkNCiAgICBpZiAoIW5vZGUuYXVkaW9FbGVtZW50KSB7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50ID0gbmV3IEF1ZGlvKCk7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LmNvbnRyb2xzID0gdHJ1ZTsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3R5bGUud2lkdGggPSAnMTAwJSc7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JzsNCiAgICB9DQoNCiAgICAvLyBTZXQgYXVkaW8gc291cmNlIChsaWtlIG9sZCBzeXN0ZW0pDQogICAgaWYgKGF1ZGlvRGF0YSBpbnN0YW5jZW9mIEJsb2IpIHsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChhdWRpb0RhdGEpOw0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGF1ZGlvRGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgaWYgKGF1ZGlvRGF0YS5zdGFydHNXaXRoKCdkYXRhOmF1ZGlvLycpIHx8IGF1ZGlvRGF0YS5zdGFydHNXaXRoKCdkYXRhOmFwcGxpY2F0aW9uLycpKSB7DQogICAgICAgICAgICAvLyBBbHJlYWR5IGEgZGF0YSBVUkwNCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnNyYyA9IGF1ZGlvRGF0YTsNCiAgICAgICAgfSBlbHNlIGlmIChhdWRpb0RhdGEubWF0Y2goL15bQS1aYS16MC05Ky9dKj17MCwyfSQvKSkgew0KICAgICAgICAgICAgLy8gTG9va3MgbGlrZSBiYXNlNjQgZGF0YSwgY29udmVydCB0byBkYXRhIFVSTA0KICAgICAgICAgICAgY29uc3QgYXVkaW9UeXBlID0gJ2F1ZGlvL21wZWcnOyAvLyBEZWZhdWx0IHRvIE1QMywgY291bGQgYmUgZW5oYW5jZWQgdG8gZGV0ZWN0IHR5cGUNCiAgICAgICAgICAgIGNvbnN0IGRhdGFVcmwgPSBgZGF0YToke2F1ZGlvVHlwZX07YmFzZTY0LCR7YXVkaW9EYXRhfWA7DQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zcmMgPSBkYXRhVXJsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSByZWd1bGFyIFVSTA0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gYXVkaW9EYXRhOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gYXVkaW9EYXRhOw0KICAgIH0NCg0KICAgIC8vIFNldCB2b2x1bWUNCiAgICBub2RlLmF1ZGlvRWxlbWVudC52b2x1bWUgPSB2b2x1bWU7DQoNCiAgICAvLyBTdG9yZSBmb3IgY29uZmlnIHBhbmVsIGNvbXBhdGliaWxpdHkNCiAgICBub2RlLmxhc3RBdWRpb0RhdGEgPSBhdWRpb0RhdGE7DQogICAgbm9kZS5sYXN0QXVkaW9VcmwgPSBub2RlLmF1ZGlvRWxlbWVudC5zcmM7DQoNCiAgICAvLyBBdXRvLXBsYXkgaWYgY29uZmlndXJlZA0KICAgIGlmIChhdXRvUGxheSkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgYXdhaXQgbm9kZS5hdWRpb0VsZW1lbnQucGxheSgpOw0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignQXV0by1wbGF5IGZhaWxlZDonLCBlcnJvcik7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBDb252ZXJ0IGF1ZGlvIGRhdGEgdG8gcHJvcGVyIGRhdGEgVVJMIGZvciBWRlMgU2F2ZQ0KICAgIGxldCBkYXRhVXJsRm9yU2F2ZSA9IG51bGw7DQoNCiAgICBpZiAoYXVkaW9EYXRhIGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICAvLyBDb252ZXJ0IEJsb2IgdG8gZGF0YSBVUkwNCiAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgICAgZGF0YVVybEZvclNhdmUgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7DQogICAgICAgICAgICByZWFkZXIub25sb2FkID0gKCkgPT4gcmVzb2x2ZShyZWFkZXIucmVzdWx0KTsNCiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gcmVqZWN0Ow0KICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoYXVkaW9EYXRhKTsNCiAgICAgICAgfSk7DQogICAgfSBlbHNlIGlmICh0eXBlb2YgYXVkaW9EYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICBpZiAoYXVkaW9EYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6YXVkaW8vJykgfHwgYXVkaW9EYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6YXBwbGljYXRpb24vJykpIHsNCiAgICAgICAgICAgIC8vIEFscmVhZHkgYSBkYXRhIFVSTA0KICAgICAgICAgICAgZGF0YVVybEZvclNhdmUgPSBhdWRpb0RhdGE7DQogICAgICAgIH0gZWxzZSBpZiAoYXVkaW9EYXRhLm1hdGNoKC9eW0EtWmEtejAtOSsvXSo9ezAsMn0kLykpIHsNCiAgICAgICAgICAgIC8vIEJhc2U2NCBkYXRhLCBjb252ZXJ0IHRvIGRhdGEgVVJMDQogICAgICAgICAgICBjb25zdCBhdWRpb1R5cGUgPSAnYXVkaW8vbXBlZyc7IC8vIERlZmF1bHQgdG8gTVAzLCBjb3VsZCBiZSBlbmhhbmNlZCB0byBkZXRlY3QgdHlwZQ0KICAgICAgICAgICAgZGF0YVVybEZvclNhdmUgPSBgZGF0YToke2F1ZGlvVHlwZX07YmFzZTY0LCR7YXVkaW9EYXRhfWA7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBSZWd1bGFyIFVSTCwga2VlcCBhcyBpcw0KICAgICAgICAgICAgZGF0YVVybEZvclNhdmUgPSBhdWRpb0RhdGE7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBGYWxsYmFjaw0KICAgICAgICBkYXRhVXJsRm9yU2F2ZSA9IGF1ZGlvRGF0YTsNCiAgICB9DQoNCiAgICByZXR1cm4gew0KICAgICAgICBhdWRpb19kYXRhOiBhdWRpb0RhdGEsDQogICAgICAgIGF1ZGlvX3VybDogbm9kZS5hdWRpb0VsZW1lbnQuc3JjLA0KICAgICAgICBkYXRhOiBkYXRhVXJsRm9yU2F2ZSAgLy8gUmV0dXJuIHRoZSBhY3R1YWwgYXVkaW8gZGF0YSBhcyBkYXRhIFVSTA0KICAgIH07DQp9DQoNCi8vIEV4cG9ydCB0byBnbG9iYWwgc2NvcGUNCnN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5tZWRpYUV4ZWN1dG9ycyA9IHsNCiAgICBleGVjdXRlSW1hZ2VOb2RlLA0KICAgIGV4ZWN1dGVBdWRpb05vZGUNCn07DQoNCg0KLy8gVGltZXIgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVRpbWVyTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBpbnRlcnZhbCA9IG5vZGUuY29uZmlnLmludGVydmFsLnZhbHVlOw0KICAgIGNvbnN0IGNvdW50ID0gbm9kZS5jb25maWcuY291bnQudmFsdWU7DQoNCiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsNCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpOw0KICAgICAgICAgICAgcmVzb2x2ZSh7DQogICAgICAgICAgICAgICAgdHJpZ2dlcjogdGltZXN0YW1wLA0KICAgICAgICAgICAgICAgIG9yaWdpbmFsX2RhdGE6IHRpbWVzdGFtcCwNCiAgICAgICAgICAgICAgICBwcm9jZXNzZWRfZGF0YTogdGltZXN0YW1wLA0KICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogdGltZXN0YW1wLA0KICAgICAgICAgICAgICAgIGVsYXBzZWQ6IGludGVydmFsDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSwgaW50ZXJ2YWwpOw0KICAgIH0pOw0KfQ0KDQovLyBEaXNwbGF5IE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVEaXNwbGF5Tm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBmb3JtYXQgPSBub2RlLmNvbmZpZy5mb3JtYXQudmFsdWU7DQogICAgY29uc3QgbWF4TGVuZ3RoID0gbm9kZS5jb25maWcubWF4TGVuZ3RoLnZhbHVlOw0KICAgIGNvbnN0IGlucHV0UG9ydCA9IG5vZGUuY29uZmlnLmlucHV0X3BvcnQ/LnZhbHVlIHx8ICdhdXRvJzsNCg0KICAgIC8vIFRyeSB0byBmaW5kIGNvbnRlbnQgYmFzZWQgb24gY29uZmlndXJlZCBpbnB1dCBwb3J0IG9yIGF1dG8tZGV0ZWN0DQogICAgbGV0IGNvbnRlbnQgPSBudWxsOw0KDQogICAgaWYgKGlucHV0UG9ydCAhPT0gJ2F1dG8nKSB7DQogICAgICAgIC8vIFVzZSB0aGUgc3BlY2lmaWVkIGlucHV0IHBvcnQNCiAgICAgICAgY29udGVudCA9IGlucHV0RGF0YVtpbnB1dFBvcnRdOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIEF1dG8tZGV0ZWN0OiBQcmlvcml0eSBvcmRlcjogdGV4dCwganNvbiwgZGF0YSwgYmluYXJ5DQogICAgICAgIGlmIChpbnB1dERhdGEudGV4dCAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBjb250ZW50ID0gaW5wdXREYXRhLnRleHQ7DQogICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLmpzb24gIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgY29udGVudCA9IGlucHV0RGF0YS5qc29uOw0KICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS5kYXRhICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBpbnB1dERhdGEuZGF0YTsNCiAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGEuYmluYXJ5ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBpbnB1dERhdGEuYmluYXJ5Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gVXNlIHRoZSBmaXJzdCBhdmFpbGFibGUgaW5wdXQNCiAgICAgICAgICAgIGNvbnN0IGZpcnN0SW5wdXQgPSBPYmplY3QudmFsdWVzKGlucHV0RGF0YSlbMF07DQogICAgICAgICAgICBjb250ZW50ID0gZmlyc3RJbnB1dDsNCiAgICAgICAgfQ0KICAgIH0NCg0KDQogICAgLy8gT25seSBjb252ZXJ0IHRvIEpTT04gc3RyaW5nIGlmIGZvcm1hdCBpcyAnanNvbicgb3IgaWYgaXQncyBhbiBvYmplY3QgYW5kIGZvcm1hdCBpcyBub3Qgc3BlY2lmaWVkDQogICAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnb2JqZWN0JyAmJiBmb3JtYXQgPT09ICdqc29uJykgew0KICAgICAgICBjb250ZW50ID0gSlNPTi5zdHJpbmdpZnkoY29udGVudCwgbnVsbCwgMik7DQogICAgfSBlbHNlIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ29iamVjdCcgJiYgZm9ybWF0ID09PSAndGV4dCcpIHsNCiAgICAgICAgLy8gRm9yIHRleHQgZm9ybWF0LCBleHRyYWN0IHRoZSBhY3R1YWwgdmFsdWUgZnJvbSBjb21tb24gZmllbGRzDQogICAgICAgIGlmIChjb250ZW50ID09PSBudWxsKSB7DQogICAgICAgICAgICBjb250ZW50ID0gJ251bGwnOw0KICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoY29udGVudCkpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LmpvaW4oJywgJyk7DQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdvYmplY3QnKSB7DQogICAgICAgICAgICAvLyBMb29rIGZvciB0aGUgYWN0dWFsIHZhbHVlIGluIGNvbW1vbiBmaWVsZHMNCiAgICAgICAgICAgIGlmIChjb250ZW50LmV4dHJhY3RlZF92YWx1ZSAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgY29udGVudCA9IFN0cmluZyhjb250ZW50LmV4dHJhY3RlZF92YWx1ZSk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRlbnQudmFsdWUgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBTdHJpbmcoY29udGVudC52YWx1ZSk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRlbnQudGV4dCAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgY29udGVudCA9IFN0cmluZyhjb250ZW50LnRleHQpOw0KICAgICAgICAgICAgfSBlbHNlIGlmIChjb250ZW50LmRhdGEgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBTdHJpbmcoY29udGVudC5kYXRhKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy8gSWYgbm8gY29tbW9uIGZpZWxkcyBmb3VuZCwganVzdCBzaG93IHRoZSBmaXJzdCB2YWx1ZQ0KICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0VmFsdWUgPSBPYmplY3QudmFsdWVzKGNvbnRlbnQpWzBdOw0KICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBTdHJpbmcoZmlyc3RWYWx1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoY29udGVudCAmJiBjb250ZW50Lmxlbmd0aCA+IG1heExlbmd0aCkgew0KICAgICAgICBjb250ZW50ID0gY29udGVudC5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKSArICcuLi4nOw0KICAgIH0NCg0KICAgIC8vIFVwZGF0ZSBkaXNwbGF5IG5vZGUgY29udGVudA0KICAgIHVwZGF0ZURpc3BsYXlOb2RlQ29udGVudChub2RlLmlkLCBjb250ZW50LCBmb3JtYXQpOw0KDQogICAgcmV0dXJuIHsNCiAgICAgICAgb3JpZ2luYWxfZGF0YTogY29udGVudCwNCiAgICAgICAgZGlzcGxheWVkOiBjb250ZW50LA0KICAgICAgICBwcm9jZXNzZWRfZGF0YTogY29udGVudA0KICAgIH07DQp9DQoNCg0KLy8gUmVwZWF0ZXIgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVJlcGVhdGVyTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBpbnRlcnZhbCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLmludGVydmFsLnZhbHVlKTsNCiAgICBjb25zdCBjb3VudCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLmNvdW50LnZhbHVlKTsNCg0KICAgIC8vIEluaXRpYWxpemUgcmVwZWF0ZXIgc3RhdGUgaWYgbm90IGV4aXN0cw0KICAgIGlmICghbm9kZS5yZXBlYXRlclN0YXRlKSB7DQogICAgICAgIG5vZGUucmVwZWF0ZXJTdGF0ZSA9IHsNCiAgICAgICAgICAgIGNvdW50OiAwLA0KICAgICAgICAgICAgaW50ZXJ2YWw6IG51bGwsDQogICAgICAgICAgICBpc1J1bm5pbmc6IGZhbHNlDQogICAgICAgIH07DQogICAgfQ0KDQogICAgLy8gSWYgdGhpcyBpcyBhIG1hbnVhbCB0cmlnZ2VyIChub3QgZnJvbSBpbnRlcnZhbCksIHN0YXJ0IHRoZSByZXBlYXRlcg0KICAgIGlmICghbm9kZS5yZXBlYXRlclN0YXRlLmlzUnVubmluZykgew0KICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUuaXNSdW5uaW5nID0gdHJ1ZTsNCiAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmNvdW50ID0gMDsNCg0KICAgICAgICAvLyBTdGFydCB0aGUgaW50ZXJ2YWwNCiAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmludGVydmFsID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4gew0KICAgICAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmNvdW50Kys7DQoNCiAgICAgICAgICAgIC8vIEV4ZWN1dGUgdGhlIGNvbm5lY3RlZCB3b3JrZmxvdw0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0ZWROb2RlcyA9IGZpbmRDb25uZWN0ZWROb2Rlcyhub2RlLmlkKTsNCiAgICAgICAgICAgICAgICBjb25zdCBleGVjdXRlZCA9IG5ldyBTZXQoKTsNCg0KICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGVkTm9kZSBvZiBjb25uZWN0ZWROb2Rlcykgew0KICAgICAgICAgICAgICAgICAgICBhd2FpdCBleGVjdXRlTm9kZShjb25uZWN0ZWROb2RlLm5vZGUsIHsgdHJpZ2dlcjogRGF0ZS5ub3coKSB9LCBleGVjdXRlZCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBleGVjdXRpbmcgcmVwZWF0ZXIgd29ya2Zsb3c6JywgZXJyb3IpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBTdG9wIGlmIGNvdW50IGxpbWl0IHJlYWNoZWQNCiAgICAgICAgICAgIGlmIChjb3VudCA+IDAgJiYgbm9kZS5yZXBlYXRlclN0YXRlLmNvdW50ID49IGNvdW50KSB7DQogICAgICAgICAgICAgICAgZW5naW5lLnN0b3BSZXBlYXRlcihub2RlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwgaW50ZXJ2YWwpOw0KICAgIH0NCg0KICAgIHJldHVybiB7IHRyaWdnZXI6IERhdGUubm93KCksIGNvdW50OiBub2RlLnJlcGVhdGVyU3RhdGUuY291bnQsIGlzUnVubmluZzogbm9kZS5yZXBlYXRlclN0YXRlLmlzUnVubmluZyB9Ow0KfQ0KDQovLyBDb25kaXRpb24gTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUNvbmRpdGlvbk5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgb3BlcmF0b3IgPSBub2RlLmNvbmZpZy5vcGVyYXRvci52YWx1ZTsNCiAgICBjb25zdCBjb21wYXJlVmFsdWUgPSBub2RlLmNvbmZpZy5jb21wYXJlX3ZhbHVlLnZhbHVlOw0KICAgIGNvbnN0IGNhc2VTZW5zaXRpdmUgPSBub2RlLmNvbmZpZy5jYXNlX3NlbnNpdGl2ZS52YWx1ZSA9PT0gJ3RydWUnOw0KDQogICAgbGV0IGlucHV0VmFsdWUgPSBpbnB1dERhdGEudmFsdWU7DQogICAgbGV0IHJlc3VsdCA9IGZhbHNlOw0KDQogICAgLy8gQ29udmVydCBpbnB1dCB0byBzdHJpbmcgZm9yIGNvbXBhcmlzb24gaWYgbmVlZGVkDQogICAgbGV0IGlucHV0U3RyID0gU3RyaW5nKGlucHV0VmFsdWUpOw0KICAgIGxldCBjb21wYXJlU3RyID0gU3RyaW5nKGNvbXBhcmVWYWx1ZSk7DQoNCiAgICAvLyBEZWJ1ZyBsb2dnaW5nIGZvciBzdHJpbmcgY29tcGFyaXNvbnMNCg0KICAgIC8vIEhhbmRsZSBjYXNlIHNlbnNpdGl2aXR5DQogICAgaWYgKCFjYXNlU2Vuc2l0aXZlKSB7DQogICAgICAgIGlucHV0U3RyID0gaW5wdXRTdHIudG9Mb3dlckNhc2UoKTsNCiAgICAgICAgY29tcGFyZVN0ciA9IGNvbXBhcmVTdHIudG9Mb3dlckNhc2UoKTsNCiAgICB9DQoNCiAgICAvLyBQZXJmb3JtIGNvbXBhcmlzb24gYmFzZWQgb24gb3BlcmF0b3INCiAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7DQogICAgICAgIGNhc2UgJ2VxdWFscyc6DQogICAgICAgICAgICByZXN1bHQgPSBpbnB1dFN0ciA9PT0gY29tcGFyZVN0cjsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdub3RfZXF1YWxzJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IGlucHV0U3RyICE9PSBjb21wYXJlU3RyOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2dyZWF0ZXJfdGhhbic6DQogICAgICAgICAgICByZXN1bHQgPSBOdW1iZXIoaW5wdXRWYWx1ZSkgPiBOdW1iZXIoY29tcGFyZVZhbHVlKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdsZXNzX3RoYW4nOg0KICAgICAgICAgICAgcmVzdWx0ID0gTnVtYmVyKGlucHV0VmFsdWUpIDwgTnVtYmVyKGNvbXBhcmVWYWx1ZSk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnZ3JlYXRlcl90aGFuX29yX2VxdWFsJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IE51bWJlcihpbnB1dFZhbHVlKSA+PSBOdW1iZXIoY29tcGFyZVZhbHVlKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdsZXNzX3RoYW5fb3JfZXF1YWwnOg0KICAgICAgICAgICAgcmVzdWx0ID0gTnVtYmVyKGlucHV0VmFsdWUpIDw9IE51bWJlcihjb21wYXJlVmFsdWUpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2NvbnRhaW5zJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IGlucHV0U3RyLmluY2x1ZGVzKGNvbXBhcmVTdHIpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ25vdF9jb250YWlucyc6DQogICAgICAgICAgICByZXN1bHQgPSAhaW5wdXRTdHIuaW5jbHVkZXMoY29tcGFyZVN0cik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnc3RhcnRzX3dpdGgnOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIuc3RhcnRzV2l0aChjb21wYXJlU3RyKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdlbmRzX3dpdGgnOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIuZW5kc1dpdGgoY29tcGFyZVN0cik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnaXNfZW1wdHknOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIudHJpbSgpID09PSAnJzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdpc19ub3RfZW1wdHknOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIudHJpbSgpICE9PSAnJzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7DQogICAgfQ0KDQogICAgLy8gU3RvcmUgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgbm9kZS5sYXN0SW5wdXRWYWx1ZSA9IGlucHV0VmFsdWU7DQogICAgbm9kZS5sYXN0Q29tcGFyZVZhbHVlID0gY29tcGFyZVZhbHVlOw0KICAgIG5vZGUubGFzdFJlc3VsdCA9IHJlc3VsdDsNCiAgICBub2RlLmxhc3RPcGVyYXRvciA9IG9wZXJhdG9yOw0KDQogICAgcmV0dXJuIHsgcmVzdWx0OiByZXN1bHQgfTsNCn0NCg0KLy8gTG9naWNhbCBHYXRlIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVMb2dpY2FsR2F0ZU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgaW52ZXJ0ID0gbm9kZS5jb25maWcuaW52ZXJ0LnZhbHVlID09PSAndHJ1ZSc7DQogICAgY29uc3QgZGVzY3JpcHRpb24gPSBub2RlLmNvbmZpZy5kZXNjcmlwdGlvbi52YWx1ZTsNCg0KICAgIGxldCBjb25kaXRpb24gPSBpbnB1dERhdGEuY29uZGl0aW9uOw0KDQogICAgLy8gQ29udmVydCB0byBib29sZWFuIGlmIG5lZWRlZA0KICAgIGlmICh0eXBlb2YgY29uZGl0aW9uID09PSAnc3RyaW5nJykgew0KICAgICAgICBjb25kaXRpb24gPSBjb25kaXRpb24udG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnOw0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbmRpdGlvbiA9PT0gJ251bWJlcicpIHsNCiAgICAgICAgY29uZGl0aW9uID0gY29uZGl0aW9uICE9PSAwOw0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbmRpdGlvbiA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgLy8gSWYgaXQncyBhbiBvYmplY3Qgd2l0aCBhIHJlc3VsdCBmaWVsZCAoZnJvbSBjb25kaXRpb24gbm9kZSkNCiAgICAgICAgY29uZGl0aW9uID0gY29uZGl0aW9uLnJlc3VsdCA9PT0gdHJ1ZTsNCiAgICB9DQoNCiAgICAvLyBBcHBseSBpbnZlcnNpb24gaWYgY29uZmlndXJlZA0KICAgIGlmIChpbnZlcnQpIHsNCiAgICAgICAgY29uZGl0aW9uID0gIWNvbmRpdGlvbjsNCiAgICB9DQoNCiAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICBub2RlLmxhc3RDb25kaXRpb24gPSBjb25kaXRpb247DQogICAgbm9kZS5sYXN0SW52ZXJ0ZWQgPSBpbnZlcnQ7DQogICAgbm9kZS5sYXN0RGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjsNCg0KICAgIC8vIE9ubHkgcmV0dXJuIHRyaWdnZXIgaWYgY29uZGl0aW9uIGlzIHRydWUNCiAgICBpZiAoY29uZGl0aW9uKSB7DQogICAgICAgIHJldHVybiB7IHRyaWdnZXI6IERhdGUubm93KCkgfTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBSZXR1cm4gc3BlY2lhbCBvYmplY3QgdG8gaW5kaWNhdGUgZXhlY3V0aW9uIHNob3VsZCBzdG9wDQogICAgICAgIHJldHVybiB7IF9fc3RvcF9leGVjdXRpb246IHRydWUgfTsNCiAgICB9DQp9DQoNCi8vIEZvciBFYWNoIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVGb3JFYWNoTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBzdG9wT25FcnJvciA9IG5vZGUuY29uZmlnLnN0b3Bfb25fZXJyb3IudmFsdWUgPT09ICd0cnVlJzsNCiAgICANCiAgICAvLyBHZXQgdGhlIGl0ZXJhdGlvbiBkZWxheSBmcm9tIGNvbmZpZyAoaW4gbWlsbGlzZWNvbmRzKQ0KICAgIGNvbnN0IGl0ZXJhdGlvbkRlbGF5ID0gbm9kZS5jb25maWcuaXRlcmF0aW9uX2RlbGF5Py52YWx1ZSB8fCAwOw0KICAgIA0KICAgIC8vIEdldCB0aGUgYXJyYXkgZnJvbSBpbnB1dA0KICAgIGxldCBhcnJheSA9IGlucHV0RGF0YS5hcnJheTsNCiAgICANCiAgICAvLyBJZiBhcnJheSBpcyBub3QgcHJvdmlkZWQsIHRyeSBvdGhlciBjb21tb24gaW5wdXQgbmFtZXMNCiAgICBpZiAoIUFycmF5LmlzQXJyYXkoYXJyYXkpKSB7DQogICAgICAgIGFycmF5ID0gaW5wdXREYXRhLmRhdGEgfHwgaW5wdXREYXRhLmZpbGVfbmFtZXMgfHwgaW5wdXREYXRhLml0ZW1zOw0KICAgIH0NCiAgICANCiAgICAvLyBFbnN1cmUgd2UgaGF2ZSBhIHZhbGlkIGFycmF5DQogICAgaWYgKCFBcnJheS5pc0FycmF5KGFycmF5KSkgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZvciBFYWNoIG5vZGUgcmVxdWlyZXMgYW4gYXJyYXkgaW5wdXQnKTsNCiAgICB9DQoNCg0KICAgIC8vIEluaXRpYWxpemUgaXRlcmF0aW9uIHN0YXRlIGlmIG5vdCBleGlzdHMNCiAgICBpZiAoIW5vZGUuZm9yRWFjaFN0YXRlKSB7DQogICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlID0gew0KICAgICAgICAgICAgY3VycmVudEluZGV4OiAwLA0KICAgICAgICAgICAgYXJyYXk6IGFycmF5LA0KICAgICAgICAgICAgaXNJdGVyYXRpbmc6IGZhbHNlLA0KICAgICAgICAgICAgaXNFeGVjdXRpbmdJdGVyYXRpb246IGZhbHNlLA0KICAgICAgICAgICAgaW50ZXJ2YWw6IG51bGwNCiAgICAgICAgfTsNCiAgICB9DQoNCiAgICAvLyBJZiB0aGlzIGlzIGEgbWFudWFsIHRyaWdnZXIgKG5vdCBmcm9tIGludGVydmFsKSwgc3RhcnQgdGhlIGl0ZXJhdG9yDQogICAgaWYgKCFub2RlLmZvckVhY2hTdGF0ZS5pc0l0ZXJhdGluZykgew0KICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pc0l0ZXJhdGluZyA9IHRydWU7DQogICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmN1cnJlbnRJbmRleCA9IDA7DQogICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmFycmF5ID0gYXJyYXk7DQoNCiAgICAgICAgLy8gU3RhcnQgdGhlIGl0ZXJhdGlvbiBwcm9jZXNzaW5nIHdpdGggcHJvcGVyIHRpbWluZw0KICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pbnRlcnZhbCA9IHNldEludGVydmFsKGFzeW5jICgpID0+IHsNCiAgICAgICAgICAgIC8vIFNraXAgaWYgcHJldmlvdXMgaXRlcmF0aW9uIGlzIHN0aWxsIHJ1bm5pbmcNCiAgICAgICAgICAgIGlmIChub2RlLmZvckVhY2hTdGF0ZS5pc0V4ZWN1dGluZ0l0ZXJhdGlvbikgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKG5vZGUuZm9yRWFjaFN0YXRlLmN1cnJlbnRJbmRleCA8IG5vZGUuZm9yRWFjaFN0YXRlLmFycmF5Lmxlbmd0aCkgew0KICAgICAgICAgICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmlzRXhlY3V0aW5nSXRlcmF0aW9uID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50SXRlbSA9IG5vZGUuZm9yRWFjaFN0YXRlLmFycmF5W25vZGUuZm9yRWFjaFN0YXRlLmN1cnJlbnRJbmRleF07DQogICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEluZGV4ID0gbm9kZS5mb3JFYWNoU3RhdGUuY3VycmVudEluZGV4Ow0KICAgICAgICAgICAgICAgIA0KDQogICAgICAgICAgICAgICAgLy8gQ2xlYXIgYnVmZmVyIGZvciBtdWx0aS1pbnB1dCBub2RlcyBhdCBzdGFydCBvZiBlYWNoIGl0ZXJhdGlvbg0KICAgICAgICAgICAgICAgIGlmIChzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZ2xvYmFsTm9kZUlucHV0QnVmZmVyKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIENsZWFyIGFueSBkb3duc3RyZWFtIG11bHRpLWlucHV0IG5vZGUgYnVmZmVycyB0byBlbnN1cmUgZnJlc2ggc3RhdGUgZm9yIHRoaXMgaXRlcmF0aW9uDQogICAgICAgICAgICAgICAgICAgIC8vIEJ1dCBiZSBtb3JlIHNlbGVjdGl2ZSAtIG9ubHkgY2xlYXIgbm9kZXMgdGhhdCBhcmVuJ3QgaW1tZWRpYXRlIGNoaWxkcmVuDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGltbWVkaWF0ZUNoaWxkSWRzID0gW107DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGFsbERvd25zdHJlYW1JZHMgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZS5pZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltbWVkaWF0ZUNoaWxkSWRzLnB1c2goY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGFsbCBkb3duc3RyZWFtIG5vZGVzIChjaGlsZHJlbiBvZiBjaGlsZHJlbikNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmluZEFsbERvd25zdHJlYW0gPSAobm9kZUlkcywgdmlzaXRlZCA9IG5ldyBTZXQoKSkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBub2RlSWQgb2Ygbm9kZUlkcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aXNpdGVkLmhhcyhub2RlSWQpKSBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpdGVkLmFkZChub2RlSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbERvd25zdHJlYW1JZHMucHVzaChub2RlSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkSWRzID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IG5vZGVJZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRJZHMucHVzaChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluZEFsbERvd25zdHJlYW0oY2hpbGRJZHMsIHZpc2l0ZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZmluZEFsbERvd25zdHJlYW0oaW1tZWRpYXRlQ2hpbGRJZHMpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gT25seSBjbGVhciBidWZmZXJzIGZvciBkb3duc3RyZWFtIG5vZGVzIHRoYXQgYXJlbid0IGltbWVkaWF0ZSBjaGlsZHJlbg0KICAgICAgICAgICAgICAgICAgICBjb25zdCBub2Rlc1RvQ2xlYXIgPSBhbGxEb3duc3RyZWFtSWRzLmZpbHRlcihpZCA9PiAhaW1tZWRpYXRlQ2hpbGRJZHMuaW5jbHVkZXMoaWQpKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZUlkIG9mIG5vZGVzVG9DbGVhcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5nbG9iYWxOb2RlSW5wdXRCdWZmZXIuaGFzKG5vZGVJZCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZ2xvYmFsTm9kZUlucHV0QnVmZmVyLmRlbGV0ZShub2RlSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSB0aGUgY29ubmVjdGVkIHdvcmtmbG93IC0gdXNlIHRoZSBleGVjdXRpb24gZW5naW5lIGRpcmVjdGx5DQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBub2RlcyBjb25uZWN0ZWQgdG8gdGhlIGN1cnJlbnRfaXRlbSBvdXRwdXQgcG9ydA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0ZWROb2RlcyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IG5vZGUuaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXROb2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3RlZE5vZGVzLnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZTogdGFyZ2V0Tm9kZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UG9ydDogY29ubmVjdGlvbi50by5wb3J0TmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFBvcnQ6IGNvbm5lY3Rpb24uZnJvbS5wb3J0TmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBTZXQgYWxsIGNvbm5lY3RlZCBub2RlcyB0byBydW5uaW5nIHN0YXRlIGJlZm9yZSBleGVjdXRpb24NCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0ZWROb2RlSW5mbyBvZiBjb25uZWN0ZWROb2Rlcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0ZWROb2RlSW5mby5ub2RlLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2NvbXBsZXRlZCcsICdlcnJvcicsICd3YWl0aW5nLWlucHV0cycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3J1bm5pbmcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIEV4ZWN1dGUgZWFjaCBjb25uZWN0ZWQgbm9kZSB3aXRoIHRoZSBhcHByb3ByaWF0ZSBkYXRhDQogICAgICAgICAgICAgICAgICAgIC8vIFVzZSBzaGFyZWQgYnVmZmVyIGZvciB0aGUgZW50aXJlIGl0ZXJhdGlvbiBzbyBtdWx0aS1pbnB1dCBub2RlcyBjYW4gYWNjdW11bGF0ZQ0KICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVyYXRpb25FeGVjdXRlZCA9IG5ldyBTZXQoKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlcmF0aW9uSW5wdXRCdWZmZXIgPSBuZXcgTWFwKCk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBDb3B5IGFueSBleGlzdGluZyBidWZmZXIgZGF0YSBmcm9tIGdsb2JhbCBidWZmZXIgdGhhdCBtaWdodCBiZSBuZWVkZWQNCiAgICAgICAgICAgICAgICAgICAgaWYgKHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5nbG9iYWxOb2RlSW5wdXRCdWZmZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW25vZGVJZCwgYnVmZmVyRGF0YV0gb2Ygc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmdsb2JhbE5vZGVJbnB1dEJ1ZmZlci5lbnRyaWVzKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRpb25JbnB1dEJ1ZmZlci5zZXQobm9kZUlkLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpdmVkSW5wdXRzOiB7IC4uLmJ1ZmZlckRhdGEucmVjZWl2ZWRJbnB1dHMgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGVkUG9ydHM6IFsuLi5idWZmZXJEYXRhLmNvbm5lY3RlZFBvcnRzXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3RlZE5vZGVJbmZvIG9mIGNvbm5lY3RlZE5vZGVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW5wdXRWYWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFwIHRoZSBGb3IgRWFjaCBvdXRwdXRzIHRvIHRoZSBjb25uZWN0ZWQgbm9kZSdzIGlucHV0DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGVkTm9kZUluZm8ub3V0cHV0UG9ydCA9PT0gJ2N1cnJlbnRfaXRlbScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFZhbHVlID0gY3VycmVudEl0ZW07DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbm5lY3RlZE5vZGVJbmZvLm91dHB1dFBvcnQgPT09ICdjdXJyZW50X2luZGV4Jykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbnZlcnQgaW5kZXggdG8gc3RyaW5nIGZvciBjb21wYXRpYmlsaXR5IHdpdGggdGV4dC1iYXNlZCBub2Rlcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBTdHJpbmcoY3VycmVudEluZGV4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IGN1cnJlbnRJdGVtOyAvLyBEZWZhdWx0IHRvIGN1cnJlbnQgaXRlbQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgaW5wdXQgZGF0YSBmb3IgdGhlIGNvbm5lY3RlZCBub2RlDQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlSW5wdXREYXRhID0ge307DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlSW5wdXREYXRhW2Nvbm5lY3RlZE5vZGVJbmZvLmlucHV0UG9ydF0gPSBpbnB1dFZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVzZSB0aGUgd29ya2Zsb3cgZXhlY3V0aW9uIHN5c3RlbSB0byBlbnN1cmUgZG93bnN0cmVhbSBub2RlcyBleGVjdXRlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyB3aWxsIHRyaWdnZXIgdGhlIGNvbXBsZXRlIGV4ZWN1dGlvbiBjaGFpbiAobGxtIOKGkiBodHRwIOKGkiBldGMuKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV4ZWN1dGVOb2RlU21hcnQoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3RlZE5vZGVJbmZvLm5vZGUsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0ZWROb2RlSW5mby5pbnB1dFBvcnQsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFZhbHVlLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlcmF0aW9uRXhlY3V0ZWQsIC8vIFVzZSBzaGFyZWQgZXhlY3V0ZWQgc2V0IGZvciB0aGlzIGl0ZXJhdGlvbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRpb25JbnB1dEJ1ZmZlciAgLy8gVXNlIHNoYXJlZCBidWZmZXIgZm9yIHRoaXMgaXRlcmF0aW9uDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIG5vZGUgYXMgY29tcGxldGVkIGFmdGVyIHN1Y2Nlc3NmdWwgZXhlY3V0aW9uDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0ZWROb2RlSW5mby5ub2RlLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZWQnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChub2RlRXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIG5vZGUgYXMgZXJyb3IgaWYgZXhlY3V0aW9uIGZhaWxzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0ZWROb2RlSW5mby5ub2RlLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlcnJvcicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZS10aHJvdyB0aGUgZXJyb3IgdG8gYmUgaGFuZGxlZCBieSB0aGUgb3V0ZXIgY2F0Y2gNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBub2RlRXJyb3I7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgdGhpcyBpdGVyYXRpb24gYXMgY29tcGxldGUNCiAgICAgICAgICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaXNFeGVjdXRpbmdJdGVyYXRpb24gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZXhlY3V0aW5nIGZvciBlYWNoIGl0ZXJhdGlvbjonLCBlcnJvcik7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIHRoaXMgaXRlcmF0aW9uIGFzIGNvbXBsZXRlIGV2ZW4gb24gZXJyb3INCiAgICAgICAgICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaXNFeGVjdXRpbmdJdGVyYXRpb24gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgYW55IHN0aWxsLXJ1bm5pbmcgY29ubmVjdGVkIG5vZGVzIGFzIGVycm9yDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3RlZE5vZGVzID0gW107DQogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZS5pZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldE5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGVkTm9kZXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlOiB0YXJnZXROb2RlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRQb3J0OiBjb25uZWN0aW9uLnRvLnBvcnROYW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0UG9ydDogY29ubmVjdGlvbi5mcm9tLnBvcnROYW1lDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0ZWROb2RlSW5mbyBvZiBjb25uZWN0ZWROb2Rlcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0ZWROb2RlSW5mby5ub2RlLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCAmJiBub2RlRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ3J1bm5pbmcnKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlcnJvcicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAoc3RvcE9uRXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0b3AgdGhlIGl0ZXJhdGlvbg0KICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChub2RlLmZvckVhY2hTdGF0ZS5pbnRlcnZhbCk7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pc0l0ZXJhdGluZyA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaW50ZXJ2YWwgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy8gTW92ZSB0byBuZXh0IGl0ZW0NCiAgICAgICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5jdXJyZW50SW5kZXgrKzsNCg0KICAgICAgICAgICAgICAgIC8vIFN0b3AgaWYgd2UndmUgcHJvY2Vzc2VkIGFsbCBpdGVtcw0KICAgICAgICAgICAgICAgIGlmIChub2RlLmZvckVhY2hTdGF0ZS5jdXJyZW50SW5kZXggPj0gbm9kZS5mb3JFYWNoU3RhdGUuYXJyYXkubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwobm9kZS5mb3JFYWNoU3RhdGUuaW50ZXJ2YWwpOw0KICAgICAgICAgICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pc0l0ZXJhdGluZyA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pbnRlcnZhbCA9IG51bGw7DQoNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIEVuc3VyZSBhbGwgY29ubmVjdGVkIG5vZGVzIHNob3cgZmluYWwgY29tcGxldGVkIHN0YXR1cw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0ZWROb2RlcyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IG5vZGUuaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXROb2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3RlZE5vZGVzLnB1c2godGFyZ2V0Tm9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3RlZE5vZGUgb2YgY29ubmVjdGVkTm9kZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ubmVjdGVkTm9kZS5pZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQgJiYgIW5vZGVFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZXJyb3InKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnLCAnd2FpdGluZy1pbnB1dHMnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZWQnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwgaXRlcmF0aW9uRGVsYXkpOyAvLyBVc2UgY29uZmlndXJhYmxlIGl0ZXJhdGlvbiBkZWxheQ0KICAgICAgICANCiAgICAgICAgLy8gRG9uJ3QgcmV0dXJuIGFueSBkYXRhIGltbWVkaWF0ZWx5IC0gbGV0IHRoZSBpbnRlcnZhbCBoYW5kbGUgYWxsIGV4ZWN1dGlvbnMNCiAgICAgICAgLy8gVXNlIGEgc3BlY2lhbCBmbGFnIHRvIHByZXZlbnQgbWFpbiB3b3JrZmxvdyBmcm9tIGV4ZWN1dGluZyBkb3duc3RyZWFtIG5vZGVzDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBzdGFydGVkOiB0cnVlLA0KICAgICAgICAgICAgdG90YWxfaXRlbXM6IGFycmF5Lmxlbmd0aCwNCiAgICAgICAgICAgIGl0ZXJhdGlvbl9kZWxheTogaXRlcmF0aW9uRGVsYXksDQogICAgICAgICAgICBtZXNzYWdlOiBgRm9yIEVhY2ggaXRlcmF0aW9uIHN0YXJ0ZWQgd2l0aCAke2l0ZXJhdGlvbkRlbGF5fW1zIGRlbGF5YCwNCiAgICAgICAgICAgIF9fZm9yX2VhY2hfY29udHJvbDogdHJ1ZSAgLy8gU3BlY2lhbCBmbGFnIHRvIHByZXZlbnQgZG93bnN0cmVhbSBleGVjdXRpb24gYnkgbWFpbiB3b3JrZmxvdw0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgIC8vIElmIGFscmVhZHkgaXRlcmF0aW5nLCByZXR1cm4gY3VycmVudCBzdGF0ZQ0KICAgIHJldHVybiB7DQogICAgICAgIGlzSXRlcmF0aW5nOiBub2RlLmZvckVhY2hTdGF0ZS5pc0l0ZXJhdGluZywNCiAgICAgICAgY3VycmVudF9pbmRleDogbm9kZS5mb3JFYWNoU3RhdGUuY3VycmVudEluZGV4LA0KICAgICAgICB0b3RhbF9pdGVtczogbm9kZS5mb3JFYWNoU3RhdGUuYXJyYXkubGVuZ3RoDQogICAgfTsNCn0NCg0KLy8gRGVsYXkgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZURlbGF5Tm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBkZWxheU1zID0gcGFyc2VJbnQobm9kZS5jb25maWcuZGVsYXlfbXM/LnZhbHVlIHx8IG5vZGUuY29uZmlnLmRlbGF5X21zIHx8IDEwMDApOw0KICAgIA0KDQogICAgDQogICAgLy8gR2V0IHRoZSBpbnB1dCBkYXRhIHRvIHBhc3MgdGhyb3VnaCBhZnRlciBkZWxheQ0KICAgIGxldCBkYXRhVG9QYXNzVGhyb3VnaCA9IGlucHV0RGF0YS5kYXRhOw0KICAgIA0KICAgIC8vIElmIG5vIHNwZWNpZmljIGRhdGEgaW5wdXQsIHVzZSB0aGUgZmlyc3QgYXZhaWxhYmxlIGlucHV0DQogICAgaWYgKGRhdGFUb1Bhc3NUaHJvdWdoID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgY29uc3QgaW5wdXRLZXlzID0gT2JqZWN0LmtleXMoaW5wdXREYXRhKTsNCiAgICAgICAgaWYgKGlucHV0S2V5cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBkYXRhVG9QYXNzVGhyb3VnaCA9IGlucHV0RGF0YVtpbnB1dEtleXNbMF1dOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIC8vIFdhaXQgZm9yIHRoZSBzcGVjaWZpZWQgZGVsYXkNCiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsNCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICByZXNvbHZlKCk7DQogICAgICAgIH0sIGRlbGF5TXMpOw0KICAgIH0pOw0KICAgIA0KICAgIC8vIFJldHVybiB0aGUgc2FtZSBkYXRhIHRoYXQgd2FzIGlucHV0DQogICAgcmV0dXJuIHsNCiAgICAgICAgZGF0YTogZGF0YVRvUGFzc1Rocm91Z2gsDQogICAgICAgIG9yaWdpbmFsX2RhdGE6IGRhdGFUb1Bhc3NUaHJvdWdoLA0KICAgICAgICBwcm9jZXNzZWRfZGF0YTogZGF0YVRvUGFzc1Rocm91Z2gsDQogICAgICAgIGRlbGF5X21zOiBkZWxheU1zLA0KICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCkNCiAgICB9Ow0KfQ0KDQovLyBFeHBvcnQgdG8gZ2xvYmFsIHNjb3BlIHVzaW5nIGdldEFwcFdpbmRvdyBmb3IgYXV0b21hdGljIGNsZWFudXANCnN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RXhlY3V0b3JzID0gew0KICAgIGV4ZWN1dGVUaW1lck5vZGUsDQogICAgZXhlY3V0ZURpc3BsYXlOb2RlLA0KICAgIGV4ZWN1dGVSZXBlYXRlck5vZGUsDQogICAgZXhlY3V0ZUNvbmRpdGlvbk5vZGUsDQogICAgZXhlY3V0ZUxvZ2ljYWxHYXRlTm9kZSwNCiAgICBleGVjdXRlRm9yRWFjaE5vZGUsDQogICAgZXhlY3V0ZURlbGF5Tm9kZQ0KfTsNCg0KDQovLyBMTE0gQ2hhdCBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlTGxtQ2hhdE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgZW5kcG9pbnQgPSBub2RlLmNvbmZpZy5lbmRwb2ludC52YWx1ZTsNCiAgICBjb25zdCBtb2RlbCA9IG5vZGUuY29uZmlnLm1vZGVsLnZhbHVlOw0KICAgIGNvbnN0IHRlbXBlcmF0dXJlID0gcGFyc2VGbG9hdChub2RlLmNvbmZpZy50ZW1wZXJhdHVyZS52YWx1ZSk7DQogICAgY29uc3QgbWF4VG9rZW5zID0gcGFyc2VJbnQobm9kZS5jb25maWcubWF4X3Rva2Vucy52YWx1ZSk7DQogICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gbm9kZS5jb25maWcuc3lzdGVtX3Byb21wdC52YWx1ZTsNCiAgICBjb25zdCBpbmNsdWRlQ29udGV4dCA9IG5vZGUuY29uZmlnLmluY2x1ZGVfY29udGV4dC52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IGFwaUtleSA9IG5vZGUuY29uZmlnLmFwaV9rZXkudmFsdWU7DQoNCiAgICAvLyBBY2NlcHQgcHJvbXB0IGZyb20gZWl0aGVyICdwcm9tcHQnIG9yICd0ZXh0JyBpbnB1dA0KICAgIGxldCBwcm9tcHQgPSBpbnB1dERhdGEucHJvbXB0Ow0KICAgIGlmICghcHJvbXB0ICYmIGlucHV0RGF0YS50ZXh0KSB7DQogICAgICAgIHByb21wdCA9IGlucHV0RGF0YS50ZXh0Ow0KICAgIH0NCiAgICBpZiAoIXByb21wdCAmJiBpbnB1dERhdGEuY29udGV4dCkgew0KICAgICAgICAvLyBJZiBjb250ZXh0IGlzIGEgc3RyaW5nLCB1c2UgaXQgYXMgcHJvbXB0DQogICAgICAgIGlmICh0eXBlb2YgaW5wdXREYXRhLmNvbnRleHQgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICBwcm9tcHQgPSBpbnB1dERhdGEuY29udGV4dDsNCiAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGEuY29udGV4dCAmJiB0eXBlb2YgaW5wdXREYXRhLmNvbnRleHQgPT09ICdvYmplY3QnICYmIGlucHV0RGF0YS5jb250ZXh0LnRleHQpIHsNCiAgICAgICAgICAgIC8vIElmIGNvbnRleHQgaXMgYW4gb2JqZWN0IHdpdGggdGV4dCBmaWVsZCwgdXNlIHRoYXQNCiAgICAgICAgICAgIHByb21wdCA9IGlucHV0RGF0YS5jb250ZXh0LnRleHQ7DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKCFwcm9tcHQpIHsNCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdMTE0gQ2hhdCByZXF1aXJlcyBhIHByb21wdCBpbnB1dC4gQ29ubmVjdCBhIFRleHQgbm9kZSB0byBwcm92aWRlIHRoZSBwcm9tcHQuJyk7DQogICAgfQ0KDQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgbWVzc2FnZXMgPSBbXTsNCg0KICAgICAgICBpZiAoc3lzdGVtUHJvbXB0KSB7DQogICAgICAgICAgICBtZXNzYWdlcy5wdXNoKHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHN5c3RlbVByb21wdCB9KTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpbmNsdWRlQ29udGV4dCAmJiBpbnB1dERhdGEuY29udGV4dCkgew0KICAgICAgICAgICAgbWVzc2FnZXMucHVzaCh7IHJvbGU6ICd1c2VyJywgY29udGVudDogYENvbnRleHQ6ICR7SlNPTi5zdHJpbmdpZnkoaW5wdXREYXRhLmNvbnRleHQpfVxuXG5Qcm9tcHQ6ICR7cHJvbXB0fWAgfSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBtZXNzYWdlcy5wdXNoKHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBVc2UgdGhlIG5ldyBMTE0gQVBJIGZvciB1bml2ZXJzYWwgcHJvdmlkZXIgc3VwcG9ydA0KICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHN5cG5leEFQSS5sbG1Db21wbGV0ZSh7DQogICAgICAgICAgICBwcm92aWRlcjogJ29wZW5haScsDQogICAgICAgICAgICBlbmRwb2ludDogYCR7ZW5kcG9pbnR9L2NoYXQvY29tcGxldGlvbnNgLA0KICAgICAgICAgICAgbW9kZWw6IG1vZGVsLA0KICAgICAgICAgICAgbWVzc2FnZXM6IG1lc3NhZ2VzLA0KICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHRlbXBlcmF0dXJlLA0KICAgICAgICAgICAgbWF4VG9rZW5zOiBtYXhUb2tlbnMsDQogICAgICAgICAgICBzdHJlYW06IGZhbHNlLA0KICAgICAgICAgICAgYXBpS2V5OiBhcGlLZXkNCiAgICAgICAgfSk7DQoNCiAgICAgICAgLy8gSGFuZGxlIHByb3h5IHJlc3BvbnNlIGZvcm1hdA0KICAgICAgICAvLyBpZiAoIXJlc3BvbnNlIHx8IHJlc3BvbnNlLnN0YXR1cyA8IDIwMCB8fCByZXNwb25zZS5zdGF0dXMgPj0gMzAwKSB7DQogICAgICAgIC8vICAgICB0aHJvdyBuZXcgRXJyb3IoYFByb3h5IHJlcXVlc3QgZmFpbGVkOiAke3Jlc3BvbnNlPy5zdGF0dXMgfHwgJ1Vua25vd24gZXJyb3InfWApOw0KICAgICAgICAvLyB9DQoNCiAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYExMTSByZXF1ZXN0IGZhaWxlZDogJHtyZXNwb25zZS5lcnJvcn1gKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIC8vIFBhcnNlIHRoZSBKU09OIHJlc3BvbnNlIGNvbnRlbnQgZnJvbSBwcm94eQ0KICAgICAgICAvLyBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZS5jb250ZW50KTsNCg0KICAgICAgICAvLyBpZiAoZGF0YS5lcnJvcikgew0KICAgICAgICAvLyAgICAgdGhyb3cgbmV3IEVycm9yKGRhdGEuZXJyb3IubWVzc2FnZSB8fCAnTExNIEFQSSBlcnJvcicpOw0KICAgICAgICAvLyB9DQoNCiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXNwb25zZSk7DQogICAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IHJlc3BvbnNlLmNvbnRlbnQgfHwgJyc7DQoNCiAgICAgICAgLy9jb25zdCByZXNwb25zZVRleHQgPSBkYXRhLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgJyc7DQoNCiAgICAgICAgLy8gU3RvcmUgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgICAgIG5vZGUubGFzdFJlc3BvbnNlID0gcmVzcG9uc2VUZXh0Ow0KICAgICAgICBub2RlLmxhc3RVc2FnZSA9IHJlc3BvbnNlLnVzYWdlOw0KICAgICAgICBub2RlLmxhc3RNb2RlbCA9IHJlc3BvbnNlLm1vZGVsOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXNwb25zZTogcmVzcG9uc2VUZXh0LA0KICAgICAgICAgICAgdG9rZW5zX3VzZWQ6IHJlc3BvbnNlLnVzYWdlPy50b3RhbF90b2tlbnMgfHwgMCwNCiAgICAgICAgICAgIG1vZGVsX3VzZWQ6IHJlc3BvbnNlLm1vZGVsLA0KICAgICAgICAgICAgZnVsbF9yZXNwb25zZTogcmVzcG9uc2UNCiAgICAgICAgfTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdMTE0gQ2hhdCBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIHJldHVybiB7IHJlc3BvbnNlOiBudWxsLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9Ow0KICAgIH0NCn0NCg0KDQovLyBUZXJtaW5hbCBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlVGVybWluYWxOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGNvbW1hbmQgPSBub2RlLmNvbmZpZy5jb21tYW5kLnZhbHVlOw0KICAgIGNvbnN0IHVzZUlucHV0Q29tbWFuZCA9IG5vZGUuY29uZmlnLnVzZV9pbnB1dF9jb21tYW5kLnZhbHVlID09PSAndHJ1ZSc7DQogICAgY29uc3Qgd29ya2luZ0RpcmVjdG9yeSA9IG5vZGUuY29uZmlnLndvcmtpbmdfZGlyZWN0b3J5LnZhbHVlOw0KICAgIGNvbnN0IHRpbWVvdXQgPSBwYXJzZUludChub2RlLmNvbmZpZy50aW1lb3V0LnZhbHVlKTsNCg0KICAgIGxldCBmaW5hbENvbW1hbmQgPSBjb21tYW5kOw0KICAgIGlmICh1c2VJbnB1dENvbW1hbmQgJiYgaW5wdXREYXRhLmNvbW1hbmQpIHsNCiAgICAgICAgZmluYWxDb21tYW5kID0gaW5wdXREYXRhLmNvbW1hbmQ7DQogICAgfQ0KDQogICAgdHJ5IHsNCiAgICAgICAgLy8gVGhpcyB3b3VsZCBuZWVkIHRvIGJlIGltcGxlbWVudGVkIHdpdGggYWN0dWFsIHRlcm1pbmFsIGV4ZWN1dGlvbg0KICAgICAgICAvLyBGb3Igbm93LCB3ZSdsbCByZXR1cm4gYSBwbGFjZWhvbGRlcg0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBvdXRwdXQ6IGBDb21tYW5kIGV4ZWN1dGVkOiAke2ZpbmFsQ29tbWFuZH1gLA0KICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSwNCiAgICAgICAgICAgIGVycm9yOiBudWxsLA0KICAgICAgICAgICAgZXhpdF9jb2RlOiAwDQogICAgICAgIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVGVybWluYWwgZXhlY3V0aW9uIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIG91dHB1dDogbnVsbCwNCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLA0KICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsDQogICAgICAgICAgICBleGl0X2NvZGU6IDENCiAgICAgICAgfTsNCiAgICB9DQp9DQoNCi8vIEV4cG9ydCB0byBnbG9iYWwgc2NvcGUNCnN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5haUV4ZWN1dG9ycyA9IHsNCiAgICBleGVjdXRlTGxtQ2hhdE5vZGUsDQogICAgZXhlY3V0ZVRlcm1pbmFsTm9kZQ0KfTsNCg0KLy8gZXhlY3V0aW9uLWVuZ2luZS5qcyAtIER5bmFtaWMgZXhlY3V0aW9uIGVuZ2luZSBmb3IgRmxvdyBFZGl0b3INCg0KY2xhc3MgRXhlY3V0aW9uRW5naW5lIHsNCiAgICBjb25zdHJ1Y3RvcihyZWdpc3RyeSkgew0KICAgICAgICB0aGlzLnJlZ2lzdHJ5ID0gcmVnaXN0cnk7DQogICAgICAgIHRoaXMuc2V0dXBFeGVjdXRvcnMoKTsNCiAgICB9DQoNCiAgICBzZXR1cEV4ZWN1dG9ycygpIHsNCiAgICAgICAgLy8gUmVnaXN0ZXIgZXhlY3V0b3JzIGZyb20gZXh0ZXJuYWwgZmlsZXMgd2l0aCBlbmdpbmUgaW5zdGFuY2UgcGFzc2VkIGFzIGZpcnN0IHBhcmFtZXRlcg0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2h0dHBfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuaHR0cEV4ZWN1dG9ycy5leGVjdXRlSHR0cE5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3Zmc19zYXZlX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmh0dHBFeGVjdXRvcnMuZXhlY3V0ZVZmc1NhdmVOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd2ZnNfbG9hZF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5odHRwRXhlY3V0b3JzLmV4ZWN1dGVWZnNMb2FkTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigndmZzX2RpcmVjdG9yeV9saXN0X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmh0dHBFeGVjdXRvcnMuZXhlY3V0ZVZmc0RpcmVjdG9yeUxpc3ROb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgICAgIA0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3RpbWVyX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFeGVjdXRvcnMuZXhlY3V0ZVRpbWVyTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignZGlzcGxheV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RXhlY3V0b3JzLmV4ZWN1dGVEaXNwbGF5Tm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigncmVwZWF0ZXJfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0V4ZWN1dG9ycy5leGVjdXRlUmVwZWF0ZXJOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdjb25kaXRpb25fZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0V4ZWN1dG9ycy5leGVjdXRlQ29uZGl0aW9uTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignbG9naWNhbF9nYXRlX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFeGVjdXRvcnMuZXhlY3V0ZUxvZ2ljYWxHYXRlTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignZm9yX2VhY2hfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0V4ZWN1dG9ycy5leGVjdXRlRm9yRWFjaE5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2RlbGF5X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFeGVjdXRvcnMuZXhlY3V0ZURlbGF5Tm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgICAgICANCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdhdWRpb19leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5tZWRpYUV4ZWN1dG9ycy5leGVjdXRlQXVkaW9Ob2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdpbWFnZV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5tZWRpYUV4ZWN1dG9ycy5leGVjdXRlSW1hZ2VOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgICAgIA0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2pzb25fZXh0cmFjdF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVKc29uRXh0cmFjdE5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3JhbmRvbV9saW5lX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmRhdGFFeGVjdXRvcnMuZXhlY3V0ZVJhbmRvbVF1b3RlTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigndGV4dF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVUZXh0Tm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignbWF0aF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVNYXRoTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignYXJyYXlfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZGF0YUV4ZWN1dG9ycy5leGVjdXRlQXJyYXlOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdzdHJpbmdfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZGF0YUV4ZWN1dG9ycy5leGVjdXRlU3RyaW5nTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignbm9kZV9yZWZlcmVuY2VfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZGF0YUV4ZWN1dG9ycy5leGVjdXRlTm9kZVJlZmVyZW5jZU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3JhbmRvbV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVSYW5kb21Ob2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgICAgIA0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2xsbV9jaGF0X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmFpRXhlY3V0b3JzLmV4ZWN1dGVMbG1DaGF0Tm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigndGVybWluYWxfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuYWlFeGVjdXRvcnMuZXhlY3V0ZVRlcm1pbmFsTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgfQ0KDQogICAgYXN5bmMgZXhlY3V0ZU5vZGUobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgICAgICBjb25zdCBub2RlRGVmID0gdGhpcy5yZWdpc3RyeS5nZXROb2RlVHlwZShub2RlLnR5cGUpOw0KICAgICAgICBpZiAoIW5vZGVEZWYpIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gbm9kZSBkZWZpbml0aW9uIGZvdW5kIGZvciB0eXBlOiAke25vZGUudHlwZX1gKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGNvbnN0IGV4ZWN1dG9yTmFtZSA9IG5vZGVEZWYuZXhlY3V0b3I7DQogICAgICAgIGNvbnN0IGV4ZWN1dG9yID0gdGhpcy5yZWdpc3RyeS5nZXRFeGVjdXRvcihleGVjdXRvck5hbWUpOw0KDQogICAgICAgIGlmICghZXhlY3V0b3IpIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gZXhlY3V0b3IgZm91bmQgZm9yOiAke2V4ZWN1dG9yTmFtZX1gKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBhd2FpdCBleGVjdXRvcihub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKTsNCiAgICB9DQoNCg0KDQogICAgLy8gU3RvcCByZXBlYXRlciBtZXRob2QNCiAgICBzdG9wUmVwZWF0ZXIobm9kZSkgew0KICAgICAgICBpZiAobm9kZS5yZXBlYXRlclN0YXRlICYmIG5vZGUucmVwZWF0ZXJTdGF0ZS5pbnRlcnZhbCkgew0KICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChub2RlLnJlcGVhdGVyU3RhdGUuaW50ZXJ2YWwpOw0KICAgICAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmludGVydmFsID0gbnVsbDsNCiAgICAgICAgICAgIG5vZGUucmVwZWF0ZXJTdGF0ZS5pc1J1bm5pbmcgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIFN0b3AgZm9yIGVhY2ggbWV0aG9kDQogICAgc3RvcEZvckVhY2gobm9kZSkgew0KICAgICAgICBpZiAobm9kZS5mb3JFYWNoU3RhdGUgJiYgbm9kZS5mb3JFYWNoU3RhdGUuaW50ZXJ2YWwpIHsNCiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwobm9kZS5mb3JFYWNoU3RhdGUuaW50ZXJ2YWwpOw0KICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaW50ZXJ2YWwgPSBudWxsOw0KICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaXNJdGVyYXRpbmcgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KDQoNCg0KfQ0KDQovLyBHbG9iYWwgZXhlY3V0aW9uIGVuZ2luZSBpbnN0YW5jZQ0KY29uc3QgZXhlY3V0aW9uRW5naW5lID0gbmV3IEV4ZWN1dGlvbkVuZ2luZShub2RlUmVnaXN0cnkpOw0KDQoNCi8vIHdvcmtmbG93LmpzIC0gV29ya2Zsb3cgZXhlY3V0aW9uIGxvZ2ljIGZvciBGbG93IEVkaXRvcg0KDQovLyBSdW4gdGhlIHdvcmtmbG93DQphc3luYyBmdW5jdGlvbiBydW5Xb3JrZmxvdygpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5pc1J1bm5pbmcpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBmbG93RWRpdG9yLmlzUnVubmluZyA9IHRydWU7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3J1bi13b3JrZmxvdycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0b3Atd29ya2Zsb3cnKS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1mbGV4JzsNCiAgICANCiAgICAvLyBDbGVhciBhbGwgdmlzdWFsIHN0YXRlcyBmcm9tIHByZXZpb3VzIHJ1bnMNCiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmxvdy1ub2RlJykuZm9yRWFjaChub2RlID0+IHsNCiAgICAgICAgbm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJywgJ3dhaXRpbmctaW5wdXRzJywgJ2NvbXBsZXRlZCcsICdlcnJvcicpOw0KICAgIH0pOw0KICAgIA0KICAgIC8vIENsZWFyIG91dHB1dA0KICAgIGNvbnN0IG91dHB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleGVjdXRpb24tb3V0cHV0Jyk7DQogICAgb3V0cHV0LmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPSJsb2ctZW50cnkgaW5mbyI+U3RhcnRpbmcgd29ya2Zsb3cgZXhlY3V0aW9uLi4uPC9kaXY+JzsNCiAgICANCiAgICB0cnkgew0KICAgICAgICAvLyBGaW5kIHN0YXJ0IG5vZGVzIChub2RlcyB3aXRoIG5vIGlucHV0cyB0aGF0IGFyZSBwYXJ0IG9mIGEgY29ubmVjdGVkIHdvcmtmbG93KQ0KICAgICAgICBjb25zdCBzdGFydE5vZGVzID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLm5vZGVzLnZhbHVlcygpKS5maWx0ZXIobm9kZSA9PiB7DQogICAgICAgICAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgICAgICAgICBpZiAoIW5vZGVEZWYpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYE5vIG5vZGUgZGVmaW5pdGlvbiBmb3VuZCBmb3IgdHlwZTogJHtub2RlLnR5cGV9YCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFRpbWVyIGFuZCBSZXBlYXRlciBub2RlcyBhcmUgc3RhcnQgbm9kZXMgKGNhbiB0cmlnZ2VyIHRoZW1zZWx2ZXMpDQogICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAndGltZXInIHx8IG5vZGUudHlwZSA9PT0gJ3JlcGVhdGVyJykgew0KICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNSdW5uaW5nID0gbm9kZS5yZXBlYXRlclN0YXRlICYmIG5vZGUucmVwZWF0ZXJTdGF0ZS5pc1J1bm5pbmc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vIFRpbWVyL1JlcGVhdGVyIGlzIGEgc3RhcnQgbm9kZSBpZiBpdCBoYXMgY29ubmVjdGVkIG91dHB1dHMNCiAgICAgICAgICAgICAgICBjb25zdCBoYXNDb25uZWN0ZWRPdXRwdXRzID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5zb21lKGNvbm4gPT4gDQogICAgICAgICAgICAgICAgICAgIGNvbm4uZnJvbS5ub2RlSWQgPT09IG5vZGUuaWQNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIHJldHVybiBoYXNDb25uZWN0ZWRPdXRwdXRzOyAvLyBUaW1lci9SZXBlYXRlciBpcyBhIHN0YXJ0IG5vZGUgaWYgY29ubmVjdGVkDQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIElmIG5vZGUgaGFzIG5vIGlucHV0cywgY2hlY2sgaWYgaXQncyBwYXJ0IG9mIGEgY29ubmVjdGVkIHdvcmtmbG93DQogICAgICAgICAgICBpZiAobm9kZURlZi5pbnB1dHMubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBub2RlIGhhcyBhbnkgb3V0cHV0cyB0aGF0IGFyZSBjb25uZWN0ZWQgdG8gb3RoZXIgbm9kZXMNCiAgICAgICAgICAgICAgICBjb25zdCBoYXNDb25uZWN0ZWRPdXRwdXRzID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5zb21lKGNvbm4gPT4gDQogICAgICAgICAgICAgICAgICAgIGNvbm4uZnJvbS5ub2RlSWQgPT09IG5vZGUuaWQNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIE9ubHkgaW5jbHVkZSBpZiBpdCdzIGNvbm5lY3RlZCB0byB0aGUgd29ya2Zsb3cNCiAgICAgICAgICAgICAgICByZXR1cm4gaGFzQ29ubmVjdGVkT3V0cHV0czsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3Igbm9kZXMgd2l0aCBvcHRpb25hbCBpbnB1dHMNCiAgICAgICAgICAgIGNvbnN0IG9wdGlvbmFsSW5wdXRzID0gbm9kZURlZi5pbnB1dHMuZmlsdGVyKGlucHV0ID0+IGlucHV0Lm9wdGlvbmFsKTsNCiAgICAgICAgICAgIGlmIChvcHRpb25hbElucHV0cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBub2RlIGhhcyBjb25uZWN0ZWQgb3V0cHV0cw0KICAgICAgICAgICAgICAgIGNvbnN0IGhhc0Nvbm5lY3RlZE91dHB1dHMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLnNvbWUoY29ubiA9PiANCiAgICAgICAgICAgICAgICAgICAgY29ubi5mcm9tLm5vZGVJZCA9PT0gbm9kZS5pZA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGhhc0Nvbm5lY3RlZE91dHB1dHM7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIE5vZGVzIHdpdGggcmVxdWlyZWQgaW5wdXRzIGFyZSBub3Qgc3RhcnQgbm9kZXMgLSB0aGV5IHNob3VsZCBiZSB0cmlnZ2VyZWQgYnkgb3RoZXIgbm9kZXMNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICBpZiAoc3RhcnROb2Rlcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9ICdObyBzdGFydCBub2RlcyBmb3VuZC4gQWRkIG5vZGVzIHdpdGggbm8gaW5wdXRzIChUaW1lcikgb3Igbm9kZXMgd2l0aCBvcHRpb25hbCBpbnB1dHMgdGhhdCBhcmVuXCd0IGNvbm5lY3RlZCAoSFRUUCBSZXF1ZXN0KSc7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFNob3cgc2hvcnQsIGNsZWFyIG5vdGlmaWNhdGlvbiB0byB1c2VyDQogICAgICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKSB7DQogICAgICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ05vIHN0YXJ0IG5vZGVzIGZvdW5kIC0gY2hlY2sgZXhlY3V0aW9uIG91dHB1dCBmb3IgZGV0YWlscycsICdlcnJvcicsIDQwMDApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gRXhlY3V0ZSB3b3JrZmxvdw0KICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZXhlY3V0ZVdvcmtmbG93KHN0YXJ0Tm9kZXMpOw0KICAgICAgICANCiAgICAgICAgLy8gRGlzcGxheSByZXN1bHRzDQogICAgICAgIG91dHB1dC5pbm5lckhUTUwgKz0gJzxkaXYgY2xhc3M9ImxvZy1lbnRyeSBzdWNjZXNzIj5Xb3JrZmxvdyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5ITwvZGl2Pic7DQogICAgICAgIGZvciAoY29uc3QgcmVzdWx0IG9mIHJlc3VsdHMpIHsNCiAgICAgICAgICAgIG91dHB1dC5pbm5lckhUTUwgKz0gYDxkaXYgY2xhc3M9ImxvZy1lbnRyeSBpbmZvIj4ke3Jlc3VsdC5ub2RlSWR9OiAke3Jlc3VsdC5vdXRwdXR9PC9kaXY+YDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdXb3JrZmxvdyBleGVjdXRpb24gZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICBvdXRwdXQuaW5uZXJIVE1MICs9IGA8ZGl2IGNsYXNzPSJsb2ctZW50cnkgZXJyb3IiPkVycm9yOiAke2Vycm9yLm1lc3NhZ2V9PC9kaXY+YDsNCiAgICB9IGZpbmFsbHkgew0KICAgICAgICBmbG93RWRpdG9yLmlzUnVubmluZyA9IGZhbHNlOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncnVuLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtZmxleCc7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9wLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICB9DQp9DQoNCi8vIEV4ZWN1dGUgd29ya2Zsb3cNCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVXb3JrZmxvdyhzdGFydE5vZGVzKSB7DQogICAgY29uc3QgcmVzdWx0cyA9IFtdOw0KICAgIGNvbnN0IGV4ZWN1dGVkID0gbmV3IFNldCgpOw0KICAgIGNvbnN0IG5vZGVJbnB1dEJ1ZmZlciA9IG5ldyBNYXAoKTsgLy8gVHJhY2sgaW5wdXRzIGZvciBtdWx0aS1pbnB1dCBub2Rlcw0KICAgIA0KICAgIC8vIFN0b3JlIGdsb2JhbGx5IHNvIEZvciBFYWNoIGNhbiBhY2Nlc3MgaXQNCiAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZ2xvYmFsTm9kZUlucHV0QnVmZmVyID0gbm9kZUlucHV0QnVmZmVyOw0KICAgIA0KICAgIGZvciAoY29uc3Qgc3RhcnROb2RlIG9mIHN0YXJ0Tm9kZXMpIHsNCiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0ZU5vZGUoc3RhcnROb2RlLCB7fSwgZXhlY3V0ZWQsIG5vZGVJbnB1dEJ1ZmZlcik7DQogICAgICAgIGlmIChyZXN1bHQpIHJlc3VsdHMucHVzaChyZXN1bHQpOw0KICAgIH0NCiAgICANCiAgICByZXR1cm4gcmVzdWx0czsNCn0NCg0KLy8gRXhlY3V0ZSBhIHNpbmdsZSBub2RlIChkeW5hbWljIHZlcnNpb24pDQphc3luYyBmdW5jdGlvbiBleGVjdXRlTm9kZShub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkLCBub2RlSW5wdXRCdWZmZXIpIHsNCiAgICBpZiAoZXhlY3V0ZWQuaGFzKG5vZGUuaWQpKSB7DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCiAgICBleGVjdXRlZC5hZGQobm9kZS5pZCk7DQogICAgDQogICAgLy8gTWFyayBub2RlIGFzIHJ1bm5pbmcNCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGUuaWQpOw0KICAgIGlmIChub2RlRWxlbWVudCkgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncnVubmluZycpOw0KICAgIA0KICAgIHRyeSB7DQogICAgICAgIC8vIFVzZSB0aGUgZHluYW1pYyBleGVjdXRpb24gZW5naW5lDQogICAgICAgIGNvbnN0IG91dHB1dCA9IGF3YWl0IGV4ZWN1dGlvbkVuZ2luZS5leGVjdXRlTm9kZShub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKTsNCiAgICAgICAgDQogICAgICAgIC8vIFN0b3JlIG91dHB1dCBkYXRhIGZvciBjb25maWcgcGFuZWwgZGlzcGxheQ0KICAgICAgICBub2RlLmxhc3RPdXRwdXREYXRhID0gb3V0cHV0Ow0KICAgICAgICBub2RlLmxhc3RFeGVjdXRpb25UaW1lID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2hlY2sgaWYgb3V0cHV0IGluZGljYXRlcyBleGVjdXRpb24gc2hvdWxkIHN0b3AgKGxvZ2ljYWwgZ2F0ZSBzcGVjaWZpYykNCiAgICAgICAgaWYgKG91dHB1dCAmJiB0eXBlb2Ygb3V0cHV0ID09PSAnb2JqZWN0JyAmJiBvdXRwdXQuX19zdG9wX2V4ZWN1dGlvbiA9PT0gdHJ1ZSkgew0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBNYXJrIG5vZGUgYXMgY29tcGxldGVkDQogICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJyk7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIHJldHVybiB7IG5vZGVJZDogbm9kZS5pZCwgb3V0cHV0OiBudWxsIH07DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIENoZWNrIGZvciBmb3JfZWFjaCBjb250cm9sIGZsYWcgLSBza2lwIGRvd25zdHJlYW0gZXhlY3V0aW9uLCBsZXQgaW50ZXJ2YWwgaGFuZGxlIGl0DQogICAgICAgIGlmIChvdXRwdXQgJiYgdHlwZW9mIG91dHB1dCA9PT0gJ29iamVjdCcgJiYgb3V0cHV0Ll9fZm9yX2VhY2hfY29udHJvbCA9PT0gdHJ1ZSkgew0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBNYXJrIG5vZGUgYXMgY29tcGxldGVkIGJ1dCBkb24ndCBleGVjdXRlIGRvd25zdHJlYW0gbm9kZXMNCiAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnKTsNCiAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZWQnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgcmV0dXJuIHsgbm9kZUlkOiBub2RlLmlkLCBvdXRwdXQ6IG91dHB1dCB9Ow0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBGaW5kIGNvbm5lY3RlZCBub2RlcyBhbmQgZXhlY3V0ZSB0aGVtDQogICAgICAgIGNvbnN0IGNvbm5lY3RlZE5vZGVzID0gZmluZENvbm5lY3RlZE5vZGVzKG5vZGUuaWQpOw0KICAgICAgICANCiAgICAgICAgZm9yIChjb25zdCBjb25uZWN0ZWROb2RlIG9mIGNvbm5lY3RlZE5vZGVzKSB7DQogICAgICAgICAgICAvLyBDaGVjayBmb3IgY3ljbGVzIGJlZm9yZSBleGVjdXRpbmcNCiAgICAgICAgICAgIGlmIChleGVjdXRlZC5oYXMoY29ubmVjdGVkTm9kZS5ub2RlLmlkKSkgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEhhbmRsZSBvdXRwdXQgbWFwcGluZyB0byBpbnB1dCBwb3J0cyAtIERJUkVDVCBNQVBQSU5HDQogICAgICAgICAgICBsZXQgaW5wdXRWYWx1ZSA9IG91dHB1dDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKG91dHB1dCBpbnN0YW5jZW9mIEJsb2IpIHsNCiAgICAgICAgICAgICAgICAvLyBCbG9iIG91dHB1dCAtIHBhc3MgZGlyZWN0bHkgdG8gdGhlIGlucHV0IHBvcnQNCiAgICAgICAgICAgICAgICBpbnB1dFZhbHVlID0gb3V0cHV0Ow0KICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygb3V0cHV0ID09PSAnb2JqZWN0JyAmJiBvdXRwdXQgIT09IG51bGwpIHsNCiAgICAgICAgICAgICAgICAvLyBPYmplY3Qgb3V0cHV0IC0gZXh0cmFjdCB0aGUgRVhBQ1Qgb3V0cHV0IHBvcnQgZmllbGQNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGVkTm9kZS5vdXRwdXRQb3J0IGluIG91dHB1dCkgew0KICAgICAgICAgICAgICAgICAgICBpbnB1dFZhbHVlID0gb3V0cHV0W2Nvbm5lY3RlZE5vZGUub3V0cHV0UG9ydF07DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgTm9kZSAke25vZGUuaWR9IC0+ICR7Y29ubmVjdGVkTm9kZS5ub2RlLmlkfTogRVJST1IgLSBPdXRwdXQgcG9ydCAnJHtjb25uZWN0ZWROb2RlLm91dHB1dFBvcnR9JyBub3QgZm91bmQgaW4gb3V0cHV0IWApOw0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBBdmFpbGFibGUgZmllbGRzOmAsIE9iamVjdC5rZXlzKG91dHB1dCkpOw0KICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIHRoaXMgY29ubmVjdGlvbiBpbnN0ZWFkIG9mIHBhc3NpbmcgbnVsbA0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8vIFNpbXBsZSB2YWx1ZSBvdXRwdXQgLSBwYXNzIGRpcmVjdGx5DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAvLyBVc2Ugc21hcnQgZXhlY3V0aW9uIHRoYXQgaGFuZGxlcyBtdWx0aS1pbnB1dCBzeW5jaHJvbml6YXRpb24NCiAgICAgICAgICAgICAgICBhd2FpdCBleGVjdXRlTm9kZVNtYXJ0KGNvbm5lY3RlZE5vZGUubm9kZSwgY29ubmVjdGVkTm9kZS5pbnB1dFBvcnQsIGlucHV0VmFsdWUsIGV4ZWN1dGVkLCBub2RlSW5wdXRCdWZmZXIpOw0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBleGVjdXRpbmcgY29ubmVjdGVkIG5vZGUgJHtjb25uZWN0ZWROb2RlLm5vZGUuaWR9OmAsIGVycm9yKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXRQYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleGVjdXRpb24tb3V0cHV0Jyk7DQogICAgICAgICAgICAgICAgb3V0cHV0UGFuZWwuaW5uZXJIVE1MICs9IGA8ZGl2IGNsYXNzPSJsb2ctZW50cnkgZXJyb3IiPkVycm9yIGluIGNvbm5lY3RlZCBub2RlICR7Y29ubmVjdGVkTm9kZS5ub2RlLmlkfTogJHtlcnJvci5tZXNzYWdlfTwvZGl2PmA7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIE1hcmsgbm9kZSBhcyBjb21wbGV0ZWQNCiAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJyk7DQogICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZWQnKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHsgbm9kZUlkOiBub2RlLmlkLCBvdXRwdXQ6IG91dHB1dCB9Ow0KICAgICAgICANCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBleGVjdXRpbmcgbm9kZSAke25vZGUuaWR9OmAsIGVycm9yKTsNCiAgICAgICAgDQogICAgICAgIC8vIE1hcmsgbm9kZSBhcyBlcnJvcg0KICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnKTsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7DQogICAgfQ0KICAgIA0KICAgICAgICB0aHJvdyBlcnJvcjsNCiAgICB9IGZpbmFsbHkgew0KICAgICAgICAvLyBSZW1vdmUgcnVubmluZyBzdGF0ZQ0KICAgICAgICBpZiAobm9kZUVsZW1lbnQpIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnKTsNCiAgICB9DQp9DQoNCi8vIFNtYXJ0IGV4ZWN1dGlvbiBmdW5jdGlvbiB0aGF0IGhhbmRsZXMgbXVsdGktaW5wdXQgc3luY2hyb25pemF0aW9uDQphc3luYyBmdW5jdGlvbiBleGVjdXRlTm9kZVNtYXJ0KG5vZGUsIGlucHV0UG9ydCwgaW5wdXRWYWx1ZSwgZXhlY3V0ZWQsIG5vZGVJbnB1dEJ1ZmZlcikgew0KICAgIGNvbnN0IG5vZGVJZCA9IG5vZGUuaWQ7DQogICAgDQogICAgLy8gR2V0IGFsbCBjb25uZWN0ZWQgaW5wdXQgcG9ydHMgZm9yIHRoaXMgbm9kZQ0KICAgIGNvbnN0IGNvbm5lY3RlZElucHV0UG9ydHMgPSBnZXRDb25uZWN0ZWRJbnB1dFBvcnRzKG5vZGVJZCk7DQogICAgDQoNCiAgICANCiAgICAvLyBJZiBub2RlIGhhcyAwIG9yIDEgaW5wdXQgY29ubmVjdGlvbnMsIGV4ZWN1dGUgaW1tZWRpYXRlbHkNCiAgICBpZiAoY29ubmVjdGVkSW5wdXRQb3J0cy5sZW5ndGggPD0gMSkgew0KICAgICAgICByZXR1cm4gYXdhaXQgZXhlY3V0ZU5vZGUobm9kZSwgeyBbaW5wdXRQb3J0XTogaW5wdXRWYWx1ZSB9LCBleGVjdXRlZCwgbm9kZUlucHV0QnVmZmVyKTsNCiAgICB9DQogICAgDQogICAgLy8gTXVsdGktaW5wdXQgbm9kZSAtIG5lZWQgdG8gY29sbGVjdCBhbGwgaW5wdXRzIGJlZm9yZSBleGVjdXRpbmcNCiAgICBpZiAoIW5vZGVJbnB1dEJ1ZmZlci5oYXMobm9kZUlkKSkgew0KICAgICAgICBub2RlSW5wdXRCdWZmZXIuc2V0KG5vZGVJZCwgew0KICAgICAgICAgICAgcmVjZWl2ZWRJbnB1dHM6IHt9LA0KICAgICAgICAgICAgY29ubmVjdGVkUG9ydHM6IGNvbm5lY3RlZElucHV0UG9ydHMNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyBNYXJrIG5vZGUgYXMgd2FpdGluZyBmb3IgaW5wdXRzICh2aXN1YWwgZmVlZGJhY2spDQogICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCd3YWl0aW5nLWlucHV0cycpOw0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnY29tcGxldGVkJywgJ2Vycm9yJyk7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgY29uc3QgYnVmZmVyID0gbm9kZUlucHV0QnVmZmVyLmdldChub2RlSWQpOw0KICAgIA0KDQogICAgDQogICAgLy8gU3RvcmUgdGhpcyBpbnB1dA0KICAgIGJ1ZmZlci5yZWNlaXZlZElucHV0c1tpbnB1dFBvcnRdID0gaW5wdXRWYWx1ZTsNCiAgICANCiANCiAgICANCiAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGFsbCByZXF1aXJlZCBpbnB1dHMNCiAgICBjb25zdCBoYXNBbGxJbnB1dHMgPSBidWZmZXIuY29ubmVjdGVkUG9ydHMuZXZlcnkocG9ydCA9PiBwb3J0IGluIGJ1ZmZlci5yZWNlaXZlZElucHV0cyk7DQogICAgDQoNCiAgICANCiAgICBpZiAoIWhhc0FsbElucHV0cykgew0KDQogICAgICAgIC8vIFN0aWxsIHdhaXRpbmcgZm9yIG1vcmUgaW5wdXRzDQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCiAgICANCiAgICAvLyBBbGwgaW5wdXRzIHJlYWR5IC0gcmVtb3ZlIHdhaXRpbmcgc3RhdGUgYW5kIGV4ZWN1dGUhDQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCd3YWl0aW5nLWlucHV0cycpOw0KICAgIH0NCiAgICANCiAgICANCiAgICAvLyBDbGVhciBidWZmZXIgZm9yIG5leHQgZXhlY3V0aW9uDQogICAgbm9kZUlucHV0QnVmZmVyLmRlbGV0ZShub2RlSWQpOw0KICAgIA0KICAgIC8vIEV4ZWN1dGUgd2l0aCBhbGwgYWdncmVnYXRlZCBpbnB1dHMNCiAgICByZXR1cm4gYXdhaXQgZXhlY3V0ZU5vZGUobm9kZSwgYnVmZmVyLnJlY2VpdmVkSW5wdXRzLCBleGVjdXRlZCwgbm9kZUlucHV0QnVmZmVyKTsNCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGdldCBjb25uZWN0ZWQgaW5wdXQgcG9ydHMgZm9yIGEgbm9kZQ0KZnVuY3Rpb24gZ2V0Q29ubmVjdGVkSW5wdXRQb3J0cyhub2RlSWQpIHsNCiAgICBsZXQgY29ubmVjdGlvbnMgPSBudWxsOw0KICAgIA0KICAgIC8vIERlYnVnOiBMb2cgd2hhdCdzIGF2YWlsYWJsZSBvbiBmbG93RWRpdG9yICh0cnkgYm90aCBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvciBhbmQgZmxvd0VkaXRvcikNCiAgICANCiAgICAvLyBUcnkgdG8gYWNjZXNzIGZsb3dFZGl0b3IgZGlyZWN0bHkgKG5vdCB2aWEgd2luZG93KQ0KICAgIGxldCBlZGl0b3IgPSBudWxsOw0KICAgIGlmICh0eXBlb2YgZmxvd0VkaXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgZmxvd0VkaXRvcikgew0KICAgICAgICBlZGl0b3IgPSBmbG93RWRpdG9yOw0KICAgIH0gZWxzZSBpZiAoc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3IpIHsNCiAgICAgICAgZWRpdG9yID0gc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3I7DQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIFtdOw0KICAgIH0NCiAgICANCiAgICANCiAgICAvLyBUcnkgbXVsdGlwbGUgd2F5cyB0byBhY2Nlc3MgY29ubmVjdGlvbnMgZGF0YQ0KICAgIGlmIChlZGl0b3IuY29ubmVjdGlvbnMpIHsNCiAgICAgICAgY29ubmVjdGlvbnMgPSBlZGl0b3IuY29ubmVjdGlvbnM7DQogICAgfSBlbHNlIGlmIChlZGl0b3Iud29ya2Zsb3cgJiYgZWRpdG9yLndvcmtmbG93LmNvbm5lY3Rpb25zKSB7DQogICAgICAgIGNvbm5lY3Rpb25zID0gbmV3IE1hcChlZGl0b3Iud29ya2Zsb3cuY29ubmVjdGlvbnMubWFwKGNvbm4gPT4gW2Nvbm4uaWQsIGNvbm5dKSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIFtdOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBhbGxDb25uZWN0aW9ucyA9IEFycmF5LmZyb20oY29ubmVjdGlvbnMudmFsdWVzKCkpOw0KICAgIA0KICAgIC8vIExvZyBhbGwgY29ubmVjdGlvbnMgZm9yIGRlYnVnZ2luZw0KICAgIGFsbENvbm5lY3Rpb25zLmZvckVhY2goKGNvbm4sIGluZGV4KSA9PiB7DQogICAgfSk7DQogICAgDQogICAgY29uc3QgY29ubmVjdGVkUG9ydHMgPSBhbGxDb25uZWN0aW9ucw0KICAgICAgICAuZmlsdGVyKGNvbm4gPT4gew0KICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGNvbm4udG8ubm9kZUlkID09PSBub2RlSWQ7DQogICAgICAgICAgICBpZiAobWF0Y2hlcykgew0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXM7DQogICAgICAgIH0pDQogICAgICAgIC5tYXAoY29ubiA9PiBjb25uLnRvLnBvcnROYW1lKTsNCiAgICAgICAgDQogICAgcmV0dXJuIGNvbm5lY3RlZFBvcnRzOw0KfQ0KICAgIA0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHVwZGF0ZSBkaXNwbGF5IG5vZGUgY29udGVudCAodXNlZCBieSBleGVjdXRpb24gZW5naW5lKQ0KZnVuY3Rpb24gdXBkYXRlRGlzcGxheU5vZGVDb250ZW50KG5vZGVJZCwgY29udGVudCwgZm9ybWF0KSB7DQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgIGlmICghbm9kZUVsZW1lbnQpIHJldHVybjsNCiAgICANCiAgICBjb25zdCBkaXNwbGF5VGV4dCA9IG5vZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kaXNwbGF5LXRleHQnKTsNCiAgICBjb25zdCBmb3JtYXRFbGVtZW50ID0gbm9kZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLmRpc3BsYXktZm9ybWF0IHNwYW4nKTsNCiAgICANCiAgICBpZiAoZGlzcGxheVRleHQpIHsNCiAgICAgICAgbGV0IGZvcm1hdHRlZENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICANCiAgICBzd2l0Y2ggKGZvcm1hdCkgew0KICAgICAgICBjYXNlICdqc29uJzoNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UoY29udGVudCkgOiBjb250ZW50Ow0KICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRDb250ZW50ID0gSlNPTi5zdHJpbmdpZnkocGFyc2VkLCBudWxsLCAyKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgZm9ybWF0dGVkQ29udGVudCA9IGNvbnRlbnQ7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnaHRtbCc6DQogICAgICAgICAgICAgICAgZm9ybWF0dGVkQ29udGVudCA9IGNvbnRlbnQ7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAndGV4dCc6DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgZm9ybWF0dGVkQ29udGVudCA9IGNvbnRlbnQ7DQogICAgICAgICAgICBicmVhazsNCiAgICB9DQogICAgDQogICAgICAgIGRpc3BsYXlUZXh0LmlubmVySFRNTCA9IGA8cHJlIGNsYXNzPSJjb250ZW50LXRleHQiPiR7ZXNjYXBlSHRtbChmb3JtYXR0ZWRDb250ZW50KX08L3ByZT5gOw0KICAgIH0NCiAgICANCiAgICBpZiAoZm9ybWF0RWxlbWVudCkgew0KICAgICAgICBmb3JtYXRFbGVtZW50LnRleHRDb250ZW50ID0gZm9ybWF0Ow0KICAgIH0NCiAgICANCiAgICAvLyBTdG9yZSBmb3IgY29uZmlnIHBhbmVsIGRpc3BsYXkNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAobm9kZSkgew0KICAgICAgICBub2RlLmxhc3RDb250ZW50ID0gY29udGVudDsNCiAgICAgICAgbm9kZS5sYXN0Rm9ybWF0ID0gZm9ybWF0Ow0KICAgIH0NCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGVzY2FwZSBIVE1MDQpmdW5jdGlvbiBlc2NhcGVIdG1sKHRleHQpIHsNCiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBkaXYudGV4dENvbnRlbnQgPSB0ZXh0Ow0KICAgIHJldHVybiBkaXYuaW5uZXJIVE1MOw0KfQ0KDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gcmVwbGFjZSB0ZW1wbGF0ZSBwbGFjZWhvbGRlcnMNCmZ1bmN0aW9uIHJlcGxhY2VUZW1wbGF0ZVBsYWNlaG9sZGVycyh0ZW1wbGF0ZSwgZGF0YSkgew0KICAgIGlmICh0eXBlb2YgdGVtcGxhdGUgIT09ICdvYmplY3QnIHx8IHRlbXBsYXRlID09PSBudWxsKSB7DQogICAgICAgIHJldHVybiB0ZW1wbGF0ZTsNCiAgICB9DQogICAgDQogICAgaWYgKEFycmF5LmlzQXJyYXkodGVtcGxhdGUpKSB7DQogICAgICAgIHJldHVybiB0ZW1wbGF0ZS5tYXAoaXRlbSA9PiByZXBsYWNlVGVtcGxhdGVQbGFjZWhvbGRlcnMoaXRlbSwgZGF0YSkpOw0KICAgIH0NCiAgICANCiAgICBjb25zdCByZXN1bHQgPSB7fTsNCiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh0ZW1wbGF0ZSkpIHsNCiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIGxldCByZXBsYWNlZFZhbHVlID0gdmFsdWU7DQogICAgDQogICAgICAgICAgICAvLyBSZXBsYWNlIHt7VkFMVUV9fSB3aXRoIHRoZSBmdWxsIGRhdGEgb2JqZWN0DQogICAgICAgICAgICBpZiAodmFsdWUuaW5jbHVkZXMoJ3t7VkFMVUV9fScpKSB7DQogICAgICAgICAgICAgICAgcmVwbGFjZWRWYWx1ZSA9IHZhbHVlLnJlcGxhY2UoJ3t7VkFMVUV9fScsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTsNCn0NCg0KICAgICAgICAgICAgLy8gUmVwbGFjZSB7e0pTT046ZmllbGR9fSB3aXRoIHNwZWNpZmljIGZpZWxkDQogICAgICAgICAgICBjb25zdCBqc29uTWF0Y2hlcyA9IHZhbHVlLm1hdGNoKC9ce1x7SlNPTjooW159XSspXH1cfS9nKTsNCiAgICAgICAgICAgIGlmIChqc29uTWF0Y2hlcykgew0KICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbWF0Y2ggb2YganNvbk1hdGNoZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGQgPSBtYXRjaC5tYXRjaCgvXHtce0pTT046KFtefV0rKVx9XH0vKVsxXTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IGdldE5lc3RlZFZhbHVlKGRhdGEsIGZpZWxkKTsNCiAgICAgICAgICAgICAgICAgICAgcmVwbGFjZWRWYWx1ZSA9IHJlcGxhY2VkVmFsdWUucmVwbGFjZShtYXRjaCwgSlNPTi5zdHJpbmdpZnkoZmllbGRWYWx1ZSkpOw0KICAgICAgICAgICAgICAgIH0NCiAgICB9DQogICAgDQogICAgICAgICAgICAvLyBSZXBsYWNlIHt7ZmllbGR9fSB3aXRoIHNwZWNpZmljIGZpZWxkIHZhbHVlDQogICAgICAgICAgICBjb25zdCBmaWVsZE1hdGNoZXMgPSB2YWx1ZS5tYXRjaCgvXHtceyhbXn1dKylcfVx9L2cpOw0KICAgICAgICAgICAgaWYgKGZpZWxkTWF0Y2hlcykgew0KICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbWF0Y2ggb2YgZmllbGRNYXRjaGVzKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gbWF0Y2gubWF0Y2goL1x7XHsoW159XSspXH1cfS8pWzFdOw0KICAgICAgICAgICAgICAgICAgICBpZiAoZmllbGQgIT09ICdWQUxVRScgJiYgIWZpZWxkLnN0YXJ0c1dpdGgoJ0pTT046JykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBnZXROZXN0ZWRWYWx1ZShkYXRhLCBmaWVsZCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlZFZhbHVlID0gcmVwbGFjZWRWYWx1ZS5yZXBsYWNlKG1hdGNoLCBmaWVsZFZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgcmVzdWx0W2tleV0gPSByZXBsYWNlZFZhbHVlOw0KICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwpIHsNCiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gcmVwbGFjZVRlbXBsYXRlUGxhY2Vob2xkZXJzKHZhbHVlLCBkYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gdmFsdWU7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIHJlc3VsdDsNCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGdldCBuZXN0ZWQgb2JqZWN0IHZhbHVlcw0KZnVuY3Rpb24gZ2V0TmVzdGVkVmFsdWUob2JqLCBwYXRoKSB7DQogICAgY29uc3Qga2V5cyA9IHBhdGguc3BsaXQoJy4nKTsNCiAgICBsZXQgY3VycmVudCA9IG9iajsNCiAgICANCiAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7DQogICAgICAgIGlmIChjdXJyZW50ID09PSBudWxsIHx8IGN1cnJlbnQgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEhhbmRsZSBhcnJheSBhY2Nlc3MgbGlrZSAiaXRlbXNbMF0ubmFtZSINCiAgICAgICAgY29uc3QgYXJyYXlNYXRjaCA9IGtleS5tYXRjaCgvXiguKylcWyhcZCspXF0kLyk7DQogICAgICAgIGlmIChhcnJheU1hdGNoKSB7DQogICAgICAgICAgICBjb25zdCBhcnJheUtleSA9IGFycmF5TWF0Y2hbMV07DQogICAgICAgICAgICBjb25zdCBhcnJheUluZGV4ID0gcGFyc2VJbnQoYXJyYXlNYXRjaFsyXSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChjdXJyZW50W2FycmF5S2V5XSAmJiBBcnJheS5pc0FycmF5KGN1cnJlbnRbYXJyYXlLZXldKSkgew0KICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50W2FycmF5S2V5XVthcnJheUluZGV4XTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50W2tleV07DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIGN1cnJlbnQ7DQp9DQoNCi8vIFN0b3Agd29ya2Zsb3cgZXhlY3V0aW9uDQpmdW5jdGlvbiBzdG9wV29ya2Zsb3coKSB7DQogICAgICAgIGZsb3dFZGl0b3IuaXNSdW5uaW5nID0gZmFsc2U7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdydW4td29ya2Zsb3cnKS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1mbGV4JzsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0b3Atd29ya2Zsb3cnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICANCiAgICAvLyBDbGVhciBydW5uaW5nIHN0YXRlcyBmcm9tIGFsbCBub2Rlcw0KICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmxvdy1ub2RlLnJ1bm5pbmcsIC5mbG93LW5vZGUud2FpdGluZy1pbnB1dHMnKS5mb3JFYWNoKG5vZGUgPT4gew0KICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJywgJ3dhaXRpbmctaW5wdXRzJyk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICBjb25zdCBvdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhlY3V0aW9uLW91dHB1dCcpOw0KICAgIG91dHB1dC5pbm5lckhUTUwgKz0gJzxkaXYgY2xhc3M9ImxvZy1lbnRyeSB3YXJuaW5nIj5Xb3JrZmxvdyBleGVjdXRpb24gc3RvcHBlZCBieSB1c2VyPC9kaXY+JzsNCiAgICANCn0NCg0KLy8gRmluZCBub2RlcyBjb25uZWN0ZWQgdG8gYSBzcGVjaWZpYyBub2RlDQpmdW5jdGlvbiBmaW5kQ29ubmVjdGVkTm9kZXMobm9kZUlkKSB7DQogICAgY29uc3QgY29ubmVjdGVkTm9kZXMgPSBbXTsNCiAgICANCiAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkKSB7DQogICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgICAgICAgICAgaWYgKHRhcmdldE5vZGUpIHsNCiAgICAgICAgICAgICAgICBjb25uZWN0ZWROb2Rlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgbm9kZTogdGFyZ2V0Tm9kZSwNCiAgICAgICAgICAgICAgICAgICAgaW5wdXRQb3J0OiBjb25uZWN0aW9uLnRvLnBvcnROYW1lLA0KICAgICAgICAgICAgICAgICAgICBvdXRwdXRQb3J0OiBjb25uZWN0aW9uLmZyb20ucG9ydE5hbWUNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICByZXR1cm4gY29ubmVjdGVkTm9kZXM7DQp9DQoNCi8vIEZvcm1hdCBkYXRhIGZvciBwcmV2aWV3IGluIGNvbmZpZyBwYW5lbA0KZnVuY3Rpb24gZm9ybWF0RGF0YVByZXZpZXcoZGF0YSwgbWF4TGVuZ3RoID0gMjAwKSB7DQogICAgaWYgKGRhdGEgPT09IG51bGwgfHwgZGF0YSA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgIHJldHVybiB7IHR5cGU6ICdudWxsJywgcHJldmlldzogJ251bGwnIH07DQogICAgfQ0KICAgIA0KICAgIGlmIChkYXRhIGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICBjb25zdCBzaXplS0IgPSAoZGF0YS5zaXplIC8gMTAyNCkudG9GaXhlZCgyKTsNCiAgICAgICAgY29uc3Qgc2l6ZU1CID0gZGF0YS5zaXplID4gMTAyNCAqIDEwMjQgPyBgICgkeyhkYXRhLnNpemUgLyAoMTAyNCAqIDEwMjQpKS50b0ZpeGVkKDIpfSBNQilgIDogJyc7DQogICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgdHlwZTogJ0Jsb2InLCANCiAgICAgICAgICAgIHByZXZpZXc6IGAke2RhdGEudHlwZSB8fCAndW5rbm93bid9IC0gJHtzaXplS0J9IEtCJHtzaXplTUJ9YCwNCiAgICAgICAgICAgIHNpemU6IGRhdGEuc2l6ZQ0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7DQogICAgICAgIGNvbnN0IHNpemVLQiA9IChkYXRhLmJ5dGVMZW5ndGggLyAxMDI0KS50b0ZpeGVkKDIpOw0KICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgIHR5cGU6ICdBcnJheUJ1ZmZlcicsIA0KICAgICAgICAgICAgcHJldmlldzogYEJpbmFyeSBkYXRhIC0gJHtzaXplS0J9IEtCYCwNCiAgICAgICAgICAgIHNpemU6IGRhdGEuYnl0ZUxlbmd0aA0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkgfHwgZGF0YSBpbnN0YW5jZW9mIEludDhBcnJheSB8fCANCiAgICAgICAgZGF0YSBpbnN0YW5jZW9mIFVpbnQxNkFycmF5IHx8IGRhdGEgaW5zdGFuY2VvZiBJbnQxNkFycmF5IHx8DQogICAgICAgIGRhdGEgaW5zdGFuY2VvZiBVaW50MzJBcnJheSB8fCBkYXRhIGluc3RhbmNlb2YgSW50MzJBcnJheSB8fA0KICAgICAgICBkYXRhIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5IHx8IGRhdGEgaW5zdGFuY2VvZiBGbG9hdDY0QXJyYXkpIHsNCiAgICAgICAgY29uc3Qgc2l6ZUtCID0gKGRhdGEuYnl0ZUxlbmd0aCAvIDEwMjQpLnRvRml4ZWQoMik7DQogICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgdHlwZTogZGF0YS5jb25zdHJ1Y3Rvci5uYW1lLCANCiAgICAgICAgICAgIHByZXZpZXc6IGBCaW5hcnkgYXJyYXkgLSAke3NpemVLQn0gS0JgLA0KICAgICAgICAgICAgc2l6ZTogZGF0YS5ieXRlTGVuZ3RoDQogICAgICAgIH07DQogICAgfQ0KICAgIA0KICAgIGlmIChBcnJheS5pc0FycmF5KGRhdGEpKSB7DQogICAgICAgIC8vIENoZWNrIGlmIGl0J3MgbGlrZWx5IGJpbmFyeSBkYXRhIChhcnJheSBvZiBudW1iZXJzIDAtMjU1KQ0KICAgICAgICBpZiAoZGF0YS5sZW5ndGggPiAwICYmIGRhdGEuZXZlcnkoaXRlbSA9PiB0eXBlb2YgaXRlbSA9PT0gJ251bWJlcicgJiYgaXRlbSA+PSAwICYmIGl0ZW0gPD0gMjU1KSkgew0KICAgICAgICAgICAgY29uc3Qgc2l6ZUtCID0gKGRhdGEubGVuZ3RoIC8gMTAyNCkudG9GaXhlZCgyKTsNCiAgICAgICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgICAgIHR5cGU6ICdCaW5hcnkgQXJyYXknLCANCiAgICAgICAgICAgICAgICBwcmV2aWV3OiBgQmluYXJ5IGRhdGEgYXJyYXkgLSAke3NpemVLQn0gS0JgLA0KICAgICAgICAgICAgICAgIGxlbmd0aDogZGF0YS5sZW5ndGgNCiAgICAgICAgICAgIH07DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHByZXZpZXcgPSBkYXRhLmxlbmd0aCA+IDMgDQogICAgICAgICAgICA/IGBbJHtkYXRhLnNsaWNlKDAsIDMpLm1hcChpdGVtID0+IEpTT04uc3RyaW5naWZ5KGl0ZW0pKS5qb2luKCcsICcpfSwgLi4uXWANCiAgICAgICAgICAgIDogSlNPTi5zdHJpbmdpZnkoZGF0YSk7DQogICAgICAgIGNvbnN0IHRydW5jYXRlZCA9IHByZXZpZXcubGVuZ3RoID4gbWF4TGVuZ3RoID8gcHJldmlldy5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKSArICcuLi4nIDogcHJldmlldzsNCiAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICB0eXBlOiAnQXJyYXknLCANCiAgICAgICAgICAgIHByZXZpZXc6IHRydW5jYXRlZCwNCiAgICAgICAgICAgIGxlbmd0aDogZGF0YS5sZW5ndGgNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgaWYgKHR5cGVvZiBkYXRhID09PSAnb2JqZWN0Jykgew0KICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoZGF0YSk7DQogICAgICAgIA0KICAgICAgICAvLyBDaGVjayBpZiBpdCBsb29rcyBsaWtlIGEgbGFyZ2UgZGF0YSBvYmplY3QgKGhhcyBjb21tb24gbGFyZ2UgZGF0YSBpbmRpY2F0b3JzKQ0KICAgICAgICBjb25zdCBoYXNMYXJnZURhdGFJbmRpY2F0b3JzID0ga2V5cy5zb21lKGtleSA9PiANCiAgICAgICAgICAgIGtleS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdkYXRhJykgfHwgDQogICAgICAgICAgICBrZXkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYnVmZmVyJykgfHwNCiAgICAgICAgICAgIGtleS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdiYXNlNjQnKSB8fA0KICAgICAgICAgICAga2V5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2JpbmFyeScpDQogICAgICAgICk7DQogICAgICAgIA0KICAgICAgICBpZiAoaGFzTGFyZ2VEYXRhSW5kaWNhdG9ycykgew0KICAgICAgICAgICAgLy8gQ2hlY2sgc2l6ZXMgb2YgdmFsdWVzIHRoYXQgbWlnaHQgYmUgbGFyZ2UNCiAgICAgICAgICAgIGxldCB0b3RhbFNpemUgPSAwOw0KICAgICAgICAgICAgbGV0IGhhc0xhcmdlVmFsdWVzID0gZmFsc2U7DQogICAgICAgICAgICBjb25zdCBzdW1tYXJ5ID0ge307DQogICAgICAgICAgICANCiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHsNCiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGRhdGFba2V5XTsNCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiB2YWx1ZS5sZW5ndGggPiAxMDAwKSB7DQogICAgICAgICAgICAgICAgICAgIHN1bW1hcnlba2V5XSA9IGBTdHJpbmcgKCR7KHZhbHVlLmxlbmd0aCAvIDEwMjQpLnRvRml4ZWQoMil9IEtCKWA7DQogICAgICAgICAgICAgICAgICAgIHRvdGFsU2l6ZSArPSB2YWx1ZS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgIGhhc0xhcmdlVmFsdWVzID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeVtrZXldID0gYEFycmF5QnVmZmVyICgkeyh2YWx1ZS5ieXRlTGVuZ3RoIC8gMTAyNCkudG9GaXhlZCgyKX0gS0IpYDsNCiAgICAgICAgICAgICAgICAgICAgdG90YWxTaXplICs9IHZhbHVlLmJ5dGVMZW5ndGg7DQogICAgICAgICAgICAgICAgICAgIGhhc0xhcmdlVmFsdWVzID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA+IDEwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeVtrZXldID0gYEFycmF5WyR7dmFsdWUubGVuZ3RofV0gKCR7KHZhbHVlLmxlbmd0aCAvIDEwMjQpLnRvRml4ZWQoMil9IEtCIGVzdC4pYDsNCiAgICAgICAgICAgICAgICAgICAgdG90YWxTaXplICs9IHZhbHVlLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgaGFzTGFyZ2VWYWx1ZXMgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHN1bW1hcnlba2V5XSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyBgIiR7dmFsdWUuc3Vic3RyaW5nKDAsIDMwKX0uLi4iYCA6IHR5cGVvZiB2YWx1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChoYXNMYXJnZVZhbHVlcykgew0KICAgICAgICAgICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTGFyZ2UgT2JqZWN0JywgDQogICAgICAgICAgICAgICAgICAgIHByZXZpZXc6IEpTT04uc3RyaW5naWZ5KHN1bW1hcnksIG51bGwsIDIpLA0KICAgICAgICAgICAgICAgICAgICBrZXlzOiBrZXlzLmxlbmd0aCwNCiAgICAgICAgICAgICAgICAgICAgZXN0aW1hdGVkU2l6ZTogdG90YWxTaXplDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gUmVndWxhciBvYmplY3QgaGFuZGxpbmcNCiAgICAgICAgY29uc3QgcHJldmlldyA9IGtleXMubGVuZ3RoID4gMw0KICAgICAgICAgICAgPyBgeyR7a2V5cy5zbGljZSgwLCAzKS5qb2luKCcsICcpfSwgLi4ufWANCiAgICAgICAgICAgIDogSlNPTi5zdHJpbmdpZnkoZGF0YSk7DQogICAgICAgIGNvbnN0IHRydW5jYXRlZCA9IHByZXZpZXcubGVuZ3RoID4gbWF4TGVuZ3RoID8gcHJldmlldy5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKSArICcuLi4nIDogcHJldmlldzsNCiAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICB0eXBlOiAnT2JqZWN0JywgDQogICAgICAgICAgICBwcmV2aWV3OiB0cnVuY2F0ZWQsDQogICAgICAgICAgICBrZXlzOiBrZXlzLmxlbmd0aA0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgIC8vIENoZWNrIGlmIGl0J3MgYmFzZTY0IGRhdGENCiAgICAgICAgY29uc3QgaXNCYXNlNjQgPSAvXltBLVphLXowLTkrL10qPXswLDJ9JC8udGVzdChkYXRhKSAmJiBkYXRhLmxlbmd0aCA+IDEwMCAmJiBkYXRhLmxlbmd0aCAlIDQgPT09IDA7DQogICAgICAgIGlmIChpc0Jhc2U2NCkgew0KICAgICAgICAgICAgY29uc3Qgc2l6ZUtCID0gKGRhdGEubGVuZ3RoICogMC43NSAvIDEwMjQpLnRvRml4ZWQoMik7IC8vIEJhc2U2NCBpcyB+MzMlIGxhcmdlciB0aGFuIGJpbmFyeQ0KICAgICAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICAgICAgdHlwZTogJ0Jhc2U2NCBEYXRhJywgDQogICAgICAgICAgICAgICAgcHJldmlldzogYEJhc2U2NCBlbmNvZGVkIGRhdGEgLSAke3NpemVLQn0gS0JgLA0KICAgICAgICAgICAgICAgIGxlbmd0aDogZGF0YS5sZW5ndGgNCiAgICAgICAgICAgIH07DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIENoZWNrIGlmIGl0J3MgYSBkYXRhIFVSTA0KICAgICAgICBpZiAoZGF0YS5zdGFydHNXaXRoKCdkYXRhOicpKSB7DQogICAgICAgICAgICBjb25zdCBjb21tYUluZGV4ID0gZGF0YS5pbmRleE9mKCcsJyk7DQogICAgICAgICAgICBjb25zdCBoZWFkZXIgPSBjb21tYUluZGV4ID4gMCA/IGRhdGEuc3Vic3RyaW5nKDAsIGNvbW1hSW5kZXgpIDogZGF0YS5zdWJzdHJpbmcoMCwgNTApOw0KICAgICAgICAgICAgY29uc3QgZGF0YVNpemUgPSBjb21tYUluZGV4ID4gMCA/IGRhdGEubGVuZ3RoIC0gY29tbWFJbmRleCAtIDEgOiBkYXRhLmxlbmd0aDsNCiAgICAgICAgICAgIGNvbnN0IHNpemVLQiA9IChkYXRhU2l6ZSAqIDAuNzUgLyAxMDI0KS50b0ZpeGVkKDIpOw0KICAgICAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICAgICAgdHlwZTogJ0RhdGEgVVJMJywgDQogICAgICAgICAgICAgICAgcHJldmlldzogYCR7aGVhZGVyfS4uLiAtICR7c2l6ZUtCfSBLQmAsDQogICAgICAgICAgICAgICAgbGVuZ3RoOiBkYXRhLmxlbmd0aA0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gUmVndWxhciBzdHJpbmcgaGFuZGxpbmcNCiAgICAgICAgY29uc3QgdHJ1bmNhdGVkID0gZGF0YS5sZW5ndGggPiBtYXhMZW5ndGggPyBkYXRhLnN1YnN0cmluZygwLCBtYXhMZW5ndGgpICsgJy4uLicgOiBkYXRhOw0KICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgIHR5cGU6ICdTdHJpbmcnLCANCiAgICAgICAgICAgIHByZXZpZXc6IHRydW5jYXRlZCwNCiAgICAgICAgICAgIGxlbmd0aDogZGF0YS5sZW5ndGgNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgcmV0dXJuIHsgDQogICAgICAgIHR5cGU6IHR5cGVvZiBkYXRhLCANCiAgICAgICAgcHJldmlldzogU3RyaW5nKGRhdGEpIA0KICAgIH07DQp9DQoNCi8vIEdldCBvdXRwdXQgcG9ydCBkYXRhIGZvciBhIHNwZWNpZmljIG5vZGUgYW5kIHBvcnQNCmZ1bmN0aW9uIGdldE91dHB1dFBvcnREYXRhKG5vZGVJZCwgcG9ydElkKSB7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlIHx8ICFub2RlLmxhc3RPdXRwdXREYXRhKSB7DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCiAgICANCiAgICAvLyBJZiB0aGUgb3V0cHV0IGRhdGEgaXMgYW4gb2JqZWN0IHdpdGggbmFtZWQgcG9ydHMsIGV4dHJhY3QgdGhlIHNwZWNpZmljIHBvcnQNCiAgICBpZiAodHlwZW9mIG5vZGUubGFzdE91dHB1dERhdGEgPT09ICdvYmplY3QnICYmIG5vZGUubGFzdE91dHB1dERhdGEgIT09IG51bGwgJiYgIUFycmF5LmlzQXJyYXkobm9kZS5sYXN0T3V0cHV0RGF0YSkgJiYgIShub2RlLmxhc3RPdXRwdXREYXRhIGluc3RhbmNlb2YgQmxvYikgJiYgIShub2RlLmxhc3RPdXRwdXREYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpKSB7DQogICAgICAgIGlmIChwb3J0SWQgaW4gbm9kZS5sYXN0T3V0cHV0RGF0YSkgew0KICAgICAgICAgICAgcmV0dXJuIG5vZGUubGFzdE91dHB1dERhdGFbcG9ydElkXTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBQb3J0IG5vdCBmb3VuZCBpbiBvdXRwdXQgb2JqZWN0DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCiAgICANCiAgICAvLyBGb3Igc2luZ2xlIG91dHB1dCBub2RlcyBvciBub24tb2JqZWN0IG91dHB1dHMgKEJsb2IsIEFycmF5QnVmZmVyLCBwcmltaXRpdmVzKSwgDQogICAgLy8gb25seSByZXR1cm4gZGF0YSBmb3IgdGhlIGZpcnN0L3ByaW1hcnkgb3V0cHV0IHBvcnQNCiAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgaWYgKG5vZGVEZWYgJiYgbm9kZURlZi5vdXRwdXRzICYmIG5vZGVEZWYub3V0cHV0cy5sZW5ndGggPiAwKSB7DQogICAgICAgIC8vIE9ubHkgcmV0dXJuIGRhdGEgZm9yIHRoZSBmaXJzdCBvdXRwdXQgcG9ydCwgb3RoZXJzIGdldCBudWxsDQogICAgICAgIGlmIChwb3J0SWQgPT09IG5vZGVEZWYub3V0cHV0c1swXS5pZCkgew0KICAgICAgICAgICAgcmV0dXJuIG5vZGUubGFzdE91dHB1dERhdGE7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIA0KICAgIC8vIEZhbGxiYWNrOiByZXR1cm4gdGhlIGRhdGEgKHNob3VsZG4ndCBub3JtYWxseSByZWFjaCBoZXJlKQ0KICAgIHJldHVybiBub2RlLmxhc3RPdXRwdXREYXRhOw0KfSANCg0KLy8gVXBkYXRlIGNhbnZhcyB0cmFuc2Zvcm0gZm9yIHBhbm5pbmcgYW5kIHpvb21pbmcNCmZ1bmN0aW9uIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5jYW52YXMpIHsNCiAgICAgICAgLy8gVXNlIHJlcXVlc3RBbmltYXRpb25GcmFtZSB0byBwcmV2ZW50IHZpc3VhbCBmbGFzaGluZw0KICAgICAgICBpZiAoZmxvd0VkaXRvci50cmFuc2Zvcm1VcGRhdGVSZXF1ZXN0ZWQpIHJldHVybjsNCiAgICAgICAgZmxvd0VkaXRvci50cmFuc2Zvcm1VcGRhdGVSZXF1ZXN0ZWQgPSB0cnVlOw0KICAgICAgICANCiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHsNCiAgICAgICAgICAgIGlmIChmbG93RWRpdG9yLmNhbnZhcykgew0KICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHtmbG93RWRpdG9yLnBhbk9mZnNldC54fXB4LCAke2Zsb3dFZGl0b3IucGFuT2Zmc2V0Lnl9cHgpIHNjYWxlKCR7Zmxvd0VkaXRvci56b29tTGV2ZWx9KWA7DQogICAgICAgICAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNmb3JtID0gdHJhbnNmb3JtOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB6b29tIGxldmVsIGRpc3BsYXkNCiAgICAgICAgICAgICAgICBjb25zdCB6b29tRGlzcGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b29tLWxldmVsJyk7DQogICAgICAgICAgICAgICAgaWYgKHpvb21EaXNwbGF5KSB7DQogICAgICAgICAgICAgICAgICAgIHpvb21EaXNwbGF5LnRleHRDb250ZW50ID0gTWF0aC5yb3VuZChmbG93RWRpdG9yLnpvb21MZXZlbCAqIDEwMCkgKyAnJSc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZmxvd0VkaXRvci50cmFuc2Zvcm1VcGRhdGVSZXF1ZXN0ZWQgPSBmYWxzZTsNCiAgICAgICAgfSk7DQogICAgfQ0KfQ0KDQovLyBTdGFydCBjYW52YXMgcGFubmluZw0KZnVuY3Rpb24gc3RhcnRDYW52YXNQYW4oZSkgew0KICAgIC8vIE9ubHkgc3RhcnQgcGFubmluZyBpZiBjbGlja2luZyBkaXJlY3RseSBvbiBjYW52YXMgKG5vdCBvbiBub2RlcyBvciBvdGhlciBlbGVtZW50cykNCiAgICAvLyBhbmQgbm90IGFscmVhZHkgZHJhZ2dpbmcgYSBub2RlDQogICAgaWYgKGUudGFyZ2V0ID09PSBmbG93RWRpdG9yLmNhbnZhcyAmJiAhZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUpIHsNCiAgICAgICAgZmxvd0VkaXRvci5pc1Bhbm5pbmcgPSB0cnVlOw0KICAgICAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8NCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6DQogICAgICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgICAgIGZsb3dFZGl0b3IucGFuU3RhcnQgPSB7IHg6IG1vdXNlQ29vcmRzLngsIHk6IG1vdXNlQ29vcmRzLnkgfTsNCiAgICAgICAgZmxvd0VkaXRvci5sYXN0UGFuT2Zmc2V0ID0geyAuLi5mbG93RWRpdG9yLnBhbk9mZnNldCB9Ow0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS5jdXJzb3IgPSAnZ3JhYmJpbmcnOw0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5jbGFzc0xpc3QuYWRkKCdwYW5uaW5nJyk7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICB9DQp9DQoNCi8vIFVwZGF0ZSBjYW52YXMgcGFubmluZw0KZnVuY3Rpb24gdXBkYXRlQ2FudmFzUGFuKGUpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5pc1Bhbm5pbmcpIHsNCiAgICAgICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOg0KICAgICAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgICAgICBjb25zdCBkZWx0YVggPSBtb3VzZUNvb3Jkcy54IC0gZmxvd0VkaXRvci5wYW5TdGFydC54Ow0KICAgICAgICBjb25zdCBkZWx0YVkgPSBtb3VzZUNvb3Jkcy55IC0gZmxvd0VkaXRvci5wYW5TdGFydC55Ow0KDQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnggPSBmbG93RWRpdG9yLmxhc3RQYW5PZmZzZXQueCArIGRlbHRhWDsNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IGZsb3dFZGl0b3IubGFzdFBhbk9mZnNldC55ICsgZGVsdGFZOw0KDQogICAgICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgfQ0KfQ0KDQovLyBTdG9wIGNhbnZhcyBwYW5uaW5nDQpmdW5jdGlvbiBzdG9wQ2FudmFzUGFuKCkgew0KICAgIGlmIChmbG93RWRpdG9yLmlzUGFubmluZykgew0KICAgICAgICBmbG93RWRpdG9yLmlzUGFubmluZyA9IGZhbHNlOw0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS5jdXJzb3IgPSAnZ3JhYic7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLmNsYXNzTGlzdC5yZW1vdmUoJ3Bhbm5pbmcnKTsNCiAgICB9DQp9DQoNCi8vIFJlc2V0IGNhbnZhcyBwYW4gdG8gY2VudGVyDQpmdW5jdGlvbiByZXNldENhbnZhc1BhbigpIHsNCiAgICAvLyBQcmV2ZW50IGNvbmN1cnJlbnQgb3BlcmF0aW9ucw0KICAgIGlmIChmbG93RWRpdG9yLmlzUmVzZXR0aW5nKSByZXR1cm47DQogICAgZmxvd0VkaXRvci5pc1Jlc2V0dGluZyA9IHRydWU7DQogICAgDQogICAgLy8gQWRkIHNtb290aCB0cmFuc2l0aW9uIGZvciByZXNldCB3aXRoIGltcHJvdmVkIGVhc2luZw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zaXRpb24gPSAndHJhbnNmb3JtIDAuNXMgY3ViaWMtYmV6aWVyKDAuMjUsIDAuNDYsIDAuNDUsIDAuOTQpJzsNCg0KICAgIC8vIENhbGN1bGF0ZSBjZW50ZXIgb2YgYWxsIG5vZGVzIGlmIGFueSBleGlzdA0KICAgIGlmIChmbG93RWRpdG9yLm5vZGVzLnNpemUgPiAwKSB7DQogICAgICAgIGNvbnN0IG5vZGVzID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLm5vZGVzLnZhbHVlcygpKTsNCiAgICAgICAgY29uc3QgbWluWCA9IE1hdGgubWluKC4uLm5vZGVzLm1hcChuID0+IG4ueCkpOw0KICAgICAgICBjb25zdCBtYXhYID0gTWF0aC5tYXgoLi4ubm9kZXMubWFwKG4gPT4gbi54KSk7DQogICAgICAgIGNvbnN0IG1pblkgPSBNYXRoLm1pbiguLi5ub2Rlcy5tYXAobiA9PiBuLnkpKTsNCiAgICAgICAgY29uc3QgbWF4WSA9IE1hdGgubWF4KC4uLm5vZGVzLm1hcChuID0+IG4ueSkpOw0KDQogICAgICAgIGNvbnN0IGNlbnRlclggPSAobWluWCArIG1heFgpIC8gMjsNCiAgICAgICAgY29uc3QgY2VudGVyWSA9IChtaW5ZICsgbWF4WSkgLyAyOw0KDQogICAgICAgIC8vIEdldCBjYW52YXMgY29udGFpbmVyIGRpbWVuc2lvbnMgKHNjYWxlZCkNCiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOg0KICAgICAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KDQogICAgICAgIC8vIENhbGN1bGF0ZSBwYW4gb2Zmc2V0IHRvIGNlbnRlciB0aGUgbm9kZXMgaW4gdGhlIHZpZXdwb3J0DQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnggPSAtY2VudGVyWCArIGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOw0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC55ID0gLWNlbnRlclkgKyBjb250YWluZXJSZWN0LmhlaWdodCAvIDI7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gSWYgbm8gbm9kZXMsIHJlc2V0IHRvIGNlbnRlciBvZiB0aGUgbGFyZ2UgY2FudmFzDQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0ID0geyB4OiAtNTAwMCwgeTogLTUwMDAgfTsNCiAgICB9DQoNCiAgICAvLyBSZXNldCB6b29tIHRvIDEwMCUNCiAgICBmbG93RWRpdG9yLnpvb21MZXZlbCA9IDEuMDsNCg0KICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KDQogICAgLy8gUmVtb3ZlIHRyYW5zaXRpb24gYWZ0ZXIgYW5pbWF0aW9uIGNvbXBsZXRlcyB3aXRoIHByb3BlciB0aW1pbmcNCiAgICBjbGVhclRpbWVvdXQoZmxvd0VkaXRvci5yZXNldFRpbWVvdXQpOw0KICAgIGZsb3dFZGl0b3IucmVzZXRUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zaXRpb24gPSAnJzsNCiAgICAgICAgZmxvd0VkaXRvci5pc1Jlc2V0dGluZyA9IGZhbHNlOw0KICAgIH0sIDUwMCk7IC8vIE1hdGNoIHRyYW5zaXRpb24gZHVyYXRpb24NCn0NCg0KLy8gWm9vbSBmdW5jdGlvbnMNCmZ1bmN0aW9uIHpvb21JbigpIHsNCiAgICBjb25zdCBuZXdab29tID0gTWF0aC5taW4oZmxvd0VkaXRvci56b29tTGV2ZWwgKyBmbG93RWRpdG9yLnpvb21TdGVwLCBmbG93RWRpdG9yLm1heFpvb20pOw0KICAgIHNldFpvb21MZXZlbChuZXdab29tKTsNCn0NCg0KZnVuY3Rpb24gem9vbU91dCgpIHsNCiAgICBjb25zdCBuZXdab29tID0gTWF0aC5tYXgoZmxvd0VkaXRvci56b29tTGV2ZWwgLSBmbG93RWRpdG9yLnpvb21TdGVwLCBmbG93RWRpdG9yLm1pblpvb20pOw0KICAgIHNldFpvb21MZXZlbChuZXdab29tKTsNCn0NCg0KZnVuY3Rpb24gc2V0Wm9vbUxldmVsKHpvb21MZXZlbCkgew0KICAgIC8vIFByZXZlbnQgY29uY3VycmVudCB6b29tIG9wZXJhdGlvbnMgdG8gYXZvaWQgdmlzdWFsIGFydGlmYWN0cw0KICAgIGlmIChmbG93RWRpdG9yLmlzWm9vbWluZykgcmV0dXJuOw0KICAgIGZsb3dFZGl0b3IuaXNab29taW5nID0gdHJ1ZTsNCiAgICANCiAgICAvLyBBZGQgem9vbWluZyBjbGFzcyBmb3IgcGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9ucw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmNsYXNzTGlzdC5hZGQoJ3pvb21pbmcnKTsNCiAgICANCiAgICAvLyBHZXQgdGhlIGNlbnRlciBvZiB0aGUgY2FudmFzIGNvbnRhaW5lciBmb3Igem9vbSBvcmlnaW4NCiAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPw0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOg0KICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgDQogICAgY29uc3QgY2VudGVyWCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOw0KICAgIGNvbnN0IGNlbnRlclkgPSBjb250YWluZXJSZWN0LmhlaWdodCAvIDI7DQogICAgDQogICAgLy8gQ2FsY3VsYXRlIHRoZSBwb2ludCBpbiBjYW52YXMgY29vcmRpbmF0ZXMgdGhhdCBzaG91bGQgcmVtYWluIGZpeGVkDQogICAgY29uc3QgY2FudmFzWCA9IChjZW50ZXJYIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueCkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICBjb25zdCBjYW52YXNZID0gKGNlbnRlclkgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIA0KICAgIC8vIFVwZGF0ZSB6b29tIGxldmVsDQogICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSBNYXRoLm1heChmbG93RWRpdG9yLm1pblpvb20sIE1hdGgubWluKGZsb3dFZGl0b3IubWF4Wm9vbSwgem9vbUxldmVsKSk7DQogICAgDQogICAgLy8gQWRqdXN0IHBhbiBvZmZzZXQgdG8ga2VlcCB0aGUgY2VudGVyIHBvaW50IGZpeGVkDQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IGNlbnRlclggLSBjYW52YXNYICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IGNlbnRlclkgLSBjYW52YXNZICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgDQogICAgdXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgDQogICAgLy8gQ29uc29saWRhdGVkIHJlZHJhdyB0aW1pbmcgdG8gcHJldmVudCBtdWx0aXBsZSByZWRyYXdzDQogICAgY2xlYXJUaW1lb3V0KGZsb3dFZGl0b3Iuem9vbVJlZHJhd1RpbWVvdXQpOw0KICAgIGZsb3dFZGl0b3Iuem9vbVJlZHJhd1RpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuY2xhc3NMaXN0LnJlbW92ZSgnem9vbWluZycpOw0KICAgICAgICBmbG93RWRpdG9yLmlzWm9vbWluZyA9IGZhbHNlOw0KICAgIH0sIDMyKTsgLy8gSW5jcmVhc2VkIGZyb20gMTZtcyB0byBwcmV2ZW50IHRvbyBmcmVxdWVudCByZWRyYXdzDQp9DQoNCmZ1bmN0aW9uIHpvb21Ub0ZpdCgpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5ub2Rlcy5zaXplID09PSAwKSB7DQogICAgICAgIC8vIElmIG5vIG5vZGVzLCByZXNldCB0byAxMDAlIHpvb20gYW5kIGNlbnRlcg0KICAgICAgICBmbG93RWRpdG9yLnpvb21MZXZlbCA9IDEuMDsNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQgPSB7IHg6IC01MDAwLCB5OiAtNTAwMCB9Ow0KICAgICAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBQcmV2ZW50IGNvbmN1cnJlbnQgem9vbSBvcGVyYXRpb25zDQogICAgaWYgKGZsb3dFZGl0b3IuaXNab29taW5nKSByZXR1cm47DQogICAgZmxvd0VkaXRvci5pc1pvb21pbmcgPSB0cnVlOw0KICAgIA0KICAgIC8vIEZpbmQgYm91bmRzIG9mIGFsbCBub2Rlcw0KICAgIGNvbnN0IG5vZGVzID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLm5vZGVzLnZhbHVlcygpKTsNCiAgICBjb25zdCBwYWRkaW5nID0gMTAwOyAvLyBFeHRyYSBwYWRkaW5nIGFyb3VuZCBub2Rlcw0KICAgIA0KICAgIGxldCBtaW5YID0gSW5maW5pdHksIG1heFggPSAtSW5maW5pdHk7DQogICAgbGV0IG1pblkgPSBJbmZpbml0eSwgbWF4WSA9IC1JbmZpbml0eTsNCiAgICANCiAgICBub2Rlcy5mb3JFYWNoKG5vZGUgPT4gew0KICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGUuaWQpOw0KICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgIGNvbnN0IHJlY3QgPSBub2RlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCBub2RlLngpOw0KICAgICAgICAgICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIG5vZGUueCArIHJlY3Qud2lkdGgpOw0KICAgICAgICAgICAgbWluWSA9IE1hdGgubWluKG1pblksIG5vZGUueSk7DQogICAgICAgICAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgbm9kZS55ICsgcmVjdC5oZWlnaHQpOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gQWRkIHBhZGRpbmcNCiAgICBtaW5YIC09IHBhZGRpbmc7DQogICAgbWF4WCArPSBwYWRkaW5nOw0KICAgIG1pblkgLT0gcGFkZGluZzsNCiAgICBtYXhZICs9IHBhZGRpbmc7DQogICAgDQogICAgY29uc3QgY29udGVudFdpZHRoID0gbWF4WCAtIG1pblg7DQogICAgY29uc3QgY29udGVudEhlaWdodCA9IG1heFkgLSBtaW5ZOw0KICAgIA0KICAgIC8vIEdldCBjb250YWluZXIgZGltZW5zaW9ucw0KICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgY29uc3QgY29udGFpbmVyUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/DQogICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6DQogICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICANCiAgICAvLyBDYWxjdWxhdGUgem9vbSB0byBmaXQNCiAgICBjb25zdCB6b29tWCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyBjb250ZW50V2lkdGg7DQogICAgY29uc3Qgem9vbVkgPSBjb250YWluZXJSZWN0LmhlaWdodCAvIGNvbnRlbnRIZWlnaHQ7DQogICAgY29uc3QgbmV3Wm9vbSA9IE1hdGgubWluKHpvb21YLCB6b29tWSwgZmxvd0VkaXRvci5tYXhab29tKTsNCiAgICANCiAgICAvLyBTZXQgem9vbSBsZXZlbA0KICAgIGZsb3dFZGl0b3Iuem9vbUxldmVsID0gTWF0aC5tYXgoZmxvd0VkaXRvci5taW5ab29tLCBuZXdab29tKTsNCiAgICANCiAgICAvLyBDZW50ZXIgdGhlIGNvbnRlbnQNCiAgICBjb25zdCBjZW50ZXJYID0gKG1pblggKyBtYXhYKSAvIDI7DQogICAgY29uc3QgY2VudGVyWSA9IChtaW5ZICsgbWF4WSkgLyAyOw0KICAgIA0KICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnggPSBjb250YWluZXJSZWN0LndpZHRoIC8gMiAtIGNlbnRlclggKiBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICBmbG93RWRpdG9yLnBhbk9mZnNldC55ID0gY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyIC0gY2VudGVyWSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIA0KICAgIC8vIEFkZCBzbW9vdGggdHJhbnNpdGlvbiB3aXRoIGJldHRlciB0aW1pbmcNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS50cmFuc2l0aW9uID0gJ3RyYW5zZm9ybSAwLjRzIGN1YmljLWJlemllcigwLjI1LCAwLjQ2LCAwLjQ1LCAwLjk0KSc7DQogICAgdXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgDQogICAgLy8gUmVtb3ZlIHRyYW5zaXRpb24gYW5kIHJlZHJhdyB3aXRoIHByb3BlciB0aW1pbmcNCiAgICBjbGVhclRpbWVvdXQoZmxvd0VkaXRvci56b29tRml0VGltZW91dCk7DQogICAgZmxvd0VkaXRvci56b29tRml0VGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS50cmFuc2l0aW9uID0gJyc7DQogICAgICAgIC8vIFVzZSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgZm9yIHNtb290aCByZWRyYXcNCiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHsNCiAgICAgICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgICAgICAgICBmbG93RWRpdG9yLmlzWm9vbWluZyA9IGZhbHNlOw0KICAgICAgICB9KTsNCiAgICB9LCA0MDApOyAvLyBNYXRjaCB0cmFuc2l0aW9uIGR1cmF0aW9uDQp9DQoNCi8vIEhhbmRsZSBtb3VzZSB3aGVlbCB6b29tDQpmdW5jdGlvbiBoYW5kbGVNb3VzZVdoZWVsKGUpIHsNCiAgICBpZiAoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIA0KICAgICAgICAvLyBUaHJvdHRsZSB3aGVlbCBldmVudHMgdG8gcHJldmVudCBvdmVyd2hlbG1pbmcgdGhlIHN5c3RlbQ0KICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpOw0KICAgICAgICBpZiAoZmxvd0VkaXRvci5sYXN0V2hlZWxUaW1lICYmIG5vdyAtIGZsb3dFZGl0b3IubGFzdFdoZWVsVGltZSA8IDE2KSB7DQogICAgICAgICAgICByZXR1cm47IC8vIExpbWl0IHRvIH42MGZwcw0KICAgICAgICB9DQogICAgICAgIGZsb3dFZGl0b3IubGFzdFdoZWVsVGltZSA9IG5vdzsNCiAgICAgICAgDQogICAgICAgIC8vIEdldCBtb3VzZSBwb3NpdGlvbiByZWxhdGl2ZSB0byBjb250YWluZXINCiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOg0KICAgICAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICANCiAgICAgICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOg0KICAgICAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgICAgICANCiAgICAgICAgY29uc3QgbW91c2VYID0gbW91c2VDb29yZHMueCAtIGNvbnRhaW5lclJlY3QubGVmdDsNCiAgICAgICAgY29uc3QgbW91c2VZID0gbW91c2VDb29yZHMueSAtIGNvbnRhaW5lclJlY3QudG9wOw0KICAgICAgICANCiAgICAgICAgLy8gQ2FsY3VsYXRlIHpvb20gZGVsdGENCiAgICAgICAgY29uc3Qgem9vbURlbHRhID0gZS5kZWx0YVkgPiAwID8gLWZsb3dFZGl0b3Iuem9vbVN0ZXAgOiBmbG93RWRpdG9yLnpvb21TdGVwOw0KICAgICAgICBjb25zdCBuZXdab29tID0gTWF0aC5tYXgoZmxvd0VkaXRvci5taW5ab29tLCBNYXRoLm1pbihmbG93RWRpdG9yLm1heFpvb20sIGZsb3dFZGl0b3Iuem9vbUxldmVsICsgem9vbURlbHRhKSk7DQogICAgICAgIA0KICAgICAgICBpZiAobmV3Wm9vbSAhPT0gZmxvd0VkaXRvci56b29tTGV2ZWwpIHsNCiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgcG9pbnQgaW4gY2FudmFzIGNvb3JkaW5hdGVzIHRoYXQgc2hvdWxkIHJlbWFpbiBmaXhlZCAodW5kZXIgbW91c2UpDQogICAgICAgICAgICBjb25zdCBjYW52YXNYID0gKG1vdXNlWCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICBjb25zdCBjYW52YXNZID0gKG1vdXNlWSAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFVwZGF0ZSB6b29tIGxldmVsDQogICAgICAgICAgICBmbG93RWRpdG9yLnpvb21MZXZlbCA9IG5ld1pvb207DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEFkanVzdCBwYW4gb2Zmc2V0IHRvIGtlZXAgdGhlIG1vdXNlIHBvaW50IGZpeGVkDQogICAgICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gbW91c2VYIC0gY2FudmFzWCAqIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IG1vdXNlWSAtIGNhbnZhc1kgKiBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgdXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENvbnNvbGlkYXRlZCByZWRyYXcgdGltaW5nIHdpdGggZGVib3VuY2luZw0KICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGZsb3dFZGl0b3Iuem9vbVJlZHJhd1RpbWVvdXQpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci56b29tUmVkcmF3VGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgICAgICAgICB9LCAxMDApOyAvLyBJbmNyZWFzZWQgZGVib3VuY2UgdGltZSBmb3Igd2hlZWwgem9vbWluZw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBIYW5kbGUgY2FudmFzIGNsaWNrIGV2ZW50cw0KZnVuY3Rpb24gaGFuZGxlQ2FudmFzQ2xpY2soZSkgew0KICAgIGlmIChlLnRhcmdldCA9PT0gZmxvd0VkaXRvci5jYW52YXMpIHsNCiAgICAgICAgLy8gRGVzZWxlY3Qgbm9kZQ0KICAgICAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpIHsNCiAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpOw0KICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPSBudWxsOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUtY29uZmlnJykuaW5uZXJIVE1MID0gJzxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5TZWxlY3QgYSBub2RlIHRvIGNvbmZpZ3VyZSBpdDwvcD4nOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBIYW5kbGUgZG9jdW1lbnQgbW91c2UgZXZlbnRzIGZvciBzbW9vdGggZHJhZ2dpbmcNCmZ1bmN0aW9uIGhhbmRsZURvY3VtZW50TW91c2VEb3duKGUpIHsNCiAgICAvLyBEb24ndCBzdGFydCBkcmFnZ2luZyBpZiBjbGlja2luZyBvbiBVSSBlbGVtZW50cw0KICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KCcuZmxvdy10b29sYmFyJykgfHwgDQogICAgICAgIGUudGFyZ2V0LmNsb3Nlc3QoJy5mbG93LWNvbmZpZy1wYW5lbCcpIHx8IA0KICAgICAgICBlLnRhcmdldC5jbG9zZXN0KCcuZmxvdy1vdXRwdXQtcGFuZWwnKSB8fA0KICAgICAgICBlLnRhcmdldC5jbG9zZXN0KCcubm9kZS1kZWxldGUtYnRuJykpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBEb24ndCBzdGFydCBkcmFnZ2luZyBpZiB3ZSdyZSBwYW5uaW5nDQogICAgaWYgKGZsb3dFZGl0b3IuaXNQYW5uaW5nKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gT25seSBhbGxvdyBkcmFnZ2luZyBmcm9tIHRoZSBub2RlIGhlYWRlcg0KICAgIGNvbnN0IGhlYWRlckVsZW1lbnQgPSBlLnRhcmdldC5jbG9zZXN0KCcuZmxvdy1ub2RlLWhlYWRlcicpOw0KICAgIGlmICghaGVhZGVyRWxlbWVudCkgcmV0dXJuOw0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gaGVhZGVyRWxlbWVudC5jbG9zZXN0KCcuZmxvdy1ub2RlJyk7DQogICAgaWYgKCFub2RlRWxlbWVudCkgcmV0dXJuOw0KICAgIA0KICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgIGNvbnN0IG5vZGVJZCA9IG5vZGVFbGVtZW50LmlkOw0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIA0KICAgIGlmIChub2RlKSB7DQogICAgICAgIGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlID0gbm9kZUlkOw0KICAgICAgICANCiAgICAgICAgLy8gQ2FsY3VsYXRlIG9mZnNldCBmcm9tIG1vdXNlIHRvIG5vZGUgY29ybmVyLCBhY2NvdW50aW5nIGZvciB6b29tDQogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPyANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6IA0KICAgICAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICANCiAgICAgICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDogDQogICAgICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgICAgIA0KICAgICAgICAvLyBDb252ZXJ0IG1vdXNlIHBvc2l0aW9uIHRvIGNhbnZhcyBjb29yZGluYXRlcw0KICAgICAgICBjb25zdCBjYW52YXNNb3VzZVggPSAobW91c2VDb29yZHMueCAtIGNvbnRhaW5lclJlY3QubGVmdCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgIGNvbnN0IGNhbnZhc01vdXNlWSA9IChtb3VzZUNvb3Jkcy55IC0gY29udGFpbmVyUmVjdC50b3AgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICANCiAgICAgICAgLy8gQ2FsY3VsYXRlIG9mZnNldCBpbiBjYW52YXMgY29vcmRpbmF0ZXMNCiAgICAgICAgZmxvd0VkaXRvci5kcmFnT2Zmc2V0ID0gew0KICAgICAgICAgICAgeDogKGNhbnZhc01vdXNlWCAtIG5vZGUueCkgKiBmbG93RWRpdG9yLnpvb21MZXZlbCwNCiAgICAgICAgICAgIHk6IChjYW52YXNNb3VzZVkgLSBub2RlLnkpICogZmxvd0VkaXRvci56b29tTGV2ZWwNCiAgICAgICAgfTsNCiAgICAgICAgDQogICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLmN1cnNvciA9ICdncmFiYmluZyc7DQogICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLnpJbmRleCA9ICcxMDAwJzsgLy8gQnJpbmcgdG8gZnJvbnQgd2hpbGUgZHJhZ2dpbmcNCiAgICAgICAgDQogICAgICAgIC8vIENhY2hlIGNvbnRhaW5lciByZWN0IGZvciBwZXJmb3JtYW5jZQ0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhc1JlY3QgPSBjb250YWluZXJSZWN0Ow0KICAgIH0NCn0NCg0KZnVuY3Rpb24gaGFuZGxlRG9jdW1lbnRNb3VzZU1vdmUoZSkgew0KICAgIC8vIEhhbmRsZSBjYW52YXMgcGFubmluZw0KICAgIGlmIChmbG93RWRpdG9yLmlzUGFubmluZykgew0KICAgICAgICB1cGRhdGVDYW52YXNQYW4oZSk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gR2V0IHNjYWxlZCBjb29yZGluYXRlcw0KICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPyANCiAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDogDQogICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICANCiAgICAvLyBIYW5kbGUgdGFnIGRyYWdnaW5nDQogICAgaWYgKGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcgJiYgZmxvd0VkaXRvci50YWdEcmFnT2Zmc2V0KSB7DQogICAgICAgIGNvbnN0IHRhZyA9IGZsb3dFZGl0b3IudGFncy5nZXQoZmxvd0VkaXRvci5kcmFnZ2luZ1RhZyk7DQogICAgICAgIGlmICh0YWcpIHsNCiAgICAgICAgICAgIC8vIEdldCBjb250YWluZXIgZGltZW5zaW9ucyBmb3IgY29vcmRpbmF0ZSBjb252ZXJzaW9uDQogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/IA0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6IA0KICAgICAgICAgICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ29udmVydCBtb3VzZSBjb29yZGluYXRlcyB0byBjYW52YXMgY29vcmRpbmF0ZXMsIGFjY291bnRpbmcgZm9yIHBhbiBhbmQgem9vbQ0KICAgICAgICAgICAgY29uc3QgY2FudmFzTW91c2VYID0gKG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQgLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgY29uc3QgY2FudmFzTW91c2VZID0gKG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBuZXcgcG9zaXRpb24gd2l0aCBvZmZzZXQgKGRyYWcgb2Zmc2V0IGlzIGFsc28gaW4gc2NyZWVuIGNvb3JkaW5hdGVzLCBzbyBjb252ZXJ0IGl0KQ0KICAgICAgICAgICAgY29uc3QgZHJhZ09mZnNldFggPSBmbG93RWRpdG9yLnRhZ0RyYWdPZmZzZXQueCAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgY29uc3QgZHJhZ09mZnNldFkgPSBmbG93RWRpdG9yLnRhZ0RyYWdPZmZzZXQueSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICB0YWcueCA9IGNhbnZhc01vdXNlWCAtIGRyYWdPZmZzZXRYOw0KICAgICAgICAgICAgdGFnLnkgPSBjYW52YXNNb3VzZVkgLSBkcmFnT2Zmc2V0WTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcpOw0KICAgICAgICAgICAgaWYgKHRhZ0VsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICAvLyBVc2UgbGVmdC90b3AgZm9yIHBvc2l0aW9uaW5nDQogICAgICAgICAgICAgICAgdGFnRWxlbWVudC5zdHlsZS5sZWZ0ID0gdGFnLnggKyAncHgnOw0KICAgICAgICAgICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUudG9wID0gdGFnLnkgKyAncHgnOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBUaHJvdHRsZSB1cGRhdGVzIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2UNCiAgICAgICAgICAgIGlmICghZmxvd0VkaXRvci50YWdVcGRhdGVUaW1lb3V0KSB7DQogICAgICAgICAgICAgICAgZmxvd0VkaXRvci50YWdVcGRhdGVUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IudGFnVXBkYXRlVGltZW91dCA9IG51bGw7DQogICAgICAgICAgICAgICAgfSwgMTYpOyAvLyB+NjBmcHMNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGlmIChmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSAmJiBmbG93RWRpdG9yLmRyYWdPZmZzZXQpIHsNCiAgICAgICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKTsNCiAgICAgICAgaWYgKG5vZGUpIHsNCiAgICAgICAgICAgIC8vIEdldCBjb250YWluZXIgZGltZW5zaW9ucyBmb3IgY29vcmRpbmF0ZSBjb252ZXJzaW9uDQogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/IA0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6IA0KICAgICAgICAgICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ29udmVydCBtb3VzZSBjb29yZGluYXRlcyB0byBjYW52YXMgY29vcmRpbmF0ZXMsIGFjY291bnRpbmcgZm9yIHBhbiBhbmQgem9vbQ0KICAgICAgICAgICAgY29uc3QgY2FudmFzTW91c2VYID0gKG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQgLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgY29uc3QgY2FudmFzTW91c2VZID0gKG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBuZXcgcG9zaXRpb24gd2l0aCBvZmZzZXQgKGRyYWcgb2Zmc2V0IGlzIGFsc28gaW4gc2NyZWVuIGNvb3JkaW5hdGVzLCBzbyBjb252ZXJ0IGl0KQ0KICAgICAgICAgICAgY29uc3QgZHJhZ09mZnNldFggPSBmbG93RWRpdG9yLmRyYWdPZmZzZXQueCAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgY29uc3QgZHJhZ09mZnNldFkgPSBmbG93RWRpdG9yLmRyYWdPZmZzZXQueSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBub2RlLnggPSBjYW52YXNNb3VzZVggLSBkcmFnT2Zmc2V0WDsNCiAgICAgICAgICAgIG5vZGUueSA9IGNhbnZhc01vdXNlWSAtIGRyYWdPZmZzZXRZOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKTsNCiAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLmxlZnQgPSBub2RlLnggKyAncHgnOw0KICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLnRvcCA9IG5vZGUueSArICdweCc7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gVXBkYXRlIGFsbCBjb25uZWN0aW9ucyBmb3IgdGhpcyBub2RlICh0aHJvdHRsZWQgZm9yIHBlcmZvcm1hbmNlKQ0KICAgICAgICAgICAgICAgIGlmICghZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0KSB7DQogICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IudXBkYXRlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ29ubmVjdGlvbnNGb3JOb2RlKG5vZGUuaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0ID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgfSwgMTYpOyAvLyB+NjBmcHMNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQoNCmZ1bmN0aW9uIGhhbmRsZURvY3VtZW50TW91c2VVcChlKSB7DQogICAgLy8gSGFuZGxlIGNhbnZhcyBwYW5uaW5nIHN0b3ANCiAgICBpZiAoZmxvd0VkaXRvci5pc1Bhbm5pbmcpIHsNCiAgICAgICAgc3RvcENhbnZhc1BhbigpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIEhhbmRsZSB0YWcgZHJhZ2dpbmcgc3RvcA0KICAgIGlmIChmbG93RWRpdG9yLmRyYWdnaW5nVGFnKSB7DQogICAgICAgIGNvbnN0IHRhZ0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmbG93RWRpdG9yLmRyYWdnaW5nVGFnKTsNCiAgICAgICAgaWYgKHRhZ0VsZW1lbnQpIHsNCiAgICAgICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInOw0KICAgICAgICAgICAgdGFnRWxlbWVudC5zdHlsZS56SW5kZXggPSAnMTAwJzsNCiAgICAgICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUudHJhbnNpdGlvbiA9ICdib3gtc2hhZG93IDAuMnMgZWFzZSwgdHJhbnNmb3JtIDAuMnMgZWFzZSc7IC8vIFJlc3RvcmUgdHJhbnNpdGlvbnMNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgZmxvd0VkaXRvci5kcmFnZ2luZ1RhZyA9IG51bGw7DQogICAgICAgIGZsb3dFZGl0b3IudGFnRHJhZ09mZnNldCA9IG51bGw7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgaWYgKGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKSB7DQogICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUpOw0KICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLmN1cnNvciA9ICdncmFiJzsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLnpJbmRleCA9ICcnOyAvLyBSZXNldCB6LWluZGV4DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIENsZWFyIGFueSBwZW5kaW5nIGNvbm5lY3Rpb24gdXBkYXRlcw0KICAgICAgICBpZiAoZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0KSB7DQogICAgICAgICAgICBjbGVhclRpbWVvdXQoZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0KTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IudXBkYXRlVGltZW91dCA9IG51bGw7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEZpbmFsIGNvbm5lY3Rpb24gdXBkYXRlDQogICAgICAgIHVwZGF0ZUNvbm5lY3Rpb25zRm9yTm9kZShmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSk7DQogICAgICAgIA0KICAgICAgICBmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSA9IG51bGw7DQogICAgICAgIGZsb3dFZGl0b3IuZHJhZ09mZnNldCA9IG51bGw7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzUmVjdCA9IG51bGw7DQogICAgfQ0KfQ0KDQoNCi8vIEV4YW1wbGU6IGNhbnZhcy1tYW5hZ2VyLmpzDQpzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlciA9IHsNCiAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0sDQogICAgc3RhcnRDYW52YXNQYW4sDQogICAgdXBkYXRlQ2FudmFzUGFuLA0KICAgIHN0b3BDYW52YXNQYW4sDQogICAgcmVzZXRDYW52YXNQYW4sDQogICAgaGFuZGxlQ2FudmFzQ2xpY2ssDQogICAgaGFuZGxlRG9jdW1lbnRNb3VzZURvd24sDQogICAgaGFuZGxlRG9jdW1lbnRNb3VzZU1vdmUsDQogICAgaGFuZGxlRG9jdW1lbnRNb3VzZVVwLA0KICAgIHpvb21JbiwNCiAgICB6b29tT3V0LA0KICAgIHNldFpvb21MZXZlbCwNCiAgICB6b29tVG9GaXQsDQogICAgaGFuZGxlTW91c2VXaGVlbA0KfTsNCg0KDQovLyBBZGQgYSBuZXcgdGFnIGF0IGN1cnJlbnQgdmlld3BvcnQgY2VudGVyDQphc3luYyBmdW5jdGlvbiBhZGRUYWcoKSB7DQogICAgY29uc3QgdGFnTmFtZSA9IGF3YWl0IHN5cG5leEFQSS5zaG93SW5wdXRNb2RhbCgNCiAgICAgICAgJ0NyZWF0ZSBOZXcgVGFnJywNCiAgICAgICAgJ1RhZyBOYW1lOicsDQogICAgICAgIHsNCiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnRW50ZXIgdGFnIG5hbWUnLA0KICAgICAgICAgICAgY29uZmlybVRleHQ6ICdDcmVhdGUgVGFnJywNCiAgICAgICAgICAgIGNhbmNlbFRleHQ6ICdDYW5jZWwnLA0KICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS10YWcnDQogICAgICAgIH0NCiAgICApOw0KICAgIA0KICAgIGlmICghdGFnTmFtZSB8fCB0YWdOYW1lLnRyaW0oKSA9PT0gJycpIHJldHVybjsNCg0KICAgIGNvbnN0IHRhZ0lkID0gYHRhZ18keysrZmxvd0VkaXRvci50YWdDb3VudGVyfWA7DQoNCiAgICAvLyBDYWxjdWxhdGUgcG9zaXRpb24gYXQgY3VycmVudCB2aWV3cG9ydCBjZW50ZXINCiAgICAvLyBHZXQgY2VudGVyIHBvc2l0aW9uIGluIGNhbnZhcyBjb29yZGluYXRlcw0KICAgIGNvbnN0IGNlbnRlciA9IHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVXRpbHMgPyANCiAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JVdGlscy5nZXRWaWV3cG9ydENlbnRlckluQ2FudmFzKCkgOg0KICAgICAgICB7IHg6IDUwMDAsIHk6IDUwMDAgfTsgLy8gRmFsbGJhY2sgdG8gY2FudmFzIGNlbnRlcg0KDQogICAgY29uc3QgdGFnID0gew0KICAgICAgICBpZDogdGFnSWQsDQogICAgICAgIG5hbWU6IHRhZ05hbWUudHJpbSgpLA0KICAgICAgICBkZXNjcmlwdGlvbjogJycsDQogICAgICAgIHg6IGNlbnRlci54LA0KICAgICAgICB5OiBjZW50ZXIueSwNCiAgICAgICAgY29sb3I6ICcjNENBRjUwJyAvLyBHcmVlbiBjb2xvcg0KICAgIH07DQoNCiAgICBmbG93RWRpdG9yLnRhZ3Muc2V0KHRhZ0lkLCB0YWcpOw0KICAgIGNyZWF0ZVRhZ0VsZW1lbnQodGFnKTsNCiAgICB1cGRhdGVUYWdQYW5lbCgpOw0KDQp9DQoNCi8vIENyZWF0ZSB0YWcgZWxlbWVudCBvbiBjYW52YXMNCmZ1bmN0aW9uIGNyZWF0ZVRhZ0VsZW1lbnQodGFnKSB7DQogICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIHRhZ0VsZW1lbnQuaWQgPSB0YWcuaWQ7DQogICAgdGFnRWxlbWVudC5jbGFzc05hbWUgPSAnY2FudmFzLXRhZyc7DQogICAgdGFnRWxlbWVudC5zdHlsZS5jc3NUZXh0ID0gYA0KICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgICAgIGxlZnQ6ICR7dGFnLnh9cHg7DQogICAgICAgIHRvcDogJHt0YWcueX1weDsNCiAgICAgICAgYmFja2dyb3VuZDogJHt0YWcuY29sb3J9Ow0KICAgICAgICBjb2xvcjogd2hpdGU7DQogICAgICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICAgICAgY3Vyc29yOiBwb2ludGVyOw0KICAgICAgICB1c2VyLXNlbGVjdDogbm9uZTsNCiAgICAgICAgei1pbmRleDogMTAwOw0KICAgICAgICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLDAsMCwwLjIpOw0KICAgICAgICB0cmFuc2l0aW9uOiBib3gtc2hhZG93IDAuMnMgZWFzZSwgdHJhbnNmb3JtIDAuMnMgZWFzZTsNCiAgICBgOw0KICAgIHRhZ0VsZW1lbnQudGV4dENvbnRlbnQgPSB0YWcubmFtZTsNCg0KICAgIC8vIE1ha2UgdGFnIGRyYWdnYWJsZQ0KICAgIHRhZ0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGUpID0+IHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICBzdGFydERyYWdnaW5nVGFnKHRhZy5pZCwgZSk7DQogICAgfSk7DQoNCiAgICAvLyBDbGljayB0byBqdW1wIHRvIHRhZw0KICAgIHRhZ0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICBpZiAoIWZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcpIHsNCiAgICAgICAgICAgIGp1bXBUb1RhZyh0YWcuaWQpOw0KICAgICAgICB9DQogICAgfSk7DQoNCiAgICAvLyBIb3ZlciBlZmZlY3RzDQogICAgdGFnRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4gew0KICAgICAgICB0YWdFbGVtZW50LnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxLjA1KSc7DQogICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUuYm94U2hhZG93ID0gJzAgNHB4IDhweCByZ2JhKDAsMCwwLDAuMyknOw0KICAgIH0pOw0KDQogICAgdGFnRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4gew0KICAgICAgICB0YWdFbGVtZW50LnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxKSc7DQogICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUuYm94U2hhZG93ID0gJzAgMnB4IDRweCByZ2JhKDAsMCwwLDAuMiknOw0KICAgIH0pOw0KDQogICAgZmxvd0VkaXRvci5jYW52YXMuYXBwZW5kQ2hpbGQodGFnRWxlbWVudCk7DQp9DQoNCi8vIFN0YXJ0IGRyYWdnaW5nIGEgdGFnDQpmdW5jdGlvbiBzdGFydERyYWdnaW5nVGFnKHRhZ0lkLCBlKSB7DQogICAgY29uc3QgdGFnID0gZmxvd0VkaXRvci50YWdzLmdldCh0YWdJZCk7DQogICAgaWYgKCF0YWcpIHJldHVybjsNCg0KICAgIGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcgPSB0YWdJZDsNCg0KICAgIC8vIENhbGN1bGF0ZSBvZmZzZXQgZnJvbSBtb3VzZSB0byB0YWcgY29ybmVyLCBhY2NvdW50aW5nIGZvciB6b29tDQogICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8gDQogICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6IA0KICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgDQogICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/IA0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOiANCiAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgIA0KICAgIC8vIENvbnZlcnQgbW91c2UgcG9zaXRpb24gdG8gY2FudmFzIGNvb3JkaW5hdGVzDQogICAgY29uc3QgY2FudmFzTW91c2VYID0gKG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQgLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIGNvbnN0IGNhbnZhc01vdXNlWSA9IChtb3VzZUNvb3Jkcy55IC0gY29udGFpbmVyUmVjdC50b3AgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBvZmZzZXQgaW4gY2FudmFzIGNvb3JkaW5hdGVzDQogICAgZmxvd0VkaXRvci50YWdEcmFnT2Zmc2V0ID0gew0KICAgICAgICB4OiAoY2FudmFzTW91c2VYIC0gdGFnLngpICogZmxvd0VkaXRvci56b29tTGV2ZWwsDQogICAgICAgIHk6IChjYW52YXNNb3VzZVkgLSB0YWcueSkgKiBmbG93RWRpdG9yLnpvb21MZXZlbA0KICAgIH07DQoNCiAgICBjb25zdCB0YWdFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFnSWQpOw0KICAgIHRhZ0VsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ2dyYWJiaW5nJzsNCiAgICB0YWdFbGVtZW50LnN0eWxlLnpJbmRleCA9ICcxMDAxJzsNCiAgICB0YWdFbGVtZW50LnN0eWxlLnRyYW5zaXRpb24gPSAnbm9uZSc7IC8vIERpc2FibGUgdHJhbnNpdGlvbnMgZHVyaW5nIGRyYWcNCn0NCg0KLy8gSnVtcCB0byB0YWcgbG9jYXRpb24NCmZ1bmN0aW9uIGp1bXBUb1RhZyh0YWdJZCkgew0KICAgIGNvbnN0IHRhZyA9IGZsb3dFZGl0b3IudGFncy5nZXQodGFnSWQpOw0KICAgIGlmICghdGFnKSByZXR1cm47DQoNCiAgICAvLyBBZGQgc21vb3RoIHRyYW5zaXRpb24NCiAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS50cmFuc2l0aW9uID0gJ3RyYW5zZm9ybSAwLjVzIGVhc2Utb3V0JzsNCg0KICAgIC8vIFVzZSB1dGlsaXR5IGZ1bmN0aW9uIHRvIGNlbnRlciB2aWV3cG9ydCBvbiB0YWcgY29vcmRpbmF0ZXMNCiAgICBpZiAoc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JVdGlscyAmJiBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzLmNlbnRlclZpZXdwb3J0T25DYW52YXMpIHsNCiAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JVdGlscy5jZW50ZXJWaWV3cG9ydE9uQ2FudmFzKHRhZy54LCB0YWcueSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gRmFsbGJhY2sgbWV0aG9kDQogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICAgIA0KICAgICAgICBjb25zdCB2aWV3cG9ydENlbnRlclggPSBjb250YWluZXJSZWN0LndpZHRoIC8gMjsNCiAgICAgICAgY29uc3Qgdmlld3BvcnRDZW50ZXJZID0gY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyOw0KICAgICAgICANCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IHZpZXdwb3J0Q2VudGVyWCAtICh0YWcueCAqIGZsb3dFZGl0b3Iuem9vbUxldmVsKTsNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IHZpZXdwb3J0Q2VudGVyWSAtICh0YWcueSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsKTsNCiAgICAgICAgDQogICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgIH0NCg0KICAgIC8vIFJlbW92ZSB0cmFuc2l0aW9uIGFmdGVyIGFuaW1hdGlvbiBjb21wbGV0ZXMNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICcnOw0KICAgIH0sIDUwMCk7DQp9DQoNCi8vIFVwZGF0ZSB0YWcgcGFuZWwNCmZ1bmN0aW9uIHVwZGF0ZVRhZ1BhbmVsKCkgew0KICAgIGNvbnN0IHRhZ1BhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RhZy1wYW5lbCcpOw0KICAgIGlmICghdGFnUGFuZWwpIHJldHVybjsNCg0KICAgIGlmIChmbG93RWRpdG9yLnRhZ3Muc2l6ZSA9PT0gMCkgew0KICAgICAgICB0YWdQYW5lbC5pbm5lckhUTUwgPSAnPHAgY2xhc3M9InRleHQtbXV0ZWQiPk5vIHRhZ3MgeWV0PC9wPic7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBsZXQgdGFnSHRtbCA9ICcnOw0KICAgIGZsb3dFZGl0b3IudGFncy5mb3JFYWNoKHRhZyA9PiB7DQogICAgICAgIHRhZ0h0bWwgKz0gYA0KICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFnLWl0ZW0iIGRhdGEtdGFnLWlkPSIke3RhZy5pZH0iPg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRhZy1jb2xvciIgc3R5bGU9ImJhY2tncm91bmQ6ICR7dGFnLmNvbG9yfSI+PC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFnLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWctbmFtZSI+JHt0YWcubmFtZX08L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgJHt0YWcuZGVzY3JpcHRpb24gPyBgPGRpdiBjbGFzcz0idGFnLWRlc2NyaXB0aW9uIj4ke3RhZy5kZXNjcmlwdGlvbn08L2Rpdj5gIDogJyd9DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0idGFnLWRlbGV0ZSIgZGF0YS10YWctaWQ9IiR7dGFnLmlkfSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtdGltZXMiPjwvaT4NCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICBgOw0KICAgIH0pOw0KDQogICAgdGFnUGFuZWwuaW5uZXJIVE1MID0gdGFnSHRtbDsNCg0KICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lcnMNCiAgICB0YWdQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcudGFnLWl0ZW0nKS5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgIGlmICghZS50YXJnZXQuY2xvc2VzdCgnLnRhZy1kZWxldGUnKSkgew0KICAgICAgICAgICAgICAgIGNvbnN0IHRhZ0lkID0gaXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFnLWlkJyk7DQogICAgICAgICAgICAgICAganVtcFRvVGFnKHRhZ0lkKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfSk7DQoNCiAgICB0YWdQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcudGFnLWRlbGV0ZScpLmZvckVhY2goYnRuID0+IHsNCiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICBjb25zdCB0YWdJZCA9IGJ0bi5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFnLWlkJyk7DQogICAgICAgICAgICBkZWxldGVUYWcodGFnSWQpOw0KICAgICAgICB9KTsNCiAgICB9KTsNCn0NCg0KLy8gRGVsZXRlIGEgdGFnDQphc3luYyBmdW5jdGlvbiBkZWxldGVUYWcodGFnSWQpIHsNCiAgICBjb25zdCBjb25maXJtZWQgPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0NvbmZpcm1hdGlvbigNCiAgICAgICAgJ0RlbGV0ZSBUYWcnLA0KICAgICAgICAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIHRhZz8nLA0KICAgICAgICB7DQogICAgICAgICAgICB0eXBlOiAnZGFuZ2VyJywNCiAgICAgICAgICAgIGNvbmZpcm1UZXh0OiAnRGVsZXRlJywNCiAgICAgICAgICAgIGNhbmNlbFRleHQ6ICdDYW5jZWwnLA0KICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS10YWcnDQogICAgICAgIH0NCiAgICApOw0KICAgIA0KICAgIGlmIChjb25maXJtZWQpIHsNCiAgICAgICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhZ0lkKTsNCiAgICAgICAgaWYgKHRhZ0VsZW1lbnQpIHsNCiAgICAgICAgICAgIHRhZ0VsZW1lbnQucmVtb3ZlKCk7DQogICAgICAgIH0NCiAgICAgICAgZmxvd0VkaXRvci50YWdzLmRlbGV0ZSh0YWdJZCk7DQogICAgICAgIHVwZGF0ZVRhZ1BhbmVsKCk7DQogICAgfQ0KfQ0KDQovLyBFeGFtcGxlOiB0YWctbWFuYWdlci5qcw0Kc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLnRhZ01hbmFnZXIgPSB7DQogICAgYWRkVGFnLA0KICAgIGNyZWF0ZVRhZ0VsZW1lbnQsDQogICAgc3RhcnREcmFnZ2luZ1RhZywNCiAgICBqdW1wVG9UYWcsDQogICAgdXBkYXRlVGFnUGFuZWwsDQogICAgZGVsZXRlVGFnDQp9Ow0KDQovLyBFbmNyeXB0IHNlbnNpdGl2ZSB2YWx1ZXMgaW4gbm9kZSBjb25maWcgYmVmb3JlIHNhdmluZw0KYXN5bmMgZnVuY3Rpb24gZW5jcnlwdE5vZGVDb25maWcobm9kZUNvbmZpZywgbm9kZVR5cGUpIHsNCiAgICBpZiAoIXN5cG5leEFQSSB8fCAhc3lwbmV4QVBJLmVuY3J5cHQpIHsNCiAgICAgICAgcmV0dXJuIG5vZGVDb25maWc7IC8vIE5vIGVuY3J5cHRpb24gYXZhaWxhYmxlDQogICAgfQ0KICAgIA0KICAgIC8vIEdldCBub2RlIGRlZmluaXRpb24gdG8gY2hlY2sgZm9yIGVuY3J5cHRlZCBmaWVsZHMNCiAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGVUeXBlKTsNCiAgICBpZiAoIW5vZGVEZWYgfHwgIW5vZGVEZWYuY29uZmlnKSB7DQogICAgICAgIHJldHVybiBub2RlQ29uZmlnOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBlbmNyeXB0ZWRDb25maWcgPSB7fTsNCiAgICANCiAgICBmb3IgKGNvbnN0IFtmaWVsZE5hbWUsIGZpZWxkQ29uZmlnXSBvZiBPYmplY3QuZW50cmllcyhub2RlQ29uZmlnKSkgew0KICAgICAgICBjb25zdCBjb25maWdEZWYgPSBub2RlRGVmLmNvbmZpZ1tmaWVsZE5hbWVdOyAvLyBBY2Nlc3MgYXMgb2JqZWN0IHByb3BlcnR5LCBub3QgYXJyYXkNCiAgICAgICAgDQogICAgICAgIGlmIChjb25maWdEZWYgJiYgY29uZmlnRGVmLmVuY3J5cHQgPT09IHRydWUgJiYgZmllbGRDb25maWcudmFsdWUpIHsNCiAgICAgICAgICAgIC8vIEVuY3J5cHQgdGhlIHZhbHVlDQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIGNvbnN0IGVuY3J5cHRlZFZhbHVlID0gYXdhaXQgc3lwbmV4QVBJLmVuY3J5cHQoZmllbGRDb25maWcudmFsdWUpOw0KICAgICAgICAgICAgICAgIGVuY3J5cHRlZENvbmZpZ1tmaWVsZE5hbWVdID0gew0KICAgICAgICAgICAgICAgICAgICAuLi5maWVsZENvbmZpZywNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGVuY3J5cHRlZFZhbHVlDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGVuY3J5cHQgZmllbGQgJHtmaWVsZE5hbWV9OmAsIGVycm9yKTsNCiAgICAgICAgICAgICAgICBlbmNyeXB0ZWRDb25maWdbZmllbGROYW1lXSA9IGZpZWxkQ29uZmlnOyAvLyBLZWVwIG9yaWdpbmFsIGlmIGVuY3J5cHRpb24gZmFpbHMNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGVuY3J5cHRlZENvbmZpZ1tmaWVsZE5hbWVdID0gZmllbGRDb25maWc7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIGVuY3J5cHRlZENvbmZpZzsNCn0NCg0KLy8gRGVjcnlwdCBzZW5zaXRpdmUgdmFsdWVzIGluIG5vZGUgY29uZmlnIGFmdGVyIGxvYWRpbmcNCmFzeW5jIGZ1bmN0aW9uIGRlY3J5cHROb2RlQ29uZmlnKG5vZGVDb25maWcsIG5vZGVUeXBlKSB7DQogICAgaWYgKCFzeXBuZXhBUEkgfHwgIXN5cG5leEFQSS5kZWNyeXB0KSB7DQogICAgICAgIHJldHVybiBub2RlQ29uZmlnOyAvLyBObyBkZWNyeXB0aW9uIGF2YWlsYWJsZQ0KICAgIH0NCiAgICANCiAgICAvLyBHZXQgbm9kZSBkZWZpbml0aW9uIHRvIGNoZWNrIGZvciBlbmNyeXB0ZWQgZmllbGRzDQogICAgY29uc3Qgbm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShub2RlVHlwZSk7DQogICAgaWYgKCFub2RlRGVmIHx8ICFub2RlRGVmLmNvbmZpZykgew0KICAgICAgICByZXR1cm4gbm9kZUNvbmZpZzsNCiAgICB9DQogICAgDQogICAgY29uc3QgZGVjcnlwdGVkQ29uZmlnID0ge307DQogICAgDQogICAgZm9yIChjb25zdCBbZmllbGROYW1lLCBmaWVsZENvbmZpZ10gb2YgT2JqZWN0LmVudHJpZXMobm9kZUNvbmZpZykpIHsNCiAgICAgICAgY29uc3QgY29uZmlnRGVmID0gbm9kZURlZi5jb25maWdbZmllbGROYW1lXTsgLy8gQWNjZXNzIGFzIG9iamVjdCBwcm9wZXJ0eSwgbm90IGFycmF5DQogICAgICAgIA0KICAgICAgICBpZiAoY29uZmlnRGVmICYmIGNvbmZpZ0RlZi5lbmNyeXB0ID09PSB0cnVlICYmIGZpZWxkQ29uZmlnLnZhbHVlKSB7DQogICAgICAgICAgICAvLyBEZWNyeXB0IHRoZSB2YWx1ZQ0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBjb25zdCBkZWNyeXB0ZWRWYWx1ZSA9IGF3YWl0IHN5cG5leEFQSS5kZWNyeXB0KGZpZWxkQ29uZmlnLnZhbHVlKTsNCiAgICAgICAgICAgICAgICBkZWNyeXB0ZWRDb25maWdbZmllbGROYW1lXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgLi4uZmllbGRDb25maWcsDQogICAgICAgICAgICAgICAgICAgIHZhbHVlOiBkZWNyeXB0ZWRWYWx1ZQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBkZWNyeXB0IGZpZWxkICR7ZmllbGROYW1lfTpgLCBlcnJvcik7DQogICAgICAgICAgICAgICAgZGVjcnlwdGVkQ29uZmlnW2ZpZWxkTmFtZV0gPSBmaWVsZENvbmZpZzsgLy8gS2VlcCBvcmlnaW5hbCBpZiBkZWNyeXB0aW9uIGZhaWxzDQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBkZWNyeXB0ZWRDb25maWdbZmllbGROYW1lXSA9IGZpZWxkQ29uZmlnOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIHJldHVybiBkZWNyeXB0ZWRDb25maWc7DQp9DQoNCi8vIFNhdmUgZmxvdyB0byB2aXJ0dWFsIGZpbGUgc3lzdGVtDQphc3luYyBmdW5jdGlvbiBzYXZlRmxvdygpIHsNCiAgICAvLyBFbmNyeXB0IHNlbnNpdGl2ZSBmaWVsZHMgYmVmb3JlIHNhdmluZw0KICAgIGNvbnN0IGVuY3J5cHRlZE5vZGVzID0gW107DQogICAgZm9yIChjb25zdCBub2RlIG9mIGZsb3dFZGl0b3Iubm9kZXMudmFsdWVzKCkpIHsNCiAgICAgICAgY29uc3QgZW5jcnlwdGVkQ29uZmlnID0gYXdhaXQgZW5jcnlwdE5vZGVDb25maWcobm9kZS5jb25maWcsIG5vZGUudHlwZSk7DQogICAgICAgIGVuY3J5cHRlZE5vZGVzLnB1c2goew0KICAgICAgICAgICAgaWQ6IG5vZGUuaWQsDQogICAgICAgICAgICB0eXBlOiBub2RlLnR5cGUsDQogICAgICAgICAgICB4OiBub2RlLngsDQogICAgICAgICAgICB5OiBub2RlLnksDQogICAgICAgICAgICBjb25maWc6IGVuY3J5cHRlZENvbmZpZw0KICAgICAgICB9KTsNCiAgICB9DQogICAgDQogICAgY29uc3QgZmxvd0RhdGEgPSB7DQogICAgICAgIG5vZGVzOiBlbmNyeXB0ZWROb2RlcywNCiAgICAgICAgY29ubmVjdGlvbnM6IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkubWFwKGNvbm4gPT4gKHsNCiAgICAgICAgICAgIGlkOiBjb25uLmlkLA0KICAgICAgICAgICAgZnJvbTogY29ubi5mcm9tLA0KICAgICAgICAgICAgdG86IGNvbm4udG8NCiAgICAgICAgfSkpLA0KICAgICAgICB0YWdzOiBBcnJheS5mcm9tKGZsb3dFZGl0b3IudGFncy52YWx1ZXMoKSksDQogICAgICAgIG1ldGFkYXRhOiB7DQogICAgICAgICAgICBzYXZlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksDQogICAgICAgICAgICBub2RlQ291bnQ6IGZsb3dFZGl0b3Iubm9kZXMuc2l6ZSwNCiAgICAgICAgICAgIGNvbm5lY3Rpb25Db3VudDogZmxvd0VkaXRvci5jb25uZWN0aW9ucy5zaXplLA0KICAgICAgICAgICAgdGFnQ291bnQ6IGZsb3dFZGl0b3IudGFncy5zaXplDQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgdHJ5IHsNCiAgICAgICAgbGV0IGZpbGVQYXRoID0gZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGg7DQogICAgICAgIA0KICAgICAgICAvLyBJZiBubyBjdXJyZW50IGZpbGUgcGF0aCwgc2hvdyBmaWxlIGV4cGxvcmVyDQogICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgIGZpbGVQYXRoID0gYXdhaXQgc3lwbmV4QVBJLnNob3dGaWxlRXhwbG9yZXIoew0KICAgICAgICAgICAgICAgIG1vZGU6ICdzYXZlJywNCiAgICAgICAgICAgICAgICB0aXRsZTogJ1NhdmUgRmxvdyBGaWxlJywNCiAgICAgICAgICAgICAgICBpbml0aWFsUGF0aDogJy8nLA0KICAgICAgICAgICAgICAgIGZpbGVOYW1lOiAnZmxvd193b3JrZmxvdy5qc29uJywNCiAgICAgICAgICAgICAgICBmaWxlRXh0ZW5zaW9uOiAnLmpzb24nLA0KICAgICAgICAgICAgICAgIG9uU2VsZWN0OiAoc2VsZWN0ZWRQYXRoKSA9PiB7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4gew0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBpZiAoIWZpbGVQYXRoKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBVc2VyIGNhbmNlbGxlZA0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU2F2ZSB0byB2aXJ0dWFsIGZpbGUgc3lzdGVtDQogICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGVKU09OKSB7DQogICAgICAgICAgICBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZUpTT04oZmlsZVBhdGgsIGZsb3dEYXRhKTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgICAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGbG93IHNhdmVkIHRvOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBmbG93OicsIGVycm9yKTsNCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbikgew0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ0ZhaWxlZCB0byBzYXZlIGZsb3c6ICcgKyBlcnJvci5tZXNzYWdlLCAnZXJyb3InKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gU2F2ZSBmbG93IGFzIChhbHdheXMgc2hvdyBmaWxlIGV4cGxvcmVyKQ0KYXN5bmMgZnVuY3Rpb24gc2F2ZUZsb3dBcygpIHsNCiAgICAvLyBFbmNyeXB0IHNlbnNpdGl2ZSBmaWVsZHMgYmVmb3JlIHNhdmluZw0KICAgIGNvbnN0IGVuY3J5cHRlZE5vZGVzID0gW107DQogICAgZm9yIChjb25zdCBub2RlIG9mIGZsb3dFZGl0b3Iubm9kZXMudmFsdWVzKCkpIHsNCiAgICAgICAgY29uc3QgZW5jcnlwdGVkQ29uZmlnID0gYXdhaXQgZW5jcnlwdE5vZGVDb25maWcobm9kZS5jb25maWcsIG5vZGUudHlwZSk7DQogICAgICAgIGVuY3J5cHRlZE5vZGVzLnB1c2goew0KICAgICAgICAgICAgaWQ6IG5vZGUuaWQsDQogICAgICAgICAgICB0eXBlOiBub2RlLnR5cGUsDQogICAgICAgICAgICB4OiBub2RlLngsDQogICAgICAgICAgICB5OiBub2RlLnksDQogICAgICAgICAgICBjb25maWc6IGVuY3J5cHRlZENvbmZpZw0KICAgICAgICB9KTsNCiAgICB9DQogICAgDQogICAgY29uc3QgZmxvd0RhdGEgPSB7DQogICAgICAgIG5vZGVzOiBlbmNyeXB0ZWROb2RlcywNCiAgICAgICAgY29ubmVjdGlvbnM6IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkubWFwKGNvbm4gPT4gKHsNCiAgICAgICAgICAgIGlkOiBjb25uLmlkLA0KICAgICAgICAgICAgZnJvbTogY29ubi5mcm9tLA0KICAgICAgICAgICAgdG86IGNvbm4udG8NCiAgICAgICAgfSkpLA0KICAgICAgICB0YWdzOiBBcnJheS5mcm9tKGZsb3dFZGl0b3IudGFncy52YWx1ZXMoKSksDQogICAgICAgIG1ldGFkYXRhOiB7DQogICAgICAgICAgICBzYXZlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksDQogICAgICAgICAgICBub2RlQ291bnQ6IGZsb3dFZGl0b3Iubm9kZXMuc2l6ZSwNCiAgICAgICAgICAgIGNvbm5lY3Rpb25Db3VudDogZmxvd0VkaXRvci5jb25uZWN0aW9ucy5zaXplLA0KICAgICAgICAgICAgdGFnQ291bnQ6IGZsb3dFZGl0b3IudGFncy5zaXplDQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgdHJ5IHsNCiAgICAgICAgLy8gU2hvdyBmaWxlIGV4cGxvcmVyIGZvciBzYXZpbmcNCiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0ZpbGVFeHBsb3Jlcih7DQogICAgICAgICAgICBtb2RlOiAnc2F2ZScsDQogICAgICAgICAgICB0aXRsZTogJ1NhdmUgRmxvdyBGaWxlIEFzJywNCiAgICAgICAgICAgIGluaXRpYWxQYXRoOiAnLycsDQogICAgICAgICAgICBmaWxlTmFtZTogJ2Zsb3dfd29ya2Zsb3cuanNvbicsDQogICAgICAgICAgICBmaWxlRXh0ZW5zaW9uOiAnLmpzb24nLA0KICAgICAgICAgICAgb25TZWxlY3Q6IChzZWxlY3RlZFBhdGgpID0+IHsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4gew0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCg0KICAgICAgICBpZiAoIWZpbGVQYXRoKSB7DQogICAgICAgICAgICByZXR1cm47IC8vIFVzZXIgY2FuY2VsbGVkDQogICAgICAgIH0NCg0KICAgICAgICAvLyBTYXZlIHRvIHZpcnR1YWwgZmlsZSBzeXN0ZW0NCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZUpTT04pIHsNCiAgICAgICAgICAgIGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlSlNPTihmaWxlUGF0aCwgZmxvd0RhdGEpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGggPSBmaWxlUGF0aDsNCiAgICAgICAgICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZsb3cgc2F2ZWQgYXM6ICR7ZmlsZVBhdGh9YCwgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgfQ0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIGZsb3cgYXM6JywgZXJyb3IpOw0KICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKSB7DQogICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignRmFpbGVkIHRvIHNhdmUgZmxvdyBhczogJyArIGVycm9yLm1lc3NhZ2UsICdlcnJvcicpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBMb2FkIGZsb3cgZnJvbSB2aXJ0dWFsIGZpbGUgc3lzdGVtDQphc3luYyBmdW5jdGlvbiBsb2FkRmxvdygpIHsNCiAgICB0cnkgew0KICAgICAgICAvLyBTaG93IGZpbGUgZXhwbG9yZXIgZm9yIGxvYWRpbmcNCiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0ZpbGVFeHBsb3Jlcih7DQogICAgICAgICAgICBtb2RlOiAnb3BlbicsDQogICAgICAgICAgICB0aXRsZTogJ0xvYWQgRmxvdyBGaWxlJywNCiAgICAgICAgICAgIGluaXRpYWxQYXRoOiAnLycsDQogICAgICAgICAgICBvblNlbGVjdDogKHNlbGVjdGVkUGF0aCkgPT4gew0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBjYW5jZWxsZWQNCiAgICAgICAgfQ0KDQogICAgICAgIGxldCBmbG93RGF0YSA9IG51bGw7DQogICAgICAgIA0KICAgICAgICAvLyBUcnkgdmlydHVhbCBmaWxlIHN5c3RlbSBmaXJzdA0KICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVKU09OKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIGZsb3dEYXRhID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZUpTT04oZmlsZVBhdGgpOw0KICAgICAgICAgICAgfSBjYXRjaCAodmZzRXJyb3IpIHsNCiAgICAgICAgICAgICAgICB0aHJvdyB2ZnNFcnJvcjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgaWYgKGZsb3dEYXRhKSB7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENsZWFyIGN1cnJlbnQgY2FudmFzICh3aXRob3V0IGNvbmZpcm1hdGlvbiBzaW5jZSB3ZSdyZSBsb2FkaW5nIGEgZmlsZSkNCiAgICAgICAgICAgIGNsZWFyQ2FudmFzU2lsZW50KCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFJlc2V0IHBhbiBvZmZzZXQgdG8gY2VudGVyIG9mIGxhcmdlIGNhbnZhcyBmb3IgbmV3IHdvcmtmbG93DQogICAgICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldCA9IHsgeDogLTUwMDAsIHk6IC01MDAwIH07DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUmVzZXQgbm9kZSBjb3VudGVyIHRvIGF2b2lkIElEIGNvbmZsaWN0cw0KICAgICAgICAgICAgZmxvd0VkaXRvci5ub2RlQ291bnRlciA9IDA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIExvYWQgbm9kZXMNCiAgICAgICAgICAgIGlmIChmbG93RGF0YS5ub2Rlcykgew0KICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZURhdGEgb2YgZmxvd0RhdGEubm9kZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gRGVjcnlwdCBzZW5zaXRpdmUgZmllbGRzIGFmdGVyIGxvYWRpbmcNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVjcnlwdGVkQ29uZmlnID0gYXdhaXQgZGVjcnlwdE5vZGVDb25maWcobm9kZURhdGEuY29uZmlnLCBub2RlRGF0YS50eXBlKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBub2RlIHdpdGggcHJvcGVyIElEDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IG5vZGVEYXRhLmlkOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IG5vZGVJZCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IG5vZGVEYXRhLnR5cGUsDQogICAgICAgICAgICAgICAgICAgICAgICB4OiBub2RlRGF0YS54LA0KICAgICAgICAgICAgICAgICAgICAgICAgeTogbm9kZURhdGEueSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZzogZGVjcnlwdGVkQ29uZmlnLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge30NCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBub2RlIGNvdW50ZXINCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZU51bSA9IHBhcnNlSW50KG5vZGVJZC5yZXBsYWNlKCdub2RlXycsICcnKSk7DQogICAgICAgICAgICAgICAgICAgIGlmIChub2RlTnVtID4gZmxvd0VkaXRvci5ub2RlQ291bnRlcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci5ub2RlQ291bnRlciA9IG5vZGVOdW07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3Iubm9kZXMuc2V0KG5vZGVJZCwgbm9kZSk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbm9kZSBlbGVtZW50IHVzaW5nIHRoZSByZW5kZXJlciBhbmQgYWRkIHRvIGNhbnZhcw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IG5vZGVSZW5kZXJlci5jcmVhdGVOb2RlRWxlbWVudChub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuYXBwZW5kQ2hpbGQobm9kZUVsZW1lbnQpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTG9hZCBjb25uZWN0aW9ucyBhZnRlciBub2RlcyBhcmUgZnVsbHkgY3JlYXRlZCBhbmQgcG9zaXRpb25lZA0KICAgICAgICAgICAgaWYgKGZsb3dEYXRhLmNvbm5lY3Rpb25zKSB7DQogICAgICAgICAgICAgICAgZmxvd0RhdGEuY29ubmVjdGlvbnMuZm9yRWFjaChjb25uRGF0YSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGNyZWF0ZUNvbm5lY3Rpb24oY29ubkRhdGEuZnJvbS5ub2RlSWQsIGNvbm5EYXRhLmZyb20ucG9ydE5hbWUsIGNvbm5EYXRhLnRvLm5vZGVJZCwgY29ubkRhdGEudG8ucG9ydE5hbWUpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIEltbWVkaWF0ZWx5IHJlZHJhdyBjb25uZWN0aW9ucyBub3cgdGhhdCBhbGwgU1ZHIGVsZW1lbnRzIGV4aXN0DQogICAgICAgICAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTG9hZCB0YWdzDQogICAgICAgICAgICBpZiAoZmxvd0RhdGEudGFncykgew0KICAgICAgICAgICAgICAgIGZsb3dEYXRhLnRhZ3MuZm9yRWFjaCh0YWdEYXRhID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFnID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHRhZ0RhdGEuaWQsDQogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0YWdEYXRhLm5hbWUsDQogICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdGFnRGF0YS5kZXNjcmlwdGlvbiB8fCAnJywNCiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRhZ0RhdGEueCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRhZ0RhdGEueSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiB0YWdEYXRhLmNvbG9yIHx8ICcjNENBRjUwJw0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRhZyBjb3VudGVyDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhZ051bSA9IHBhcnNlSW50KHRhZ0RhdGEuaWQucmVwbGFjZSgndGFnXycsICcnKSk7DQogICAgICAgICAgICAgICAgICAgIGlmICh0YWdOdW0gPiBmbG93RWRpdG9yLnRhZ0NvdW50ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IudGFnQ291bnRlciA9IHRhZ051bTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci50YWdzLnNldCh0YWdEYXRhLmlkLCB0YWcpOw0KICAgICAgICAgICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkudGFnTWFuYWdlci5jcmVhdGVUYWdFbGVtZW50KHRhZyk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBjZW50ZXIgb2YgbG9hZGVkIG5vZGVzIGFuZCBhZGp1c3QgcGFuIHRvIGNlbnRlciB0aGVtDQogICAgICAgICAgICBpZiAoZmxvd0RhdGEubm9kZXMgJiYgZmxvd0RhdGEubm9kZXMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgIGNvbnN0IG1pblggPSBNYXRoLm1pbiguLi5mbG93RGF0YS5ub2Rlcy5tYXAobiA9PiBuLngpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBtYXhYID0gTWF0aC5tYXgoLi4uZmxvd0RhdGEubm9kZXMubWFwKG4gPT4gbi54KSk7DQogICAgICAgICAgICAgICAgY29uc3QgbWluWSA9IE1hdGgubWluKC4uLmZsb3dEYXRhLm5vZGVzLm1hcChuID0+IG4ueSkpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG1heFkgPSBNYXRoLm1heCguLi5mbG93RGF0YS5ub2Rlcy5tYXAobiA9PiBuLnkpKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBjb25zdCBjZW50ZXJYID0gKG1pblggKyBtYXhYKSAvIDI7DQogICAgICAgICAgICAgICAgY29uc3QgY2VudGVyWSA9IChtaW5ZICsgbWF4WSkgLyAyOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIEdldCBjYW52YXMgY29udGFpbmVyIGRpbWVuc2lvbnMNCiAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHBhbiBvZmZzZXQgdG8gY2VudGVyIHRoZSBub2RlcyBpbiB0aGUgdmlld3BvcnQNCiAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gLWNlbnRlclggKyBjb250YWluZXJSZWN0LndpZHRoIC8gMjsNCiAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC55ID0gLWNlbnRlclkgKyBjb250YWluZXJSZWN0LmhlaWdodCAvIDI7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEZpbmFsIGNvbm5lY3Rpb24gcmVkcmF3IGFmdGVyIGFsbCBwb3NpdGlvbmluZyBpcyBjb21wbGV0ZQ0KICAgICAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gVXBkYXRlIHRhZyBwYW5lbA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLnRhZ01hbmFnZXIudXBkYXRlVGFnUGFuZWwoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gVXBkYXRlIGN1cnJlbnQgZmlsZSBwYXRoDQogICAgICAgICAgICBmbG93RWRpdG9yLmN1cnJlbnRGaWxlUGF0aCA9IGZpbGVQYXRoOw0KICAgICAgICAgICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24pIHsNCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmxvdyBsb2FkZWQgZnJvbTogJHtmaWxlUGF0aH1gLCAnc3VjY2VzcycpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbikgew0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdObyB2YWxpZCBmbG93IGRhdGEgZm91bmQgaW4gdGhlIHNlbGVjdGVkIGZpbGUuJywgJ3dhcm5pbmcnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIGZsb3c6JywgZXJyb3IpOw0KICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKSB7DQogICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignRmFpbGVkIHRvIGxvYWQgZmxvdzogJyArIGVycm9yLm1lc3NhZ2UsICdlcnJvcicpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBVcGRhdGUgZmlsZW5hbWUgZGlzcGxheQ0KZnVuY3Rpb24gdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCkgew0KICAgIGNvbnN0IGZpbGVuYW1lRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXJyZW50LWZpbGVuYW1lJyk7DQogICAgaWYgKGZpbGVuYW1lRWxlbWVudCkgew0KICAgICAgICBjb25zdCBmaWxlbmFtZSA9IGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoID8gZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGguc3BsaXQoJy8nKS5wb3AoKSA6ICd1bnRpdGxlZC5mbG93JzsNCiAgICAgICAgZmlsZW5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZmlsZW5hbWU7DQogICAgfQ0KfQ0KDQoNCi8vIEV4cG9ydCB0byBnbG9iYWwgc2NvcGUNCnN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlciA9IHsNCiAgICBzYXZlRmxvdywNCiAgICBzYXZlRmxvd0FzLA0KICAgIGxvYWRGbG93LA0KICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheQ0KfTsNCg0KDQovLyBQb3B1bGF0ZSB0b29sYm94IHdpdGggbG9hZGVkIG5vZGVzDQpmdW5jdGlvbiBwb3B1bGF0ZVRvb2xib3goKSB7DQogICAgY29uc3QgdG9vbGJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mbG93LXRvb2xib3gnKTsNCiAgICBpZiAoIXRvb2xib3gpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVG9vbGJveCBub3QgZm91bmQnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBDbGVhciBleGlzdGluZyB0b29sYm94IGNvbnRlbnQNCiAgICBjb25zdCB0b29sYm94Q29udGVudCA9IHRvb2xib3gucXVlcnlTZWxlY3RvcignLnRvb2xib3gtY29udGVudCcpOw0KICAgIGlmICh0b29sYm94Q29udGVudCkgew0KICAgICAgICB0b29sYm94Q29udGVudC5pbm5lckhUTUwgPSAnJzsNCiAgICB9DQogICAgDQogICAgLy8gR3JvdXAgbm9kZXMgYnkgY2F0ZWdvcnkNCiAgICBjb25zdCBjYXRlZ29yaWVzID0ge307DQogICAgY29uc3QgYWxsTm9kZXMgPSBub2RlUmVnaXN0cnkuZ2V0QWxsTm9kZVR5cGVzKCk7DQogICAgDQogICAgDQogICAgYWxsTm9kZXMuZm9yRWFjaChub2RlRGVmID0+IHsNCiAgICAgICAgY29uc3QgY2F0ZWdvcnkgPSBub2RlRGVmLmNhdGVnb3J5IHx8ICdvdGhlcic7DQogICAgICAgIGlmICghY2F0ZWdvcmllc1tjYXRlZ29yeV0pIHsNCiAgICAgICAgICAgIGNhdGVnb3JpZXNbY2F0ZWdvcnldID0gW107DQogICAgICAgIH0NCiAgICAgICAgY2F0ZWdvcmllc1tjYXRlZ29yeV0ucHVzaChub2RlRGVmKTsNCiAgICB9KTsNCiAgICANCiAgICANCiAgICAvLyBDcmVhdGUgdG9vbGJveCBzZWN0aW9ucyBmb3IgZWFjaCBjYXRlZ29yeQ0KICAgIE9iamVjdC5lbnRyaWVzKGNhdGVnb3JpZXMpLmZvckVhY2goKFtjYXRlZ29yeSwgbm9kZXNdKSA9PiB7DQogICAgICAgIGNvbnN0IGNhdGVnb3J5U2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgICAgICBjYXRlZ29yeVNlY3Rpb24uY2xhc3NOYW1lID0gJ25vZGUtY2F0ZWdvcnknOw0KICAgICAgICBjYXRlZ29yeVNlY3Rpb24uaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgPGg1PiR7Y2F0ZWdvcnkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBjYXRlZ29yeS5zbGljZSgxKX08L2g1Pg0KICAgICAgICAgICAgJHtub2Rlcy5tYXAobm9kZURlZiA9PiBgDQogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0idG9vbGJveC1ub2RlLWJ0biIgZGF0YS1ub2RlLXR5cGU9IiR7bm9kZURlZi5pZH0iIHRpdGxlPSIke25vZGVEZWYuZGVzY3JpcHRpb259Ij4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9IiR7bm9kZURlZi5pY29ufSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICA8c3Bhbj4ke25vZGVEZWYubmFtZX08L3NwYW4+DQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICBgKS5qb2luKCcnKX0NCiAgICAgICAgYDsNCiAgICAgICAgDQogICAgICAgIGlmICh0b29sYm94Q29udGVudCkgew0KICAgICAgICAgICAgdG9vbGJveENvbnRlbnQuYXBwZW5kQ2hpbGQoY2F0ZWdvcnlTZWN0aW9uKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIFJlLWF0dGFjaCBldmVudCBsaXN0ZW5lcnMNCiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudG9vbGJveC1ub2RlLWJ0bicpLmZvckVhY2goYnRuID0+IHsNCiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIGNvbnN0IG5vZGVUeXBlID0gYnRuLmdldEF0dHJpYnV0ZSgnZGF0YS1ub2RlLXR5cGUnKTsNCiAgICAgICAgICAgIGlmIChub2RlVHlwZSkgew0KICAgICAgICAgICAgICAgIGFkZE5vZGUobm9kZVR5cGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9KTsNCiAgICANCn0NCg0KLy8gU2V0IHVwIGV2ZW50IGhhbmRsZXJzDQpmdW5jdGlvbiBzZXR1cEV2ZW50SGFuZGxlcnMoKSB7DQogICAgLy8gTm90ZTogVG9vbGJveCBub2RlIGJ1dHRvbiBldmVudCBsaXN0ZW5lcnMgYXJlIHNldCB1cCBpbiBwb3B1bGF0ZVRvb2xib3goKQ0KICAgIC8vIHRvIGF2b2lkIGR1cGxpY2F0ZXMgd2hlbiB0aGUgdG9vbGJveCBpcyByZXBvcHVsYXRlZA0KICAgIA0KICAgIC8vIFdvcmtmbG93IGFjdGlvbnMNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncnVuLXdvcmtmbG93Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcnVuV29ya2Zsb3cpOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9wLXdvcmtmbG93Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3RvcFdvcmtmbG93KTsNCiAgICAvLyBOb3RlOiBkZWxldGUtc2VsZWN0ZWQsIGNsZWFyLWNhbnZhcywgcmVzZXQtdmlldywgYW5kIGFkZC10YWcgYXJlIG5vdyBoYW5kbGVkIGJ5IGhhbWJ1cmdlciBtZW51DQogICAgDQogICAgLy8gWm9vbSBjb250cm9scw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b29tLWluJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIuem9vbUluKTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9vbS1vdXQnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci56b29tT3V0KTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9vbS1maXQnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci56b29tVG9GaXQpOw0KICAgIA0KICAgIC8vIE5vdGU6IEZpbGUgb3BlcmF0aW9ucyAoc2F2ZSwgc2F2ZS1hcywgbG9hZCkgYXJlIG5vdyBoYW5kbGVkIGJ5IGhhbWJ1cmdlciBtZW51DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NsZWFyLW91dHB1dCcpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsZWFyT3V0cHV0KTsNCiAgICANCiAgICAvLyBIYW1idXJnZXIgbWVudQ0KICAgIHNldHVwSGFtYnVyZ2VyTWVudSgpOw0KICAgIA0KICAgIC8vIENvbmZpZyBwYW5lbCB0b2dnbGUNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlLWNvbmZpZycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZUNvbmZpZ1BhbmVsKTsNCiAgICANCiAgICAvLyBJbml0aWFsaXplIGNvbmZpZyBwYW5lbCBzdGF0ZSAod2l0aG91dCBvdmVycmlkaW5nIGljb25zKQ0KICAgIGNvbnN0IGNvbmZpZ1BhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zsb3ctY29uZmlnLXBhbmVsJyk7DQogICAgaWYgKGNvbmZpZ1BhbmVsKSB7DQogICAgICAgIC8vIERlZmF1bHQgZXhwYW5kZWQgKG5vdCBjb2xsYXBzZWQpDQogICAgICAgIGNvbmZpZ1BhbmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2NvbGxhcHNlZCcpOw0KICAgIH0NCiAgICANCiAgICAvLyBUb29sYm94IHRvZ2dsZQ0KICAgIGNvbnN0IHRvb2xib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy10b29sYm94Jyk7DQogICAgY29uc3QgdG9vbGJveENvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9vbGJveC1jb250ZW50Jyk7DQogICAgY29uc3QgdG9nZ2xlVG9vbGJveEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtdG9vbGJveCcpOw0KICAgIGlmICh0b29sYm94ICYmIHRvb2xib3hDb250ZW50ICYmIHRvZ2dsZVRvb2xib3hCdG4pIHsNCiAgICAgICAgLy8gRGVmYXVsdCBleHBhbmRlZCAobm90IGNvbGxhcHNlZCkNCiAgICAgICAgdG9vbGJveC5jbGFzc0xpc3QucmVtb3ZlKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgdG9vbGJveENvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICcnOw0KDQogICAgICAgIHRvZ2dsZVRvb2xib3hCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgIHRvZ2dsZVRvb2xib3goKTsNCiAgICAgICAgfSk7DQogICAgfQ0KICAgIA0KICAgIC8vIE91dHB1dCBwYW5lbCB0b2dnbGUNCiAgICBjb25zdCBvdXRwdXRQYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmbG93LW91dHB1dC1wYW5lbCcpOw0KICAgIGNvbnN0IG91dHB1dENvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3V0cHV0LWNvbnRlbnQnKTsNCiAgICBjb25zdCB0b2dnbGVPdXRwdXRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlLW91dHB1dCcpOw0KICAgIGlmIChvdXRwdXRQYW5lbCAmJiBvdXRwdXRDb250ZW50ICYmIHRvZ2dsZU91dHB1dEJ0bikgew0KICAgICAgICAvLyBEZWZhdWx0IGNvbGxhcHNlZA0KICAgICAgICBvdXRwdXRQYW5lbC5jbGFzc0xpc3QuYWRkKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgb3V0cHV0Q29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICB0b2dnbGVPdXRwdXRCdG4ucXVlcnlTZWxlY3RvcignaScpLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1kb3duJzsNCg0KICAgICAgICB0b2dnbGVPdXRwdXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgIGNvbnN0IGlzQ29sbGFwc2VkID0gb3V0cHV0UGFuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgICAgIGlmIChpc0NvbGxhcHNlZCkgew0KICAgICAgICAgICAgICAgIG91dHB1dFBhbmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2NvbGxhcHNlZCcpOw0KICAgICAgICAgICAgICAgIG91dHB1dENvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICcnOw0KICAgICAgICAgICAgICAgIHRvZ2dsZU91dHB1dEJ0bi5xdWVyeVNlbGVjdG9yKCdpJykuY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLXVwJzsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgb3V0cHV0UGFuZWwuY2xhc3NMaXN0LmFkZCgnY29sbGFwc2VkJyk7DQogICAgICAgICAgICAgICAgb3V0cHV0Q29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICAgIHRvZ2dsZU91dHB1dEJ0bi5xdWVyeVNlbGVjdG9yKCdpJykuY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLWRvd24nOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgDQogICAgLy8gQ2FudmFzIGV2ZW50cw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIuaGFuZGxlQ2FudmFzQ2xpY2spOw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnN0YXJ0Q2FudmFzUGFuKTsNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLmhhbmRsZU1vdXNlV2hlZWwsIHsgcGFzc2l2ZTogZmFsc2UgfSk7DQogICAgDQogICAgLy8gRG9jdW1lbnQtbGV2ZWwgbW91c2UgZXZlbnRzIGZvciBzbW9vdGggZHJhZ2dpbmcgYW5kIHBhbm5pbmcNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci5oYW5kbGVEb2N1bWVudE1vdXNlRG93bik7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIuaGFuZGxlRG9jdW1lbnRNb3VzZU1vdmUpOw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci5oYW5kbGVEb2N1bWVudE1vdXNlVXApOw0KICAgIA0KDQp9DQoNCi8vIFRvZ2dsZSBjb25maWcgcGFuZWwNCmZ1bmN0aW9uIHRvZ2dsZUNvbmZpZ1BhbmVsKCkgew0KICAgIGNvbnN0IGNvbmZpZ1BhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zsb3ctY29uZmlnLXBhbmVsJyk7DQogICAgY29uc3QgdG9nZ2xlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1jb25maWcnKTsNCiAgICBjb25zdCBpY29uID0gdG9nZ2xlQnRuLnF1ZXJ5U2VsZWN0b3IoJ2knKTsNCiAgICANCiAgICBpZiAoY29uZmlnUGFuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb2xsYXBzZWQnKSkgew0KICAgICAgICAvLyBFeHBhbmQNCiAgICAgICAgY29uZmlnUGFuZWwuY2xhc3NMaXN0LnJlbW92ZSgnY29sbGFwc2VkJyk7DQogICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ0NvbGxhcHNlIENvbmZpZ3VyYXRpb24gUGFuZWwnOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIENvbGxhcHNlDQogICAgICAgIGNvbmZpZ1BhbmVsLmNsYXNzTGlzdC5hZGQoJ2NvbGxhcHNlZCcpOw0KICAgICAgICBpY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1sZWZ0JzsNCiAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ0V4cGFuZCBDb25maWd1cmF0aW9uIFBhbmVsJzsNCiAgICB9DQp9DQoNCi8vIFRvZ2dsZSB0b29sYm94DQpmdW5jdGlvbiB0b2dnbGVUb29sYm94KCkgew0KICAgIGNvbnN0IHRvb2xib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy10b29sYm94Jyk7DQogICAgY29uc3QgdG9vbGJveENvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9vbGJveC1jb250ZW50Jyk7DQogICAgY29uc3QgdG9nZ2xlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS10b29sYm94Jyk7DQogICAgY29uc3QgaWNvbiA9IHRvZ2dsZUJ0bi5xdWVyeVNlbGVjdG9yKCdpJyk7DQogICAgDQogICAgaWYgKHRvb2xib3guY2xhc3NMaXN0LmNvbnRhaW5zKCdjb2xsYXBzZWQnKSkgew0KICAgICAgICAvLyBFeHBhbmQNCiAgICAgICAgdG9vbGJveC5jbGFzc0xpc3QucmVtb3ZlKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgdG9vbGJveENvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICcnOw0KICAgICAgICBpY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1sZWZ0JzsNCiAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ0NvbGxhcHNlIFRvb2xib3gnOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIENvbGxhcHNlDQogICAgICAgIHRvb2xib3guY2xhc3NMaXN0LmFkZCgnY29sbGFwc2VkJyk7DQogICAgICAgIHRvb2xib3hDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ0V4cGFuZCBUb29sYm94JzsNCiAgICB9DQp9DQoNCi8vIFNldHVwIGhhbWJ1cmdlciBtZW51IGZ1bmN0aW9uYWxpdHkNCmZ1bmN0aW9uIHNldHVwSGFtYnVyZ2VyTWVudSgpIHsNCiAgICBjb25zdCBoYW1idXJnZXJCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGFtYnVyZ2VyLW1lbnUnKTsNCiAgICBjb25zdCBkcm9wZG93bk1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGRvd24tbWVudScpOw0KICAgIA0KICAgIGlmICghaGFtYnVyZ2VyQnRuIHx8ICFkcm9wZG93bk1lbnUpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignSGFtYnVyZ2VyIG1lbnUgZWxlbWVudHMgbm90IGZvdW5kJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gVG9nZ2xlIG1lbnUgb24gaGFtYnVyZ2VyIGNsaWNrDQogICAgaGFtYnVyZ2VyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgDQogICAgICAgIC8vIFBvc2l0aW9uIHRoZSBkcm9wZG93biByZWxhdGl2ZSB0byB0aGUgaGFtYnVyZ2VyIGJ1dHRvbg0KICAgICAgICBpZiAoIWRyb3Bkb3duTWVudS5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKSkgew0KICAgICAgICAgICAgLy8gVXNlIHNjYWxlZCBtb3VzZSBjb29yZGluYXRlcyBmb3IgbW9yZSBpbnR1aXRpdmUgcG9zaXRpb25pbmcNCiAgICAgICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPyANCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOg0KICAgICAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gaGFtYnVyZ2VyQnRuLmNsb3Nlc3QoJy5mbG93LWVkaXRvciwgLmFwcC1jb250YWluZXInKTsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCAmJiBjb250YWluZXIpID8NCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOg0KICAgICAgICAgICAgICAgIChjb250YWluZXIgPyBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiB7IHRvcDogMCwgbGVmdDogMCB9KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUG9zaXRpb24gcmVsYXRpdmUgdG8gbW91c2UgY2xpY2ssIG9mZnNldCBzbGlnaHRseSB0byBhdm9pZCBjb3ZlcmluZyB0aGUgYnV0dG9uDQogICAgICAgICAgICBjb25zdCByZWxhdGl2ZVRvcCA9IG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcCArIDU7DQogICAgICAgICAgICBjb25zdCByZWxhdGl2ZUxlZnQgPSBtb3VzZUNvb3Jkcy54IC0gY29udGFpbmVyUmVjdC5sZWZ0IC0gMTgwIC0gMTAgKyAyMDsgLy8gTWVudSB3aWR0aCArIHNtYWxsIGdhcCwgdGhlbiAyMHB4IG1vcmUgdG8gdGhlIHJpZ2h0DQogICAgICAgICAgICANCiAgICAgICAgICAgIGRyb3Bkb3duTWVudS5zdHlsZS50b3AgPSByZWxhdGl2ZVRvcCArICdweCc7DQogICAgICAgICAgICBkcm9wZG93bk1lbnUuc3R5bGUubGVmdCA9IHJlbGF0aXZlTGVmdCArICdweCc7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGRyb3Bkb3duTWVudS5jbGFzc0xpc3QudG9nZ2xlKCdzaG93Jyk7DQogICAgfSk7DQogICAgDQogICAgLy8gQ2xvc2UgbWVudSB3aGVuIGNsaWNraW5nIG91dHNpZGUNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgIGlmICghZHJvcGRvd25NZW51LmNvbnRhaW5zKGUudGFyZ2V0KSAmJiAhaGFtYnVyZ2VyQnRuLmNvbnRhaW5zKGUudGFyZ2V0KSkgew0KICAgICAgICAgICAgZHJvcGRvd25NZW51LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIEhhbmRsZSBtZW51IGl0ZW0gY2xpY2tzIC0gT05MWSB0aGUgc3BlY2lmaWMgYWN0aW9ucyByZXF1ZXN0ZWQNCiAgICBkcm9wZG93bk1lbnUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICBjb25zdCBtZW51SXRlbSA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5tZW51LWl0ZW0nKTsNCiAgICAgICAgaWYgKCFtZW51SXRlbSkgcmV0dXJuOw0KICAgICAgICANCiAgICAgICAgY29uc3QgYWN0aW9uID0gbWVudUl0ZW0uZGF0YXNldC5hY3Rpb247DQogICAgICAgIGlmICghYWN0aW9uKSByZXR1cm47DQogICAgICAgIA0KICAgICAgICAvLyBDbG9zZSB0aGUgbWVudQ0KICAgICAgICBkcm9wZG93bk1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOw0KICAgICAgICANCiAgICAgICAgLy8gRXhlY3V0ZSBPTkxZIHRoZSByZXF1ZXN0ZWQgYWN0aW9uczogc2F2ZSwgc2F2ZS1hcywgbG9hZCwgZGVsZXRlLCBjbGVhci1hbGwsIHJlc2V0LXZpZXcsIGFkZC10YWcNCiAgICAgICAgc3dpdGNoIChhY3Rpb24pIHsNCiAgICAgICAgICAgIGNhc2UgJ3NhdmUtZmxvdyc6DQogICAgICAgICAgICAgICAgaWYgKHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlciAmJiBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmlsZU1hbmFnZXIuc2F2ZUZsb3cpIHsNCiAgICAgICAgICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLnNhdmVGbG93KCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnc2F2ZS1mbG93LWFzJzoNCiAgICAgICAgICAgICAgICBpZiAoc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyICYmIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci5zYXZlRmxvd0FzKSB7DQogICAgICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci5zYXZlRmxvd0FzKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbG9hZC1mbG93JzoNCiAgICAgICAgICAgICAgICBpZiAoc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyICYmIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci5sb2FkRmxvdykgew0KICAgICAgICAgICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmlsZU1hbmFnZXIubG9hZEZsb3coKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdhZGQtdGFnJzoNCiAgICAgICAgICAgICAgICBpZiAoc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLnRhZ01hbmFnZXIgJiYgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLnRhZ01hbmFnZXIuYWRkVGFnKSB7DQogICAgICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS50YWdNYW5hZ2VyLmFkZFRhZygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3Jlc2V0LXZpZXcnOg0KICAgICAgICAgICAgICAgIGlmIChzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlciAmJiBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci5yZXNldENhbnZhc1Bhbikgew0KICAgICAgICAgICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci5yZXNldENhbnZhc1BhbigpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZS1zZWxlY3RlZCc6DQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkZWxldGVTZWxlY3RlZE5vZGUgPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgICAgICAgICAgZGVsZXRlU2VsZWN0ZWROb2RlKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnY2xlYXItY2FudmFzJzoNCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNsZWFyQ2FudmFzID09PSAnZnVuY3Rpb24nKSB7DQogICAgICAgICAgICAgICAgICAgIGNsZWFyQ2FudmFzKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfSk7DQp9DQoNCi8vIEV4YW1wbGU6IHVpLW1hbmFnZXIuanMNCnN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS51aU1hbmFnZXIgPSB7DQogICAgcG9wdWxhdGVUb29sYm94LA0KICAgIHNldHVwRXZlbnRIYW5kbGVycywNCiAgICB0b2dnbGVDb25maWdQYW5lbCwNCiAgICB0b2dnbGVUb29sYm94DQp9Ow0KDQovLyBtYWluLmpzIC0gRW50cnkgcG9pbnQgZm9yIEZsb3cgRWRpdG9yDQoNCi8vIEdsb2JhbCB2YXJpYWJsZXMgKHNjb3BlZCB0byBhdm9pZCBnbG9iYWwgcG9sbHV0aW9uKQ0KbGV0IGZsb3dFZGl0b3IgPSB7DQogICAgbm9kZXM6IG5ldyBNYXAoKSwNCiAgICBjb25uZWN0aW9uczogbmV3IE1hcCgpLA0KICAgIHNlbGVjdGVkTm9kZTogbnVsbCwNCiAgICBkcmFnZ2luZ05vZGU6IG51bGwsDQogICAgY29ubmVjdGluZ0Zyb206IG51bGwsDQogICAgY2FudmFzOiBudWxsLA0KICAgIG5vZGVDb3VudGVyOiAwLA0KICAgIGlzUnVubmluZzogZmFsc2UsDQogICAgY3VycmVudEZpbGVQYXRoOiBudWxsLA0KICAgIGlzQWN0aXZlOiB0cnVlLA0KICAgIC8vIENhbnZhcyBwYW5uaW5nIHN0YXRlDQogICAgaXNQYW5uaW5nOiBmYWxzZSwNCiAgICBwYW5TdGFydDogeyB4OiAwLCB5OiAwIH0sDQogICAgcGFuT2Zmc2V0OiB7IHg6IC01MDAwLCB5OiAtNTAwMCB9LCAvLyBDZW50ZXIgdGhlIGxhcmdlIGNhbnZhcyBpbml0aWFsbHkNCiAgICBsYXN0UGFuT2Zmc2V0OiB7IHg6IC01MDAwLCB5OiAtNTAwMCB9LA0KICAgIC8vIFpvb20gc3RhdGUNCiAgICB6b29tTGV2ZWw6IDEuMCwNCiAgICBtaW5ab29tOiAwLjEsDQogICAgbWF4Wm9vbTogMy4wLA0KICAgIHpvb21TdGVwOiAwLjEsDQogICAgLy8gVGFnIHN5c3RlbQ0KICAgIHRhZ3M6IG5ldyBNYXAoKSwNCiAgICB0YWdDb3VudGVyOiAwLA0KICAgIGRyYWdnaW5nVGFnOiBudWxsLA0KICAgIHRhZ0RyYWdPZmZzZXQ6IG51bGwsDQogICAgdGFnVXBkYXRlVGltZW91dDogbnVsbCwNCiAgICAvLyBWaXN1YWwgcGVyZm9ybWFuY2UgZmxhZ3MNCiAgICB0cmFuc2Zvcm1VcGRhdGVSZXF1ZXN0ZWQ6IGZhbHNlLA0KICAgIGlzWm9vbWluZzogZmFsc2UsDQogICAgaXNSZXNldHRpbmc6IGZhbHNlLA0KICAgIHJlZHJhd0luUHJvZ3Jlc3M6IGZhbHNlLA0KICAgIGxhc3RXaGVlbFRpbWU6IDAsDQogICAgLy8gVGltZW91dCBJRHMgZm9yIGNsZWFudXANCiAgICB6b29tUmVkcmF3VGltZW91dDogbnVsbCwNCiAgICB6b29tRml0VGltZW91dDogbnVsbCwNCiAgICByZXNldFRpbWVvdXQ6IG51bGwNCn07DQoNCi8vIEluaXRpYWxpemUgd2hlbiBET00gaXMgcmVhZHkNCmFzeW5jIGZ1bmN0aW9uIGluaXRGbG93RWRpdG9yKCkgew0KICAgIA0KICAgIC8vIENoZWNrIGlmIFN5cG5leEFQSSBpcyBhdmFpbGFibGUgKGxvY2FsIHZhcmlhYmxlIGluIHNhbmRib3hlZCBlbnZpcm9ubWVudCkNCiAgICBpZiAodHlwZW9mIHN5cG5leEFQSSA9PT0gJ3VuZGVmaW5lZCcgfHwgIXN5cG5leEFQSSkgew0KICAgICAgICBjb25zb2xlLndhcm4oJ1N5cG5leEFQSSBub3QgYXZhaWxhYmxlIC0gcnVubmluZyBpbiBzdGFuZGFsb25lIG1vZGUnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgc2NhbGUgZGV0ZWN0aW9uIGZvciBhcHAgc2NhbGluZyBjb21wZW5zYXRpb24NCiAgICBpZiAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmluaXRTY2FsZURldGVjdGlvbikgew0KICAgICAgICBzeXBuZXhBUEkuaW5pdFNjYWxlRGV0ZWN0aW9uKChuZXdTY2FsZSwgb2xkU2NhbGUpID0+IHsNCiAgICAgICAgICAgIC8vIFJlZHJhdyBjb25uZWN0aW9ucyB3aGVuIHNjYWxlIGNoYW5nZXMNCiAgICAgICAgICAgIGlmICh0eXBlb2YgcmVkcmF3QWxsQ29ubmVjdGlvbnMgPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgDQogICAgLy8gVGVzdCBWRlMgQVBJDQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgdGVzdFJlc3VsdCA9IGF3YWl0IHN5cG5leEFQSS5saXN0VmlydHVhbEZpbGVzKCcvJyk7DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVkZTIEFQSSB0ZXN0IGZhaWxlZDonLCBlcnJvcik7DQogICAgfQ0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgY2FudmFzDQogICAgZmxvd0VkaXRvci5jYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy1jYW52YXMnKTsNCiAgICBpZiAoIWZsb3dFZGl0b3IuY2FudmFzKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Zsb3cgY2FudmFzIG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIENyZWF0ZSBTVkcgbWFya2VyIGRlZmluaXRpb25zIGZvciBjb25uZWN0aW9uIGFycm93cw0KICAgIGNvbnN0IGRlZnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2RlZnMnKTsNCiAgICBjb25zdCBtYXJrZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ21hcmtlcicpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2Fycm93aGVhZCcpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ21hcmtlcldpZHRoJywgJzEwJyk7DQogICAgbWFya2VyLnNldEF0dHJpYnV0ZSgnbWFya2VySGVpZ2h0JywgJzcnKTsNCiAgICBtYXJrZXIuc2V0QXR0cmlidXRlKCdyZWZYJywgJzknKTsNCiAgICBtYXJrZXIuc2V0QXR0cmlidXRlKCdyZWZZJywgJzMuNScpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ29yaWVudCcsICdhdXRvJyk7DQogICAgbWFya2VyLnNldEF0dHJpYnV0ZSgnbWFya2VyVW5pdHMnLCAnc3Ryb2tlV2lkdGgnKTsNCiAgICANCiAgICBjb25zdCBwb2x5Z29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwb2x5Z29uJyk7DQogICAgcG9seWdvbi5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICcwIDAsIDEwIDMuNSwgMCA3Jyk7DQogICAgcG9seWdvbi5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnIzRDQUY1MCcpOw0KICAgIA0KICAgIG1hcmtlci5hcHBlbmRDaGlsZChwb2x5Z29uKTsNCiAgICBkZWZzLmFwcGVuZENoaWxkKG1hcmtlcik7DQogICAgDQogICAgLy8gQ3JlYXRlIGEgdGVtcG9yYXJ5IFNWRyBjb250YWluZXIgZm9yIHRoZSBtYXJrZXIgZGVmaW5pdGlvbg0KICAgIGNvbnN0IG1hcmtlclN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7DQogICAgbWFya2VyU3ZnLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsNCiAgICBtYXJrZXJTdmcuc3R5bGUud2lkdGggPSAnMCc7DQogICAgbWFya2VyU3ZnLnN0eWxlLmhlaWdodCA9ICcwJzsNCiAgICBtYXJrZXJTdmcuYXBwZW5kQ2hpbGQoZGVmcyk7DQogICAgZmxvd0VkaXRvci5jYW52YXMuYXBwZW5kQ2hpbGQobWFya2VyU3ZnKTsNCiAgICANCiAgICAvLyBJbml0aWFsaXplIGNhbnZhcyB0cmFuc2Zvcm0gZm9yIHBhbm5pbmcNCiAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICANCiAgICAvLyBMb2FkIG5vZGVzIGZyb20gVkZTDQogICAgYXdhaXQgbm9kZVJlZ2lzdHJ5LmxvYWROb2Rlc0Zyb21WRlMoKTsNCiAgICANCiAgICAvLyBQb3B1bGF0ZSB0b29sYm94IHdpdGggbG9hZGVkIG5vZGVzDQogICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLnVpTWFuYWdlci5wb3B1bGF0ZVRvb2xib3goKTsNCiAgICANCiAgICAvLyBTZXQgdXAgZXZlbnQgaGFuZGxlcnMNCiAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkudWlNYW5hZ2VyLnNldHVwRXZlbnRIYW5kbGVycygpOw0KICAgIA0KICAgIC8vIFNldCB1cCBrZXlib2FyZCBzaG9ydGN1dHMgdXNpbmcgbmV3IFN5cG5leEFQSQ0KICAgIHNldHVwS2V5Ym9hcmRTaG9ydGN1dHMoKTsNCiAgICANCiAgICAvLyBIYW5kbGUgZnVsbHNjcmVlbiBjaGFuZ2VzIHRvIHByZXZlbnQgdmlzdWFsIGZsYXNoaW5nDQogICAgZnVuY3Rpb24gaGFuZGxlRnVsbHNjcmVlbkNoYW5nZSgpIHsNCiAgICAgICAgY29uc3QgaXNGdWxsc2NyZWVuID0gISEoZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQubW96RnVsbFNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQubXNGdWxsc2NyZWVuRWxlbWVudCk7DQogICAgICAgIA0KICAgICAgICBpZiAoaXNGdWxsc2NyZWVuKSB7DQogICAgICAgICAgICAvLyBBZGQgbm8tdHJhbnNpdGlvbnMgY2xhc3Mgd2hlbiBlbnRlcmluZyBmdWxsc2NyZWVuDQogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ25vLXRyYW5zaXRpb25zJyk7DQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ25vLXRyYW5zaXRpb25zJyk7DQogICAgICAgICAgICAgICAgLy8gUmVkcmF3IGNvbm5lY3Rpb25zIGFmdGVyIGZ1bGxzY3JlZW4gdHJhbnNpdGlvbg0KICAgICAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9LCA1MDApOyAvLyBBbGxvdyBmdWxsc2NyZWVuIHRyYW5zaXRpb24gdG8gY29tcGxldGUNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIEFkZCBuby10cmFuc2l0aW9ucyBjbGFzcyB3aGVuIGV4aXRpbmcgZnVsbHNjcmVlbg0KICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCduby10cmFuc2l0aW9ucycpOw0KICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCduby10cmFuc2l0aW9ucycpOw0KICAgICAgICAgICAgICAgIC8vIFJlZHJhdyBjb25uZWN0aW9ucyBhZnRlciBmdWxsc2NyZWVuIHRyYW5zaXRpb24NCiAgICAgICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSwgNTAwKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBMaXN0ZW4gZm9yIGZ1bGxzY3JlZW4gY2hhbmdlcw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2Z1bGxzY3JlZW5jaGFuZ2UnLCBoYW5kbGVGdWxsc2NyZWVuQ2hhbmdlKTsNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd3ZWJraXRmdWxsc2NyZWVuY2hhbmdlJywgaGFuZGxlRnVsbHNjcmVlbkNoYW5nZSk7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW96ZnVsbHNjcmVlbmNoYW5nZScsIGhhbmRsZUZ1bGxzY3JlZW5DaGFuZ2UpOw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ01TRnVsbHNjcmVlbkNoYW5nZScsIGhhbmRsZUZ1bGxzY3JlZW5DaGFuZ2UpOw0KICAgIA0KICAgIC8vIEhhbmRsZSB3aW5kb3cgcmVzaXplIHRvIHVwZGF0ZSBjb25uZWN0aW9ucyB3aXRoIGRlYm91bmNpbmcNCiAgICBsZXQgcmVzaXplVGltZW91dDsNCiAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4gew0KICAgICAgICAvLyBBZGQgbm8tdHJhbnNpdGlvbnMgY2xhc3MgZHVyaW5nIHJlc2l6ZSB0byBwcmV2ZW50IGZsYXNoaW5nDQogICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnbm8tdHJhbnNpdGlvbnMnKTsNCiAgICAgICAgDQogICAgICAgIC8vIERlYm91bmNlIHJlc2l6ZSBldmVudHMgdG8gcHJldmVudCBvdmVyd2hlbG1pbmcgdGhlIHN5c3RlbQ0KICAgICAgICBjbGVhclRpbWVvdXQocmVzaXplVGltZW91dCk7DQogICAgICAgIHJlc2l6ZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIC8vIFJlbW92ZSBuby10cmFuc2l0aW9ucyBjbGFzcw0KICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCduby10cmFuc2l0aW9ucycpOw0KICAgICAgICAgICAgLy8gVXNlIHJlcXVlc3RBbmltYXRpb25GcmFtZSBmb3Igc21vb3RoIHVwZGF0ZXMNCiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7DQogICAgICAgICAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9LCAxNTApOyAvLyAxNTBtcyBkZWJvdW5jZQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIEhhbmRsZSBhcHAgY2xlYW51cCB3aGVuIHdpbmRvdyBpcyB1bmxvYWRlZA0KICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCBjbGVhbnVwRmxvd0VkaXRvcik7DQogICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmFkZEV2ZW50TGlzdGVuZXIoJ3BhZ2VoaWRlJywgY2xlYW51cEZsb3dFZGl0b3IpOw0KICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5hZGRFdmVudExpc3RlbmVyKCd1bmxvYWQnLCBjbGVhbnVwRmxvd0VkaXRvcik7DQogICAgDQogICAgLy8gRmxvdyBFZGl0b3IgbG9hZGVkIHN1Y2Nlc3NmdWxseSAobm8gbm90aWZpY2F0aW9uIG5lZWRlZCkNCiAgICANCiAgICAvLyBVcGRhdGUgZmlsZW5hbWUgZGlzcGxheQ0KICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci51cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICANCn0NCg0KLy8gQ2xlYW51cCBmdW5jdGlvbiB0byByZW1vdmUgdG9vbHRpcHMgYW5kIGV2ZW50IGxpc3RlbmVycw0KZnVuY3Rpb24gY2xlYW51cEZsb3dFZGl0b3IoKSB7DQogICAgLy8gTWFyayBhcHAgYXMgaW5hY3RpdmUgdG8gcHJldmVudCBuZXcgdG9vbHRpcHMNCiAgICBmbG93RWRpdG9yLmlzQWN0aXZlID0gZmFsc2U7DQogICAgDQogICAgLy8gQ2xlYXIgYWxsIHRpbWVvdXRzIHRvIHByZXZlbnQgbWVtb3J5IGxlYWtzDQogICAgY2xlYXJUaW1lb3V0KGZsb3dFZGl0b3Iuem9vbVJlZHJhd1RpbWVvdXQpOw0KICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnpvb21GaXRUaW1lb3V0KTsNCiAgICBjbGVhclRpbWVvdXQoZmxvd0VkaXRvci5yZXNldFRpbWVvdXQpOw0KICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnRhZ1VwZGF0ZVRpbWVvdXQpOw0KICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQpOw0KICAgIA0KICAgIC8vIFJlbW92ZSBhbnkgbGluZ2VyaW5nIHRvb2x0aXBzIChjaGVjayBtdWx0aXBsZSBwb3NzaWJsZSBsb2NhdGlvbnMpDQogICAgY29uc3QgdG9vbHRpcHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29ubmVjdGlvbi10b29sdGlwLCAjY29ubmVjdGlvbi10b29sdGlwJyk7DQogICAgdG9vbHRpcHMuZm9yRWFjaCh0b29sdGlwID0+IHsNCiAgICAgICAgaWYgKHRvb2x0aXAucGFyZW50Tm9kZSkgew0KICAgICAgICAgICAgdG9vbHRpcC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRvb2x0aXApOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gUmVtb3ZlIGdsb2JhbCBldmVudCBsaXN0ZW5lcnMNCiAgICBpZiAoc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlcikgew0KICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyKTsNCiAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlciA9IG51bGw7DQogICAgfQ0KICAgIA0KICAgIC8vIENsZWFyIGFueSBvdGhlciBnbG9iYWwgcmVmZXJlbmNlcw0KICAgIGlmIChzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyKSB7DQogICAgICAgIGRlbGV0ZSBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyOw0KICAgIH0NCiAgICANCiAgICAvLyBSZXNldCB2aXN1YWwgc3RhdGUgZmxhZ3MNCiAgICBmbG93RWRpdG9yLnRyYW5zZm9ybVVwZGF0ZVJlcXVlc3RlZCA9IGZhbHNlOw0KICAgIGZsb3dFZGl0b3IuaXNab29taW5nID0gZmFsc2U7DQogICAgZmxvd0VkaXRvci5pc1Jlc2V0dGluZyA9IGZhbHNlOw0KICAgIGZsb3dFZGl0b3IucmVkcmF3SW5Qcm9ncmVzcyA9IGZhbHNlOw0KICAgIA0KICAgIC8vIEFsc28gcmVtb3ZlIGFueSB0b29sdGlwcyB0aGF0IG1pZ2h0IGJlIGluIHRoZSBib2R5DQogICAgY29uc3QgYm9keVRvb2x0aXBzID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yQWxsKCcuY29ubmVjdGlvbi10b29sdGlwJyk7DQogICAgYm9keVRvb2x0aXBzLmZvckVhY2godG9vbHRpcCA9PiB7DQogICAgICAgIGlmICh0b29sdGlwLnBhcmVudE5vZGUpIHsNCiAgICAgICAgICAgIHRvb2x0aXAucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0b29sdGlwKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KfQ0KDQovLyBBZGQgYSBuZXcgbm9kZSB0byB0aGUgY2FudmFzIChkeW5hbWljIHZlcnNpb24pDQpmdW5jdGlvbiBhZGROb2RlKHR5cGUpIHsNCiAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKHR5cGUpOw0KICAgIGlmICghbm9kZURlZikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdVbmtub3duIG5vZGUgdHlwZTonLCB0eXBlKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBub2RlSWQgPSBgbm9kZV8keysrZmxvd0VkaXRvci5ub2RlQ291bnRlcn1gOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBwb3NpdGlvbiByZWxhdGl2ZSB0byBjdXJyZW50IHZpZXdwb3J0IGNlbnRlcg0KICAgIGNvbnN0IGNlbnRlciA9IHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVXRpbHMgPyANCiAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JVdGlscy5nZXRWaWV3cG9ydENlbnRlckluQ2FudmFzKCkgOg0KICAgICAgICB7IHg6IDUwMDAsIHk6IDUwMDAgfTsgLy8gRmFsbGJhY2sgdG8gY2FudmFzIGNlbnRlcg0KICAgIA0KICAgIC8vIEFkZCBzb21lIHJhbmRvbSBvZmZzZXQgYXJvdW5kIHRoZSBjZW50ZXINCiAgICBjb25zdCBvZmZzZXRYID0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMjAwOyAvLyAtMTAwIHRvICsxMDANCiAgICBjb25zdCBvZmZzZXRZID0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMjAwOyAvLyAtMTAwIHRvICsxMDANCiAgICANCiAgICBjb25zdCBub2RlID0gew0KICAgICAgICBpZDogbm9kZUlkLA0KICAgICAgICB0eXBlOiB0eXBlLA0KICAgICAgICB4OiBjZW50ZXIueCArIG9mZnNldFgsDQogICAgICAgIHk6IGNlbnRlci55ICsgb2Zmc2V0WSwNCiAgICAgICAgY29uZmlnOiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG5vZGVEZWYuY29uZmlnKSksIC8vIERlZXAgY29weQ0KICAgICAgICBkYXRhOiB7fQ0KICAgIH07DQogICAgDQogICAgLy8gSW5pdGlhbGl6ZSBzcGVjaWFsIG5vZGUgc3RhdGVzDQogICAgaWYgKHR5cGUgPT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlID0gew0KICAgICAgICAgICAgY291bnQ6IDAsDQogICAgICAgICAgICBpbnRlcnZhbDogbnVsbCwNCiAgICAgICAgICAgIGlzUnVubmluZzogZmFsc2UNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgZmxvd0VkaXRvci5ub2Rlcy5zZXQobm9kZUlkLCBub2RlKTsNCiAgICANCiAgICAvLyBDcmVhdGUgbm9kZSBlbGVtZW50IHVzaW5nIHRoZSByZW5kZXJlcg0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gbm9kZVJlbmRlcmVyLmNyZWF0ZU5vZGVFbGVtZW50KG5vZGUpOw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFwcGVuZENoaWxkKG5vZGVFbGVtZW50KTsNCiAgICANCn0NCg0KLy8gU2V0dXAga2V5Ym9hcmQgc2hvcnRjdXRzIHVzaW5nIG5ldyBTeXBuZXhBUEkNCmZ1bmN0aW9uIHNldHVwS2V5Ym9hcmRTaG9ydGN1dHMoKSB7DQogICAgLy8gQ2hlY2sgaWYgU3lwbmV4QVBJIGtleWJvYXJkIGZ1bmN0aW9uYWxpdHkgaXMgYXZhaWxhYmxlDQogICAgaWYgKHR5cGVvZiBzeXBuZXhBUEkgPT09ICd1bmRlZmluZWQnIHx8ICFzeXBuZXhBUEkgfHwgIXN5cG5leEFQSS5yZWdpc3RlcktleWJvYXJkU2hvcnRjdXRzKSB7DQogICAgICAgIGNvbnNvbGUud2FybignU3lwbmV4QVBJIGtleWJvYXJkIHNob3J0Y3V0cyBub3QgYXZhaWxhYmxlIC0gRmxvdyBFZGl0b3Iga2V5Ym9hcmQgc2hvcnRjdXRzIGRpc2FibGVkJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gUmVnaXN0ZXIga2V5Ym9hcmQgc2hvcnRjdXRzIHVzaW5nIHRoZSBuZXcgU3lwbmV4QVBJDQogICAgLy8gTWFwIGtleXMgdG8gdGhlaXIgaGFuZGxlcnMsIHByZXNlcnZpbmcgYWxsIHRoZSBvcmlnaW5hbCBsb2dpYyBmcm9tIGhhbmRsZUtleURvd24NCiAgICBzeXBuZXhBUEkucmVnaXN0ZXJLZXlib2FyZFNob3J0Y3V0cyh7DQogICAgICAgICdkZWxldGUnOiAoKSA9PiB7DQogICAgICAgICAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpIHsNCiAgICAgICAgICAgICAgICBkZWxldGVTZWxlY3RlZE5vZGUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgJ2N0cmwrYmFja3NwYWNlJzogKCkgPT4gew0KICAgICAgICAgICAgaWYgKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlKSB7DQogICAgICAgICAgICAgICAgZGVsZXRlU2VsZWN0ZWROb2RlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgICdjbWQrYmFja3NwYWNlJzogKCkgPT4gew0KICAgICAgICAgICAgaWYgKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlKSB7DQogICAgICAgICAgICAgICAgZGVsZXRlU2VsZWN0ZWROb2RlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgICdlc2NhcGUnOiAoKSA9PiB7DQogICAgICAgICAgICAvLyBEZXNlbGVjdCBub2RlDQogICAgICAgICAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlKTsNCiAgICAgICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7DQogICAgICAgICAgICAgICAgZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPSBudWxsOw0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlLWNvbmZpZycpLmlubmVySFRNTCA9ICc8cCBjbGFzcz0idGV4dC1tdXRlZCI+U2VsZWN0IGEgbm9kZSB0byBjb25maWd1cmUgaXQ8L3A+JzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgJ2N0cmwrcyc6ICgpID0+IHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci5zYXZlRmxvdygpOw0KICAgICAgICB9LA0KICAgICAgICAnY21kK3MnOiAoKSA9PiB7DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmlsZU1hbmFnZXIuc2F2ZUZsb3coKTsNCiAgICAgICAgfSwNCiAgICAgICAgJ2N0cmwrc2hpZnQrcyc6ICgpID0+IHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci5zYXZlRmxvd0FzKCk7DQogICAgICAgIH0sDQogICAgICAgICdjbWQrc2hpZnQrcyc6ICgpID0+IHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci5zYXZlRmxvd0FzKCk7DQogICAgICAgIH0sDQogICAgICAgICdjdHJsK28nOiAoKSA9PiB7DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmlsZU1hbmFnZXIubG9hZEZsb3coKTsNCiAgICAgICAgfSwNCiAgICAgICAgJ2NtZCtvJzogKCkgPT4gew0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLmxvYWRGbG93KCk7DQogICAgICAgIH0sDQogICAgICAgICdjdHJsKz0nOiAoKSA9PiB7DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci56b29tSW4oKTsNCiAgICAgICAgfSwNCiAgICAgICAgJ2NtZCs9JzogKCkgPT4gew0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIuem9vbUluKCk7DQogICAgICAgIH0sDQogICAgICAgICdjdHJsKy0nOiAoKSA9PiB7DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci56b29tT3V0KCk7DQogICAgICAgIH0sDQogICAgICAgICdjbWQrLSc6ICgpID0+IHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnpvb21PdXQoKTsNCiAgICAgICAgfSwNCiAgICAgICAgJ2N0cmwrMCc6ICgpID0+IHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnJlc2V0Q2FudmFzUGFuKCk7DQogICAgICAgIH0sDQogICAgICAgICdjbWQrMCc6ICgpID0+IHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnJlc2V0Q2FudmFzUGFuKCk7DQogICAgICAgIH0sDQogICAgICAgICdjdHJsK3NoaWZ0K2YnOiAoKSA9PiB7DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci56b29tVG9GaXQoKTsNCiAgICAgICAgfSwNCiAgICAgICAgJ2NtZCtzaGlmdCtmJzogKCkgPT4gew0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIuem9vbVRvRml0KCk7DQogICAgICAgIH0NCiAgICB9LCB7DQogICAgICAgIHByZXZlbnREZWZhdWx0OiB0cnVlLA0KICAgICAgICBzdG9wUHJvcGFnYXRpb246IGZhbHNlDQogICAgfSk7DQogICAgDQoNCn0NCg0KLy8gSW5pdGlhbGl6ZSB3aGVuIERPTSBpcyByZWFkeQ0KaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdsb2FkaW5nJykgew0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBpbml0Rmxvd0VkaXRvcik7DQp9IGVsc2Ugew0KICAgIC8vIERPTSBpcyBhbHJlYWR5IGxvYWRlZA0KICAgIGluaXRGbG93RWRpdG9yKCk7DQp9DQoNCg0KPC9zY3JpcHQ+"
  },
  "package_info": {
    "format_version": "1.0",
    "created_at": "2025-08-12T00:34:29.190578",
    "packaged_by": "Sypnex OS App Packager",
    "source_directory": ".\\flow_editor"
  },
  "additional_files": [
    {
      "vfs_path": "/apps/installed/flow_editor/nodes-pack.json",
      "filename": "nodes-pack.json",
      "data": "ew0KICAidmVyc2lvbiI6ICIxLjAuMCIsDQogICJwYWNrZWRfYXQiOiAiMjAyNS0wOC0wOFQxNDo0NjoyMy4zNjQzNDYiLA0KICAidG90YWxfbm9kZXMiOiAyMSwNCiAgIm5vZGVzIjogew0KICAgICJhcnJheSI6IHsNCiAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAibmFtZSI6ICJBcnJheSBPcGVyYXRpb25zIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQcm9jZXNzIGFycmF5cyBhbmQgbGlzdHMgd2l0aCBtYXAsIGZpbHRlciwgYW5kIG90aGVyIG9wZXJhdGlvbnMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWxpc3QiLA0KICAgICAgImNvbG9yIjogInByaW1hcnkiLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAgICAgIm5hbWUiOiAiQXJyYXkiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJvYmplY3QiLA0KICAgICAgICAgICJuYW1lIjogIk9iamVjdCIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInJlc3VsdCIsDQogICAgICAgICAgIm5hbWUiOiAiUmVzdWx0IiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJsZW5ndGgiLA0KICAgICAgICAgICJuYW1lIjogIkxlbmd0aCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpcnN0IiwNCiAgICAgICAgICAibmFtZSI6ICJGaXJzdCBJdGVtIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImxhc3QiLA0KICAgICAgICAgICJuYW1lIjogIkxhc3QgSXRlbSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJyYW5kb20iLA0KICAgICAgICAgICJuYW1lIjogIlJhbmRvbSBJdGVtIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgIm9wZXJhdGlvbiI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJPcGVyYXRpb24iLA0KICAgICAgICAgICJ2YWx1ZSI6ICJtYXAiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgIm1hcCIsDQogICAgICAgICAgICAiZmlsdGVyIiwNCiAgICAgICAgICAgICJsZW5ndGgiLA0KICAgICAgICAgICAgImpvaW4iLA0KICAgICAgICAgICAgImZpcnN0IiwNCiAgICAgICAgICAgICJsYXN0IiwNCiAgICAgICAgICAgICJyYW5kb20iLA0KICAgICAgICAgICAgInNsaWNlIiwNCiAgICAgICAgICAgICJyZXZlcnNlIiwNCiAgICAgICAgICAgICJzb3J0IiwNCiAgICAgICAgICAgICJ1bmlxdWUiLA0KICAgICAgICAgICAgIm9iamVjdF9rZXlzIiwNCiAgICAgICAgICAgICJvYmplY3RfdmFsdWVzIiwNCiAgICAgICAgICAgICJvYmplY3RfZW50cmllcyINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJmaWVsZF9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWVsZCBQYXRoIChmb3IgbWFwL2ZpbHRlcikiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJlLmcuLCBuYW1lLCB1c2VyLmVtYWlsLCBpZCINCiAgICAgICAgfSwNCiAgICAgICAgImZpbHRlcl92YWx1ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRmlsdGVyIFZhbHVlIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiVmFsdWUgdG8gZmlsdGVyIGJ5Ig0KICAgICAgICB9LA0KICAgICAgICAiZmlsdGVyX29wZXJhdG9yIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkZpbHRlciBPcGVyYXRvciIsDQogICAgICAgICAgInZhbHVlIjogImVxdWFscyIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAiZXF1YWxzIiwNCiAgICAgICAgICAgICJub3RfZXF1YWxzIiwNCiAgICAgICAgICAgICJjb250YWlucyIsDQogICAgICAgICAgICAiZ3JlYXRlcl90aGFuIiwNCiAgICAgICAgICAgICJsZXNzX3RoYW4iLA0KICAgICAgICAgICAgInN0YXJ0c193aXRoIiwNCiAgICAgICAgICAgICJlbmRzX3dpdGgiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiam9pbl9zZXBhcmF0b3IiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkpvaW4gU2VwYXJhdG9yIiwNCiAgICAgICAgICAidmFsdWUiOiAiLCAiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJTZXBhcmF0b3IgZm9yIGpvaW4gb3BlcmF0aW9uIg0KICAgICAgICB9LA0KICAgICAgICAic2xpY2Vfc3RhcnQiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiU2xpY2UgU3RhcnQiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDANCiAgICAgICAgfSwNCiAgICAgICAgInNsaWNlX2VuZCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJTbGljZSBFbmQgKDAgPSBlbmQpIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiYXJyYXlfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImF1ZGlvIjogew0KICAgICAgImlkIjogImF1ZGlvIiwNCiAgICAgICJuYW1lIjogIkF1ZGlvIFBsYXllciIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheSBhdWRpbyBmaWxlcyBhbmQgY29udHJvbCBwbGF5YmFjayIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtdm9sdW1lLXVwIiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJtZWRpYSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiZnJvbnRlbmRfb25seSIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhdWRpb19kYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJBdWRpbyBEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidXJsIiwNCiAgICAgICAgICAibmFtZSI6ICJVUkwiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJpbmFyeSIsDQogICAgICAgICAgIm5hbWUiOiAiQmluYXJ5IiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYXVkaW9fZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiQXVkaW8gRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImF1ZGlvX3VybCIsDQogICAgICAgICAgIm5hbWUiOiAiQXVkaW8gVVJMIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImR1cmF0aW9uIiwNCiAgICAgICAgICAibmFtZSI6ICJEdXJhdGlvbiIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm9yaWdpbmFsIiwNCiAgICAgICAgICAibmFtZSI6ICJPcmlnaW5hbCIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImF1dG9QbGF5Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkF1dG8gUGxheSIsDQogICAgICAgICAgInZhbHVlIjogImZhbHNlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJ2b2x1bWUiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiVm9sdW1lICgwLTEpIiwNCiAgICAgICAgICAidmFsdWUiOiAxLA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJtYXgiOiAxLA0KICAgICAgICAgICJzdGVwIjogMC4xDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiYXVkaW9fZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImNvbmRpdGlvbiI6IHsNCiAgICAgICJpZCI6ICJjb25kaXRpb24iLA0KICAgICAgIm5hbWUiOiAiQ29uZGl0aW9uIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJDb21wYXJlIGlucHV0IHZhbHVlIHRvIGEgY29uZGl0aW9uIGFuZCBvdXRwdXQgdHJ1ZS9mYWxzZSIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtcXVlc3Rpb24tY2lyY2xlIiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJsb2dpYyIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInZhbHVlIiwNCiAgICAgICAgICAibmFtZSI6ICJWYWx1ZSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInJlc3VsdCIsDQogICAgICAgICAgIm5hbWUiOiAiUmVzdWx0IiwNCiAgICAgICAgICAidHlwZSI6ICJib29sZWFuIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgIm9wZXJhdG9yIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk9wZXJhdG9yIiwNCiAgICAgICAgICAidmFsdWUiOiAiZXF1YWxzIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJlcXVhbHMiLA0KICAgICAgICAgICAgIm5vdF9lcXVhbHMiLA0KICAgICAgICAgICAgImdyZWF0ZXJfdGhhbiIsDQogICAgICAgICAgICAibGVzc190aGFuIiwNCiAgICAgICAgICAgICJncmVhdGVyX3RoYW5fb3JfZXF1YWwiLA0KICAgICAgICAgICAgImxlc3NfdGhhbl9vcl9lcXVhbCIsDQogICAgICAgICAgICAiY29udGFpbnMiLA0KICAgICAgICAgICAgIm5vdF9jb250YWlucyIsDQogICAgICAgICAgICAic3RhcnRzX3dpdGgiLA0KICAgICAgICAgICAgImVuZHNfd2l0aCIsDQogICAgICAgICAgICAiaXNfZW1wdHkiLA0KICAgICAgICAgICAgImlzX25vdF9lbXB0eSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJjb21wYXJlX3ZhbHVlIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJDb21wYXJlIFRvIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiVmFsdWUgdG8gY29tcGFyZSBhZ2FpbnN0Ig0KICAgICAgICB9LA0KICAgICAgICAiY2FzZV9zZW5zaXRpdmUiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQ2FzZSBTZW5zaXRpdmUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0cnVlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiY29uZGl0aW9uX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJkZWxheSI6IHsNCiAgICAgICJpZCI6ICJkZWxheSIsDQogICAgICAibmFtZSI6ICJEZWxheSIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiRGVsYXlzIHRoZSBmbG93IGV4ZWN1dGlvbiIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtY2xvY2siLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogImZsb3ciLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJleGVjdXRvciI6ICJkZWxheV9leGVjdXRvciIsDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiZGVsYXlfbXMiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiRGVsYXkgKG1pbGxpc2Vjb25kcykiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEwMDAsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgIm1heCI6IDYwMDAwLA0KICAgICAgICAgICJzdGVwIjogMTAwDQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KICAgICJkaXNwbGF5Ijogew0KICAgICAgImlkIjogImRpc3BsYXkiLA0KICAgICAgIm5hbWUiOiAiRGlzcGxheSBUZXh0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEaXNwbGF5IHRleHQgZGF0YSBpbiB2YXJpb3VzIGZvcm1hdHMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWV5ZSIsDQogICAgICAiY29sb3IiOiAic3VjY2VzcyIsDQogICAgICAiY2F0ZWdvcnkiOiAib3V0cHV0IiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJmcm9udGVuZF9vbmx5IiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImpzb24iLA0KICAgICAgICAgICJuYW1lIjogIkpTT04iLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkaXNwbGF5ZWQiLA0KICAgICAgICAgICJuYW1lIjogIkRpc3BsYXllZCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJpbnB1dF9wb3J0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIklucHV0IFBvcnQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJhdXRvIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJhdXRvIiwNCiAgICAgICAgICAgICJ0ZXh0IiwNCiAgICAgICAgICAgICJqc29uIiwNCiAgICAgICAgICAgICJkYXRhIiwNCiAgICAgICAgICAgICJiaW5hcnkiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiZm9ybWF0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkZvcm1hdCIsDQogICAgICAgICAgInZhbHVlIjogInRleHQiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRleHQiLA0KICAgICAgICAgICAgImpzb24iLA0KICAgICAgICAgICAgImh0bWwiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAibWF4TGVuZ3RoIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIk1heCBMZW5ndGgiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEwMDAsDQogICAgICAgICAgIm1pbiI6IDEsDQogICAgICAgICAgIm1heCI6IDEwMDAwLA0KICAgICAgICAgICJzdGVwIjogMTAwDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiZGlzcGxheV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAiZm9yX2VhY2giOiB7DQogICAgICAiaWQiOiAiZm9yX2VhY2giLA0KICAgICAgIm5hbWUiOiAiRm9yIEVhY2giLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkl0ZXJhdGUgdGhyb3VnaCBhbiBhcnJheSBhbmQgZXhlY3V0ZSBjb25uZWN0ZWQgbm9kZXMgZm9yIGVhY2ggaXRlbSIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtcmVwZWF0IiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJmbG93IiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAgICAgIm5hbWUiOiAiQXJyYXkiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjdXJyZW50X2l0ZW0iLA0KICAgICAgICAgICJuYW1lIjogIkN1cnJlbnQgSXRlbSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjdXJyZW50X2luZGV4IiwNCiAgICAgICAgICAibmFtZSI6ICJDdXJyZW50IEluZGV4IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiY29tcGxldGVkIiwNCiAgICAgICAgICAibmFtZSI6ICJDb21wbGV0ZWQiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAic3RvcF9vbl9lcnJvciI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJTdG9wIG9uIEVycm9yIiwNCiAgICAgICAgICAidmFsdWUiOiAidHJ1ZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiaXRlcmF0aW9uX2RlbGF5Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkl0ZXJhdGlvbiBEZWxheSAobXMpIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJtYXgiOiA2MDAwMCwNCiAgICAgICAgICAic3RlcCI6IDEwMCwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiRGVsYXkgYmV0d2VlbiBpdGVyYXRpb25zIGluIG1pbGxpc2Vjb25kcyINCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJmb3JfZWFjaF9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAiaHR0cCI6IHsNCiAgICAgICJpZCI6ICJodHRwIiwNCiAgICAgICJuYW1lIjogIkhUVFAgUmVxdWVzdCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiTWFrZSBIVFRQIHJlcXVlc3RzIHRvIGV4dGVybmFsIEFQSXMgYW5kIHNlcnZpY2VzIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1nbG9iZSIsDQogICAgICAiY29sb3IiOiAicHJpbWFyeSIsDQogICAgICAiY2F0ZWdvcnkiOiAibmV0d29yayIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJqc29uIiwNCiAgICAgICAgICAibmFtZSI6ICJKU09OIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJpbmFyeSIsDQogICAgICAgICAgIm5hbWUiOiAiQmluYXJ5IiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAic3RhdHVzX2NvZGUiLA0KICAgICAgICAgICJuYW1lIjogIlN0YXR1cyBDb2RlIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiaGVhZGVycyIsDQogICAgICAgICAgIm5hbWUiOiAiSGVhZGVycyIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ1cmwiLA0KICAgICAgICAgICJuYW1lIjogIlVSTCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJ1cmwiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIlVSTCIsDQogICAgICAgICAgInZhbHVlIjogImh0dHBzOi8vanNvbnBsYWNlaG9sZGVyLnR5cGljb2RlLmNvbS9wb3N0cy8xIg0KICAgICAgICB9LA0KICAgICAgICAibWV0aG9kIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk1ldGhvZCIsDQogICAgICAgICAgInZhbHVlIjogIkdFVCIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAiR0VUIiwNCiAgICAgICAgICAgICJQT1NUIiwNCiAgICAgICAgICAgICJQVVQiLA0KICAgICAgICAgICAgIkRFTEVURSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJoZWFkZXJzIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHRhcmVhIiwNCiAgICAgICAgICAibGFiZWwiOiAiSGVhZGVycyAoSlNPTikiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ7XCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJ9Ig0KICAgICAgICB9LA0KICAgICAgICAiYm9keSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0YXJlYSIsDQogICAgICAgICAgImxhYmVsIjogIkJvZHkgKEpTT04pIiwNCiAgICAgICAgICAidmFsdWUiOiAie1wibWVzc2FnZVwiOiBcInt7VkFMVUV9fVwiLCBcInRpbWVzdGFtcFwiOiBcInt7SlNPTjp0aW1lc3RhbXB9fVwifSINCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJodHRwX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJpbWFnZSI6IHsNCiAgICAgICJpZCI6ICJpbWFnZSIsDQogICAgICAibmFtZSI6ICJJbWFnZSBEaXNwbGF5IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEaXNwbGF5IGltYWdlcyBhbmQgY29udHJvbCB2aXN1YWxpemF0aW9uIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1pbWFnZSIsDQogICAgICAiY29sb3IiOiAiaW5mbyIsDQogICAgICAiY2F0ZWdvcnkiOiAibWVkaWEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImZyb250ZW5kX29ubHkiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJpbmFyeSIsDQogICAgICAgICAgIm5hbWUiOiAiQmluYXJ5IiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiaW1hZ2VfZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiSW1hZ2UgRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInVybCIsDQogICAgICAgICAgIm5hbWUiOiAiVVJMIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJiaW5hcnkiLA0KICAgICAgICAgICJuYW1lIjogIkJpbmFyeSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImltYWdlX2RhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkltYWdlIERhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJpbWFnZV91cmwiLA0KICAgICAgICAgICJuYW1lIjogIkltYWdlIFVSTCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkaW1lbnNpb25zIiwNCiAgICAgICAgICAibmFtZSI6ICJEaW1lbnNpb25zIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm9yaWdpbmFsIiwNCiAgICAgICAgICAibmFtZSI6ICJPcmlnaW5hbCIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgIm1heF9wcmV2aWV3X3NpemUiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiTWF4IFByZXZpZXcgU2l6ZSIsDQogICAgICAgICAgInZhbHVlIjogMzAwLA0KICAgICAgICAgICJtaW4iOiA1MCwNCiAgICAgICAgICAibWF4IjogODAwLA0KICAgICAgICAgICJzdGVwIjogNTANCiAgICAgICAgfSwNCiAgICAgICAgInNob3dfaW5mbyI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJTaG93IEluZm8iLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0cnVlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiaW1hZ2VfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImpzb25fZXh0cmFjdCI6IHsNCiAgICAgICJpZCI6ICJqc29uX2V4dHJhY3QiLA0KICAgICAgIm5hbWUiOiAiSlNPTiBFeHRyYWN0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJFeHRyYWN0IHZhbHVlcyBmcm9tIEpTT04gZGF0YSB1c2luZyBkb3Qgbm90YXRpb24iLA0KICAgICAgImljb24iOiAiZmFzIGZhLWNvZGUtYnJhbmNoIiwNCiAgICAgICJjb2xvciI6ICJpbmZvIiwNCiAgICAgICJjYXRlZ29yeSI6ICJkYXRhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJqc29uIiwNCiAgICAgICAgICAibmFtZSI6ICJKU09OIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAianNvbiIsDQogICAgICAgICAgIm5hbWUiOiAiSlNPTiIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJleHRyYWN0ZWRfdmFsdWUiLA0KICAgICAgICAgICJuYW1lIjogIkV4dHJhY3RlZCBWYWx1ZSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJmaWVsZF9wYXRoIiwNCiAgICAgICAgICAibmFtZSI6ICJGaWVsZCBQYXRoIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm9yaWdpbmFsIiwNCiAgICAgICAgICAibmFtZSI6ICJPcmlnaW5hbCIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJmaWVsZF9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWVsZCBQYXRoIiwNCiAgICAgICAgICAidmFsdWUiOiAiZGF0YS5pdGVtcyIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlVzZSBkb3Qgbm90YXRpb24gKGUuZy4sIGRhdGEuaXRlbXMuMC5uYW1lKSINCiAgICAgICAgfSwNCiAgICAgICAgImRpc3BsYXlfZm9ybWF0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkRpc3BsYXkgRm9ybWF0IiwNCiAgICAgICAgICAidmFsdWUiOiAidGV4dCIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidGV4dCIsDQogICAgICAgICAgICAianNvbiINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAianNvbl9leHRyYWN0X2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJsbG1fY2hhdCI6IHsNCiAgICAgICJpZCI6ICJsbG1fY2hhdCIsDQogICAgICAibmFtZSI6ICJMTE0gQ2hhdCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiQ2hhdCB3aXRoIExhcmdlIExhbmd1YWdlIE1vZGVscyB1c2luZyBPbGxhbWEiLA0KICAgICAgImljb24iOiAiZmFzIGZhLXJvYm90IiwNCiAgICAgICJjb2xvciI6ICJpbmZvIiwNCiAgICAgICJjYXRlZ29yeSI6ICJhaSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInByb21wdCIsDQogICAgICAgICAgIm5hbWUiOiAiUHJvbXB0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInN5c3RlbV9tZXNzYWdlIiwNCiAgICAgICAgICAibmFtZSI6ICJTeXN0ZW0gTWVzc2FnZSIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjb250ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJDb250ZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAicmVzcG9uc2UiLA0KICAgICAgICAgICJuYW1lIjogIlJlc3BvbnNlIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRva2Vuc191c2VkIiwNCiAgICAgICAgICAibmFtZSI6ICJUb2tlbnMgVXNlZCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm1vZGVsX3VzZWQiLA0KICAgICAgICAgICJuYW1lIjogIk1vZGVsIFVzZWQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZnVsbF9yZXNwb25zZSIsDQogICAgICAgICAgIm5hbWUiOiAiRnVsbCBSZXNwb25zZSIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJlbmRwb2ludCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT2xsYW1hIEVuZHBvaW50IiwNCiAgICAgICAgICAidmFsdWUiOiAiaHR0cDovLzEyNy4wLjAuMToxMTQzNC92MSIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogImh0dHA6Ly8xMjcuMC4wLjE6MTE0MzQvdjEiDQogICAgICAgIH0sDQogICAgICAgICJtb2RlbCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiTW9kZWwgTmFtZSIsDQogICAgICAgICAgInZhbHVlIjogIkhhbW1lckFJL21uLW1hZy1tZWxsLXIxOmxhdGVzdCIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogImxsYW1hMiwgY29kZWxsYW1hLCBldGMuIg0KICAgICAgICB9LA0KICAgICAgICAidGVtcGVyYXR1cmUiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiVGVtcGVyYXR1cmUiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAuNywNCiAgICAgICAgICAibWluIjogMCwNCiAgICAgICAgICAibWF4IjogMiwNCiAgICAgICAgICAic3RlcCI6IDAuMQ0KICAgICAgICB9LA0KICAgICAgICAibWF4X3Rva2VucyI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJNYXggVG9rZW5zIiwNCiAgICAgICAgICAidmFsdWUiOiAyMDQ4LA0KICAgICAgICAgICJtaW4iOiAxLA0KICAgICAgICAgICJtYXgiOiA4MTkyLA0KICAgICAgICAgICJzdGVwIjogMQ0KICAgICAgICB9LA0KICAgICAgICAic3lzdGVtX3Byb21wdCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0YXJlYSIsDQogICAgICAgICAgImxhYmVsIjogIlN5c3RlbSBQcm9tcHQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJZb3UgYXJlIGEgaGVscGZ1bCBBSSBhc3Npc3RhbnQuIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiRGVmaW5lIHRoZSBBSSdzIHJvbGUgYW5kIGJlaGF2aW9yIg0KICAgICAgICB9LA0KICAgICAgICAiYXBpX2tleSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQVBJIEtleSIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIkVudGVyIHlvdXIgQVBJIGtleSAob3B0aW9uYWwgZm9yIGxvY2FsIG1vZGVscykiLA0KICAgICAgICAgICJlbmNyeXB0IjogdHJ1ZQ0KICAgICAgICB9LA0KICAgICAgICAiaW5jbHVkZV9jb250ZXh0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkluY2x1ZGUgQ29udGV4dCIsDQogICAgICAgICAgInZhbHVlIjogInRydWUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJsbG1fY2hhdF9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAibG9naWNhbF9nYXRlIjogew0KICAgICAgImlkIjogImxvZ2ljYWxfZ2F0ZSIsDQogICAgICAibmFtZSI6ICJMb2dpY2FsIEdhdGUiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIk9ubHkgY29udGludWUgZXhlY3V0aW9uIGlmIGlucHV0IGlzIHRydWUiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWZpbHRlciIsDQogICAgICAiY29sb3IiOiAiaW5mbyIsDQogICAgICAiY2F0ZWdvcnkiOiAibG9naWMiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjb25kaXRpb24iLA0KICAgICAgICAgICJuYW1lIjogIkNvbmRpdGlvbiIsDQogICAgICAgICAgInR5cGUiOiAiYm9vbGVhbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiaW52ZXJ0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkludmVydCBMb2dpYyIsDQogICAgICAgICAgInZhbHVlIjogImZhbHNlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJkZXNjcmlwdGlvbiI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRGVzY3JpcHRpb24iLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJPcHRpb25hbCBkZXNjcmlwdGlvbiBvZiB3aGF0IHRoaXMgZ2F0ZSBkb2VzIg0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImxvZ2ljYWxfZ2F0ZV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAibWF0aCI6IHsNCiAgICAgICJpZCI6ICJtYXRoIiwNCiAgICAgICJuYW1lIjogIk1hdGggT3BlcmF0aW9ucyIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiUGVyZm9ybSBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvbiBudW1lcmljIHZhbHVlcyIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtY2FsY3VsYXRvciIsDQogICAgICAiY29sb3IiOiAiaW5mbyIsDQogICAgICAiY2F0ZWdvcnkiOiAiZGF0YSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInZhbHVlX2EiLA0KICAgICAgICAgICJuYW1lIjogIlZhbHVlIEEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidmFsdWVfYiIsDQogICAgICAgICAgIm5hbWUiOiAiVmFsdWUgQiIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJudW1iZXJfYSIsDQogICAgICAgICAgIm5hbWUiOiAiTnVtYmVyIEEiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJudW1iZXJfYiIsDQogICAgICAgICAgIm5hbWUiOiAiTnVtYmVyIEIiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInJlc3VsdCIsDQogICAgICAgICAgIm5hbWUiOiAiUmVzdWx0IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZvcm1hdHRlZCIsDQogICAgICAgICAgIm5hbWUiOiAiRm9ybWF0dGVkIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgIm9wZXJhdGlvbiI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJPcGVyYXRpb24iLA0KICAgICAgICAgICJ2YWx1ZSI6ICJhZGQiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImFkZCIsDQogICAgICAgICAgICAic3VidHJhY3QiLA0KICAgICAgICAgICAgIm11bHRpcGx5IiwNCiAgICAgICAgICAgICJkaXZpZGUiLA0KICAgICAgICAgICAgIm1vZHVsbyIsDQogICAgICAgICAgICAicG93ZXIiLA0KICAgICAgICAgICAgIm1pbiIsDQogICAgICAgICAgICAibWF4IiwNCiAgICAgICAgICAgICJhYnMiLA0KICAgICAgICAgICAgInJvdW5kIiwNCiAgICAgICAgICAgICJmbG9vciIsDQogICAgICAgICAgICAiY2VpbCINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJ2YWx1ZV9hIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIlZhbHVlIEEgKGlmIG5vdCBjb25uZWN0ZWQpIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJzdGVwIjogMC4wMQ0KICAgICAgICB9LA0KICAgICAgICAidmFsdWVfYiI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJWYWx1ZSBCIChpZiBub3QgY29ubmVjdGVkKSIsDQogICAgICAgICAgInZhbHVlIjogMCwNCiAgICAgICAgICAic3RlcCI6IDAuMDENCiAgICAgICAgfSwNCiAgICAgICAgImRlY2ltYWxfcGxhY2VzIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkRlY2ltYWwgUGxhY2VzIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJtYXgiOiAxMCwNCiAgICAgICAgICAic3RlcCI6IDENCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJtYXRoX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJub2RlX3JlZmVyZW5jZSI6IHsNCiAgICAgICJpZCI6ICJub2RlX3JlZmVyZW5jZSIsDQogICAgICAibmFtZSI6ICJOb2RlIFJlZmVyZW5jZSIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiQWNjZXNzIG91dHB1dCBkYXRhIGZyb20gYW55IHByZXZpb3VzbHkgZXhlY3V0ZWQgbm9kZSBpbiB0aGUgd29ya2Zsb3ciLA0KICAgICAgImljb24iOiAiZmFzIGZhLWxpbmsiLA0KICAgICAgImNvbG9yIjogImluZm8iLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIiwNCiAgICAgICAgICAib3B0aW9uYWwiOiB0cnVlDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAianNvbiIsDQogICAgICAgICAgIm5hbWUiOiAiSlNPTiIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJudW1iZXIiLA0KICAgICAgICAgICJuYW1lIjogIk51bWJlciIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJvb2xlYW4iLA0KICAgICAgICAgICJuYW1lIjogIkJvb2xlYW4iLA0KICAgICAgICAgICJ0eXBlIjogImJvb2xlYW4iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJvcmlnaW5hbCIsDQogICAgICAgICAgIm5hbWUiOiAiT3JpZ2luYWwiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAic291cmNlX25vZGVfaWQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiU291cmNlIE5vZGUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJvcHRpb25zIjogW10sDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlNlbGVjdCBhIG5vZGUgdG8gcmVmZXJlbmNlIg0KICAgICAgICB9LA0KICAgICAgICAib3V0cHV0X3BvcnRfaWQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3V0cHV0IFBvcnQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJvcHRpb25zIjogW10sDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlNlbGVjdCBhbiBvdXRwdXQgcG9ydCINCiAgICAgICAgfSwNCiAgICAgICAgImZhbGxiYWNrX3ZhbHVlIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGYWxsYmFjayBWYWx1ZSIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlZhbHVlIHRvIHVzZSBpZiByZWZlcmVuY2UgZmFpbHMiDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAibm9kZV9yZWZlcmVuY2VfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInJhbmRvbSI6IHsNCiAgICAgICJpZCI6ICJyYW5kb20iLA0KICAgICAgIm5hbWUiOiAiUmFuZG9tIE51bWJlciIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiR2VuZXJhdGUgcmFuZG9tIG51bWJlcnMgd2l0aGluIGEgc3BlY2lmaWVkIHJhbmdlIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1kaWNlIiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJkYXRhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSIsDQogICAgICAgICAgIm9wdGlvbmFsIjogdHJ1ZQ0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAibnVtYmVyIiwNCiAgICAgICAgICAibmFtZSI6ICJOdW1iZXIiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiaW50ZWdlciIsDQogICAgICAgICAgIm5hbWUiOiAiSW50ZWdlciIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZsb2F0IiwNCiAgICAgICAgICAibmFtZSI6ICJGbG9hdCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgIm1pbl92YWx1ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJNaW5pbXVtIFZhbHVlIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJzdGVwIjogMC4wMQ0KICAgICAgICB9LA0KICAgICAgICAibWF4X3ZhbHVlIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIk1heGltdW0gVmFsdWUiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEwMCwNCiAgICAgICAgICAic3RlcCI6IDAuMDENCiAgICAgICAgfSwNCiAgICAgICAgImRlY2ltYWxfcGxhY2VzIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkRlY2ltYWwgUGxhY2VzIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJtYXgiOiAxMCwNCiAgICAgICAgICAic3RlcCI6IDENCiAgICAgICAgfSwNCiAgICAgICAgIm91dHB1dF90eXBlIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk91dHB1dCBUeXBlIiwNCiAgICAgICAgICAidmFsdWUiOiAiaW50ZWdlciIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAiaW50ZWdlciIsDQogICAgICAgICAgICAiZmxvYXQiDQogICAgICAgICAgXQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInJhbmRvbV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAicmVwZWF0ZXIiOiB7DQogICAgICAiaWQiOiAicmVwZWF0ZXIiLA0KICAgICAgIm5hbWUiOiAiUmVwZWF0ZXIiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIlJlcGVhdCBjb25uZWN0ZWQgd29ya2Zsb3cgYXQgaW50ZXJ2YWxzIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1yZWRvIiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJ0cmlnZ2VyIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiY291bnQiLA0KICAgICAgICAgICJuYW1lIjogIkNvdW50IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiaW50ZXJ2YWwiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiSW50ZXJ2YWwgKG1zKSIsDQogICAgICAgICAgInZhbHVlIjogMTAwMCwNCiAgICAgICAgICAibWluIjogMTAwLA0KICAgICAgICAgICJtYXgiOiAzMDAwMDAsDQogICAgICAgICAgInN0ZXAiOiAxMDANCiAgICAgICAgfSwNCiAgICAgICAgImNvdW50Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkNvdW50ICgwID0gaW5maW5pdGUpIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJzdGVwIjogMQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInJlcGVhdGVyX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJzdHJpbmciOiB7DQogICAgICAiaWQiOiAic3RyaW5nIiwNCiAgICAgICJuYW1lIjogIlN0cmluZyBPcGVyYXRpb25zIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJNYW5pcHVsYXRlIGFuZCBwcm9jZXNzIHRleHQgc3RyaW5ncyB3aXRoIHZhcmlvdXMgb3BlcmF0aW9ucyIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtdGV4dC13aWR0aCIsDQogICAgICAiY29sb3IiOiAic2Vjb25kYXJ5IiwNCiAgICAgICJjYXRlZ29yeSI6ICJkYXRhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0X2IiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQgQiIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAicmVzdWx0IiwNCiAgICAgICAgICAibmFtZSI6ICJSZXN1bHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAgICAgIm5hbWUiOiAiQXJyYXkiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAibGVuZ3RoIiwNCiAgICAgICAgICAibmFtZSI6ICJMZW5ndGgiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ3b3JkX2NvdW50IiwNCiAgICAgICAgICAibmFtZSI6ICJXb3JkIENvdW50IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAib3BlcmF0aW9uIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk9wZXJhdGlvbiIsDQogICAgICAgICAgInZhbHVlIjogImNvbmNhdGVuYXRlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJjb25jYXRlbmF0ZSIsDQogICAgICAgICAgICAic3BsaXQiLA0KICAgICAgICAgICAgInJlcGxhY2UiLA0KICAgICAgICAgICAgInRyaW0iLA0KICAgICAgICAgICAgInVwcGVyY2FzZSIsDQogICAgICAgICAgICAibG93ZXJjYXNlIiwNCiAgICAgICAgICAgICJzdWJzdHJpbmciLA0KICAgICAgICAgICAgInJlZ2V4X21hdGNoIiwNCiAgICAgICAgICAgICJyZWdleF9yZXBsYWNlIiwNCiAgICAgICAgICAgICJzdGFydHNfd2l0aCIsDQogICAgICAgICAgICAiZW5kc193aXRoIiwNCiAgICAgICAgICAgICJjb250YWlucyIsDQogICAgICAgICAgICAicmVwZWF0IiwNCiAgICAgICAgICAgICJsYXN0X2xpbmUiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAidGV4dF9iIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJUZXh0IEIgKGlmIG5vdCBjb25uZWN0ZWQpIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiU2Vjb25kIHRleHQgaW5wdXQiDQogICAgICAgIH0sDQogICAgICAgICJzZXBhcmF0b3IiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIlNlcGFyYXRvci9EZWxpbWl0ZXIiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIsIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiRm9yIHNwbGl0L2pvaW4gb3BlcmF0aW9ucyINCiAgICAgICAgfSwNCiAgICAgICAgInNlYXJjaF90ZXh0Ijogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJTZWFyY2ggVGV4dCIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlRleHQgdG8gc2VhcmNoL3JlcGxhY2UiDQogICAgICAgIH0sDQogICAgICAgICJyZXBsYWNlX3RleHQiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIlJlcGxhY2UgV2l0aCIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlJlcGxhY2VtZW50IHRleHQiDQogICAgICAgIH0sDQogICAgICAgICJzdGFydF9pbmRleCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJTdGFydCBJbmRleCIsDQogICAgICAgICAgInZhbHVlIjogMCwNCiAgICAgICAgICAibWluIjogMA0KICAgICAgICB9LA0KICAgICAgICAiZW5kX2luZGV4Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkVuZCBJbmRleCAoMCA9IGVuZCkiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDANCiAgICAgICAgfSwNCiAgICAgICAgInJlcGVhdF9jb3VudCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJSZXBlYXQgQ291bnQiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEsDQogICAgICAgICAgIm1pbiI6IDEsDQogICAgICAgICAgIm1heCI6IDEwMA0KICAgICAgICB9LA0KICAgICAgICAiY2FzZV9zZW5zaXRpdmUiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQ2FzZSBTZW5zaXRpdmUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0cnVlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAic3RyaW5nX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJ0ZXh0Ijogew0KICAgICAgImlkIjogInRleHQiLA0KICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiT3V0cHV0IHN0YXRpYyB0ZXh0IGNvbnRlbnQiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWZvbnQiLA0KICAgICAgImNvbG9yIjogInNlY29uZGFyeSIsDQogICAgICAiY2F0ZWdvcnkiOiAiZGF0YSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ1cHBlcmNhc2UiLA0KICAgICAgICAgICJuYW1lIjogIlVwcGVyY2FzZSIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJsb3dlcmNhc2UiLA0KICAgICAgICAgICJuYW1lIjogIkxvd2VyY2FzZSIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ3b3JkX2NvdW50IiwNCiAgICAgICAgICAibmFtZSI6ICJXb3JkIENvdW50IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAibGVuZ3RoIiwNCiAgICAgICAgICAibmFtZSI6ICJMZW5ndGgiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJ0ZXh0X2NvbnRlbnQiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dGFyZWEiLA0KICAgICAgICAgICJsYWJlbCI6ICJUZXh0IENvbnRlbnQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJIZWxsbywgV29ybGQhIg0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInRleHRfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInRpbWVyIjogew0KICAgICAgImlkIjogInRpbWVyIiwNCiAgICAgICJuYW1lIjogIlRpbWVyIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEZWxheSBleGVjdXRpb24gZm9yIHNwZWNpZmllZCBtaWxsaXNlY29uZHMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWNsb2NrIiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJ0cmlnZ2VyIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRpbWVzdGFtcCIsDQogICAgICAgICAgIm5hbWUiOiAiVGltZXN0YW1wIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZWxhcHNlZCIsDQogICAgICAgICAgIm5hbWUiOiAiRWxhcHNlZCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImludGVydmFsIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkludGVydmFsIChtcykiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEwMDAsDQogICAgICAgICAgIm1pbiI6IDEwMCwNCiAgICAgICAgICAibWF4IjogNjAwMDAsDQogICAgICAgICAgInN0ZXAiOiAxMDANCiAgICAgICAgfSwNCiAgICAgICAgImNvdW50Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkNvdW50IiwNCiAgICAgICAgICAidmFsdWUiOiAxLA0KICAgICAgICAgICJtaW4iOiAxLA0KICAgICAgICAgICJtYXgiOiAxMDAsDQogICAgICAgICAgInN0ZXAiOiAxDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAidGltZXJfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInZmc19kaXJlY3RvcnlfbGlzdCI6IHsNCiAgICAgICJpZCI6ICJ2ZnNfZGlyZWN0b3J5X2xpc3QiLA0KICAgICAgIm5hbWUiOiAiVkZTIERpcmVjdG9yeSBMaXN0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJMaXN0IGFsbCBmaWxlcyBhbmQgZGlyZWN0b3JpZXMgaW4gYSBWRlMgcGF0aCIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtZm9sZGVyLXRyZWUiLA0KICAgICAgImNvbG9yIjogInByaW1hcnkiLA0KICAgICAgImNhdGVnb3J5IjogInN0b3JhZ2UiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRpcmVjdG9yeV9wYXRoIiwNCiAgICAgICAgICAibmFtZSI6ICJEaXJlY3RvcnkgUGF0aCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpbGVfbGlzdCIsDQogICAgICAgICAgIm5hbWUiOiAiRmlsZSBMaXN0IiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpbGVfcGF0aHMiLA0KICAgICAgICAgICJuYW1lIjogIkZpbGUgUGF0aHMiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZmlsZV9uYW1lcyIsDQogICAgICAgICAgIm5hbWUiOiAiRmlsZSBOYW1lcyIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjb3VudCIsDQogICAgICAgICAgIm5hbWUiOiAiRmlsZSBDb3VudCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRpcmVjdG9yaWVzIiwNCiAgICAgICAgICAibmFtZSI6ICJEaXJlY3RvcmllcyIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJmaWxlc19vbmx5IiwNCiAgICAgICAgICAibmFtZSI6ICJGaWxlcyBPbmx5IiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImRpcmVjdG9yeV9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJEaXJlY3RvcnkgUGF0aCIsDQogICAgICAgICAgInZhbHVlIjogIi8iLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICIvYWJzb2x1dGUvcGF0aC9pbi92ZnMiDQogICAgICAgIH0sDQogICAgICAgICJmaWx0ZXJfZXh0ZW5zaW9ucyI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRmlsZSBFeHRlbnNpb25zIEZpbHRlciIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogInR4dCxqc29uLG1kIChsZWF2ZSBlbXB0eSBmb3IgYWxsKSINCiAgICAgICAgfSwNCiAgICAgICAgImluY2x1ZGVfZGlyZWN0b3JpZXMiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiSW5jbHVkZSBEaXJlY3RvcmllcyIsDQogICAgICAgICAgInZhbHVlIjogInRydWUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgInJlY3Vyc2l2ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJSZWN1cnNpdmUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJmYWxzZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInZmc19kaXJlY3RvcnlfbGlzdF9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAidmZzX2xvYWQiOiB7DQogICAgICAiaWQiOiAidmZzX2xvYWQiLA0KICAgICAgIm5hbWUiOiAiVkZTIExvYWQiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkxvYWQgZGF0YSBmcm9tIHRoZSBWaXJ0dWFsIEZpbGUgU3lzdGVtIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1mb2xkZXItb3BlbiIsDQogICAgICAiY29sb3IiOiAicHJpbWFyeSIsDQogICAgICAiY2F0ZWdvcnkiOiAic3RvcmFnZSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpbGVfcGF0aCIsDQogICAgICAgICAgIm5hbWUiOiAiRmlsZSBQYXRoIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImZpbGVfcGF0aCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRmlsZSBQYXRoIiwNCiAgICAgICAgICAidmFsdWUiOiAiL215X2RhdGEuanNvbiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIi9hYnNvbHV0ZS9wYXRoL2luL3ZmcyINCiAgICAgICAgfSwNCiAgICAgICAgImZvcm1hdCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJGb3JtYXQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJqc29uIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJqc29uIiwNCiAgICAgICAgICAgICJ0ZXh0IiwNCiAgICAgICAgICAgICJiaW5hcnkiLA0KICAgICAgICAgICAgImJsb2IiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiYXV0b19yZWxvYWQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQXV0byBSZWxvYWQgb24gQ2hhbmdlIiwNCiAgICAgICAgICAidmFsdWUiOiAiZmFsc2UiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJ2ZnNfbG9hZF9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAidmZzX3NhdmUiOiB7DQogICAgICAiaWQiOiAidmZzX3NhdmUiLA0KICAgICAgIm5hbWUiOiAiVkZTIFNhdmUiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIlNhdmUgZGF0YSB0byB0aGUgVmlydHVhbCBGaWxlIFN5c3RlbSIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtc2F2ZSIsDQogICAgICAiY29sb3IiOiAicHJpbWFyeSIsDQogICAgICAiY2F0ZWdvcnkiOiAic3RvcmFnZSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJzdWNjZXNzIiwNCiAgICAgICAgICAibmFtZSI6ICJTdWNjZXNzIiwNCiAgICAgICAgICAidHlwZSI6ICJib29sZWFuIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImZpbGVfcGF0aCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRmlsZSBQYXRoIiwNCiAgICAgICAgICAidmFsdWUiOiAiL215X2RhdGEuanNvbiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIi9hYnNvbHV0ZS9wYXRoL2luL3ZmcyINCiAgICAgICAgfSwNCiAgICAgICAgImZvcm1hdCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJGb3JtYXQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJqc29uIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJqc29uIiwNCiAgICAgICAgICAgICJ0ZXh0IiwNCiAgICAgICAgICAgICJiaW5hcnkiLA0KICAgICAgICAgICAgImJsb2IiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAib3ZlcndyaXRlIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk92ZXJ3cml0ZSIsDQogICAgICAgICAgInZhbHVlIjogInRydWUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgImFwcGVuZCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJBcHBlbmQgTW9kZSIsDQogICAgICAgICAgInZhbHVlIjogImZhbHNlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAidmZzX3NhdmVfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0NCiAgfQ0KfQ==",
      "size": 38497
    }
  ]
}