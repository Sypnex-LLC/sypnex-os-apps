{
  "app_metadata": {
    "id": "flow_editor",
    "name": "Flow Editor",
    "description": "Visual node-based workflow editor for creating and executing data processing pipelines",
    "icon": "fas fa-project-diagram",
    "keywords": [
      "flow",
      "workflow",
      "nodes",
      "pipeline",
      "visual",
      "editor"
    ],
    "author": "Sypnex OS",
    "version": "1.1.6",
    "type": "user_app",
    "scripts": [
      "js/utils.js",
      "js/node-registry.js",
      "js/canvas.js",
      "js/node-config.js",
      "js/node-renderer.js",
      "js/data-executors.js",
      "js/http-executors.js",
      "js/media-executors.js",
      "js/flow-executors.js",
      "js/ai-executors.js",
      "js/execution-engine.js",
      "js/workflow.js",
      "js/canvas-manager.js",
      "js/tag-manager.js",
      "js/file-manager.js",
      "js/ui-manager.js",
      "js/main.js"
    ],
    "styles": [
      "css/layout.css",
      "css/nodes.css",
      "css/components.css",
      "css/node-types.css",
      "css/responsive.css",
      "css/os-theme.css"
    ],
    "additional_files": [
      {
        "vfs_path": "/nodes/nodes-pack.json",
        "source_file": "node-definitions/nodes-pack.json"
      }
    ],
    "settings": [
      {
        "key": "DEFAULT_HTTP_TIMEOUT",
        "name": "HTTP Timeout (ms)",
        "type": "number",
        "value": 30000,
        "description": "Default timeout for HTTP requests in milliseconds"
      },
      {
        "key": "AUTO_SAVE_INTERVAL",
        "name": "Auto Save Interval (s)",
        "type": "number",
        "value": 30,
        "description": "Auto save workflows every N seconds (0 = disabled)"
      },
      {
        "key": "MAX_NODES",
        "name": "Maximum Nodes",
        "type": "number",
        "value": 50,
        "description": "Maximum number of nodes allowed in a workflow"
      }
    ]
  },
  "files": {
    "flow_editor.app": "ew0KICAiaWQiOiAiZmxvd19lZGl0b3IiLA0KICAibmFtZSI6ICJGbG93IEVkaXRvciIsDQogICJkZXNjcmlwdGlvbiI6ICJWaXN1YWwgbm9kZS1iYXNlZCB3b3JrZmxvdyBlZGl0b3IgZm9yIGNyZWF0aW5nIGFuZCBleGVjdXRpbmcgZGF0YSBwcm9jZXNzaW5nIHBpcGVsaW5lcyIsDQogICJpY29uIjogImZhcyBmYS1wcm9qZWN0LWRpYWdyYW0iLA0KICAia2V5d29yZHMiOiBbImZsb3ciLCAid29ya2Zsb3ciLCAibm9kZXMiLCAicGlwZWxpbmUiLCAidmlzdWFsIiwgImVkaXRvciJdLA0KICAiYXV0aG9yIjogIlN5cG5leCBPUyIsDQogICJ2ZXJzaW9uIjogIjEuMS42IiwNCiAgInR5cGUiOiAidXNlcl9hcHAiLA0KICAic2NyaXB0cyI6IFsNCiAgICAianMvdXRpbHMuanMiLA0KICAgICJqcy9ub2RlLXJlZ2lzdHJ5LmpzIiwNCiAgICAianMvY2FudmFzLmpzIiwNCiAgICAianMvbm9kZS1jb25maWcuanMiLA0KICAgICJqcy9ub2RlLXJlbmRlcmVyLmpzIiwNCiAgICAianMvZGF0YS1leGVjdXRvcnMuanMiLA0KICAgICJqcy9odHRwLWV4ZWN1dG9ycy5qcyIsDQogICAgImpzL21lZGlhLWV4ZWN1dG9ycy5qcyIsDQogICAgImpzL2Zsb3ctZXhlY3V0b3JzLmpzIiwNCiAgICAianMvYWktZXhlY3V0b3JzLmpzIiwNCiAgICAianMvZXhlY3V0aW9uLWVuZ2luZS5qcyIsDQogICAgImpzL3dvcmtmbG93LmpzIiwNCiAgICAianMvY2FudmFzLW1hbmFnZXIuanMiLA0KICAgICJqcy90YWctbWFuYWdlci5qcyIsDQogICAgImpzL2ZpbGUtbWFuYWdlci5qcyIsDQogICAgImpzL3VpLW1hbmFnZXIuanMiLA0KICAgICJqcy9tYWluLmpzIg0KICBdLA0KICAic3R5bGVzIjogWw0KICAgICJjc3MvbGF5b3V0LmNzcyIsDQogICAgImNzcy9ub2Rlcy5jc3MiLA0KICAgICJjc3MvY29tcG9uZW50cy5jc3MiLA0KICAgICJjc3Mvbm9kZS10eXBlcy5jc3MiLA0KICAgICJjc3MvcmVzcG9uc2l2ZS5jc3MiLA0KICAgICJjc3Mvb3MtdGhlbWUuY3NzIg0KICBdLA0KICAiYWRkaXRpb25hbF9maWxlcyI6IFsNCiAgICB7DQogICAgICAidmZzX3BhdGgiOiAiL25vZGVzL25vZGVzLXBhY2suanNvbiIsDQogICAgICAic291cmNlX2ZpbGUiOiAibm9kZS1kZWZpbml0aW9ucy9ub2Rlcy1wYWNrLmpzb24iDQogICAgfQ0KICBdLA0KICAic2V0dGluZ3MiOiBbDQogICAgew0KICAgICAgImtleSI6ICJERUZBVUxUX0hUVFBfVElNRU9VVCIsDQogICAgICAibmFtZSI6ICJIVFRQIFRpbWVvdXQgKG1zKSIsDQogICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgInZhbHVlIjogMzAwMDAsDQogICAgICAiZGVzY3JpcHRpb24iOiAiRGVmYXVsdCB0aW1lb3V0IGZvciBIVFRQIHJlcXVlc3RzIGluIG1pbGxpc2Vjb25kcyINCiAgICB9LA0KICAgIHsNCiAgICAgICJrZXkiOiAiQVVUT19TQVZFX0lOVEVSVkFMIiwNCiAgICAgICJuYW1lIjogIkF1dG8gU2F2ZSBJbnRlcnZhbCAocykiLA0KICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICJ2YWx1ZSI6IDMwLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkF1dG8gc2F2ZSB3b3JrZmxvd3MgZXZlcnkgTiBzZWNvbmRzICgwID0gZGlzYWJsZWQpIg0KICAgIH0sDQogICAgew0KICAgICAgImtleSI6ICJNQVhfTk9ERVMiLA0KICAgICAgIm5hbWUiOiAiTWF4aW11bSBOb2RlcyIsDQogICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgInZhbHVlIjogNTAsDQogICAgICAiZGVzY3JpcHRpb24iOiAiTWF4aW11bSBudW1iZXIgb2Ygbm9kZXMgYWxsb3dlZCBpbiBhIHdvcmtmbG93Ig0KICAgIH0NCiAgXQ0KfQ==",
    "flow_editor.html": "PHN0eWxlIHR5cGU9InRleHQvY3NzIj4vKiA9PT09PSBTdHlsZTogY3NzL2xheW91dC5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIExheW91dCAmIFN0cnVjdHVyZSAqLw0KLyogRW5zdXJlIGFwcC1jb250YWluZXIgdXNlcyBmdWxsIGhlaWdodCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmFwcC1jb250YWluZXIgew0KICAgIGhlaWdodDogMTAwdmg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIG92ZXJmbG93OiBoaWRkZW4NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXBwLWNvbnRlbnQgew0KICAgIGZsZXg6IDE7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgZ2FwOiAxMHB4Ow0KICAgIHBhZGRpbmc6IDEwcHg7DQogICAgbWluLWhlaWdodDogMA0KICAgIH0NCi8qIEZsb3cgRWRpdG9yIExheW91dCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctZWRpdG9yIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXg6IDE7DQogICAgZ2FwOiAwOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgbWluLWhlaWdodDogMA0KICAgIH0NCi8qIExlZnQgVG9vbGJveCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJveCB7DQogICAgd2lkdGg6IDI1MHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1yaWdodDogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGZsZXgtc2hyaW5rOiAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtaGVhZGVyIHsNCiAgICBwYWRkaW5nOiAxNXB4Ow0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1oZWFkZXIgaDQgew0KICAgIG1hcmdpbjogMDsNCiAgICBmb250LXNpemU6IDE2cHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gI3RvZ2dsZS10b29sYm94IHsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdICN0b2dnbGUtdG9vbGJveDpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCi8qIENvbGxhcHNlZCBzdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJveC5jb2xsYXBzZWQgew0KICAgIHdpZHRoOiA1MHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJveC5jb2xsYXBzZWQgLnRvb2xib3gtY29udGVudCB7DQogICAgZGlzcGxheTogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xib3guY29sbGFwc2VkIC50b29sYm94LWhlYWRlciBoNCB7DQogICAgZGlzcGxheTogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LWNvbnRlbnQgew0KICAgIGZsZXg6IDE7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBwYWRkaW5nOiAxMHB4DQogICAgfQ0KLyogTWFpbiBXb3Jrc3BhY2UgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXdvcmtzcGFjZSB7DQogICAgZmxleDogMTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgbWluLXdpZHRoOiAwDQogICAgfQ0KLyogVG9vbGJhciAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAxMnB4IDIwcHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgZmxleC1zaHJpbms6IDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJhci1sZWZ0IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGdhcDogMTBweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmN1cnJlbnQtZmlsZS1pbmZvIHsNCiAgICBtYXJnaW4tbGVmdDogMTVweDsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY3VycmVudC1maWxlbmFtZSB7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJhci1yaWdodCB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDhweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZQ0KICAgIH0NCi8qIFpvb20gQ29udHJvbHMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWNvbnRyb2xzIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA0cHg7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWxldmVsIHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgbWluLXdpZHRoOiA0MHB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICB1c2VyLXNlbGVjdDogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWNvbnRyb2xzIGJ1dHRvbiB7DQogICAgcGFkZGluZzogNHB4IDZweDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnpvb20tY29udHJvbHMgYnV0dG9uOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ib3JkZXItY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnpvb20tY29udHJvbHMgYnV0dG9uOmFjdGl2ZSB7DQogICAgdHJhbnNmb3JtOiBzY2FsZSgwLjk1KQ0KICAgIH0NCi8qIENhbnZhcyBDb250YWluZXIgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNhbnZhcy1jb250YWluZXIgew0KICAgIGZsZXg6IDE7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIG92ZXJmbG93OiBoaWRkZW4NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jYW52YXMgew0KICAgIHdpZHRoOiAxMDAwMHB4Ow0KICAgIGhlaWdodDogMTAwMDBweDsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCAyMHB4IDIwcHgsIHZhcigtLWJvcmRlci1jb2xvcikgMXB4LCB0cmFuc3BhcmVudCAxcHgpLCByYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDQwcHggNDBweCwgdmFyKC0tYm9yZGVyLWNvbG9yKSAxcHgsIHRyYW5zcGFyZW50IDFweCk7DQogICAgYmFja2dyb3VuZC1zaXplOiA0MHB4IDQwcHg7DQogICAgY3Vyc29yOiBncmFiOw0KICAgIHRyYW5zZm9ybS1vcmlnaW46IDAgMDsNCiAgICB3aWxsLWNoYW5nZTogdHJhbnNmb3JtDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY2FudmFzOmFjdGl2ZSB7DQogICAgY3Vyc29yOiBncmFiYmluZw0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNhbnZhcy5wYW5uaW5nIHsNCiAgICBjdXJzb3I6IGdyYWJiaW5nDQogICAgfQ0KLyogQ29uZmlndXJhdGlvbiBQYW5lbCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLXBhbmVsIHsNCiAgICB3aWR0aDogMzAwcHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBmbGV4LXNocmluazogMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctaGVhZGVyIHsNCiAgICBwYWRkaW5nOiAxNXB4Ow0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWhlYWRlciBoNCB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdG9nZ2xlLWNvbmZpZyB7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdG9nZ2xlLWNvbmZpZzpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCi8qIENvbGxhcHNlZCBzdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLXBhbmVsLmNvbGxhcHNlZCB7DQogICAgd2lkdGg6IDUwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25maWctcGFuZWwuY29sbGFwc2VkIC5jb25maWctY29udGVudCB7DQogICAgZGlzcGxheTogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbmZpZy1wYW5lbC5jb2xsYXBzZWQgLmNvbmZpZy1oZWFkZXIgaDQgew0KICAgIGRpc3BsYXk6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWNvbnRlbnQgew0KICAgIGZsZXg6IDE7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBwYWRkaW5nOiAxNXB4DQogICAgfQ0KLyogT3V0cHV0IFBhbmVsICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1vdXRwdXQtcGFuZWwgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgZmxleC1zaHJpbms6IDA7DQogICAgbWF4LWhlaWdodDogMzAwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAxMnB4IDE1cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LWhlYWRlciBoNCB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LWNvbnRlbnQgew0KICAgIHBhZGRpbmc6IDE1cHg7DQogICAgbWF4LWhlaWdodDogMjUwcHg7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBvdmVyZmxvdy14OiBoaWRkZW4NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1vdXRwdXQtcGFuZWwuY29sbGFwc2VkIC5vdXRwdXQtY29udGVudCB7DQogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctb3V0cHV0LXBhbmVsIC5vdXRwdXQtaGVhZGVyIHsNCiAgICBjdXJzb3I6IHBvaW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1vdXRwdXQtcGFuZWwgLm91dHB1dC1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDhweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyDQogICAgfQ0KLyogPT09PT0gU3R5bGU6IGNzcy9ub2Rlcy5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIE5vZGVzICYgQ29ubmVjdGlvbnMgKi8NCi8qIE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgbWluLXdpZHRoOiAxNTBweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIGN1cnNvcjogZ3JhYjsNCiAgICB1c2VyLXNlbGVjdDogbm9uZTsNCiAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjEpOw0KICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4ycyBlYXNlLCB0cmFuc2Zvcm0gMC4xcyBlYXNlOw0KICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm0NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlOmFjdGl2ZSB7DQogICAgY3Vyc29yOiBncmFiYmluZzsNCiAgICB0cmFuc2l0aW9uOiBub25lDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZTpob3ZlciB7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRleSgtMXB4KQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUuc2VsZWN0ZWQgew0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeS1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIG1hcmdpbi1ib3R0b206IDhweDsNCiAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgcG9zaXRpb246IHJlbGF0aXZlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm5vZGUtZGVsZXRlLWJ0biB7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHJpZ2h0OiAtNXB4Ow0KICAgIHRvcDogLTVweDsNCiAgICB3aWR0aDogMjBweDsNCiAgICBoZWlnaHQ6IDIwcHg7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgZm9udC1zaXplOiAxMHB4Ow0KICAgIG9wYWNpdHk6IDA7DQogICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjJzIGVhc2U7DQogICAgei1pbmRleDogMTANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlOmhvdmVyIC5ub2RlLWRlbGV0ZS1idG4gew0KICAgIG9wYWNpdHk6IDENCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubm9kZS1kZWxldGUtYnRuOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiAjZDMyZjJmOw0KICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtdHlwZSB7DQogICAgcGFkZGluZzogMnB4IDZweDsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7DQogICAgYmFja2dyb3VuZDogIzZjNzU3ZDsNCiAgICBjb2xvcjogd2hpdGUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLWNvbnRlbnQgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLXBvcnRzIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgd2lkdGg6IDEwMCU7DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIHBvaW50ZXItZXZlbnRzOiBub25lDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1wb3J0IHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgd2lkdGg6IDEycHg7DQogICAgaGVpZ2h0OiAxMnB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBwb2ludGVyLWV2ZW50czogYWxsOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLXBvcnQ6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjIpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1wb3J0LmlucHV0IHsNCiAgICBsZWZ0OiAtNnB4Ow0KICAgIHRvcDogNTAlOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRleSgtNTAlKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtcG9ydC5vdXRwdXQgew0KICAgIHJpZ2h0OiAtNnB4Ow0KICAgIHRvcDogNTAlOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRleSgtNTAlKQ0KICAgIH0NCi8qIENvbm5lY3Rpb24gTGluZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbm5lY3Rpb24gew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICBwb2ludGVyLWV2ZW50czogbm9uZTsNCiAgICB6LWluZGV4OiAxDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29ubmVjdGlvbi1saW5lIHsNCiAgICBzdHJva2U6IHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgc3Ryb2tlLXdpZHRoOiA4Ow0KICAgIGZpbGw6IG5vbmU7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICBvcGFjaXR5OiAwLjY7DQogICAgLyogU2xpZ2h0bHkgdHJhbnNwYXJlbnQgYnkgZGVmYXVsdCAqLw0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbm5lY3Rpb24tbGluZTpob3ZlciB7DQogICAgc3Ryb2tlOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBvcGFjaXR5OiAxOw0KICAgIHN0cm9rZS13aWR0aDogMTANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25uZWN0aW9uLWxpbmUuY29ubmVjdGVkIHsNCiAgICBzdHJva2U6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIG9wYWNpdHk6IDAuOA0KICAgIH0NCi8qIFJ1bm5pbmcgU3RhdGUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUucnVubmluZyB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsNCiAgICBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlDQogICAgfQ0KLyogV2FpdGluZyBmb3IgSW5wdXRzIFN0YXRlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLndhaXRpbmctaW5wdXRzIHsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXdhcm5pbmctY29sb3IpOw0KICAgIGFuaW1hdGlvbjogd2FpdGluZy1wdWxzZSAycyBpbmZpbml0ZQ0KICAgIH0NCi8qIENvbXBsZXRlZCBTdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5jb21wbGV0ZWQgew0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tc3VjY2Vzcy1jb2xvcikNCiAgICB9DQovKiBFcnJvciBTdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5lcnJvciB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQpAa2V5ZnJhbWVzIHB1bHNlIHsNCiAgICAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS1zdWNjZXNzLWNvbG9yLXJnYiksIDAuNCk7DQogICAgICAgIH0gNzAlIHsNCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDAgMTBweCByZ2JhKHZhcigtLXN1Y2Nlc3MtY29sb3ItcmdiKSwgMCk7DQogICAgICAgIH0gMTAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS1zdWNjZXNzLWNvbG9yLXJnYiksIDApOw0KICAgICAgICB9DQogICAgfQ0KQGtleWZyYW1lcyB3YWl0aW5nLXB1bHNlIHsNCiAgICAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS13YXJuaW5nLWNvbG9yLXJnYiksIDAuNCk7DQogICAgICAgIH0gNzAlIHsNCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDAgMTBweCByZ2JhKHZhcigtLXdhcm5pbmctY29sb3ItcmdiKSwgMCk7DQogICAgICAgIH0gMTAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS13YXJuaW5nLWNvbG9yLXJnYiksIDApOw0KICAgICAgICB9DQogICAgfQ0KLyogPT09PT0gU3R5bGU6IGNzcy9jb21wb25lbnRzLmNzcyA9PT09PSAqLw0KLyogRmxvdyBFZGl0b3IgVUkgQ29tcG9uZW50cyAqLw0KLyogTm9kZSBDYXRlZ29yeSBUb29sYm94ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubm9kZS1jYXRlZ29yeSB7DQogICAgbWFyZ2luLWJvdHRvbTogMjBweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5ub2RlLWNhdGVnb3J5IGg1IHsNCiAgICBtYXJnaW46IDAgMCAxMHB4IDA7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7DQogICAgbGV0dGVyLXNwYWNpbmc6IDAuNXB4Ow0KICAgIHBhZGRpbmc6IDAgNXB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtbm9kZS1idG4gew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDEwcHg7DQogICAgcGFkZGluZzogMTJweCAxNXB4Ow0KICAgIG1hcmdpbi1ib3R0b206IDVweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBjdXJzb3I6IGdyYWI7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICB0ZXh0LWFsaWduOiBsZWZ0Ow0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1ub2RlLWJ0bjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KC0xcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1ub2RlLWJ0bjphY3RpdmUgew0KICAgIGN1cnNvcjogZ3JhYmJpbmc7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KDApDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtbm9kZS1idG4gaSB7DQogICAgZm9udC1zaXplOiAxNnB4Ow0KICAgIHdpZHRoOiAyMHB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LW5vZGUtYnRuIHNwYW4gew0KICAgIGZsZXg6IDE7DQogICAgZm9udC13ZWlnaHQ6IDUwMA0KICAgIH0NCi8qIEJ1dHRvbnMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0biB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogNnB4Ow0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQogICAgdGV4dC1kZWNvcmF0aW9uOiBub25lDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTFweCk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwgMCwgMCwgMC4xKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0bi1vdXRsaW5lLWRhbmdlciB7DQogICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4tb3V0bGluZS1kYW5nZXI6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4tb3V0bGluZS1zZWNvbmRhcnkgew0KICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuLW91dGxpbmUtc2Vjb25kYXJ5OmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKQ0KICAgIH0NCi8qIENvbmZpZ3VyYXRpb24gU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWdyb3VwIHsNCiAgICBtYXJnaW4tYm90dG9tOiAxNXB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1ncm91cCBsYWJlbCB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgbWFyZ2luLWJvdHRvbTogNXB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgaW5wdXQgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgdHJhbnNpdGlvbjogYm9yZGVyLWNvbG9yIDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgc2VsZWN0IHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOw0KICAgIGN1cnNvcjogcG9pbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgaW5wdXQ6Zm9jdXMgew0KICAgIG91dGxpbmU6IG5vbmU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgc2VsZWN0OmZvY3VzIHsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDIxMiwgMjU1LCAwLjA1KQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgc2VsZWN0IG9wdGlvbiB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1ncm91cCBzZWxlY3Qgb3B0aW9uOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZykNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWdyb3VwIHRleHRhcmVhIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHJlc2l6ZTogdmVydGljYWw7DQogICAgbWluLWhlaWdodDogODBweDsNCiAgICBmb250LWZhbWlseTogbW9ub3NwYWNlDQogICAgfQ0KLyogVGFnIFBhbmVsICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdGFnLXBhbmVsIHsNCiAgICBtYXJnaW4tdG9wOiAyMHB4Ow0KICAgIHBhZGRpbmctdG9wOiAyMHB4Ow0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gI3RhZy1wYW5lbCBoNSB7DQogICAgbWFyZ2luOiAwIDAgMTVweCAwOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDEwcHg7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQogICAgbWFyZ2luLWJvdHRvbTogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctY29sb3Igew0KICAgIHdpZHRoOiAxMnB4Ow0KICAgIGhlaWdodDogMTJweDsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgZmxleC1zaHJpbms6IDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWluZm8gew0KICAgIGZsZXg6IDE7DQogICAgbWluLXdpZHRoOiAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1uYW1lIHsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIGZvbnQtc2l6ZTogMTNweDsNCiAgICBtYXJnaW4tYm90dG9tOiAycHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWRlc2NyaXB0aW9uIHsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgb3BhY2l0eTogMC43DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1kZWxldGUgew0KICAgIGJhY2tncm91bmQ6IG5vbmU7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGNvbG9yOiBpbmhlcml0Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBwYWRkaW5nOiA0cHg7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG9wYWNpdHk6IDAuNjsNCiAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctZGVsZXRlOmhvdmVyIHsNCiAgICBvcGFjaXR5OiAxOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKQ0KICAgIH0NCi8qIE91dHB1dCBTdHlsZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leGVjdXRpb24tb3V0cHV0IHsNCiAgICBmb250LWZhbWlseTogbW9ub3NwYWNlOw0KICAgIGZvbnQtc2l6ZTogMTNweDsNCiAgICBsaW5lLWhlaWdodDogMS40Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leGVjdXRpb24tb3V0cHV0IC5sb2ctZW50cnkgew0KICAgIG1hcmdpbi1ib3R0b206IDVweDsNCiAgICBwYWRkaW5nOiA0cHggMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leGVjdXRpb24tb3V0cHV0IC5sb2ctZW50cnkuaW5mbyB7DQogICAgY29sb3I6IHZhcigtLWluZm8tY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmV4ZWN1dGlvbi1vdXRwdXQgLmxvZy1lbnRyeS5zdWNjZXNzIHsNCiAgICBjb2xvcjogdmFyKC0tc3VjY2Vzcy1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZXhlY3V0aW9uLW91dHB1dCAubG9nLWVudHJ5LmVycm9yIHsNCiAgICBjb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmV4ZWN1dGlvbi1vdXRwdXQgLmxvZy1lbnRyeS53YXJuaW5nIHsNCiAgICBjb2xvcjogdmFyKC0td2FybmluZy1jb2xvcikNCiAgICB9DQovKiBJbnB1dC9PdXRwdXQgTWFwcGluZ3MgQ29uZmlndXJhdGlvbiBTdHlsZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5ncy1jb25maWcsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5vdXRwdXQtbWFwcGluZ3MtY29uZmlnIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgbWFyZ2luLXRvcDogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmctY29uZmlnLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmctY29uZmlnIHsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICBib3JkZXItbGVmdDogM3B4IHNvbGlkIHZhcigtLXByaW1hcnktY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmctY29uZmlnOmxhc3QtY2hpbGQsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5vdXRwdXQtbWFwcGluZy1jb25maWc6bGFzdC1jaGlsZCB7DQogICAgbWFyZ2luLWJvdHRvbTogMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5nLWNvbmZpZyBsYWJlbCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm91dHB1dC1tYXBwaW5nLWNvbmZpZyBsYWJlbCB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIG1hcmdpbi1ib3R0b206IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5nLXNlbGVjdCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm91dHB1dC1tYXBwaW5nLXNlbGVjdCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LXRhcmdldC1zZWxlY3Qgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQogICAgY3Vyc29yOiBwb2ludGVyDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmctc2VsZWN0OmZvY3VzLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmctc2VsZWN0OmZvY3VzLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtdGFyZ2V0LXNlbGVjdDpmb2N1cyB7DQogICAgb3V0bGluZTogbm9uZTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAyMTIsIDI1NSwgMC4wNSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZy1zZWxlY3Qgb3B0aW9uLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmctc2VsZWN0IG9wdGlvbiwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LXRhcmdldC1zZWxlY3Qgb3B0aW9uIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWJnKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgcGFkZGluZzogOHB4IDEycHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZy1zZWxlY3Qgb3B0aW9uOmhvdmVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmctc2VsZWN0IG9wdGlvbjpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LXRhcmdldC1zZWxlY3Qgb3B0aW9uOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZykNCiAgICB9DQovKiBMZWdhY3kgc3R5bGVzIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZ3Mgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBtYXJnaW4tdG9wOiA0cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZyB7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBtYXJnaW4tYm90dG9tOiA0cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgbGluZS1oZWlnaHQ6IDEuMg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5nOmxhc3QtY2hpbGQgew0KICAgIG1hcmdpbi1ib3R0b206IDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZyAuc291cmNlLW5vZGUgew0KICAgIGZvbnQtd2VpZ2h0OiA2MDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZyAuc291cmNlLXBvcnQgew0KICAgIG9wYWNpdHk6IDAuODsNCiAgICBmb250LXN0eWxlOiBpdGFsaWMNCiAgICB9DQovKiBDb2xsYXBzaWJsZSBDb25maWd1cmF0aW9uIFNlY3Rpb25zIC0gVXNpbmcgZXhpc3RpbmcgT1MgdGhlbWUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbiB7DQogICAgbWFyZ2luLWJvdHRvbTogMTVweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1zZWN0aW9uLWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIHBhZGRpbmc6IDEycHggMTVweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICB1c2VyLXNlbGVjdDogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbi1oZWFkZXI6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLXNlY3Rpb24taGVhZGVyLmNvbGxhcHNlZCB7DQogICAgYm9yZGVyLWJvdHRvbTogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbi1oZWFkZXIgaSB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1zZWN0aW9uLWhlYWRlciBzcGFuIHsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBmb250LXNpemU6IDE0cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWNvdW50IHsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7DQogICAgbWFyZ2luLWxlZnQ6IGF1dG8NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLXNlY3Rpb24tY29udGVudCB7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbi1oZWFkZXIuY29sbGFwc2VkICsgLmNvbmZpZy1zZWN0aW9uLWNvbnRlbnQgew0KICAgIGJvcmRlci10b3A6IG5vbmUNCiAgICB9DQovKiBBZGp1c3QgZXhpc3RpbmcgY29uZmlnIGdyb3VwcyB3aXRoaW4gc2VjdGlvbnMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbiAuY29uZmlnLWdyb3VwIHsNCiAgICBtYXJnaW4tYm90dG9tOiAxMnB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1zZWN0aW9uIC5jb25maWctZ3JvdXA6bGFzdC1jaGlsZCB7DQogICAgbWFyZ2luLWJvdHRvbTogMA0KICAgIH0NCi8qID09PT09IFN0eWxlOiBjc3Mvbm9kZS10eXBlcy5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIE5vZGUgVHlwZSBTcGVjaWZpYyBTdHlsZXMgKi8NCi8qIERpc3BsYXkgTm9kZSBDb250ZW50ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZGlzcGxheS1jb250ZW50IHsNCiAgICBwYWRkaW5nOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZGlzcGxheS10ZXh0IHsNCiAgICBtaW4taGVpZ2h0OiA0MHB4Ow0KICAgIG1heC1oZWlnaHQ6IDIwMHB4Ow0KICAgIHdpZHRoOiAyMjBweDsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgcmVzaXplOiBub25lOw0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3gNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZGlzcGxheS10ZXh0IHByZSB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7DQogICAgd2hpdGUtc3BhY2U6IHByZS13cmFwOw0KICAgIHdvcmQtYnJlYWs6IGJyZWFrLXdvcmQ7DQogICAgdXNlci1zZWxlY3Q6IHRleHQNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZGlzcGxheS1mb3JtYXQgew0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpDQogICAgfQ0KLyogQXVkaW8gUGxheWVyIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmF1ZGlvLWNvbnRyb2xzIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxMHB4Ow0KICAgIG1hcmdpbi10b3A6IDEwcHg7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmF1ZGlvLXBsYXktYnRuLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXVkaW8tc3RvcC1idG4gew0KICAgIHdpZHRoOiAzMnB4Ow0KICAgIGhlaWdodDogMzJweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXVkaW8tcGxheS1idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1Y2Nlc3MtY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hdWRpby1zdG9wLWJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hdWRpby1wbGF5LWJ0bjpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmF1ZGlvLXN0b3AtYnRuOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwgMCwgMCwgMC4yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hdWRpby1zdGF0dXMgew0KICAgIGZsZXg6IDE7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXINCiAgICB9DQovKiBKU09OIEV4dHJhY3QgRGlzcGxheSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmpzb24tZXh0cmFjdC1kaXNwbGF5IHsNCiAgICBtYXJnaW4tdG9wOiAxMHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuMDUpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leHRyYWN0LWxhYmVsIHsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIG1hcmdpbi1ib3R0b206IDRweDsNCiAgICBmb250LXdlaWdodDogNTAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmV4dHJhY3QtdmFsdWUgew0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiAzcHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leHRyYWN0LXZhbHVlLnN1Y2Nlc3Mgew0KICAgIGNvbG9yOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXN1Y2Nlc3MtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmV4dHJhY3QtdmFsdWUuZXJyb3Igew0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQovKiBSZXBlYXRlciBOb2RlIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLWNvbnRlbnQgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIHBhZGRpbmc6IDhweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5yZXBlYXRlci1zdGF0dXMgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBtaW4td2lkdGg6IDgwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAucmVwZWF0ZXItc3RhdHVzLnN0b3BwZWQgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4xKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAucmVwZWF0ZXItc3RhdHVzLnJ1bm5pbmcgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1Y2Nlc3MtY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLWNvbnRyb2xzIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGdhcDogOHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0YXJ0LWJ0biwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0b3AtYnRuIHsNCiAgICB3aWR0aDogMjhweDsNCiAgICBoZWlnaHQ6IDI4cHg7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0YXJ0LWJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VjY2Vzcy1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0b3AtYnRuIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0YXJ0LWJ0bjpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0b3AtYnRuOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwgMCwgMCwgMC4yKQ0KICAgIH0NCi8qIEltYWdlIE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtY29udGFpbmVyIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgbWluLWhlaWdodDogMTIwcHg7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtdGh1bWJuYWlsIHsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBvYmplY3QtZml0OiBjb250YWluOw0KICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtdGh1bWJuYWlsOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMDUpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtaW5mbyB7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMTFweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICB3aWR0aDogMTAwJQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbWFnZS1lcnJvciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA0cHg7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtZXJyb3IgaSB7DQogICAgZm9udC1zaXplOiAxNnB4DQogICAgfQ0KLyogSW1hZ2UgTW9kYWwgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwgew0KICAgIHBvc2l0aW9uOiBmaXhlZDsNCiAgICB0b3A6IDA7DQogICAgbGVmdDogMDsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjgpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICB6LWluZGV4OiAxMDAwOw0KICAgIHBhZGRpbmc6IDIwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtY29udGVudCB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIG1heC13aWR0aDogOTAlOw0KICAgIG1heC1oZWlnaHQ6IDkwJTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDIwcHggcmdiYSgwLCAwLCAwLCAwLjMpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLW1vZGFsLWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAxNXB4IDIwcHg7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtaGVhZGVyIHNwYW4gew0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLW1vZGFsLWNsb3NlIHsNCiAgICBiYWNrZ3JvdW5kOiBub25lOw0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBmb250LXNpemU6IDI0cHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBwYWRkaW5nOiAwOw0KICAgIHdpZHRoOiAzMHB4Ow0KICAgIGhlaWdodDogMzBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtY2xvc2U6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4xKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtYm9keSB7DQogICAgcGFkZGluZzogMjBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDE1cHg7DQogICAgbWF4LWhlaWdodDogY2FsYyg5MHZoIC0gMTAwcHgpOw0KICAgIG92ZXJmbG93LXk6IGF1dG8NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtaW1hZ2Ugew0KICAgIG1heC13aWR0aDogMTAwJTsNCiAgICBtYXgtaGVpZ2h0OiA3MHZoOw0KICAgIG9iamVjdC1maXQ6IGNvbnRhaW47DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtbW9kYWwtaW5mbyB7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIHBhZGRpbmc6IDEwcHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgd2lkdGg6IDEwMCUNCiAgICB9DQovKiBSYW5kb20gUXVvdGUgTm9kZSBTdHlsZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5xdW90ZS1jb250ZW50IHsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5xdW90ZS10ZXh0IHsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgbWluLWhlaWdodDogNDBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAucXVvdGUtZGlzcGxheSB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZm9udC1zaXplOiAxM3B4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjQ7DQogICAgbWF4LXdpZHRoOiAxMDAlOw0KICAgIHdvcmQtd3JhcDogYnJlYWstd29yZA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5xdW90ZS1pbmZvIHsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIHBhZGRpbmctdG9wOiA4cHgNCiAgICB9DQovKiBMTE0gQ2hhdCBOb2RlIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmxsbS1yZXNwb25zZSB7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjMsIDE2MiwgMTg0LCAwLjEpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBtYXJnaW46IDRweCAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlc3BvbnNlLXByZXZpZXcgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBsaW5lLWhlaWdodDogMS4zOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgbWFyZ2luLWJvdHRvbTogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnVzYWdlLWluZm8gew0KICAgIGZvbnQtc2l6ZTogMTBweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHJnYmEoMCwgMCwgMCwgMC4xKTsNCiAgICBwYWRkaW5nLXRvcDogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmxsbS1lcnJvciB7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjIwLCA1MywgNjksIDAuMSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG1hcmdpbjogNHB4IDA7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogNnB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmxsbS1lcnJvciBpIHsNCiAgICBmb250LXNpemU6IDE0cHgNCiAgICB9DQovKiBUZXh0IE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGV4dC1jb250ZW50IHsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgxMDgsIDExNywgMTI1LCAwLjEpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBtYXJnaW46IDRweCAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRleHQtcHJldmlldyB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjM7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsNCiAgICBtYXJnaW4tYm90dG9tOiA0cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGV4dC1pbmZvIHsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMSk7DQogICAgcGFkZGluZy10b3A6IDRweA0KICAgIH0NCi8qIE5vZGUgU3RhdHVzIERpc3BsYXkgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5ub2RlLXN0YXR1cyB7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG1hcmdpbjogNHB4IDA7DQogICAgdGV4dC1hbGlnbjogY2VudGVyDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnN0YXR1cy10ZXh0IHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgbWFyZ2luLWJvdHRvbTogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnN0YXR1cy1pbmZvIHsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpDQogICAgfQ0KLyogQ29udGVudCBEaXNwbGF5IGluIENvbmZpZyBQYW5lbCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbnRlbnQtZGlzcGxheSB7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgcGFkZGluZzogMTJweDsNCiAgICBtYXJnaW4tdG9wOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29udGVudC10ZXh0IHsNCiAgICBtYXJnaW46IDA7DQogICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgbGluZS1oZWlnaHQ6IDEuNDsNCiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7DQogICAgd29yZC1icmVhazogYnJlYWstd29yZDsNCiAgICBtYXgtaGVpZ2h0OiAzMDBweDsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogM3B4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICB1c2VyLXNlbGVjdDogdGV4dA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb250ZW50LWluZm8gew0KICAgIG1hcmdpbi10b3A6IDhweDsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgIH0NCi8qIFRlcm1pbmFsIE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGVybWluYWwtZXJyb3Igew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDIyMCwgNTMsIDY5LCAwLjEpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgbWFyZ2luLXRvcDogOHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRlcm1pbmFsLWVycm9yIGkgew0KICAgIG1hcmdpbi1yaWdodDogOHB4Ow0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikNCiAgICB9DQovKiA9PT09PSBTdHlsZTogY3NzL3Jlc3BvbnNpdmUuY3NzID09PT09ICovDQovKiBGbG93IEVkaXRvciBSZXNwb25zaXZlIERlc2lnbiAmIEVmZmVjdHMgKi8NCi8qIEhhbWJ1cmdlciBNZW51IFN0eWxlcyAtIEFsd2F5cyB2aXNpYmxlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaGFtYnVyZ2VyLWJ0biB7DQogICAgcGFkZGluZzogOHB4IDEycHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZHJvcGRvd24tbWVudSB7DQogICAgZGlzcGxheTogbm9uZTsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMik7DQogICAgei1pbmRleDogOTk5OTsNCiAgICBtaW4td2lkdGg6IDE4MHB4Ow0KICAgIHdpZHRoOiAxODBweDsNCiAgICBtYXgtaGVpZ2h0OiA3MHZoOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgcGFkZGluZzogMDsNCiAgICBtYXJnaW46IDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZHJvcGRvd24tbWVudS5zaG93IHsNCiAgICBkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm1lbnUtc2VjdGlvbiB7DQogICAgcGFkZGluZzogOHB4IDA7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1zZWN0aW9uOmxhc3QtY2hpbGQgew0KICAgIGJvcmRlci1ib3R0b206IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1zZWN0aW9uLXRpdGxlIHsNCiAgICBwYWRkaW5nOiA4cHggMTZweDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsNCiAgICBsZXR0ZXItc3BhY2luZzogMC41cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1pdGVtIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxMHB4Ow0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDEwcHggMTZweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAwLjJzIGVhc2U7DQogICAgdGV4dC1hbGlnbjogbGVmdA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5tZW51LWl0ZW06aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1pdGVtLmRhbmdlciB7DQogICAgY29sb3I6ICNmZjZiNmINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1pdGVtLmRhbmdlcjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDEwNywgMTA3LCAwLjEpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm1lbnUtem9vbS1jb250cm9scyB7DQogICAgcGFkZGluZzogMCAxNnB4Ow0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBnYXA6IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5tZW51LXpvb20tbGV2ZWwgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgcGFkZGluZzogNHB4IDA7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgbWFyZ2luOiA0cHggMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWJ0biB7DQogICAgcGFkZGluZzogNnB4IDEycHggIWltcG9ydGFudDsNCiAgICBmb250LXNpemU6IDEycHggIWltcG9ydGFudA0KICAgIH0NCi8qIFJlc3BvbnNpdmUgRGVzaWduICovDQpAbWVkaWEgKG1heC13aWR0aDogMTIwMHB4KSB7DQogICAgLmZsb3ctZWRpdG9yIHsNCiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgbWluLWhlaWdodDogMA0KICAgICAgICB9DQogICAgLmZsb3ctdG9vbGJveCB7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICBoZWlnaHQ6IGF1dG87DQogICAgICAgIGJvcmRlci1yaWdodDogbm9uZTsNCiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgICAgIGZsZXgtc2hyaW5rOiAwOw0KICAgICAgICBtYXgtaGVpZ2h0OiAyMDBweA0KICAgICAgICB9DQogICAgLnRvb2xib3gtY29udGVudCB7DQogICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgIGZsZXgtd3JhcDogd3JhcDsNCiAgICAgICAgZ2FwOiAxMHB4Ow0KICAgICAgICBwYWRkaW5nOiAxNXB4Ow0KICAgICAgICBvdmVyZmxvdy15OiBhdXRvDQogICAgICAgIH0NCiAgICAubm9kZS1jYXRlZ29yeSB7DQogICAgICAgIG1hcmdpbi1ib3R0b206IDA7DQogICAgICAgIGZsZXg6IDE7DQogICAgICAgIG1pbi13aWR0aDogMjAwcHgNCiAgICAgICAgfQ0KICAgIC5mbG93LXdvcmtzcGFjZSB7DQogICAgICAgIGZsZXg6IDE7DQogICAgICAgIG1pbi1oZWlnaHQ6IDANCiAgICAgICAgfQ0KICAgIC5mbG93LWNvbmZpZy1wYW5lbCB7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICBib3JkZXItbGVmdDogbm9uZTsNCiAgICAgICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgICAgIGZsZXgtc2hyaW5rOiAwOw0KICAgICAgICBtYXgtaGVpZ2h0OiAzMDBweA0KICAgICAgICB9DQogICAgLmZsb3ctb3V0cHV0LXBhbmVsIHsNCiAgICAgICAgbWF4LWhlaWdodDogMjAwcHgNCiAgICAgICAgfQ0KICAgIC5vdXRwdXQtY29udGVudCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4DQogICAgICAgIH0NCiAgICB9DQpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsNCiAgICAuYXBwLWNvbnRlbnQgew0KICAgICAgICBwYWRkaW5nOiA1cHg7DQogICAgICAgIGdhcDogNXB4DQogICAgICAgIH0NCiAgICAuZmxvdy10b29sYmFyIHsNCiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgZ2FwOiAxMHB4Ow0KICAgICAgICBwYWRkaW5nOiA4cHggMTVweA0KICAgICAgICB9DQogICAgLnRvb2xiYXItbGVmdCwgLnRvb2xiYXItcmlnaHQgew0KICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgIGZsZXgtd3JhcDogd3JhcA0KICAgICAgICB9DQogICAgLmZsb3ctdG9vbGJhciAuYnRuIHsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgICAgICBwYWRkaW5nOiA2cHggMTBweA0KICAgICAgICB9DQogICAgLmZsb3ctdG9vbGJveCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4DQogICAgICAgIH0NCiAgICAuZmxvdy1jb25maWctcGFuZWwgew0KICAgICAgICBtYXgtaGVpZ2h0OiAyNTBweA0KICAgICAgICB9DQogICAgLmZsb3ctb3V0cHV0LXBhbmVsIHsNCiAgICAgICAgbWF4LWhlaWdodDogMTUwcHgNCiAgICAgICAgfQ0KICAgIC5vdXRwdXQtY29udGVudCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDEwMHB4Ow0KICAgICAgICBwYWRkaW5nOiAxMHB4DQogICAgICAgIH0NCiAgICB9DQpAbWVkaWEgKG1heC13aWR0aDogNDgwcHgpIHsNCiAgICAudG9vbGJhci1sZWZ0LCAudG9vbGJhci1yaWdodCB7DQogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICAgIGdhcDogNXB4Ow0KICAgICAgICBhbGlnbi1pdGVtczogc3RyZXRjaA0KICAgICAgICB9DQogICAgLmZsb3ctdG9vbGJhciAuYnRuIHsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgICAgICB9DQogICAgLnpvb20tY29udHJvbHMgew0KICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcg0KICAgICAgICB9DQogICAgfQ0KLyogPT09PT0gU3R5bGU6IGNzcy9vcy10aGVtZS5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIC0gU3lwbmV4T1MgVGhlbWUgSW50ZWdyYXRpb24gKi8NCi8qIFRoaXMgZmlsZSBlbnN1cmVzIHRoZSBmbG93IGVkaXRvciBtYXRjaGVzIHRoZSBPUyBhZXN0aGV0aWMgcGVyZmVjdGx5ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSB7DQogICAgLyogT3ZlcnJpZGUgZmxvdyBlZGl0b3IgdmFyaWFibGVzIHdpdGggT1MgdmFyaWFibGVzICovDQogICAgLS1zdXJmYWNlLWNvbG9yOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgLS1ib3JkZXItY29sb3I6IHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgLS10ZXh0LWNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOw0KICAgIC0tdGV4dC1tdXRlZDogdmFyKC0tdGV4dC1zZWNvbmRhcnkpOw0KICAgIC0tcHJpbWFyeS1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICAtLXByaW1hcnktY29sb3ItcmdiOiAwLCAyMTIsIDI1NTsNCiAgICAtLWVycm9yLWNvbG9yOiAjZmY0NzU3Ow0KICAgIC0tc3VjY2Vzcy1jb2xvcjogIzJlZDU3MzsNCiAgICAtLXdhcm5pbmctY29sb3I6ICNmZmE1MDINCiAgICB9DQovKiBFbmhhbmNlZCBnbGFzcyBtb3JwaGlzbSBmb3IgZmxvdyBlZGl0b3IgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWVkaXRvciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm9yZGVyLXJhZGl1czogMTJweDsNCiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTBweCk7DQogICAgYm94LXNoYWRvdzogMCA4cHggMzJweCByZ2JhKDAsIDAsIDAsIDAuMykNCiAgICB9DQovKiBUb29sYm94IHdpdGggYmV0dGVyIGdsYXNzIGVmZmVjdCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJveCB7DQogICAgYmFja2dyb3VuZDogcmdiYSgyNiwgMjYsIDI2LCAwLjkpOw0KICAgIGJvcmRlci1yaWdodDogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDE1cHgpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtaGVhZGVyIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDEwLCAxMCwgMTAsIDAuOCk7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1oZWFkZXIgaDQgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIHRleHQtc2hhZG93OiAwIDAgMTBweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjMpDQogICAgfQ0KLyogRW5oYW5jZWQgbm9kZSBzdHlsaW5nIHdpdGggZ2xhc3MgbW9ycGhpc20gKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDEycHg7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDIwcHggcmdiYSgwLCAwLCAwLCAwLjIpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlOmhvdmVyIHsNCiAgICBib3gtc2hhZG93OiAwIDhweCAzMnB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMik7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KC0ycHgpOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUuc2VsZWN0ZWQgew0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBib3gtc2hhZG93OiAwIDAgMCAzcHggcmdiYSgwLCAyMTIsIDI1NSwgMC4zKTsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDIxMiwgMjU1LCAwLjA1KQ0KICAgIH0NCi8qIE5vZGUgcG9ydHMgd2l0aCBuZW9uIGdsb3cgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtcG9ydCB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm94LXNoYWRvdzogMCAwIDEwcHggcmdiYSgwLCAwLCAwLCAwLjUpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLXBvcnQ6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGJveC1zaGFkb3c6IDAgMCAxNXB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuOCk7DQogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjMpDQogICAgfQ0KLyogQ29ubmVjdGlvbiBsaW5lcyB3aXRoIG5lb24gZWZmZWN0ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25uZWN0aW9uLWxpbmUgew0KICAgIHN0cm9rZTogdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBzdHJva2Utd2lkdGg6IDM7DQogICAgZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgM3B4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMykpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25uZWN0aW9uLWxpbmU6aG92ZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbm5lY3Rpb24tbGluZS5jb25uZWN0ZWQgew0KICAgIHN0cm9rZTogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBzdHJva2Utd2lkdGg6IDQ7DQogICAgZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgOHB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuOCkpDQogICAgfQ0KLyogVG9vbGJhciB3aXRoIGdsYXNzIGVmZmVjdCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgxMCwgMTAsIDEwLCAwLjkpOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxNXB4KQ0KICAgIH0NCi8qIEVuaGFuY2VkIGJ1dHRvbiBzdHlsaW5nICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1ub2RlLWJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1ub2RlLWJ0bjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAyMTIsIDI1NSwgMC4xKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KC0xcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDE1cHggcmdiYSgwLCAyMTIsIDI1NSwgMC4yKTsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKQ0KICAgIH0NCi8qIEZsb3cgdG9vbGJhciBidXR0b25zICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTBweCk7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0bjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAyMTIsIDI1NSwgMC4xKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KC0xcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDE1cHggcmdiYSgwLCAyMTIsIDI1NSwgMC4yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0bi1zdWNjZXNzIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWJnKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4tc3VjY2Vzczpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWhvdmVyKTsNCiAgICBib3gtc2hhZG93OiAwIDRweCAyMHB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuNCkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4tZGFuZ2VyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuLWRhbmdlcjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogI2ZmMzc0MjsNCiAgICBib3gtc2hhZG93OiAwIDRweCAyMHB4IHJnYmEoMjU1LCA3MSwgODcsIDAuNCkNCiAgICB9DQovKiBOb2RlIHR5cGUgc3R5bGluZyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS10eXBlIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWJnKTsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIHRleHQtc2hhZG93OiBub25lOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweA0KICAgIH0NCi8qIE5vZGUgZGVsZXRlIGJ1dHRvbiAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm5vZGUtZGVsZXRlLWJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGJvcmRlcjogMnB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsNCiAgICBib3gtc2hhZG93OiAwIDJweCAxMHB4IHJnYmEoMjU1LCA3MSwgODcsIDAuMyk7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5ub2RlLWRlbGV0ZS1idG46aG92ZXIgew0KICAgIGJhY2tncm91bmQ6ICNmZjM3NDI7DQogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDE1cHggcmdiYSgyNTUsIDcxLCA4NywgMC41KQ0KICAgIH0NCi8qIEN1cnJlbnQgZmlsZW5hbWUgc3R5bGluZyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmN1cnJlbnQtZmlsZW5hbWUgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgdGV4dC1zaGFkb3c6IDAgMCA1cHggcmdiYSgwLCAyMTIsIDI1NSwgMC4zKQ0KICAgIH0NCi8qIFpvb20gY29udHJvbHMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWNvbnRyb2xzIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIHBhZGRpbmc6IDRweDsNCiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTBweCkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuem9vbS1sZXZlbCB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBtaW4td2lkdGg6IDQ1cHg7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMTJweA0KICAgIH0NCi8qIExvYWRpbmcgc3RhdGUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5sb2FkaW5nLW5vZGVzIHsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1zZWNvbmRhcnkpOw0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAyMHB4Ow0KICAgIGZvbnQtc3R5bGU6IGl0YWxpYw0KICAgIH0NCi8qIE5vZGUgY2F0ZWdvcmllcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm5vZGUtY2F0ZWdvcnkgaDUgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7DQogICAgbGV0dGVyLXNwYWNpbmc6IDFweDsNCiAgICBmb250LXdlaWdodDogNzAwOw0KICAgIGZvbnQtc2l6ZTogMTFweA0KICAgIH0NCi8qIENhbnZhcyB0YWdzIGFuZCBjb25maWd1cmF0aW9uIGxpc3QgdGFncyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdGFnLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXJlYS10YWcsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbSwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNhbnZhcy10YWcgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudDsNCiAgICBjb2xvcjogdmFyKC0tcHJpbWFyeS1iZykgIWltcG9ydGFudDsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDEwcHggcmdiYSgwLCAyMTIsIDI1NSwgMC4zKTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdGFnOmhvdmVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXJlYS10YWc6aG92ZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbTpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNhbnZhcy10YWc6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1ob3ZlcikgIWltcG9ydGFudDsNCiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuNSk7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KC0xcHgpDQogICAgfQ0KLyogVGFnIHRleHQgYW5kIGljb25zICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10YWcgLnRhZy10ZXh0LCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXJlYS10YWcgLnRhZy10ZXh0LCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gLnRhZy10ZXh0LCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY2FudmFzLXRhZyAudGFnLXRleHQsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRhZyBpLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXJlYS10YWcgaSwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtIGksIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jYW52YXMtdGFnIGkgew0KICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWJnKSAhaW1wb3J0YW50DQogICAgfQ0KLyogVGFnIGluZGljYXRvciBjaXJjbGVzL2RvdHMgaW4gY29uZmlndXJhdGlvbiBhcmVhICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWluZGljYXRvciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1jb2xvci1pbmRpY2F0b3IsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctY2lyY2xlLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWRvdCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmFyZWEtdGFnLWluZGljYXRvciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1jb2xvciB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudDsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudA0KICAgIH0NCi8qIFRhZyBpdGVtcyBpbiBjb25maWd1cmF0aW9uIGxpc3QgLSBtYXRjaCBub2RlIGxpc3Qgc3R5bGluZyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZykgIWltcG9ydGFudDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpICFpbXBvcnRhbnQNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW06aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMjEyLCAyNTUsIDAuMSkgIWltcG9ydGFudDsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudDsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZXkoLTFweCk7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTVweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjIpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtIC50YWctbmFtZSB7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSkgIWltcG9ydGFudA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbSAudGFnLWluZm8gew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpICFpbXBvcnRhbnQNCiAgICB9DQovKiBUYWcgZGVsZXRlIGJ1dHRvbiBzdHlsaW5nICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWRlbGV0ZSwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtIC50YWctZGVsZXRlIHsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KSAhaW1wb3J0YW50Ow0KICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyOiBub25lICFpbXBvcnRhbnQNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWRlbGV0ZTpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtIC50YWctZGVsZXRlOmhvdmVyIHsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1kZWxldGUgaSwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtIC50YWctZGVsZXRlIGkgew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpICFpbXBvcnRhbnQNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWRlbGV0ZTpob3ZlciBpLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gLnRhZy1kZWxldGU6aG92ZXIgaSB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudA0KICAgIH0NCi8qIENvbmZpZ3VyYXRpb24gYXJlYSBoZWFkZXIgdGV4dCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1oZWFkZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWd1cmF0aW9uLWhlYWRlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLWhlYWRlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1wbGFjZWhvbGRlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZ3VyYXRpb24tcGxhY2Vob2xkZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbmZpZy1hcmVhIHAsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbmZpZy1hcmVhIC5wbGFjZWhvbGRlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLWFyZWEgLmNvbmZpZy1tZXNzYWdlLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWFyZWEgcCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1hcmVhIC5wbGFjZWhvbGRlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1hcmVhIC5jb25maWctbWVzc2FnZSwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlndXJhdGlvbiBwLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25maWd1cmF0aW9uIC5wbGFjZWhvbGRlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRleHQtbXV0ZWQgew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXNlY29uZGFyeSkgIWltcG9ydGFudA0KICAgIH0NCi8qIFJ1bm5pbmcgc3RhdGUgd2l0aCBwdWxzaW5nIGVmZmVjdCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5ydW5uaW5nIHsNCiAgICBhbmltYXRpb246IHB1bHNlLW5lb24gMnMgaW5maW5pdGU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1zdWNjZXNzLWNvbG9yKQ0KICAgIH0NCkBrZXlmcmFtZXMgcHVsc2UtbmVvbiB7DQogICAgMCUsIDEwMCUgew0KICAgICAgICBib3gtc2hhZG93OiAwIDAgNXB4IHJnYmEoNDYsIDIxMywgMTE1LCAwLjUpOw0KICAgICAgICB9IDUwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAyMHB4IHJnYmEoNDYsIDIxMywgMTE1LCAwLjgpLCAwIDAgMzBweCByZ2JhKDQ2LCAyMTMsIDExNSwgMC40KTsNCiAgICAgICAgfQ0KICAgIH0NCi8qIEVycm9yIHN0YXRlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLmVycm9yIHsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBhbmltYXRpb246IHB1bHNlLWVycm9yLW5lb24gMXMgaW5maW5pdGUNCiAgICB9DQpAa2V5ZnJhbWVzIHB1bHNlLWVycm9yLW5lb24gew0KICAgIDAlLCAxMDAlIHsNCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDVweCByZ2JhKDI1NSwgNzEsIDg3LCAwLjUpOw0KICAgICAgICB9IDUwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAyMHB4IHJnYmEoMjU1LCA3MSwgODcsIDAuOCksIDAgMCAzMHB4IHJnYmEoMjU1LCA3MSwgODcsIDAuNCk7DQogICAgICAgIH0NCiAgICB9DQovKiBSZXNwb25zaXZlIGFkanVzdG1lbnRzICovDQpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsNCiAgICAuZmxvdy10b29sYm94IHsNCiAgICAgICAgd2lkdGg6IDIwMHB4DQogICAgICAgIH0NCiAgICAuZmxvdy1ub2RlIHsNCiAgICAgICAgbWluLXdpZHRoOiAxMjBweDsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4DQogICAgICAgIH0NCiAgICAudG9vbGJveC1ub2RlLWJ0biB7DQogICAgICAgIHBhZGRpbmc6IDhweCAxMHB4Ow0KICAgICAgICBmb250LXNpemU6IDEycHgNCiAgICAgICAgfQ0KICAgIH08L3N0eWxlPjxkaXYgY2xhc3M9ImFwcC1jb250YWluZXIiIGRhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIj4NCjxkaXYgY2xhc3M9ImFwcC1jb250ZW50Ij4NCjxkaXYgY2xhc3M9ImZsb3ctZWRpdG9yIj4NCjwhLS0gTGVmdCBUb29sYm94IC0tPg0KPGRpdiBjbGFzcz0iZmxvdy10b29sYm94IiBpZD0iZmxvdy10b29sYm94Ij4NCjxkaXYgY2xhc3M9InRvb2xib3gtaGVhZGVyIj4NCjxoND48aSBjbGFzcz0iZmFzIGZhLXRvb2xzIj48L2k+IE5vZGVzPC9oND4NCjxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiBpZD0idG9nZ2xlLXRvb2xib3giIHRpdGxlPSJDb2xsYXBzZSBUb29sYm94Ij4NCjxpIGNsYXNzPSJmYXMgZmEtY2hldnJvbi1sZWZ0Ij48L2k+DQo8L2J1dHRvbj4NCjwvZGl2Pg0KPGRpdiBjbGFzcz0idG9vbGJveC1jb250ZW50IiBpZD0idG9vbGJveC1jb250ZW50Ij4NCjwhLS0gTm9kZXMgd2lsbCBiZSBsb2FkZWQgZHluYW1pY2FsbHkgZnJvbSBWRlMgLS0+DQo8ZGl2IGNsYXNzPSJsb2FkaW5nLW5vZGVzIj4NCjxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5Mb2FkaW5nIG5vZGVzLi4uPC9wPg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KPCEtLSBNYWluIHdvcmtzcGFjZSAtLT4NCjxkaXYgY2xhc3M9ImZsb3ctd29ya3NwYWNlIj4NCjwhLS0gVG9vbGJhciAtLT4NCjxkaXYgY2xhc3M9ImZsb3ctdG9vbGJhciI+DQo8ZGl2IGNsYXNzPSJ0b29sYmFyLWxlZnQiPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zdWNjZXNzIiBpZD0icnVuLXdvcmtmbG93Ij4NCjxpIGNsYXNzPSJmYXMgZmEtcGxheSI+PC9pPiA8c3BhbiBjbGFzcz0iYnRuLXRleHQiPlJ1biBXb3JrZmxvdzwvc3Bhbj4NCjwvYnV0dG9uPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1kYW5nZXIiIGlkPSJzdG9wLXdvcmtmbG93IiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPg0KPGkgY2xhc3M9ImZhcyBmYS1zdG9wIj48L2k+IDxzcGFuIGNsYXNzPSJidG4tdGV4dCI+U3RvcDwvc3Bhbj4NCjwvYnV0dG9uPg0KPGRpdiBjbGFzcz0iY3VycmVudC1maWxlLWluZm8iPg0KPHNwYW4gY2xhc3M9ImN1cnJlbnQtZmlsZW5hbWUiIGlkPSJjdXJyZW50LWZpbGVuYW1lIj51bnRpdGxlZC5mbG93PC9zcGFuPg0KPC9kaXY+DQo8L2Rpdj4NCjxkaXYgY2xhc3M9InRvb2xiYXItcmlnaHQiPg0KPCEtLSBab29tIGNvbnRyb2xzIHN0YXkgdmlzaWJsZSAtLT4NCjxkaXYgY2xhc3M9Inpvb20tY29udHJvbHMiPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSIgaWQ9Inpvb20tb3V0IiB0aXRsZT0iWm9vbSBPdXQiPg0KPGkgY2xhc3M9ImZhcyBmYS1zZWFyY2gtbWludXMiPjwvaT4NCjwvYnV0dG9uPg0KPHNwYW4gY2xhc3M9Inpvb20tbGV2ZWwiIGlkPSJ6b29tLWxldmVsIj4xMDAlPC9zcGFuPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSIgaWQ9Inpvb20taW4iIHRpdGxlPSJab29tIEluIj4NCjxpIGNsYXNzPSJmYXMgZmEtc2VhcmNoLXBsdXMiPjwvaT4NCjwvYnV0dG9uPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSIgaWQ9Inpvb20tZml0IiB0aXRsZT0iWm9vbSB0byBGaXQiPg0KPGkgY2xhc3M9ImZhcyBmYS1leHBhbmQtYXJyb3dzLWFsdCI+PC9pPg0KPC9idXR0b24+DQo8L2Rpdj4NCjwhLS0gSGFtYnVyZ2VyIE1lbnUgQnV0dG9uIC0tPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSBoYW1idXJnZXItYnRuIiBpZD0iaGFtYnVyZ2VyLW1lbnUiIHRpdGxlPSJNZW51Ij4NCjxpIGNsYXNzPSJmYXMgZmEtYmFycyI+PC9pPg0KPC9idXR0b24+DQo8L2Rpdj4NCjwvZGl2Pg0KPCEtLSBEcm9wZG93biBNZW51IC0gT25seSBmaWxlIG9wZXJhdGlvbnMgYW5kIGRlbGV0ZS9jbGVhciBhY3Rpb25zIC0tPg0KPGRpdiBjbGFzcz0iZHJvcGRvd24tbWVudSIgaWQ9ImRyb3Bkb3duLW1lbnUiPg0KPGRpdiBjbGFzcz0ibWVudS1zZWN0aW9uIj4NCjxkaXYgY2xhc3M9Im1lbnUtc2VjdGlvbi10aXRsZSI+RmlsZSBBY3Rpb25zPC9kaXY+DQo8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0iIGRhdGEtYWN0aW9uPSJzYXZlLWZsb3ciPg0KPGkgY2xhc3M9ImZhcyBmYS1zYXZlIj48L2k+IFNhdmUNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIiBkYXRhLWFjdGlvbj0ic2F2ZS1mbG93LWFzIj4NCjxpIGNsYXNzPSJmYXMgZmEtc2F2ZSI+PC9pPiBTYXZlIEFzDQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCjxidXR0b24gY2xhc3M9Im1lbnUtaXRlbSIgZGF0YS1hY3Rpb249ImxvYWQtZmxvdyI+DQo8aSBjbGFzcz0iZmFzIGZhLWZvbGRlci1vcGVuIj48L2k+IExvYWQNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJtZW51LXNlY3Rpb24iPg0KPGRpdiBjbGFzcz0ibWVudS1zZWN0aW9uLXRpdGxlIj5WaWV3IEFjdGlvbnM8L2Rpdj4NCjxidXR0b24gY2xhc3M9Im1lbnUtaXRlbSIgZGF0YS1hY3Rpb249ImFkZC10YWciPg0KPGkgY2xhc3M9ImZhcyBmYS10YWciPjwvaT4gQWRkIFRhZw0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0iIGRhdGEtYWN0aW9uPSJyZXNldC12aWV3Ij4NCjxpIGNsYXNzPSJmYXMgZmEtY3Jvc3NoYWlycyI+PC9pPiBSZXNldCBWaWV3DQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCjwvZGl2Pg0KPGRpdiBjbGFzcz0ibWVudS1zZWN0aW9uIj4NCjxkaXYgY2xhc3M9Im1lbnUtc2VjdGlvbi10aXRsZSI+RWRpdCBBY3Rpb25zPC9kaXY+DQo8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0gZGFuZ2VyIiBkYXRhLWFjdGlvbj0iZGVsZXRlLXNlbGVjdGVkIj4NCjxpIGNsYXNzPSJmYXMgZmEtdHJhc2giPjwvaT4gRGVsZXRlIFNlbGVjdGVkDQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCjxidXR0b24gY2xhc3M9Im1lbnUtaXRlbSBkYW5nZXIiIGRhdGEtYWN0aW9uPSJjbGVhci1jYW52YXMiPg0KPGkgY2xhc3M9ImZhcyBmYS10cmFzaC1hbHQiPjwvaT4gQ2xlYXIgQWxsDQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCjwvZGl2Pg0KPC9kaXY+DQo8IS0tIE1haW4gY2FudmFzIGFyZWEgLS0+DQo8ZGl2IGNsYXNzPSJmbG93LWNhbnZhcy1jb250YWluZXIiPg0KPGRpdiBjbGFzcz0iZmxvdy1jYW52YXMiIGlkPSJmbG93LWNhbnZhcyI+DQo8IS0tIE5vZGVzIHdpbGwgYmUgYWRkZWQgaGVyZSBkeW5hbWljYWxseSAtLT4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCjwhLS0gQ29uZmlndXJhdGlvbiBwYW5lbCAtLT4NCjxkaXYgY2xhc3M9ImZsb3ctY29uZmlnLXBhbmVsIiBpZD0iZmxvdy1jb25maWctcGFuZWwiPg0KPGRpdiBjbGFzcz0iY29uZmlnLWhlYWRlciI+DQo8aDQ+PGkgY2xhc3M9ImZhcyBmYS1jb2ciPjwvaT4gQ29uZmlndXJhdGlvbjwvaDQ+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSIgaWQ9InRvZ2dsZS1jb25maWciIHRpdGxlPSJDb2xsYXBzZSBDb25maWd1cmF0aW9uIFBhbmVsIj4NCjxpIGNsYXNzPSJmYXMgZmEtY2hldnJvbi1yaWdodCI+PC9pPg0KPC9idXR0b24+DQo8L2Rpdj4NCjxkaXYgY2xhc3M9ImNvbmZpZy1jb250ZW50IiBpZD0iY29uZmlnLWNvbnRlbnQiPg0KPGRpdiBpZD0ibm9kZS1jb25maWciPg0KPHAgY2xhc3M9InRleHQtbXV0ZWQiPlNlbGVjdCBhIG5vZGUgdG8gY29uZmlndXJlIGl0PC9wPg0KPC9kaXY+DQo8ZGl2IGlkPSJ0YWctcGFuZWwiPg0KPGg1PjxpIGNsYXNzPSJmYXMgZmEtdGFncyI+PC9pPiBBcmVhIFRhZ3M8L2g1Pg0KPHAgY2xhc3M9InRleHQtbXV0ZWQiPk5vIHRhZ3MgeWV0PC9wPg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQo8IS0tIE91dHB1dCBwYW5lbCAtLT4NCjxkaXYgY2xhc3M9ImZsb3ctb3V0cHV0LXBhbmVsIGNvbGxhcHNlZCIgaWQ9ImZsb3ctb3V0cHV0LXBhbmVsIj4NCjxkaXYgY2xhc3M9Im91dHB1dC1oZWFkZXIiPg0KPGg0PjxpIGNsYXNzPSJmYXMgZmEtdGVybWluYWwiPjwvaT4gRXhlY3V0aW9uIE91dHB1dDwvaDQ+DQo8ZGl2IGNsYXNzPSJvdXRwdXQtY29udHJvbHMiPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tb3V0bGluZS1zZWNvbmRhcnkiIGlkPSJ0b2dnbGUtb3V0cHV0IiB0aXRsZT0iU2hvdy9IaWRlIE91dHB1dCI+DQo8aSBjbGFzcz0iZmFzIGZhLWNoZXZyb24tZG93biI+PC9pPg0KPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSIgaWQ9ImNsZWFyLW91dHB1dCI+DQo8aSBjbGFzcz0iZmFzIGZhLXRyYXNoIj48L2k+IENsZWFyDQogICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPC9kaXY+DQo8L2Rpdj4NCjxkaXYgY2xhc3M9Im91dHB1dC1jb250ZW50IiBpZD0ib3V0cHV0LWNvbnRlbnQiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQo8ZGl2IGNsYXNzPSJleGVjdXRpb24tb3V0cHV0IiBpZD0iZXhlY3V0aW9uLW91dHB1dCI+DQo8cCBjbGFzcz0idGV4dC1tdXRlZCI+V29ya2Zsb3cgb3V0cHV0IHdpbGwgYXBwZWFyIGhlcmU8L3A+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KDQo8c2NyaXB0Pi8vID09PT09IFNjcmlwdDoganMvdXRpbHMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL25vZGUtcmVnaXN0cnkuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2NhbnZhcy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvbm9kZS1jb25maWcuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL25vZGUtcmVuZGVyZXIuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2RhdGEtZXhlY3V0b3JzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9odHRwLWV4ZWN1dG9ycy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvbWVkaWEtZXhlY3V0b3JzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9mbG93LWV4ZWN1dG9ycy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvYWktZXhlY3V0b3JzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9leGVjdXRpb24tZW5naW5lLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy93b3JrZmxvdy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvY2FudmFzLW1hbmFnZXIuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL3RhZy1tYW5hZ2VyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9maWxlLW1hbmFnZXIuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL3VpLW1hbmFnZXIuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL21haW4uanMgPT09PT0NCg0KDQovLyB1dGlscy5qcyAtIFV0aWxpdHkgZnVuY3Rpb25zIGZvciBGbG93IEVkaXRvcg0KDQovLyBDYW52YXMtc3BlY2lmaWMgY29vcmRpbmF0ZSB0cmFuc2Zvcm1hdGlvbiB1dGlsaXRpZXMNCi8vIChBcHAgc2NhbGluZyB1dGlsaXRpZXMgYXJlIG5vdyBjZW50cmFsaXplZCBpbiBzeXBuZXhBUEkuc2NhbGluZykNCg0KLy8gVXRpbGl0eSBmdW5jdGlvbiB0byBlc2NhcGUgSFRNTA0KZnVuY3Rpb24gZXNjYXBlSHRtbCh0ZXh0KSB7DQogICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgZGl2LnRleHRDb250ZW50ID0gdGV4dDsNCiAgICByZXR1cm4gZGl2LmlubmVySFRNTDsNCn0NCg0KLy8gVXRpbGl0eSBmdW5jdGlvbiB0byBmb3JtYXQgZmlsZSBzaXplDQpmdW5jdGlvbiBmb3JtYXRGaWxlU2l6ZShieXRlcykgew0KICAgIGlmIChieXRlcyA9PT0gMCkgcmV0dXJuICcwIEJ5dGVzJzsNCiAgICBjb25zdCBrID0gMTAyNDsNCiAgICBjb25zdCBzaXplcyA9IFsnQnl0ZXMnLCAnS0InLCAnTUInLCAnR0InXTsNCiAgICBjb25zdCBpID0gTWF0aC5mbG9vcihNYXRoLmxvZyhieXRlcykgLyBNYXRoLmxvZyhrKSk7DQogICAgcmV0dXJuIHBhcnNlRmxvYXQoKGJ5dGVzIC8gTWF0aC5wb3coaywgaSkpLnRvRml4ZWQoMikpICsgJyAnICsgc2l6ZXNbaV07DQp9DQoNCi8vIFV0aWxpdHkgZnVuY3Rpb24gdG8gZGVib3VuY2UgZnVuY3Rpb24gY2FsbHMNCmZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMsIHdhaXQpIHsNCiAgICBsZXQgdGltZW91dDsNCiAgICByZXR1cm4gZnVuY3Rpb24gZXhlY3V0ZWRGdW5jdGlvbiguLi5hcmdzKSB7DQogICAgICAgIGNvbnN0IGxhdGVyID0gKCkgPT4gew0KICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpOw0KICAgICAgICAgICAgZnVuYyguLi5hcmdzKTsNCiAgICAgICAgfTsNCiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpOw0KICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCk7DQogICAgfTsNCn0NCg0KDQovLyBIZWxwZXIgbWV0aG9kIGZvciB0ZW1wbGF0ZSBwcm9jZXNzaW5nDQpmdW5jdGlvbiBwcm9jZXNzVGVtcGxhdGVzKHRlbXBsYXRlLCBkYXRhKSB7DQogICAgbGV0IHJlc3VsdCA9IHRlbXBsYXRlOw0KICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcgJiYgZGF0YSAhPT0gbnVsbCkgew0KICAgICAgICAvLyBDaGVjayBpZiBkYXRhLmRhdGEgaXMgYSBKU09OIHN0cmluZyBhbmQgdHJ5IHRvIHBhcnNlIGl0DQogICAgICAgIGxldCB0ZW1wbGF0ZURhdGEgPSBkYXRhOw0KICAgICAgICBpZiAoZGF0YS5kYXRhICYmIHR5cGVvZiBkYXRhLmRhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlZERhdGEgPSBKU09OLnBhcnNlKGRhdGEuZGF0YSk7DQogICAgICAgICAgICAgICAgLy8gTWVyZ2UgdGhlIHBhcnNlZCBKU09OIHdpdGggdGhlIG9yaWdpbmFsIGRhdGEgb2JqZWN0DQogICAgICAgICAgICAgICAgdGVtcGxhdGVEYXRhID0geyAuLi5kYXRhLCAuLi5wYXJzZWREYXRhIH07DQogICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgLy8gSWYgcGFyc2luZyBmYWlscywganVzdCB1c2UgdGhlIG9yaWdpbmFsIGRhdGENCiAgICAgICAgICAgICAgICB0ZW1wbGF0ZURhdGEgPSBkYXRhOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBGaW5kIGFsbCB0ZW1wbGF0ZSBwYXR0ZXJucyBsaWtlIHt7a2V5fX0gb3Ige3twYXRoLnRvLnZhbHVlfX0NCiAgICAgICAgY29uc3QgdGVtcGxhdGVQYXR0ZXJuID0gL1x7XHsoW159XSspXH1cfS9nOw0KICAgICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSh0ZW1wbGF0ZVBhdHRlcm4sIChtYXRjaCwgcGF0aCkgPT4gew0KICAgICAgICAgICAgLy8gVHJ5IHRvIGdldCBuZXN0ZWQgdmFsdWUgdXNpbmcgZG90IG5vdGF0aW9uDQogICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGV4dHJhY3ROZXN0ZWRWYWx1ZSh0ZW1wbGF0ZURhdGEsIHBhdGgpOw0KICAgICAgICAgICAgLy8gUmV0dXJuIHRoZSB2YWx1ZSBpZiBmb3VuZCwgb3RoZXJ3aXNlIGtlZXAgdGhlIG9yaWdpbmFsIHRlbXBsYXRlDQogICAgICAgICAgICByZXR1cm4gdmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCA/IHZhbHVlIDogbWF0Y2g7DQogICAgICAgIH0pOw0KICAgIH0NCiAgICByZXR1cm4gcmVzdWx0Ow0KfQ0KDQovLyBIZWxwZXIgbWV0aG9kIGZvciBleHRyYWN0aW5nIG5lc3RlZCBKU09OIHZhbHVlcw0KZnVuY3Rpb24gZXh0cmFjdE5lc3RlZFZhbHVlKG9iaiwgcGF0aCkgew0KICAgIGNvbnN0IGtleXMgPSBwYXRoLnNwbGl0KCcuJyk7DQogICAgbGV0IGN1cnJlbnQgPSBvYmo7DQoNCiAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7DQogICAgICAgIGlmIChjdXJyZW50ID09PSBudWxsIHx8IGN1cnJlbnQgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBIYW5kbGUgYXJyYXkgYWNjZXNzIGxpa2UgIml0ZW1zWzBdLm5hbWUiDQogICAgICAgIGNvbnN0IGFycmF5TWF0Y2ggPSBrZXkubWF0Y2goL14oLispXFsoXGQrKVxdJC8pOw0KICAgICAgICBpZiAoYXJyYXlNYXRjaCkgew0KICAgICAgICAgICAgY29uc3QgYXJyYXlLZXkgPSBhcnJheU1hdGNoWzFdOw0KICAgICAgICAgICAgY29uc3QgYXJyYXlJbmRleCA9IHBhcnNlSW50KGFycmF5TWF0Y2hbMl0pOw0KDQogICAgICAgICAgICBpZiAoY3VycmVudFthcnJheUtleV0gJiYgQXJyYXkuaXNBcnJheShjdXJyZW50W2FycmF5S2V5XSkpIHsNCiAgICAgICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFthcnJheUtleV1bYXJyYXlJbmRleF07DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnRba2V5XTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiBjdXJyZW50Ow0KfQ0KDQovLyBIZWxwZXIgbWV0aG9kIHRvIGRldGVjdCBpbWFnZSB0eXBlIGZyb20gYmFzZTY0IGRhdGENCmZ1bmN0aW9uIGRldGVjdEltYWdlVHlwZUZyb21CYXNlNjQoYmFzZTY0RGF0YSkgew0KICAgIC8vIENoZWNrIHRoZSBmaXJzdCBmZXcgYnl0ZXMgdG8gZGV0ZXJtaW5lIGltYWdlIHR5cGUNCiAgICB0cnkgew0KICAgICAgICBjb25zdCBiaW5hcnlTdHJpbmcgPSBhdG9iKGJhc2U2NERhdGEpOw0KICAgICAgICBjb25zdCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGJpbmFyeVN0cmluZy5sZW5ndGgpOw0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJpbmFyeVN0cmluZy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgYnl0ZXNbaV0gPSBiaW5hcnlTdHJpbmcuY2hhckNvZGVBdChpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIENoZWNrIGZpbGUgc2lnbmF0dXJlcw0KICAgICAgICBpZiAoYnl0ZXNbMF0gPT09IDB4RkYgJiYgYnl0ZXNbMV0gPT09IDB4RDggJiYgYnl0ZXNbMl0gPT09IDB4RkYpIHsNCiAgICAgICAgICAgIHJldHVybiAnaW1hZ2UvanBlZyc7DQogICAgICAgIH0gZWxzZSBpZiAoYnl0ZXNbMF0gPT09IDB4ODkgJiYgYnl0ZXNbMV0gPT09IDB4NTAgJiYgYnl0ZXNbMl0gPT09IDB4NEUgJiYgYnl0ZXNbM10gPT09IDB4NDcpIHsNCiAgICAgICAgICAgIHJldHVybiAnaW1hZ2UvcG5nJzsNCiAgICAgICAgfSBlbHNlIGlmIChieXRlc1swXSA9PT0gMHg0NyAmJiBieXRlc1sxXSA9PT0gMHg0OSAmJiBieXRlc1syXSA9PT0gMHg0Nikgew0KICAgICAgICAgICAgcmV0dXJuICdpbWFnZS9naWYnOw0KICAgICAgICB9IGVsc2UgaWYgKGJ5dGVzWzBdID09PSAweDUyICYmIGJ5dGVzWzFdID09PSAweDQ5ICYmIGJ5dGVzWzJdID09PSAweDQ2ICYmIGJ5dGVzWzNdID09PSAweDQ2KSB7DQogICAgICAgICAgICByZXR1cm4gJ2ltYWdlL3dlYnAnOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gRGVmYXVsdCB0byBQTkcgaWYgd2UgY2FuJ3QgZGV0ZXJtaW5lDQogICAgICAgICAgICByZXR1cm4gJ2ltYWdlL3BuZyc7DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlKSB7DQogICAgICAgIC8vIERlZmF1bHQgdG8gUE5HIGlmIHRoZXJlJ3MgYW4gZXJyb3INCiAgICAgICAgcmV0dXJuICdpbWFnZS9wbmcnOw0KICAgIH0NCn0NCg0KLy8gQ29udmVydCB2aWV3cG9ydCBjb29yZGluYXRlcyB0byBjYW52YXMgY29vcmRpbmF0ZXMgKGFjY291bnRpbmcgZm9yIHBhbiBhbmQgem9vbSkNCmZ1bmN0aW9uIHZpZXdwb3J0VG9DYW52YXNDb29yZHModmlld3BvcnRYLCB2aWV3cG9ydFkpIHsNCiAgICBpZiAodHlwZW9mIGZsb3dFZGl0b3IgPT09ICd1bmRlZmluZWQnKSB7DQogICAgICAgIHJldHVybiB7IHg6IHZpZXdwb3J0WCwgeTogdmlld3BvcnRZIH07DQogICAgfQ0KICAgIA0KICAgIHJldHVybiB7DQogICAgICAgIHg6ICh2aWV3cG9ydFggLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsLA0KICAgICAgICB5OiAodmlld3BvcnRZIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbA0KICAgIH07DQp9DQoNCi8vIENvbnZlcnQgY2FudmFzIGNvb3JkaW5hdGVzIHRvIHZpZXdwb3J0IGNvb3JkaW5hdGVzIChhY2NvdW50aW5nIGZvciBwYW4gYW5kIHpvb20pDQpmdW5jdGlvbiBjYW52YXNUb1ZpZXdwb3J0Q29vcmRzKGNhbnZhc1gsIGNhbnZhc1kpIHsNCiAgICBpZiAodHlwZW9mIGZsb3dFZGl0b3IgPT09ICd1bmRlZmluZWQnKSB7DQogICAgICAgIHJldHVybiB7IHg6IGNhbnZhc1gsIHk6IGNhbnZhc1kgfTsNCiAgICB9DQogICAgDQogICAgcmV0dXJuIHsNCiAgICAgICAgeDogKGNhbnZhc1ggKiBmbG93RWRpdG9yLnpvb21MZXZlbCkgKyBmbG93RWRpdG9yLnBhbk9mZnNldC54LA0KICAgICAgICB5OiAoY2FudmFzWSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsKSArIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkNCiAgICB9Ow0KfQ0KDQovLyBHZXQgdGhlIGNlbnRlciBvZiB0aGUgY3VycmVudCB2aWV3cG9ydCBpbiBjYW52YXMgY29vcmRpbmF0ZXMNCmZ1bmN0aW9uIGdldFZpZXdwb3J0Q2VudGVySW5DYW52YXMoKSB7DQogICAgaWYgKHR5cGVvZiBmbG93RWRpdG9yID09PSAndW5kZWZpbmVkJyB8fCAhZmxvd0VkaXRvci5jYW52YXMpIHsNCiAgICAgICAgcmV0dXJuIHsgeDogMCwgeTogMCB9Ow0KICAgIH0NCiAgICANCiAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgIGlmICghY29udGFpbmVyKSB7DQogICAgICAgIHJldHVybiB7IHg6IDAsIHk6IDAgfTsNCiAgICB9DQogICAgDQogICAgY29uc3QgY29udGFpbmVyUmVjdCA9IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICBjb25zdCB2aWV3cG9ydENlbnRlclggPSBjb250YWluZXJSZWN0LndpZHRoIC8gMjsNCiAgICBjb25zdCB2aWV3cG9ydENlbnRlclkgPSBjb250YWluZXJSZWN0LmhlaWdodCAvIDI7DQogICAgDQogICAgcmV0dXJuIHZpZXdwb3J0VG9DYW52YXNDb29yZHModmlld3BvcnRDZW50ZXJYLCB2aWV3cG9ydENlbnRlclkpOw0KfQ0KDQovLyBDZW50ZXIgdGhlIHZpZXdwb3J0IG9uIHNwZWNpZmljIGNhbnZhcyBjb29yZGluYXRlcw0KZnVuY3Rpb24gY2VudGVyVmlld3BvcnRPbkNhbnZhcyhjYW52YXNYLCBjYW52YXNZKSB7DQogICAgaWYgKHR5cGVvZiBmbG93RWRpdG9yID09PSAndW5kZWZpbmVkJyB8fCAhZmxvd0VkaXRvci5jYW52YXMpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgIGlmICghY29udGFpbmVyKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgY29uc3QgY29udGFpbmVyUmVjdCA9IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICBjb25zdCB2aWV3cG9ydENlbnRlclggPSBjb250YWluZXJSZWN0LndpZHRoIC8gMjsNCiAgICBjb25zdCB2aWV3cG9ydENlbnRlclkgPSBjb250YWluZXJSZWN0LmhlaWdodCAvIDI7DQogICAgDQogICAgLy8gQ2FsY3VsYXRlIHBhbiBvZmZzZXQgdG8gY2VudGVyIHRoZSBzcGVjaWZpZWQgY2FudmFzIGNvb3JkaW5hdGVzIGluIHRoZSB2aWV3cG9ydA0KICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnggPSB2aWV3cG9ydENlbnRlclggLSAoY2FudmFzWCAqIGZsb3dFZGl0b3Iuem9vbUxldmVsKTsNCiAgICBmbG93RWRpdG9yLnBhbk9mZnNldC55ID0gdmlld3BvcnRDZW50ZXJZIC0gKGNhbnZhc1kgKiBmbG93RWRpdG9yLnpvb21MZXZlbCk7DQogICAgDQogICAgLy8gVXBkYXRlIHRoZSB0cmFuc2Zvcm0NCiAgICBpZiAod2luZG93LmNhbnZhc01hbmFnZXIgJiYgd2luZG93LmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtKSB7DQogICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgIH0NCn0NCg0KLy8gRXhwb3J0IHV0aWxpdGllcyBmb3IgdXNlIGluIG90aGVyIG1vZHVsZXMNCi8vIENhbnZhcy1zcGVjaWZpYyB1dGlsaXRpZXMgb25seSAtIHNjYWxpbmcgdXRpbGl0aWVzIGFyZSBub3cgaW4gc3lwbmV4QVBJLnNjYWxpbmcNCndpbmRvdy5mbG93RWRpdG9yVXRpbHMgPSB7DQogICAgLy8gQ2FudmFzLXNwZWNpZmljIGNvb3JkaW5hdGUgdHJhbnNmb3JtYXRpb25zDQogICAgdmlld3BvcnRUb0NhbnZhc0Nvb3JkcywNCiAgICBjYW52YXNUb1ZpZXdwb3J0Q29vcmRzLA0KICAgIGdldFZpZXdwb3J0Q2VudGVySW5DYW52YXMsDQogICAgY2VudGVyVmlld3BvcnRPbkNhbnZhcywNCiAgICANCiAgICAvLyBHZW5lcmFsIHV0aWxpdGllcw0KICAgIGVzY2FwZUh0bWwsDQogICAgZm9ybWF0RmlsZVNpemUsDQogICAgZGVib3VuY2UsDQogICAgcHJvY2Vzc1RlbXBsYXRlcywNCiAgICBleHRyYWN0TmVzdGVkVmFsdWUsDQogICAgZGV0ZWN0SW1hZ2VUeXBlRnJvbUJhc2U2NA0KfTsNCg0KLy8gUmVwbGFjZSB0ZW1wbGF0ZSBwbGFjZWhvbGRlcnMgaW4gSlNPTiBib2R5DQpmdW5jdGlvbiByZXBsYWNlVGVtcGxhdGVQbGFjZWhvbGRlcnMoYm9keSwgdGVtcGxhdGVEYXRhKSB7DQoNCiAgICBpZiAoIWJvZHkpIHsNCiAgICAgICAgcmV0dXJuIGJvZHk7DQogICAgfQ0KDQogICAgLy8gSGFuZGxlIGJvdGggc3RyaW5nIGFuZCBvYmplY3QgaW5wdXRzDQogICAgbGV0IGJvZHlTdHJpbmc7DQogICAgbGV0IGlzSnNvblN0cmluZyA9IGZhbHNlOw0KDQogICAgaWYgKHR5cGVvZiBib2R5ID09PSAnc3RyaW5nJykgew0KICAgICAgICBib2R5U3RyaW5nID0gYm9keTsNCiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBhbHJlYWR5IGEgSlNPTiBzdHJpbmcNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIEpTT04ucGFyc2UoYm9keSk7DQogICAgICAgICAgICBpc0pzb25TdHJpbmcgPSB0cnVlOw0KICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAvLyBOb3QgYSBKU09OIHN0cmluZywgdHJlYXQgYXMgcmVndWxhciBzdHJpbmcNCiAgICAgICAgfQ0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGJvZHkgPT09ICdvYmplY3QnKSB7DQogICAgICAgIGJvZHlTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShib2R5KTsNCiAgICAgICAgaXNKc29uU3RyaW5nID0gdHJ1ZTsNCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gYm9keTsNCiAgICB9DQoNCg0KICAgIC8vIFJlcGxhY2UgcGxhY2Vob2xkZXJzIHdpdGggdGVtcGxhdGUgZGF0YQ0KICAgIGlmICh0ZW1wbGF0ZURhdGEgIT09IHVuZGVmaW5lZCAmJiB0ZW1wbGF0ZURhdGEgIT09IG51bGwpIHsNCiAgICAgICAgY29uc3QgYmVmb3JlUmVwbGFjZSA9IGJvZHlTdHJpbmc7DQoNCg0KICAgICAgICAvLyBTaW1wbGUgSlNPTiBmaWVsZCByZXBsYWNlbWVudCAtIGp1c3Qge3tmaWVsZH19IG9yIHt7bmVzdGVkLmZpZWxkfX0NCiAgICAgICAgaWYgKHR5cGVvZiB0ZW1wbGF0ZURhdGEgPT09ICdvYmplY3QnKSB7DQoNCiAgICAgICAgICAgIC8vIFVzZSBhIHNpbXBsZXIsIG1vcmUgZXhwbGljaXQgcmVnZXgNCiAgICAgICAgICAgIGNvbnN0IHBsYWNlaG9sZGVyUmVnZXggPSAvXHtceyhbXn1dKylcfVx9L2c7DQoNCiAgICAgICAgICAgIC8vIFRlc3QgaWYgdGhlIHJlZ2V4IGZpbmRzIGFueXRoaW5nDQogICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gYm9keVN0cmluZy5tYXRjaChwbGFjZWhvbGRlclJlZ2V4KTsNCg0KICAgICAgICAgICAgYm9keVN0cmluZyA9IGJvZHlTdHJpbmcucmVwbGFjZShwbGFjZWhvbGRlclJlZ2V4LCAobWF0Y2gsIGZpZWxkUGF0aCkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZ2V0TmVzdGVkVmFsdWUodGVtcGxhdGVEYXRhLCBmaWVsZFBhdGgpOw0KICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIGxldCByZXBsYWNlbWVudDsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFsd2F5cyBlc2NhcGUgdGhlIHN0cmluZyBwcm9wZXJseSBmb3IgSlNPTiBjb250ZXh0DQogICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudCA9IHZhbHVlLnJlcGxhY2UoL1xcL2csICdcXFxcJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvIi9nLCAnXFwiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXG4vZywgJ1xcbicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xyL2csICdcXHInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cdC9nLCAnXFx0Jyk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3Igbm9uLXN0cmluZ3MsIGNvbnZlcnQgdG8gSlNPTiBzdHJpbmcNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50ID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXBsYWNlbWVudDsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2g7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRlbXBsYXRlRGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIC8vIEZvciBzdHJpbmdzLCBqdXN0IHJlcGxhY2Uge3tWQUxVRX19IGFzIGEgZmFsbGJhY2sNCiAgICAgICAgICAgIGJvZHlTdHJpbmcgPSBib2R5U3RyaW5nLnJlcGxhY2UoL3t7VkFMVUV9fS9nLCBKU09OLnN0cmluZ2lmeSh0ZW1wbGF0ZURhdGEpKTsNCiAgICAgICAgfQ0KDQogICAgfSBlbHNlIHsNCiAgICB9DQoNCiAgICBpZiAodHlwZW9mIGJvZHkgPT09ICdvYmplY3QnKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShib2R5U3RyaW5nKTsNCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSB0ZW1wbGF0ZS1yZXBsYWNlZCBib2R5OicsIGVycm9yKTsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0JvZHkgc3RyaW5nIHdhczonLCBib2R5U3RyaW5nKTsNCiAgICAgICAgICAgIHJldHVybiBib2R5Ow0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIGJvZHlTdHJpbmc7DQogICAgfQ0KfQ0KDQovLyBHZXQgbmVzdGVkIHZhbHVlIGZyb20gb2JqZWN0IHVzaW5nIGRvdCBub3RhdGlvbg0KZnVuY3Rpb24gZ2V0TmVzdGVkVmFsdWUob2JqLCBwYXRoKSB7DQogICAgY29uc3QgcmVzdWx0ID0gcGF0aC5zcGxpdCgnLicpLnJlZHVjZSgoY3VycmVudCwga2V5KSA9PiB7DQogICAgICAgIGNvbnN0IHZhbHVlID0gY3VycmVudCAmJiBjdXJyZW50W2tleV0gIT09IHVuZGVmaW5lZCA/IGN1cnJlbnRba2V5XSA6IHVuZGVmaW5lZDsNCiAgICAgICAgcmV0dXJuIHZhbHVlOw0KICAgIH0sIG9iaik7DQogICAgcmV0dXJuIHJlc3VsdDsNCn0NCg0KDQovLyBVcGRhdGUgSlNPTiBleHRyYWN0IG5vZGUgZGlzcGxheQ0KZnVuY3Rpb24gdXBkYXRlSnNvbkV4dHJhY3REaXNwbGF5KG5vZGVJZCwgbGFiZWwsIHZhbHVlLCBzdGF0dXMgPSAnbm9ybWFsJykgew0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgY29uc3QgY29udGVudEVsZW1lbnQgPSBub2RlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZmxvdy1ub2RlLWNvbnRlbnQnKTsNCiAgICAgICAgaWYgKGNvbnRlbnRFbGVtZW50KSB7DQogICAgICAgICAgICBjb25zdCBzdGF0dXNDbGFzcyA9IHN0YXR1cyA9PT0gJ2Vycm9yJyA/ICd0ZXh0LWRhbmdlcicgOiBzdGF0dXMgPT09ICdzdWNjZXNzJyA/ICd0ZXh0LXN1Y2Nlc3MnIDogJ3RleHQtbXV0ZWQnOw0KDQogICAgICAgICAgICAvLyBTaG93IGp1c3QgYSBzdGF0dXMgb24gdGhlIG5vZGUsIGZ1bGwgY29udGVudCB3aWxsIGJlIGluIGNvbmZpZyBwYW5lbA0KICAgICAgICAgICAgY29uc3QgdHJ1bmNhdGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmIHZhbHVlLmxlbmd0aCA+IDUwID8NCiAgICAgICAgICAgICAgICB2YWx1ZS5zdWJzdHJpbmcoMCwgNTApICsgJy4uLicgOiB2YWx1ZTsNCg0KICAgICAgICAgICAgY29udGVudEVsZW1lbnQuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5vZGUtc3RhdHVzIj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdHVzLXRleHQiPlZhbHVlIGV4dHJhY3RlZDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0dXMtaW5mbyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+JHtsYWJlbH06ICR7ZXNjYXBlSHRtbChTdHJpbmcodHJ1bmNhdGVkVmFsdWUpKX08L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIEFkZCBleGVjdXRpb24gbG9nIGVudHJ5DQpmdW5jdGlvbiBhZGRFeGVjdXRpb25Mb2cobWVzc2FnZSwgdHlwZSA9ICdpbmZvJykgew0KICAgIGNvbnN0IG91dHB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleGVjdXRpb24tb3V0cHV0Jyk7DQogICAgaWYgKG91dHB1dCkgew0KICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvTG9jYWxlVGltZVN0cmluZygpOw0KICAgICAgICBvdXRwdXQuaW5uZXJIVE1MICs9IGA8ZGl2IGNsYXNzPSJsb2ctZW50cnkgJHt0eXBlfSI+WyR7dGltZXN0YW1wfV0gJHttZXNzYWdlfTwvZGl2PmA7DQogICAgICAgIG91dHB1dC5zY3JvbGxUb3AgPSBvdXRwdXQuc2Nyb2xsSGVpZ2h0Ow0KICAgIH0NCn0NCg0KLy8gQ2xlYXIgZXhlY3V0aW9uIG91dHB1dA0KZnVuY3Rpb24gY2xlYXJPdXRwdXQoKSB7DQogICAgY29uc3Qgb3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4ZWN1dGlvbi1vdXRwdXQnKTsNCiAgICBpZiAob3V0cHV0KSB7DQogICAgICAgIG91dHB1dC5pbm5lckhUTUwgPSAnPGRpdiBjbGFzcz0ibG9nLWVudHJ5IGluZm8iPk91dHB1dCBjbGVhcmVkPC9kaXY+JzsNCiAgICB9DQp9DQoNCg0KLy8gSW50ZXJhY3RpdmUgaGVscGVyIGZ1bmN0aW9ucyBmb3Igc3BlY2lhbCBub2RlIHR5cGVzDQoNCi8vIEF1ZGlvIGNvbnRyb2wgZnVuY3Rpb25zDQpmdW5jdGlvbiBwbGF5QXVkaW8obm9kZUlkKSB7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlIHx8ICFub2RlLmxhc3RBdWRpb1VybCkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdObyBhdWRpbyBkYXRhIGF2YWlsYWJsZSBmb3Igbm9kZTonLCBub2RlSWQpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8gQ3JlYXRlIG9yIHJldXNlIGF1ZGlvIGVsZW1lbnQNCiAgICBpZiAoIW5vZGUuYXVkaW9FbGVtZW50KSB7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50ID0gbmV3IEF1ZGlvKG5vZGUubGFzdEF1ZGlvVXJsKTsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQudm9sdW1lID0gcGFyc2VGbG9hdChub2RlLmNvbmZpZy52b2x1bWUudmFsdWUpOw0KICAgIH0NCg0KICAgIG5vZGUuYXVkaW9FbGVtZW50LnBsYXkoKS5jYXRjaChlcnJvciA9PiB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBwbGF5IGF1ZGlvOicsIGVycm9yKTsNCiAgICB9KTsNCg0KfQ0KDQpmdW5jdGlvbiBzdG9wQXVkaW8obm9kZUlkKSB7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlIHx8ICFub2RlLmF1ZGlvRWxlbWVudCkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdObyBhdWRpbyBlbGVtZW50IGZvdW5kIGZvciBub2RlOicsIG5vZGVJZCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBub2RlLmF1ZGlvRWxlbWVudC5wYXVzZSgpOw0KICAgIG5vZGUuYXVkaW9FbGVtZW50LmN1cnJlbnRUaW1lID0gMDsNCg0KfQ0KDQovLyBJbWFnZSBkaXNwbGF5IGZ1bmN0aW9ucw0KZnVuY3Rpb24gc2hvd0Z1bGxJbWFnZShub2RlSWQpIHsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUgfHwgIW5vZGUubGFzdEltYWdlVXJsKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIGltYWdlIGRhdGEgYXZhaWxhYmxlIGZvciBub2RlOicsIG5vZGVJZCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBDcmVhdGUgYSBtb2RhbCB0byBzaG93IHRoZSBmdWxsIGltYWdlDQogICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBtb2RhbC5jbGFzc05hbWUgPSAnaW1hZ2UtbW9kYWwnOw0KICAgIG1vZGFsLnN0eWxlLmNzc1RleHQgPSBgDQogICAgICAgIHBvc2l0aW9uOiBmaXhlZDsNCiAgICAgICAgdG9wOiAwOw0KICAgICAgICBsZWZ0OiAwOw0KICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuOCk7DQogICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICB6LWluZGV4OiAxMDAwMDsNCiAgICAgICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGA7DQoNCiAgICBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTsNCiAgICBpbWcuc3JjID0gbm9kZS5sYXN0SW1hZ2VVcmw7DQogICAgaW1nLnN0eWxlLmNzc1RleHQgPSBgDQogICAgICAgIG1heC13aWR0aDogOTAlOw0KICAgICAgICBtYXgtaGVpZ2h0OiA5MCU7DQogICAgICAgIG9iamVjdC1maXQ6IGNvbnRhaW47DQogICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICAgICAgYm94LXNoYWRvdzogMCA0cHggMjBweCByZ2JhKDAsIDAsIDAsIDAuNSk7DQogICAgYDsNCg0KICAgIG1vZGFsLmFwcGVuZENoaWxkKGltZyk7DQogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtb2RhbCk7DQoNCiAgICAvLyBDbG9zZSBtb2RhbCBvbiBjbGljaw0KICAgIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG1vZGFsKTsNCiAgICB9KTsNCg0KfQ0KDQovLyBSZXBlYXRlciBjb250cm9sIGZ1bmN0aW9ucw0KZnVuY3Rpb24gc3RhcnRSZXBlYXRlcihub2RlSWQpIHsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUgfHwgbm9kZS50eXBlICE9PSAncmVwZWF0ZXInKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ludmFsaWQgcmVwZWF0ZXIgbm9kZTonLCBub2RlSWQpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8gRXhlY3V0ZSB0aGUgcmVwZWF0ZXIgbm9kZSB0byBzdGFydCBpdA0KICAgIGV4ZWN1dGlvbkVuZ2luZS5leGVjdXRlTm9kZShub2RlLCB7fSwgbmV3IFNldCgpKS50aGVuKCgpID0+IHsNCiAgICAgICAgLy8gUmVmcmVzaCB0aGUgY29uZmlnIHBhbmVsIHRvIHVwZGF0ZSB0aGUgVUkNCiAgICAgICAgc2hvd05vZGVDb25maWcobm9kZUlkKTsNCiAgICB9KS5jYXRjaChlcnJvciA9PiB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzdGFydCByZXBlYXRlcjonLCBlcnJvcik7DQogICAgfSk7DQp9DQoNCmZ1bmN0aW9uIHN0b3BSZXBlYXRlcihub2RlSWQpIHsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUgfHwgbm9kZS50eXBlICE9PSAncmVwZWF0ZXInKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ludmFsaWQgcmVwZWF0ZXIgbm9kZTonLCBub2RlSWQpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8gU3RvcCB0aGUgcmVwZWF0ZXIgdXNpbmcgdGhlIGV4ZWN1dGlvbiBlbmdpbmUgbWV0aG9kDQogICAgZXhlY3V0aW9uRW5naW5lLnN0b3BSZXBlYXRlcihub2RlKTsNCg0KICAgIC8vIFJlZnJlc2ggdGhlIGNvbmZpZyBwYW5lbCB0byB1cGRhdGUgdGhlIFVJDQogICAgc2hvd05vZGVDb25maWcobm9kZUlkKTsNCn0NCg0KDQoNCi8vIFVwZGF0ZSBpbnB1dCBtYXBwaW5nIHdoZW4gdXNlciBzZWxlY3RzIGEgZGlmZmVyZW50IG91dHB1dCBwb3J0DQpmdW5jdGlvbiB1cGRhdGVJbnB1dE1hcHBpbmcobm9kZUlkLCBpbnB1dFBvcnQsIHNlbGVjdGVkT3V0cHV0UG9ydCkgew0KICAgIC8vIEZpbmQgdGhlIGNvbm5lY3Rpb24gdGhhdCBnb2VzIHRvIHRoaXMgaW5wdXQgcG9ydCAoaWdub3JlIGZyb20ucG9ydE5hbWUpDQogICAgY29uc3QgY29ubmVjdGlvbiA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkuZmluZChjb25uID0+DQogICAgICAgIGNvbm4udG8ubm9kZUlkID09PSBub2RlSWQgJiYgY29ubi50by5wb3J0TmFtZSA9PT0gaW5wdXRQb3J0DQogICAgKTsNCiAgICBpZiAoY29ubmVjdGlvbikgew0KICAgICAgICAvLyBSZW1vdmUgdGhlIG9sZCBjb25uZWN0aW9uDQogICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuZGVsZXRlKGNvbm5lY3Rpb24uaWQpOw0KICAgICAgICBpZiAoY29ubmVjdGlvbi5zdmcpIGNvbm5lY3Rpb24uc3ZnLnJlbW92ZSgpOw0KICAgICAgICAvLyBDcmVhdGUgYSBuZXcgY29ubmVjdGlvbiB3aXRoIHRoZSB1cGRhdGVkIHBvcnQgbmFtZSBhbmQgbmV3IElEDQogICAgICAgIGNvbnN0IG5ld0Nvbm5lY3Rpb25JZCA9IGBjb25uXyR7Y29ubmVjdGlvbi5mcm9tLm5vZGVJZH1fJHtzZWxlY3RlZE91dHB1dFBvcnR9XyR7Y29ubmVjdGlvbi50by5ub2RlSWR9XyR7Y29ubmVjdGlvbi50by5wb3J0TmFtZX1gOw0KICAgICAgICBjb25zdCBuZXdDb25uZWN0aW9uID0gew0KICAgICAgICAgICAgaWQ6IG5ld0Nvbm5lY3Rpb25JZCwNCiAgICAgICAgICAgIGZyb206IHsgbm9kZUlkOiBjb25uZWN0aW9uLmZyb20ubm9kZUlkLCBwb3J0TmFtZTogc2VsZWN0ZWRPdXRwdXRQb3J0IH0sDQogICAgICAgICAgICB0bzogeyBub2RlSWQ6IGNvbm5lY3Rpb24udG8ubm9kZUlkLCBwb3J0TmFtZTogY29ubmVjdGlvbi50by5wb3J0TmFtZSB9DQogICAgICAgIH07DQogICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuc2V0KG5ld0Nvbm5lY3Rpb25JZCwgbmV3Q29ubmVjdGlvbik7DQogICAgICAgIGRyYXdDb25uZWN0aW9uKG5ld0Nvbm5lY3Rpb24pOw0KICAgICAgICAvLyBSZWZyZXNoIHRoZSBub2RlIGNvbmZpZyBwYW5lbCB0byBzaG93IHVwZGF0ZWQgc3RhdGUNCiAgICAgICAgaWYgKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlID09PSBub2RlSWQpIHsNCiAgICAgICAgICAgIHNob3dOb2RlQ29uZmlnKG5vZGVJZCk7DQogICAgICAgIH0NCiAgICAgICAgLy8gQXV0by1zYXZlIHRoZSB3b3JrZmxvdyB0byBwZXJzaXN0IHRoZSBtYXBwaW5nIGNoYW5nZQ0KICAgICAgICBpZiAod2luZG93LmZpbGVNYW5hZ2VyLnNhdmVGbG93KSB7DQogICAgICAgICAgICB3aW5kb3cuZmlsZU1hbmFnZXIuc2F2ZUZsb3coKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gVXBkYXRlIG91dHB1dCBtYXBwaW5nIHdoZW4gdXNlciBzZWxlY3RzIGEgZGlmZmVyZW50IG91dHB1dCBwb3J0DQpmdW5jdGlvbiB1cGRhdGVPdXRwdXRNYXBwaW5nKG5vZGVJZCwgb3V0cHV0UG9ydCwgdGFyZ2V0Tm9kZUlkLCBzZWxlY3RlZE91dHB1dFBvcnQpIHsNCiAgICAvLyBSZW1vdmUgYWxsIGNvbm5lY3Rpb25zIGZyb20gdGhpcyBub2RlIHRvIHRoZSB0YXJnZXQgbm9kZSAocmVnYXJkbGVzcyBvZiBwb3J0KQ0KICAgIGNvbnN0IGNvbm5lY3Rpb25zVG9SZW1vdmUgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLmZpbHRlcihjb25uID0+DQogICAgICAgIGNvbm4uZnJvbS5ub2RlSWQgPT09IG5vZGVJZCAmJiBjb25uLnRvLm5vZGVJZCA9PT0gdGFyZ2V0Tm9kZUlkDQogICAgKTsNCiAgICBjb25uZWN0aW9uc1RvUmVtb3ZlLmZvckVhY2goY29ubiA9PiB7DQogICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuZGVsZXRlKGNvbm4uaWQpOw0KICAgICAgICBpZiAoY29ubi5zdmcpIGNvbm4uc3ZnLnJlbW92ZSgpOw0KICAgIH0pOw0KICAgIC8vIEFkZCB0aGUgbmV3IGNvbm5lY3Rpb24NCiAgICBjb25zdCBuZXdDb25uZWN0aW9uSWQgPSBgY29ubl8ke25vZGVJZH1fJHtzZWxlY3RlZE91dHB1dFBvcnR9XyR7dGFyZ2V0Tm9kZUlkfWA7DQogICAgY29uc3QgbmV3Q29ubmVjdGlvbiA9IHsNCiAgICAgICAgaWQ6IG5ld0Nvbm5lY3Rpb25JZCwNCiAgICAgICAgZnJvbTogeyBub2RlSWQ6IG5vZGVJZCwgcG9ydE5hbWU6IHNlbGVjdGVkT3V0cHV0UG9ydCB9LA0KICAgICAgICB0bzogeyBub2RlSWQ6IHRhcmdldE5vZGVJZCwgcG9ydE5hbWU6IGNvbm5lY3Rpb25zVG9SZW1vdmVbMF0/LnRvLnBvcnROYW1lIHx8ICdkYXRhJyB9DQogICAgfTsNCiAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnNldChuZXdDb25uZWN0aW9uSWQsIG5ld0Nvbm5lY3Rpb24pOw0KICAgIGRyYXdDb25uZWN0aW9uKG5ld0Nvbm5lY3Rpb24pOw0KICAgIC8vIFJlZnJlc2ggdGhlIHRhcmdldCBub2RlIGlmIHNlbGVjdGVkDQogICAgaWYgKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlID09PSB0YXJnZXROb2RlSWQpIHsNCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICBzaG93Tm9kZUNvbmZpZyh0YXJnZXROb2RlSWQpOw0KICAgICAgICB9LCAxMCk7DQogICAgfQ0KICAgIC8vIEF1dG8tc2F2ZQ0KICAgIGlmICh3aW5kb3cuZmlsZU1hbmFnZXIuc2F2ZUZsb3cpIHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvdygpOw0KfQ0KDQoNCi8vIG5vZGUtcmVnaXN0cnkuanMgLSBEeW5hbWljIG5vZGUgcmVnaXN0cnkgZm9yIEZsb3cgRWRpdG9yDQoNCmNsYXNzIE5vZGVSZWdpc3RyeSB7DQogICAgY29uc3RydWN0b3IoKSB7DQogICAgICAgIHRoaXMubm9kZVR5cGVzID0gbmV3IE1hcCgpOw0KICAgICAgICB0aGlzLmV4ZWN1dG9ycyA9IG5ldyBNYXAoKTsNCiAgICAgICAgdGhpcy5sb2FkZWQgPSBmYWxzZTsNCiAgICB9DQogICAgDQogICAgYXN5bmMgbG9hZE5vZGVzRnJvbVZGUygpIHsNCiAgICAgICAgaWYgKHRoaXMubG9hZGVkKSByZXR1cm47DQogICAgICAgIA0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBMb2FkIHRoZSBwYWNrZWQgbm9kZXMgZmlsZSBkaXJlY3RseQ0KICAgICAgICAgICAgY29uc3QgcGFja0ZpbGVQYXRoID0gJy9ub2Rlcy9ub2Rlcy1wYWNrLmpzb24nOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZVRleHQocGFja0ZpbGVQYXRoKTsNCiAgICAgICAgICAgIGNvbnN0IHBhY2tEYXRhID0gSlNPTi5wYXJzZShjb250ZW50KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBSZWdpc3RlciBhbGwgbm9kZXMgZnJvbSB0aGUgcGFjaw0KICAgICAgICAgICAgZm9yIChjb25zdCBbbm9kZUlkLCBub2RlRGVmXSBvZiBPYmplY3QuZW50cmllcyhwYWNrRGF0YS5ub2RlcykpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnJlZ2lzdGVyTm9kZShub2RlRGVmKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlOw0KICAgICAgICAgICAgDQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBub2RlcyBmcm9tIFZGUyBwYWNrZWQgZmlsZTonLCBlcnJvcik7DQogICAgICAgICAgICB0aHJvdyBlcnJvcjsgLy8gUmUtdGhyb3cgdG8gaW5kaWNhdGUgZmFpbHVyZQ0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGFzeW5jIGxvYWROb2RlRmlsZShmaWxlUGF0aCkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVUZXh0KGZpbGVQYXRoKTsNCiAgICAgICAgICAgIGNvbnN0IG5vZGVEZWYgPSBKU09OLnBhcnNlKGNvbnRlbnQpOw0KICAgICAgICAgICAgdGhpcy5yZWdpc3Rlck5vZGUobm9kZURlZik7DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gbG9hZCBub2RlIGZyb20gJHtmaWxlUGF0aH06YCwgZXJyb3IpOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIHJlZ2lzdGVyTm9kZShub2RlRGVmKSB7DQogICAgICAgIHRoaXMubm9kZVR5cGVzLnNldChub2RlRGVmLmlkLCBub2RlRGVmKTsNCiAgICB9DQogICAgDQogICAgcmVnaXN0ZXJFeGVjdXRvcihuYW1lLCBleGVjdXRvcikgew0KICAgICAgICB0aGlzLmV4ZWN1dG9ycy5zZXQobmFtZSwgZXhlY3V0b3IpOw0KICAgIH0NCiAgICANCiAgICBnZXROb2RlVHlwZShpZCkgew0KICAgICAgICByZXR1cm4gdGhpcy5ub2RlVHlwZXMuZ2V0KGlkKTsNCiAgICB9DQogICAgDQogICAgZ2V0RXhlY3V0b3IobmFtZSkgew0KICAgICAgICByZXR1cm4gdGhpcy5leGVjdXRvcnMuZ2V0KG5hbWUpOw0KICAgIH0NCiAgICANCiAgICBnZXRBbGxOb2RlVHlwZXMoKSB7DQogICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMubm9kZVR5cGVzLnZhbHVlcygpKTsNCiAgICB9DQogICAgDQogICAgZ2V0Tm9kZVR5cGVzQnlDYXRlZ29yeShjYXRlZ29yeSkgew0KICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGxOb2RlVHlwZXMoKS5maWx0ZXIobm9kZSA9PiBub2RlLmNhdGVnb3J5ID09PSBjYXRlZ29yeSk7DQogICAgfQ0KfQ0KDQovLyBHbG9iYWwgbm9kZSByZWdpc3RyeSBpbnN0YW5jZQ0KY29uc3Qgbm9kZVJlZ2lzdHJ5ID0gbmV3IE5vZGVSZWdpc3RyeSgpOw0KDQoNCi8vIGNhbnZhcy5qcyAtIENhbnZhcyBldmVudCBoYW5kbGVycyBhbmQgZHJhd2luZyBsb2dpYyBmb3IgRmxvdyBFZGl0b3INCg0KLy8gU3RhcnQgZHJhZ2dpbmcgYSBub2RlDQpmdW5jdGlvbiBzdGFydERyYWdnaW5nTm9kZShub2RlSWQsIGUpIHsNCiAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICANCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUpIHJldHVybjsNCiAgICANCiAgICBmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSA9IG5vZGVJZDsNCiAgICANCiAgICAvLyBDYWxjdWxhdGUgb2Zmc2V0IGZyb20gbW91c2UgdG8gbm9kZSBjb3JuZXIgdXNpbmcgc2NhbGVkIGNvb3JkaW5hdGVzDQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgIGNvbnN0IHJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPyANCiAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChub2RlRWxlbWVudCkgOiANCiAgICAgICAgbm9kZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/IA0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOiANCiAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgIA0KICAgIGZsb3dFZGl0b3IuZHJhZ09mZnNldCA9IHsNCiAgICAgICAgeDogbW91c2VDb29yZHMueCAtIHJlY3QubGVmdCwNCiAgICAgICAgeTogbW91c2VDb29yZHMueSAtIHJlY3QudG9wDQogICAgfTsNCiAgICANCiAgICBub2RlRWxlbWVudC5zdHlsZS5jdXJzb3IgPSAnZ3JhYmJpbmcnOw0KICAgIG5vZGVFbGVtZW50LnN0eWxlLnpJbmRleCA9ICcxMDAwJzsgLy8gQnJpbmcgdG8gZnJvbnQgd2hpbGUgZHJhZ2dpbmcNCiAgICANCiAgICAvLyBDYWNoZSBjYW52YXMgcmVjdCBmb3IgcGVyZm9ybWFuY2UgKHNjYWxlZCkNCiAgICBmbG93RWRpdG9yLmNhbnZhc1JlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPyANCiAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChmbG93RWRpdG9yLmNhbnZhcykgOiANCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQp9DQoNCi8vIFNlbGVjdCBhIG5vZGUNCmZ1bmN0aW9uIHNlbGVjdE5vZGUobm9kZUlkKSB7DQogICAgLy8gUmVtb3ZlIHByZXZpb3VzIHNlbGVjdGlvbg0KICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mbG93LW5vZGUuc2VsZWN0ZWQnKS5mb3JFYWNoKG5vZGUgPT4gew0KICAgICAgICBub2RlLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7DQogICAgfSk7DQogICAgDQogICAgLy8gU2VsZWN0IG5ldyBub2RlDQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOw0KICAgICAgICBmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9IG5vZGVJZDsNCiAgICAgICAgc2hvd05vZGVDb25maWcobm9kZUlkKTsNCiAgICB9DQp9DQoNCg0KLy8gU3RhcnQgYSBjb25uZWN0aW9uIGZyb20gYSBwb3J0DQpmdW5jdGlvbiBzdGFydENvbm5lY3Rpb24obm9kZUlkLCBwb3J0TmFtZSwgaXNPdXRwdXQpIHsNCiAgICBpZiAoaXNPdXRwdXQpIHsNCiAgICAgICAgLy8gU3RhcnRpbmcgZnJvbSBvdXRwdXQgcG9ydA0KICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tID0gew0KICAgICAgICAgICAgbm9kZUlkOiBub2RlSWQsDQogICAgICAgICAgICBwb3J0TmFtZTogcG9ydE5hbWUsDQogICAgICAgICAgICBpc091dHB1dDogdHJ1ZQ0KICAgICAgICB9Ow0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIFN0YXJ0aW5nIGZyb20gaW5wdXQgcG9ydCAtIGNoZWNrIGlmIHdlIGhhdmUgYSBwZW5kaW5nIGNvbm5lY3Rpb24NCiAgICAgICAgaWYgKGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20gJiYgZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbS5pc091dHB1dCkgew0KICAgICAgICAgICAgLy8gQ29tcGxldGUgdGhlIGNvbm5lY3Rpb24NCiAgICAgICAgICAgIGNvbnN0IGZyb21Ob2RlSWQgPSBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tLm5vZGVJZDsNCiAgICAgICAgICAgIGNvbnN0IGZyb21Qb3J0ID0gZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbS5wb3J0TmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY3JlYXRlQ29ubmVjdGlvbihmcm9tTm9kZUlkLCBmcm9tUG9ydCwgbm9kZUlkLCBwb3J0TmFtZSk7DQogICAgICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tID0gbnVsbDsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gVXBkYXRlIGNvbm5lY3Rpb25zIGZvciBhIHNwZWNpZmljIG5vZGUNCmZ1bmN0aW9uIHVwZGF0ZUNvbm5lY3Rpb25zRm9yTm9kZShub2RlSWQpIHsNCiAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkIHx8IGNvbm5lY3Rpb24udG8ubm9kZUlkID09PSBub2RlSWQpIHsNCiAgICAgICAgICAgIHVwZGF0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbik7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIFVwZGF0ZSBhIHNpbmdsZSBjb25uZWN0aW9uDQpmdW5jdGlvbiB1cGRhdGVDb25uZWN0aW9uKGNvbm5lY3Rpb24pIHsNCiAgICBjb25zdCBmcm9tTm9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQpOw0KICAgIGNvbnN0IHRvTm9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICANCiAgICBpZiAoIWZyb21Ob2RlIHx8ICF0b05vZGUgfHwgIWNvbm5lY3Rpb24uc3ZnKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gR2V0IG5vZGUgZGF0YSBwb3NpdGlvbnMNCiAgICBjb25zdCBmcm9tTm9kZURhdGEgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uZWN0aW9uLmZyb20ubm9kZUlkKTsNCiAgICBjb25zdCB0b05vZGVEYXRhID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgIA0KICAgIGlmICghZnJvbU5vZGVEYXRhIHx8ICF0b05vZGVEYXRhKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gR2V0IGFjdHVhbCBub2RlIGRpbWVuc2lvbnMgZnJvbSBjb21wdXRlZCBzdHlsZXMNCiAgICBjb25zdCBmcm9tU3R5bGVzID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZnJvbU5vZGUpOw0KICAgIGNvbnN0IHRvU3R5bGVzID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodG9Ob2RlKTsNCiAgICANCiAgICBjb25zdCBmcm9tV2lkdGggPSBwYXJzZUZsb2F0KGZyb21TdHlsZXMud2lkdGgpIHx8IDIwMDsNCiAgICBjb25zdCBmcm9tSGVpZ2h0ID0gcGFyc2VGbG9hdChmcm9tU3R5bGVzLmhlaWdodCkgfHwgODA7DQogICAgY29uc3QgdG9XaWR0aCA9IHBhcnNlRmxvYXQodG9TdHlsZXMud2lkdGgpIHx8IDIwMDsNCiAgICBjb25zdCB0b0hlaWdodCA9IHBhcnNlRmxvYXQodG9TdHlsZXMuaGVpZ2h0KSB8fCA4MDsNCiAgICANCiAgICAvLyBDYWxjdWxhdGUgY29ubmVjdGlvbiBwb3NpdGlvbnMgZGlyZWN0bHkgZnJvbSBub2RlIGRhdGEgKG5vIGV4dHJhIHRyYW5zZm9ybXMpDQogICAgLy8gRnJvbSBvdXRwdXQgcG9ydCAocmlnaHQgc2lkZSBvZiBmcm9tIG5vZGUsIG1pZGRsZSB2ZXJ0aWNhbGx5KQ0KICAgIGNvbnN0IGZyb21YID0gZnJvbU5vZGVEYXRhLnggKyBmcm9tV2lkdGg7DQogICAgY29uc3QgZnJvbVkgPSBmcm9tTm9kZURhdGEueSArIGZyb21IZWlnaHQgLyAyOw0KICAgIA0KICAgIC8vIFRvIGlucHV0IHBvcnQgKGxlZnQgc2lkZSBvZiB0byBub2RlLCBtaWRkbGUgdmVydGljYWxseSkgIA0KICAgIGNvbnN0IHRvWCA9IHRvTm9kZURhdGEueDsNCiAgICBjb25zdCB0b1kgPSB0b05vZGVEYXRhLnkgKyB0b0hlaWdodCAvIDI7DQogICAgDQogICAgDQogICAgLy8gVXBkYXRlIHRoZSBwYXRoDQogICAgY29uc3QgcGF0aCA9IGNvbm5lY3Rpb24uc3ZnLnF1ZXJ5U2VsZWN0b3IoJ3BhdGgnKTsNCiAgICBpZiAocGF0aCkgew0KICAgICAgICBjb25zdCBjb250cm9sUG9pbnQxWCA9IGZyb21YICsgKHRvWCAtIGZyb21YKSAqIDAuNTsNCiAgICAgICAgY29uc3QgY29udHJvbFBvaW50MlggPSBmcm9tWCArICh0b1ggLSBmcm9tWCkgKiAwLjU7DQogICAgICAgIGNvbnN0IHBhdGhEID0gYE0gJHtmcm9tWH0gJHtmcm9tWX0gQyAke2NvbnRyb2xQb2ludDFYfSAke2Zyb21ZfSAke2NvbnRyb2xQb2ludDJYfSAke3RvWX0gJHt0b1h9ICR7dG9ZfWA7DQogICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCdkJywgcGF0aEQpOw0KICAgIH0gZWxzZSB7DQogICAgfQ0KfQ0KDQovLyBSZWRyYXcgYWxsIGNvbm5lY3Rpb25zIChmb3Igd2luZG93IHJlc2l6ZSwgZXRjLikNCmZ1bmN0aW9uIHJlZHJhd0FsbENvbm5lY3Rpb25zKCkgew0KICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgIHVwZGF0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbik7DQogICAgfQ0KfQ0KDQovLyBEZWxldGUgYSBub2RlIGFuZCBhbGwgaXRzIGNvbm5lY3Rpb25zDQphc3luYyBmdW5jdGlvbiBkZWxldGVOb2RlKG5vZGVJZCkgew0KICAgIGNvbnN0IGNvbmZpcm1lZCA9IGF3YWl0IHN5cG5leEFQSS5zaG93Q29uZmlybWF0aW9uKA0KICAgICAgICAnRGVsZXRlIE5vZGUnLA0KICAgICAgICAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIG5vZGU/JywNCiAgICAgICAgew0KICAgICAgICAgICAgdHlwZTogJ2RhbmdlcicsDQogICAgICAgICAgICBjb25maXJtVGV4dDogJ0RlbGV0ZScsDQogICAgICAgICAgICBjYW5jZWxUZXh0OiAnQ2FuY2VsJywNCiAgICAgICAgICAgIGljb246ICdmYXMgZmEtY3ViZScNCiAgICAgICAgfQ0KICAgICk7DQogICAgDQogICAgaWYgKGNvbmZpcm1lZCkgew0KICAgICAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICAgICAgDQogICAgICAgIC8vIENsZWFuIHVwIGF1ZGlvIGVsZW1lbnRzIGlmIHRoaXMgaXMgYW4gYXVkaW8gbm9kZQ0KICAgICAgICBpZiAobm9kZSAmJiBub2RlLnR5cGUgPT09ICdhdWRpbycgJiYgbm9kZS5hdWRpb0VsZW1lbnQpIHsNCiAgICAgICAgICAgIC8vIFBhdXNlIGFuZCBzdG9wIHRoZSBhdWRpbw0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQucGF1c2UoKTsNCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LmN1cnJlbnRUaW1lID0gMDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUmVtb3ZlIGV2ZW50IGxpc3RlbmVycyBwcm9wZXJseQ0KICAgICAgICAgICAgaWYgKG5vZGUuYXVkaW9FdmVudExpc3RlbmVycykgew0KICAgICAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2VuZGVkJywgbm9kZS5hdWRpb0V2ZW50TGlzdGVuZXJzLmVuZGVkKTsNCiAgICAgICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIG5vZGUuYXVkaW9FdmVudExpc3RlbmVycy5lcnJvcik7DQogICAgICAgICAgICAgICAgbm9kZS5hdWRpb0V2ZW50TGlzdGVuZXJzID0gbnVsbDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gU3RvcmUgdGhlIHNyYyBiZWZvcmUgY2xlYXJpbmcgaXQgZm9yIGNsZWFudXANCiAgICAgICAgICAgIGNvbnN0IGF1ZGlvU3JjID0gbm9kZS5hdWRpb0VsZW1lbnQuc3JjOw0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gJyc7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFJldm9rZSBibG9iIFVSTCBpZiBpdCBleGlzdHMNCiAgICAgICAgICAgIGlmIChhdWRpb1NyYyAmJiBhdWRpb1NyYy5zdGFydHNXaXRoKCdibG9iOicpKSB7DQogICAgICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChhdWRpb1NyYyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENsZWFyIHRoZSBhdWRpbyBlbGVtZW50IHJlZmVyZW5jZQ0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQgPSBudWxsOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBSZW1vdmUgYWxsIGNvbm5lY3Rpb25zIGludm9sdmluZyB0aGlzIG5vZGUNCiAgICAgICAgY29uc3QgY29ubmVjdGlvbnNUb0RlbGV0ZSA9IFtdOw0KICAgICAgICBmb3IgKGNvbnN0IFtjb25uZWN0aW9uSWQsIGNvbm5lY3Rpb25dIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuZW50cmllcygpKSB7DQogICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkIHx8IGNvbm5lY3Rpb24udG8ubm9kZUlkID09PSBub2RlSWQpIHsNCiAgICAgICAgICAgICAgICBjb25uZWN0aW9uc1RvRGVsZXRlLnB1c2goY29ubmVjdGlvbklkKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gRGVsZXRlIGNvbm5lY3Rpb25zDQogICAgICAgIGZvciAoY29uc3QgY29ubmVjdGlvbklkIG9mIGNvbm5lY3Rpb25zVG9EZWxldGUpIHsNCiAgICAgICAgICAgIGRlbGV0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbklkKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gUmVtb3ZlIG5vZGUgZnJvbSBkYXRhIHN0cnVjdHVyZQ0KICAgICAgICBmbG93RWRpdG9yLm5vZGVzLmRlbGV0ZShub2RlSWQpOw0KICAgICAgICANCiAgICAgICAgLy8gUmVtb3ZlIG5vZGUgZWxlbWVudCBmcm9tIERPTQ0KICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgbm9kZUVsZW1lbnQucmVtb3ZlKCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIERlc2VsZWN0IGlmIHRoaXMgd2FzIHRoZSBzZWxlY3RlZCBub2RlDQogICAgICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9PT0gbm9kZUlkKSB7DQogICAgICAgICAgICBmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9IG51bGw7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZS1jb25maWcnKS5pbm5lckhUTUwgPSAnPHAgY2xhc3M9InRleHQtbXV0ZWQiPlNlbGVjdCBhIG5vZGUgdG8gY29uZmlndXJlIGl0PC9wPic7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgfQ0KfQ0KDQovLyBEZWxldGUgYSBjb25uZWN0aW9uDQpmdW5jdGlvbiBkZWxldGVDb25uZWN0aW9uKGNvbm5lY3Rpb25JZCkgew0KICAgIGNvbnN0IGNvbm5lY3Rpb24gPSBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmdldChjb25uZWN0aW9uSWQpOw0KICAgIGlmIChjb25uZWN0aW9uICYmIGNvbm5lY3Rpb24uc3ZnKSB7DQogICAgICAgIGNvbm5lY3Rpb24uc3ZnLnJlbW92ZSgpOw0KICAgIH0NCiAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmRlbGV0ZShjb25uZWN0aW9uSWQpOw0KfQ0KDQovLyBEZWxldGUgc2VsZWN0ZWQgbm9kZQ0KYXN5bmMgZnVuY3Rpb24gZGVsZXRlU2VsZWN0ZWROb2RlKCkgew0KICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSkgew0KICAgICAgICBhd2FpdCBkZWxldGVOb2RlKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlKTsNCiAgICB9DQp9DQoNCi8vIEhhbmRsZSBrZXlib2FyZCBzaG9ydGN1dHMNCmZ1bmN0aW9uIGhhbmRsZUtleURvd24oZSkgew0KICAgIGlmIChlLmtleSA9PT0gJ0RlbGV0ZScgfHwgKGUua2V5ID09PSAnQmFja3NwYWNlJyAmJiBlLmN0cmxLZXkpKSB7DQogICAgICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSkgew0KICAgICAgICAgICAgZGVsZXRlU2VsZWN0ZWROb2RlKCk7DQogICAgICAgIH0NCiAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnRXNjYXBlJykgew0KICAgICAgICAvLyBEZXNlbGVjdCBub2RlDQogICAgICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSkgew0KICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSk7DQogICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7DQogICAgICAgICAgICBmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9IG51bGw7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZS1jb25maWcnKS5pbm5lckhUTUwgPSAnPHAgY2xhc3M9InRleHQtbXV0ZWQiPlNlbGVjdCBhIG5vZGUgdG8gY29uZmlndXJlIGl0PC9wPic7DQogICAgICAgIH0NCiAgICB9IGVsc2UgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJ3MnICYmICFlLnNoaWZ0S2V5KSB7DQogICAgICAgIC8vIEN0cmwvQ21kICsgUzogU2F2ZQ0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvdygpOw0KICAgIH0gZWxzZSBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS5rZXkgPT09ICdTJykgew0KICAgICAgICAvLyBDdHJsL0NtZCArIFNoaWZ0ICsgUzogU2F2ZSBBcw0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvd0FzKCk7DQogICAgfSBlbHNlIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkgPT09ICdvJykgew0KICAgICAgICAvLyBDdHJsL0NtZCArIE86IExvYWQNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICB3aW5kb3cuZmlsZU1hbmFnZXIubG9hZEZsb3coKTsNCiAgICB9IGVsc2UgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJz0nKSB7DQogICAgICAgIC8vIEN0cmwvQ21kICsgPTogWm9vbSBJbg0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnpvb21JbigpOw0KICAgIH0gZWxzZSBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5ID09PSAnLScpIHsNCiAgICAgICAgLy8gQ3RybC9DbWQgKyAtOiBab29tIE91dA0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnpvb21PdXQoKTsNCiAgICB9IGVsc2UgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJzAnKSB7DQogICAgICAgIC8vIEN0cmwvQ21kICsgMDogUmVzZXQgem9vbSBhbmQgcGFuDQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgd2luZG93LmNhbnZhc01hbmFnZXIucmVzZXRDYW52YXNQYW4oKTsNCiAgICB9IGVsc2UgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiAoZS5zaGlmdEtleSkgJiYgZS5rZXkgPT09ICdGJykgew0KICAgICAgICAvLyBDdHJsL0NtZCArIFNoaWZ0ICsgRjogWm9vbSB0byBmaXQNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICB3aW5kb3cuY2FudmFzTWFuYWdlci56b29tVG9GaXQoKTsNCiAgICB9DQp9DQoNCi8vIEhhbmRsZSBwb3J0IG1vdXNlIGV2ZW50cyBmb3IgY29ubmVjdGlvbnMNCmZ1bmN0aW9uIGhhbmRsZVBvcnRNb3VzZURvd24oZSwgbm9kZUlkLCBwb3J0TmFtZSwgaXNPdXRwdXQpIHsNCiAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICANCiAgICBpZiAoaXNPdXRwdXQpIHsNCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbSA9IHsgbm9kZUlkLCBwb3J0TmFtZSB9Ow0KICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuYWRkKCdjb25uZWN0aW5nJyk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgaWYgKGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20pIHsNCiAgICAgICAgICAgIGNyZWF0ZUNvbm5lY3Rpb24oZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbS5ub2RlSWQsIGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20ucG9ydE5hbWUsIG5vZGVJZCwgcG9ydE5hbWUpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbSA9IG51bGw7DQogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmxvdy1ub2RlLXBvcnQnKS5mb3JFYWNoKHBvcnQgPT4gcG9ydC5jbGFzc0xpc3QucmVtb3ZlKCdjb25uZWN0aW5nJykpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBDcmVhdGUgYSBjb25uZWN0aW9uIGJldHdlZW4gbm9kZXMNCmZ1bmN0aW9uIGNyZWF0ZUNvbm5lY3Rpb24oZnJvbU5vZGVJZCwgZnJvbVBvcnQsIHRvTm9kZUlkLCB0b1BvcnQpIHsNCiAgICAvLyBDaGVjayBpZiBjb25uZWN0aW9uIGFscmVhZHkgZXhpc3RzDQogICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IGZyb21Ob2RlSWQgJiYgDQogICAgICAgICAgICBjb25uZWN0aW9uLmZyb20ucG9ydE5hbWUgPT09IGZyb21Qb3J0ICYmDQogICAgICAgICAgICBjb25uZWN0aW9uLnRvLm5vZGVJZCA9PT0gdG9Ob2RlSWQgJiYgDQogICAgICAgICAgICBjb25uZWN0aW9uLnRvLnBvcnROYW1lID09PSB0b1BvcnQpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICBjb25zdCBjb25uZWN0aW9uSWQgPSBgY29ubl8ke2Zyb21Ob2RlSWR9XyR7ZnJvbVBvcnR9XyR7dG9Ob2RlSWR9XyR7dG9Qb3J0fWA7DQogICAgY29uc3QgY29ubmVjdGlvbiA9IHsNCiAgICAgICAgaWQ6IGNvbm5lY3Rpb25JZCwNCiAgICAgICAgZnJvbTogeyBub2RlSWQ6IGZyb21Ob2RlSWQsIHBvcnROYW1lOiBmcm9tUG9ydCB9LA0KICAgICAgICB0bzogeyBub2RlSWQ6IHRvTm9kZUlkLCBwb3J0TmFtZTogdG9Qb3J0IH0NCiAgICB9Ow0KICAgIA0KICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuc2V0KGNvbm5lY3Rpb25JZCwgY29ubmVjdGlvbik7DQogICAgZHJhd0Nvbm5lY3Rpb24oY29ubmVjdGlvbik7DQogICAgDQp9DQoNCi8vIERyYXcgYSBjb25uZWN0aW9uIG9uIHRoZSBjYW52YXMNCmZ1bmN0aW9uIGRyYXdDb25uZWN0aW9uKGNvbm5lY3Rpb24pIHsNCiAgICBjb25zdCBmcm9tTm9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQpOw0KICAgIGNvbnN0IHRvTm9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICANCiAgICBpZiAoIWZyb21Ob2RlIHx8ICF0b05vZGUpIHJldHVybjsNCiAgICANCiAgICAvLyBDcmVhdGUgU1ZHIGVsZW1lbnQgZm9yIHRoZSBjb25uZWN0aW9uDQogICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTsNCiAgICBzdmcuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOw0KICAgIHN2Zy5zdHlsZS50b3AgPSAnMCc7DQogICAgc3ZnLnN0eWxlLmxlZnQgPSAnMCc7DQogICAgc3ZnLnN0eWxlLndpZHRoID0gJzEwMCUnOw0KICAgIHN2Zy5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7DQogICAgc3ZnLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSc7IC8vIERvbid0IGNhcHR1cmUgZXZlbnRzIGJ5IGRlZmF1bHQNCiAgICBzdmcuc3R5bGUuekluZGV4ID0gJzEnOw0KICAgIHN2Zy5kYXRhc2V0LmNvbm5lY3Rpb25JZCA9IGNvbm5lY3Rpb24uaWQ7DQogICAgDQogICAgY29uc3QgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncGF0aCcpOw0KICAgIHBhdGguc2V0QXR0cmlidXRlKCdzdHJva2UnLCAnIzRDQUY1MCcpOw0KICAgIHBhdGguc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMicpOw0KICAgIHBhdGguc2V0QXR0cmlidXRlKCdmaWxsJywgJ25vbmUnKTsNCiAgICBwYXRoLnNldEF0dHJpYnV0ZSgnbWFya2VyLWVuZCcsICd1cmwoI2Fycm93aGVhZCknKTsNCiAgICBwYXRoLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJzsNCiAgICBwYXRoLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnYXV0byc7IC8vIE9ubHkgdGhlIHBhdGggY2FwdHVyZXMgZXZlbnRzDQogICAgDQogICAgLy8gQWRkIGhvdmVyIGVmZmVjdHMNCiAgICBwYXRoLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7DQogICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnNCcpOw0KICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJyNmZjZiNmInKTsNCiAgICAgICAgLy8gU2hvdyBkZWxldGUgdG9vbHRpcA0KICAgICAgICBzaG93Q29ubmVjdGlvblRvb2x0aXAoY29ubmVjdGlvbi5pZCwgJ0NsaWNrIHRvIGRlbGV0ZSBjb25uZWN0aW9uJyk7DQogICAgfSk7DQogICAgDQogICAgcGF0aC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4gew0KICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzInKTsNCiAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICcjNENBRjUwJyk7DQogICAgICAgIGhpZGVDb25uZWN0aW9uVG9vbHRpcCgpOw0KICAgIH0pOw0KICAgIA0KICAgIC8vIEFkZCBjbGljayB0byBkZWxldGUNCiAgICBwYXRoLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHsNCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgY29uc3QgY29uZmlybWVkID0gYXdhaXQgc3lwbmV4QVBJLnNob3dDb25maXJtYXRpb24oDQogICAgICAgICAgICAnRGVsZXRlIENvbm5lY3Rpb24nLA0KICAgICAgICAgICAgJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyBjb25uZWN0aW9uPycsDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdHlwZTogJ2RhbmdlcicsDQogICAgICAgICAgICAgICAgY29uZmlybVRleHQ6ICdEZWxldGUnLA0KICAgICAgICAgICAgICAgIGNhbmNlbFRleHQ6ICdDYW5jZWwnLA0KICAgICAgICAgICAgICAgIGljb246ICdmYXMgZmEtbGluaycNCiAgICAgICAgICAgIH0NCiAgICAgICAgKTsNCiAgICAgICAgDQogICAgICAgIGlmIChjb25maXJtZWQpIHsNCiAgICAgICAgICAgIGRlbGV0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbi5pZCk7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICBzdmcuYXBwZW5kQ2hpbGQocGF0aCk7DQogICAgZmxvd0VkaXRvci5jYW52YXMuYXBwZW5kQ2hpbGQoc3ZnKTsNCiAgICANCiAgICAvLyBTdG9yZSBTVkcgcmVmZXJlbmNlDQogICAgY29ubmVjdGlvbi5zdmcgPSBzdmc7DQogICAgDQogICAgLy8gVXBkYXRlIGNvbm5lY3Rpb24gcG9zaXRpb24NCiAgICB1cGRhdGVDb25uZWN0aW9uKGNvbm5lY3Rpb24pOw0KfQ0KDQovLyBTaG93IGNvbm5lY3Rpb24gdG9vbHRpcA0KZnVuY3Rpb24gc2hvd0Nvbm5lY3Rpb25Ub29sdGlwKGNvbm5lY3Rpb25JZCwgbWVzc2FnZSkgew0KICAgIC8vIENoZWNrIGlmIGFwcCBpcyBzdGlsbCBhY3RpdmUNCiAgICBpZiAoIWZsb3dFZGl0b3IuaXNBY3RpdmUpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBSZW1vdmUgZXhpc3RpbmcgdG9vbHRpcA0KICAgIGhpZGVDb25uZWN0aW9uVG9vbHRpcCgpOw0KICAgIA0KICAgIGNvbnN0IHRvb2x0aXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICB0b29sdGlwLmNsYXNzTmFtZSA9ICdjb25uZWN0aW9uLXRvb2x0aXAnOw0KICAgIHRvb2x0aXAudGV4dENvbnRlbnQgPSBtZXNzYWdlOw0KICAgIHRvb2x0aXAuc3R5bGUuY3NzVGV4dCA9IGANCiAgICAgICAgcG9zaXRpb246IGZpeGVkOw0KICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuOCk7DQogICAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgICAgcGFkZGluZzogNHB4IDhweDsNCiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgICAgICBmb250LXNpemU6IDEycHg7DQogICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lOw0KICAgICAgICB6LWluZGV4OiAxMDAwMDsNCiAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsNCiAgICAgICAgZGlzcGxheTogbm9uZTsNCiAgICBgOw0KICAgIA0KICAgIHRvb2x0aXAuaWQgPSAnY29ubmVjdGlvbi10b29sdGlwJzsNCiAgICANCiAgICAvLyBUcnkgdG8gYXBwZW5kIHRvIGFwcCBjb250YWluZXIgZmlyc3QsIGZhbGxiYWNrIHRvIGJvZHkNCiAgICBjb25zdCBhcHBDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXBwLWNvbnRhaW5lcicpOw0KICAgIGNvbnN0IGNvbnRhaW5lciA9IGFwcENvbnRhaW5lciB8fCBkb2N1bWVudC5ib2R5Ow0KICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0b29sdGlwKTsNCiAgICANCiAgICAvLyBQb3NpdGlvbiB0b29sdGlwIG5lYXIgbW91c2UgKHdpbGwgYmUgdXBkYXRlZCBvbiBtb3VzZW1vdmUpDQogICAgY29uc3QgdG9vbHRpcE1vdXNlTW92ZUhhbmRsZXIgPSAoZSkgPT4gdXBkYXRlVG9vbHRpcFBvc2l0aW9uKGUpOw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRvb2x0aXBNb3VzZU1vdmVIYW5kbGVyKTsNCiAgICANCiAgICAvLyBTdG9yZSB0aGUgaGFuZGxlciByZWZlcmVuY2UgZm9yIGNsZWFudXANCiAgICB3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyID0gdG9vbHRpcE1vdXNlTW92ZUhhbmRsZXI7DQogICAgDQogICAgLy8gU2hvdyB0aGUgdG9vbHRpcCBhZnRlciBhIHNtYWxsIGRlbGF5IHRvIHByZXZlbnQgZmxpY2tlcmluZw0KICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICBpZiAodG9vbHRpcC5wYXJlbnROb2RlICYmIGZsb3dFZGl0b3IuaXNBY3RpdmUpIHsNCiAgICAgICAgICAgIHRvb2x0aXAuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIH0NCiAgICB9LCAxMCk7DQp9DQoNCi8vIFVwZGF0ZSB0b29sdGlwIHBvc2l0aW9uDQpmdW5jdGlvbiB1cGRhdGVUb29sdGlwUG9zaXRpb24oZSkgew0KICAgIGNvbnN0IHRvb2x0aXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29ubmVjdGlvbi10b29sdGlwJyk7DQogICAgaWYgKHRvb2x0aXApIHsNCiAgICAgICAgLy8gVXNlIHNjYWxlZCBjb29yZGluYXRlcyBmb3IgdG9vbHRpcCBwb3NpdGlvbmluZw0KICAgICAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOiANCiAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgdG9vbHRpcC5zdHlsZS5sZWZ0ID0gKG1vdXNlQ29vcmRzLnggKyAxMCkgKyAncHgnOw0KICAgICAgICB0b29sdGlwLnN0eWxlLnRvcCA9IChtb3VzZUNvb3Jkcy55IC0gMTApICsgJ3B4JzsNCiAgICB9DQp9DQoNCi8vIEhpZGUgY29ubmVjdGlvbiB0b29sdGlwDQpmdW5jdGlvbiBoaWRlQ29ubmVjdGlvblRvb2x0aXAoKSB7DQogICAgY29uc3QgdG9vbHRpcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25uZWN0aW9uLXRvb2x0aXAnKTsNCiAgICBpZiAodG9vbHRpcCkgew0KICAgICAgICAvLyBSZW1vdmUgdGhlIHNwZWNpZmljIGV2ZW50IGxpc3RlbmVyIHdlIGFkZGVkDQogICAgICAgIGlmICh3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyKSB7DQogICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyKTsNCiAgICAgICAgICAgIHdpbmRvdy5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIgPSBudWxsOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBIaWRlIGFuZCByZW1vdmUgdGhlIHRvb2x0aXANCiAgICAgICAgdG9vbHRpcC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICBpZiAodG9vbHRpcC5wYXJlbnROb2RlKSB7DQogICAgICAgICAgICB0b29sdGlwLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodG9vbHRpcCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIENsZWFyIHRoZSBjYW52YXMNCmFzeW5jIGZ1bmN0aW9uIGNsZWFyQ2FudmFzKCkgew0KICAgIGNvbnN0IGNvbmZpcm1lZCA9IGF3YWl0IHN5cG5leEFQSS5zaG93Q29uZmlybWF0aW9uKA0KICAgICAgICAnQ2xlYXIgQ2FudmFzJywNCiAgICAgICAgJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBjbGVhciB0aGUgY2FudmFzPyBUaGlzIHdpbGwgZGVsZXRlIGFsbCBub2RlcyBhbmQgY29ubmVjdGlvbnMuJywNCiAgICAgICAgew0KICAgICAgICAgICAgdHlwZTogJ2RhbmdlcicsDQogICAgICAgICAgICBjb25maXJtVGV4dDogJ0NsZWFyIEFsbCcsDQogICAgICAgICAgICBjYW5jZWxUZXh0OiAnQ2FuY2VsJywNCiAgICAgICAgICAgIGljb246ICdmYXMgZmEtdHJhc2gtYWx0Jw0KICAgICAgICB9DQogICAgKTsNCiAgICANCiAgICBpZiAoY29uZmlybWVkKSB7DQogICAgICAgIGNsZWFyQ2FudmFzU2lsZW50KCk7DQogICAgfQ0KfQ0KDQovLyBDbGVhciB0aGUgY2FudmFzIHdpdGhvdXQgY29uZmlybWF0aW9uICh1c2VkIGludGVybmFsbHkpDQpmdW5jdGlvbiBjbGVhckNhbnZhc1NpbGVudCgpIHsNCiAgICAvLyBIaWRlIGFueSBhY3RpdmUgdG9vbHRpcHMNCiAgICBoaWRlQ29ubmVjdGlvblRvb2x0aXAoKTsNCiAgICAgICAgDQogICAgICAgIC8vIENsZWFyIGFsbCBjb25uZWN0aW9ucw0KICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24uc3ZnKSB7DQogICAgICAgICAgICAgICAgY29ubmVjdGlvbi5zdmcucmVtb3ZlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5jbGVhcigpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgYWxsIG5vZGVzDQogICAgICAgIGZvciAoY29uc3Qgbm9kZUlkIG9mIGZsb3dFZGl0b3Iubm9kZXMua2V5cygpKSB7DQogICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5yZW1vdmUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBmbG93RWRpdG9yLm5vZGVzLmNsZWFyKCk7DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciBhbGwgdGFncw0KICAgICAgICBmb3IgKGNvbnN0IHRhZ0lkIG9mIGZsb3dFZGl0b3IudGFncy5rZXlzKCkpIHsNCiAgICAgICAgICAgIGNvbnN0IHRhZ0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWdJZCk7DQogICAgICAgICAgICBpZiAodGFnRWxlbWVudCkgew0KICAgICAgICAgICAgICAgIHRhZ0VsZW1lbnQucmVtb3ZlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZmxvd0VkaXRvci50YWdzLmNsZWFyKCk7DQogICAgICAgIA0KICAgICAgICAvLyBVcGRhdGUgdGFnIHBhbmVsIHRvIHJlZmxlY3QgY2xlYXJlZCB0YWdzDQogICAgICAgIGlmICh0eXBlb2Ygd2luZG93LnRhZ01hbmFnZXIudXBkYXRlVGFnUGFuZWwgPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgIHdpbmRvdy50YWdNYW5hZ2VyLnVwZGF0ZVRhZ1BhbmVsKCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFJlc2V0IGNvdW50ZXJzDQogICAgICAgIGZsb3dFZGl0b3Iubm9kZUNvdW50ZXIgPSAwOw0KICAgICAgICBmbG93RWRpdG9yLnRhZ0NvdW50ZXIgPSAwOw0KICAgICAgICBmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9IG51bGw7DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciBjdXJyZW50IGZpbGUgcGF0aA0KICAgICAgICBmbG93RWRpdG9yLmN1cnJlbnRGaWxlUGF0aCA9IG51bGw7DQogICAgICAgIA0KICAgICAgICAvLyBSZXNldCBwYW4gb2Zmc2V0IHRvIGNlbnRlciBvZiBsYXJnZSBjYW52YXMNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQgPSB7IHg6IC01MDAwLCB5OiAtNTAwMCB9Ow0KICAgICAgICANCiAgICAgICAgLy8gUmVzZXQgem9vbSBsZXZlbA0KICAgICAgICBmbG93RWRpdG9yLnpvb21MZXZlbCA9IDEuMDsNCiAgICAgICAgDQogICAgICAgIGlmICh0eXBlb2Ygd2luZG93LmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtID09PSAnZnVuY3Rpb24nKSB7DQogICAgICAgICAgICB3aW5kb3cuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gVXBkYXRlIGZpbGVuYW1lIGRpc3BsYXkNCiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuZmlsZU1hbmFnZXIudXBkYXRlRmlsZW5hbWVEaXNwbGF5ID09PSAnZnVuY3Rpb24nKSB7DQogICAgICAgICAgICB3aW5kb3cuZmlsZU1hbmFnZXIudXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIENsZWFyIGNvbmZpZyBwYW5lbA0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZS1jb25maWcnKS5pbm5lckhUTUwgPSAnPHAgY2xhc3M9InRleHQtbXV0ZWQiPlNlbGVjdCBhIG5vZGUgdG8gY29uZmlndXJlIGl0PC9wPic7DQp9IA0KDQoNCi8vIFNob3cgbm9kZSBjb25maWd1cmF0aW9uDQphc3luYyBmdW5jdGlvbiBzaG93Tm9kZUNvbmZpZyhub2RlSWQpIHsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUpIHJldHVybjsNCiAgICANCiAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgaWYgKCFub2RlRGVmKSByZXR1cm47DQoNCiAgICAvLyBMb2FkIHNhdmVkIGNvbmZpZ3VyYXRpb24gc2VjdGlvbiBzdGF0ZXMNCiAgICBsZXQgc2VjdGlvblN0YXRlcyA9IHt9Ow0KICAgIHRyeSB7DQogICAgICAgIGlmICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2V0dGluZykgew0KICAgICAgICAgICAgLy8gTG9hZCBzdGF0ZXMgZm9yIGFsbCBwb3NzaWJsZSBzZWN0aW9ucw0KICAgICAgICAgICAgY29uc3Qgc2VjdGlvbnMgPSBbJ25vZGUtY29udGVudCcsICdpbnB1dC1jb25uZWN0aW9ucycsICdvdXRwdXQtY29ubmVjdGlvbnMnLCAnbm9kZS1zZXR0aW5ncycsICdvdXRwdXQtZGF0YSddOw0KICAgICAgICAgICAgZm9yIChjb25zdCBzZWN0aW9uSWQgb2Ygc2VjdGlvbnMpIHsNCiAgICAgICAgICAgICAgICAvLyBEZWZhdWx0IHRvIGV4cGFuZGVkIGZvciBub2RlLWNvbnRlbnQsIGNvbGxhcHNlZCBmb3Igb3RoZXJzDQogICAgICAgICAgICAgICAgY29uc3QgZGVmYXVsdEV4cGFuZGVkID0gc2VjdGlvbklkID09PSAnbm9kZS1jb250ZW50JzsNCiAgICAgICAgICAgICAgICBzZWN0aW9uU3RhdGVzW3NlY3Rpb25JZF0gPSBhd2FpdCBzeXBuZXhBUEkuZ2V0U2V0dGluZyhgY29uZmlnX3NlY3Rpb25fJHtzZWN0aW9uSWR9YCwgZGVmYXVsdEV4cGFuZGVkKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGxvYWQgY29uZmlnIHNlY3Rpb24gc3RhdGVzOicsIGVycm9yKTsNCiAgICAgICAgLy8gVXNlIGRlZmF1bHRzIGlmIGxvYWRpbmcgZmFpbHMNCiAgICAgICAgc2VjdGlvblN0YXRlcyA9IHsNCiAgICAgICAgICAgICdub2RlLWNvbnRlbnQnOiB0cnVlLA0KICAgICAgICAgICAgJ2lucHV0LWNvbm5lY3Rpb25zJzogZmFsc2UsDQogICAgICAgICAgICAnb3V0cHV0LWNvbm5lY3Rpb25zJzogZmFsc2UsDQogICAgICAgICAgICAnbm9kZS1zZXR0aW5ncyc6IGZhbHNlLA0KICAgICAgICAgICAgJ291dHB1dC1kYXRhJzogZmFsc2UNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgLy8gU2hvdyBjb25maWcgcGFuZWwgd2l0aCBub2RlIGNvbmZpZ3VyYXRpb24NCiAgICBjb25zdCBjb25maWdQYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlLWNvbmZpZycpOw0KICAgIGlmIChjb25maWdQYW5lbCkgew0KICAgICAgICBsZXQgY29uZmlnSHRtbCA9IGA8aDQ+JHtub2RlRGVmLm5hbWV9IENvbmZpZ3VyYXRpb248L2g0PmA7DQogICAgICAgIA0KICAgICAgICAvLyBBZGQgc3BlY2lhbCBjb250ZW50IGRpc3BsYXkgZm9yIGRpZmZlcmVudCBub2RlIHR5cGVzDQogICAgICAgIGxldCBoYXNTcGVjaWFsQ29udGVudCA9IGZhbHNlOw0KICAgICAgICBsZXQgc3BlY2lhbENvbnRlbnRIdG1sID0gJyc7DQogICAgICAgIA0KICAgICAgICBpZiAobm9kZS50eXBlID09PSAnZGlzcGxheScgJiYgbm9kZS5sYXN0Q29udGVudCkgew0KICAgICAgICAgICAgaGFzU3BlY2lhbENvbnRlbnQgPSB0cnVlOw0KICAgICAgICAgICAgc3BlY2lhbENvbnRlbnRIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+TGFzdCBDb250ZW50PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udGVudC1kaXNwbGF5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxwcmUgY2xhc3M9ImNvbnRlbnQtdGV4dCI+JHtlc2NhcGVIdG1sKG5vZGUubGFzdENvbnRlbnQpfTwvcHJlPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udGVudC1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+Rm9ybWF0OiAke25vZGUubGFzdEZvcm1hdH0g4oCiIExlbmd0aDogJHtub2RlLmxhc3RDb250ZW50Lmxlbmd0aH0gY2hhcnM8L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09ICdpbWFnZScgJiYgbm9kZS5sYXN0SW1hZ2VEYXRhKSB7DQogICAgICAgICAgICBoYXNTcGVjaWFsQ29udGVudCA9IHRydWU7DQogICAgICAgICAgICBzcGVjaWFsQ29udGVudEh0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5JbWFnZSBQcmV2aWV3PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW1hZ2UtZGlzcGxheSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iJHtub2RlLmxhc3RJbWFnZVVybH0iIGFsdD0iSW1hZ2UgcHJldmlldyIgc3R5bGU9Im1heC13aWR0aDogMjAwcHg7IG1heC1oZWlnaHQ6IDE1MHB4OyBib3JkZXI6IDFweCBzb2xpZCAjY2NjOyBib3JkZXItcmFkaXVzOiA0cHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImltYWdlLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5TaXplOiAke25vZGUubGFzdEltYWdlSW5mbz8ud2lkdGggfHwgJz8nfXgke25vZGUubGFzdEltYWdlSW5mbz8uaGVpZ2h0IHx8ICc/J30g4oCiIEZvcm1hdDogJHtub2RlLmxhc3RJbWFnZUluZm8/LmZvcm1hdCB8fCAnPyd9PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tcHJpbWFyeSBtdC0yIHZpZXctZnVsbC1pbWFnZS1idG4iIGRhdGEtbm9kZS1pZD0iJHtub2RlSWR9Ij5WaWV3IEZ1bGwgSW1hZ2U8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9IGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ2F1ZGlvJyAmJiBub2RlLmxhc3RBdWRpb0RhdGEpIHsNCiAgICAgICAgICAgIGhhc1NwZWNpYWxDb250ZW50ID0gdHJ1ZTsNCiAgICAgICAgICAgIHNwZWNpYWxDb250ZW50SHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkF1ZGlvIENvbnRyb2xzPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXVkaW8tZGlzcGxheSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhdWRpby1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+QXVkaW8gbG9hZGVkIHN1Y2Nlc3NmdWxseTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImF1ZGlvLWNvbnRyb2xzIG10LTIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLXN1Y2Nlc3MgcGxheS1hdWRpby1idG4iIGRhdGEtbm9kZS1pZD0iJHtub2RlSWR9Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1wbGF5Ij48L2k+IFBsYXkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1kYW5nZXIgc3RvcC1hdWRpby1idG4iIGRhdGEtbm9kZS1pZD0iJHtub2RlSWR9Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1zdG9wIj48L2k+IFN0b3ANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0gZWxzZSBpZiAobm9kZS50eXBlID09PSAndmZzX2xvYWQnKSB7DQogICAgICAgICAgICBoYXNTcGVjaWFsQ29udGVudCA9IHRydWU7DQogICAgICAgICAgICBzcGVjaWFsQ29udGVudEh0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5WRlMgTG9hZCBTdGF0dXM8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ2ZnMtbG9hZC1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5MYXN0IGxvYWRlZDogJHtub2RlLmxhc3RMb2FkZWRGaWxlIHx8ICdOb25lJ308L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0gZWxzZSBpZiAobm9kZS50eXBlID09PSAnbGxtX2NoYXQnICYmIG5vZGUubGFzdFJlc3BvbnNlKSB7DQogICAgICAgICAgICBoYXNTcGVjaWFsQ29udGVudCA9IHRydWU7DQogICAgICAgICAgICBzcGVjaWFsQ29udGVudEh0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5MYXN0IFJlc3BvbnNlPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udGVudC1kaXNwbGF5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxwcmUgY2xhc3M9ImNvbnRlbnQtdGV4dCI+JHtlc2NhcGVIdG1sKG5vZGUubGFzdFJlc3BvbnNlKX08L3ByZT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQtaW5mbyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPlRva2VuczogJHtub2RlLmxhc3RVc2FnZT8udG90YWxfdG9rZW5zIHx8IDB9IOKAoiBNb2RlbDogJHtub2RlLmxhc3RNb2RlbCB8fCAnVW5rbm93bid9PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0gZWxzZSBpZiAobm9kZS50eXBlID09PSAncmVwZWF0ZXInKSB7DQogICAgICAgICAgICBoYXNTcGVjaWFsQ29udGVudCA9IHRydWU7DQogICAgICAgICAgICBjb25zdCBpc1J1bm5pbmcgPSBub2RlLnJlcGVhdGVyU3RhdGUgJiYgbm9kZS5yZXBlYXRlclN0YXRlLmlzUnVubmluZzsNCiAgICAgICAgICAgIGNvbnN0IGNvdW50ID0gbm9kZS5yZXBlYXRlclN0YXRlID8gbm9kZS5yZXBlYXRlclN0YXRlLmNvdW50IDogMDsNCiAgICAgICAgICAgIHNwZWNpYWxDb250ZW50SHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlJlcGVhdGVyIENvbnRyb2xzPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmVwZWF0ZXItZGlzcGxheSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyZXBlYXRlci1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+U3RhdHVzOiAke2lzUnVubmluZyA/ICdSdW5uaW5nJyA6ICdTdG9wcGVkJ30g4oCiIENvdW50OiAke2NvdW50fTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJlcGVhdGVyLWNvbnRyb2xzIG10LTIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLXN1Y2Nlc3Mgc3RhcnQtcmVwZWF0ZXItYnRuIiBkYXRhLW5vZGUtaWQ9IiR7bm9kZUlkfSIgJHtpc1J1bm5pbmcgPyAnZGlzYWJsZWQnIDogJyd9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXBsYXkiPjwvaT4gU3RhcnQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1kYW5nZXIgc3RvcC1yZXBlYXRlci1idG4iIGRhdGEtbm9kZS1pZD0iJHtub2RlSWR9IiAkeyFpc1J1bm5pbmcgPyAnZGlzYWJsZWQnIDogJyd9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXN0b3AiPjwvaT4gU3RvcA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gV3JhcCBzcGVjaWFsIGNvbnRlbnQgaW4gYSBjb2xsYXBzaWJsZSBzZWN0aW9uIGlmIHByZXNlbnQNCiAgICAgICAgaWYgKGhhc1NwZWNpYWxDb250ZW50KSB7DQogICAgICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gc2VjdGlvblN0YXRlc1snbm9kZS1jb250ZW50J107DQogICAgICAgICAgICBjb25zdCBoZWFkZXJDbGFzcyA9IGlzRXhwYW5kZWQgPyAnJyA6ICdjb2xsYXBzZWQnOw0KICAgICAgICAgICAgY29uc3QgaWNvbkNsYXNzID0gaXNFeHBhbmRlZCA/ICdmYXMgZmEtY2hldnJvbi1kb3duJyA6ICdmYXMgZmEtY2hldnJvbi1yaWdodCc7DQogICAgICAgICAgICBjb25zdCBjb250ZW50U3R5bGUgPSBpc0V4cGFuZGVkID8gJycgOiAnIHN0eWxlPSJkaXNwbGF5OiBub25lOyInOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWhlYWRlciAke2hlYWRlckNsYXNzfSIgZGF0YS1zZWN0aW9uPSJub2RlLWNvbnRlbnQiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9IiR7aWNvbkNsYXNzfSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+Tm9kZSBDb250ZW50PC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24tY29udGVudCIgaWQ9Im5vZGUtY29udGVudC1jb250ZW50IiR7Y29udGVudFN0eWxlfT4NCiAgICAgICAgICAgICAgICAgICAgICAgICR7c3BlY2lhbENvbnRlbnRIdG1sfQ0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFNob3cgaW5wdXQgbWFwcGluZ3MgY29uZmlndXJhdGlvbiAod2hhdCB0aGlzIG5vZGUgcmVjZWl2ZXMgZnJvbSBvdGhlciBub2RlcykNCiAgICAgICAgY29uc3QgaW5wdXRDb25uZWN0aW9ucyA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkNCiAgICAgICAgICAgIC5maWx0ZXIoY29ubiA9PiBjb25uLnRvLm5vZGVJZCA9PT0gbm9kZUlkKTsNCiAgICAgICAgDQogICAgICAgIGlmIChpbnB1dENvbm5lY3Rpb25zLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSBzZWN0aW9uU3RhdGVzWydpbnB1dC1jb25uZWN0aW9ucyddOw0KICAgICAgICAgICAgY29uc3QgaGVhZGVyQ2xhc3MgPSBpc0V4cGFuZGVkID8gJycgOiAnY29sbGFwc2VkJzsNCiAgICAgICAgICAgIGNvbnN0IGljb25DbGFzcyA9IGlzRXhwYW5kZWQgPyAnZmFzIGZhLWNoZXZyb24tZG93bicgOiAnZmFzIGZhLWNoZXZyb24tcmlnaHQnOw0KICAgICAgICAgICAgY29uc3QgY29udGVudFN0eWxlID0gaXNFeHBhbmRlZCA/ICcnIDogJyBzdHlsZT0iZGlzcGxheTogbm9uZTsiJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24iPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbi1oZWFkZXIgJHtoZWFkZXJDbGFzc30iIGRhdGEtc2VjdGlvbj0iaW5wdXQtY29ubmVjdGlvbnMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9IiR7aWNvbkNsYXNzfSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+SW5wdXQgQ29ubmVjdGlvbnM8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c21hbGwgY2xhc3M9ImNvbmZpZy1jb3VudCI+KCR7aW5wdXRDb25uZWN0aW9ucy5sZW5ndGh9KTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbi1jb250ZW50IiBpZD0iaW5wdXQtY29ubmVjdGlvbnMtY29udGVudCIke2NvbnRlbnRTdHlsZX0+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnB1dC1tYXBwaW5ncy1jb25maWciPg0KICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZm9yIChjb25zdCBjb25uIG9mIGlucHV0Q29ubmVjdGlvbnMpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2VOb2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubi5mcm9tLm5vZGVJZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgc291cmNlTm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShzb3VyY2VOb2RlPy50eXBlIHx8ICd1bmtub3duJyk7DQogICAgICAgICAgICAgICAgY29uc3Qgc291cmNlTm9kZU5hbWUgPSBzb3VyY2VOb2RlRGVmPy5uYW1lIHx8IHNvdXJjZU5vZGU/LnR5cGUgfHwgJ3Vua25vd24nOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkT3V0cHV0ID0gc291cmNlTm9kZURlZj8ub3V0cHV0cz8uZmluZChvdXRwdXQgPT4gb3V0cHV0LmlkID09PSBjb25uLmZyb20ucG9ydE5hbWUpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dE5hbWUgPSBzZWxlY3RlZE91dHB1dCA/IHNlbGVjdGVkT3V0cHV0Lm5hbWUgOiBjb25uLmZyb20ucG9ydE5hbWU7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gU2ltcGxlOiBTaG93IHdoYXQgSSdtIHJlY2VpdmluZyBhbmQgbGV0IG1lIGNob29zZSBteSBpbnB1dCBwb3J0DQogICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImlucHV0LW1hcHBpbmctY29uZmlnIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbm5lY3Rpb24taGVhZGVyIj5Gcm9tICR7c291cmNlTm9kZU5hbWV9ICgke291dHB1dE5hbWV9KTwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29ubmVjdGlvbi1jb250cm9scyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udHJvbC1yb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+VG8gbXkgaW5wdXQ6PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0iaW5wdXRfdGFyZ2V0XyR7bm9kZUlkfXwke2Nvbm4udG8ucG9ydE5hbWV9IiBjbGFzcz0iaW5wdXQtdGFyZ2V0LXNlbGVjdCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPlNlbGVjdC4uLjwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtub2RlRGVmLmlucHV0cy5tYXAoaW5wdXQgPT4gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYDxvcHRpb24gdmFsdWU9IiR7aW5wdXQuaWR9IiAke2Nvbm4udG8ucG9ydE5hbWUgPT09IGlucHV0LmlkID8gJ3NlbGVjdGVkJyA6ICcnfT4ke2lucHV0Lm5hbWV9PC9vcHRpb24+YA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5qb2luKCcnKX0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBTaG93IG91dHB1dCBtYXBwaW5ncyBjb25maWd1cmF0aW9uICh3aGF0IG90aGVyIG5vZGVzIHJlY2VpdmUgZnJvbSB0aGlzIG5vZGUpDQogICAgICAgIGNvbnN0IG91dHB1dENvbm5lY3Rpb25zID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKQ0KICAgICAgICAgICAgLmZpbHRlcihjb25uID0+IGNvbm4uZnJvbS5ub2RlSWQgPT09IG5vZGVJZCk7DQogICAgICAgIA0KICAgICAgICBpZiAob3V0cHV0Q29ubmVjdGlvbnMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9IHNlY3Rpb25TdGF0ZXNbJ291dHB1dC1jb25uZWN0aW9ucyddOw0KICAgICAgICAgICAgY29uc3QgaGVhZGVyQ2xhc3MgPSBpc0V4cGFuZGVkID8gJycgOiAnY29sbGFwc2VkJzsNCiAgICAgICAgICAgIGNvbnN0IGljb25DbGFzcyA9IGlzRXhwYW5kZWQgPyAnZmFzIGZhLWNoZXZyb24tZG93bicgOiAnZmFzIGZhLWNoZXZyb24tcmlnaHQnOw0KICAgICAgICAgICAgY29uc3QgY29udGVudFN0eWxlID0gaXNFeHBhbmRlZCA/ICcnIDogJyBzdHlsZT0iZGlzcGxheTogbm9uZTsiJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24iPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbi1oZWFkZXIgJHtoZWFkZXJDbGFzc30iIGRhdGEtc2VjdGlvbj0ib3V0cHV0LWNvbm5lY3Rpb25zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSIke2ljb25DbGFzc30iPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPk91dHB1dCBDb25uZWN0aW9uczwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbCBjbGFzcz0iY29uZmlnLWNvdW50Ij4oJHtvdXRwdXRDb25uZWN0aW9ucy5sZW5ndGh9KTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbi1jb250ZW50IiBpZD0ib3V0cHV0LWNvbm5lY3Rpb25zLWNvbnRlbnQiJHtjb250ZW50U3R5bGV9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ib3V0cHV0LW1hcHBpbmdzLWNvbmZpZyI+DQogICAgICAgICAgICBgOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm4gb2Ygb3V0cHV0Q29ubmVjdGlvbnMpIHsNCiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubi50by5ub2RlSWQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUodGFyZ2V0Tm9kZT8udHlwZSB8fCAndW5rbm93bicpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGVOYW1lID0gdGFyZ2V0Tm9kZURlZj8ubmFtZSB8fCB0YXJnZXROb2RlPy50eXBlIHx8ICd1bmtub3duJzsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBHZXQgYXZhaWxhYmxlIG91dHB1dHMgZnJvbSBUSElTIG5vZGUgKHNvdXJjZSBub2RlKQ0KICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZU5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICAgICAgICAgICAgICBjb25zdCBhdmFpbGFibGVPdXRwdXRzID0gc291cmNlTm9kZURlZj8ub3V0cHV0cyB8fCBbXTsNCiAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ib3V0cHV0LW1hcHBpbmctY29uZmlnIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbm5lY3Rpb24taGVhZGVyIj5UbyAke3RhcmdldE5vZGVOYW1lfTwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29ubmVjdGlvbi1jb250cm9scyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udHJvbC1yb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+U2VuZCBvdXRwdXQ6PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0ib3V0cHV0X21hcHBpbmdfJHtub2RlSWR9fCR7Y29ubi5mcm9tLnBvcnROYW1lfXwke2Nvbm4udG8ubm9kZUlkfSIgY2xhc3M9Im91dHB1dC1tYXBwaW5nLXNlbGVjdCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPlNlbGVjdC4uLjwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHthdmFpbGFibGVPdXRwdXRzLm1hcChvdXRwdXQgPT4gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYDxvcHRpb24gdmFsdWU9IiR7b3V0cHV0LmlkfSIgJHtjb25uLmZyb20ucG9ydE5hbWUgPT09IG91dHB1dC5pZCA/ICdzZWxlY3RlZCcgOiAnJ30+JHtvdXRwdXQubmFtZX08L29wdGlvbj5gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmpvaW4oJycpfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEdlbmVyYXRlIGNvbmZpZ3VyYXRpb24gZmllbGRzIC0gZ3JvdXBlZCBmb3IgYmV0dGVyIG9yZ2FuaXphdGlvbg0KICAgICAgICBjb25zdCBjb25maWdFbnRyaWVzID0gT2JqZWN0LmVudHJpZXMobm9kZURlZi5jb25maWcpOw0KICAgICAgICBpZiAoY29uZmlnRW50cmllcy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gc2VjdGlvblN0YXRlc1snbm9kZS1zZXR0aW5ncyddOw0KICAgICAgICAgICAgY29uc3QgaGVhZGVyQ2xhc3MgPSBpc0V4cGFuZGVkID8gJycgOiAnY29sbGFwc2VkJzsNCiAgICAgICAgICAgIGNvbnN0IGljb25DbGFzcyA9IGlzRXhwYW5kZWQgPyAnZmFzIGZhLWNoZXZyb24tZG93bicgOiAnZmFzIGZhLWNoZXZyb24tcmlnaHQnOw0KICAgICAgICAgICAgY29uc3QgY29udGVudFN0eWxlID0gaXNFeHBhbmRlZCA/ICcnIDogJyBzdHlsZT0iZGlzcGxheTogbm9uZTsiJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24iPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbi1oZWFkZXIgJHtoZWFkZXJDbGFzc30iIGRhdGEtc2VjdGlvbj0ibm9kZS1zZXR0aW5ncyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iJHtpY29uQ2xhc3N9Ij48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5Ob2RlIFNldHRpbmdzPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsIGNsYXNzPSJjb25maWctY291bnQiPigke2NvbmZpZ0VudHJpZXMubGVuZ3RofSk8L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24tY29udGVudCIgaWQ9Im5vZGUtc2V0dGluZ3MtY29udGVudCIke2NvbnRlbnRTdHlsZX0+DQogICAgICAgICAgICBgOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBmb3IgKGNvbnN0IFtrZXksIGNvbmZpZ10gb2YgY29uZmlnRW50cmllcykgew0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0iY29uZmlnXyR7bm9kZUlkfV8ke2tleX0iPiR7Y29uZmlnLmxhYmVsfTwvbGFiZWw+DQogICAgICAgICAgICAgICAgYDsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLnR5cGUgPT09ICdzZWxlY3QnKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDxzZWxlY3QgaWQ9ImNvbmZpZ18ke25vZGVJZH1fJHtrZXl9Ij5gOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3Igbm9kZV9yZWZlcmVuY2Ugbm9kZQ0KICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnbm9kZV9yZWZlcmVuY2UnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSAnc291cmNlX25vZGVfaWQnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUG9wdWxhdGUgd2l0aCBhbGwgYXZhaWxhYmxlIG5vZGVzIChleGNsdWRpbmcgdGhpcyBub2RlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDxvcHRpb24gdmFsdWU9IiI+U2VsZWN0IGEgbm9kZS4uLjwvb3B0aW9uPmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBbYXZhaWxhYmxlTm9kZUlkLCBhdmFpbGFibGVOb2RlXSBvZiBmbG93RWRpdG9yLm5vZGVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdmFpbGFibGVOb2RlSWQgIT09IG5vZGVJZCkgeyAvLyBEb24ndCBpbmNsdWRlIHNlbGYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF2YWlsYWJsZU5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUoYXZhaWxhYmxlTm9kZS50eXBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVOYW1lID0gYXZhaWxhYmxlTm9kZURlZiA/IGF2YWlsYWJsZU5vZGVEZWYubmFtZSA6IGF2YWlsYWJsZU5vZGUudHlwZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkID0gbm9kZS5jb25maWdba2V5XS52YWx1ZSA9PT0gYXZhaWxhYmxlTm9kZUlkID8gJ3NlbGVjdGVkJyA6ICcnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPG9wdGlvbiB2YWx1ZT0iJHthdmFpbGFibGVOb2RlSWR9IiAke3NlbGVjdGVkfT4ke25vZGVOYW1lfSAoJHthdmFpbGFibGVOb2RlSWR9KTwvb3B0aW9uPmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ291dHB1dF9wb3J0X2lkJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBvcHVsYXRlIHdpdGggb3V0cHV0IHBvcnRzIG9mIHRoZSBzZWxlY3RlZCBzb3VyY2Ugbm9kZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDxvcHRpb24gdmFsdWU9IiI+U2VsZWN0IG91dHB1dCBwb3J0Li4uPC9vcHRpb24+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZE5vZGVJZCA9IG5vZGUuY29uZmlnLnNvdXJjZV9ub2RlX2lkLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZE5vZGVJZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZE5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChzZWxlY3RlZE5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZE5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkTm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShzZWxlY3RlZE5vZGUudHlwZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWROb2RlRGVmICYmIHNlbGVjdGVkTm9kZURlZi5vdXRwdXRzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBvdXRwdXQgb2Ygc2VsZWN0ZWROb2RlRGVmLm91dHB1dHMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBub2RlLmNvbmZpZ1trZXldLnZhbHVlID09PSBvdXRwdXQuaWQgPyAnc2VsZWN0ZWQnIDogJyc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDxvcHRpb24gdmFsdWU9IiR7b3V0cHV0LmlkfSIgJHtzZWxlY3RlZH0+JHtvdXRwdXQubmFtZX0gKCR7b3V0cHV0LnR5cGV9KTwvb3B0aW9uPmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWd1bGFyIHNlbGVjdCBmaWVsZA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZy5vcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBub2RlLmNvbmZpZ1trZXldLnZhbHVlID09PSBvcHRpb24gPyAnc2VsZWN0ZWQnIDogJyc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDxvcHRpb24gdmFsdWU9IiR7b3B0aW9ufSIgJHtzZWxlY3RlZH0+JHtvcHRpb259PC9vcHRpb24+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlZ3VsYXIgc2VsZWN0IGZpZWxkIGZvciBvdGhlciBub2Rlcw0KICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLm9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkID0gbm9kZS5jb25maWdba2V5XS52YWx1ZSA9PT0gb3B0aW9uID8gJ3NlbGVjdGVkJyA6ICcnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDxvcHRpb24gdmFsdWU9IiR7b3B0aW9ufSIgJHtzZWxlY3RlZH0+JHtvcHRpb259PC9vcHRpb24+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8L3NlbGVjdD5gOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnR5cGUgPT09ICd0ZXh0YXJlYScpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPHRleHRhcmVhIGlkPSJjb25maWdfJHtub2RlSWR9XyR7a2V5fSI+JHtub2RlLmNvbmZpZ1trZXldLnZhbHVlfTwvdGV4dGFyZWE+YDsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy50eXBlID09PSAnbnVtYmVyJykgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBtaW4gPSBjb25maWcubWluID8gYCBtaW49IiR7Y29uZmlnLm1pbn0iYCA6ICcnOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXggPSBjb25maWcubWF4ID8gYCBtYXg9IiR7Y29uZmlnLm1heH0iYCA6ICcnOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGVwID0gY29uZmlnLnN0ZXAgPyBgIHN0ZXA9IiR7Y29uZmlnLnN0ZXB9ImAgOiAnJzsNCiAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPGlucHV0IHR5cGU9Im51bWJlciIgaWQ9ImNvbmZpZ18ke25vZGVJZH1fJHtrZXl9IiB2YWx1ZT0iJHtub2RlLmNvbmZpZ1trZXldLnZhbHVlfSIke21pbn0ke21heH0ke3N0ZXB9PmA7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPGlucHV0IHR5cGU9IiR7Y29uZmlnLnR5cGV9IiBpZD0iY29uZmlnXyR7bm9kZUlkfV8ke2tleX0iIHZhbHVlPSIke25vZGUuY29uZmlnW2tleV0udmFsdWV9Ij5gOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8L2Rpdj5gOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBTaG93IG91dHB1dCBkYXRhIGZvciBhbGwgcG9ydHMgKGlmIG5vZGUgaGFzIGJlZW4gZXhlY3V0ZWQpIC0gYXQgdGhlIGJvdHRvbQ0KICAgICAgICBpZiAobm9kZS5sYXN0T3V0cHV0RGF0YSAmJiBub2RlLmxhc3RFeGVjdXRpb25UaW1lKSB7DQogICAgICAgICAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgICAgICAgICBjb25zdCBvdXRwdXRzID0gbm9kZURlZi5vdXRwdXRzIHx8IFtdOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAob3V0cHV0cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9IHNlY3Rpb25TdGF0ZXNbJ291dHB1dC1kYXRhJ107DQogICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyQ2xhc3MgPSBpc0V4cGFuZGVkID8gJycgOiAnY29sbGFwc2VkJzsNCiAgICAgICAgICAgICAgICBjb25zdCBpY29uQ2xhc3MgPSBpc0V4cGFuZGVkID8gJ2ZhcyBmYS1jaGV2cm9uLWRvd24nIDogJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50U3R5bGUgPSBpc0V4cGFuZGVkID8gJycgOiAnIHN0eWxlPSJkaXNwbGF5OiBub25lOyInOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbi1oZWFkZXIgJHtoZWFkZXJDbGFzc30iIGRhdGEtc2VjdGlvbj0ib3V0cHV0LWRhdGEiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSIke2ljb25DbGFzc30iPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5PdXRwdXQgRGF0YTwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGwgY2xhc3M9ImNvbmZpZy1jb3VudCI+KCR7b3V0cHV0cy5sZW5ndGh9IHBvcnRzKTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWNvbnRlbnQiIGlkPSJvdXRwdXQtZGF0YS1jb250ZW50IiR7Y29udGVudFN0eWxlfT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDEycHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgbWFyZ2luLWJvdHRvbTogOHB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExhc3QgZXhlY3V0ZWQ6ICR7bmV3IERhdGUobm9kZS5sYXN0RXhlY3V0aW9uVGltZSkudG9Mb2NhbGVTdHJpbmcoKX0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgb3V0cHV0IG9mIG91dHB1dHMpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0RGF0YSA9IGdldE91dHB1dFBvcnREYXRhKG5vZGUuaWQsIG91dHB1dC5pZCk7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdERhdGFQcmV2aWV3KG91dHB1dERhdGEpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50LWRpc3BsYXkiIHN0eWxlPSJtYXJnaW4tYm90dG9tOiA4cHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXdlaWdodDogNTAwOyBtYXJnaW4tYm90dG9tOiA2cHg7IGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsgZm9udC1zaXplOiAxM3B4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7b3V0cHV0Lm5hbWV9IDxzcGFuIHN0eWxlPSJjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtd2VpZ2h0OiBub3JtYWw7IGZvbnQtc2l6ZTogMTFweDsiPigke2Zvcm1hdHRlZC50eXBlfSk8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHByZSBjbGFzcz0iY29udGVudC10ZXh0IiBzdHlsZT0ibWFyZ2luLWJvdHRvbTogNHB4OyBtYXgtaGVpZ2h0OiA4MHB4OyI+JHtlc2NhcGVIdG1sKGZvcm1hdHRlZC5wcmV2aWV3KX08L3ByZT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2Zvcm1hdHRlZC5sZW5ndGggIT09IHVuZGVmaW5lZCA/IGA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDExcHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsiPkxlbmd0aDogJHtmb3JtYXR0ZWQubGVuZ3RofTwvZGl2PmAgOiAnJ30NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2Zvcm1hdHRlZC5rZXlzICE9PSB1bmRlZmluZWQgPyBgPGRpdiBzdHlsZT0iZm9udC1zaXplOiAxMXB4OyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7Ij5LZXlzOiAke2Zvcm1hdHRlZC5rZXlzfTwvZGl2PmAgOiAnJ30NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2Zvcm1hdHRlZC5zaXplICE9PSB1bmRlZmluZWQgPyBgPGRpdiBzdHlsZT0iZm9udC1zaXplOiAxMXB4OyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7Ij5TaXplOiAkeyhmb3JtYXR0ZWQuc2l6ZSAvIDEwMjQpLnRvRml4ZWQoMil9IEtCPC9kaXY+YCA6ICcnfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7Zm9ybWF0dGVkLmVzdGltYXRlZFNpemUgIT09IHVuZGVmaW5lZCA/IGA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDExcHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsiPkVzdC4gU2l6ZTogJHsoZm9ybWF0dGVkLmVzdGltYXRlZFNpemUgLyAxMDI0KS50b0ZpeGVkKDIpfSBLQjwvZGl2PmAgOiAnJ30NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25maWdQYW5lbC5pbm5lckhUTUwgPSBjb25maWdIdG1sOw0KICAgICAgICANCiAgICAgICAgLy8gQWRkIGV2ZW50IGxpc3RlbmVycyBmb3IgbWFwcGluZyBzZWxlY3RzDQogICAgICAgIC8vIE5vIGlucHV0IG1hcHBpbmcgc2VsZWN0cyBhbnltb3JlIC0gbm9kZXMgY2FuJ3QgY29udHJvbCB3aGF0IHRoZXkgcmVjZWl2ZQ0KICAgICAgICANCiAgICAgICAgY29uc3QgaW5wdXRUYXJnZXRTZWxlY3RzID0gY29uZmlnUGFuZWwucXVlcnlTZWxlY3RvckFsbCgnLmlucHV0LXRhcmdldC1zZWxlY3QnKTsNCiAgICAgICAgaW5wdXRUYXJnZXRTZWxlY3RzLmZvckVhY2goc2VsZWN0ID0+IHsNCiAgICAgICAgICAgIHNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IFtub2RlSWQsIGN1cnJlbnRJbnB1dFBvcnRdID0gZS50YXJnZXQuaWQucmVwbGFjZSgnaW5wdXRfdGFyZ2V0XycsICcnKS5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkSW5wdXRQb3J0ID0gZS50YXJnZXQudmFsdWU7DQogICAgICAgICAgICAgICAgLy8gRmluZCB0aGUgY29ubmVjdGlvbg0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLmZpbmQoY29ubiA9Pg0KICAgICAgICAgICAgICAgICAgICBjb25uLnRvLm5vZGVJZCA9PT0gbm9kZUlkICYmIGNvbm4udG8ucG9ydE5hbWUgPT09IGN1cnJlbnRJbnB1dFBvcnQNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uICYmIHNlbGVjdGVkSW5wdXRQb3J0KSB7DQogICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBhbGwgY29ubmVjdGlvbnMgZnJvbSB0aGUgc2FtZSBmcm9tTm9kZSB0byB0aGlzIG5vZGUgKHJlZ2FyZGxlc3Mgb2YgcG9ydCkNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbnNUb1JlbW92ZSA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkuZmlsdGVyKGNvbm4gPT4NCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbm4uZnJvbS5ub2RlSWQgPT09IGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgJiYgY29ubi50by5ub2RlSWQgPT09IG5vZGVJZA0KICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICBjb25uZWN0aW9uc1RvUmVtb3ZlLmZvckVhY2goY29ubiA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmRlbGV0ZShjb25uLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25uLnN2ZykgY29ubi5zdmcucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIG5ldyBjb25uZWN0aW9uDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0Nvbm5lY3Rpb25JZCA9IGBjb25uXyR7Y29ubmVjdGlvbi5mcm9tLm5vZGVJZH1fJHtjb25uZWN0aW9uLmZyb20ucG9ydE5hbWV9XyR7bm9kZUlkfV8ke3NlbGVjdGVkSW5wdXRQb3J0fWA7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0Nvbm5lY3Rpb24gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZDogbmV3Q29ubmVjdGlvbklkLA0KICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogeyBub2RlSWQ6IGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQsIHBvcnROYW1lOiBjb25uZWN0aW9uLmZyb20ucG9ydE5hbWUgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvOiB7IG5vZGVJZDogbm9kZUlkLCBwb3J0TmFtZTogc2VsZWN0ZWRJbnB1dFBvcnQgfQ0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnNldChuZXdDb25uZWN0aW9uSWQsIG5ld0Nvbm5lY3Rpb24pOw0KICAgICAgICAgICAgICAgICAgICBkcmF3Q29ubmVjdGlvbihuZXdDb25uZWN0aW9uKTsNCiAgICAgICAgICAgICAgICAgICAgLy8gQXV0by1zYXZlDQogICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuc2F2ZUZsb3cpIHdpbmRvdy5zYXZlRmxvdygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IG91dHB1dE1hcHBpbmdTZWxlY3RzID0gY29uZmlnUGFuZWwucXVlcnlTZWxlY3RvckFsbCgnLm91dHB1dC1tYXBwaW5nLXNlbGVjdCcpOw0KICAgICAgICBvdXRwdXRNYXBwaW5nU2VsZWN0cy5mb3JFYWNoKHNlbGVjdCA9PiB7DQogICAgICAgICAgICBzZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IGUudGFyZ2V0LmlkLnJlcGxhY2UoJ291dHB1dF9tYXBwaW5nXycsICcnKS5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IHBhcnRzWzBdOw0KICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dFBvcnQgPSBwYXJ0c1sxXTsNCiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlSWQgPSBwYXJ0c1syXTsNCiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZE91dHB1dFBvcnQgPSBlLnRhcmdldC52YWx1ZTsNCiAgICAgICAgICAgICAgICB1cGRhdGVPdXRwdXRNYXBwaW5nKG5vZGVJZCwgb3V0cHV0UG9ydCwgdGFyZ2V0Tm9kZUlkLCBzZWxlY3RlZE91dHB1dFBvcnQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgLy8gQWRkIGV2ZW50IGxpc3RlbmVycyBmb3Igc3BlY2lhbCBidXR0b25zDQogICAgICAgIGNvbnN0IHZpZXdGdWxsSW1hZ2VCdG4gPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yKCcudmlldy1mdWxsLWltYWdlLWJ0bicpOw0KICAgICAgICBpZiAodmlld0Z1bGxJbWFnZUJ0bikgew0KICAgICAgICAgICAgdmlld0Z1bGxJbWFnZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW5vZGUtaWQnKTsNCiAgICAgICAgICAgICAgICBzaG93RnVsbEltYWdlKG5vZGVJZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgY29uc3QgcGxheUF1ZGlvQnRuID0gY29uZmlnUGFuZWwucXVlcnlTZWxlY3RvcignLnBsYXktYXVkaW8tYnRuJyk7DQogICAgICAgIGlmIChwbGF5QXVkaW9CdG4pIHsNCiAgICAgICAgICAgIHBsYXlBdWRpb0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW5vZGUtaWQnKTsNCiAgICAgICAgICAgICAgICBwbGF5QXVkaW8obm9kZUlkKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25zdCBzdG9wQXVkaW9CdG4gPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yKCcuc3RvcC1hdWRpby1idG4nKTsNCiAgICAgICAgaWYgKHN0b3BBdWRpb0J0bikgew0KICAgICAgICAgICAgc3RvcEF1ZGlvQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS1pZCcpOw0KICAgICAgICAgICAgICAgIHN0b3BBdWRpbyhub2RlSWQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHN0YXJ0UmVwZWF0ZXJCdG4gPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yKCcuc3RhcnQtcmVwZWF0ZXItYnRuJyk7DQogICAgICAgIGlmIChzdGFydFJlcGVhdGVyQnRuKSB7DQogICAgICAgICAgICBzdGFydFJlcGVhdGVyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS1pZCcpOw0KICAgICAgICAgICAgICAgIHN0YXJ0UmVwZWF0ZXIobm9kZUlkKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25zdCBzdG9wUmVwZWF0ZXJCdG4gPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yKCcuc3RvcC1yZXBlYXRlci1idG4nKTsNCiAgICAgICAgaWYgKHN0b3BSZXBlYXRlckJ0bikgew0KICAgICAgICAgICAgc3RvcFJlcGVhdGVyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS1pZCcpOw0KICAgICAgICAgICAgICAgIHN0b3BSZXBlYXRlcihub2RlSWQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBjaGFuZ2UgbGlzdGVuZXJzDQogICAgICAgIGZvciAoY29uc3QgW2tleSwgY29uZmlnXSBvZiBPYmplY3QuZW50cmllcyhub2RlRGVmLmNvbmZpZykpIHsNCiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgY29uZmlnXyR7bm9kZUlkfV8ke2tleX1gKTsNCiAgICAgICAgICAgIGlmIChlbGVtZW50KSB7DQogICAgICAgICAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgICAgICBub2RlLmNvbmZpZ1trZXldLnZhbHVlID0gZS50YXJnZXQudmFsdWU7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBkaXNwbGF5IG5vZGUgZm9ybWF0IGNoYW5nZXMNCiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ2Rpc3BsYXknICYmIGtleSA9PT0gJ2Zvcm1hdCcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgZGlzcGxheS1mb3JtYXQtJHtub2RlSWR9YCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybWF0RWxlbWVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdEVsZW1lbnQudGV4dENvbnRlbnQgPSBlLnRhcmdldC52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3Igbm9kZV9yZWZlcmVuY2Ugc291cmNlIG5vZGUgY2hhbmdlcw0KICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnbm9kZV9yZWZlcmVuY2UnICYmIGtleSA9PT0gJ3NvdXJjZV9ub2RlX2lkJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBvdXRwdXQgcG9ydCBkcm9wZG93biB3aGVuIHNvdXJjZSBub2RlIGNoYW5nZXMNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dFBvcnRTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgY29uZmlnXyR7bm9kZUlkfV9vdXRwdXRfcG9ydF9pZGApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG91dHB1dFBvcnRTZWxlY3QpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDbGVhciBhbmQgcmVwb3B1bGF0ZSBvdXRwdXQgcG9ydCBvcHRpb25zDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0UG9ydFNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3Qgb3V0cHV0IHBvcnQuLi48L29wdGlvbj4nOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkTm9kZUlkID0gZS50YXJnZXQudmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZUlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkTm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KHNlbGVjdGVkTm9kZUlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWROb2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKHNlbGVjdGVkTm9kZS50eXBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZE5vZGVEZWYgJiYgc2VsZWN0ZWROb2RlRGVmLm91dHB1dHMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG91dHB1dCBvZiBzZWxlY3RlZE5vZGVEZWYub3V0cHV0cykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uLnZhbHVlID0gb3V0cHV0LmlkOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb24udGV4dENvbnRlbnQgPSBgJHtvdXRwdXQubmFtZX0gKCR7b3V0cHV0LnR5cGV9KWA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFBvcnRTZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVzZXQgdGhlIG91dHB1dCBwb3J0IHZhbHVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5jb25maWcub3V0cHV0X3BvcnRfaWQudmFsdWUgPSAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBBZGQgY29sbGFwc2libGUgc2VjdGlvbiBmdW5jdGlvbmFsaXR5IHdpdGggcGVyc2lzdGVuY2UNCiAgICAgICAgY29uc3Qgc2VjdGlvbkhlYWRlcnMgPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcuY29uZmlnLXNlY3Rpb24taGVhZGVyJyk7DQogICAgICAgIHNlY3Rpb25IZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IHsNCiAgICAgICAgICAgIGhlYWRlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7DQogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb25JZCA9IGhlYWRlci5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2VjdGlvbicpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHtzZWN0aW9uSWR9LWNvbnRlbnRgKTsNCiAgICAgICAgICAgICAgICBjb25zdCBpY29uID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJ2knKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAoY29udGVudCAmJiBpY29uKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQ29sbGFwc2VkID0gaGVhZGVyLmNsYXNzTGlzdC5jb250YWlucygnY29sbGFwc2VkJyk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAoaXNDb2xsYXBzZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEV4cGFuZA0KICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2NvbGxhcHNlZCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudC5zdHlsZS5kaXNwbGF5ID0gJyc7DQogICAgICAgICAgICAgICAgICAgICAgICBpY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1kb3duJzsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbGxhcHNlDQogICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXIuY2xhc3NMaXN0LmFkZCgnY29sbGFwc2VkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgICAgICAgICBpY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1yaWdodCc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIFNhdmUgdGhlIHN0YXRlIHRvIGFwcCBzZXR0aW5ncyAodHJ1ZSA9IGV4cGFuZGVkLCBmYWxzZSA9IGNvbGxhcHNlZCkNCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuc2V0U2V0dGluZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSAhaGVhZGVyLmNsYXNzTGlzdC5jb250YWlucygnY29sbGFwc2VkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc3lwbmV4QVBJLnNldFNldHRpbmcoYGNvbmZpZ19zZWN0aW9uXyR7c2VjdGlvbklkfWAsIGlzRXhwYW5kZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gc2F2ZSBjb25maWcgc2VjdGlvbiBzdGF0ZTonLCBlcnJvcik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgfQ0KfQ0KDQovLyBub2RlLXJlbmRlcmVyLmpzIC0gRHluYW1pYyBub2RlIHJlbmRlcmluZyBmb3IgRmxvdyBFZGl0b3INCg0KY2xhc3MgTm9kZVJlbmRlcmVyIHsNCiAgICBjb25zdHJ1Y3RvcigpIHsNCiAgICAgICAgdGhpcy50ZW1wbGF0ZXMgPSBuZXcgTWFwKCk7DQogICAgICAgIHRoaXMuc2V0dXBTdGFuZGFyZFRlbXBsYXRlKCk7DQogICAgfQ0KICAgIA0KICAgIHNldHVwU3RhbmRhcmRUZW1wbGF0ZSgpIHsNCiAgICAgICAgdGhpcy50ZW1wbGF0ZXMuc2V0KCdzdGFuZGFyZCcsIHsNCiAgICAgICAgICAgIHJlbmRlcjogKG5vZGUsIG5vZGVEZWYpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dHMgPSBub2RlRGVmLmlucHV0cyB8fCBbXTsNCiAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXRzID0gbm9kZURlZi5vdXRwdXRzIHx8IFtdOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIHJldHVybiBgDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsb3ctbm9kZS1oZWFkZXIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9IiR7bm9kZURlZi5pY29ufSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+JHtub2RlRGVmLm5hbWV9PC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9ImZsb3ctbm9kZS10eXBlICR7bm9kZS50eXBlfSI+JHtub2RlLnR5cGUudG9VcHBlckNhc2UoKX08L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJub2RlLWRlbGV0ZS1idG4iIHRpdGxlPSJEZWxldGUgbm9kZSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS10aW1lcyI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LW5vZGUtY29udGVudCI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJub2RlLWRlZmF1bHQtY29udGVudCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsIGNsYXNzPSJ0ZXh0LW11dGVkIj4ke25vZGVEZWYuZGVzY3JpcHRpb259PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmxvdy1ub2RlLXBvcnRzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICR7aW5wdXRzLm1hcChpbnB1dCA9PiANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgPGRpdiBjbGFzcz0iZmxvdy1ub2RlLXBvcnQgaW5wdXQiIGRhdGEtcG9ydD0iJHtpbnB1dC5pZH0iPjwvZGl2PmANCiAgICAgICAgICAgICAgICAgICAgICAgICkuam9pbignJyl9DQogICAgICAgICAgICAgICAgICAgICAgICAke291dHB1dHMubWFwKG91dHB1dCA9PiANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgPGRpdiBjbGFzcz0iZmxvdy1ub2RlLXBvcnQgb3V0cHV0IiBkYXRhLXBvcnQ9IiR7b3V0cHV0LmlkfSI+PC9kaXY+YA0KICAgICAgICAgICAgICAgICAgICAgICAgKS5qb2luKCcnKX0NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfQ0KICAgIA0KICAgIHJlZ2lzdGVyVGVtcGxhdGUobmFtZSwgdGVtcGxhdGUpIHsNCiAgICAgICAgdGhpcy50ZW1wbGF0ZXMuc2V0KG5hbWUsIHRlbXBsYXRlKTsNCiAgICB9DQogICAgDQogICAgcmVuZGVyTm9kZShub2RlKSB7DQogICAgICAgIGNvbnN0IG5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICAgICAgaWYgKCFub2RlRGVmKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKGBObyBub2RlIGRlZmluaXRpb24gZm91bmQgZm9yIHR5cGU6ICR7bm9kZS50eXBlfWApOw0KICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25zdCB0ZW1wbGF0ZU5hbWUgPSBub2RlRGVmLnRlbXBsYXRlIHx8ICdzdGFuZGFyZCc7DQogICAgICAgIGNvbnN0IHRlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZXMuZ2V0KHRlbXBsYXRlTmFtZSk7DQogICAgICAgIA0KICAgICAgICBpZiAoIXRlbXBsYXRlKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKGBObyB0ZW1wbGF0ZSBmb3VuZDogJHt0ZW1wbGF0ZU5hbWV9YCk7DQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHJldHVybiB0ZW1wbGF0ZS5yZW5kZXIobm9kZSwgbm9kZURlZik7DQogICAgfQ0KICAgIA0KICAgIGNyZWF0ZU5vZGVFbGVtZW50KG5vZGUpIHsNCiAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NOYW1lID0gYGZsb3ctbm9kZSAke25vZGUudHlwZX0tbm9kZWA7DQogICAgICAgIG5vZGVFbGVtZW50LmlkID0gbm9kZS5pZDsNCiAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUubGVmdCA9IG5vZGUueCArICdweCc7DQogICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLnRvcCA9IG5vZGUueSArICdweCc7DQogICAgICAgIA0KICAgICAgICAvLyBSZW5kZXIgdGhlIG5vZGUgY29udGVudA0KICAgICAgICBub2RlRWxlbWVudC5pbm5lckhUTUwgPSB0aGlzLnJlbmRlck5vZGUobm9kZSk7DQogICAgICAgIA0KICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzIGFuZCBnZXQgdGhlIHVwZGF0ZWQgZWxlbWVudA0KICAgICAgICBjb25zdCBmaW5hbEVsZW1lbnQgPSB0aGlzLmFkZE5vZGVFdmVudExpc3RlbmVycyhub2RlRWxlbWVudCwgbm9kZSk7DQogICAgICAgIA0KICAgICAgICByZXR1cm4gZmluYWxFbGVtZW50Ow0KICAgIH0NCiAgICANCiAgICBhZGROb2RlRXZlbnRMaXN0ZW5lcnMobm9kZUVsZW1lbnQsIG5vZGUpIHsNCiAgICAgICAgLy8gRGVsZXRlIGJ1dHRvbg0KICAgICAgICBjb25zdCBkZWxldGVCdG4gPSBub2RlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubm9kZS1kZWxldGUtYnRuJyk7DQogICAgICAgIGlmIChkZWxldGVCdG4pIHsNCiAgICAgICAgICAgIGRlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgICAgICBkZWxldGVOb2RlKG5vZGUuaWQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIE5vZGUgc2VsZWN0aW9uDQogICAgICAgIG5vZGVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KCcubm9kZS1kZWxldGUtYnRuJykpIHJldHVybjsNCiAgICAgICAgICAgIHNlbGVjdE5vZGUobm9kZS5pZCk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgLy8gTm9kZSBkcmFnZ2luZw0KICAgICAgICBub2RlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZSkgPT4gew0KICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy5ub2RlLWRlbGV0ZS1idG4nKSkgcmV0dXJuOw0KICAgICAgICAgICAgc3RhcnREcmFnZ2luZ05vZGUobm9kZS5pZCwgZSk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgLy8gUG9ydCBjb25uZWN0aW9ucw0KICAgICAgICBjb25zdCBwb3J0cyA9IG5vZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mbG93LW5vZGUtcG9ydCcpOw0KICAgICAgICBwb3J0cy5mb3JFYWNoKHBvcnQgPT4gew0KICAgICAgICAgICAgcG9ydC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICAgICAgc3RhcnRDb25uZWN0aW9uKG5vZGUuaWQsIHBvcnQuZGF0YXNldC5wb3J0LCBwb3J0LmNsYXNzTGlzdC5jb250YWlucygnb3V0cHV0JykpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIG5vZGVFbGVtZW50Ow0KICAgIH0NCn0NCg0KLy8gR2xvYmFsIG5vZGUgcmVuZGVyZXIgaW5zdGFuY2UNCmNvbnN0IG5vZGVSZW5kZXJlciA9IG5ldyBOb2RlUmVuZGVyZXIoKTsNCg0KDQovLyBUZXh0IE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVUZXh0Tm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCB0ZXh0Q29udGVudCA9IG5vZGUuY29uZmlnLnRleHRfY29udGVudC52YWx1ZTsNCg0KICAgIHJldHVybiB7IHRleHQ6IHRleHRDb250ZW50IH07DQp9DQoNCg0KLy8gSlNPTiBFeHRyYWN0IE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVKc29uRXh0cmFjdE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgZmllbGRQYXRoID0gbm9kZS5jb25maWcuZmllbGRfcGF0aC52YWx1ZTsNCiAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBub2RlLmNvbmZpZy5kZWZhdWx0X3ZhbHVlPy52YWx1ZSB8fCAnJzsNCg0KICAgIC8vIEFjY2VwdCBhbnkgaW5wdXQgZGF0YSwgbm90IGp1c3QganNvbl9kYXRhDQogICAgbGV0IGpzb25EYXRhID0gbnVsbDsNCg0KICAgIC8vIFRyeSB0byBmaW5kIEpTT04gZGF0YSBmcm9tIGFueSBpbnB1dA0KICAgIGlmIChpbnB1dERhdGEuanNvbl9kYXRhKSB7DQogICAgICAgIGpzb25EYXRhID0gaW5wdXREYXRhLmpzb25fZGF0YTsNCiAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS5kYXRhKSB7DQogICAgICAgIGpzb25EYXRhID0gaW5wdXREYXRhLmRhdGE7DQogICAgfSBlbHNlIGlmIChpbnB1dERhdGEudGV4dCkgew0KICAgICAgICBqc29uRGF0YSA9IGlucHV0RGF0YS50ZXh0Ow0KICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLnJlc3BvbnNlKSB7DQogICAgICAgIGpzb25EYXRhID0gaW5wdXREYXRhLnJlc3BvbnNlOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIFVzZSB0aGUgZmlyc3QgYXZhaWxhYmxlIGlucHV0DQogICAgICAgIGNvbnN0IGZpcnN0SW5wdXQgPSBPYmplY3QudmFsdWVzKGlucHV0RGF0YSlbMF07DQogICAgICAgIGpzb25EYXRhID0gZmlyc3RJbnB1dDsNCiAgICB9DQoNCg0KICAgIGxldCBleHRyYWN0ZWRWYWx1ZSA9IG51bGw7DQoNCiAgICB0cnkgew0KICAgICAgICAvLyBQYXJzZSBKU09OIGlmIGl0J3MgYSBzdHJpbmcNCiAgICAgICAgaWYgKHR5cGVvZiBqc29uRGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIGpzb25EYXRhID0gSlNPTi5wYXJzZShqc29uRGF0YSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBFeHRyYWN0IHZhbHVlIHVzaW5nIGRvdCBub3RhdGlvbg0KICAgICAgICBleHRyYWN0ZWRWYWx1ZSA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZXh0cmFjdE5lc3RlZFZhbHVlKGpzb25EYXRhLCBmaWVsZFBhdGgpOw0KDQogICAgICAgIC8vIFVzZSBkZWZhdWx0IHZhbHVlIGlmIGV4dHJhY3Rpb24gZmFpbGVkDQogICAgICAgIGlmIChleHRyYWN0ZWRWYWx1ZSA9PT0gbnVsbCB8fCBleHRyYWN0ZWRWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBleHRyYWN0ZWRWYWx1ZSA9IGRlZmF1bHRWYWx1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEZvcm1hdCB0aGUgb3V0cHV0IGFzIHN0cmluZyBmb3IgY29uc2lzdGVuY3kNCiAgICAgICAgbGV0IGZvcm1hdHRlZFZhbHVlID0gU3RyaW5nKGV4dHJhY3RlZFZhbHVlKTsNCg0KICAgICAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgbm9kZS5sYXN0RXh0cmFjdGVkVmFsdWUgPSBmb3JtYXR0ZWRWYWx1ZTsNCiAgICAgICAgbm9kZS5sYXN0RmllbGRQYXRoID0gZmllbGRQYXRoOw0KDQogICAgICAgIC8vIERlYnVnIGxvZ2dpbmcNCg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgZGF0YTogZm9ybWF0dGVkVmFsdWUsDQogICAgICAgICAgICB0ZXh0OiBmb3JtYXR0ZWRWYWx1ZSwNCiAgICAgICAgICAgIGpzb246IGV4dHJhY3RlZFZhbHVlLA0KICAgICAgICAgICAgZXh0cmFjdGVkX3ZhbHVlOiBmb3JtYXR0ZWRWYWx1ZSwNCiAgICAgICAgICAgIGZpZWxkX3BhdGg6IGZpZWxkUGF0aCwNCiAgICAgICAgICAgIG9yaWdpbmFsOiBqc29uRGF0YQ0KICAgICAgICB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04gRXh0cmFjdCBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkYXRhOiBkZWZhdWx0VmFsdWUsDQogICAgICAgICAgICB0ZXh0OiBkZWZhdWx0VmFsdWUsDQogICAgICAgICAgICBqc29uOiBudWxsLA0KICAgICAgICAgICAgZXh0cmFjdGVkX3ZhbHVlOiBkZWZhdWx0VmFsdWUsDQogICAgICAgICAgICBmaWVsZF9wYXRoOiBmaWVsZFBhdGgsDQogICAgICAgICAgICBvcmlnaW5hbDoganNvbkRhdGEsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KDQovLyBSYW5kb20gTGluZSBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlUmFuZG9tUXVvdGVOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IHNraXBFbXB0eSA9IG5vZGUuY29uZmlnLnNraXBfZW1wdHkudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCB0cmltV2hpdGVzcGFjZSA9IG5vZGUuY29uZmlnLnRyaW1fd2hpdGVzcGFjZS52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IG1heExlbmd0aCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLm1heF9sZW5ndGgudmFsdWUpOw0KDQoNCiAgICBsZXQgdGV4dCA9IGlucHV0RGF0YS50ZXh0Ow0KICAgIGlmICh0eXBlb2YgdGV4dCAhPT0gJ3N0cmluZycpIHsNCiAgICAgICAgdGV4dCA9IEpTT04uc3RyaW5naWZ5KHRleHQpOw0KICAgIH0NCg0KDQogICAgY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KCdcbicpOw0KDQogICAgbGV0IHZhbGlkTGluZXMgPSBsaW5lczsNCg0KICAgIGlmIChza2lwRW1wdHkpIHsNCiAgICAgICAgdmFsaWRMaW5lcyA9IGxpbmVzLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpLmxlbmd0aCA+IDApOw0KICAgIH0NCg0KICAgIGlmICh0cmltV2hpdGVzcGFjZSkgew0KICAgICAgICB2YWxpZExpbmVzID0gdmFsaWRMaW5lcy5tYXAobGluZSA9PiBsaW5lLnRyaW0oKSk7DQogICAgfQ0KDQogICAgaWYgKHZhbGlkTGluZXMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIHJldHVybiB7IHJhbmRvbV9saW5lOiBudWxsLCBsaW5lX251bWJlcjogMCwgdG90YWxfbGluZXM6IDAgfTsNCiAgICB9DQoNCiAgICBjb25zdCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHZhbGlkTGluZXMubGVuZ3RoKTsNCiAgICBsZXQgcmFuZG9tTGluZSA9IHZhbGlkTGluZXNbcmFuZG9tSW5kZXhdOw0KDQoNCiAgICBpZiAobWF4TGVuZ3RoID4gMCAmJiByYW5kb21MaW5lLmxlbmd0aCA+IG1heExlbmd0aCkgew0KICAgICAgICByYW5kb21MaW5lID0gcmFuZG9tTGluZS5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKSArICcuLi4nOw0KICAgIH0NCg0KICAgIGNvbnN0IHJlc3VsdCA9IHsNCiAgICAgICAgcmFuZG9tX2xpbmU6IHJhbmRvbUxpbmUsDQogICAgICAgIGxpbmVfbnVtYmVyOiByYW5kb21JbmRleCArIDEsDQogICAgICAgIHRvdGFsX2xpbmVzOiB2YWxpZExpbmVzLmxlbmd0aA0KICAgIH07DQoNCiAgICByZXR1cm4gcmVzdWx0Ow0KfQ0KDQovLyBNYXRoIE9wZXJhdGlvbnMgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZU1hdGhOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IG9wZXJhdGlvbiA9IG5vZGUuY29uZmlnLm9wZXJhdGlvbi52YWx1ZTsNCiAgICBjb25zdCBjb25maWdWYWx1ZUEgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLnZhbHVlX2EudmFsdWUpIHx8IDA7DQogICAgY29uc3QgY29uZmlnVmFsdWVCID0gcGFyc2VGbG9hdChub2RlLmNvbmZpZy52YWx1ZV9iLnZhbHVlKSB8fCAwOw0KICAgIGxldCBkZWNpbWFsUGxhY2VzID0gcGFyc2VJbnQobm9kZS5jb25maWcuZGVjaW1hbF9wbGFjZXMudmFsdWUpOw0KICAgIGlmIChpc05hTihkZWNpbWFsUGxhY2VzKSkgZGVjaW1hbFBsYWNlcyA9IDA7IC8vIERlZmF1bHQgdG8gMCBpZiBub3QgYSBudW1iZXINCg0KICAgIC8vIEdldCB2YWx1ZXMgZnJvbSBpbnB1dHMgb3IgY29uZmlnDQogICAgbGV0IHZhbHVlQSA9IGlucHV0RGF0YS52YWx1ZV9hICE9PSB1bmRlZmluZWQgPyBpbnB1dERhdGEudmFsdWVfYSA6IA0KICAgICAgICAgICAgICAgICBpbnB1dERhdGEubnVtYmVyX2EgIT09IHVuZGVmaW5lZCA/IGlucHV0RGF0YS5udW1iZXJfYSA6IGNvbmZpZ1ZhbHVlQTsNCiAgICBsZXQgdmFsdWVCID0gaW5wdXREYXRhLnZhbHVlX2IgIT09IHVuZGVmaW5lZCA/IGlucHV0RGF0YS52YWx1ZV9iIDogDQogICAgICAgICAgICAgICAgIGlucHV0RGF0YS5udW1iZXJfYiAhPT0gdW5kZWZpbmVkID8gaW5wdXREYXRhLm51bWJlcl9iIDogY29uZmlnVmFsdWVCOw0KDQogICAgLy8gQ29udmVydCB0byBudW1iZXJzDQogICAgaWYgKHR5cGVvZiB2YWx1ZUEgPT09ICdzdHJpbmcnKSB2YWx1ZUEgPSBwYXJzZUZsb2F0KHZhbHVlQSkgfHwgMDsNCiAgICBpZiAodHlwZW9mIHZhbHVlQiA9PT0gJ3N0cmluZycpIHZhbHVlQiA9IHBhcnNlRmxvYXQodmFsdWVCKSB8fCAwOw0KICAgIGlmICh0eXBlb2YgdmFsdWVBID09PSAnb2JqZWN0JyAmJiB2YWx1ZUEgIT09IG51bGwpIHsNCiAgICAgICAgLy8gVHJ5IHRvIGV4dHJhY3QgbnVtZXJpYyB2YWx1ZSBmcm9tIG9iamVjdA0KICAgICAgICB2YWx1ZUEgPSBwYXJzZUZsb2F0KHZhbHVlQS52YWx1ZSB8fCB2YWx1ZUEucmVzdWx0IHx8IHZhbHVlQS5kYXRhIHx8IDApOw0KICAgIH0NCiAgICBpZiAodHlwZW9mIHZhbHVlQiA9PT0gJ29iamVjdCcgJiYgdmFsdWVCICE9PSBudWxsKSB7DQogICAgICAgIHZhbHVlQiA9IHBhcnNlRmxvYXQodmFsdWVCLnZhbHVlIHx8IHZhbHVlQi5yZXN1bHQgfHwgdmFsdWVCLmRhdGEgfHwgMCk7DQogICAgfQ0KDQogICAgbGV0IHJlc3VsdCA9IDA7DQoNCiAgICB0cnkgew0KICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbikgew0KICAgICAgICAgICAgY2FzZSAnYWRkJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZUEgKyB2YWx1ZUI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzdWJ0cmFjdCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWVBIC0gdmFsdWVCOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbXVsdGlwbHknOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlQSAqIHZhbHVlQjsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2RpdmlkZSc6DQogICAgICAgICAgICAgICAgaWYgKHZhbHVlQiA9PT0gMCkgdGhyb3cgbmV3IEVycm9yKCdEaXZpc2lvbiBieSB6ZXJvJyk7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWVBIC8gdmFsdWVCOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbW9kdWxvJzoNCiAgICAgICAgICAgICAgICBpZiAodmFsdWVCID09PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ01vZHVsbyBieSB6ZXJvJyk7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWVBICUgdmFsdWVCOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAncG93ZXInOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGgucG93KHZhbHVlQSwgdmFsdWVCKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ21pbic6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5taW4odmFsdWVBLCB2YWx1ZUIpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbWF4JzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLm1heCh2YWx1ZUEsIHZhbHVlQik7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdhYnMnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGguYWJzKHZhbHVlQSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdyb3VuZCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5yb3VuZCh2YWx1ZUEpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZmxvb3InOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGguZmxvb3IodmFsdWVBKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2NlaWwnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGguY2VpbCh2YWx1ZUEpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZUE7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBSb3VuZCB0byBzcGVjaWZpZWQgZGVjaW1hbCBwbGFjZXMNCiAgICAgICAgaWYgKGRlY2ltYWxQbGFjZXMgPj0gMCkgew0KICAgICAgICAgICAgcmVzdWx0ID0gcGFyc2VGbG9hdChyZXN1bHQudG9GaXhlZChkZWNpbWFsUGxhY2VzKSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgbm9kZS5sYXN0VmFsdWVBID0gdmFsdWVBOw0KICAgICAgICBub2RlLmxhc3RWYWx1ZUIgPSB2YWx1ZUI7DQogICAgICAgIG5vZGUubGFzdFJlc3VsdCA9IHJlc3VsdDsNCiAgICAgICAgbm9kZS5sYXN0T3BlcmF0aW9uID0gb3BlcmF0aW9uOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXN1bHQ6IHJlc3VsdCwNCiAgICAgICAgICAgIGRhdGE6IHJlc3VsdCwNCiAgICAgICAgICAgIHRleHQ6IHJlc3VsdC50b1N0cmluZygpLA0KICAgICAgICAgICAgZm9ybWF0dGVkOiBkZWNpbWFsUGxhY2VzID09PSAwID8gcmVzdWx0LnRvU3RyaW5nKCkgOiByZXN1bHQudG9GaXhlZChkZWNpbWFsUGxhY2VzKQ0KICAgICAgICB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ01hdGggb3BlcmF0aW9uIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHJlc3VsdDogMCwNCiAgICAgICAgICAgIGRhdGE6IDAsDQogICAgICAgICAgICB0ZXh0OiAiMCIsDQogICAgICAgICAgICBmb3JtYXR0ZWQ6IGRlY2ltYWxQbGFjZXMgPT09IDAgPyAiMCIgOiAiMC4wMCIsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gQXJyYXkgT3BlcmF0aW9ucyBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlQXJyYXlOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IG9wZXJhdGlvbiA9IG5vZGUuY29uZmlnLm9wZXJhdGlvbi52YWx1ZTsNCiAgICBjb25zdCBmaWVsZFBhdGggPSBub2RlLmNvbmZpZy5maWVsZF9wYXRoLnZhbHVlOw0KICAgIGNvbnN0IGZpbHRlclZhbHVlID0gbm9kZS5jb25maWcuZmlsdGVyX3ZhbHVlLnZhbHVlOw0KICAgIGNvbnN0IGZpbHRlck9wZXJhdG9yID0gbm9kZS5jb25maWcuZmlsdGVyX29wZXJhdG9yLnZhbHVlOw0KICAgIGNvbnN0IGpvaW5TZXBhcmF0b3IgPSBub2RlLmNvbmZpZy5qb2luX3NlcGFyYXRvci52YWx1ZSB8fCAnLCAnOw0KICAgIGNvbnN0IHNsaWNlU3RhcnQgPSBwYXJzZUludChub2RlLmNvbmZpZy5zbGljZV9zdGFydC52YWx1ZSkgfHwgMDsNCiAgICBjb25zdCBzbGljZUVuZCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLnNsaWNlX2VuZC52YWx1ZSkgfHwgMDsNCg0KICAgIC8vIEdldCBhcnJheSBmcm9tIGlucHV0DQogICAgbGV0IGFycmF5ID0gaW5wdXREYXRhLmFycmF5IHx8IGlucHV0RGF0YS5kYXRhOw0KICAgIGxldCBvYmplY3QgPSBpbnB1dERhdGEub2JqZWN0IHx8IGlucHV0RGF0YS5kYXRhOw0KICAgIA0KICAgIC8vIEZvciBvYmplY3Qgb3BlcmF0aW9ucywgd2Ugd29yayB3aXRoIG9iamVjdHMgaW5zdGVhZCBvZiBhcnJheXMNCiAgICBpZiAoWydvYmplY3Rfa2V5cycsICdvYmplY3RfdmFsdWVzJywgJ29iamVjdF9lbnRyaWVzJ10uaW5jbHVkZXMob3BlcmF0aW9uKSkgew0KICAgICAgICAvLyBQYXJzZSBvYmplY3QgaWYgaXQncyBhIHN0cmluZw0KICAgICAgICBpZiAodHlwZW9mIG9iamVjdCA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgb2JqZWN0ID0gSlNPTi5wYXJzZShvYmplY3QpOw0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSBvYmplY3Q6JywgZSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBudWxsLCBlcnJvcjogJ0ludmFsaWQgb2JqZWN0IGRhdGEnIH07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAodHlwZW9mIG9iamVjdCAhPT0gJ29iamVjdCcgfHwgQXJyYXkuaXNBcnJheShvYmplY3QpIHx8IG9iamVjdCA9PT0gbnVsbCkgew0KICAgICAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBudWxsLCBlcnJvcjogJ0lucHV0IGlzIG5vdCBhbiBvYmplY3QnIH07DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBQYXJzZSBhcnJheSBpZiBpdCdzIGEgc3RyaW5nIChleGlzdGluZyBsb2dpYykNCiAgICAgICAgaWYgKHR5cGVvZiBhcnJheSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgYXJyYXkgPSBKU09OLnBhcnNlKGFycmF5KTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGFyc2UgYXJyYXk6JywgZSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBudWxsLCBlcnJvcjogJ0ludmFsaWQgYXJyYXkgZGF0YScgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICghQXJyYXkuaXNBcnJheShhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiB7IHJlc3VsdDogbnVsbCwgZXJyb3I6ICdJbnB1dCBpcyBub3QgYW4gYXJyYXknIH07DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBsZXQgcmVzdWx0ID0gbnVsbDsNCg0KICAgIHRyeSB7DQogICAgICAgIHN3aXRjaCAob3BlcmF0aW9uKSB7DQogICAgICAgICAgICBjYXNlICdtYXAnOg0KICAgICAgICAgICAgICAgIGlmIChmaWVsZFBhdGgpIHsNCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkubWFwKGl0ZW0gPT4gd2luZG93LmZsb3dFZGl0b3JVdGlscy5leHRyYWN0TmVzdGVkVmFsdWUoaXRlbSwgZmllbGRQYXRoKSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkuc2xpY2UoKTsgLy8gUmV0dXJuIGNvcHkgb2YgYXJyYXkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdmaWx0ZXInOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5LmZpbHRlcihpdGVtID0+IHsNCiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gZmllbGRQYXRoID8gd2luZG93LmZsb3dFZGl0b3JVdGlscy5leHRyYWN0TmVzdGVkVmFsdWUoaXRlbSwgZmllbGRQYXRoKSA6IGl0ZW07DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBwZXJmb3JtRmlsdGVyT3BlcmF0aW9uKHZhbHVlLCBmaWx0ZXJWYWx1ZSwgZmlsdGVyT3BlcmF0b3IpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbGVuZ3RoJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5sZW5ndGg7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdqb2luJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5tYXAoaXRlbSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGlmIChmaWVsZFBhdGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShpdGVtLCBmaWVsZFBhdGgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgPyBKU09OLnN0cmluZ2lmeShpdGVtKSA6IFN0cmluZyhpdGVtKTsNCiAgICAgICAgICAgICAgICB9KS5qb2luKGpvaW5TZXBhcmF0b3IpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZmlyc3QnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5Lmxlbmd0aCA+IDAgPyBhcnJheVswXSA6IG51bGw7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdsYXN0JzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5sZW5ndGggPiAwID8gYXJyYXlbYXJyYXkubGVuZ3RoIC0gMV0gOiBudWxsOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnc2xpY2UnOg0KICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHNsaWNlRW5kID4gMCA/IHNsaWNlRW5kIDogYXJyYXkubGVuZ3RoOw0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5LnNsaWNlKHNsaWNlU3RhcnQsIGVuZCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdyZXZlcnNlJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5zbGljZSgpLnJldmVyc2UoKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3NvcnQnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5LnNsaWNlKCkuc29ydCgoYSwgYikgPT4gew0KICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWVBID0gZmllbGRQYXRoID8gd2luZG93LmZsb3dFZGl0b3JVdGlscy5leHRyYWN0TmVzdGVkVmFsdWUoYSwgZmllbGRQYXRoKSA6IGE7DQogICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZUIgPSBmaWVsZFBhdGggPyB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShiLCBmaWVsZFBhdGgpIDogYjsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlQSA8IHZhbHVlQiA/IC0xIDogdmFsdWVBID4gdmFsdWVCID8gMSA6IDA7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICd1bmlxdWUnOg0KICAgICAgICAgICAgICAgIGlmIChmaWVsZFBhdGgpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VlbiA9IG5ldyBTZXQoKTsNCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkuZmlsdGVyKGl0ZW0gPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShpdGVtLCBmaWVsZFBhdGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlZW4uaGFzKHZhbHVlKSkgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2Vlbi5hZGQodmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFsuLi5uZXcgU2V0KGFycmF5KV07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnb2JqZWN0X2tleXMnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE9iamVjdC5rZXlzKG9iamVjdCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdvYmplY3RfdmFsdWVzJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBPYmplY3QudmFsdWVzKG9iamVjdCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdvYmplY3RfZW50cmllcyc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gT2JqZWN0LmVudHJpZXMob2JqZWN0KS5tYXAoKFtrZXksIHZhbHVlXSkgPT4gKHsNCiAgICAgICAgICAgICAgICAgICAga2V5OiBrZXksDQogICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZQ0KICAgICAgICAgICAgICAgIH0pKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgaWYgKFsnb2JqZWN0X2tleXMnLCAnb2JqZWN0X3ZhbHVlcycsICdvYmplY3RfZW50cmllcyddLmluY2x1ZGVzKG9wZXJhdGlvbikpIHsNCiAgICAgICAgICAgIG5vZGUubGFzdEFycmF5ID0gb2JqZWN0Ow0KICAgICAgICAgICAgbm9kZS5sYXN0T2JqZWN0ID0gb2JqZWN0Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgbm9kZS5sYXN0QXJyYXkgPSBhcnJheTsNCiAgICAgICAgfQ0KICAgICAgICBub2RlLmxhc3RSZXN1bHQgPSByZXN1bHQ7DQogICAgICAgIG5vZGUubGFzdE9wZXJhdGlvbiA9IG9wZXJhdGlvbjsNCg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgcmVzdWx0OiByZXN1bHQsDQogICAgICAgICAgICBkYXRhOiByZXN1bHQsDQogICAgICAgICAgICB0ZXh0OiBBcnJheS5pc0FycmF5KHJlc3VsdCkgPyBKU09OLnN0cmluZ2lmeShyZXN1bHQpIDogU3RyaW5nKHJlc3VsdCksDQogICAgICAgICAgICBsZW5ndGg6IEFycmF5LmlzQXJyYXkocmVzdWx0KSA/IHJlc3VsdC5sZW5ndGggOiBBcnJheS5pc0FycmF5KGFycmF5KSA/IGFycmF5Lmxlbmd0aCA6IDAsDQogICAgICAgICAgICBmaXJzdDogQXJyYXkuaXNBcnJheShhcnJheSkgJiYgYXJyYXkubGVuZ3RoID4gMCA/IGFycmF5WzBdIDogbnVsbCwNCiAgICAgICAgICAgIGxhc3Q6IEFycmF5LmlzQXJyYXkoYXJyYXkpICYmIGFycmF5Lmxlbmd0aCA+IDAgPyBhcnJheVthcnJheS5sZW5ndGggLSAxXSA6IG51bGwNCiAgICAgICAgfTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdBcnJheSBvcGVyYXRpb24gZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgcmVzdWx0OiBudWxsLA0KICAgICAgICAgICAgZGF0YTogbnVsbCwNCiAgICAgICAgICAgIHRleHQ6ICIiLA0KICAgICAgICAgICAgbGVuZ3RoOiAwLA0KICAgICAgICAgICAgZmlyc3Q6IG51bGwsDQogICAgICAgICAgICBsYXN0OiBudWxsLA0KICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UNCiAgICAgICAgfTsNCiAgICB9DQp9DQoNCi8vIEhlbHBlciBmdW5jdGlvbiBmb3IgYXJyYXkgZmlsdGVyaW5nDQpmdW5jdGlvbiBwZXJmb3JtRmlsdGVyT3BlcmF0aW9uKHZhbHVlLCBmaWx0ZXJWYWx1ZSwgb3BlcmF0b3IpIHsNCiAgICBjb25zdCB2YWx1ZVN0ciA9IFN0cmluZyh2YWx1ZSkudG9Mb3dlckNhc2UoKTsNCiAgICBjb25zdCBmaWx0ZXJTdHIgPSBTdHJpbmcoZmlsdGVyVmFsdWUpLnRvTG93ZXJDYXNlKCk7DQogICAgDQogICAgc3dpdGNoIChvcGVyYXRvcikgew0KICAgICAgICBjYXNlICdlcXVhbHMnOg0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlID09IGZpbHRlclZhbHVlOw0KICAgICAgICBjYXNlICdub3RfZXF1YWxzJzoNCiAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPSBmaWx0ZXJWYWx1ZTsNCiAgICAgICAgY2FzZSAnY29udGFpbnMnOg0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlU3RyLmluY2x1ZGVzKGZpbHRlclN0cik7DQogICAgICAgIGNhc2UgJ2dyZWF0ZXJfdGhhbic6DQogICAgICAgICAgICByZXR1cm4gTnVtYmVyKHZhbHVlKSA+IE51bWJlcihmaWx0ZXJWYWx1ZSk7DQogICAgICAgIGNhc2UgJ2xlc3NfdGhhbic6DQogICAgICAgICAgICByZXR1cm4gTnVtYmVyKHZhbHVlKSA8IE51bWJlcihmaWx0ZXJWYWx1ZSk7DQogICAgICAgIGNhc2UgJ3N0YXJ0c193aXRoJzoNCiAgICAgICAgICAgIHJldHVybiB2YWx1ZVN0ci5zdGFydHNXaXRoKGZpbHRlclN0cik7DQogICAgICAgIGNhc2UgJ2VuZHNfd2l0aCc6DQogICAgICAgICAgICByZXR1cm4gdmFsdWVTdHIuZW5kc1dpdGgoZmlsdGVyU3RyKTsNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCn0NCg0KLy8gU3RyaW5nIE9wZXJhdGlvbnMgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVN0cmluZ05vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgb3BlcmF0aW9uID0gbm9kZS5jb25maWcub3BlcmF0aW9uLnZhbHVlOw0KICAgIGNvbnN0IGNvbmZpZ1RleHRCID0gbm9kZS5jb25maWcudGV4dF9iLnZhbHVlOw0KICAgIA0KICAgIC8vIFByb2Nlc3MgZXNjYXBlIHNlcXVlbmNlcyBpbiBzZXBhcmF0b3IgKGUuZy4sIFxuLCBcclxuLCBcdCwgZXRjLikNCiAgICBsZXQgc2VwYXJhdG9yID0gbm9kZS5jb25maWcuc2VwYXJhdG9yLnZhbHVlIHx8ICcsJzsNCiAgICBzZXBhcmF0b3IgPSBzZXBhcmF0b3INCiAgICAgICAgLnJlcGxhY2UoL1xcbi9nLCAnXG4nKQ0KICAgICAgICAucmVwbGFjZSgvXFxyL2csICdccicpDQogICAgICAgIC5yZXBsYWNlKC9cXHQvZywgJ1x0JykNCiAgICAgICAgLnJlcGxhY2UoL1xcXFwvZywgJ1xcJyk7DQogICAgDQogICAgY29uc3Qgc2VhcmNoVGV4dCA9IG5vZGUuY29uZmlnLnNlYXJjaF90ZXh0LnZhbHVlOw0KICAgIGNvbnN0IHJlcGxhY2VUZXh0ID0gbm9kZS5jb25maWcucmVwbGFjZV90ZXh0LnZhbHVlOw0KICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBwYXJzZUludChub2RlLmNvbmZpZy5zdGFydF9pbmRleC52YWx1ZSkgfHwgMDsNCiAgICBjb25zdCBlbmRJbmRleCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLmVuZF9pbmRleC52YWx1ZSkgfHwgMDsNCiAgICBjb25zdCByZXBlYXRDb3VudCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLnJlcGVhdF9jb3VudC52YWx1ZSkgfHwgMTsNCiAgICBjb25zdCBjYXNlU2Vuc2l0aXZlID0gbm9kZS5jb25maWcuY2FzZV9zZW5zaXRpdmUudmFsdWUgPT09ICd0cnVlJzsNCg0KICAgIC8vIEdldCB0ZXh0IGlucHV0cw0KICAgIGxldCB0ZXh0QSA9IGlucHV0RGF0YS50ZXh0IHx8IGlucHV0RGF0YS5kYXRhIHx8ICcnOw0KICAgIGxldCB0ZXh0QiA9IGlucHV0RGF0YS50ZXh0X2IgfHwgY29uZmlnVGV4dEIgfHwgJyc7DQoNCiAgICAvLyBEZWJ1ZyBsb2dnaW5nIGZvciBpbnB1dCBzeW5jaHJvbml6YXRpb24NCiAgICBjb25zb2xlLmxvZygn8J+UlyBTdHJpbmcgTm9kZSBJbnB1dCBEZWJ1ZzonLCB7DQogICAgICAgIGlucHV0RGF0YTogaW5wdXREYXRhLA0KICAgICAgICB0ZXh0QTogdGV4dEEsDQogICAgICAgIHRleHRCOiB0ZXh0QiwNCiAgICAgICAgY29uZmlnVGV4dEI6IGNvbmZpZ1RleHRCLA0KICAgICAgICBvcGVyYXRpb246IG9wZXJhdGlvbg0KICAgIH0pOw0KDQogICAgLy8gQ29udmVydCB0byBzdHJpbmdzDQogICAgaWYgKHR5cGVvZiB0ZXh0QSAhPT0gJ3N0cmluZycpIHRleHRBID0gU3RyaW5nKHRleHRBKTsNCiAgICBpZiAodHlwZW9mIHRleHRCICE9PSAnc3RyaW5nJykgdGV4dEIgPSBTdHJpbmcodGV4dEIpOw0KDQogICAgbGV0IHJlc3VsdCA9ICcnOw0KDQogICAgdHJ5IHsNCiAgICAgICAgc3dpdGNoIChvcGVyYXRpb24pIHsNCiAgICAgICAgICAgIGNhc2UgJ2NvbmNhdGVuYXRlJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QSArIHNlcGFyYXRvciArIHRleHRCOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnc3BsaXQnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnNwbGl0KHNlcGFyYXRvcik7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdyZXBsYWNlJzoNCiAgICAgICAgICAgICAgICBpZiAoY2FzZVNlbnNpdGl2ZSkgew0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS5yZXBsYWNlKG5ldyBSZWdFeHAoZXNjYXBlUmVnZXgoc2VhcmNoVGV4dCksICdnJyksIHJlcGxhY2VUZXh0KTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS5yZXBsYWNlKG5ldyBSZWdFeHAoZXNjYXBlUmVnZXgoc2VhcmNoVGV4dCksICdnaScpLCByZXBsYWNlVGV4dCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAndHJpbSc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdGV4dEEudHJpbSgpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAndXBwZXJjYXNlJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbG93ZXJjYXNlJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnc3Vic3RyaW5nJzoNCiAgICAgICAgICAgICAgICBjb25zdCBlbmQgPSBlbmRJbmRleCA+IDAgPyBlbmRJbmRleCA6IHRleHRBLmxlbmd0aDsNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS5zdWJzdHJpbmcoc3RhcnRJbmRleCwgZW5kKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JlZ2V4X21hdGNoJzoNCiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaEZsYWdzID0gY2FzZVNlbnNpdGl2ZSA/ICdnJyA6ICdnaSc7DQogICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHRleHRBLm1hdGNoKG5ldyBSZWdFeHAoc2VhcmNoVGV4dCwgbWF0Y2hGbGFncykpOw0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IG1hdGNoZXMgfHwgW107DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdyZWdleF9yZXBsYWNlJzoNCiAgICAgICAgICAgICAgICBjb25zdCByZXBsYWNlRmxhZ3MgPSBjYXNlU2Vuc2l0aXZlID8gJ2cnIDogJ2dpJzsNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS5yZXBsYWNlKG5ldyBSZWdFeHAoc2VhcmNoVGV4dCwgcmVwbGFjZUZsYWdzKSwgcmVwbGFjZVRleHQpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnc3RhcnRzX3dpdGgnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGNhc2VTZW5zaXRpdmUgPyB0ZXh0QS5zdGFydHNXaXRoKHNlYXJjaFRleHQpIDogDQogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2VuZHNfd2l0aCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gY2FzZVNlbnNpdGl2ZSA/IHRleHRBLmVuZHNXaXRoKHNlYXJjaFRleHQpIDogDQogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QS50b0xvd2VyQ2FzZSgpLmVuZHNXaXRoKHNlYXJjaFRleHQudG9Mb3dlckNhc2UoKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdjb250YWlucyc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gY2FzZVNlbnNpdGl2ZSA/IHRleHRBLmluY2x1ZGVzKHNlYXJjaFRleHQpIDogDQogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaFRleHQudG9Mb3dlckNhc2UoKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdyZXBlYXQnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnJlcGVhdChNYXRoLm1heCgwLCBNYXRoLm1pbihyZXBlYXRDb3VudCwgMTAwKSkpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbGFzdF9saW5lJzoNCiAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IHRleHRBLnNwbGl0KCdcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpLmxlbmd0aCA+IDApOw0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGxpbmVzLmxlbmd0aCA+IDAgPyBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXSA6ICcnOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBub2RlLmxhc3RUZXh0QSA9IHRleHRBOw0KICAgICAgICBub2RlLmxhc3RUZXh0QiA9IHRleHRCOw0KICAgICAgICBub2RlLmxhc3RSZXN1bHQgPSByZXN1bHQ7DQogICAgICAgIG5vZGUubGFzdE9wZXJhdGlvbiA9IG9wZXJhdGlvbjsNCg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgcmVzdWx0OiBBcnJheS5pc0FycmF5KHJlc3VsdCkgPyByZXN1bHQgOiBTdHJpbmcocmVzdWx0KSwNCiAgICAgICAgICAgIGRhdGE6IHJlc3VsdCwNCiAgICAgICAgICAgIGFycmF5OiBBcnJheS5pc0FycmF5KHJlc3VsdCkgPyByZXN1bHQgOiBudWxsLA0KICAgICAgICAgICAgbGVuZ3RoOiBTdHJpbmcocmVzdWx0KS5sZW5ndGgsDQogICAgICAgICAgICB3b3JkX2NvdW50OiBTdHJpbmcocmVzdWx0KS50cmltKCkuc3BsaXQoL1xzKy8pLmZpbHRlcih3b3JkID0+IHdvcmQubGVuZ3RoID4gMCkubGVuZ3RoDQogICAgICAgIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignU3RyaW5nIG9wZXJhdGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXN1bHQ6ICcnLA0KICAgICAgICAgICAgZGF0YTogJycsDQogICAgICAgICAgICBhcnJheTogbnVsbCwNCiAgICAgICAgICAgIGxlbmd0aDogMCwNCiAgICAgICAgICAgIHdvcmRfY291bnQ6IDAsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGVzY2FwZSByZWdleCBzcGVjaWFsIGNoYXJhY3RlcnMNCmZ1bmN0aW9uIGVzY2FwZVJlZ2V4KHN0cmluZykgew0KICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xdXFxdL2csICdcXCQmJyk7DQp9DQoNCi8vIE5vZGUgUmVmZXJlbmNlIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVOb2RlUmVmZXJlbmNlTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBzb3VyY2VOb2RlSWQgPSBub2RlLmNvbmZpZy5zb3VyY2Vfbm9kZV9pZC52YWx1ZTsNCiAgICBjb25zdCBvdXRwdXRQb3J0SWQgPSBub2RlLmNvbmZpZy5vdXRwdXRfcG9ydF9pZC52YWx1ZTsNCiAgICBjb25zdCBmYWxsYmFja1ZhbHVlID0gbm9kZS5jb25maWcuZmFsbGJhY2tfdmFsdWUudmFsdWUgfHwgbnVsbDsNCg0KICAgIC8vIFZhbGlkYXRlIGlucHV0cw0KICAgIGlmICghc291cmNlTm9kZUlkKSB7DQogICAgICAgIGNvbnNvbGUud2FybignTm9kZSBSZWZlcmVuY2U6IE5vIHNvdXJjZSBub2RlIHNlbGVjdGVkJyk7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkYXRhOiBmYWxsYmFja1ZhbHVlLA0KICAgICAgICAgICAgdGV4dDogU3RyaW5nKGZhbGxiYWNrVmFsdWUgfHwgJycpLA0KICAgICAgICAgICAganNvbjogZmFsbGJhY2tWYWx1ZSwNCiAgICAgICAgICAgIG51bWJlcjogaXNOYU4oTnVtYmVyKGZhbGxiYWNrVmFsdWUpKSA/IDAgOiBOdW1iZXIoZmFsbGJhY2tWYWx1ZSksDQogICAgICAgICAgICBib29sZWFuOiBCb29sZWFuKGZhbGxiYWNrVmFsdWUpLA0KICAgICAgICAgICAgYmluYXJ5OiBudWxsLA0KICAgICAgICAgICAgb3JpZ2luYWw6IGZhbGxiYWNrVmFsdWUsDQogICAgICAgICAgICBlcnJvcjogJ05vIHNvdXJjZSBub2RlIHNlbGVjdGVkJw0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgIGlmICghb3V0cHV0UG9ydElkKSB7DQogICAgICAgIGNvbnNvbGUud2FybignTm9kZSBSZWZlcmVuY2U6IE5vIG91dHB1dCBwb3J0IHNlbGVjdGVkJyk7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkYXRhOiBmYWxsYmFja1ZhbHVlLA0KICAgICAgICAgICAgdGV4dDogU3RyaW5nKGZhbGxiYWNrVmFsdWUgfHwgJycpLA0KICAgICAgICAgICAganNvbjogZmFsbGJhY2tWYWx1ZSwNCiAgICAgICAgICAgIG51bWJlcjogaXNOYU4oTnVtYmVyKGZhbGxiYWNrVmFsdWUpKSA/IDAgOiBOdW1iZXIoZmFsbGJhY2tWYWx1ZSksDQogICAgICAgICAgICBib29sZWFuOiBCb29sZWFuKGZhbGxiYWNrVmFsdWUpLA0KICAgICAgICAgICAgYmluYXJ5OiBudWxsLA0KICAgICAgICAgICAgb3JpZ2luYWw6IGZhbGxiYWNrVmFsdWUsDQogICAgICAgICAgICBlcnJvcjogJ05vIG91dHB1dCBwb3J0IHNlbGVjdGVkJw0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgIHRyeSB7DQogICAgICAgIC8vIEdldCB0aGUgcmVmZXJlbmNlZCBkYXRhIHVzaW5nIHRoZSBleGlzdGluZyBmdW5jdGlvbg0KICAgICAgICBjb25zdCByZWZlcmVuY2VkRGF0YSA9IGdldE91dHB1dFBvcnREYXRhKHNvdXJjZU5vZGVJZCwgb3V0cHV0UG9ydElkKTsNCiAgICAgICAgDQogICAgICAgIGlmIChyZWZlcmVuY2VkRGF0YSA9PT0gbnVsbCB8fCByZWZlcmVuY2VkRGF0YSA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBjb25zb2xlLndhcm4oYE5vZGUgUmVmZXJlbmNlOiBObyBkYXRhIGZvdW5kIGZvciBub2RlICR7c291cmNlTm9kZUlkfSwgcG9ydCAke291dHB1dFBvcnRJZH1gKTsNCiAgICAgICAgICAgIGNvbnN0IGZhbGxiYWNrID0gZmFsbGJhY2tWYWx1ZSAhPT0gJycgPyBmYWxsYmFja1ZhbHVlIDogbnVsbDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBkYXRhOiBmYWxsYmFjaywNCiAgICAgICAgICAgICAgICB0ZXh0OiBTdHJpbmcoZmFsbGJhY2sgfHwgJycpLA0KICAgICAgICAgICAgICAgIGpzb246IGZhbGxiYWNrLA0KICAgICAgICAgICAgICAgIG51bWJlcjogaXNOYU4oTnVtYmVyKGZhbGxiYWNrKSkgPyAwIDogTnVtYmVyKGZhbGxiYWNrKSwNCiAgICAgICAgICAgICAgICBib29sZWFuOiBCb29sZWFuKGZhbGxiYWNrKSwNCiAgICAgICAgICAgICAgICBiaW5hcnk6IG51bGwsDQogICAgICAgICAgICAgICAgb3JpZ2luYWw6IGZhbGxiYWNrLA0KICAgICAgICAgICAgICAgIGVycm9yOiBgTm8gZGF0YSBmb3VuZCBmb3Igbm9kZSAke3NvdXJjZU5vZGVJZH0sIHBvcnQgJHtvdXRwdXRQb3J0SWR9YA0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN1Y2Nlc3NmdWxseSBnb3QgdGhlIGRhdGEgLSBmb3JtYXQgaXQgZm9yIGFsbCBvdXRwdXQgdHlwZXMNCiAgICAgICAgbGV0IHRleHRWYWx1ZSA9IFN0cmluZyhyZWZlcmVuY2VkRGF0YSk7DQogICAgICAgIGxldCBqc29uVmFsdWUgPSByZWZlcmVuY2VkRGF0YTsNCiAgICAgICAgbGV0IG51bWJlclZhbHVlID0gMDsNCiAgICAgICAgbGV0IGJvb2xlYW5WYWx1ZSA9IEJvb2xlYW4ocmVmZXJlbmNlZERhdGEpOw0KDQogICAgICAgIC8vIEhhbmRsZSBkaWZmZXJlbnQgZGF0YSB0eXBlcyBhcHByb3ByaWF0ZWx5DQogICAgICAgIGlmICh0eXBlb2YgcmVmZXJlbmNlZERhdGEgPT09ICdudW1iZXInKSB7DQogICAgICAgICAgICBudW1iZXJWYWx1ZSA9IHJlZmVyZW5jZWREYXRhOw0KICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiByZWZlcmVuY2VkRGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IE51bWJlcihyZWZlcmVuY2VkRGF0YSk7DQogICAgICAgICAgICBudW1iZXJWYWx1ZSA9IGlzTmFOKHBhcnNlZCkgPyAwIDogcGFyc2VkOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gRm9yIEpTT04gb3V0cHV0LCB0cnkgdG8gcHJlc2VydmUgb2JqZWN0IHN0cnVjdHVyZQ0KICAgICAgICBpZiAodHlwZW9mIHJlZmVyZW5jZWREYXRhID09PSAnb2JqZWN0Jykgew0KICAgICAgICAgICAganNvblZhbHVlID0gcmVmZXJlbmNlZERhdGE7DQogICAgICAgICAgICB0ZXh0VmFsdWUgPSBKU09OLnN0cmluZ2lmeShyZWZlcmVuY2VkRGF0YSwgbnVsbCwgMik7DQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHJlZmVyZW5jZWREYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgSlNPTg0KICAgICAgICAgICAgICAgIGpzb25WYWx1ZSA9IEpTT04ucGFyc2UocmVmZXJlbmNlZERhdGEpOw0KICAgICAgICAgICAgfSBjYXRjaCB7DQogICAgICAgICAgICAgICAgLy8gTm90IHZhbGlkIEpTT04sIGtlZXAgYXMgc3RyaW5nDQogICAgICAgICAgICAgICAganNvblZhbHVlID0gcmVmZXJlbmNlZERhdGE7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBjb25zb2xlLmxvZyhgTm9kZSBSZWZlcmVuY2U6IFN1Y2Nlc3NmdWxseSByZXRyaWV2ZWQgZGF0YSBmcm9tICR7c291cmNlTm9kZUlkfS4ke291dHB1dFBvcnRJZH06YCwgcmVmZXJlbmNlZERhdGEpOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkYXRhOiByZWZlcmVuY2VkRGF0YSwNCiAgICAgICAgICAgIHRleHQ6IHRleHRWYWx1ZSwNCiAgICAgICAgICAgIGpzb246IGpzb25WYWx1ZSwNCiAgICAgICAgICAgIG51bWJlcjogbnVtYmVyVmFsdWUsDQogICAgICAgICAgICBib29sZWFuOiBib29sZWFuVmFsdWUsDQogICAgICAgICAgICBiaW5hcnk6IChyZWZlcmVuY2VkRGF0YSBpbnN0YW5jZW9mIEJsb2IgfHwgcmVmZXJlbmNlZERhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgPyByZWZlcmVuY2VkRGF0YSA6IG51bGwsDQogICAgICAgICAgICBvcmlnaW5hbDogcmVmZXJlbmNlZERhdGENCiAgICAgICAgfTsNCg0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vZGUgUmVmZXJlbmNlIGV4ZWN1dGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIGNvbnN0IGZhbGxiYWNrID0gZmFsbGJhY2tWYWx1ZSAhPT0gJycgPyBmYWxsYmFja1ZhbHVlIDogbnVsbDsNCiAgICAgICAgDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkYXRhOiBmYWxsYmFjaywNCiAgICAgICAgICAgIHRleHQ6IFN0cmluZyhmYWxsYmFjayB8fCAnJyksDQogICAgICAgICAgICBqc29uOiBmYWxsYmFjaywNCiAgICAgICAgICAgIG51bWJlcjogaXNOYU4oTnVtYmVyKGZhbGxiYWNrKSkgPyAwIDogTnVtYmVyKGZhbGxiYWNrKSwNCiAgICAgICAgICAgIGJvb2xlYW46IEJvb2xlYW4oZmFsbGJhY2spLA0KICAgICAgICAgICAgYmluYXJ5OiBudWxsLA0KICAgICAgICAgICAgb3JpZ2luYWw6IGZhbGxiYWNrLA0KICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UNCiAgICAgICAgfTsNCiAgICB9DQp9DQoNCi8vIFJhbmRvbSBOdW1iZXIgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVJhbmRvbU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgbWluVmFsdWUgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLm1pbl92YWx1ZS52YWx1ZSkgfHwgMDsNCiAgICBjb25zdCBtYXhWYWx1ZSA9IHBhcnNlRmxvYXQobm9kZS5jb25maWcubWF4X3ZhbHVlLnZhbHVlKSB8fCAxMDA7DQogICAgY29uc3QgZGVjaW1hbFBsYWNlcyA9IHBhcnNlSW50KG5vZGUuY29uZmlnLmRlY2ltYWxfcGxhY2VzLnZhbHVlKSB8fCAwOw0KICAgIGNvbnN0IG91dHB1dFR5cGUgPSBub2RlLmNvbmZpZy5vdXRwdXRfdHlwZS52YWx1ZSB8fCAnaW50ZWdlcic7DQoNCiAgICAvLyBWYWxpZGF0ZSByYW5nZQ0KICAgIGlmIChtaW5WYWx1ZSA+PSBtYXhWYWx1ZSkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdSYW5kb206IE1pbmltdW0gdmFsdWUgbXVzdCBiZSBsZXNzIHRoYW4gbWF4aW11bSB2YWx1ZScpOw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgbnVtYmVyOiAwLA0KICAgICAgICAgICAgdGV4dDogJzAnLA0KICAgICAgICAgICAgZGF0YTogJzAnLA0KICAgICAgICAgICAgaW50ZWdlcjogMCwNCiAgICAgICAgICAgIGZsb2F0OiAwLjAsDQogICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgcmFuZ2U6IG1pbmltdW0gbXVzdCBiZSBsZXNzIHRoYW4gbWF4aW11bScNCiAgICAgICAgfTsNCiAgICB9DQoNCiAgICB0cnkgew0KICAgICAgICAvLyBHZW5lcmF0ZSByYW5kb20gbnVtYmVyIGJldHdlZW4gbWluIGFuZCBtYXgNCiAgICAgICAgbGV0IHJhbmRvbVZhbHVlID0gTWF0aC5yYW5kb20oKSAqIChtYXhWYWx1ZSAtIG1pblZhbHVlKSArIG1pblZhbHVlOw0KDQogICAgICAgIC8vIEFwcGx5IG91dHB1dCB0eXBlIGFuZCBkZWNpbWFsIHBsYWNlcw0KICAgICAgICBpZiAob3V0cHV0VHlwZSA9PT0gJ2ludGVnZXInIHx8IGRlY2ltYWxQbGFjZXMgPT09IDApIHsNCiAgICAgICAgICAgIHJhbmRvbVZhbHVlID0gTWF0aC5yb3VuZChyYW5kb21WYWx1ZSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByYW5kb21WYWx1ZSA9IHBhcnNlRmxvYXQocmFuZG9tVmFsdWUudG9GaXhlZChkZWNpbWFsUGxhY2VzKSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgbm9kZS5sYXN0UmFuZG9tVmFsdWUgPSByYW5kb21WYWx1ZTsNCiAgICAgICAgbm9kZS5sYXN0UmFuZ2UgPSBgJHttaW5WYWx1ZX0gLSAke21heFZhbHVlfWA7DQogICAgICAgIG5vZGUubGFzdE91dHB1dFR5cGUgPSBvdXRwdXRUeXBlOw0KDQogICAgICAgIGNvbnNvbGUubG9nKGBSYW5kb206IEdlbmVyYXRlZCAke3JhbmRvbVZhbHVlfSAoJHtvdXRwdXRUeXBlfSkgaW4gcmFuZ2UgJHttaW5WYWx1ZX0tJHttYXhWYWx1ZX1gKTsNCg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgbnVtYmVyOiByYW5kb21WYWx1ZSwNCiAgICAgICAgICAgIHRleHQ6IFN0cmluZyhyYW5kb21WYWx1ZSksIC8vIENvbnZlcnQgdG8gc3RyaW5nIGZvciBWRlMgY29tcGF0aWJpbGl0eQ0KICAgICAgICAgICAgZGF0YTogU3RyaW5nKHJhbmRvbVZhbHVlKSwgLy8gQ29udmVydCB0byBzdHJpbmcgZm9yIFZGUyBjb21wYXRpYmlsaXR5ICANCiAgICAgICAgICAgIGludGVnZXI6IE1hdGgucm91bmQocmFuZG9tVmFsdWUpLA0KICAgICAgICAgICAgZmxvYXQ6IHBhcnNlRmxvYXQocmFuZG9tVmFsdWUudG9GaXhlZChNYXRoLm1heChkZWNpbWFsUGxhY2VzLCAxKSkpDQogICAgICAgIH07DQoNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdSYW5kb20gZXhlY3V0aW9uIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIG51bWJlcjogMCwNCiAgICAgICAgICAgIHRleHQ6ICcwJywNCiAgICAgICAgICAgIGRhdGE6ICcwJywNCiAgICAgICAgICAgIGludGVnZXI6IDAsDQogICAgICAgICAgICBmbG9hdDogMC4wLA0KICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UNCiAgICAgICAgfTsNCiAgICB9DQp9DQoNCi8vIEV4cG9ydCB0byBnbG9iYWwgc2NvcGUNCndpbmRvdy5kYXRhRXhlY3V0b3JzID0gew0KICAgIGV4ZWN1dGVUZXh0Tm9kZSwNCiAgICBleGVjdXRlSnNvbkV4dHJhY3ROb2RlLA0KICAgIGV4ZWN1dGVSYW5kb21RdW90ZU5vZGUsDQogICAgZXhlY3V0ZU1hdGhOb2RlLA0KICAgIGV4ZWN1dGVBcnJheU5vZGUsDQogICAgZXhlY3V0ZVN0cmluZ05vZGUsDQogICAgZXhlY3V0ZU5vZGVSZWZlcmVuY2VOb2RlLA0KICAgIGV4ZWN1dGVSYW5kb21Ob2RlDQp9Ow0KDQoNCi8vIEhUVFAgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUh0dHBOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IHVybCA9IG5vZGUuY29uZmlnLnVybC52YWx1ZTsNCiAgICBjb25zdCBtZXRob2QgPSBub2RlLmNvbmZpZy5tZXRob2QudmFsdWU7DQogICAgY29uc3QgaGVhZGVycyA9IEpTT04ucGFyc2Uobm9kZS5jb25maWcuaGVhZGVycy52YWx1ZSB8fCAne30nKTsNCiAgICBjb25zdCBib2R5ID0gbm9kZS5jb25maWcuYm9keS52YWx1ZTsNCiAgICBjb25zdCB1c2VUZW1wbGF0ZSA9IHRydWU7IC8vIEFsd2F5cyBlbmFibGUgdGVtcGxhdGUgcHJvY2Vzc2luZw0KDQogICAgbGV0IHByb2Nlc3NlZEJvZHkgPSBib2R5Ow0KDQogICAgY29uc29sZS5sb2coJ0hUVFAgTm9kZSBEZWJ1ZzonLCB7DQogICAgICAgIGlucHV0RGF0YTogaW5wdXREYXRhLA0KICAgICAgICBvcmlnaW5hbEJvZHk6IGJvZHksDQogICAgICAgIHVzZVRlbXBsYXRlOiB1c2VUZW1wbGF0ZQ0KICAgIH0pOw0KDQogICAgLy8gUHJvY2VzcyB0ZW1wbGF0ZXMgZmlyc3Qgb24gdGhlIHN0cmluZyBib2R5DQogICAgaWYgKHVzZVRlbXBsYXRlICYmIGlucHV0RGF0YSkgew0KICAgICAgICBwcm9jZXNzZWRCb2R5ID0gd2luZG93LmZsb3dFZGl0b3JVdGlscy5wcm9jZXNzVGVtcGxhdGVzKHByb2Nlc3NlZEJvZHksIGlucHV0RGF0YSk7DQogICAgICAgIGNvbnNvbGUubG9nKCdIVFRQIE5vZGUgVGVtcGxhdGUgUHJvY2Vzc2luZzonLCB7DQogICAgICAgICAgICBvcmlnaW5hbEJvZHk6IGJvZHksDQogICAgICAgICAgICBwcm9jZXNzZWRCb2R5OiBwcm9jZXNzZWRCb2R5LA0KICAgICAgICAgICAgaW5wdXREYXRhOiBpbnB1dERhdGENCiAgICAgICAgfSk7DQogICAgfQ0KDQogICAgLy8gVGhlbiBwYXJzZSBhcyBKU09OIGlmIGl0J3MgYSBzdHJpbmcgYW5kIGxvb2tzIGxpa2UgSlNPTg0KICAgIGlmICh0eXBlb2YgcHJvY2Vzc2VkQm9keSA9PT0gJ3N0cmluZycgJiYgcHJvY2Vzc2VkQm9keS50cmltKCkuc3RhcnRzV2l0aCgneycpKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBwcm9jZXNzZWRCb2R5ID0gSlNPTi5wYXJzZShwcm9jZXNzZWRCb2R5KTsNCiAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gcGFyc2UgYm9keSBhcyBKU09OLCB1c2luZyBhcyBzdHJpbmc6JywgZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBVc2UgT1MgcHJveHkgdG8gYnlwYXNzIENPUlMNCiAgICBjb25zdCBwcm94eVJlcXVlc3QgPSB7DQogICAgICAgIHVybDogdXJsLA0KICAgICAgICBtZXRob2Q6IG1ldGhvZCwNCiAgICAgICAgaGVhZGVyczogaGVhZGVycywNCiAgICAgICAgYm9keTogcHJvY2Vzc2VkQm9keSwNCiAgICAgICAgdGltZW91dDogMzANCiAgICB9Ow0KDQoNCiAgICBjb25zdCBwcm94eVJlc3BvbnNlID0gYXdhaXQgc3lwbmV4QVBJLnByb3h5SFRUUChwcm94eVJlcXVlc3QpOw0KDQogICAgaWYgKCFwcm94eVJlc3BvbnNlIHx8IHByb3h5UmVzcG9uc2Uuc3RhdHVzIDwgMjAwIHx8IHByb3h5UmVzcG9uc2Uuc3RhdHVzID49IDMwMCkgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFByb3h5IHJlcXVlc3QgZmFpbGVkOiAke3Byb3h5UmVzcG9uc2U/LnN0YXR1cyB8fCAnVW5rbm93biBlcnJvcid9YCk7DQogICAgfQ0KDQogICAgY29uc3QgcHJveHlEYXRhID0gcHJveHlSZXNwb25zZTsNCg0KICAgIGlmIChwcm94eURhdGEuZXJyb3IpIHsNCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIHJlcXVlc3QgZmFpbGVkOiAke3Byb3h5RGF0YS5lcnJvcn1gKTsNCiAgICB9DQoNCiAgICAvLyBDaGVjayBpZiByZXNwb25zZSBpcyBiaW5hcnkgKGF1ZGlvLCBpbWFnZSwgZXRjLikNCiAgICBpZiAocHJveHlEYXRhLmlzX2JpbmFyeSkgew0KDQogICAgICAgIC8vIENvbnZlcnQgYmFzZTY0IGNvbnRlbnQgdG8gYmxvYiBmb3IgYmluYXJ5IGRhdGENCiAgICAgICAgY29uc3QgYmluYXJ5RGF0YSA9IGF0b2IocHJveHlEYXRhLmNvbnRlbnQpOw0KICAgICAgICBjb25zdCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGJpbmFyeURhdGEubGVuZ3RoKTsNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaW5hcnlEYXRhLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBieXRlc1tpXSA9IGJpbmFyeURhdGEuY2hhckNvZGVBdChpKTsNCiAgICAgICAgfQ0KICAgICAgICBjb25zdCBjb250ZW50VHlwZSA9IHByb3h5RGF0YS5oZWFkZXJzWydjb250ZW50LXR5cGUnXSB8fCBwcm94eURhdGEuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gfHwgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSc7DQogICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbYnl0ZXNdLCB7IHR5cGU6IGNvbnRlbnRUeXBlIH0pOw0KDQogICAgICAgIC8vIFJldHVybiBzdHJ1Y3R1cmVkIG91dHB1dCBmb3IgYmluYXJ5IHJlc3BvbnNlcyB3aXRoIGFsbCBwb3J0cw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgb3JpZ2luYWxfZGF0YTogYmxvYiwNCiAgICAgICAgICAgIHByb2Nlc3NlZF9kYXRhOiBibG9iLA0KICAgICAgICAgICAgcmVzcG9uc2U6IGJsb2IsDQogICAgICAgICAgICBzdGF0dXNfY29kZTogcHJveHlEYXRhLnN0YXR1cyB8fCAyMDAsDQogICAgICAgICAgICBoZWFkZXJzOiBwcm94eURhdGEuaGVhZGVycyB8fCB7fSwNCiAgICAgICAgICAgIHBhcnNlZF9qc29uOiBudWxsLA0KICAgICAgICAgICAgLy8gQWxzbyBwcm92aWRlIHRoZSByYXcgcmVzcG9uc2UgYXMgJ2RhdGEnIGZvciBjb21wYXRpYmlsaXR5DQogICAgICAgICAgICBkYXRhOiBibG9iLA0KICAgICAgICAgICAgLy8gQWRkIHRoZSBtaXNzaW5nIG91dHB1dCBwb3J0cyBmcm9tIG5vZGUgZGVmaW5pdGlvbg0KICAgICAgICAgICAgdGV4dDogbnVsbCwNCiAgICAgICAgICAgIGpzb246IG51bGwsDQogICAgICAgICAgICB1cmw6IHVybCwNCiAgICAgICAgICAgIGJpbmFyeTogYnl0ZXMsICAvLyBSYXcgYmluYXJ5IGRhdGEgYXMgVWludDhBcnJheQ0KICAgICAgICAgICAgYmxvYjogYmxvYiAgICAgIC8vIEJsb2Igb2JqZWN0IGZvciBjb21wYXRpYmlsaXR5DQogICAgICAgIH07DQogICAgfQ0KDQogICAgLy8gRm9yIHRleHQgcmVzcG9uc2VzLCB0cnkgdG8gcGFyc2UgYXMgSlNPTiBhbmQgcmV0dXJuIHN0cnVjdHVyZWQgb3V0cHV0DQoNCiAgICBsZXQgcGFyc2VkSnNvbiA9IG51bGw7DQogICAgdHJ5IHsNCiAgICAgICAgLy8gVHJ5IHRvIHBhcnNlIGFzIEpTT04NCiAgICAgICAgcGFyc2VkSnNvbiA9IEpTT04ucGFyc2UocHJveHlEYXRhLmNvbnRlbnQpOw0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICB9DQoNCiAgICAvLyBSZXR1cm4gc3RydWN0dXJlZCBvdXRwdXQgZm9yIHRleHQgcmVzcG9uc2VzIG1hdGNoaW5nIG5ldyBub2RlIGFyY2hpdGVjdHVyZQ0KICAgIHJldHVybiB7DQogICAgICAgIG9yaWdpbmFsX2RhdGE6IHByb3h5RGF0YS5jb250ZW50LA0KICAgICAgICBwcm9jZXNzZWRfZGF0YTogcGFyc2VkSnNvbiB8fCBwcm94eURhdGEuY29udGVudCwNCiAgICAgICAgcmVzcG9uc2U6IHByb3h5RGF0YS5jb250ZW50LA0KICAgICAgICBzdGF0dXNfY29kZTogcHJveHlEYXRhLnN0YXR1cyB8fCAyMDAsDQogICAgICAgIGhlYWRlcnM6IHByb3h5RGF0YS5oZWFkZXJzIHx8IHt9LA0KICAgICAgICBwYXJzZWRfanNvbjogcGFyc2VkSnNvbiwNCiAgICAgICAgLy8gQWxzbyBwcm92aWRlIHRoZSByYXcgcmVzcG9uc2UgYXMgJ2RhdGEnIGZvciBjb21wYXRpYmlsaXR5DQogICAgICAgIGRhdGE6IHByb3h5RGF0YS5jb250ZW50LA0KICAgICAgICAvLyBBZGQgdGhlIG1pc3Npbmcgb3V0cHV0IHBvcnRzIGZyb20gbm9kZSBkZWZpbml0aW9uDQogICAgICAgIHRleHQ6IHByb3h5RGF0YS5jb250ZW50LA0KICAgICAgICBqc29uOiBwYXJzZWRKc29uLA0KICAgICAgICB1cmw6IHVybA0KICAgIH07DQp9DQoNCi8vIFZGUyBMb2FkIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVWZnNMb2FkTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBsZXQgZmlsZVBhdGggPSBub2RlLmNvbmZpZy5maWxlX3BhdGgudmFsdWU7DQogICAgY29uc3QgZm9ybWF0ID0gbm9kZS5jb25maWcuZm9ybWF0LnZhbHVlOw0KDQogICAgLy8gUHJvY2VzcyB0ZW1wbGF0ZSB2YXJpYWJsZXMgaW4gZmlsZSBwYXRoDQogICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpOw0KICAgIGNvbnN0IGRhdGVUZW1wbGF0ZXMgPSB7DQogICAgICAgICd7e0RBVEV9fSc6IGN1cnJlbnREYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSwgLy8gWVlZWS1NTS1ERA0KICAgICAgICAne3tZWVlZfX0nOiBjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCksDQogICAgICAgICd7e01NfX0nOiAoY3VycmVudERhdGUuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSwNCiAgICAgICAgJ3t7RER9fSc6IGN1cnJlbnREYXRlLmdldERhdGUoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyksDQogICAgICAgICd7e1RJTUVTVEFNUH19JzogY3VycmVudERhdGUuZ2V0VGltZSgpLnRvU3RyaW5nKCksDQogICAgICAgICd7e0lTT19EQVRFfX0nOiBjdXJyZW50RGF0ZS50b0lTT1N0cmluZygpDQogICAgfTsNCg0KICAgIC8vIFJlcGxhY2UgYWxsIHRlbXBsYXRlIHZhcmlhYmxlcyB1c2luZyBzaW1wbGUgc3RyaW5nIHJlcGxhY2VtZW50DQogICAgZm9yIChjb25zdCBbdGVtcGxhdGUsIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhkYXRlVGVtcGxhdGVzKSkgew0KICAgICAgICBmaWxlUGF0aCA9IGZpbGVQYXRoLnJlcGxhY2VBbGwodGVtcGxhdGUsIHZhbHVlKTsNCiAgICB9DQoNCg0KICAgIHRyeSB7DQogICAgICAgIGxldCBkYXRhID0gbnVsbDsNCg0KDQogICAgICAgIGlmIChmb3JtYXQgPT09ICdqc29uJykgew0KICAgICAgICAgICAgZGF0YSA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVKU09OKGZpbGVQYXRoKTsNCiAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09ICd0ZXh0Jykgew0KICAgICAgICAgICAgZGF0YSA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVUZXh0KGZpbGVQYXRoKTsNCiAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09ICdibG9iJykgew0KICAgICAgICAgICAgLy8gRm9yIGJsb2IgZm9ybWF0LCByZWFkIGFzIHRleHQgKGRhdGEgVVJMcyBhcmUgc3RvcmVkIGFzIHRleHQpDQogICAgICAgICAgICBkYXRhID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZVRleHQoZmlsZVBhdGgpOw0KICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ2JpbmFyeScpIHsNCiAgICAgICAgICAgIC8vIEZvciBiaW5hcnkgZmlsZXMsIHVzZSB0aGUgbmV3IFN5cG5leEFQSSBtZXRob2QgdG8gZ2V0IEJsb2INCiAgICAgICAgICAgIGRhdGEgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlQmxvYihmaWxlUGF0aCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gZm9ybWF0OiAnICsgZm9ybWF0ICsgJy4gU3VwcG9ydGVkIGZvcm1hdHMgYXJlOiBqc29uLCB0ZXh0LCBibG9iLCBiaW5hcnknKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN0b3JlIHRoZSBsb2FkZWQgZGF0YSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgbm9kZS5sYXN0TG9hZGVkRmlsZSA9IGZpbGVQYXRoOw0KICAgICAgICBub2RlLmxhc3RMb2FkZWREYXRhID0gZGF0YTsNCg0KDQogICAgICAgIC8vIFJldHVybiBzdHJ1Y3R1cmVkIG91dHB1dCB3aXRoIGFwcHJvcHJpYXRlIHBvcnQgbmFtZXMNCiAgICAgICAgY29uc3QgcmVzdWx0ID0gew0KICAgICAgICAgICAgZGF0YTogZGF0YSwNCiAgICAgICAgICAgIGZpbGVfcGF0aDogZmlsZVBhdGgsICAvLyBSZXR1cm4gdGhlIGFjdHVhbCBwcm9jZXNzZWQgZmlsZSBwYXRoIHN0cmluZw0KICAgICAgICAgICAganNvbl9kYXRhOiBmb3JtYXQgPT09ICdqc29uJyA/IGRhdGEgOiBudWxsDQogICAgICAgIH07DQogICAgICAgIHJldHVybiByZXN1bHQ7DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVkZTIExvYWQgZXJyb3I6Jywgew0KICAgICAgICAgICAgb3JpZ2luYWxQYXRoOiBub2RlLmNvbmZpZy5maWxlX3BhdGgudmFsdWUsDQogICAgICAgICAgICBwcm9jZXNzZWRQYXRoOiBmaWxlUGF0aCwNCiAgICAgICAgICAgIGZvcm1hdDogZm9ybWF0LA0KICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsDQogICAgICAgICAgICBlcnJvclN0YWNrOiBlcnJvci5zdGFjaw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIHsgZGF0YTogbnVsbCwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTsNCiAgICB9DQp9DQoNCg0KLy8gVkZTIFNhdmUgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVZmc1NhdmVOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGZpbGVQYXRoID0gbm9kZS5jb25maWcuZmlsZV9wYXRoLnZhbHVlOw0KICAgIGNvbnN0IGZvcm1hdCA9IG5vZGUuY29uZmlnLmZvcm1hdC52YWx1ZTsNCiAgICBjb25zdCBvdmVyd3JpdGUgPSBub2RlLmNvbmZpZy5vdmVyd3JpdGUudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCBhcHBlbmQgPSBub2RlLmNvbmZpZy5hcHBlbmQudmFsdWUgPT09ICd0cnVlJzsNCg0KICAgIHRyeSB7DQogICAgICAgIGxldCBkYXRhID0gaW5wdXREYXRhLmRhdGE7DQogICAgICAgIGxldCBzdWNjZXNzID0gZmFsc2U7DQoNCiAgICAgICAgY29uc29sZS5sb2coJ1ZGUyBTYXZlIERlYnVnOicsIHsNCiAgICAgICAgICAgIGZpbGVQYXRoOiBmaWxlUGF0aCwNCiAgICAgICAgICAgIGZvcm1hdDogZm9ybWF0LA0KICAgICAgICAgICAgb3ZlcndyaXRlOiBvdmVyd3JpdGUsDQogICAgICAgICAgICBhcHBlbmQ6IGFwcGVuZCwNCiAgICAgICAgICAgIGRhdGFUeXBlOiB0eXBlb2YgZGF0YSwNCiAgICAgICAgICAgIGRhdGE6IGRhdGENCiAgICAgICAgfSk7DQoNCiAgICAgICAgaWYgKGZvcm1hdCA9PT0gJ2pzb24nKSB7DQogICAgICAgICAgICAvLyBGb3IgSlNPTiBmb3JtYXQgd2l0aCBhcHBlbmQgbW9kZSwgd2UgbmVlZCB0byBoYW5kbGUgaXQgc3BlY2lhbGx5DQogICAgICAgICAgICBpZiAoYXBwZW5kICYmICFvdmVyd3JpdGUpIHsNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcmVhZCBleGlzdGluZyBmaWxlIGZpcnN0DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nRGF0YSA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVKU09OKGZpbGVQYXRoKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZXhpc3RpbmdEYXRhKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgZXhpc3RpbmcgZGF0YSBpcyBhbiBhcnJheSwgYXBwZW5kIHRvIGl0DQogICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ0RhdGEucHVzaChkYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBleGlzdGluZ0RhdGE7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBleGlzdGluZyBkYXRhIGlzIG5vdCBhbiBhcnJheSwgY3JlYXRlIGEgbmV3IGFycmF5DQogICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gW2V4aXN0aW5nRGF0YSwgZGF0YV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICAvLyBGaWxlIGRvZXNuJ3QgZXhpc3Qgb3IgY2FuJ3QgYmUgcmVhZCwgY3JlYXRlIG5ldyBhcnJheQ0KICAgICAgICAgICAgICAgICAgICBkYXRhID0gW2RhdGFdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHN1Y2Nlc3MgPSBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZUpTT04oZmlsZVBhdGgsIGRhdGEpOw0KICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ3RleHQnKSB7DQogICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgLy8gRm9yIHRleHQgZm9ybWF0IHdpdGggYXBwZW5kIG1vZGUNCiAgICAgICAgICAgICAgICBpZiAoYXBwZW5kICYmICFvdmVyd3JpdGUpIHsNCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyeSB0byByZWFkIGV4aXN0aW5nIGZpbGUgZmlyc3QNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nVGV4dCA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVUZXh0KGZpbGVQYXRoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBleGlzdGluZ1RleHQgKyAnXG4nICsgZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbGUgZG9lc24ndCBleGlzdCwgdXNlIGRhdGEgYXMtaXMNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBzdWNjZXNzID0gYXdhaXQgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGUoZmlsZVBhdGgsIGRhdGEpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RleHQgZm9ybWF0IHJlcXVpcmVzIHN0cmluZyBkYXRhLCByZWNlaXZlZDogJyArIHR5cGVvZiBkYXRhICsgJy4gVXNlIEpTT04gZm9ybWF0IGZvciBvYmplY3RzLicpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ2JpbmFyeScpIHsNCiAgICAgICAgICAgIC8vIEhhbmRsZSBiaW5hcnkgZGF0YSBwcm9wZXJseSB1c2luZyB0aGUgYmluYXJ5IHVwbG9hZCBlbmRwb2ludA0KICAgICAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7DQogICAgICAgICAgICAgICAgLy8gVXNlIHRoZSBiaW5hcnkgdXBsb2FkIG1ldGhvZCBmb3IgcmF3IGJpbmFyeSBkYXRhDQogICAgICAgICAgICAgICAgc3VjY2VzcyA9IGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlQmluYXJ5KGZpbGVQYXRoLCBkYXRhKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy8gQmluYXJ5IGZvcm1hdCBvbmx5IHN1cHBvcnRzIFVpbnQ4QXJyYXkgZm9yIHJhdyBiaW5hcnkgZGF0YQ0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQmluYXJ5IGZvcm1hdCByZXF1aXJlcyBVaW50OEFycmF5IGRhdGEgZm9yIHJhdyBiaW5hcnksIHJlY2VpdmVkOiAnICsgdHlwZW9mIGRhdGEgKyAnLiBVc2UgYmxvYiBmb3JtYXQgZm9yIEJsb2IgZGF0YS4nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09ICdibG9iJykgew0KICAgICAgICAgICAgLy8gSGFuZGxlIEJsb2IgdG8gZGF0YSBVUkwgY29udmVyc2lvbg0KICAgICAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBCbG9iKSB7DQogICAgICAgICAgICAgICAgLy8gQ29udmVydCBCbG9iIHRvIGRhdGEgVVJMDQogICAgICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBkYXRhVXJsID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gew0KICAgICAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gKCkgPT4gcmVzb2x2ZShyZWFkZXIucmVzdWx0KTsNCiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLm9uZXJyb3IgPSByZWplY3Q7DQogICAgICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGRhdGEpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZShmaWxlUGF0aCwgZGF0YVVybCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQmxvYiBmb3JtYXQgcmVxdWlyZXMgQmxvYiBkYXRhLCByZWNlaXZlZDogJyArIHR5cGVvZiBkYXRhKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIFVua25vd24gZm9ybWF0DQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gZm9ybWF0OiAnICsgZm9ybWF0ICsgJy4gU3VwcG9ydGVkIGZvcm1hdHMgYXJlOiBqc29uLCB0ZXh0LCBiaW5hcnksIGJsb2InKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHN1Y2Nlc3MgfTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdWRlMgU2F2ZSBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9Ow0KICAgIH0NCn0NCg0KLy8gVkZTIERpcmVjdG9yeSBMaXN0IE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVWZnNEaXJlY3RvcnlMaXN0Tm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBsZXQgZGlyZWN0b3J5UGF0aCA9IG5vZGUuY29uZmlnLmRpcmVjdG9yeV9wYXRoLnZhbHVlOw0KICAgIGNvbnN0IGZpbHRlckV4dGVuc2lvbnMgPSBub2RlLmNvbmZpZy5maWx0ZXJfZXh0ZW5zaW9ucy52YWx1ZTsNCiAgICBjb25zdCBpbmNsdWRlRGlyZWN0b3JpZXMgPSBub2RlLmNvbmZpZy5pbmNsdWRlX2RpcmVjdG9yaWVzLnZhbHVlID09PSAndHJ1ZSc7DQogICAgY29uc3QgcmVjdXJzaXZlID0gbm9kZS5jb25maWcucmVjdXJzaXZlLnZhbHVlID09PSAndHJ1ZSc7DQoNCiAgICAvLyBEZWJ1ZyBsb2dnaW5nDQogICAgY29uc29sZS5sb2coJ1ZGUyBEaXJlY3RvcnkgTGlzdCBEZWJ1ZzonLCB7DQogICAgICAgIGNvbmZpZ1ZhbHVlOiBub2RlLmNvbmZpZy5kaXJlY3RvcnlfcGF0aC52YWx1ZSwNCiAgICAgICAgaW5wdXREYXRhOiBpbnB1dERhdGEsDQogICAgICAgIGluaXRpYWxEaXJlY3RvcnlQYXRoOiBkaXJlY3RvcnlQYXRoDQogICAgfSk7DQoNCiAgICAvLyBVc2UgaW5wdXQgcGF0aCBpZiBwcm92aWRlZCwgb3RoZXJ3aXNlIHVzZSBjb25maWcNCiAgICBpZiAoaW5wdXREYXRhICYmIGlucHV0RGF0YS5kaXJlY3RvcnlfcGF0aCkgew0KICAgICAgICBkaXJlY3RvcnlQYXRoID0gaW5wdXREYXRhLmRpcmVjdG9yeV9wYXRoOw0KICAgICAgICBjb25zb2xlLmxvZygnVXNpbmcgaW5wdXQgZGlyZWN0b3J5IHBhdGg6JywgZGlyZWN0b3J5UGF0aCk7DQogICAgfQ0KDQogICAgLy8gRW5zdXJlIGRpcmVjdG9yeVBhdGggaXMgYSBzdHJpbmcgYW5kIG5vdCBlbXB0eQ0KICAgIGlmICh0eXBlb2YgZGlyZWN0b3J5UGF0aCAhPT0gJ3N0cmluZycgfHwgIWRpcmVjdG9yeVBhdGgpIHsNCiAgICAgICAgZGlyZWN0b3J5UGF0aCA9ICcvJzsNCiAgICAgICAgY29uc29sZS5sb2coJ1Jlc2V0IGRpcmVjdG9yeSBwYXRoIHRvIHJvb3Q6JywgZGlyZWN0b3J5UGF0aCk7DQogICAgfQ0KDQogICAgLy8gUHJvY2VzcyB0ZW1wbGF0ZSB2YXJpYWJsZXMgaW4gZGlyZWN0b3J5IHBhdGgNCiAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgY29uc3QgZGF0ZVRlbXBsYXRlcyA9IHsNCiAgICAgICAgJ3t7REFURX19JzogY3VycmVudERhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdLA0KICAgICAgICAne3tZWVlZfX0nOiBjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCksDQogICAgICAgICd7e01NfX0nOiAoY3VycmVudERhdGUuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSwNCiAgICAgICAgJ3t7RER9fSc6IGN1cnJlbnREYXRlLmdldERhdGUoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyksDQogICAgICAgICd7e1RJTUVTVEFNUH19JzogY3VycmVudERhdGUuZ2V0VGltZSgpLnRvU3RyaW5nKCksDQogICAgICAgICd7e0lTT19EQVRFfX0nOiBjdXJyZW50RGF0ZS50b0lTT1N0cmluZygpDQogICAgfTsNCg0KICAgIGZvciAoY29uc3QgW3RlbXBsYXRlLCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZGF0ZVRlbXBsYXRlcykpIHsNCiAgICAgICAgZGlyZWN0b3J5UGF0aCA9IGRpcmVjdG9yeVBhdGgucmVwbGFjZUFsbCh0ZW1wbGF0ZSwgdmFsdWUpOw0KICAgIH0NCg0KICAgIGNvbnNvbGUubG9nKCdGaW5hbCBkaXJlY3RvcnkgcGF0aCBiZWZvcmUgQVBJIGNhbGw6JywgZGlyZWN0b3J5UGF0aCk7DQoNCiAgICB0cnkgew0KICAgICAgICAvLyBVc2UgdGhlIGV4aXN0aW5nIHN5cG5leEFQSS5saXN0VmlydHVhbEZpbGVzIG1ldGhvZA0KICAgICAgICBjb25zdCBmaWxlTGlzdERhdGEgPSBhd2FpdCBzeXBuZXhBUEkubGlzdFZpcnR1YWxGaWxlcyhkaXJlY3RvcnlQYXRoKTsNCiAgICAgICAgDQogICAgICAgIGlmICghZmlsZUxpc3REYXRhIHx8ICFmaWxlTGlzdERhdGEuaXRlbXMpIHsNCiAgICAgICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgICAgIGVycm9yOiBgRGlyZWN0b3J5IG5vdCBmb3VuZCBvciBlbXB0eTogJHtkaXJlY3RvcnlQYXRofWAsDQogICAgICAgICAgICAgICAgZmlsZV9saXN0OiBbXSwNCiAgICAgICAgICAgICAgICBmaWxlX3BhdGhzOiBbXSwNCiAgICAgICAgICAgICAgICBmaWxlX25hbWVzOiBbXSwNCiAgICAgICAgICAgICAgICBjb3VudDogMCwNCiAgICAgICAgICAgICAgICBkaXJlY3RvcmllczogW10sDQogICAgICAgICAgICAgICAgZmlsZXNfb25seTogW10NCiAgICAgICAgICAgIH07DQogICAgICAgIH0NCg0KICAgICAgICBsZXQgYWxsSXRlbXMgPSBmaWxlTGlzdERhdGEuaXRlbXM7DQogICAgICAgIA0KICAgICAgICAvLyBIYW5kbGUgcmVjdXJzaXZlIGxpc3RpbmcgaWYgZW5hYmxlZA0KICAgICAgICBpZiAocmVjdXJzaXZlKSB7DQogICAgICAgICAgICBjb25zdCBnZXRBbGxGaWxlc1JlY3Vyc2l2ZSA9IGFzeW5jIChpdGVtcywgYmFzZVBhdGgpID0+IHsNCiAgICAgICAgICAgICAgICBsZXQgYWxsRmlsZXMgPSBbXTsNCiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uaXNfZGlyZWN0b3J5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJQYXRoID0gYmFzZVBhdGggKyAoYmFzZVBhdGguZW5kc1dpdGgoJy8nKSA/ICcnIDogJy8nKSArIGl0ZW0ubmFtZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3ViRGlyRGF0YSA9IGF3YWl0IHN5cG5leEFQSS5saXN0VmlydHVhbEZpbGVzKHN1YlBhdGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJEaXJEYXRhICYmIHN1YkRpckRhdGEuaXRlbXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3ViRmlsZXMgPSBhd2FpdCBnZXRBbGxGaWxlc1JlY3Vyc2l2ZShzdWJEaXJEYXRhLml0ZW1zLCBzdWJQYXRoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsRmlsZXMgPSBhbGxGaWxlcy5jb25jYXQoc3ViRmlsZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgQ291bGQgbm90IHJlYWQgc3ViZGlyZWN0b3J5ICR7c3ViUGF0aH06YCwgZXJyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBhbGxGaWxlcy5wdXNoKHsuLi5pdGVtLCBmdWxsUGF0aDogYmFzZVBhdGggKyAoYmFzZVBhdGguZW5kc1dpdGgoJy8nKSA/ICcnIDogJy8nKSArIGl0ZW0ubmFtZX0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXR1cm4gYWxsRmlsZXM7DQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBhbGxJdGVtcyA9IGF3YWl0IGdldEFsbEZpbGVzUmVjdXJzaXZlKGFsbEl0ZW1zLCBkaXJlY3RvcnlQYXRoKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIEFkZCBmdWxsIHBhdGggZm9yIG5vbi1yZWN1cnNpdmUNCiAgICAgICAgICAgIGFsbEl0ZW1zID0gYWxsSXRlbXMubWFwKGl0ZW0gPT4gKHsNCiAgICAgICAgICAgICAgICAuLi5pdGVtLCANCiAgICAgICAgICAgICAgICBmdWxsUGF0aDogZGlyZWN0b3J5UGF0aCArIChkaXJlY3RvcnlQYXRoLmVuZHNXaXRoKCcvJykgPyAnJyA6ICcvJykgKyBpdGVtLm5hbWUNCiAgICAgICAgICAgIH0pKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEZpbHRlciBieSBmaWxlIGV4dGVuc2lvbnMgaWYgc3BlY2lmaWVkDQogICAgICAgIGxldCBmaWx0ZXJlZEl0ZW1zID0gYWxsSXRlbXM7DQogICAgICAgIGlmIChmaWx0ZXJFeHRlbnNpb25zICYmIGZpbHRlckV4dGVuc2lvbnMudHJpbSgpKSB7DQogICAgICAgICAgICBjb25zdCBleHRlbnNpb25zID0gZmlsdGVyRXh0ZW5zaW9ucy5zcGxpdCgnLCcpLm1hcChleHQgPT4gZXh0LnRyaW0oKS50b0xvd2VyQ2FzZSgpKTsNCiAgICAgICAgICAgIGZpbHRlcmVkSXRlbXMgPSBhbGxJdGVtcy5maWx0ZXIoaXRlbSA9PiB7DQogICAgICAgICAgICAgICAgLy8gQWx3YXlzIGluY2x1ZGUgZGlyZWN0b3JpZXMgaWYgaW5jbHVkZURpcmVjdG9yaWVzIGlzIHRydWUNCiAgICAgICAgICAgICAgICBpZiAoaXRlbS5pc19kaXJlY3RvcnkpIHJldHVybiBpbmNsdWRlRGlyZWN0b3JpZXM7DQogICAgICAgICAgICAgICAgLy8gRm9yIGZpbGVzLCBjaGVjayB0aGUgZXh0ZW5zaW9uDQogICAgICAgICAgICAgICAgY29uc3QgaXRlbUV4dCA9IGl0ZW0ubmFtZS5zcGxpdCgnLicpLnBvcCgpPy50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgICAgIHJldHVybiBleHRlbnNpb25zLmluY2x1ZGVzKGl0ZW1FeHQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBjb25zb2xlLmxvZygnRXh0ZW5zaW9uIGZpbHRlcmluZyBhcHBsaWVkOicsIHsNCiAgICAgICAgICAgICAgICBleHRlbnNpb25zOiBleHRlbnNpb25zLA0KICAgICAgICAgICAgICAgIGJlZm9yZUZpbHRlcjogYWxsSXRlbXMubGVuZ3RoLA0KICAgICAgICAgICAgICAgIGFmdGVyRmlsdGVyOiBmaWx0ZXJlZEl0ZW1zLmxlbmd0aA0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjb25zb2xlLmxvZygnTm8gZXh0ZW5zaW9uIGZpbHRlcmluZyAtIHJldHVybmluZyBhbGwgaXRlbXMnKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFNlcGFyYXRlIGZpbGVzIGFuZCBkaXJlY3Rvcmllcw0KICAgICAgICBjb25zdCBmaWxlcyA9IGZpbHRlcmVkSXRlbXMuZmlsdGVyKGl0ZW0gPT4gIWl0ZW0uaXNfZGlyZWN0b3J5KTsNCiAgICAgICAgY29uc3QgZGlyZWN0b3JpZXMgPSBmaWx0ZXJlZEl0ZW1zLmZpbHRlcihpdGVtID0+IGl0ZW0uaXNfZGlyZWN0b3J5KTsNCiAgICAgICAgDQogICAgICAgIC8vIENyZWF0ZSBvdXRwdXQgYXJyYXlzDQogICAgICAgIGNvbnN0IGZpbGVQYXRocyA9IGZpbGVzLm1hcChmaWxlID0+IGZpbGUuZnVsbFBhdGgpOw0KICAgICAgICBjb25zdCBmaWxlTmFtZXMgPSBmaWxlcy5tYXAoZmlsZSA9PiBmaWxlLm5hbWUpOw0KICAgICAgICBjb25zdCBkaXJlY3RvcnlQYXRocyA9IGRpcmVjdG9yaWVzLm1hcChkaXIgPT4gZGlyLmZ1bGxQYXRoKTsNCg0KICAgICAgICAvLyBGaW5hbCBmaWxlIGxpc3QgYmFzZWQgb24gaW5jbHVkZURpcmVjdG9yaWVzIHNldHRpbmcNCiAgICAgICAgLy8gSWYgaW5jbHVkZURpcmVjdG9yaWVzIGlzIHRydWUsIHJldHVybiBhbGwgZmlsdGVyZWQgaXRlbXMgKGZpbGVzICsgZGlyZWN0b3JpZXMpDQogICAgICAgIC8vIElmIGluY2x1ZGVEaXJlY3RvcmllcyBpcyBmYWxzZSwgcmV0dXJuIG9ubHkgZmlsZXMNCiAgICAgICAgY29uc3QgZmluYWxGaWxlTGlzdCA9IGluY2x1ZGVEaXJlY3RvcmllcyA/IGZpbHRlcmVkSXRlbXMgOiBmaWxlczsNCg0KICAgICAgICBjb25zb2xlLmxvZygnUHJvY2Vzc2luZyByZXN1bHRzOicsIHsNCiAgICAgICAgICAgIHRvdGFsRmlsdGVyZWRJdGVtczogZmlsdGVyZWRJdGVtcy5sZW5ndGgsDQogICAgICAgICAgICBmaWxlc0NvdW50OiBmaWxlcy5sZW5ndGgsDQogICAgICAgICAgICBkaXJlY3Rvcmllc0NvdW50OiBkaXJlY3Rvcmllcy5sZW5ndGgsDQogICAgICAgICAgICBpbmNsdWRlRGlyZWN0b3JpZXM6IGluY2x1ZGVEaXJlY3RvcmllcywNCiAgICAgICAgICAgIGZpbmFsRmlsZUxpc3RDb3VudDogZmluYWxGaWxlTGlzdC5sZW5ndGgNCiAgICAgICAgfSk7DQoNCiAgICAgICAgLy8gU3RvcmUgcmVzdWx0cyBmb3IgY29uZmlnIHBhbmVsIGRpc3BsYXkNCiAgICAgICAgbm9kZS5sYXN0RGlyZWN0b3J5UGF0aCA9IGRpcmVjdG9yeVBhdGg7DQogICAgICAgIG5vZGUubGFzdEZpbGVDb3VudCA9IGZpbmFsRmlsZUxpc3QubGVuZ3RoOw0KICAgICAgICBub2RlLmxhc3RGaWxlTGlzdCA9IGZpbmFsRmlsZUxpc3Q7DQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGZpbGVfbGlzdDogZmluYWxGaWxlTGlzdCwNCiAgICAgICAgICAgIGZpbGVfcGF0aHM6IGZpbGVQYXRocywNCiAgICAgICAgICAgIGZpbGVfbmFtZXM6IGZpbGVOYW1lcywNCiAgICAgICAgICAgIGNvdW50OiBmaW5hbEZpbGVMaXN0Lmxlbmd0aCwNCiAgICAgICAgICAgIGRpcmVjdG9yaWVzOiBkaXJlY3RvcnlQYXRocywNCiAgICAgICAgICAgIGZpbGVzX29ubHk6IGZpbGVzDQogICAgICAgIH07DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1ZGUyBEaXJlY3RvcnkgTGlzdCBlcnJvcjonLCB7DQogICAgICAgICAgICBkaXJlY3RvcnlQYXRoOiBkaXJlY3RvcnlQYXRoLA0KICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsDQogICAgICAgICAgICBlcnJvclN0YWNrOiBlcnJvci5zdGFjaw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSwNCiAgICAgICAgICAgIGZpbGVfbGlzdDogW10sDQogICAgICAgICAgICBmaWxlX3BhdGhzOiBbXSwNCiAgICAgICAgICAgIGZpbGVfbmFtZXM6IFtdLA0KICAgICAgICAgICAgY291bnQ6IDAsDQogICAgICAgICAgICBkaXJlY3RvcmllczogW10sDQogICAgICAgICAgICBmaWxlc19vbmx5OiBbXQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gRXhwb3J0IHRvIGdsb2JhbCBzY29wZQ0Kd2luZG93Lmh0dHBFeGVjdXRvcnMgPSB7DQogICAgZXhlY3V0ZUh0dHBOb2RlLA0KICAgIGV4ZWN1dGVWZnNMb2FkTm9kZSwNCiAgICBleGVjdXRlVmZzU2F2ZU5vZGUsDQogICAgZXhlY3V0ZVZmc0RpcmVjdG9yeUxpc3ROb2RlDQp9Ow0KDQovLyBJbWFnZSBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlSW1hZ2VOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IG1heFByZXZpZXdTaXplID0gbm9kZS5jb25maWcubWF4X3ByZXZpZXdfc2l6ZS52YWx1ZTsNCiAgICBjb25zdCBzaG93SW5mbyA9IG5vZGUuY29uZmlnLnNob3dfaW5mby52YWx1ZSA9PT0gJ3RydWUnOw0KDQogICAgbGV0IGltYWdlRGF0YSA9IGlucHV0RGF0YS5pbWFnZV9kYXRhOw0KICAgIGxldCBpbWFnZVVybCA9IG51bGw7DQogICAgbGV0IGltYWdlSW5mbyA9IG51bGw7DQoNCiAgICAvLyBIYW5kbGUgZGlmZmVyZW50IHR5cGVzIG9mIGltYWdlIGRhdGENCiAgICBpZiAoaW1hZ2VEYXRhIGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICAvLyBDcmVhdGUgb2JqZWN0IFVSTCBmb3IgQmxvYiBkYXRhDQogICAgICAgIGltYWdlVXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChpbWFnZURhdGEpOw0KICAgICAgICBpbWFnZUluZm8gPSB7DQogICAgICAgICAgICB0eXBlOiBpbWFnZURhdGEudHlwZSB8fCAnaW1hZ2UnLA0KICAgICAgICAgICAgc2l6ZTogaW1hZ2VEYXRhLnNpemUNCiAgICAgICAgfTsNCiAgICB9IGVsc2UgaWYgKHR5cGVvZiBpbWFnZURhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgIC8vIENoZWNrIGlmIGl0J3MgYmFzZTY0IGRhdGENCiAgICAgICAgaWYgKGltYWdlRGF0YS5zdGFydHNXaXRoKCdkYXRhOmltYWdlLycpIHx8IGltYWdlRGF0YS5zdGFydHNXaXRoKCdkYXRhOmFwcGxpY2F0aW9uLycpKSB7DQogICAgICAgICAgICAvLyBBbHJlYWR5IGEgZGF0YSBVUkwNCiAgICAgICAgICAgIGltYWdlVXJsID0gaW1hZ2VEYXRhOw0KICAgICAgICB9IGVsc2UgaWYgKGltYWdlRGF0YS5tYXRjaCgvXltBLVphLXowLTkrL10qPXswLDJ9JC8pKSB7DQogICAgICAgICAgICAvLyBMb29rcyBsaWtlIGJhc2U2NCBkYXRhLCBjb252ZXJ0IHRvIGRhdGEgVVJMDQogICAgICAgICAgICAvLyBUcnkgdG8gZGV0ZWN0IGltYWdlIHR5cGUgZnJvbSB0aGUgZGF0YQ0KICAgICAgICAgICAgY29uc3QgaW1hZ2VUeXBlID0gd2luZG93LmZsb3dFZGl0b3JVdGlscy5kZXRlY3RJbWFnZVR5cGVGcm9tQmFzZTY0KGltYWdlRGF0YSk7DQogICAgICAgICAgICBpbWFnZVVybCA9IGBkYXRhOiR7aW1hZ2VUeXBlfTtiYXNlNjQsJHtpbWFnZURhdGF9YDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIEFzc3VtZSBpdCdzIGEgcmVndWxhciBVUkwNCiAgICAgICAgICAgIGltYWdlVXJsID0gaW1hZ2VEYXRhOw0KICAgICAgICB9DQogICAgfSBlbHNlIGlmIChpbWFnZURhdGEgJiYgdHlwZW9mIGltYWdlRGF0YSA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgLy8gSGFuZGxlIG9iamVjdCB3aXRoIGltYWdlIGRhdGENCiAgICAgICAgaWYgKGltYWdlRGF0YS51cmwpIHsNCiAgICAgICAgICAgIGltYWdlVXJsID0gaW1hZ2VEYXRhLnVybDsNCiAgICAgICAgfSBlbHNlIGlmIChpbWFnZURhdGEuZGF0YSkgew0KICAgICAgICAgICAgaW1hZ2VVcmwgPSBpbWFnZURhdGEuZGF0YTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpbWFnZURhdGEuaW5mbykgew0KICAgICAgICAgICAgaW1hZ2VJbmZvID0gaW1hZ2VEYXRhLmluZm87DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBOb3RlOiBSZW1vdmVkIGltYWdlIGRpbWVuc2lvbiBkZXRlY3Rpb24gYXMgaXQncyBub3QgbmVlZGVkDQoNCiAgICAvLyBTdG9yZSBpbWFnZSBkYXRhIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgIG5vZGUubGFzdEltYWdlRGF0YSA9IGltYWdlRGF0YTsNCiAgICBub2RlLmxhc3RJbWFnZVVybCA9IGltYWdlVXJsOw0KICAgIG5vZGUubGFzdEltYWdlSW5mbyA9IGltYWdlSW5mbzsNCg0KICAgIHJldHVybiB7DQogICAgICAgIGltYWdlX2RhdGE6IGltYWdlRGF0YSwNCiAgICAgICAgaW1hZ2VfdXJsOiBpbWFnZVVybCwNCiAgICAgICAgaW1hZ2VfaW5mbzogaW1hZ2VJbmZvLA0KICAgICAgICBkYXRhOiBpbWFnZURhdGENCiAgICB9Ow0KfQ0KDQovLyBBdWRpbyBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlQXVkaW9Ob2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGF1dG9QbGF5ID0gbm9kZS5jb25maWcuYXV0b1BsYXkudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCB2b2x1bWUgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLnZvbHVtZS52YWx1ZSk7DQoNCiAgICBsZXQgYXVkaW9EYXRhID0gaW5wdXREYXRhLmF1ZGlvX2RhdGE7DQoNCg0KICAgIGlmICghYXVkaW9EYXRhKSB7DQogICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYXVkaW8gZGF0YSBwcm92aWRlZCcpOw0KICAgIH0NCg0KICAgIC8vIFN0b3JlIGF1ZGlvIGRhdGEgZm9yIG1hbnVhbCBwbGF5IGJ1dHRvbiBzeXN0ZW0gKGxpa2Ugb2xkIHN5c3RlbSkNCiAgICBub2RlLmF1ZGlvRGF0YSA9IGF1ZGlvRGF0YTsNCiAgICBub2RlLnZvbHVtZSA9IHZvbHVtZTsNCg0KICAgIC8vIENyZWF0ZSBhdWRpbyBlbGVtZW50IGlmIGl0IGRvZXNuJ3QgZXhpc3QgKGxpa2Ugb2xkIHN5c3RlbSkNCiAgICBpZiAoIW5vZGUuYXVkaW9FbGVtZW50KSB7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50ID0gbmV3IEF1ZGlvKCk7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LmNvbnRyb2xzID0gdHJ1ZTsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3R5bGUud2lkdGggPSAnMTAwJSc7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JzsNCiAgICB9DQoNCiAgICAvLyBTZXQgYXVkaW8gc291cmNlIChsaWtlIG9sZCBzeXN0ZW0pDQogICAgaWYgKGF1ZGlvRGF0YSBpbnN0YW5jZW9mIEJsb2IpIHsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChhdWRpb0RhdGEpOw0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGF1ZGlvRGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgaWYgKGF1ZGlvRGF0YS5zdGFydHNXaXRoKCdkYXRhOmF1ZGlvLycpIHx8IGF1ZGlvRGF0YS5zdGFydHNXaXRoKCdkYXRhOmFwcGxpY2F0aW9uLycpKSB7DQogICAgICAgICAgICAvLyBBbHJlYWR5IGEgZGF0YSBVUkwNCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnNyYyA9IGF1ZGlvRGF0YTsNCiAgICAgICAgfSBlbHNlIGlmIChhdWRpb0RhdGEubWF0Y2goL15bQS1aYS16MC05Ky9dKj17MCwyfSQvKSkgew0KICAgICAgICAgICAgLy8gTG9va3MgbGlrZSBiYXNlNjQgZGF0YSwgY29udmVydCB0byBkYXRhIFVSTA0KICAgICAgICAgICAgY29uc3QgYXVkaW9UeXBlID0gJ2F1ZGlvL21wZWcnOyAvLyBEZWZhdWx0IHRvIE1QMywgY291bGQgYmUgZW5oYW5jZWQgdG8gZGV0ZWN0IHR5cGUNCiAgICAgICAgICAgIGNvbnN0IGRhdGFVcmwgPSBgZGF0YToke2F1ZGlvVHlwZX07YmFzZTY0LCR7YXVkaW9EYXRhfWA7DQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zcmMgPSBkYXRhVXJsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSByZWd1bGFyIFVSTA0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gYXVkaW9EYXRhOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gYXVkaW9EYXRhOw0KICAgIH0NCg0KICAgIC8vIFNldCB2b2x1bWUNCiAgICBub2RlLmF1ZGlvRWxlbWVudC52b2x1bWUgPSB2b2x1bWU7DQoNCiAgICAvLyBTdG9yZSBmb3IgY29uZmlnIHBhbmVsIGNvbXBhdGliaWxpdHkNCiAgICBub2RlLmxhc3RBdWRpb0RhdGEgPSBhdWRpb0RhdGE7DQogICAgbm9kZS5sYXN0QXVkaW9VcmwgPSBub2RlLmF1ZGlvRWxlbWVudC5zcmM7DQoNCiAgICAvLyBBdXRvLXBsYXkgaWYgY29uZmlndXJlZA0KICAgIGlmIChhdXRvUGxheSkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgYXdhaXQgbm9kZS5hdWRpb0VsZW1lbnQucGxheSgpOw0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignQXV0by1wbGF5IGZhaWxlZDonLCBlcnJvcik7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBDb252ZXJ0IGF1ZGlvIGRhdGEgdG8gcHJvcGVyIGRhdGEgVVJMIGZvciBWRlMgU2F2ZQ0KICAgIGxldCBkYXRhVXJsRm9yU2F2ZSA9IG51bGw7DQoNCiAgICBpZiAoYXVkaW9EYXRhIGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICAvLyBDb252ZXJ0IEJsb2IgdG8gZGF0YSBVUkwNCiAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgICAgZGF0YVVybEZvclNhdmUgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7DQogICAgICAgICAgICByZWFkZXIub25sb2FkID0gKCkgPT4gcmVzb2x2ZShyZWFkZXIucmVzdWx0KTsNCiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gcmVqZWN0Ow0KICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoYXVkaW9EYXRhKTsNCiAgICAgICAgfSk7DQogICAgfSBlbHNlIGlmICh0eXBlb2YgYXVkaW9EYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICBpZiAoYXVkaW9EYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6YXVkaW8vJykgfHwgYXVkaW9EYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6YXBwbGljYXRpb24vJykpIHsNCiAgICAgICAgICAgIC8vIEFscmVhZHkgYSBkYXRhIFVSTA0KICAgICAgICAgICAgZGF0YVVybEZvclNhdmUgPSBhdWRpb0RhdGE7DQogICAgICAgIH0gZWxzZSBpZiAoYXVkaW9EYXRhLm1hdGNoKC9eW0EtWmEtejAtOSsvXSo9ezAsMn0kLykpIHsNCiAgICAgICAgICAgIC8vIEJhc2U2NCBkYXRhLCBjb252ZXJ0IHRvIGRhdGEgVVJMDQogICAgICAgICAgICBjb25zdCBhdWRpb1R5cGUgPSAnYXVkaW8vbXBlZyc7IC8vIERlZmF1bHQgdG8gTVAzLCBjb3VsZCBiZSBlbmhhbmNlZCB0byBkZXRlY3QgdHlwZQ0KICAgICAgICAgICAgZGF0YVVybEZvclNhdmUgPSBgZGF0YToke2F1ZGlvVHlwZX07YmFzZTY0LCR7YXVkaW9EYXRhfWA7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBSZWd1bGFyIFVSTCwga2VlcCBhcyBpcw0KICAgICAgICAgICAgZGF0YVVybEZvclNhdmUgPSBhdWRpb0RhdGE7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBGYWxsYmFjaw0KICAgICAgICBkYXRhVXJsRm9yU2F2ZSA9IGF1ZGlvRGF0YTsNCiAgICB9DQoNCiAgICByZXR1cm4gew0KICAgICAgICBhdWRpb19kYXRhOiBhdWRpb0RhdGEsDQogICAgICAgIGF1ZGlvX3VybDogbm9kZS5hdWRpb0VsZW1lbnQuc3JjLA0KICAgICAgICBkYXRhOiBkYXRhVXJsRm9yU2F2ZSAgLy8gUmV0dXJuIHRoZSBhY3R1YWwgYXVkaW8gZGF0YSBhcyBkYXRhIFVSTA0KICAgIH07DQp9DQoNCi8vIEV4cG9ydCB0byBnbG9iYWwgc2NvcGUNCndpbmRvdy5tZWRpYUV4ZWN1dG9ycyA9IHsNCiAgICBleGVjdXRlSW1hZ2VOb2RlLA0KICAgIGV4ZWN1dGVBdWRpb05vZGUNCn07DQoNCg0KLy8gVGltZXIgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVRpbWVyTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBpbnRlcnZhbCA9IG5vZGUuY29uZmlnLmludGVydmFsLnZhbHVlOw0KICAgIGNvbnN0IGNvdW50ID0gbm9kZS5jb25maWcuY291bnQudmFsdWU7DQoNCiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsNCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpOw0KICAgICAgICAgICAgcmVzb2x2ZSh7DQogICAgICAgICAgICAgICAgdHJpZ2dlcjogdGltZXN0YW1wLA0KICAgICAgICAgICAgICAgIG9yaWdpbmFsX2RhdGE6IHRpbWVzdGFtcCwNCiAgICAgICAgICAgICAgICBwcm9jZXNzZWRfZGF0YTogdGltZXN0YW1wLA0KICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogdGltZXN0YW1wLA0KICAgICAgICAgICAgICAgIGVsYXBzZWQ6IGludGVydmFsDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSwgaW50ZXJ2YWwpOw0KICAgIH0pOw0KfQ0KDQovLyBEaXNwbGF5IE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVEaXNwbGF5Tm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBmb3JtYXQgPSBub2RlLmNvbmZpZy5mb3JtYXQudmFsdWU7DQogICAgY29uc3QgbWF4TGVuZ3RoID0gbm9kZS5jb25maWcubWF4TGVuZ3RoLnZhbHVlOw0KICAgIGNvbnN0IGlucHV0UG9ydCA9IG5vZGUuY29uZmlnLmlucHV0X3BvcnQ/LnZhbHVlIHx8ICdhdXRvJzsNCg0KICAgIC8vIFRyeSB0byBmaW5kIGNvbnRlbnQgYmFzZWQgb24gY29uZmlndXJlZCBpbnB1dCBwb3J0IG9yIGF1dG8tZGV0ZWN0DQogICAgbGV0IGNvbnRlbnQgPSBudWxsOw0KDQogICAgaWYgKGlucHV0UG9ydCAhPT0gJ2F1dG8nKSB7DQogICAgICAgIC8vIFVzZSB0aGUgc3BlY2lmaWVkIGlucHV0IHBvcnQNCiAgICAgICAgY29udGVudCA9IGlucHV0RGF0YVtpbnB1dFBvcnRdOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIEF1dG8tZGV0ZWN0OiBQcmlvcml0eSBvcmRlcjogdGV4dCwganNvbiwgZGF0YSwgYmluYXJ5DQogICAgICAgIGlmIChpbnB1dERhdGEudGV4dCAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBjb250ZW50ID0gaW5wdXREYXRhLnRleHQ7DQogICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLmpzb24gIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgY29udGVudCA9IGlucHV0RGF0YS5qc29uOw0KICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS5kYXRhICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBpbnB1dERhdGEuZGF0YTsNCiAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGEuYmluYXJ5ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBpbnB1dERhdGEuYmluYXJ5Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gVXNlIHRoZSBmaXJzdCBhdmFpbGFibGUgaW5wdXQNCiAgICAgICAgICAgIGNvbnN0IGZpcnN0SW5wdXQgPSBPYmplY3QudmFsdWVzKGlucHV0RGF0YSlbMF07DQogICAgICAgICAgICBjb250ZW50ID0gZmlyc3RJbnB1dDsNCiAgICAgICAgfQ0KICAgIH0NCg0KDQogICAgLy8gT25seSBjb252ZXJ0IHRvIEpTT04gc3RyaW5nIGlmIGZvcm1hdCBpcyAnanNvbicgb3IgaWYgaXQncyBhbiBvYmplY3QgYW5kIGZvcm1hdCBpcyBub3Qgc3BlY2lmaWVkDQogICAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnb2JqZWN0JyAmJiBmb3JtYXQgPT09ICdqc29uJykgew0KICAgICAgICBjb250ZW50ID0gSlNPTi5zdHJpbmdpZnkoY29udGVudCwgbnVsbCwgMik7DQogICAgfSBlbHNlIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ29iamVjdCcgJiYgZm9ybWF0ID09PSAndGV4dCcpIHsNCiAgICAgICAgLy8gRm9yIHRleHQgZm9ybWF0LCBleHRyYWN0IHRoZSBhY3R1YWwgdmFsdWUgZnJvbSBjb21tb24gZmllbGRzDQogICAgICAgIGlmIChjb250ZW50ID09PSBudWxsKSB7DQogICAgICAgICAgICBjb250ZW50ID0gJ251bGwnOw0KICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoY29udGVudCkpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LmpvaW4oJywgJyk7DQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdvYmplY3QnKSB7DQogICAgICAgICAgICAvLyBMb29rIGZvciB0aGUgYWN0dWFsIHZhbHVlIGluIGNvbW1vbiBmaWVsZHMNCiAgICAgICAgICAgIGlmIChjb250ZW50LmV4dHJhY3RlZF92YWx1ZSAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgY29udGVudCA9IFN0cmluZyhjb250ZW50LmV4dHJhY3RlZF92YWx1ZSk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRlbnQudmFsdWUgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBTdHJpbmcoY29udGVudC52YWx1ZSk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRlbnQudGV4dCAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgY29udGVudCA9IFN0cmluZyhjb250ZW50LnRleHQpOw0KICAgICAgICAgICAgfSBlbHNlIGlmIChjb250ZW50LmRhdGEgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBTdHJpbmcoY29udGVudC5kYXRhKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy8gSWYgbm8gY29tbW9uIGZpZWxkcyBmb3VuZCwganVzdCBzaG93IHRoZSBmaXJzdCB2YWx1ZQ0KICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0VmFsdWUgPSBPYmplY3QudmFsdWVzKGNvbnRlbnQpWzBdOw0KICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBTdHJpbmcoZmlyc3RWYWx1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoY29udGVudCAmJiBjb250ZW50Lmxlbmd0aCA+IG1heExlbmd0aCkgew0KICAgICAgICBjb250ZW50ID0gY29udGVudC5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKSArICcuLi4nOw0KICAgIH0NCg0KICAgIC8vIFVwZGF0ZSBkaXNwbGF5IG5vZGUgY29udGVudA0KICAgIHVwZGF0ZURpc3BsYXlOb2RlQ29udGVudChub2RlLmlkLCBjb250ZW50LCBmb3JtYXQpOw0KDQogICAgcmV0dXJuIHsNCiAgICAgICAgb3JpZ2luYWxfZGF0YTogY29udGVudCwNCiAgICAgICAgZGlzcGxheWVkOiBjb250ZW50LA0KICAgICAgICBwcm9jZXNzZWRfZGF0YTogY29udGVudA0KICAgIH07DQp9DQoNCg0KLy8gUmVwZWF0ZXIgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVJlcGVhdGVyTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBpbnRlcnZhbCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLmludGVydmFsLnZhbHVlKTsNCiAgICBjb25zdCBjb3VudCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLmNvdW50LnZhbHVlKTsNCg0KICAgIC8vIEluaXRpYWxpemUgcmVwZWF0ZXIgc3RhdGUgaWYgbm90IGV4aXN0cw0KICAgIGlmICghbm9kZS5yZXBlYXRlclN0YXRlKSB7DQogICAgICAgIG5vZGUucmVwZWF0ZXJTdGF0ZSA9IHsNCiAgICAgICAgICAgIGNvdW50OiAwLA0KICAgICAgICAgICAgaW50ZXJ2YWw6IG51bGwsDQogICAgICAgICAgICBpc1J1bm5pbmc6IGZhbHNlDQogICAgICAgIH07DQogICAgfQ0KDQogICAgLy8gSWYgdGhpcyBpcyBhIG1hbnVhbCB0cmlnZ2VyIChub3QgZnJvbSBpbnRlcnZhbCksIHN0YXJ0IHRoZSByZXBlYXRlcg0KICAgIGlmICghbm9kZS5yZXBlYXRlclN0YXRlLmlzUnVubmluZykgew0KICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUuaXNSdW5uaW5nID0gdHJ1ZTsNCiAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmNvdW50ID0gMDsNCg0KICAgICAgICAvLyBTdGFydCB0aGUgaW50ZXJ2YWwNCiAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmludGVydmFsID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4gew0KICAgICAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmNvdW50Kys7DQoNCiAgICAgICAgICAgIC8vIEV4ZWN1dGUgdGhlIGNvbm5lY3RlZCB3b3JrZmxvdw0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0ZWROb2RlcyA9IGZpbmRDb25uZWN0ZWROb2Rlcyhub2RlLmlkKTsNCiAgICAgICAgICAgICAgICBjb25zdCBleGVjdXRlZCA9IG5ldyBTZXQoKTsNCg0KICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGVkTm9kZSBvZiBjb25uZWN0ZWROb2Rlcykgew0KICAgICAgICAgICAgICAgICAgICBhd2FpdCBleGVjdXRlTm9kZShjb25uZWN0ZWROb2RlLm5vZGUsIHsgdHJpZ2dlcjogRGF0ZS5ub3coKSB9LCBleGVjdXRlZCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBleGVjdXRpbmcgcmVwZWF0ZXIgd29ya2Zsb3c6JywgZXJyb3IpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBTdG9wIGlmIGNvdW50IGxpbWl0IHJlYWNoZWQNCiAgICAgICAgICAgIGlmIChjb3VudCA+IDAgJiYgbm9kZS5yZXBlYXRlclN0YXRlLmNvdW50ID49IGNvdW50KSB7DQogICAgICAgICAgICAgICAgZW5naW5lLnN0b3BSZXBlYXRlcihub2RlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwgaW50ZXJ2YWwpOw0KICAgIH0NCg0KICAgIHJldHVybiB7IHRyaWdnZXI6IERhdGUubm93KCksIGNvdW50OiBub2RlLnJlcGVhdGVyU3RhdGUuY291bnQsIGlzUnVubmluZzogbm9kZS5yZXBlYXRlclN0YXRlLmlzUnVubmluZyB9Ow0KfQ0KDQovLyBDb25kaXRpb24gTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUNvbmRpdGlvbk5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgb3BlcmF0b3IgPSBub2RlLmNvbmZpZy5vcGVyYXRvci52YWx1ZTsNCiAgICBjb25zdCBjb21wYXJlVmFsdWUgPSBub2RlLmNvbmZpZy5jb21wYXJlX3ZhbHVlLnZhbHVlOw0KICAgIGNvbnN0IGNhc2VTZW5zaXRpdmUgPSBub2RlLmNvbmZpZy5jYXNlX3NlbnNpdGl2ZS52YWx1ZSA9PT0gJ3RydWUnOw0KDQogICAgbGV0IGlucHV0VmFsdWUgPSBpbnB1dERhdGEudmFsdWU7DQogICAgbGV0IHJlc3VsdCA9IGZhbHNlOw0KDQogICAgLy8gQ29udmVydCBpbnB1dCB0byBzdHJpbmcgZm9yIGNvbXBhcmlzb24gaWYgbmVlZGVkDQogICAgbGV0IGlucHV0U3RyID0gU3RyaW5nKGlucHV0VmFsdWUpOw0KICAgIGxldCBjb21wYXJlU3RyID0gU3RyaW5nKGNvbXBhcmVWYWx1ZSk7DQoNCiAgICAvLyBEZWJ1ZyBsb2dnaW5nIGZvciBzdHJpbmcgY29tcGFyaXNvbnMNCg0KICAgIC8vIEhhbmRsZSBjYXNlIHNlbnNpdGl2aXR5DQogICAgaWYgKCFjYXNlU2Vuc2l0aXZlKSB7DQogICAgICAgIGlucHV0U3RyID0gaW5wdXRTdHIudG9Mb3dlckNhc2UoKTsNCiAgICAgICAgY29tcGFyZVN0ciA9IGNvbXBhcmVTdHIudG9Mb3dlckNhc2UoKTsNCiAgICB9DQoNCiAgICAvLyBQZXJmb3JtIGNvbXBhcmlzb24gYmFzZWQgb24gb3BlcmF0b3INCiAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7DQogICAgICAgIGNhc2UgJ2VxdWFscyc6DQogICAgICAgICAgICByZXN1bHQgPSBpbnB1dFN0ciA9PT0gY29tcGFyZVN0cjsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdub3RfZXF1YWxzJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IGlucHV0U3RyICE9PSBjb21wYXJlU3RyOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2dyZWF0ZXJfdGhhbic6DQogICAgICAgICAgICByZXN1bHQgPSBOdW1iZXIoaW5wdXRWYWx1ZSkgPiBOdW1iZXIoY29tcGFyZVZhbHVlKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdsZXNzX3RoYW4nOg0KICAgICAgICAgICAgcmVzdWx0ID0gTnVtYmVyKGlucHV0VmFsdWUpIDwgTnVtYmVyKGNvbXBhcmVWYWx1ZSk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnZ3JlYXRlcl90aGFuX29yX2VxdWFsJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IE51bWJlcihpbnB1dFZhbHVlKSA+PSBOdW1iZXIoY29tcGFyZVZhbHVlKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdsZXNzX3RoYW5fb3JfZXF1YWwnOg0KICAgICAgICAgICAgcmVzdWx0ID0gTnVtYmVyKGlucHV0VmFsdWUpIDw9IE51bWJlcihjb21wYXJlVmFsdWUpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2NvbnRhaW5zJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IGlucHV0U3RyLmluY2x1ZGVzKGNvbXBhcmVTdHIpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ25vdF9jb250YWlucyc6DQogICAgICAgICAgICByZXN1bHQgPSAhaW5wdXRTdHIuaW5jbHVkZXMoY29tcGFyZVN0cik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnc3RhcnRzX3dpdGgnOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIuc3RhcnRzV2l0aChjb21wYXJlU3RyKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdlbmRzX3dpdGgnOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIuZW5kc1dpdGgoY29tcGFyZVN0cik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnaXNfZW1wdHknOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIudHJpbSgpID09PSAnJzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdpc19ub3RfZW1wdHknOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIudHJpbSgpICE9PSAnJzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7DQogICAgfQ0KDQogICAgLy8gU3RvcmUgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgbm9kZS5sYXN0SW5wdXRWYWx1ZSA9IGlucHV0VmFsdWU7DQogICAgbm9kZS5sYXN0Q29tcGFyZVZhbHVlID0gY29tcGFyZVZhbHVlOw0KICAgIG5vZGUubGFzdFJlc3VsdCA9IHJlc3VsdDsNCiAgICBub2RlLmxhc3RPcGVyYXRvciA9IG9wZXJhdG9yOw0KDQogICAgcmV0dXJuIHsgcmVzdWx0OiByZXN1bHQgfTsNCn0NCg0KLy8gTG9naWNhbCBHYXRlIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVMb2dpY2FsR2F0ZU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgaW52ZXJ0ID0gbm9kZS5jb25maWcuaW52ZXJ0LnZhbHVlID09PSAndHJ1ZSc7DQogICAgY29uc3QgZGVzY3JpcHRpb24gPSBub2RlLmNvbmZpZy5kZXNjcmlwdGlvbi52YWx1ZTsNCg0KICAgIGxldCBjb25kaXRpb24gPSBpbnB1dERhdGEuY29uZGl0aW9uOw0KDQogICAgLy8gQ29udmVydCB0byBib29sZWFuIGlmIG5lZWRlZA0KICAgIGlmICh0eXBlb2YgY29uZGl0aW9uID09PSAnc3RyaW5nJykgew0KICAgICAgICBjb25kaXRpb24gPSBjb25kaXRpb24udG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnOw0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbmRpdGlvbiA9PT0gJ251bWJlcicpIHsNCiAgICAgICAgY29uZGl0aW9uID0gY29uZGl0aW9uICE9PSAwOw0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbmRpdGlvbiA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgLy8gSWYgaXQncyBhbiBvYmplY3Qgd2l0aCBhIHJlc3VsdCBmaWVsZCAoZnJvbSBjb25kaXRpb24gbm9kZSkNCiAgICAgICAgY29uZGl0aW9uID0gY29uZGl0aW9uLnJlc3VsdCA9PT0gdHJ1ZTsNCiAgICB9DQoNCiAgICAvLyBBcHBseSBpbnZlcnNpb24gaWYgY29uZmlndXJlZA0KICAgIGlmIChpbnZlcnQpIHsNCiAgICAgICAgY29uZGl0aW9uID0gIWNvbmRpdGlvbjsNCiAgICB9DQoNCiAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICBub2RlLmxhc3RDb25kaXRpb24gPSBjb25kaXRpb247DQogICAgbm9kZS5sYXN0SW52ZXJ0ZWQgPSBpbnZlcnQ7DQogICAgbm9kZS5sYXN0RGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjsNCg0KICAgIC8vIE9ubHkgcmV0dXJuIHRyaWdnZXIgaWYgY29uZGl0aW9uIGlzIHRydWUNCiAgICBpZiAoY29uZGl0aW9uKSB7DQogICAgICAgIHJldHVybiB7IHRyaWdnZXI6IERhdGUubm93KCkgfTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBSZXR1cm4gc3BlY2lhbCBvYmplY3QgdG8gaW5kaWNhdGUgZXhlY3V0aW9uIHNob3VsZCBzdG9wDQogICAgICAgIHJldHVybiB7IF9fc3RvcF9leGVjdXRpb246IHRydWUgfTsNCiAgICB9DQp9DQoNCi8vIEZvciBFYWNoIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVGb3JFYWNoTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBzdG9wT25FcnJvciA9IG5vZGUuY29uZmlnLnN0b3Bfb25fZXJyb3IudmFsdWUgPT09ICd0cnVlJzsNCiAgICANCiAgICAvLyBHZXQgdGhlIGl0ZXJhdGlvbiBkZWxheSBmcm9tIGNvbmZpZyAoaW4gbWlsbGlzZWNvbmRzKQ0KICAgIGNvbnN0IGl0ZXJhdGlvbkRlbGF5ID0gbm9kZS5jb25maWcuaXRlcmF0aW9uX2RlbGF5Py52YWx1ZSB8fCAwOw0KICAgIA0KICAgIC8vIEdldCB0aGUgYXJyYXkgZnJvbSBpbnB1dA0KICAgIGxldCBhcnJheSA9IGlucHV0RGF0YS5hcnJheTsNCiAgICANCiAgICAvLyBJZiBhcnJheSBpcyBub3QgcHJvdmlkZWQsIHRyeSBvdGhlciBjb21tb24gaW5wdXQgbmFtZXMNCiAgICBpZiAoIUFycmF5LmlzQXJyYXkoYXJyYXkpKSB7DQogICAgICAgIGFycmF5ID0gaW5wdXREYXRhLmRhdGEgfHwgaW5wdXREYXRhLmZpbGVfbmFtZXMgfHwgaW5wdXREYXRhLml0ZW1zOw0KICAgIH0NCiAgICANCiAgICAvLyBFbnN1cmUgd2UgaGF2ZSBhIHZhbGlkIGFycmF5DQogICAgaWYgKCFBcnJheS5pc0FycmF5KGFycmF5KSkgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZvciBFYWNoIG5vZGUgcmVxdWlyZXMgYW4gYXJyYXkgaW5wdXQnKTsNCiAgICB9DQoNCiAgICBjb25zb2xlLmxvZygnRm9yIEVhY2ggRGVidWc6Jywgew0KICAgICAgICBhcnJheUxlbmd0aDogYXJyYXkubGVuZ3RoLA0KICAgICAgICBhcnJheVByZXZpZXc6IGFycmF5LnNsaWNlKDAsIDMpLA0KICAgICAgICBzdG9wT25FcnJvcjogc3RvcE9uRXJyb3IsDQogICAgICAgIGl0ZXJhdGlvbkRlbGF5OiBpdGVyYXRpb25EZWxheQ0KICAgIH0pOw0KDQogICAgLy8gSW5pdGlhbGl6ZSBpdGVyYXRpb24gc3RhdGUgaWYgbm90IGV4aXN0cw0KICAgIGlmICghbm9kZS5mb3JFYWNoU3RhdGUpIHsNCiAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUgPSB7DQogICAgICAgICAgICBjdXJyZW50SW5kZXg6IDAsDQogICAgICAgICAgICBhcnJheTogYXJyYXksDQogICAgICAgICAgICBpc0l0ZXJhdGluZzogZmFsc2UsDQogICAgICAgICAgICBpc0V4ZWN1dGluZ0l0ZXJhdGlvbjogZmFsc2UsDQogICAgICAgICAgICBpbnRlcnZhbDogbnVsbA0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgIC8vIElmIHRoaXMgaXMgYSBtYW51YWwgdHJpZ2dlciAobm90IGZyb20gaW50ZXJ2YWwpLCBzdGFydCB0aGUgaXRlcmF0b3INCiAgICBpZiAoIW5vZGUuZm9yRWFjaFN0YXRlLmlzSXRlcmF0aW5nKSB7DQogICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmlzSXRlcmF0aW5nID0gdHJ1ZTsNCiAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuY3VycmVudEluZGV4ID0gMDsNCiAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuYXJyYXkgPSBhcnJheTsNCg0KICAgICAgICAvLyBTdGFydCB0aGUgaXRlcmF0aW9uIHByb2Nlc3Npbmcgd2l0aCBwcm9wZXIgdGltaW5nDQogICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmludGVydmFsID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4gew0KICAgICAgICAgICAgLy8gU2tpcCBpZiBwcmV2aW91cyBpdGVyYXRpb24gaXMgc3RpbGwgcnVubmluZw0KICAgICAgICAgICAgaWYgKG5vZGUuZm9yRWFjaFN0YXRlLmlzRXhlY3V0aW5nSXRlcmF0aW9uKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZvciBFYWNoOiBTa2lwcGluZyBpdGVyYXRpb24gLSBwcmV2aW91cyBzdGlsbCBydW5uaW5nJyk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAobm9kZS5mb3JFYWNoU3RhdGUuY3VycmVudEluZGV4IDwgbm9kZS5mb3JFYWNoU3RhdGUuYXJyYXkubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaXNFeGVjdXRpbmdJdGVyYXRpb24gPSB0cnVlOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRJdGVtID0gbm9kZS5mb3JFYWNoU3RhdGUuYXJyYXlbbm9kZS5mb3JFYWNoU3RhdGUuY3VycmVudEluZGV4XTsNCiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50SW5kZXggPSBub2RlLmZvckVhY2hTdGF0ZS5jdXJyZW50SW5kZXg7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEZvciBFYWNoIGl0ZXJhdGlvbiAke2N1cnJlbnRJbmRleCArIDF9LyR7bm9kZS5mb3JFYWNoU3RhdGUuYXJyYXkubGVuZ3RofTpgLCBjdXJyZW50SXRlbSk7DQoNCiAgICAgICAgICAgICAgICAvLyBDbGVhciBidWZmZXIgZm9yIG11bHRpLWlucHV0IG5vZGVzIGF0IHN0YXJ0IG9mIGVhY2ggaXRlcmF0aW9uDQogICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5nbG9iYWxOb2RlSW5wdXRCdWZmZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgYW55IGRvd25zdHJlYW0gbXVsdGktaW5wdXQgbm9kZSBidWZmZXJzIHRvIGVuc3VyZSBmcmVzaCBzdGF0ZSBmb3IgdGhpcyBpdGVyYXRpb24NCiAgICAgICAgICAgICAgICAgICAgLy8gQnV0IGJlIG1vcmUgc2VsZWN0aXZlIC0gb25seSBjbGVhciBub2RlcyB0aGF0IGFyZW4ndCBpbW1lZGlhdGUgY2hpbGRyZW4NCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW1tZWRpYXRlQ2hpbGRJZHMgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWxsRG93bnN0cmVhbUlkcyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBub2RlLmlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1tZWRpYXRlQ2hpbGRJZHMucHVzaChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgYWxsIGRvd25zdHJlYW0gbm9kZXMgKGNoaWxkcmVuIG9mIGNoaWxkcmVuKQ0KICAgICAgICAgICAgICAgICAgICBjb25zdCBmaW5kQWxsRG93bnN0cmVhbSA9IChub2RlSWRzLCB2aXNpdGVkID0gbmV3IFNldCgpKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGVJZCBvZiBub2RlSWRzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpc2l0ZWQuaGFzKG5vZGVJZCkpIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2l0ZWQuYWRkKG5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsRG93bnN0cmVhbUlkcy5wdXNoKG5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGRJZHMgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZElkcy5wdXNoKGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5kQWxsRG93bnN0cmVhbShjaGlsZElkcywgdmlzaXRlZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBmaW5kQWxsRG93bnN0cmVhbShpbW1lZGlhdGVDaGlsZElkcyk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGNsZWFyIGJ1ZmZlcnMgZm9yIGRvd25zdHJlYW0gbm9kZXMgdGhhdCBhcmVuJ3QgaW1tZWRpYXRlIGNoaWxkcmVuDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVzVG9DbGVhciA9IGFsbERvd25zdHJlYW1JZHMuZmlsdGVyKGlkID0+ICFpbW1lZGlhdGVDaGlsZElkcy5pbmNsdWRlcyhpZCkpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBub2RlSWQgb2Ygbm9kZXNUb0NsZWFyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93Lmdsb2JhbE5vZGVJbnB1dEJ1ZmZlci5oYXMobm9kZUlkKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5nbG9iYWxOb2RlSW5wdXRCdWZmZXIuZGVsZXRlKG5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYPCfp7kgQ2xlYXJlZCBidWZmZXIgZm9yIGRvd25zdHJlYW0gbm9kZSAke25vZGVJZH0gYXQgc3RhcnQgb2YgaXRlcmF0aW9uICR7Y3VycmVudEluZGV4ICsgMX1gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIEV4ZWN1dGUgdGhlIGNvbm5lY3RlZCB3b3JrZmxvdyAtIHVzZSB0aGUgZXhlY3V0aW9uIGVuZ2luZSBkaXJlY3RseQ0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgbm9kZXMgY29ubmVjdGVkIHRvIHRoZSBjdXJyZW50X2l0ZW0gb3V0cHV0IHBvcnQNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGVkTm9kZXMgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBub2RlLmlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Tm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0Tm9kZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0ZWROb2Rlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGU6IHRhcmdldE5vZGUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFBvcnQ6IGNvbm5lY3Rpb24udG8ucG9ydE5hbWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRQb3J0OiBjb25uZWN0aW9uLmZyb20ucG9ydE5hbWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gU2V0IGFsbCBjb25uZWN0ZWQgbm9kZXMgdG8gcnVubmluZyBzdGF0ZSBiZWZvcmUgZXhlY3V0aW9uDQogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGVkTm9kZUluZm8gb2YgY29ubmVjdGVkTm9kZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ubmVjdGVkTm9kZUluZm8ubm9kZS5pZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjb21wbGV0ZWQnLCAnZXJyb3InLCAnd2FpdGluZy1pbnB1dHMnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdydW5uaW5nJyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBFeGVjdXRlIGVhY2ggY29ubmVjdGVkIG5vZGUgd2l0aCB0aGUgYXBwcm9wcmlhdGUgZGF0YQ0KICAgICAgICAgICAgICAgICAgICAvLyBVc2Ugc2hhcmVkIGJ1ZmZlciBmb3IgdGhlIGVudGlyZSBpdGVyYXRpb24gc28gbXVsdGktaW5wdXQgbm9kZXMgY2FuIGFjY3VtdWxhdGUNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlcmF0aW9uRXhlY3V0ZWQgPSBuZXcgU2V0KCk7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZXJhdGlvbklucHV0QnVmZmVyID0gbmV3IE1hcCgpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gQ29weSBhbnkgZXhpc3RpbmcgYnVmZmVyIGRhdGEgZnJvbSBnbG9iYWwgYnVmZmVyIHRoYXQgbWlnaHQgYmUgbmVlZGVkDQogICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuZ2xvYmFsTm9kZUlucHV0QnVmZmVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtub2RlSWQsIGJ1ZmZlckRhdGFdIG9mIHdpbmRvdy5nbG9iYWxOb2RlSW5wdXRCdWZmZXIuZW50cmllcygpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlcmF0aW9uSW5wdXRCdWZmZXIuc2V0KG5vZGVJZCwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNlaXZlZElucHV0czogeyAuLi5idWZmZXJEYXRhLnJlY2VpdmVkSW5wdXRzIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3RlZFBvcnRzOiBbLi4uYnVmZmVyRGF0YS5jb25uZWN0ZWRQb3J0c10NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0ZWROb2RlSW5mbyBvZiBjb25uZWN0ZWROb2Rlcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGlucHV0VmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hcCB0aGUgRm9yIEVhY2ggb3V0cHV0cyB0byB0aGUgY29ubmVjdGVkIG5vZGUncyBpbnB1dA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm5lY3RlZE5vZGVJbmZvLm91dHB1dFBvcnQgPT09ICdjdXJyZW50X2l0ZW0nKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IGN1cnJlbnRJdGVtOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb25uZWN0ZWROb2RlSW5mby5vdXRwdXRQb3J0ID09PSAnY3VycmVudF9pbmRleCcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb252ZXJ0IGluZGV4IHRvIHN0cmluZyBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIHRleHQtYmFzZWQgbm9kZXMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFZhbHVlID0gU3RyaW5nKGN1cnJlbnRJbmRleCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBjdXJyZW50SXRlbTsgLy8gRGVmYXVsdCB0byBjdXJyZW50IGl0ZW0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGlucHV0IGRhdGEgZm9yIHRoZSBjb25uZWN0ZWQgbm9kZQ0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlucHV0RGF0YSA9IHt9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlucHV0RGF0YVtjb25uZWN0ZWROb2RlSW5mby5pbnB1dFBvcnRdID0gaW5wdXRWYWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdGhlIHdvcmtmbG93IGV4ZWN1dGlvbiBzeXN0ZW0gdG8gZW5zdXJlIGRvd25zdHJlYW0gbm9kZXMgZXhlY3V0ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgd2lsbCB0cmlnZ2VyIHRoZSBjb21wbGV0ZSBleGVjdXRpb24gY2hhaW4gKGxsbSDihpIgaHR0cCDihpIgZXRjLikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBleGVjdXRlTm9kZVNtYXJ0KA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0ZWROb2RlSW5mby5ub2RlLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGVkTm9kZUluZm8uaW5wdXRQb3J0LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZXJhdGlvbkV4ZWN1dGVkLCAvLyBVc2Ugc2hhcmVkIGV4ZWN1dGVkIHNldCBmb3IgdGhpcyBpdGVyYXRpb24NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlcmF0aW9uSW5wdXRCdWZmZXIgIC8vIFVzZSBzaGFyZWQgYnVmZmVyIGZvciB0aGlzIGl0ZXJhdGlvbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFyayBub2RlIGFzIGNvbXBsZXRlZCBhZnRlciBzdWNjZXNzZnVsIGV4ZWN1dGlvbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ubmVjdGVkTm9kZUluZm8ubm9kZS5pZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAobm9kZUVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFyayBub2RlIGFzIGVycm9yIGlmIGV4ZWN1dGlvbiBmYWlscw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ubmVjdGVkTm9kZUluZm8ubm9kZS5pZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZXJyb3InKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmUtdGhyb3cgdGhlIGVycm9yIHRvIGJlIGhhbmRsZWQgYnkgdGhlIG91dGVyIGNhdGNoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbm9kZUVycm9yOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIHRoaXMgaXRlcmF0aW9uIGFzIGNvbXBsZXRlDQogICAgICAgICAgICAgICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmlzRXhlY3V0aW5nSXRlcmF0aW9uID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGV4ZWN1dGluZyBmb3IgZWFjaCBpdGVyYXRpb246JywgZXJyb3IpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gTWFyayB0aGlzIGl0ZXJhdGlvbiBhcyBjb21wbGV0ZSBldmVuIG9uIGVycm9yDQogICAgICAgICAgICAgICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmlzRXhlY3V0aW5nSXRlcmF0aW9uID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIGFueSBzdGlsbC1ydW5uaW5nIGNvbm5lY3RlZCBub2RlcyBhcyBlcnJvcg0KICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0ZWROb2RlcyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IG5vZGUuaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXROb2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3RlZE5vZGVzLnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZTogdGFyZ2V0Tm9kZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UG9ydDogY29ubmVjdGlvbi50by5wb3J0TmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFBvcnQ6IGNvbm5lY3Rpb24uZnJvbS5wb3J0TmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGVkTm9kZUluZm8gb2YgY29ubmVjdGVkTm9kZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29ubmVjdGVkTm9kZUluZm8ubm9kZS5pZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQgJiYgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdydW5uaW5nJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZXJyb3InKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgaWYgKHN0b3BPbkVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBTdG9wIHRoZSBpdGVyYXRpb24NCiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwobm9kZS5mb3JFYWNoU3RhdGUuaW50ZXJ2YWwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaXNJdGVyYXRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmludGVydmFsID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIE1vdmUgdG8gbmV4dCBpdGVtDQogICAgICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuY3VycmVudEluZGV4Kys7DQoNCiAgICAgICAgICAgICAgICAvLyBTdG9wIGlmIHdlJ3ZlIHByb2Nlc3NlZCBhbGwgaXRlbXMNCiAgICAgICAgICAgICAgICBpZiAobm9kZS5mb3JFYWNoU3RhdGUuY3VycmVudEluZGV4ID49IG5vZGUuZm9yRWFjaFN0YXRlLmFycmF5Lmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKG5vZGUuZm9yRWFjaFN0YXRlLmludGVydmFsKTsNCiAgICAgICAgICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaXNJdGVyYXRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaW50ZXJ2YWwgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRm9yIEVhY2ggY29tcGxldGVkIGFsbCBpdGVtcycpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gRW5zdXJlIGFsbCBjb25uZWN0ZWQgbm9kZXMgc2hvdyBmaW5hbCBjb21wbGV0ZWQgc3RhdHVzDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3RlZE5vZGVzID0gW107DQogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZS5pZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldE5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGVkTm9kZXMucHVzaCh0YXJnZXROb2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGVkTm9kZSBvZiBjb25uZWN0ZWROb2Rlcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0ZWROb2RlLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCAmJiAhbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlcnJvcicpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycsICd3YWl0aW5nLWlucHV0cycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NvbXBsZXRlZCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LCBpdGVyYXRpb25EZWxheSk7IC8vIFVzZSBjb25maWd1cmFibGUgaXRlcmF0aW9uIGRlbGF5DQogICAgICAgIA0KICAgICAgICAvLyBEb24ndCByZXR1cm4gYW55IGRhdGEgaW1tZWRpYXRlbHkgLSBsZXQgdGhlIGludGVydmFsIGhhbmRsZSBhbGwgZXhlY3V0aW9ucw0KICAgICAgICAvLyBVc2UgYSBzcGVjaWFsIGZsYWcgdG8gcHJldmVudCBtYWluIHdvcmtmbG93IGZyb20gZXhlY3V0aW5nIGRvd25zdHJlYW0gbm9kZXMNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHN0YXJ0ZWQ6IHRydWUsDQogICAgICAgICAgICB0b3RhbF9pdGVtczogYXJyYXkubGVuZ3RoLA0KICAgICAgICAgICAgaXRlcmF0aW9uX2RlbGF5OiBpdGVyYXRpb25EZWxheSwNCiAgICAgICAgICAgIG1lc3NhZ2U6IGBGb3IgRWFjaCBpdGVyYXRpb24gc3RhcnRlZCB3aXRoICR7aXRlcmF0aW9uRGVsYXl9bXMgZGVsYXlgLA0KICAgICAgICAgICAgX19mb3JfZWFjaF9jb250cm9sOiB0cnVlICAvLyBTcGVjaWFsIGZsYWcgdG8gcHJldmVudCBkb3duc3RyZWFtIGV4ZWN1dGlvbiBieSBtYWluIHdvcmtmbG93DQogICAgICAgIH07DQogICAgfQ0KDQogICAgLy8gSWYgYWxyZWFkeSBpdGVyYXRpbmcsIHJldHVybiBjdXJyZW50IHN0YXRlDQogICAgcmV0dXJuIHsNCiAgICAgICAgaXNJdGVyYXRpbmc6IG5vZGUuZm9yRWFjaFN0YXRlLmlzSXRlcmF0aW5nLA0KICAgICAgICBjdXJyZW50X2luZGV4OiBub2RlLmZvckVhY2hTdGF0ZS5jdXJyZW50SW5kZXgsDQogICAgICAgIHRvdGFsX2l0ZW1zOiBub2RlLmZvckVhY2hTdGF0ZS5hcnJheS5sZW5ndGgNCiAgICB9Ow0KfQ0KDQovLyBEZWxheSBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlRGVsYXlOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGRlbGF5TXMgPSBwYXJzZUludChub2RlLmNvbmZpZy5kZWxheV9tcz8udmFsdWUgfHwgbm9kZS5jb25maWcuZGVsYXlfbXMgfHwgMTAwMCk7DQogICAgDQogICAgY29uc29sZS5sb2coYERlbGF5IG5vZGUgc3RhcnRpbmcgJHtkZWxheU1zfW1zIGRlbGF5YCk7DQogICAgDQogICAgLy8gR2V0IHRoZSBpbnB1dCBkYXRhIHRvIHBhc3MgdGhyb3VnaCBhZnRlciBkZWxheQ0KICAgIGxldCBkYXRhVG9QYXNzVGhyb3VnaCA9IGlucHV0RGF0YS5kYXRhOw0KICAgIA0KICAgIC8vIElmIG5vIHNwZWNpZmljIGRhdGEgaW5wdXQsIHVzZSB0aGUgZmlyc3QgYXZhaWxhYmxlIGlucHV0DQogICAgaWYgKGRhdGFUb1Bhc3NUaHJvdWdoID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgY29uc3QgaW5wdXRLZXlzID0gT2JqZWN0LmtleXMoaW5wdXREYXRhKTsNCiAgICAgICAgaWYgKGlucHV0S2V5cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBkYXRhVG9QYXNzVGhyb3VnaCA9IGlucHV0RGF0YVtpbnB1dEtleXNbMF1dOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIC8vIFdhaXQgZm9yIHRoZSBzcGVjaWZpZWQgZGVsYXkNCiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsNCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICBjb25zb2xlLmxvZyhgRGVsYXkgbm9kZSBjb21wbGV0ZWQgYWZ0ZXIgJHtkZWxheU1zfW1zYCk7DQogICAgICAgICAgICByZXNvbHZlKCk7DQogICAgICAgIH0sIGRlbGF5TXMpOw0KICAgIH0pOw0KICAgIA0KICAgIC8vIFJldHVybiB0aGUgc2FtZSBkYXRhIHRoYXQgd2FzIGlucHV0DQogICAgcmV0dXJuIHsNCiAgICAgICAgZGF0YTogZGF0YVRvUGFzc1Rocm91Z2gsDQogICAgICAgIG9yaWdpbmFsX2RhdGE6IGRhdGFUb1Bhc3NUaHJvdWdoLA0KICAgICAgICBwcm9jZXNzZWRfZGF0YTogZGF0YVRvUGFzc1Rocm91Z2gsDQogICAgICAgIGRlbGF5X21zOiBkZWxheU1zLA0KICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCkNCiAgICB9Ow0KfQ0KDQovLyBFeHBvcnQgdG8gZ2xvYmFsIHNjb3BlDQp3aW5kb3cuZmxvd0V4ZWN1dG9ycyA9IHsNCiAgICBleGVjdXRlVGltZXJOb2RlLA0KICAgIGV4ZWN1dGVEaXNwbGF5Tm9kZSwNCiAgICBleGVjdXRlUmVwZWF0ZXJOb2RlLA0KICAgIGV4ZWN1dGVDb25kaXRpb25Ob2RlLA0KICAgIGV4ZWN1dGVMb2dpY2FsR2F0ZU5vZGUsDQogICAgZXhlY3V0ZUZvckVhY2hOb2RlLA0KICAgIGV4ZWN1dGVEZWxheU5vZGUNCn07DQoNCg0KLy8gTExNIENoYXQgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUxsbUNoYXROb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGVuZHBvaW50ID0gbm9kZS5jb25maWcuZW5kcG9pbnQudmFsdWU7DQogICAgY29uc3QgbW9kZWwgPSBub2RlLmNvbmZpZy5tb2RlbC52YWx1ZTsNCiAgICBjb25zdCB0ZW1wZXJhdHVyZSA9IHBhcnNlRmxvYXQobm9kZS5jb25maWcudGVtcGVyYXR1cmUudmFsdWUpOw0KICAgIGNvbnN0IG1heFRva2VucyA9IHBhcnNlSW50KG5vZGUuY29uZmlnLm1heF90b2tlbnMudmFsdWUpOw0KICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IG5vZGUuY29uZmlnLnN5c3RlbV9wcm9tcHQudmFsdWU7DQogICAgY29uc3QgaW5jbHVkZUNvbnRleHQgPSBub2RlLmNvbmZpZy5pbmNsdWRlX2NvbnRleHQudmFsdWUgPT09ICd0cnVlJzsNCg0KICAgIC8vIEFjY2VwdCBwcm9tcHQgZnJvbSBlaXRoZXIgJ3Byb21wdCcgb3IgJ3RleHQnIGlucHV0DQogICAgbGV0IHByb21wdCA9IGlucHV0RGF0YS5wcm9tcHQ7DQogICAgaWYgKCFwcm9tcHQgJiYgaW5wdXREYXRhLnRleHQpIHsNCiAgICAgICAgcHJvbXB0ID0gaW5wdXREYXRhLnRleHQ7DQogICAgfQ0KICAgIGlmICghcHJvbXB0ICYmIGlucHV0RGF0YS5jb250ZXh0KSB7DQogICAgICAgIC8vIElmIGNvbnRleHQgaXMgYSBzdHJpbmcsIHVzZSBpdCBhcyBwcm9tcHQNCiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dERhdGEuY29udGV4dCA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIHByb21wdCA9IGlucHV0RGF0YS5jb250ZXh0Ow0KICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS5jb250ZXh0ICYmIHR5cGVvZiBpbnB1dERhdGEuY29udGV4dCA9PT0gJ29iamVjdCcgJiYgaW5wdXREYXRhLmNvbnRleHQudGV4dCkgew0KICAgICAgICAgICAgLy8gSWYgY29udGV4dCBpcyBhbiBvYmplY3Qgd2l0aCB0ZXh0IGZpZWxkLCB1c2UgdGhhdA0KICAgICAgICAgICAgcHJvbXB0ID0gaW5wdXREYXRhLmNvbnRleHQudGV4dDsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBpZiAoIXByb21wdCkgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xMTSBDaGF0IHJlcXVpcmVzIGEgcHJvbXB0IGlucHV0LiBDb25uZWN0IGEgVGV4dCBub2RlIHRvIHByb3ZpZGUgdGhlIHByb21wdC4nKTsNCiAgICB9DQoNCiAgICB0cnkgew0KICAgICAgICBjb25zdCBtZXNzYWdlcyA9IFtdOw0KDQogICAgICAgIGlmIChzeXN0ZW1Qcm9tcHQpIHsNCiAgICAgICAgICAgIG1lc3NhZ2VzLnB1c2goeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH0pOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGluY2x1ZGVDb250ZXh0ICYmIGlucHV0RGF0YS5jb250ZXh0KSB7DQogICAgICAgICAgICBtZXNzYWdlcy5wdXNoKHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiBgQ29udGV4dDogJHtKU09OLnN0cmluZ2lmeShpbnB1dERhdGEuY29udGV4dCl9XG5cblByb21wdDogJHtwcm9tcHR9YCB9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIG1lc3NhZ2VzLnB1c2goeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9KTsNCiAgICAgICAgfQ0KDQogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgc3lwbmV4QVBJLnByb3h5SFRUUCh7DQogICAgICAgICAgICB1cmw6IGAke2VuZHBvaW50fS9jaGF0L2NvbXBsZXRpb25zYCwNCiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLA0KICAgICAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBib2R5OiB7DQogICAgICAgICAgICAgICAgbW9kZWw6IG1vZGVsLA0KICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBtZXNzYWdlcywNCiAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogdGVtcGVyYXR1cmUsDQogICAgICAgICAgICAgICAgbWF4X3Rva2VuczogbWF4VG9rZW5zDQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgICAgIC8vIEhhbmRsZSBwcm94eSByZXNwb25zZSBmb3JtYXQNCiAgICAgICAgaWYgKCFyZXNwb25zZSB8fCByZXNwb25zZS5zdGF0dXMgPCAyMDAgfHwgcmVzcG9uc2Uuc3RhdHVzID49IDMwMCkgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQcm94eSByZXF1ZXN0IGZhaWxlZDogJHtyZXNwb25zZT8uc3RhdHVzIHx8ICdVbmtub3duIGVycm9yJ31gKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChyZXNwb25zZS5lcnJvcikgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBMTE0gcmVxdWVzdCBmYWlsZWQ6ICR7cmVzcG9uc2UuZXJyb3J9YCk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBQYXJzZSB0aGUgSlNPTiByZXNwb25zZSBjb250ZW50IGZyb20gcHJveHkNCiAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2UuY29udGVudCk7DQoNCiAgICAgICAgaWYgKGRhdGEuZXJyb3IpIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihkYXRhLmVycm9yLm1lc3NhZ2UgfHwgJ0xMTSBBUEkgZXJyb3InKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGRhdGEuY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCB8fCAnJzsNCg0KICAgICAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgbm9kZS5sYXN0UmVzcG9uc2UgPSByZXNwb25zZVRleHQ7DQogICAgICAgIG5vZGUubGFzdFVzYWdlID0gZGF0YS51c2FnZTsNCiAgICAgICAgbm9kZS5sYXN0TW9kZWwgPSBtb2RlbDsNCg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgcmVzcG9uc2U6IHJlc3BvbnNlVGV4dCwNCiAgICAgICAgICAgIHRva2Vuc191c2VkOiBkYXRhLnVzYWdlPy50b3RhbF90b2tlbnMgfHwgMCwNCiAgICAgICAgICAgIG1vZGVsX3VzZWQ6IG1vZGVsLA0KICAgICAgICAgICAgZnVsbF9yZXNwb25zZTogZGF0YQ0KICAgICAgICB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0xMTSBDaGF0IGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsgcmVzcG9uc2U6IG51bGwsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07DQogICAgfQ0KfQ0KDQoNCi8vIFRlcm1pbmFsIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVUZXJtaW5hbE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgY29tbWFuZCA9IG5vZGUuY29uZmlnLmNvbW1hbmQudmFsdWU7DQogICAgY29uc3QgdXNlSW5wdXRDb21tYW5kID0gbm9kZS5jb25maWcudXNlX2lucHV0X2NvbW1hbmQudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCB3b3JraW5nRGlyZWN0b3J5ID0gbm9kZS5jb25maWcud29ya2luZ19kaXJlY3RvcnkudmFsdWU7DQogICAgY29uc3QgdGltZW91dCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLnRpbWVvdXQudmFsdWUpOw0KDQogICAgbGV0IGZpbmFsQ29tbWFuZCA9IGNvbW1hbmQ7DQogICAgaWYgKHVzZUlucHV0Q29tbWFuZCAmJiBpbnB1dERhdGEuY29tbWFuZCkgew0KICAgICAgICBmaW5hbENvbW1hbmQgPSBpbnB1dERhdGEuY29tbWFuZDsNCiAgICB9DQoNCiAgICB0cnkgew0KICAgICAgICAvLyBUaGlzIHdvdWxkIG5lZWQgdG8gYmUgaW1wbGVtZW50ZWQgd2l0aCBhY3R1YWwgdGVybWluYWwgZXhlY3V0aW9uDQogICAgICAgIC8vIEZvciBub3csIHdlJ2xsIHJldHVybiBhIHBsYWNlaG9sZGVyDQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIG91dHB1dDogYENvbW1hbmQgZXhlY3V0ZWQ6ICR7ZmluYWxDb21tYW5kfWAsDQogICAgICAgICAgICBzdWNjZXNzOiB0cnVlLA0KICAgICAgICAgICAgZXJyb3I6IG51bGwsDQogICAgICAgICAgICBleGl0X2NvZGU6IDANCiAgICAgICAgfTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdUZXJtaW5hbCBleGVjdXRpb24gZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgb3V0cHV0OiBudWxsLA0KICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSwNCiAgICAgICAgICAgIGV4aXRfY29kZTogMQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gRXhwb3J0IHRvIGdsb2JhbCBzY29wZQ0Kd2luZG93LmFpRXhlY3V0b3JzID0gew0KICAgIGV4ZWN1dGVMbG1DaGF0Tm9kZSwNCiAgICBleGVjdXRlVGVybWluYWxOb2RlDQp9Ow0KDQovLyBleGVjdXRpb24tZW5naW5lLmpzIC0gRHluYW1pYyBleGVjdXRpb24gZW5naW5lIGZvciBGbG93IEVkaXRvcg0KDQpjbGFzcyBFeGVjdXRpb25FbmdpbmUgew0KICAgIGNvbnN0cnVjdG9yKHJlZ2lzdHJ5KSB7DQogICAgICAgIHRoaXMucmVnaXN0cnkgPSByZWdpc3RyeTsNCiAgICAgICAgdGhpcy5zZXR1cEV4ZWN1dG9ycygpOw0KICAgIH0NCg0KICAgIHNldHVwRXhlY3V0b3JzKCkgew0KICAgICAgICAvLyBSZWdpc3RlciBleGVjdXRvcnMgZnJvbSBleHRlcm5hbCBmaWxlcyB3aXRoIGVuZ2luZSBpbnN0YW5jZSBwYXNzZWQgYXMgZmlyc3QgcGFyYW1ldGVyDQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignaHR0cF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5odHRwRXhlY3V0b3JzLmV4ZWN1dGVIdHRwTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigndmZzX3NhdmVfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuaHR0cEV4ZWN1dG9ycy5leGVjdXRlVmZzU2F2ZU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3Zmc19sb2FkX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93Lmh0dHBFeGVjdXRvcnMuZXhlY3V0ZVZmc0xvYWROb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd2ZnNfZGlyZWN0b3J5X2xpc3RfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuaHR0cEV4ZWN1dG9ycy5leGVjdXRlVmZzRGlyZWN0b3J5TGlzdE5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICAgICAgDQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigndGltZXJfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZmxvd0V4ZWN1dG9ycy5leGVjdXRlVGltZXJOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdkaXNwbGF5X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmZsb3dFeGVjdXRvcnMuZXhlY3V0ZURpc3BsYXlOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdyZXBlYXRlcl9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5mbG93RXhlY3V0b3JzLmV4ZWN1dGVSZXBlYXRlck5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2NvbmRpdGlvbl9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5mbG93RXhlY3V0b3JzLmV4ZWN1dGVDb25kaXRpb25Ob2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdsb2dpY2FsX2dhdGVfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZmxvd0V4ZWN1dG9ycy5leGVjdXRlTG9naWNhbEdhdGVOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdmb3JfZWFjaF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5mbG93RXhlY3V0b3JzLmV4ZWN1dGVGb3JFYWNoTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignZGVsYXlfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZmxvd0V4ZWN1dG9ycy5leGVjdXRlRGVsYXlOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgICAgIA0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2F1ZGlvX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93Lm1lZGlhRXhlY3V0b3JzLmV4ZWN1dGVBdWRpb05vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2ltYWdlX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93Lm1lZGlhRXhlY3V0b3JzLmV4ZWN1dGVJbWFnZU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICAgICAgDQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignanNvbl9leHRyYWN0X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmRhdGFFeGVjdXRvcnMuZXhlY3V0ZUpzb25FeHRyYWN0Tm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigncmFuZG9tX2xpbmVfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZGF0YUV4ZWN1dG9ycy5leGVjdXRlUmFuZG9tUXVvdGVOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd0ZXh0X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmRhdGFFeGVjdXRvcnMuZXhlY3V0ZVRleHROb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdtYXRoX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmRhdGFFeGVjdXRvcnMuZXhlY3V0ZU1hdGhOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdhcnJheV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVBcnJheU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3N0cmluZ19leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVTdHJpbmdOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdub2RlX3JlZmVyZW5jZV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVOb2RlUmVmZXJlbmNlTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigncmFuZG9tX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmRhdGFFeGVjdXRvcnMuZXhlY3V0ZVJhbmRvbU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICAgICAgDQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignbGxtX2NoYXRfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuYWlFeGVjdXRvcnMuZXhlY3V0ZUxsbUNoYXROb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd0ZXJtaW5hbF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5haUV4ZWN1dG9ycy5leGVjdXRlVGVybWluYWxOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICB9DQoNCiAgICBhc3luYyBleGVjdXRlTm9kZShub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgICAgIGNvbnN0IG5vZGVEZWYgPSB0aGlzLnJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgICAgIGlmICghbm9kZURlZikgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBub2RlIGRlZmluaXRpb24gZm91bmQgZm9yIHR5cGU6ICR7bm9kZS50eXBlfWApOw0KICAgICAgICB9DQoNCiAgICAgICAgY29uc3QgZXhlY3V0b3JOYW1lID0gbm9kZURlZi5leGVjdXRvcjsNCiAgICAgICAgY29uc3QgZXhlY3V0b3IgPSB0aGlzLnJlZ2lzdHJ5LmdldEV4ZWN1dG9yKGV4ZWN1dG9yTmFtZSk7DQoNCiAgICAgICAgaWYgKCFleGVjdXRvcikgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBleGVjdXRvciBmb3VuZCBmb3I6ICR7ZXhlY3V0b3JOYW1lfWApOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGF3YWl0IGV4ZWN1dG9yKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpOw0KICAgIH0NCg0KDQoNCiAgICAvLyBTdG9wIHJlcGVhdGVyIG1ldGhvZA0KICAgIHN0b3BSZXBlYXRlcihub2RlKSB7DQogICAgICAgIGlmIChub2RlLnJlcGVhdGVyU3RhdGUgJiYgbm9kZS5yZXBlYXRlclN0YXRlLmludGVydmFsKSB7DQogICAgICAgICAgICBjbGVhckludGVydmFsKG5vZGUucmVwZWF0ZXJTdGF0ZS5pbnRlcnZhbCk7DQogICAgICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUuaW50ZXJ2YWwgPSBudWxsOw0KICAgICAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmlzUnVubmluZyA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gU3RvcCBmb3IgZWFjaCBtZXRob2QNCiAgICBzdG9wRm9yRWFjaChub2RlKSB7DQogICAgICAgIGlmIChub2RlLmZvckVhY2hTdGF0ZSAmJiBub2RlLmZvckVhY2hTdGF0ZS5pbnRlcnZhbCkgew0KICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChub2RlLmZvckVhY2hTdGF0ZS5pbnRlcnZhbCk7DQogICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pbnRlcnZhbCA9IG51bGw7DQogICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pc0l0ZXJhdGluZyA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQoNCg0KDQp9DQoNCi8vIEdsb2JhbCBleGVjdXRpb24gZW5naW5lIGluc3RhbmNlDQpjb25zdCBleGVjdXRpb25FbmdpbmUgPSBuZXcgRXhlY3V0aW9uRW5naW5lKG5vZGVSZWdpc3RyeSk7DQoNCg0KLy8gd29ya2Zsb3cuanMgLSBXb3JrZmxvdyBleGVjdXRpb24gbG9naWMgZm9yIEZsb3cgRWRpdG9yDQoNCi8vIFJ1biB0aGUgd29ya2Zsb3cNCmFzeW5jIGZ1bmN0aW9uIHJ1bldvcmtmbG93KCkgew0KICAgIGlmIChmbG93RWRpdG9yLmlzUnVubmluZykgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGZsb3dFZGl0b3IuaXNSdW5uaW5nID0gdHJ1ZTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncnVuLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcC13b3JrZmxvdycpLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWZsZXgnOw0KICAgIA0KICAgIC8vIENsZWFyIGFsbCB2aXN1YWwgc3RhdGVzIGZyb20gcHJldmlvdXMgcnVucw0KICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mbG93LW5vZGUnKS5mb3JFYWNoKG5vZGUgPT4gew0KICAgICAgICBub2RlLmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnLCAnd2FpdGluZy1pbnB1dHMnLCAnY29tcGxldGVkJywgJ2Vycm9yJyk7DQogICAgfSk7DQogICAgDQogICAgLy8gQ2xlYXIgb3V0cHV0DQogICAgY29uc3Qgb3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4ZWN1dGlvbi1vdXRwdXQnKTsNCiAgICBvdXRwdXQuaW5uZXJIVE1MID0gJzxkaXYgY2xhc3M9ImxvZy1lbnRyeSBpbmZvIj5TdGFydGluZyB3b3JrZmxvdyBleGVjdXRpb24uLi48L2Rpdj4nOw0KICAgIA0KICAgIHRyeSB7DQogICAgICAgIC8vIEZpbmQgc3RhcnQgbm9kZXMgKG5vZGVzIHdpdGggbm8gaW5wdXRzIHRoYXQgYXJlIHBhcnQgb2YgYSBjb25uZWN0ZWQgd29ya2Zsb3cpDQogICAgICAgIGNvbnN0IHN0YXJ0Tm9kZXMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3Iubm9kZXMudmFsdWVzKCkpLmZpbHRlcihub2RlID0+IHsNCiAgICAgICAgICAgIGNvbnN0IG5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICAgICAgICAgIGlmICghbm9kZURlZikgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgTm8gbm9kZSBkZWZpbml0aW9uIGZvdW5kIGZvciB0eXBlOiAke25vZGUudHlwZX1gKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gVGltZXIgYW5kIFJlcGVhdGVyIG5vZGVzIGFyZSBzdGFydCBub2RlcyAoY2FuIHRyaWdnZXIgdGhlbXNlbHZlcykNCiAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICd0aW1lcicgfHwgbm9kZS50eXBlID09PSAncmVwZWF0ZXInKSB7DQogICAgICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ3JlcGVhdGVyJykgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1J1bm5pbmcgPSBub2RlLnJlcGVhdGVyU3RhdGUgJiYgbm9kZS5yZXBlYXRlclN0YXRlLmlzUnVubmluZzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy8gVGltZXIvUmVwZWF0ZXIgaXMgYSBzdGFydCBub2RlIGlmIGl0IGhhcyBjb25uZWN0ZWQgb3V0cHV0cw0KICAgICAgICAgICAgICAgIGNvbnN0IGhhc0Nvbm5lY3RlZE91dHB1dHMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLnNvbWUoY29ubiA9PiANCiAgICAgICAgICAgICAgICAgICAgY29ubi5mcm9tLm5vZGVJZCA9PT0gbm9kZS5pZA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGhhc0Nvbm5lY3RlZE91dHB1dHM7IC8vIFRpbWVyL1JlcGVhdGVyIGlzIGEgc3RhcnQgbm9kZSBpZiBjb25uZWN0ZWQNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gSWYgbm9kZSBoYXMgbm8gaW5wdXRzLCBjaGVjayBpZiBpdCdzIHBhcnQgb2YgYSBjb25uZWN0ZWQgd29ya2Zsb3cNCiAgICAgICAgICAgIGlmIChub2RlRGVmLmlucHV0cy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIG5vZGUgaGFzIGFueSBvdXRwdXRzIHRoYXQgYXJlIGNvbm5lY3RlZCB0byBvdGhlciBub2Rlcw0KICAgICAgICAgICAgICAgIGNvbnN0IGhhc0Nvbm5lY3RlZE91dHB1dHMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLnNvbWUoY29ubiA9PiANCiAgICAgICAgICAgICAgICAgICAgY29ubi5mcm9tLm5vZGVJZCA9PT0gbm9kZS5pZA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gT25seSBpbmNsdWRlIGlmIGl0J3MgY29ubmVjdGVkIHRvIHRoZSB3b3JrZmxvdw0KICAgICAgICAgICAgICAgIHJldHVybiBoYXNDb25uZWN0ZWRPdXRwdXRzOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBub2RlcyB3aXRoIG9wdGlvbmFsIGlucHV0cw0KICAgICAgICAgICAgY29uc3Qgb3B0aW9uYWxJbnB1dHMgPSBub2RlRGVmLmlucHV0cy5maWx0ZXIoaW5wdXQgPT4gaW5wdXQub3B0aW9uYWwpOw0KICAgICAgICAgICAgaWYgKG9wdGlvbmFsSW5wdXRzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIG5vZGUgaGFzIGNvbm5lY3RlZCBvdXRwdXRzDQogICAgICAgICAgICAgICAgY29uc3QgaGFzQ29ubmVjdGVkT3V0cHV0cyA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkuc29tZShjb25uID0+IA0KICAgICAgICAgICAgICAgICAgICBjb25uLmZyb20ubm9kZUlkID09PSBub2RlLmlkDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gaGFzQ29ubmVjdGVkT3V0cHV0czsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTm9kZXMgd2l0aCByZXF1aXJlZCBpbnB1dHMgYXJlIG5vdCBzdGFydCBub2RlcyAtIHRoZXkgc2hvdWxkIGJlIHRyaWdnZXJlZCBieSBvdGhlciBub2Rlcw0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIGlmIChzdGFydE5vZGVzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBzdGFydCBub2RlcyBmb3VuZC4gQWRkIG5vZGVzIHdpdGggbm8gaW5wdXRzIChUaW1lcikgb3Igbm9kZXMgd2l0aCBvcHRpb25hbCBpbnB1dHMgdGhhdCBhcmVuXCd0IGNvbm5lY3RlZCAoSFRUUCBSZXF1ZXN0KScpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBFeGVjdXRlIHdvcmtmbG93DQogICAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBleGVjdXRlV29ya2Zsb3coc3RhcnROb2Rlcyk7DQogICAgICAgIA0KICAgICAgICAvLyBEaXNwbGF5IHJlc3VsdHMNCiAgICAgICAgb3V0cHV0LmlubmVySFRNTCArPSAnPGRpdiBjbGFzcz0ibG9nLWVudHJ5IHN1Y2Nlc3MiPldvcmtmbG93IGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkhPC9kaXY+JzsNCiAgICAgICAgZm9yIChjb25zdCByZXN1bHQgb2YgcmVzdWx0cykgew0KICAgICAgICAgICAgb3V0cHV0LmlubmVySFRNTCArPSBgPGRpdiBjbGFzcz0ibG9nLWVudHJ5IGluZm8iPiR7cmVzdWx0Lm5vZGVJZH06ICR7cmVzdWx0Lm91dHB1dH08L2Rpdj5gOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBTZW5kIGNvbXBsZXRpb24gdmlhIFdlYlNvY2tldA0KICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5zZW5kTWVzc2FnZSkgew0KICAgICAgICAgICAgc3lwbmV4QVBJLnNlbmRNZXNzYWdlKCd3b3JrZmxvd19jb21wbGV0ZWQnLCB7DQogICAgICAgICAgICAgICAgcmVzdWx0czogcmVzdWx0cywNCiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCkNCiAgICAgICAgICAgIH0sICdmbG93LWVkaXRvcicpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dvcmtmbG93IGV4ZWN1dGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIG91dHB1dC5pbm5lckhUTUwgKz0gYDxkaXYgY2xhc3M9ImxvZy1lbnRyeSBlcnJvciI+RXJyb3I6ICR7ZXJyb3IubWVzc2FnZX08L2Rpdj5gOw0KICAgIH0gZmluYWxseSB7DQogICAgICAgIGZsb3dFZGl0b3IuaXNSdW5uaW5nID0gZmFsc2U7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdydW4td29ya2Zsb3cnKS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1mbGV4JzsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0b3Atd29ya2Zsb3cnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIH0NCn0NCg0KLy8gRXhlY3V0ZSB3b3JrZmxvdw0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVdvcmtmbG93KHN0YXJ0Tm9kZXMpIHsNCiAgICBjb25zdCByZXN1bHRzID0gW107DQogICAgY29uc3QgZXhlY3V0ZWQgPSBuZXcgU2V0KCk7DQogICAgY29uc3Qgbm9kZUlucHV0QnVmZmVyID0gbmV3IE1hcCgpOyAvLyBUcmFjayBpbnB1dHMgZm9yIG11bHRpLWlucHV0IG5vZGVzDQogICAgDQogICAgLy8gU3RvcmUgZ2xvYmFsbHkgc28gRm9yIEVhY2ggY2FuIGFjY2VzcyBpdA0KICAgIHdpbmRvdy5nbG9iYWxOb2RlSW5wdXRCdWZmZXIgPSBub2RlSW5wdXRCdWZmZXI7DQogICAgDQogICAgZm9yIChjb25zdCBzdGFydE5vZGUgb2Ygc3RhcnROb2Rlcykgew0KICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBleGVjdXRlTm9kZShzdGFydE5vZGUsIHt9LCBleGVjdXRlZCwgbm9kZUlucHV0QnVmZmVyKTsNCiAgICAgICAgaWYgKHJlc3VsdCkgcmVzdWx0cy5wdXNoKHJlc3VsdCk7DQogICAgfQ0KICAgIA0KICAgIHJldHVybiByZXN1bHRzOw0KfQ0KDQovLyBFeGVjdXRlIGEgc2luZ2xlIG5vZGUgKGR5bmFtaWMgdmVyc2lvbikNCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVOb2RlKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQsIG5vZGVJbnB1dEJ1ZmZlcikgew0KICAgIGlmIChleGVjdXRlZC5oYXMobm9kZS5pZCkpIHsNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIGV4ZWN1dGVkLmFkZChub2RlLmlkKTsNCiAgICANCiAgICAvLyBNYXJrIG5vZGUgYXMgcnVubmluZw0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZS5pZCk7DQogICAgaWYgKG5vZGVFbGVtZW50KSBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdydW5uaW5nJyk7DQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgLy8gVXNlIHRoZSBkeW5hbWljIGV4ZWN1dGlvbiBlbmdpbmUNCiAgICAgICAgY29uc3Qgb3V0cHV0ID0gYXdhaXQgZXhlY3V0aW9uRW5naW5lLmV4ZWN1dGVOb2RlKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpOw0KICAgICAgICANCiAgICAgICAgLy8gU3RvcmUgb3V0cHV0IGRhdGEgZm9yIGNvbmZpZyBwYW5lbCBkaXNwbGF5DQogICAgICAgIG5vZGUubGFzdE91dHB1dERhdGEgPSBvdXRwdXQ7DQogICAgICAgIG5vZGUubGFzdEV4ZWN1dGlvblRpbWUgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7DQogICAgICAgIA0KICAgICAgICAvLyBDaGVjayBpZiBvdXRwdXQgaW5kaWNhdGVzIGV4ZWN1dGlvbiBzaG91bGQgc3RvcCAobG9naWNhbCBnYXRlIHNwZWNpZmljKQ0KICAgICAgICBpZiAob3V0cHV0ICYmIHR5cGVvZiBvdXRwdXQgPT09ICdvYmplY3QnICYmIG91dHB1dC5fX3N0b3BfZXhlY3V0aW9uID09PSB0cnVlKSB7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIE1hcmsgbm9kZSBhcyBjb21wbGV0ZWQNCiAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnKTsNCiAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZWQnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgcmV0dXJuIHsgbm9kZUlkOiBub2RlLmlkLCBvdXRwdXQ6IG51bGwgfTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQ2hlY2sgZm9yIGZvcl9lYWNoIGNvbnRyb2wgZmxhZyAtIHNraXAgZG93bnN0cmVhbSBleGVjdXRpb24sIGxldCBpbnRlcnZhbCBoYW5kbGUgaXQNCiAgICAgICAgaWYgKG91dHB1dCAmJiB0eXBlb2Ygb3V0cHV0ID09PSAnb2JqZWN0JyAmJiBvdXRwdXQuX19mb3JfZWFjaF9jb250cm9sID09PSB0cnVlKSB7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIE1hcmsgbm9kZSBhcyBjb21wbGV0ZWQgYnV0IGRvbid0IGV4ZWN1dGUgZG93bnN0cmVhbSBub2Rlcw0KICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NvbXBsZXRlZCcpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICByZXR1cm4geyBub2RlSWQ6IG5vZGUuaWQsIG91dHB1dDogb3V0cHV0IH07DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEZpbmQgY29ubmVjdGVkIG5vZGVzIGFuZCBleGVjdXRlIHRoZW0NCiAgICAgICAgY29uc3QgY29ubmVjdGVkTm9kZXMgPSBmaW5kQ29ubmVjdGVkTm9kZXMobm9kZS5pZCk7DQogICAgICAgIA0KICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3RlZE5vZGUgb2YgY29ubmVjdGVkTm9kZXMpIHsNCiAgICAgICAgICAgIC8vIENoZWNrIGZvciBjeWNsZXMgYmVmb3JlIGV4ZWN1dGluZw0KICAgICAgICAgICAgaWYgKGV4ZWN1dGVkLmhhcyhjb25uZWN0ZWROb2RlLm5vZGUuaWQpKSB7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gSGFuZGxlIG91dHB1dCBtYXBwaW5nIHRvIGlucHV0IHBvcnRzIC0gRElSRUNUIE1BUFBJTkcNCiAgICAgICAgICAgIGxldCBpbnB1dFZhbHVlID0gb3V0cHV0Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAob3V0cHV0IGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICAgICAgICAgIC8vIEJsb2Igb3V0cHV0IC0gcGFzcyBkaXJlY3RseSB0byB0aGUgaW5wdXQgcG9ydA0KICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBvdXRwdXQ7DQogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvdXRwdXQgPT09ICdvYmplY3QnICYmIG91dHB1dCAhPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIC8vIE9iamVjdCBvdXRwdXQgLSBleHRyYWN0IHRoZSBFWEFDVCBvdXRwdXQgcG9ydCBmaWVsZA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChjb25uZWN0ZWROb2RlLm91dHB1dFBvcnQgaW4gb3V0cHV0KSB7DQogICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBvdXRwdXRbY29ubmVjdGVkTm9kZS5vdXRwdXRQb3J0XTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBOb2RlICR7bm9kZS5pZH0gLT4gJHtjb25uZWN0ZWROb2RlLm5vZGUuaWR9OiBFUlJPUiAtIE91dHB1dCBwb3J0ICcke2Nvbm5lY3RlZE5vZGUub3V0cHV0UG9ydH0nIG5vdCBmb3VuZCBpbiBvdXRwdXQhYCk7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEF2YWlsYWJsZSBmaWVsZHM6YCwgT2JqZWN0LmtleXMob3V0cHV0KSk7DQogICAgICAgICAgICAgICAgICAgIC8vIFNraXAgdGhpcyBjb25uZWN0aW9uIGluc3RlYWQgb2YgcGFzc2luZyBudWxsDQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy8gU2ltcGxlIHZhbHVlIG91dHB1dCAtIHBhc3MgZGlyZWN0bHkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIC8vIFVzZSBzbWFydCBleGVjdXRpb24gdGhhdCBoYW5kbGVzIG11bHRpLWlucHV0IHN5bmNocm9uaXphdGlvbg0KICAgICAgICAgICAgICAgIGF3YWl0IGV4ZWN1dGVOb2RlU21hcnQoY29ubmVjdGVkTm9kZS5ub2RlLCBjb25uZWN0ZWROb2RlLmlucHV0UG9ydCwgaW5wdXRWYWx1ZSwgZXhlY3V0ZWQsIG5vZGVJbnB1dEJ1ZmZlcik7DQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGV4ZWN1dGluZyBjb25uZWN0ZWQgbm9kZSAke2Nvbm5lY3RlZE5vZGUubm9kZS5pZH06YCwgZXJyb3IpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dFBhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4ZWN1dGlvbi1vdXRwdXQnKTsNCiAgICAgICAgICAgICAgICBvdXRwdXRQYW5lbC5pbm5lckhUTUwgKz0gYDxkaXYgY2xhc3M9ImxvZy1lbnRyeSBlcnJvciI+RXJyb3IgaW4gY29ubmVjdGVkIG5vZGUgJHtjb25uZWN0ZWROb2RlLm5vZGUuaWR9OiAke2Vycm9yLm1lc3NhZ2V9PC9kaXY+YDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gTWFyayBub2RlIGFzIGNvbXBsZXRlZA0KICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnKTsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NvbXBsZXRlZCcpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICByZXR1cm4geyBub2RlSWQ6IG5vZGUuaWQsIG91dHB1dDogb3V0cHV0IH07DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGV4ZWN1dGluZyBub2RlICR7bm9kZS5pZH06YCwgZXJyb3IpOw0KICAgICAgICANCiAgICAgICAgLy8gTWFyayBub2RlIGFzIGVycm9yDQogICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZXJyb3InKTsNCiAgICB9DQogICAgDQogICAgICAgIHRocm93IGVycm9yOw0KICAgIH0gZmluYWxseSB7DQogICAgICAgIC8vIFJlbW92ZSBydW5uaW5nIHN0YXRlDQogICAgICAgIGlmIChub2RlRWxlbWVudCkgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgIH0NCn0NCg0KLy8gU21hcnQgZXhlY3V0aW9uIGZ1bmN0aW9uIHRoYXQgaGFuZGxlcyBtdWx0aS1pbnB1dCBzeW5jaHJvbml6YXRpb24NCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVOb2RlU21hcnQobm9kZSwgaW5wdXRQb3J0LCBpbnB1dFZhbHVlLCBleGVjdXRlZCwgbm9kZUlucHV0QnVmZmVyKSB7DQogICAgY29uc3Qgbm9kZUlkID0gbm9kZS5pZDsNCiAgICANCiAgICAvLyBHZXQgYWxsIGNvbm5lY3RlZCBpbnB1dCBwb3J0cyBmb3IgdGhpcyBub2RlDQogICAgY29uc3QgY29ubmVjdGVkSW5wdXRQb3J0cyA9IGdldENvbm5lY3RlZElucHV0UG9ydHMobm9kZUlkKTsNCiAgICANCiAgICBjb25zb2xlLmxvZyhg8J+UpyBleGVjdXRlTm9kZVNtYXJ0IGZvciAke25vZGUudHlwZX0gbm9kZSAke25vZGVJZH06YCwgew0KICAgICAgICBpbnB1dFBvcnQsDQogICAgICAgIGlucHV0VmFsdWUsDQogICAgICAgIGNvbm5lY3RlZElucHV0UG9ydHMsDQogICAgICAgIGNvbm5lY3RlZFBvcnRzQ291bnQ6IGNvbm5lY3RlZElucHV0UG9ydHMubGVuZ3RoDQogICAgfSk7DQogICAgDQogICAgLy8gSWYgbm9kZSBoYXMgMCBvciAxIGlucHV0IGNvbm5lY3Rpb25zLCBleGVjdXRlIGltbWVkaWF0ZWx5DQogICAgaWYgKGNvbm5lY3RlZElucHV0UG9ydHMubGVuZ3RoIDw9IDEpIHsNCiAgICAgICAgY29uc29sZS5sb2coYPCfmoAgRXhlY3V0aW5nIGltbWVkaWF0ZWx5ICgke2Nvbm5lY3RlZElucHV0UG9ydHMubGVuZ3RofSBjb25uZWN0ZWQgcG9ydHMpYCk7DQogICAgICAgIHJldHVybiBhd2FpdCBleGVjdXRlTm9kZShub2RlLCB7IFtpbnB1dFBvcnRdOiBpbnB1dFZhbHVlIH0sIGV4ZWN1dGVkLCBub2RlSW5wdXRCdWZmZXIpOw0KICAgIH0NCiAgICANCiAgICAvLyBNdWx0aS1pbnB1dCBub2RlIC0gbmVlZCB0byBjb2xsZWN0IGFsbCBpbnB1dHMgYmVmb3JlIGV4ZWN1dGluZw0KICAgIGlmICghbm9kZUlucHV0QnVmZmVyLmhhcyhub2RlSWQpKSB7DQogICAgICAgIG5vZGVJbnB1dEJ1ZmZlci5zZXQobm9kZUlkLCB7DQogICAgICAgICAgICByZWNlaXZlZElucHV0czoge30sDQogICAgICAgICAgICBjb25uZWN0ZWRQb3J0czogY29ubmVjdGVkSW5wdXRQb3J0cw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIC8vIE1hcmsgbm9kZSBhcyB3YWl0aW5nIGZvciBpbnB1dHMgKHZpc3VhbCBmZWVkYmFjaykNCiAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3dhaXRpbmctaW5wdXRzJyk7DQogICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjb21wbGV0ZWQnLCAnZXJyb3InKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICBjb25zdCBidWZmZXIgPSBub2RlSW5wdXRCdWZmZXIuZ2V0KG5vZGVJZCk7DQogICAgDQogICAgY29uc29sZS5sb2coYPCflKcgQnVmZmVyIHVwZGF0ZSBCRUZPUkUgZm9yICR7bm9kZS50eXBlfSBub2RlICR7bm9kZUlkfTpgLCB7DQogICAgICAgIGlucHV0UG9ydCwNCiAgICAgICAgaW5wdXRWYWx1ZSwNCiAgICAgICAgcmVjZWl2ZWRJbnB1dHNCZWZvcmU6IHsgLi4uYnVmZmVyLnJlY2VpdmVkSW5wdXRzIH0sDQogICAgICAgIGNvbm5lY3RlZFBvcnRzOiBidWZmZXIuY29ubmVjdGVkUG9ydHMsDQogICAgICAgIHJlY2VpdmVkS2V5c0JlZm9yZTogT2JqZWN0LmtleXMoYnVmZmVyLnJlY2VpdmVkSW5wdXRzKSwNCiAgICAgICAgbWlzc2luZ1BvcnRzOiBidWZmZXIuY29ubmVjdGVkUG9ydHMuZmlsdGVyKHBvcnQgPT4gIShwb3J0IGluIGJ1ZmZlci5yZWNlaXZlZElucHV0cykpDQogICAgfSk7DQogICAgDQogICAgLy8gU3RvcmUgdGhpcyBpbnB1dA0KICAgIGJ1ZmZlci5yZWNlaXZlZElucHV0c1tpbnB1dFBvcnRdID0gaW5wdXRWYWx1ZTsNCiAgICANCiAgICBjb25zb2xlLmxvZyhg8J+UpyBCdWZmZXIgdXBkYXRlIEFGVEVSIGZvciAke25vZGUudHlwZX0gbm9kZSAke25vZGVJZH06YCwgew0KICAgICAgICByZWNlaXZlZElucHV0c0FmdGVyOiB7IC4uLmJ1ZmZlci5yZWNlaXZlZElucHV0cyB9LA0KICAgICAgICByZWNlaXZlZEtleXNBZnRlcjogT2JqZWN0LmtleXMoYnVmZmVyLnJlY2VpdmVkSW5wdXRzKQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIENoZWNrIGlmIHdlIGhhdmUgYWxsIHJlcXVpcmVkIGlucHV0cw0KICAgIGNvbnN0IGhhc0FsbElucHV0cyA9IGJ1ZmZlci5jb25uZWN0ZWRQb3J0cy5ldmVyeShwb3J0ID0+IHBvcnQgaW4gYnVmZmVyLnJlY2VpdmVkSW5wdXRzKTsNCiAgICANCiAgICBjb25zb2xlLmxvZyhg8J+UpyBJbnB1dCBjaGVjayBmb3IgJHtub2RlLnR5cGV9IG5vZGUgJHtub2RlSWR9OmAsIHsNCiAgICAgICAgaGFzQWxsSW5wdXRzLA0KICAgICAgICByZXF1aXJlZFBvcnRzOiBidWZmZXIuY29ubmVjdGVkUG9ydHMsDQogICAgICAgIHJlY2VpdmVkUG9ydHM6IE9iamVjdC5rZXlzKGJ1ZmZlci5yZWNlaXZlZElucHV0cykNCiAgICB9KTsNCiAgICANCiAgICBpZiAoIWhhc0FsbElucHV0cykgew0KICAgICAgICBjb25zb2xlLmxvZyhg4o+zIFN0aWxsIHdhaXRpbmcgZm9yIGlucHV0cyBvbiAke25vZGUudHlwZX0gbm9kZSAke25vZGVJZH1gKTsNCiAgICAgICAgLy8gU3RpbGwgd2FpdGluZyBmb3IgbW9yZSBpbnB1dHMNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIA0KICAgIC8vIEFsbCBpbnB1dHMgcmVhZHkgLSByZW1vdmUgd2FpdGluZyBzdGF0ZSBhbmQgZXhlY3V0ZSENCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3dhaXRpbmctaW5wdXRzJyk7DQogICAgfQ0KICAgIA0KICAgIA0KICAgIC8vIENsZWFyIGJ1ZmZlciBmb3IgbmV4dCBleGVjdXRpb24NCiAgICBub2RlSW5wdXRCdWZmZXIuZGVsZXRlKG5vZGVJZCk7DQogICAgDQogICAgLy8gRXhlY3V0ZSB3aXRoIGFsbCBhZ2dyZWdhdGVkIGlucHV0cw0KICAgIHJldHVybiBhd2FpdCBleGVjdXRlTm9kZShub2RlLCBidWZmZXIucmVjZWl2ZWRJbnB1dHMsIGV4ZWN1dGVkLCBub2RlSW5wdXRCdWZmZXIpOw0KfQ0KDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gZ2V0IGNvbm5lY3RlZCBpbnB1dCBwb3J0cyBmb3IgYSBub2RlDQpmdW5jdGlvbiBnZXRDb25uZWN0ZWRJbnB1dFBvcnRzKG5vZGVJZCkgew0KICAgIGxldCBjb25uZWN0aW9ucyA9IG51bGw7DQogICAgDQogICAgLy8gRGVidWc6IExvZyB3aGF0J3MgYXZhaWxhYmxlIG9uIGZsb3dFZGl0b3IgKHRyeSBib3RoIHdpbmRvdy5mbG93RWRpdG9yIGFuZCBmbG93RWRpdG9yKQ0KICAgIA0KICAgIC8vIFRyeSB0byBhY2Nlc3MgZmxvd0VkaXRvciBkaXJlY3RseSAobm90IHZpYSB3aW5kb3cpDQogICAgbGV0IGVkaXRvciA9IG51bGw7DQogICAgaWYgKHR5cGVvZiBmbG93RWRpdG9yICE9PSAndW5kZWZpbmVkJyAmJiBmbG93RWRpdG9yKSB7DQogICAgICAgIGVkaXRvciA9IGZsb3dFZGl0b3I7DQogICAgfSBlbHNlIGlmICh3aW5kb3cuZmxvd0VkaXRvcikgew0KICAgICAgICBlZGl0b3IgPSB3aW5kb3cuZmxvd0VkaXRvcjsNCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gW107DQogICAgfQ0KICAgIA0KICAgIA0KICAgIC8vIFRyeSBtdWx0aXBsZSB3YXlzIHRvIGFjY2VzcyBjb25uZWN0aW9ucyBkYXRhDQogICAgaWYgKGVkaXRvci5jb25uZWN0aW9ucykgew0KICAgICAgICBjb25uZWN0aW9ucyA9IGVkaXRvci5jb25uZWN0aW9uczsNCiAgICB9IGVsc2UgaWYgKGVkaXRvci53b3JrZmxvdyAmJiBlZGl0b3Iud29ya2Zsb3cuY29ubmVjdGlvbnMpIHsNCiAgICAgICAgY29ubmVjdGlvbnMgPSBuZXcgTWFwKGVkaXRvci53b3JrZmxvdy5jb25uZWN0aW9ucy5tYXAoY29ubiA9PiBbY29ubi5pZCwgY29ubl0pKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gW107DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGFsbENvbm5lY3Rpb25zID0gQXJyYXkuZnJvbShjb25uZWN0aW9ucy52YWx1ZXMoKSk7DQogICAgDQogICAgLy8gTG9nIGFsbCBjb25uZWN0aW9ucyBmb3IgZGVidWdnaW5nDQogICAgYWxsQ29ubmVjdGlvbnMuZm9yRWFjaCgoY29ubiwgaW5kZXgpID0+IHsNCiAgICB9KTsNCiAgICANCiAgICBjb25zdCBjb25uZWN0ZWRQb3J0cyA9IGFsbENvbm5lY3Rpb25zDQogICAgICAgIC5maWx0ZXIoY29ubiA9PiB7DQogICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gY29ubi50by5ub2RlSWQgPT09IG5vZGVJZDsNCiAgICAgICAgICAgIGlmIChtYXRjaGVzKSB7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gbWF0Y2hlczsNCiAgICAgICAgfSkNCiAgICAgICAgLm1hcChjb25uID0+IGNvbm4udG8ucG9ydE5hbWUpOw0KICAgICAgICANCiAgICByZXR1cm4gY29ubmVjdGVkUG9ydHM7DQp9DQogICAgDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gdXBkYXRlIGRpc3BsYXkgbm9kZSBjb250ZW50ICh1c2VkIGJ5IGV4ZWN1dGlvbiBlbmdpbmUpDQpmdW5jdGlvbiB1cGRhdGVEaXNwbGF5Tm9kZUNvbnRlbnQobm9kZUlkLCBjb250ZW50LCBmb3JtYXQpIHsNCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgaWYgKCFub2RlRWxlbWVudCkgcmV0dXJuOw0KICAgIA0KICAgIGNvbnN0IGRpc3BsYXlUZXh0ID0gbm9kZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLmRpc3BsYXktdGV4dCcpOw0KICAgIGNvbnN0IGZvcm1hdEVsZW1lbnQgPSBub2RlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZGlzcGxheS1mb3JtYXQgc3BhbicpOw0KICAgIA0KICAgIGlmIChkaXNwbGF5VGV4dCkgew0KICAgICAgICBsZXQgZm9ybWF0dGVkQ29udGVudCA9IGNvbnRlbnQ7DQogICAgICAgIA0KICAgIHN3aXRjaCAoZm9ybWF0KSB7DQogICAgICAgIGNhc2UgJ2pzb24nOg0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gdHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnID8gSlNPTi5wYXJzZShjb250ZW50KSA6IGNvbnRlbnQ7DQogICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZENvbnRlbnQgPSBKU09OLnN0cmluZ2lmeShwYXJzZWQsIG51bGwsIDIpOw0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRDb250ZW50ID0gY29udGVudDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdodG1sJzoNCiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRDb250ZW50ID0gY29udGVudDsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICd0ZXh0JzoNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRDb250ZW50ID0gY29udGVudDsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgIH0NCiAgICANCiAgICAgICAgZGlzcGxheVRleHQuaW5uZXJIVE1MID0gYDxwcmUgY2xhc3M9ImNvbnRlbnQtdGV4dCI+JHtlc2NhcGVIdG1sKGZvcm1hdHRlZENvbnRlbnQpfTwvcHJlPmA7DQogICAgfQ0KICAgIA0KICAgIGlmIChmb3JtYXRFbGVtZW50KSB7DQogICAgICAgIGZvcm1hdEVsZW1lbnQudGV4dENvbnRlbnQgPSBmb3JtYXQ7DQogICAgfQ0KICAgIA0KICAgIC8vIFN0b3JlIGZvciBjb25maWcgcGFuZWwgZGlzcGxheQ0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmIChub2RlKSB7DQogICAgICAgIG5vZGUubGFzdENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICBub2RlLmxhc3RGb3JtYXQgPSBmb3JtYXQ7DQogICAgfQ0KfQ0KDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gZXNjYXBlIEhUTUwNCmZ1bmN0aW9uIGVzY2FwZUh0bWwodGV4dCkgew0KICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIGRpdi50ZXh0Q29udGVudCA9IHRleHQ7DQogICAgcmV0dXJuIGRpdi5pbm5lckhUTUw7DQp9DQoNCi8vIEhlbHBlciBmdW5jdGlvbiB0byByZXBsYWNlIHRlbXBsYXRlIHBsYWNlaG9sZGVycw0KZnVuY3Rpb24gcmVwbGFjZVRlbXBsYXRlUGxhY2Vob2xkZXJzKHRlbXBsYXRlLCBkYXRhKSB7DQogICAgaWYgKHR5cGVvZiB0ZW1wbGF0ZSAhPT0gJ29iamVjdCcgfHwgdGVtcGxhdGUgPT09IG51bGwpIHsNCiAgICAgICAgcmV0dXJuIHRlbXBsYXRlOw0KICAgIH0NCiAgICANCiAgICBpZiAoQXJyYXkuaXNBcnJheSh0ZW1wbGF0ZSkpIHsNCiAgICAgICAgcmV0dXJuIHRlbXBsYXRlLm1hcChpdGVtID0+IHJlcGxhY2VUZW1wbGF0ZVBsYWNlaG9sZGVycyhpdGVtLCBkYXRhKSk7DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IHJlc3VsdCA9IHt9Ow0KICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRlbXBsYXRlKSkgew0KICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgbGV0IHJlcGxhY2VkVmFsdWUgPSB2YWx1ZTsNCiAgICANCiAgICAgICAgICAgIC8vIFJlcGxhY2Uge3tWQUxVRX19IHdpdGggdGhlIGZ1bGwgZGF0YSBvYmplY3QNCiAgICAgICAgICAgIGlmICh2YWx1ZS5pbmNsdWRlcygne3tWQUxVRX19JykpIHsNCiAgICAgICAgICAgICAgICByZXBsYWNlZFZhbHVlID0gdmFsdWUucmVwbGFjZSgne3tWQUxVRX19JywgSlNPTi5zdHJpbmdpZnkoZGF0YSkpOw0KfQ0KDQogICAgICAgICAgICAvLyBSZXBsYWNlIHt7SlNPTjpmaWVsZH19IHdpdGggc3BlY2lmaWMgZmllbGQNCiAgICAgICAgICAgIGNvbnN0IGpzb25NYXRjaGVzID0gdmFsdWUubWF0Y2goL1x7XHtKU09OOihbXn1dKylcfVx9L2cpOw0KICAgICAgICAgICAgaWYgKGpzb25NYXRjaGVzKSB7DQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBtYXRjaCBvZiBqc29uTWF0Y2hlcykgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZCA9IG1hdGNoLm1hdGNoKC9ce1x7SlNPTjooW159XSspXH1cfS8pWzFdOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZFZhbHVlID0gZ2V0TmVzdGVkVmFsdWUoZGF0YSwgZmllbGQpOw0KICAgICAgICAgICAgICAgICAgICByZXBsYWNlZFZhbHVlID0gcmVwbGFjZWRWYWx1ZS5yZXBsYWNlKG1hdGNoLCBKU09OLnN0cmluZ2lmeShmaWVsZFZhbHVlKSk7DQogICAgICAgICAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAgICAgICAgIC8vIFJlcGxhY2Uge3tmaWVsZH19IHdpdGggc3BlY2lmaWMgZmllbGQgdmFsdWUNCiAgICAgICAgICAgIGNvbnN0IGZpZWxkTWF0Y2hlcyA9IHZhbHVlLm1hdGNoKC9ce1x7KFtefV0rKVx9XH0vZyk7DQogICAgICAgICAgICBpZiAoZmllbGRNYXRjaGVzKSB7DQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBtYXRjaCBvZiBmaWVsZE1hdGNoZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGQgPSBtYXRjaC5tYXRjaCgvXHtceyhbXn1dKylcfVx9LylbMV07DQogICAgICAgICAgICAgICAgICAgIGlmIChmaWVsZCAhPT0gJ1ZBTFVFJyAmJiAhZmllbGQuc3RhcnRzV2l0aCgnSlNPTjonKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IGdldE5lc3RlZFZhbHVlKGRhdGEsIGZpZWxkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VkVmFsdWUgPSByZXBsYWNlZFZhbHVlLnJlcGxhY2UobWF0Y2gsIGZpZWxkVmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICByZXN1bHRba2V5XSA9IHJlcGxhY2VkVmFsdWU7DQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAhPT0gbnVsbCkgew0KICAgICAgICAgICAgcmVzdWx0W2tleV0gPSByZXBsYWNlVGVtcGxhdGVQbGFjZWhvbGRlcnModmFsdWUsIGRhdGEpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmVzdWx0W2tleV0gPSB2YWx1ZTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICByZXR1cm4gcmVzdWx0Ow0KfQ0KDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gZ2V0IG5lc3RlZCBvYmplY3QgdmFsdWVzDQpmdW5jdGlvbiBnZXROZXN0ZWRWYWx1ZShvYmosIHBhdGgpIHsNCiAgICBjb25zdCBrZXlzID0gcGF0aC5zcGxpdCgnLicpOw0KICAgIGxldCBjdXJyZW50ID0gb2JqOw0KICAgIA0KICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHsNCiAgICAgICAgaWYgKGN1cnJlbnQgPT09IG51bGwgfHwgY3VycmVudCA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gSGFuZGxlIGFycmF5IGFjY2VzcyBsaWtlICJpdGVtc1swXS5uYW1lIg0KICAgICAgICBjb25zdCBhcnJheU1hdGNoID0ga2V5Lm1hdGNoKC9eKC4rKVxbKFxkKylcXSQvKTsNCiAgICAgICAgaWYgKGFycmF5TWF0Y2gpIHsNCiAgICAgICAgICAgIGNvbnN0IGFycmF5S2V5ID0gYXJyYXlNYXRjaFsxXTsNCiAgICAgICAgICAgIGNvbnN0IGFycmF5SW5kZXggPSBwYXJzZUludChhcnJheU1hdGNoWzJdKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGN1cnJlbnRbYXJyYXlLZXldICYmIEFycmF5LmlzQXJyYXkoY3VycmVudFthcnJheUtleV0pKSB7DQogICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnRbYXJyYXlLZXldW2FycmF5SW5kZXhdOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnRba2V5XTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICByZXR1cm4gY3VycmVudDsNCn0NCg0KLy8gU3RvcCB3b3JrZmxvdyBleGVjdXRpb24NCmZ1bmN0aW9uIHN0b3BXb3JrZmxvdygpIHsNCiAgICAgICAgZmxvd0VkaXRvci5pc1J1bm5pbmcgPSBmYWxzZTsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3J1bi13b3JrZmxvdycpLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWZsZXgnOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcC13b3JrZmxvdycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIA0KICAgIC8vIENsZWFyIHJ1bm5pbmcgc3RhdGVzIGZyb20gYWxsIG5vZGVzDQogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mbG93LW5vZGUucnVubmluZywgLmZsb3ctbm9kZS53YWl0aW5nLWlucHV0cycpLmZvckVhY2gobm9kZSA9PiB7DQogICAgICAgICAgICBub2RlLmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnLCAnd2FpdGluZy1pbnB1dHMnKTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgIGNvbnN0IG91dHB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleGVjdXRpb24tb3V0cHV0Jyk7DQogICAgb3V0cHV0LmlubmVySFRNTCArPSAnPGRpdiBjbGFzcz0ibG9nLWVudHJ5IHdhcm5pbmciPldvcmtmbG93IGV4ZWN1dGlvbiBzdG9wcGVkIGJ5IHVzZXI8L2Rpdj4nOw0KICAgIA0KfQ0KDQovLyBGaW5kIG5vZGVzIGNvbm5lY3RlZCB0byBhIHNwZWNpZmljIG5vZGUNCmZ1bmN0aW9uIGZpbmRDb25uZWN0ZWROb2Rlcyhub2RlSWQpIHsNCiAgICBjb25zdCBjb25uZWN0ZWROb2RlcyA9IFtdOw0KICAgIA0KICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBub2RlSWQpIHsNCiAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgICAgICAgICBpZiAodGFyZ2V0Tm9kZSkgew0KICAgICAgICAgICAgICAgIGNvbm5lY3RlZE5vZGVzLnB1c2goew0KICAgICAgICAgICAgICAgICAgICBub2RlOiB0YXJnZXROb2RlLA0KICAgICAgICAgICAgICAgICAgICBpbnB1dFBvcnQ6IGNvbm5lY3Rpb24udG8ucG9ydE5hbWUsDQogICAgICAgICAgICAgICAgICAgIG91dHB1dFBvcnQ6IGNvbm5lY3Rpb24uZnJvbS5wb3J0TmFtZQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIHJldHVybiBjb25uZWN0ZWROb2RlczsNCn0NCg0KLy8gRm9ybWF0IGRhdGEgZm9yIHByZXZpZXcgaW4gY29uZmlnIHBhbmVsDQpmdW5jdGlvbiBmb3JtYXREYXRhUHJldmlldyhkYXRhLCBtYXhMZW5ndGggPSAyMDApIHsNCiAgICBpZiAoZGF0YSA9PT0gbnVsbCB8fCBkYXRhID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgcmV0dXJuIHsgdHlwZTogJ251bGwnLCBwcmV2aWV3OiAnbnVsbCcgfTsNCiAgICB9DQogICAgDQogICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBCbG9iKSB7DQogICAgICAgIGNvbnN0IHNpemVLQiA9IChkYXRhLnNpemUgLyAxMDI0KS50b0ZpeGVkKDIpOw0KICAgICAgICBjb25zdCBzaXplTUIgPSBkYXRhLnNpemUgPiAxMDI0ICogMTAyNCA/IGAgKCR7KGRhdGEuc2l6ZSAvICgxMDI0ICogMTAyNCkpLnRvRml4ZWQoMil9IE1CKWAgOiAnJzsNCiAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICB0eXBlOiAnQmxvYicsIA0KICAgICAgICAgICAgcHJldmlldzogYCR7ZGF0YS50eXBlIHx8ICd1bmtub3duJ30gLSAke3NpemVLQn0gS0Ike3NpemVNQn1gLA0KICAgICAgICAgICAgc2l6ZTogZGF0YS5zaXplDQogICAgICAgIH07DQogICAgfQ0KICAgIA0KICAgIGlmIChkYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsNCiAgICAgICAgY29uc3Qgc2l6ZUtCID0gKGRhdGEuYnl0ZUxlbmd0aCAvIDEwMjQpLnRvRml4ZWQoMik7DQogICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgdHlwZTogJ0FycmF5QnVmZmVyJywgDQogICAgICAgICAgICBwcmV2aWV3OiBgQmluYXJ5IGRhdGEgLSAke3NpemVLQn0gS0JgLA0KICAgICAgICAgICAgc2l6ZTogZGF0YS5ieXRlTGVuZ3RoDQogICAgICAgIH07DQogICAgfQ0KICAgIA0KICAgIGlmIChkYXRhIGluc3RhbmNlb2YgVWludDhBcnJheSB8fCBkYXRhIGluc3RhbmNlb2YgSW50OEFycmF5IHx8IA0KICAgICAgICBkYXRhIGluc3RhbmNlb2YgVWludDE2QXJyYXkgfHwgZGF0YSBpbnN0YW5jZW9mIEludDE2QXJyYXkgfHwNCiAgICAgICAgZGF0YSBpbnN0YW5jZW9mIFVpbnQzMkFycmF5IHx8IGRhdGEgaW5zdGFuY2VvZiBJbnQzMkFycmF5IHx8DQogICAgICAgIGRhdGEgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXkgfHwgZGF0YSBpbnN0YW5jZW9mIEZsb2F0NjRBcnJheSkgew0KICAgICAgICBjb25zdCBzaXplS0IgPSAoZGF0YS5ieXRlTGVuZ3RoIC8gMTAyNCkudG9GaXhlZCgyKTsNCiAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICB0eXBlOiBkYXRhLmNvbnN0cnVjdG9yLm5hbWUsIA0KICAgICAgICAgICAgcHJldmlldzogYEJpbmFyeSBhcnJheSAtICR7c2l6ZUtCfSBLQmAsDQogICAgICAgICAgICBzaXplOiBkYXRhLmJ5dGVMZW5ndGgNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgaWYgKEFycmF5LmlzQXJyYXkoZGF0YSkpIHsNCiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBsaWtlbHkgYmluYXJ5IGRhdGEgKGFycmF5IG9mIG51bWJlcnMgMC0yNTUpDQogICAgICAgIGlmIChkYXRhLmxlbmd0aCA+IDAgJiYgZGF0YS5ldmVyeShpdGVtID0+IHR5cGVvZiBpdGVtID09PSAnbnVtYmVyJyAmJiBpdGVtID49IDAgJiYgaXRlbSA8PSAyNTUpKSB7DQogICAgICAgICAgICBjb25zdCBzaXplS0IgPSAoZGF0YS5sZW5ndGggLyAxMDI0KS50b0ZpeGVkKDIpOw0KICAgICAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICAgICAgdHlwZTogJ0JpbmFyeSBBcnJheScsIA0KICAgICAgICAgICAgICAgIHByZXZpZXc6IGBCaW5hcnkgZGF0YSBhcnJheSAtICR7c2l6ZUtCfSBLQmAsDQogICAgICAgICAgICAgICAgbGVuZ3RoOiBkYXRhLmxlbmd0aA0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgY29uc3QgcHJldmlldyA9IGRhdGEubGVuZ3RoID4gMyANCiAgICAgICAgICAgID8gYFske2RhdGEuc2xpY2UoMCwgMykubWFwKGl0ZW0gPT4gSlNPTi5zdHJpbmdpZnkoaXRlbSkpLmpvaW4oJywgJyl9LCAuLi5dYA0KICAgICAgICAgICAgOiBKU09OLnN0cmluZ2lmeShkYXRhKTsNCiAgICAgICAgY29uc3QgdHJ1bmNhdGVkID0gcHJldmlldy5sZW5ndGggPiBtYXhMZW5ndGggPyBwcmV2aWV3LnN1YnN0cmluZygwLCBtYXhMZW5ndGgpICsgJy4uLicgOiBwcmV2aWV3Ow0KICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgIHR5cGU6ICdBcnJheScsIA0KICAgICAgICAgICAgcHJldmlldzogdHJ1bmNhdGVkLA0KICAgICAgICAgICAgbGVuZ3RoOiBkYXRhLmxlbmd0aA0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdvYmplY3QnKSB7DQogICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhkYXRhKTsNCiAgICAgICAgDQogICAgICAgIC8vIENoZWNrIGlmIGl0IGxvb2tzIGxpa2UgYSBsYXJnZSBkYXRhIG9iamVjdCAoaGFzIGNvbW1vbiBsYXJnZSBkYXRhIGluZGljYXRvcnMpDQogICAgICAgIGNvbnN0IGhhc0xhcmdlRGF0YUluZGljYXRvcnMgPSBrZXlzLnNvbWUoa2V5ID0+IA0KICAgICAgICAgICAga2V5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2RhdGEnKSB8fCANCiAgICAgICAgICAgIGtleS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdidWZmZXInKSB8fA0KICAgICAgICAgICAga2V5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2Jhc2U2NCcpIHx8DQogICAgICAgICAgICBrZXkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYmluYXJ5JykNCiAgICAgICAgKTsNCiAgICAgICAgDQogICAgICAgIGlmIChoYXNMYXJnZURhdGFJbmRpY2F0b3JzKSB7DQogICAgICAgICAgICAvLyBDaGVjayBzaXplcyBvZiB2YWx1ZXMgdGhhdCBtaWdodCBiZSBsYXJnZQ0KICAgICAgICAgICAgbGV0IHRvdGFsU2l6ZSA9IDA7DQogICAgICAgICAgICBsZXQgaGFzTGFyZ2VWYWx1ZXMgPSBmYWxzZTsNCiAgICAgICAgICAgIGNvbnN0IHN1bW1hcnkgPSB7fTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgew0KICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZGF0YVtrZXldOw0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmIHZhbHVlLmxlbmd0aCA+IDEwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeVtrZXldID0gYFN0cmluZyAoJHsodmFsdWUubGVuZ3RoIC8gMTAyNCkudG9GaXhlZCgyKX0gS0IpYDsNCiAgICAgICAgICAgICAgICAgICAgdG90YWxTaXplICs9IHZhbHVlLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgaGFzTGFyZ2VWYWx1ZXMgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgew0KICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5W2tleV0gPSBgQXJyYXlCdWZmZXIgKCR7KHZhbHVlLmJ5dGVMZW5ndGggLyAxMDI0KS50b0ZpeGVkKDIpfSBLQilgOw0KICAgICAgICAgICAgICAgICAgICB0b3RhbFNpemUgKz0gdmFsdWUuYnl0ZUxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgaGFzTGFyZ2VWYWx1ZXMgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID4gMTAwMCkgew0KICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5W2tleV0gPSBgQXJyYXlbJHt2YWx1ZS5sZW5ndGh9XSAoJHsodmFsdWUubGVuZ3RoIC8gMTAyNCkudG9GaXhlZCgyKX0gS0IgZXN0LilgOw0KICAgICAgICAgICAgICAgICAgICB0b3RhbFNpemUgKz0gdmFsdWUubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICBoYXNMYXJnZVZhbHVlcyA9IHRydWU7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeVtrZXldID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IGAiJHt2YWx1ZS5zdWJzdHJpbmcoMCwgMzApfS4uLiJgIDogdHlwZW9mIHZhbHVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGhhc0xhcmdlVmFsdWVzKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdMYXJnZSBPYmplY3QnLCANCiAgICAgICAgICAgICAgICAgICAgcHJldmlldzogSlNPTi5zdHJpbmdpZnkoc3VtbWFyeSwgbnVsbCwgMiksDQogICAgICAgICAgICAgICAgICAgIGtleXM6IGtleXMubGVuZ3RoLA0KICAgICAgICAgICAgICAgICAgICBlc3RpbWF0ZWRTaXplOiB0b3RhbFNpemUNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBSZWd1bGFyIG9iamVjdCBoYW5kbGluZw0KICAgICAgICBjb25zdCBwcmV2aWV3ID0ga2V5cy5sZW5ndGggPiAzDQogICAgICAgICAgICA/IGB7JHtrZXlzLnNsaWNlKDAsIDMpLmpvaW4oJywgJyl9LCAuLi59YA0KICAgICAgICAgICAgOiBKU09OLnN0cmluZ2lmeShkYXRhKTsNCiAgICAgICAgY29uc3QgdHJ1bmNhdGVkID0gcHJldmlldy5sZW5ndGggPiBtYXhMZW5ndGggPyBwcmV2aWV3LnN1YnN0cmluZygwLCBtYXhMZW5ndGgpICsgJy4uLicgOiBwcmV2aWV3Ow0KICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgIHR5cGU6ICdPYmplY3QnLCANCiAgICAgICAgICAgIHByZXZpZXc6IHRydW5jYXRlZCwNCiAgICAgICAgICAgIGtleXM6IGtleXMubGVuZ3RoDQogICAgICAgIH07DQogICAgfQ0KICAgIA0KICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBiYXNlNjQgZGF0YQ0KICAgICAgICBjb25zdCBpc0Jhc2U2NCA9IC9eW0EtWmEtejAtOSsvXSo9ezAsMn0kLy50ZXN0KGRhdGEpICYmIGRhdGEubGVuZ3RoID4gMTAwICYmIGRhdGEubGVuZ3RoICUgNCA9PT0gMDsNCiAgICAgICAgaWYgKGlzQmFzZTY0KSB7DQogICAgICAgICAgICBjb25zdCBzaXplS0IgPSAoZGF0YS5sZW5ndGggKiAwLjc1IC8gMTAyNCkudG9GaXhlZCgyKTsgLy8gQmFzZTY0IGlzIH4zMyUgbGFyZ2VyIHRoYW4gYmluYXJ5DQogICAgICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgICAgICB0eXBlOiAnQmFzZTY0IERhdGEnLCANCiAgICAgICAgICAgICAgICBwcmV2aWV3OiBgQmFzZTY0IGVuY29kZWQgZGF0YSAtICR7c2l6ZUtCfSBLQmAsDQogICAgICAgICAgICAgICAgbGVuZ3RoOiBkYXRhLmxlbmd0aA0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBhIGRhdGEgVVJMDQogICAgICAgIGlmIChkYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6JykpIHsNCiAgICAgICAgICAgIGNvbnN0IGNvbW1hSW5kZXggPSBkYXRhLmluZGV4T2YoJywnKTsNCiAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IGNvbW1hSW5kZXggPiAwID8gZGF0YS5zdWJzdHJpbmcoMCwgY29tbWFJbmRleCkgOiBkYXRhLnN1YnN0cmluZygwLCA1MCk7DQogICAgICAgICAgICBjb25zdCBkYXRhU2l6ZSA9IGNvbW1hSW5kZXggPiAwID8gZGF0YS5sZW5ndGggLSBjb21tYUluZGV4IC0gMSA6IGRhdGEubGVuZ3RoOw0KICAgICAgICAgICAgY29uc3Qgc2l6ZUtCID0gKGRhdGFTaXplICogMC43NSAvIDEwMjQpLnRvRml4ZWQoMik7DQogICAgICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgICAgICB0eXBlOiAnRGF0YSBVUkwnLCANCiAgICAgICAgICAgICAgICBwcmV2aWV3OiBgJHtoZWFkZXJ9Li4uIC0gJHtzaXplS0J9IEtCYCwNCiAgICAgICAgICAgICAgICBsZW5ndGg6IGRhdGEubGVuZ3RoDQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBSZWd1bGFyIHN0cmluZyBoYW5kbGluZw0KICAgICAgICBjb25zdCB0cnVuY2F0ZWQgPSBkYXRhLmxlbmd0aCA+IG1heExlbmd0aCA/IGRhdGEuc3Vic3RyaW5nKDAsIG1heExlbmd0aCkgKyAnLi4uJyA6IGRhdGE7DQogICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgdHlwZTogJ1N0cmluZycsIA0KICAgICAgICAgICAgcHJldmlldzogdHJ1bmNhdGVkLA0KICAgICAgICAgICAgbGVuZ3RoOiBkYXRhLmxlbmd0aA0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICByZXR1cm4geyANCiAgICAgICAgdHlwZTogdHlwZW9mIGRhdGEsIA0KICAgICAgICBwcmV2aWV3OiBTdHJpbmcoZGF0YSkgDQogICAgfTsNCn0NCg0KLy8gR2V0IG91dHB1dCBwb3J0IGRhdGEgZm9yIGEgc3BlY2lmaWMgbm9kZSBhbmQgcG9ydA0KZnVuY3Rpb24gZ2V0T3V0cHV0UG9ydERhdGEobm9kZUlkLCBwb3J0SWQpIHsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUgfHwgIW5vZGUubGFzdE91dHB1dERhdGEpIHsNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIA0KICAgIC8vIElmIHRoZSBvdXRwdXQgZGF0YSBpcyBhbiBvYmplY3Qgd2l0aCBuYW1lZCBwb3J0cywgZXh0cmFjdCB0aGUgc3BlY2lmaWMgcG9ydA0KICAgIGlmICh0eXBlb2Ygbm9kZS5sYXN0T3V0cHV0RGF0YSA9PT0gJ29iamVjdCcgJiYgbm9kZS5sYXN0T3V0cHV0RGF0YSAhPT0gbnVsbCAmJiAhQXJyYXkuaXNBcnJheShub2RlLmxhc3RPdXRwdXREYXRhKSAmJiAhKG5vZGUubGFzdE91dHB1dERhdGEgaW5zdGFuY2VvZiBCbG9iKSAmJiAhKG5vZGUubGFzdE91dHB1dERhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikpIHsNCiAgICAgICAgaWYgKHBvcnRJZCBpbiBub2RlLmxhc3RPdXRwdXREYXRhKSB7DQogICAgICAgICAgICByZXR1cm4gbm9kZS5sYXN0T3V0cHV0RGF0YVtwb3J0SWRdOw0KICAgICAgICB9DQogICAgICAgIC8vIFBvcnQgbm90IGZvdW5kIGluIG91dHB1dCBvYmplY3QNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIA0KICAgIC8vIEZvciBzaW5nbGUgb3V0cHV0IG5vZGVzIG9yIG5vbi1vYmplY3Qgb3V0cHV0cyAoQmxvYiwgQXJyYXlCdWZmZXIsIHByaW1pdGl2ZXMpLCANCiAgICAvLyBvbmx5IHJldHVybiBkYXRhIGZvciB0aGUgZmlyc3QvcHJpbWFyeSBvdXRwdXQgcG9ydA0KICAgIGNvbnN0IG5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICBpZiAobm9kZURlZiAmJiBub2RlRGVmLm91dHB1dHMgJiYgbm9kZURlZi5vdXRwdXRzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgLy8gT25seSByZXR1cm4gZGF0YSBmb3IgdGhlIGZpcnN0IG91dHB1dCBwb3J0LCBvdGhlcnMgZ2V0IG51bGwNCiAgICAgICAgaWYgKHBvcnRJZCA9PT0gbm9kZURlZi5vdXRwdXRzWzBdLmlkKSB7DQogICAgICAgICAgICByZXR1cm4gbm9kZS5sYXN0T3V0cHV0RGF0YTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQogICAgDQogICAgLy8gRmFsbGJhY2s6IHJldHVybiB0aGUgZGF0YSAoc2hvdWxkbid0IG5vcm1hbGx5IHJlYWNoIGhlcmUpDQogICAgcmV0dXJuIG5vZGUubGFzdE91dHB1dERhdGE7DQp9IA0KDQovLyBVcGRhdGUgY2FudmFzIHRyYW5zZm9ybSBmb3IgcGFubmluZyBhbmQgem9vbWluZw0KZnVuY3Rpb24gdXBkYXRlQ2FudmFzVHJhbnNmb3JtKCkgew0KICAgIGlmIChmbG93RWRpdG9yLmNhbnZhcykgew0KICAgICAgICBjb25zdCB0cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKCR7Zmxvd0VkaXRvci5wYW5PZmZzZXQueH1weCwgJHtmbG93RWRpdG9yLnBhbk9mZnNldC55fXB4KSBzY2FsZSgke2Zsb3dFZGl0b3Iuem9vbUxldmVsfSlgOw0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS50cmFuc2Zvcm0gPSB0cmFuc2Zvcm07DQogICAgICAgIA0KICAgICAgICAvLyBVcGRhdGUgem9vbSBsZXZlbCBkaXNwbGF5DQogICAgICAgIGNvbnN0IHpvb21EaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvb20tbGV2ZWwnKTsNCiAgICAgICAgaWYgKHpvb21EaXNwbGF5KSB7DQogICAgICAgICAgICB6b29tRGlzcGxheS50ZXh0Q29udGVudCA9IE1hdGgucm91bmQoZmxvd0VkaXRvci56b29tTGV2ZWwgKiAxMDApICsgJyUnOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBTdGFydCBjYW52YXMgcGFubmluZw0KZnVuY3Rpb24gc3RhcnRDYW52YXNQYW4oZSkgew0KICAgIC8vIE9ubHkgc3RhcnQgcGFubmluZyBpZiBjbGlja2luZyBkaXJlY3RseSBvbiBjYW52YXMgKG5vdCBvbiBub2RlcyBvciBvdGhlciBlbGVtZW50cykNCiAgICAvLyBhbmQgbm90IGFscmVhZHkgZHJhZ2dpbmcgYSBub2RlDQogICAgaWYgKGUudGFyZ2V0ID09PSBmbG93RWRpdG9yLmNhbnZhcyAmJiAhZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUpIHsNCiAgICAgICAgZmxvd0VkaXRvci5pc1Bhbm5pbmcgPSB0cnVlOw0KICAgICAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8NCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6DQogICAgICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgICAgIGZsb3dFZGl0b3IucGFuU3RhcnQgPSB7IHg6IG1vdXNlQ29vcmRzLngsIHk6IG1vdXNlQ29vcmRzLnkgfTsNCiAgICAgICAgZmxvd0VkaXRvci5sYXN0UGFuT2Zmc2V0ID0geyAuLi5mbG93RWRpdG9yLnBhbk9mZnNldCB9Ow0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS5jdXJzb3IgPSAnZ3JhYmJpbmcnOw0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5jbGFzc0xpc3QuYWRkKCdwYW5uaW5nJyk7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICB9DQp9DQoNCi8vIFVwZGF0ZSBjYW52YXMgcGFubmluZw0KZnVuY3Rpb24gdXBkYXRlQ2FudmFzUGFuKGUpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5pc1Bhbm5pbmcpIHsNCiAgICAgICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOg0KICAgICAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgICAgICBjb25zdCBkZWx0YVggPSBtb3VzZUNvb3Jkcy54IC0gZmxvd0VkaXRvci5wYW5TdGFydC54Ow0KICAgICAgICBjb25zdCBkZWx0YVkgPSBtb3VzZUNvb3Jkcy55IC0gZmxvd0VkaXRvci5wYW5TdGFydC55Ow0KDQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnggPSBmbG93RWRpdG9yLmxhc3RQYW5PZmZzZXQueCArIGRlbHRhWDsNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IGZsb3dFZGl0b3IubGFzdFBhbk9mZnNldC55ICsgZGVsdGFZOw0KDQogICAgICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgfQ0KfQ0KDQovLyBTdG9wIGNhbnZhcyBwYW5uaW5nDQpmdW5jdGlvbiBzdG9wQ2FudmFzUGFuKCkgew0KICAgIGlmIChmbG93RWRpdG9yLmlzUGFubmluZykgew0KICAgICAgICBmbG93RWRpdG9yLmlzUGFubmluZyA9IGZhbHNlOw0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS5jdXJzb3IgPSAnZ3JhYic7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLmNsYXNzTGlzdC5yZW1vdmUoJ3Bhbm5pbmcnKTsNCiAgICB9DQp9DQoNCi8vIFJlc2V0IGNhbnZhcyBwYW4gdG8gY2VudGVyDQpmdW5jdGlvbiByZXNldENhbnZhc1BhbigpIHsNCiAgICAvLyBBZGQgc21vb3RoIHRyYW5zaXRpb24gZm9yIHJlc2V0DQogICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICd0cmFuc2Zvcm0gMC4zcyBlYXNlLW91dCc7DQoNCiAgICAvLyBDYWxjdWxhdGUgY2VudGVyIG9mIGFsbCBub2RlcyBpZiBhbnkgZXhpc3QNCiAgICBpZiAoZmxvd0VkaXRvci5ub2Rlcy5zaXplID4gMCkgew0KICAgICAgICBjb25zdCBub2RlcyA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5ub2Rlcy52YWx1ZXMoKSk7DQogICAgICAgIGNvbnN0IG1pblggPSBNYXRoLm1pbiguLi5ub2Rlcy5tYXAobiA9PiBuLngpKTsNCiAgICAgICAgY29uc3QgbWF4WCA9IE1hdGgubWF4KC4uLm5vZGVzLm1hcChuID0+IG4ueCkpOw0KICAgICAgICBjb25zdCBtaW5ZID0gTWF0aC5taW4oLi4ubm9kZXMubWFwKG4gPT4gbi55KSk7DQogICAgICAgIGNvbnN0IG1heFkgPSBNYXRoLm1heCguLi5ub2Rlcy5tYXAobiA9PiBuLnkpKTsNCg0KICAgICAgICBjb25zdCBjZW50ZXJYID0gKG1pblggKyBtYXhYKSAvIDI7DQogICAgICAgIGNvbnN0IGNlbnRlclkgPSAobWluWSArIG1heFkpIC8gMjsNCg0KICAgICAgICAvLyBHZXQgY2FudmFzIGNvbnRhaW5lciBkaW1lbnNpb25zIChzY2FsZWQpDQogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPw0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDoNCiAgICAgICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCg0KICAgICAgICAvLyBDYWxjdWxhdGUgcGFuIG9mZnNldCB0byBjZW50ZXIgdGhlIG5vZGVzIGluIHRoZSB2aWV3cG9ydA0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gLWNlbnRlclggKyBjb250YWluZXJSZWN0LndpZHRoIC8gMjsNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IC1jZW50ZXJZICsgY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIElmIG5vIG5vZGVzLCByZXNldCB0byBjZW50ZXIgb2YgdGhlIGxhcmdlIGNhbnZhcw0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldCA9IHsgeDogLTUwMDAsIHk6IC01MDAwIH07DQogICAgfQ0KDQogICAgLy8gUmVzZXQgem9vbSB0byAxMDAlDQogICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSAxLjA7DQoNCiAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCg0KICAgIC8vIFJlbW92ZSB0cmFuc2l0aW9uIGFmdGVyIGFuaW1hdGlvbiBjb21wbGV0ZXMNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICcnOw0KICAgIH0sIDMwMCk7DQp9DQoNCi8vIFpvb20gZnVuY3Rpb25zDQpmdW5jdGlvbiB6b29tSW4oKSB7DQogICAgY29uc3QgbmV3Wm9vbSA9IE1hdGgubWluKGZsb3dFZGl0b3Iuem9vbUxldmVsICsgZmxvd0VkaXRvci56b29tU3RlcCwgZmxvd0VkaXRvci5tYXhab29tKTsNCiAgICBzZXRab29tTGV2ZWwobmV3Wm9vbSk7DQp9DQoNCmZ1bmN0aW9uIHpvb21PdXQoKSB7DQogICAgY29uc3QgbmV3Wm9vbSA9IE1hdGgubWF4KGZsb3dFZGl0b3Iuem9vbUxldmVsIC0gZmxvd0VkaXRvci56b29tU3RlcCwgZmxvd0VkaXRvci5taW5ab29tKTsNCiAgICBzZXRab29tTGV2ZWwobmV3Wm9vbSk7DQp9DQoNCmZ1bmN0aW9uIHNldFpvb21MZXZlbCh6b29tTGV2ZWwpIHsNCiAgICAvLyBHZXQgdGhlIGNlbnRlciBvZiB0aGUgY2FudmFzIGNvbnRhaW5lciBmb3Igem9vbSBvcmlnaW4NCiAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPw0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOg0KICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgDQogICAgY29uc3QgY2VudGVyWCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOw0KICAgIGNvbnN0IGNlbnRlclkgPSBjb250YWluZXJSZWN0LmhlaWdodCAvIDI7DQogICAgDQogICAgLy8gQ2FsY3VsYXRlIHRoZSBwb2ludCBpbiBjYW52YXMgY29vcmRpbmF0ZXMgdGhhdCBzaG91bGQgcmVtYWluIGZpeGVkDQogICAgY29uc3QgY2FudmFzWCA9IChjZW50ZXJYIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueCkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICBjb25zdCBjYW52YXNZID0gKGNlbnRlclkgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIA0KICAgIC8vIFVwZGF0ZSB6b29tIGxldmVsDQogICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSBNYXRoLm1heChmbG93RWRpdG9yLm1pblpvb20sIE1hdGgubWluKGZsb3dFZGl0b3IubWF4Wm9vbSwgem9vbUxldmVsKSk7DQogICAgDQogICAgLy8gQWRqdXN0IHBhbiBvZmZzZXQgdG8ga2VlcCB0aGUgY2VudGVyIHBvaW50IGZpeGVkDQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IGNlbnRlclggLSBjYW52YXNYICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IGNlbnRlclkgLSBjYW52YXNZICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgDQogICAgdXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgDQogICAgLy8gUmVkcmF3IGNvbm5lY3Rpb25zIGFmdGVyIHpvb20NCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICB9LCAxNik7DQp9DQoNCmZ1bmN0aW9uIHpvb21Ub0ZpdCgpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5ub2Rlcy5zaXplID09PSAwKSB7DQogICAgICAgIC8vIElmIG5vIG5vZGVzLCByZXNldCB0byAxMDAlIHpvb20gYW5kIGNlbnRlcg0KICAgICAgICBmbG93RWRpdG9yLnpvb21MZXZlbCA9IDEuMDsNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQgPSB7IHg6IC01MDAwLCB5OiAtNTAwMCB9Ow0KICAgICAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBGaW5kIGJvdW5kcyBvZiBhbGwgbm9kZXMNCiAgICBjb25zdCBub2RlcyA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5ub2Rlcy52YWx1ZXMoKSk7DQogICAgY29uc3QgcGFkZGluZyA9IDEwMDsgLy8gRXh0cmEgcGFkZGluZyBhcm91bmQgbm9kZXMNCiAgICANCiAgICBsZXQgbWluWCA9IEluZmluaXR5LCBtYXhYID0gLUluZmluaXR5Ow0KICAgIGxldCBtaW5ZID0gSW5maW5pdHksIG1heFkgPSAtSW5maW5pdHk7DQogICAgDQogICAgbm9kZXMuZm9yRWFjaChub2RlID0+IHsNCiAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlLmlkKTsNCiAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICBjb25zdCByZWN0ID0gbm9kZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICAgICAgICBtaW5YID0gTWF0aC5taW4obWluWCwgbm9kZS54KTsNCiAgICAgICAgICAgIG1heFggPSBNYXRoLm1heChtYXhYLCBub2RlLnggKyByZWN0LndpZHRoKTsNCiAgICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCBub2RlLnkpOw0KICAgICAgICAgICAgbWF4WSA9IE1hdGgubWF4KG1heFksIG5vZGUueSArIHJlY3QuaGVpZ2h0KTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIEFkZCBwYWRkaW5nDQogICAgbWluWCAtPSBwYWRkaW5nOw0KICAgIG1heFggKz0gcGFkZGluZzsNCiAgICBtaW5ZIC09IHBhZGRpbmc7DQogICAgbWF4WSArPSBwYWRkaW5nOw0KICAgIA0KICAgIGNvbnN0IGNvbnRlbnRXaWR0aCA9IG1heFggLSBtaW5YOw0KICAgIGNvbnN0IGNvbnRlbnRIZWlnaHQgPSBtYXhZIC0gbWluWTsNCiAgICANCiAgICAvLyBHZXQgY29udGFpbmVyIGRpbWVuc2lvbnMNCiAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPw0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOg0KICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgDQogICAgLy8gQ2FsY3VsYXRlIHpvb20gdG8gZml0DQogICAgY29uc3Qgem9vbVggPSBjb250YWluZXJSZWN0LndpZHRoIC8gY29udGVudFdpZHRoOw0KICAgIGNvbnN0IHpvb21ZID0gY29udGFpbmVyUmVjdC5oZWlnaHQgLyBjb250ZW50SGVpZ2h0Ow0KICAgIGNvbnN0IG5ld1pvb20gPSBNYXRoLm1pbih6b29tWCwgem9vbVksIGZsb3dFZGl0b3IubWF4Wm9vbSk7DQogICAgDQogICAgLy8gU2V0IHpvb20gbGV2ZWwNCiAgICBmbG93RWRpdG9yLnpvb21MZXZlbCA9IE1hdGgubWF4KGZsb3dFZGl0b3IubWluWm9vbSwgbmV3Wm9vbSk7DQogICAgDQogICAgLy8gQ2VudGVyIHRoZSBjb250ZW50DQogICAgY29uc3QgY2VudGVyWCA9IChtaW5YICsgbWF4WCkgLyAyOw0KICAgIGNvbnN0IGNlbnRlclkgPSAobWluWSArIG1heFkpIC8gMjsNCiAgICANCiAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gY29udGFpbmVyUmVjdC53aWR0aCAvIDIgLSBjZW50ZXJYICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMiAtIGNlbnRlclkgKiBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICANCiAgICAvLyBBZGQgc21vb3RoIHRyYW5zaXRpb24NCiAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS50cmFuc2l0aW9uID0gJ3RyYW5zZm9ybSAwLjNzIGVhc2Utb3V0JzsNCiAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICANCiAgICAvLyBSZW1vdmUgdHJhbnNpdGlvbiBhZnRlciBhbmltYXRpb24NCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICcnOw0KICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgIH0sIDMwMCk7DQp9DQoNCi8vIEhhbmRsZSBtb3VzZSB3aGVlbCB6b29tDQpmdW5jdGlvbiBoYW5kbGVNb3VzZVdoZWVsKGUpIHsNCiAgICBpZiAoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIA0KICAgICAgICAvLyBHZXQgbW91c2UgcG9zaXRpb24gcmVsYXRpdmUgdG8gY29udGFpbmVyDQogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPw0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDoNCiAgICAgICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPw0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDoNCiAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IG1vdXNlWCA9IG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQ7DQogICAgICAgIGNvbnN0IG1vdXNlWSA9IG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcDsNCiAgICAgICAgDQogICAgICAgIC8vIENhbGN1bGF0ZSB6b29tIGRlbHRhDQogICAgICAgIGNvbnN0IHpvb21EZWx0YSA9IGUuZGVsdGFZID4gMCA/IC1mbG93RWRpdG9yLnpvb21TdGVwIDogZmxvd0VkaXRvci56b29tU3RlcDsNCiAgICAgICAgY29uc3QgbmV3Wm9vbSA9IE1hdGgubWF4KGZsb3dFZGl0b3IubWluWm9vbSwgTWF0aC5taW4oZmxvd0VkaXRvci5tYXhab29tLCBmbG93RWRpdG9yLnpvb21MZXZlbCArIHpvb21EZWx0YSkpOw0KICAgICAgICANCiAgICAgICAgaWYgKG5ld1pvb20gIT09IGZsb3dFZGl0b3Iuem9vbUxldmVsKSB7DQogICAgICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIHBvaW50IGluIGNhbnZhcyBjb29yZGluYXRlcyB0aGF0IHNob3VsZCByZW1haW4gZml4ZWQgKHVuZGVyIG1vdXNlKQ0KICAgICAgICAgICAgY29uc3QgY2FudmFzWCA9IChtb3VzZVggLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgY29uc3QgY2FudmFzWSA9IChtb3VzZVkgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBVcGRhdGUgem9vbSBsZXZlbA0KICAgICAgICAgICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSBuZXdab29tOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBBZGp1c3QgcGFuIG9mZnNldCB0byBrZWVwIHRoZSBtb3VzZSBwb2ludCBmaXhlZA0KICAgICAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IG1vdXNlWCAtIGNhbnZhc1ggKiBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSBtb3VzZVkgLSBjYW52YXNZICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBSZWRyYXcgY29ubmVjdGlvbnMgYWZ0ZXIgem9vbQ0KICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGZsb3dFZGl0b3Iuem9vbVJlZHJhd1RpbWVvdXQpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci56b29tUmVkcmF3VGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgICAgICAgICB9LCA1MCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIEhhbmRsZSBjYW52YXMgY2xpY2sgZXZlbnRzDQpmdW5jdGlvbiBoYW5kbGVDYW52YXNDbGljayhlKSB7DQogICAgaWYgKGUudGFyZ2V0ID09PSBmbG93RWRpdG9yLmNhbnZhcykgew0KICAgICAgICAvLyBEZXNlbGVjdCBub2RlDQogICAgICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSkgew0KICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSk7DQogICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7DQogICAgICAgICAgICBmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9IG51bGw7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZS1jb25maWcnKS5pbm5lckhUTUwgPSAnPHAgY2xhc3M9InRleHQtbXV0ZWQiPlNlbGVjdCBhIG5vZGUgdG8gY29uZmlndXJlIGl0PC9wPic7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIEhhbmRsZSBkb2N1bWVudCBtb3VzZSBldmVudHMgZm9yIHNtb290aCBkcmFnZ2luZw0KZnVuY3Rpb24gaGFuZGxlRG9jdW1lbnRNb3VzZURvd24oZSkgew0KICAgIC8vIERvbid0IHN0YXJ0IGRyYWdnaW5nIGlmIGNsaWNraW5nIG9uIFVJIGVsZW1lbnRzDQogICAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy5mbG93LXRvb2xiYXInKSB8fCANCiAgICAgICAgZS50YXJnZXQuY2xvc2VzdCgnLmZsb3ctY29uZmlnLXBhbmVsJykgfHwgDQogICAgICAgIGUudGFyZ2V0LmNsb3Nlc3QoJy5mbG93LW91dHB1dC1wYW5lbCcpIHx8DQogICAgICAgIGUudGFyZ2V0LmNsb3Nlc3QoJy5ub2RlLWRlbGV0ZS1idG4nKSkgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIERvbid0IHN0YXJ0IGRyYWdnaW5nIGlmIHdlJ3JlIHBhbm5pbmcNCiAgICBpZiAoZmxvd0VkaXRvci5pc1Bhbm5pbmcpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBPbmx5IGFsbG93IGRyYWdnaW5nIGZyb20gdGhlIG5vZGUgaGVhZGVyDQogICAgY29uc3QgaGVhZGVyRWxlbWVudCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5mbG93LW5vZGUtaGVhZGVyJyk7DQogICAgaWYgKCFoZWFkZXJFbGVtZW50KSByZXR1cm47DQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBoZWFkZXJFbGVtZW50LmNsb3Nlc3QoJy5mbG93LW5vZGUnKTsNCiAgICBpZiAoIW5vZGVFbGVtZW50KSByZXR1cm47DQogICAgDQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgY29uc3Qgbm9kZUlkID0gbm9kZUVsZW1lbnQuaWQ7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgDQogICAgaWYgKG5vZGUpIHsNCiAgICAgICAgZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUgPSBub2RlSWQ7DQogICAgICAgIA0KICAgICAgICAvLyBDYWxjdWxhdGUgb2Zmc2V0IGZyb20gbW91c2UgdG8gbm9kZSBjb3JuZXIsIGFjY291bnRpbmcgZm9yIHpvb20NCiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDogDQogICAgICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICAgIA0KICAgICAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOiANCiAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgDQogICAgICAgIC8vIENvbnZlcnQgbW91c2UgcG9zaXRpb24gdG8gY2FudmFzIGNvb3JkaW5hdGVzDQogICAgICAgIGNvbnN0IGNhbnZhc01vdXNlWCA9IChtb3VzZUNvb3Jkcy54IC0gY29udGFpbmVyUmVjdC5sZWZ0IC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueCkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgY29uc3QgY2FudmFzTW91c2VZID0gKG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgIA0KICAgICAgICAvLyBDYWxjdWxhdGUgb2Zmc2V0IGluIGNhbnZhcyBjb29yZGluYXRlcw0KICAgICAgICBmbG93RWRpdG9yLmRyYWdPZmZzZXQgPSB7DQogICAgICAgICAgICB4OiAoY2FudmFzTW91c2VYIC0gbm9kZS54KSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsLA0KICAgICAgICAgICAgeTogKGNhbnZhc01vdXNlWSAtIG5vZGUueSkgKiBmbG93RWRpdG9yLnpvb21MZXZlbA0KICAgICAgICB9Ow0KICAgICAgICANCiAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ2dyYWJiaW5nJzsNCiAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUuekluZGV4ID0gJzEwMDAnOyAvLyBCcmluZyB0byBmcm9udCB3aGlsZSBkcmFnZ2luZw0KICAgICAgICANCiAgICAgICAgLy8gQ2FjaGUgY29udGFpbmVyIHJlY3QgZm9yIHBlcmZvcm1hbmNlDQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzUmVjdCA9IGNvbnRhaW5lclJlY3Q7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBoYW5kbGVEb2N1bWVudE1vdXNlTW92ZShlKSB7DQogICAgLy8gSGFuZGxlIGNhbnZhcyBwYW5uaW5nDQogICAgaWYgKGZsb3dFZGl0b3IuaXNQYW5uaW5nKSB7DQogICAgICAgIHVwZGF0ZUNhbnZhc1BhbihlKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBHZXQgc2NhbGVkIGNvb3JkaW5hdGVzDQogICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/IA0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOiANCiAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgIA0KICAgIC8vIEhhbmRsZSB0YWcgZHJhZ2dpbmcNCiAgICBpZiAoZmxvd0VkaXRvci5kcmFnZ2luZ1RhZyAmJiBmbG93RWRpdG9yLnRhZ0RyYWdPZmZzZXQpIHsNCiAgICAgICAgY29uc3QgdGFnID0gZmxvd0VkaXRvci50YWdzLmdldChmbG93RWRpdG9yLmRyYWdnaW5nVGFnKTsNCiAgICAgICAgaWYgKHRhZykgew0KICAgICAgICAgICAgLy8gR2V0IGNvbnRhaW5lciBkaW1lbnNpb25zIGZvciBjb29yZGluYXRlIGNvbnZlcnNpb24NCiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8gDQogICAgICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDogDQogICAgICAgICAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDb252ZXJ0IG1vdXNlIGNvb3JkaW5hdGVzIHRvIGNhbnZhcyBjb29yZGluYXRlcywgYWNjb3VudGluZyBmb3IgcGFuIGFuZCB6b29tDQogICAgICAgICAgICBjb25zdCBjYW52YXNNb3VzZVggPSAobW91c2VDb29yZHMueCAtIGNvbnRhaW5lclJlY3QubGVmdCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICBjb25zdCBjYW52YXNNb3VzZVkgPSAobW91c2VDb29yZHMueSAtIGNvbnRhaW5lclJlY3QudG9wIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBwb3NpdGlvbiB3aXRoIG9mZnNldCAoZHJhZyBvZmZzZXQgaXMgYWxzbyBpbiBzY3JlZW4gY29vcmRpbmF0ZXMsIHNvIGNvbnZlcnQgaXQpDQogICAgICAgICAgICBjb25zdCBkcmFnT2Zmc2V0WCA9IGZsb3dFZGl0b3IudGFnRHJhZ09mZnNldC54IC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICBjb25zdCBkcmFnT2Zmc2V0WSA9IGZsb3dFZGl0b3IudGFnRHJhZ09mZnNldC55IC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIHRhZy54ID0gY2FudmFzTW91c2VYIC0gZHJhZ09mZnNldFg7DQogICAgICAgICAgICB0YWcueSA9IGNhbnZhc01vdXNlWSAtIGRyYWdPZmZzZXRZOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCB0YWdFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmxvd0VkaXRvci5kcmFnZ2luZ1RhZyk7DQogICAgICAgICAgICBpZiAodGFnRWxlbWVudCkgew0KICAgICAgICAgICAgICAgIC8vIFVzZSBsZWZ0L3RvcCBmb3IgcG9zaXRpb25pbmcNCiAgICAgICAgICAgICAgICB0YWdFbGVtZW50LnN0eWxlLmxlZnQgPSB0YWcueCArICdweCc7DQogICAgICAgICAgICAgICAgdGFnRWxlbWVudC5zdHlsZS50b3AgPSB0YWcueSArICdweCc7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFRocm90dGxlIHVwZGF0ZXMgZm9yIGJldHRlciBwZXJmb3JtYW5jZQ0KICAgICAgICAgICAgaWYgKCFmbG93RWRpdG9yLnRhZ1VwZGF0ZVRpbWVvdXQpIHsNCiAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnRhZ1VwZGF0ZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci50YWdVcGRhdGVUaW1lb3V0ID0gbnVsbDsNCiAgICAgICAgICAgICAgICB9LCAxNik7IC8vIH42MGZwcw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgaWYgKGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlICYmIGZsb3dFZGl0b3IuZHJhZ09mZnNldCkgew0KICAgICAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUpOw0KICAgICAgICBpZiAobm9kZSkgew0KICAgICAgICAgICAgLy8gR2V0IGNvbnRhaW5lciBkaW1lbnNpb25zIGZvciBjb29yZGluYXRlIGNvbnZlcnNpb24NCiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8gDQogICAgICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDogDQogICAgICAgICAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDb252ZXJ0IG1vdXNlIGNvb3JkaW5hdGVzIHRvIGNhbnZhcyBjb29yZGluYXRlcywgYWNjb3VudGluZyBmb3IgcGFuIGFuZCB6b29tDQogICAgICAgICAgICBjb25zdCBjYW52YXNNb3VzZVggPSAobW91c2VDb29yZHMueCAtIGNvbnRhaW5lclJlY3QubGVmdCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICBjb25zdCBjYW52YXNNb3VzZVkgPSAobW91c2VDb29yZHMueSAtIGNvbnRhaW5lclJlY3QudG9wIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBwb3NpdGlvbiB3aXRoIG9mZnNldCAoZHJhZyBvZmZzZXQgaXMgYWxzbyBpbiBzY3JlZW4gY29vcmRpbmF0ZXMsIHNvIGNvbnZlcnQgaXQpDQogICAgICAgICAgICBjb25zdCBkcmFnT2Zmc2V0WCA9IGZsb3dFZGl0b3IuZHJhZ09mZnNldC54IC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICBjb25zdCBkcmFnT2Zmc2V0WSA9IGZsb3dFZGl0b3IuZHJhZ09mZnNldC55IC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIG5vZGUueCA9IGNhbnZhc01vdXNlWCAtIGRyYWdPZmZzZXRYOw0KICAgICAgICAgICAgbm9kZS55ID0gY2FudmFzTW91c2VZIC0gZHJhZ09mZnNldFk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUpOw0KICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUubGVmdCA9IG5vZGUueCArICdweCc7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUudG9wID0gbm9kZS55ICsgJ3B4JzsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgYWxsIGNvbm5lY3Rpb25zIGZvciB0aGlzIG5vZGUgKHRocm90dGxlZCBmb3IgcGVyZm9ybWFuY2UpDQogICAgICAgICAgICAgICAgaWYgKCFmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQpIHsNCiAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVDb25uZWN0aW9uc0Zvck5vZGUobm9kZS5pZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9LCAxNik7IC8vIH42MGZwcw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gaGFuZGxlRG9jdW1lbnRNb3VzZVVwKGUpIHsNCiAgICAvLyBIYW5kbGUgY2FudmFzIHBhbm5pbmcgc3RvcA0KICAgIGlmIChmbG93RWRpdG9yLmlzUGFubmluZykgew0KICAgICAgICBzdG9wQ2FudmFzUGFuKCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gSGFuZGxlIHRhZyBkcmFnZ2luZyBzdG9wDQogICAgaWYgKGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcpIHsNCiAgICAgICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcpOw0KICAgICAgICBpZiAodGFnRWxlbWVudCkgew0KICAgICAgICAgICAgdGFnRWxlbWVudC5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7DQogICAgICAgICAgICB0YWdFbGVtZW50LnN0eWxlLnpJbmRleCA9ICcxMDAnOw0KICAgICAgICAgICAgdGFnRWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gJ2JveC1zaGFkb3cgMC4ycyBlYXNlLCB0cmFuc2Zvcm0gMC4ycyBlYXNlJzsgLy8gUmVzdG9yZSB0cmFuc2l0aW9ucw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBmbG93RWRpdG9yLmRyYWdnaW5nVGFnID0gbnVsbDsNCiAgICAgICAgZmxvd0VkaXRvci50YWdEcmFnT2Zmc2V0ID0gbnVsbDsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBpZiAoZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUpIHsNCiAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSk7DQogICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ2dyYWInOw0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUuekluZGV4ID0gJyc7IC8vIFJlc2V0IHotaW5kZXgNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgYW55IHBlbmRpbmcgY29ubmVjdGlvbiB1cGRhdGVzDQogICAgICAgIGlmIChmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQpIHsNCiAgICAgICAgICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0ID0gbnVsbDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gRmluYWwgY29ubmVjdGlvbiB1cGRhdGUNCiAgICAgICAgdXBkYXRlQ29ubmVjdGlvbnNGb3JOb2RlKGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKTsNCiAgICAgICAgDQogICAgICAgIGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlID0gbnVsbDsNCiAgICAgICAgZmxvd0VkaXRvci5kcmFnT2Zmc2V0ID0gbnVsbDsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXNSZWN0ID0gbnVsbDsNCiAgICB9DQp9DQoNCg0KLy8gRXhhbXBsZTogY2FudmFzLW1hbmFnZXIuanMNCndpbmRvdy5jYW52YXNNYW5hZ2VyID0gew0KICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSwNCiAgICBzdGFydENhbnZhc1BhbiwNCiAgICB1cGRhdGVDYW52YXNQYW4sDQogICAgc3RvcENhbnZhc1BhbiwNCiAgICByZXNldENhbnZhc1BhbiwNCiAgICBoYW5kbGVDYW52YXNDbGljaywNCiAgICBoYW5kbGVEb2N1bWVudE1vdXNlRG93biwNCiAgICBoYW5kbGVEb2N1bWVudE1vdXNlTW92ZSwNCiAgICBoYW5kbGVEb2N1bWVudE1vdXNlVXAsDQogICAgem9vbUluLA0KICAgIHpvb21PdXQsDQogICAgc2V0Wm9vbUxldmVsLA0KICAgIHpvb21Ub0ZpdCwNCiAgICBoYW5kbGVNb3VzZVdoZWVsDQp9Ow0KDQoNCi8vIEFkZCBhIG5ldyB0YWcgYXQgY3VycmVudCB2aWV3cG9ydCBjZW50ZXINCmFzeW5jIGZ1bmN0aW9uIGFkZFRhZygpIHsNCiAgICBjb25zdCB0YWdOYW1lID0gYXdhaXQgc3lwbmV4QVBJLnNob3dJbnB1dE1vZGFsKA0KICAgICAgICAnQ3JlYXRlIE5ldyBUYWcnLA0KICAgICAgICAnVGFnIE5hbWU6JywNCiAgICAgICAgew0KICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICdFbnRlciB0YWcgbmFtZScsDQogICAgICAgICAgICBjb25maXJtVGV4dDogJ0NyZWF0ZSBUYWcnLA0KICAgICAgICAgICAgY2FuY2VsVGV4dDogJ0NhbmNlbCcsDQogICAgICAgICAgICBpY29uOiAnZmFzIGZhLXRhZycNCiAgICAgICAgfQ0KICAgICk7DQogICAgDQogICAgaWYgKCF0YWdOYW1lIHx8IHRhZ05hbWUudHJpbSgpID09PSAnJykgcmV0dXJuOw0KDQogICAgY29uc3QgdGFnSWQgPSBgdGFnXyR7KytmbG93RWRpdG9yLnRhZ0NvdW50ZXJ9YDsNCg0KICAgIC8vIENhbGN1bGF0ZSBwb3NpdGlvbiBhdCBjdXJyZW50IHZpZXdwb3J0IGNlbnRlcg0KICAgIC8vIEdldCBjZW50ZXIgcG9zaXRpb24gaW4gY2FudmFzIGNvb3JkaW5hdGVzDQogICAgY29uc3QgY2VudGVyID0gd2luZG93LmZsb3dFZGl0b3JVdGlscyA/IA0KICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmdldFZpZXdwb3J0Q2VudGVySW5DYW52YXMoKSA6DQogICAgICAgIHsgeDogNTAwMCwgeTogNTAwMCB9OyAvLyBGYWxsYmFjayB0byBjYW52YXMgY2VudGVyDQoNCiAgICBjb25zdCB0YWcgPSB7DQogICAgICAgIGlkOiB0YWdJZCwNCiAgICAgICAgbmFtZTogdGFnTmFtZS50cmltKCksDQogICAgICAgIGRlc2NyaXB0aW9uOiAnJywNCiAgICAgICAgeDogY2VudGVyLngsDQogICAgICAgIHk6IGNlbnRlci55LA0KICAgICAgICBjb2xvcjogJyM0Q0FGNTAnIC8vIEdyZWVuIGNvbG9yDQogICAgfTsNCg0KICAgIGZsb3dFZGl0b3IudGFncy5zZXQodGFnSWQsIHRhZyk7DQogICAgY3JlYXRlVGFnRWxlbWVudCh0YWcpOw0KICAgIHVwZGF0ZVRhZ1BhbmVsKCk7DQoNCn0NCg0KLy8gQ3JlYXRlIHRhZyBlbGVtZW50IG9uIGNhbnZhcw0KZnVuY3Rpb24gY3JlYXRlVGFnRWxlbWVudCh0YWcpIHsNCiAgICBjb25zdCB0YWdFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgdGFnRWxlbWVudC5pZCA9IHRhZy5pZDsNCiAgICB0YWdFbGVtZW50LmNsYXNzTmFtZSA9ICdjYW52YXMtdGFnJzsNCiAgICB0YWdFbGVtZW50LnN0eWxlLmNzc1RleHQgPSBgDQogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgbGVmdDogJHt0YWcueH1weDsNCiAgICAgICAgdG9wOiAke3RhZy55fXB4Ow0KICAgICAgICBiYWNrZ3JvdW5kOiAke3RhZy5jb2xvcn07DQogICAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgICAgcGFkZGluZzogNHB4IDhweDsNCiAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgICAgICBmb250LXdlaWdodDogNTAwOw0KICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAgIHVzZXItc2VsZWN0OiBub25lOw0KICAgICAgICB6LWluZGV4OiAxMDA7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsMCwwLDAuMik7DQogICAgICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4ycyBlYXNlLCB0cmFuc2Zvcm0gMC4ycyBlYXNlOw0KICAgIGA7DQogICAgdGFnRWxlbWVudC50ZXh0Q29udGVudCA9IHRhZy5uYW1lOw0KDQogICAgLy8gTWFrZSB0YWcgZHJhZ2dhYmxlDQogICAgdGFnRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZSkgPT4gew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgIHN0YXJ0RHJhZ2dpbmdUYWcodGFnLmlkLCBlKTsNCiAgICB9KTsNCg0KICAgIC8vIENsaWNrIHRvIGp1bXAgdG8gdGFnDQogICAgdGFnRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgIGlmICghZmxvd0VkaXRvci5kcmFnZ2luZ1RhZykgew0KICAgICAgICAgICAganVtcFRvVGFnKHRhZy5pZCk7DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgIC8vIEhvdmVyIGVmZmVjdHMNCiAgICB0YWdFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7DQogICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDEuMDUpJzsNCiAgICAgICAgdGFnRWxlbWVudC5zdHlsZS5ib3hTaGFkb3cgPSAnMCA0cHggOHB4IHJnYmEoMCwwLDAsMC4zKSc7DQogICAgfSk7DQoNCiAgICB0YWdFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7DQogICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDEpJzsNCiAgICAgICAgdGFnRWxlbWVudC5zdHlsZS5ib3hTaGFkb3cgPSAnMCAycHggNHB4IHJnYmEoMCwwLDAsMC4yKSc7DQogICAgfSk7DQoNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5hcHBlbmRDaGlsZCh0YWdFbGVtZW50KTsNCn0NCg0KLy8gU3RhcnQgZHJhZ2dpbmcgYSB0YWcNCmZ1bmN0aW9uIHN0YXJ0RHJhZ2dpbmdUYWcodGFnSWQsIGUpIHsNCiAgICBjb25zdCB0YWcgPSBmbG93RWRpdG9yLnRhZ3MuZ2V0KHRhZ0lkKTsNCiAgICBpZiAoIXRhZykgcmV0dXJuOw0KDQogICAgZmxvd0VkaXRvci5kcmFnZ2luZ1RhZyA9IHRhZ0lkOw0KDQogICAgLy8gQ2FsY3VsYXRlIG9mZnNldCBmcm9tIG1vdXNlIHRvIHRhZyBjb3JuZXIsIGFjY291bnRpbmcgZm9yIHpvb20NCiAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPyANCiAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDogDQogICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICANCiAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8gDQogICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6IA0KICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgDQogICAgLy8gQ29udmVydCBtb3VzZSBwb3NpdGlvbiB0byBjYW52YXMgY29vcmRpbmF0ZXMNCiAgICBjb25zdCBjYW52YXNNb3VzZVggPSAobW91c2VDb29yZHMueCAtIGNvbnRhaW5lclJlY3QubGVmdCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgY29uc3QgY2FudmFzTW91c2VZID0gKG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgDQogICAgLy8gQ2FsY3VsYXRlIG9mZnNldCBpbiBjYW52YXMgY29vcmRpbmF0ZXMNCiAgICBmbG93RWRpdG9yLnRhZ0RyYWdPZmZzZXQgPSB7DQogICAgICAgIHg6IChjYW52YXNNb3VzZVggLSB0YWcueCkgKiBmbG93RWRpdG9yLnpvb21MZXZlbCwNCiAgICAgICAgeTogKGNhbnZhc01vdXNlWSAtIHRhZy55KSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsDQogICAgfTsNCg0KICAgIGNvbnN0IHRhZ0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWdJZCk7DQogICAgdGFnRWxlbWVudC5zdHlsZS5jdXJzb3IgPSAnZ3JhYmJpbmcnOw0KICAgIHRhZ0VsZW1lbnQuc3R5bGUuekluZGV4ID0gJzEwMDEnOw0KICAgIHRhZ0VsZW1lbnQuc3R5bGUudHJhbnNpdGlvbiA9ICdub25lJzsgLy8gRGlzYWJsZSB0cmFuc2l0aW9ucyBkdXJpbmcgZHJhZw0KfQ0KDQovLyBKdW1wIHRvIHRhZyBsb2NhdGlvbg0KZnVuY3Rpb24ganVtcFRvVGFnKHRhZ0lkKSB7DQogICAgY29uc3QgdGFnID0gZmxvd0VkaXRvci50YWdzLmdldCh0YWdJZCk7DQogICAgaWYgKCF0YWcpIHJldHVybjsNCg0KICAgIC8vIEFkZCBzbW9vdGggdHJhbnNpdGlvbg0KICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zaXRpb24gPSAndHJhbnNmb3JtIDAuNXMgZWFzZS1vdXQnOw0KDQogICAgLy8gVXNlIHV0aWxpdHkgZnVuY3Rpb24gdG8gY2VudGVyIHZpZXdwb3J0IG9uIHRhZyBjb29yZGluYXRlcw0KICAgIGlmICh3aW5kb3cuZmxvd0VkaXRvclV0aWxzICYmIHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuY2VudGVyVmlld3BvcnRPbkNhbnZhcykgew0KICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmNlbnRlclZpZXdwb3J0T25DYW52YXModGFnLngsIHRhZy55KTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBGYWxsYmFjayBtZXRob2QNCiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOw0KICAgICAgICBjb25zdCB2aWV3cG9ydENlbnRlclkgPSBjb250YWluZXJSZWN0LmhlaWdodCAvIDI7DQogICAgICAgIA0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gdmlld3BvcnRDZW50ZXJYIC0gKHRhZy54ICogZmxvd0VkaXRvci56b29tTGV2ZWwpOw0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC55ID0gdmlld3BvcnRDZW50ZXJZIC0gKHRhZy55ICogZmxvd0VkaXRvci56b29tTGV2ZWwpOw0KICAgICAgICANCiAgICAgICAgd2luZG93LmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgfQ0KDQogICAgLy8gUmVtb3ZlIHRyYW5zaXRpb24gYWZ0ZXIgYW5pbWF0aW9uIGNvbXBsZXRlcw0KICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS50cmFuc2l0aW9uID0gJyc7DQogICAgfSwgNTAwKTsNCn0NCg0KLy8gVXBkYXRlIHRhZyBwYW5lbA0KZnVuY3Rpb24gdXBkYXRlVGFnUGFuZWwoKSB7DQogICAgY29uc3QgdGFnUGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFnLXBhbmVsJyk7DQogICAgaWYgKCF0YWdQYW5lbCkgcmV0dXJuOw0KDQogICAgaWYgKGZsb3dFZGl0b3IudGFncy5zaXplID09PSAwKSB7DQogICAgICAgIHRhZ1BhbmVsLmlubmVySFRNTCA9ICc8cCBjbGFzcz0idGV4dC1tdXRlZCI+Tm8gdGFncyB5ZXQ8L3A+JzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGxldCB0YWdIdG1sID0gJyc7DQogICAgZmxvd0VkaXRvci50YWdzLmZvckVhY2godGFnID0+IHsNCiAgICAgICAgdGFnSHRtbCArPSBgDQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWctaXRlbSIgZGF0YS10YWctaWQ9IiR7dGFnLmlkfSI+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFnLWNvbG9yIiBzdHlsZT0iYmFja2dyb3VuZDogJHt0YWcuY29sb3J9Ij48L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWctaW5mbyI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRhZy1uYW1lIj4ke3RhZy5uYW1lfTwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAke3RhZy5kZXNjcmlwdGlvbiA/IGA8ZGl2IGNsYXNzPSJ0YWctZGVzY3JpcHRpb24iPiR7dGFnLmRlc2NyaXB0aW9ufTwvZGl2PmAgOiAnJ30NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ0YWctZGVsZXRlIiBkYXRhLXRhZy1pZD0iJHt0YWcuaWR9Ij4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS10aW1lcyI+PC9pPg0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgIGA7DQogICAgfSk7DQoNCiAgICB0YWdQYW5lbC5pbm5lckhUTUwgPSB0YWdIdG1sOw0KDQogICAgLy8gQWRkIGV2ZW50IGxpc3RlbmVycw0KICAgIHRhZ1BhbmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWctaXRlbScpLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgaWYgKCFlLnRhcmdldC5jbG9zZXN0KCcudGFnLWRlbGV0ZScpKSB7DQogICAgICAgICAgICAgICAgY29uc3QgdGFnSWQgPSBpdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS10YWctaWQnKTsNCiAgICAgICAgICAgICAgICBqdW1wVG9UYWcodGFnSWQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9KTsNCg0KICAgIHRhZ1BhbmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWctZGVsZXRlJykuZm9yRWFjaChidG4gPT4gew0KICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgIGNvbnN0IHRhZ0lkID0gYnRuLmdldEF0dHJpYnV0ZSgnZGF0YS10YWctaWQnKTsNCiAgICAgICAgICAgIGRlbGV0ZVRhZyh0YWdJZCk7DQogICAgICAgIH0pOw0KICAgIH0pOw0KfQ0KDQovLyBEZWxldGUgYSB0YWcNCmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVRhZyh0YWdJZCkgew0KICAgIGNvbnN0IGNvbmZpcm1lZCA9IGF3YWl0IHN5cG5leEFQSS5zaG93Q29uZmlybWF0aW9uKA0KICAgICAgICAnRGVsZXRlIFRhZycsDQogICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgdGFnPycsDQogICAgICAgIHsNCiAgICAgICAgICAgIHR5cGU6ICdkYW5nZXInLA0KICAgICAgICAgICAgY29uZmlybVRleHQ6ICdEZWxldGUnLA0KICAgICAgICAgICAgY2FuY2VsVGV4dDogJ0NhbmNlbCcsDQogICAgICAgICAgICBpY29uOiAnZmFzIGZhLXRhZycNCiAgICAgICAgfQ0KICAgICk7DQogICAgDQogICAgaWYgKGNvbmZpcm1lZCkgew0KICAgICAgICBjb25zdCB0YWdFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFnSWQpOw0KICAgICAgICBpZiAodGFnRWxlbWVudCkgew0KICAgICAgICAgICAgdGFnRWxlbWVudC5yZW1vdmUoKTsNCiAgICAgICAgfQ0KICAgICAgICBmbG93RWRpdG9yLnRhZ3MuZGVsZXRlKHRhZ0lkKTsNCiAgICAgICAgdXBkYXRlVGFnUGFuZWwoKTsNCiAgICB9DQp9DQoNCi8vIEV4YW1wbGU6IHRhZy1tYW5hZ2VyLmpzDQp3aW5kb3cudGFnTWFuYWdlciA9IHsNCiAgICBhZGRUYWcsDQogICAgY3JlYXRlVGFnRWxlbWVudCwNCiAgICBzdGFydERyYWdnaW5nVGFnLA0KICAgIGp1bXBUb1RhZywNCiAgICB1cGRhdGVUYWdQYW5lbCwNCiAgICBkZWxldGVUYWcNCn07DQoNCi8vIFNhdmUgZmxvdyB0byB2aXJ0dWFsIGZpbGUgc3lzdGVtDQphc3luYyBmdW5jdGlvbiBzYXZlRmxvdygpIHsNCiAgICBjb25zdCBmbG93RGF0YSA9IHsNCiAgICAgICAgbm9kZXM6IEFycmF5LmZyb20oZmxvd0VkaXRvci5ub2Rlcy52YWx1ZXMoKSkubWFwKG5vZGUgPT4gKHsNCiAgICAgICAgICAgIGlkOiBub2RlLmlkLA0KICAgICAgICAgICAgdHlwZTogbm9kZS50eXBlLA0KICAgICAgICAgICAgeDogbm9kZS54LA0KICAgICAgICAgICAgeTogbm9kZS55LA0KICAgICAgICAgICAgY29uZmlnOiBub2RlLmNvbmZpZw0KICAgICAgICB9KSksDQogICAgICAgIGNvbm5lY3Rpb25zOiBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLm1hcChjb25uID0+ICh7DQogICAgICAgICAgICBpZDogY29ubi5pZCwNCiAgICAgICAgICAgIGZyb206IGNvbm4uZnJvbSwNCiAgICAgICAgICAgIHRvOiBjb25uLnRvDQogICAgICAgIH0pKSwNCiAgICAgICAgdGFnczogQXJyYXkuZnJvbShmbG93RWRpdG9yLnRhZ3MudmFsdWVzKCkpLA0KICAgICAgICBtZXRhZGF0YTogew0KICAgICAgICAgICAgc2F2ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLA0KICAgICAgICAgICAgbm9kZUNvdW50OiBmbG93RWRpdG9yLm5vZGVzLnNpemUsDQogICAgICAgICAgICBjb25uZWN0aW9uQ291bnQ6IGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuc2l6ZSwNCiAgICAgICAgICAgIHRhZ0NvdW50OiBmbG93RWRpdG9yLnRhZ3Muc2l6ZQ0KICAgICAgICB9DQogICAgfTsNCg0KICAgIHRyeSB7DQogICAgICAgIGxldCBmaWxlUGF0aCA9IGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoOw0KICAgICAgICANCiAgICAgICAgLy8gSWYgbm8gY3VycmVudCBmaWxlIHBhdGgsIHNob3cgZmlsZSBleHBsb3Jlcg0KICAgICAgICBpZiAoIWZpbGVQYXRoKSB7DQogICAgICAgICAgICBmaWxlUGF0aCA9IGF3YWl0IHN5cG5leEFQSS5zaG93RmlsZUV4cGxvcmVyKHsNCiAgICAgICAgICAgICAgICBtb2RlOiAnc2F2ZScsDQogICAgICAgICAgICAgICAgdGl0bGU6ICdTYXZlIEZsb3cgRmlsZScsDQogICAgICAgICAgICAgICAgaW5pdGlhbFBhdGg6ICcvJywNCiAgICAgICAgICAgICAgICBmaWxlTmFtZTogJ2Zsb3dfd29ya2Zsb3cuanNvbicsDQogICAgICAgICAgICAgICAgZmlsZUV4dGVuc2lvbjogJy5qc29uJywNCiAgICAgICAgICAgICAgICBvblNlbGVjdDogKHNlbGVjdGVkUGF0aCkgPT4gew0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgb25DYW5jZWw6ICgpID0+IHsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgaWYgKCFmaWxlUGF0aCkgew0KICAgICAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBjYW5jZWxsZWQNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFNhdmUgdG8gdmlydHVhbCBmaWxlIHN5c3RlbQ0KICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlSlNPTikgew0KICAgICAgICAgICAgYXdhaXQgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGVKU09OKGZpbGVQYXRoLCBmbG93RGF0YSk7DQogICAgICAgICAgICBmbG93RWRpdG9yLmN1cnJlbnRGaWxlUGF0aCA9IGZpbGVQYXRoOw0KICAgICAgICAgICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmxvdyBzYXZlZCB0bzogJHtmaWxlUGF0aH1gLCAnc3VjY2VzcycpOw0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNhdmUgZmxvdzonLCBlcnJvcik7DQogICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24pIHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdGYWlsZWQgdG8gc2F2ZSBmbG93OiAnICsgZXJyb3IubWVzc2FnZSwgJ2Vycm9yJyk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIFNhdmUgZmxvdyBhcyAoYWx3YXlzIHNob3cgZmlsZSBleHBsb3JlcikNCmFzeW5jIGZ1bmN0aW9uIHNhdmVGbG93QXMoKSB7DQogICAgY29uc3QgZmxvd0RhdGEgPSB7DQogICAgICAgIG5vZGVzOiBBcnJheS5mcm9tKGZsb3dFZGl0b3Iubm9kZXMudmFsdWVzKCkpLm1hcChub2RlID0+ICh7DQogICAgICAgICAgICBpZDogbm9kZS5pZCwNCiAgICAgICAgICAgIHR5cGU6IG5vZGUudHlwZSwNCiAgICAgICAgICAgIHg6IG5vZGUueCwNCiAgICAgICAgICAgIHk6IG5vZGUueSwNCiAgICAgICAgICAgIGNvbmZpZzogbm9kZS5jb25maWcNCiAgICAgICAgfSkpLA0KICAgICAgICBjb25uZWN0aW9uczogQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5tYXAoY29ubiA9PiAoew0KICAgICAgICAgICAgaWQ6IGNvbm4uaWQsDQogICAgICAgICAgICBmcm9tOiBjb25uLmZyb20sDQogICAgICAgICAgICB0bzogY29ubi50bw0KICAgICAgICB9KSksDQogICAgICAgIHRhZ3M6IEFycmF5LmZyb20oZmxvd0VkaXRvci50YWdzLnZhbHVlcygpKSwNCiAgICAgICAgbWV0YWRhdGE6IHsNCiAgICAgICAgICAgIHNhdmVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwNCiAgICAgICAgICAgIG5vZGVDb3VudDogZmxvd0VkaXRvci5ub2Rlcy5zaXplLA0KICAgICAgICAgICAgY29ubmVjdGlvbkNvdW50OiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnNpemUsDQogICAgICAgICAgICB0YWdDb3VudDogZmxvd0VkaXRvci50YWdzLnNpemUNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICB0cnkgew0KICAgICAgICAvLyBTaG93IGZpbGUgZXhwbG9yZXIgZm9yIHNhdmluZw0KICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGF3YWl0IHN5cG5leEFQSS5zaG93RmlsZUV4cGxvcmVyKHsNCiAgICAgICAgICAgIG1vZGU6ICdzYXZlJywNCiAgICAgICAgICAgIHRpdGxlOiAnU2F2ZSBGbG93IEZpbGUgQXMnLA0KICAgICAgICAgICAgaW5pdGlhbFBhdGg6ICcvJywNCiAgICAgICAgICAgIGZpbGVOYW1lOiAnZmxvd193b3JrZmxvdy5qc29uJywNCiAgICAgICAgICAgIGZpbGVFeHRlbnNpb246ICcuanNvbicsDQogICAgICAgICAgICBvblNlbGVjdDogKHNlbGVjdGVkUGF0aCkgPT4gew0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBjYW5jZWxsZWQNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFNhdmUgdG8gdmlydHVhbCBmaWxlIHN5c3RlbQ0KICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlSlNPTikgew0KICAgICAgICAgICAgYXdhaXQgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGVKU09OKGZpbGVQYXRoLCBmbG93RGF0YSk7DQogICAgICAgICAgICBmbG93RWRpdG9yLmN1cnJlbnRGaWxlUGF0aCA9IGZpbGVQYXRoOw0KICAgICAgICAgICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmxvdyBzYXZlZCBhczogJHtmaWxlUGF0aH1gLCAnc3VjY2VzcycpOw0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNhdmUgZmxvdyBhczonLCBlcnJvcik7DQogICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24pIHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdGYWlsZWQgdG8gc2F2ZSBmbG93IGFzOiAnICsgZXJyb3IubWVzc2FnZSwgJ2Vycm9yJyk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIExvYWQgZmxvdyBmcm9tIHZpcnR1YWwgZmlsZSBzeXN0ZW0NCmFzeW5jIGZ1bmN0aW9uIGxvYWRGbG93KCkgew0KICAgIHRyeSB7DQogICAgICAgIC8vIFNob3cgZmlsZSBleHBsb3JlciBmb3IgbG9hZGluZw0KICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGF3YWl0IHN5cG5leEFQSS5zaG93RmlsZUV4cGxvcmVyKHsNCiAgICAgICAgICAgIG1vZGU6ICdvcGVuJywNCiAgICAgICAgICAgIHRpdGxlOiAnTG9hZCBGbG93IEZpbGUnLA0KICAgICAgICAgICAgaW5pdGlhbFBhdGg6ICcvJywNCiAgICAgICAgICAgIG9uU2VsZWN0OiAoc2VsZWN0ZWRQYXRoKSA9PiB7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgb25DYW5jZWw6ICgpID0+IHsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgaWYgKCFmaWxlUGF0aCkgew0KICAgICAgICAgICAgcmV0dXJuOyAvLyBVc2VyIGNhbmNlbGxlZA0KICAgICAgICB9DQoNCiAgICAgICAgbGV0IGZsb3dEYXRhID0gbnVsbDsNCiAgICAgICAgDQogICAgICAgIC8vIFRyeSB2aXJ0dWFsIGZpbGUgc3lzdGVtIGZpcnN0DQogICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZUpTT04pIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgZmxvd0RhdGEgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlSlNPTihmaWxlUGF0aCk7DQogICAgICAgICAgICB9IGNhdGNoICh2ZnNFcnJvcikgew0KICAgICAgICAgICAgICAgIHRocm93IHZmc0Vycm9yOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBpZiAoZmxvd0RhdGEpIHsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ2xlYXIgY3VycmVudCBjYW52YXMgKHdpdGhvdXQgY29uZmlybWF0aW9uIHNpbmNlIHdlJ3JlIGxvYWRpbmcgYSBmaWxlKQ0KICAgICAgICAgICAgY2xlYXJDYW52YXNTaWxlbnQoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUmVzZXQgcGFuIG9mZnNldCB0byBjZW50ZXIgb2YgbGFyZ2UgY2FudmFzIGZvciBuZXcgd29ya2Zsb3cNCiAgICAgICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0ID0geyB4OiAtNTAwMCwgeTogLTUwMDAgfTsNCiAgICAgICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBSZXNldCBub2RlIGNvdW50ZXIgdG8gYXZvaWQgSUQgY29uZmxpY3RzDQogICAgICAgICAgICBmbG93RWRpdG9yLm5vZGVDb3VudGVyID0gMDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTG9hZCBub2Rlcw0KICAgICAgICAgICAgaWYgKGZsb3dEYXRhLm5vZGVzKSB7DQogICAgICAgICAgICAgICAgZmxvd0RhdGEubm9kZXMuZm9yRWFjaChub2RlRGF0YSA9PiB7DQogICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBub2RlIHdpdGggcHJvcGVyIElEDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IG5vZGVEYXRhLmlkOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IG5vZGVJZCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IG5vZGVEYXRhLnR5cGUsDQogICAgICAgICAgICAgICAgICAgICAgICB4OiBub2RlRGF0YS54LA0KICAgICAgICAgICAgICAgICAgICAgICAgeTogbm9kZURhdGEueSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZzogbm9kZURhdGEuY29uZmlnLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge30NCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBub2RlIGNvdW50ZXINCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZU51bSA9IHBhcnNlSW50KG5vZGVJZC5yZXBsYWNlKCdub2RlXycsICcnKSk7DQogICAgICAgICAgICAgICAgICAgIGlmIChub2RlTnVtID4gZmxvd0VkaXRvci5ub2RlQ291bnRlcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci5ub2RlQ291bnRlciA9IG5vZGVOdW07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3Iubm9kZXMuc2V0KG5vZGVJZCwgbm9kZSk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbm9kZSBlbGVtZW50IHVzaW5nIHRoZSByZW5kZXJlciBhbmQgYWRkIHRvIGNhbnZhcw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IG5vZGVSZW5kZXJlci5jcmVhdGVOb2RlRWxlbWVudChub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuYXBwZW5kQ2hpbGQobm9kZUVsZW1lbnQpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBMb2FkIGNvbm5lY3Rpb25zIGFmdGVyIG5vZGVzIGFyZSBmdWxseSBjcmVhdGVkIGFuZCBwb3NpdGlvbmVkDQogICAgICAgICAgICBpZiAoZmxvd0RhdGEuY29ubmVjdGlvbnMpIHsNCiAgICAgICAgICAgICAgICBmbG93RGF0YS5jb25uZWN0aW9ucy5mb3JFYWNoKGNvbm5EYXRhID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY3JlYXRlQ29ubmVjdGlvbihjb25uRGF0YS5mcm9tLm5vZGVJZCwgY29ubkRhdGEuZnJvbS5wb3J0TmFtZSwgY29ubkRhdGEudG8ubm9kZUlkLCBjb25uRGF0YS50by5wb3J0TmFtZSk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gSW1tZWRpYXRlbHkgcmVkcmF3IGNvbm5lY3Rpb25zIG5vdyB0aGF0IGFsbCBTVkcgZWxlbWVudHMgZXhpc3QNCiAgICAgICAgICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBMb2FkIHRhZ3MNCiAgICAgICAgICAgIGlmIChmbG93RGF0YS50YWdzKSB7DQogICAgICAgICAgICAgICAgZmxvd0RhdGEudGFncy5mb3JFYWNoKHRhZ0RhdGEgPT4gew0KICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWcgPSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZDogdGFnRGF0YS5pZCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRhZ0RhdGEubmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0YWdEYXRhLmRlc2NyaXB0aW9uIHx8ICcnLA0KICAgICAgICAgICAgICAgICAgICAgICAgeDogdGFnRGF0YS54LA0KICAgICAgICAgICAgICAgICAgICAgICAgeTogdGFnRGF0YS55LA0KICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IHRhZ0RhdGEuY29sb3IgfHwgJyM0Q0FGNTAnDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGFnIGNvdW50ZXINCiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFnTnVtID0gcGFyc2VJbnQodGFnRGF0YS5pZC5yZXBsYWNlKCd0YWdfJywgJycpKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRhZ051bSA+IGZsb3dFZGl0b3IudGFnQ291bnRlcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci50YWdDb3VudGVyID0gdGFnTnVtOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnRhZ3Muc2V0KHRhZ0RhdGEuaWQsIHRhZyk7DQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy50YWdNYW5hZ2VyLmNyZWF0ZVRhZ0VsZW1lbnQodGFnKTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGNlbnRlciBvZiBsb2FkZWQgbm9kZXMgYW5kIGFkanVzdCBwYW4gdG8gY2VudGVyIHRoZW0NCiAgICAgICAgICAgIGlmIChmbG93RGF0YS5ub2RlcyAmJiBmbG93RGF0YS5ub2Rlcy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgY29uc3QgbWluWCA9IE1hdGgubWluKC4uLmZsb3dEYXRhLm5vZGVzLm1hcChuID0+IG4ueCkpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG1heFggPSBNYXRoLm1heCguLi5mbG93RGF0YS5ub2Rlcy5tYXAobiA9PiBuLngpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBtaW5ZID0gTWF0aC5taW4oLi4uZmxvd0RhdGEubm9kZXMubWFwKG4gPT4gbi55KSk7DQogICAgICAgICAgICAgICAgY29uc3QgbWF4WSA9IE1hdGgubWF4KC4uLmZsb3dEYXRhLm5vZGVzLm1hcChuID0+IG4ueSkpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbnN0IGNlbnRlclggPSAobWluWCArIG1heFgpIC8gMjsNCiAgICAgICAgICAgICAgICBjb25zdCBjZW50ZXJZID0gKG1pblkgKyBtYXhZKSAvIDI7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gR2V0IGNhbnZhcyBjb250YWluZXIgZGltZW5zaW9ucw0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgICAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgcGFuIG9mZnNldCB0byBjZW50ZXIgdGhlIG5vZGVzIGluIHRoZSB2aWV3cG9ydA0KICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnggPSAtY2VudGVyWCArIGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOw0KICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSAtY2VudGVyWSArIGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB3aW5kb3cuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gRmluYWwgY29ubmVjdGlvbiByZWRyYXcgYWZ0ZXIgYWxsIHBvc2l0aW9uaW5nIGlzIGNvbXBsZXRlDQogICAgICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBVcGRhdGUgdGFnIHBhbmVsDQogICAgICAgICAgICB3aW5kb3cudGFnTWFuYWdlci51cGRhdGVUYWdQYW5lbCgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBVcGRhdGUgY3VycmVudCBmaWxlIHBhdGgNCiAgICAgICAgICAgIGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgICAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbikgew0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGbG93IGxvYWRlZCBmcm9tOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKSB7DQogICAgICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ05vIHZhbGlkIGZsb3cgZGF0YSBmb3VuZCBpbiB0aGUgc2VsZWN0ZWQgZmlsZS4nLCAnd2FybmluZycpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgZmxvdzonLCBlcnJvcik7DQogICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24pIHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdGYWlsZWQgdG8gbG9hZCBmbG93OiAnICsgZXJyb3IubWVzc2FnZSwgJ2Vycm9yJyk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIFVwZGF0ZSBmaWxlbmFtZSBkaXNwbGF5DQpmdW5jdGlvbiB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKSB7DQogICAgY29uc3QgZmlsZW5hbWVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1cnJlbnQtZmlsZW5hbWUnKTsNCiAgICBpZiAoZmlsZW5hbWVFbGVtZW50KSB7DQogICAgICAgIGNvbnN0IGZpbGVuYW1lID0gZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGggPyBmbG93RWRpdG9yLmN1cnJlbnRGaWxlUGF0aC5zcGxpdCgnLycpLnBvcCgpIDogJ3VudGl0bGVkLmZsb3cnOw0KICAgICAgICBmaWxlbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBmaWxlbmFtZTsNCiAgICB9DQp9DQoNCg0KLy8gRXhwb3J0IHRvIGdsb2JhbCBzY29wZQ0Kd2luZG93LmZpbGVNYW5hZ2VyID0gew0KICAgIHNhdmVGbG93LA0KICAgIHNhdmVGbG93QXMsDQogICAgbG9hZEZsb3csDQogICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5DQp9Ow0KDQoNCi8vIFBvcHVsYXRlIHRvb2xib3ggd2l0aCBsb2FkZWQgbm9kZXMNCmZ1bmN0aW9uIHBvcHVsYXRlVG9vbGJveCgpIHsNCiAgICBjb25zdCB0b29sYm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZsb3ctdG9vbGJveCcpOw0KICAgIGlmICghdG9vbGJveCkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdUb29sYm94IG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIENsZWFyIGV4aXN0aW5nIHRvb2xib3ggY29udGVudA0KICAgIGNvbnN0IHRvb2xib3hDb250ZW50ID0gdG9vbGJveC5xdWVyeVNlbGVjdG9yKCcudG9vbGJveC1jb250ZW50Jyk7DQogICAgaWYgKHRvb2xib3hDb250ZW50KSB7DQogICAgICAgIHRvb2xib3hDb250ZW50LmlubmVySFRNTCA9ICcnOw0KICAgIH0NCiAgICANCiAgICAvLyBHcm91cCBub2RlcyBieSBjYXRlZ29yeQ0KICAgIGNvbnN0IGNhdGVnb3JpZXMgPSB7fTsNCiAgICBjb25zdCBhbGxOb2RlcyA9IG5vZGVSZWdpc3RyeS5nZXRBbGxOb2RlVHlwZXMoKTsNCiAgICANCiAgICANCiAgICBhbGxOb2Rlcy5mb3JFYWNoKG5vZGVEZWYgPT4gew0KICAgICAgICBjb25zdCBjYXRlZ29yeSA9IG5vZGVEZWYuY2F0ZWdvcnkgfHwgJ290aGVyJzsNCiAgICAgICAgaWYgKCFjYXRlZ29yaWVzW2NhdGVnb3J5XSkgew0KICAgICAgICAgICAgY2F0ZWdvcmllc1tjYXRlZ29yeV0gPSBbXTsNCiAgICAgICAgfQ0KICAgICAgICBjYXRlZ29yaWVzW2NhdGVnb3J5XS5wdXNoKG5vZGVEZWYpOw0KICAgIH0pOw0KICAgIA0KICAgIA0KICAgIC8vIENyZWF0ZSB0b29sYm94IHNlY3Rpb25zIGZvciBlYWNoIGNhdGVnb3J5DQogICAgT2JqZWN0LmVudHJpZXMoY2F0ZWdvcmllcykuZm9yRWFjaCgoW2NhdGVnb3J5LCBub2Rlc10pID0+IHsNCiAgICAgICAgY29uc3QgY2F0ZWdvcnlTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgICAgIGNhdGVnb3J5U2VjdGlvbi5jbGFzc05hbWUgPSAnbm9kZS1jYXRlZ29yeSc7DQogICAgICAgIGNhdGVnb3J5U2VjdGlvbi5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICA8aDU+JHtjYXRlZ29yeS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGNhdGVnb3J5LnNsaWNlKDEpfTwvaDU+DQogICAgICAgICAgICAke25vZGVzLm1hcChub2RlRGVmID0+IGANCiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ0b29sYm94LW5vZGUtYnRuIiBkYXRhLW5vZGUtdHlwZT0iJHtub2RlRGVmLmlkfSIgdGl0bGU9IiR7bm9kZURlZi5kZXNjcmlwdGlvbn0iPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iJHtub2RlRGVmLmljb259Ij48L2k+DQogICAgICAgICAgICAgICAgICAgIDxzcGFuPiR7bm9kZURlZi5uYW1lfTwvc3Bhbj4NCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgIGApLmpvaW4oJycpfQ0KICAgICAgICBgOw0KICAgICAgICANCiAgICAgICAgaWYgKHRvb2xib3hDb250ZW50KSB7DQogICAgICAgICAgICB0b29sYm94Q29udGVudC5hcHBlbmRDaGlsZChjYXRlZ29yeVNlY3Rpb24pOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gUmUtYXR0YWNoIGV2ZW50IGxpc3RlbmVycw0KICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b29sYm94LW5vZGUtYnRuJykuZm9yRWFjaChidG4gPT4gew0KICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgY29uc3Qgbm9kZVR5cGUgPSBidG4uZ2V0QXR0cmlidXRlKCdkYXRhLW5vZGUtdHlwZScpOw0KICAgICAgICAgICAgaWYgKG5vZGVUeXBlKSB7DQogICAgICAgICAgICAgICAgYWRkTm9kZShub2RlVHlwZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0pOw0KICAgIA0KfQ0KDQovLyBTZXQgdXAgZXZlbnQgaGFuZGxlcnMNCmZ1bmN0aW9uIHNldHVwRXZlbnRIYW5kbGVycygpIHsNCiAgICAvLyBOb3RlOiBUb29sYm94IG5vZGUgYnV0dG9uIGV2ZW50IGxpc3RlbmVycyBhcmUgc2V0IHVwIGluIHBvcHVsYXRlVG9vbGJveCgpDQogICAgLy8gdG8gYXZvaWQgZHVwbGljYXRlcyB3aGVuIHRoZSB0b29sYm94IGlzIHJlcG9wdWxhdGVkDQogICAgDQogICAgLy8gV29ya2Zsb3cgYWN0aW9ucw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdydW4td29ya2Zsb3cnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBydW5Xb3JrZmxvdyk7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0b3Atd29ya2Zsb3cnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdG9wV29ya2Zsb3cpOw0KICAgIC8vIE5vdGU6IGRlbGV0ZS1zZWxlY3RlZCwgY2xlYXItY2FudmFzLCByZXNldC12aWV3LCBhbmQgYWRkLXRhZyBhcmUgbm93IGhhbmRsZWQgYnkgaGFtYnVyZ2VyIG1lbnUNCiAgICANCiAgICAvLyBab29tIGNvbnRyb2xzDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvb20taW4nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB3aW5kb3cuY2FudmFzTWFuYWdlci56b29tSW4pOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b29tLW91dCcpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnpvb21PdXQpOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b29tLWZpdCcpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnpvb21Ub0ZpdCk7DQogICAgDQogICAgLy8gTm90ZTogRmlsZSBvcGVyYXRpb25zIChzYXZlLCBzYXZlLWFzLCBsb2FkKSBhcmUgbm93IGhhbmRsZWQgYnkgaGFtYnVyZ2VyIG1lbnUNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2xlYXItb3V0cHV0Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xlYXJPdXRwdXQpOw0KICAgIA0KICAgIC8vIEhhbWJ1cmdlciBtZW51DQogICAgc2V0dXBIYW1idXJnZXJNZW51KCk7DQogICAgDQogICAgLy8gQ29uZmlnIHBhbmVsIHRvZ2dsZQ0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtY29uZmlnJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlQ29uZmlnUGFuZWwpOw0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgY29uZmlnIHBhbmVsIHN0YXRlICh3aXRob3V0IG92ZXJyaWRpbmcgaWNvbnMpDQogICAgY29uc3QgY29uZmlnUGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy1jb25maWctcGFuZWwnKTsNCiAgICBpZiAoY29uZmlnUGFuZWwpIHsNCiAgICAgICAgLy8gRGVmYXVsdCBleHBhbmRlZCAobm90IGNvbGxhcHNlZCkNCiAgICAgICAgY29uZmlnUGFuZWwuY2xhc3NMaXN0LnJlbW92ZSgnY29sbGFwc2VkJyk7DQogICAgfQ0KICAgIA0KICAgIC8vIFRvb2xib3ggdG9nZ2xlDQogICAgY29uc3QgdG9vbGJveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmbG93LXRvb2xib3gnKTsNCiAgICBjb25zdCB0b29sYm94Q29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b29sYm94LWNvbnRlbnQnKTsNCiAgICBjb25zdCB0b2dnbGVUb29sYm94QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS10b29sYm94Jyk7DQogICAgaWYgKHRvb2xib3ggJiYgdG9vbGJveENvbnRlbnQgJiYgdG9nZ2xlVG9vbGJveEJ0bikgew0KICAgICAgICAvLyBEZWZhdWx0IGV4cGFuZGVkIChub3QgY29sbGFwc2VkKQ0KICAgICAgICB0b29sYm94LmNsYXNzTGlzdC5yZW1vdmUoJ2NvbGxhcHNlZCcpOw0KICAgICAgICB0b29sYm94Q29udGVudC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoNCiAgICAgICAgdG9nZ2xlVG9vbGJveEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgdG9nZ2xlVG9vbGJveCgpOw0KICAgICAgICB9KTsNCiAgICB9DQogICAgDQogICAgLy8gT3V0cHV0IHBhbmVsIHRvZ2dsZQ0KICAgIGNvbnN0IG91dHB1dFBhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zsb3ctb3V0cHV0LXBhbmVsJyk7DQogICAgY29uc3Qgb3V0cHV0Q29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdXRwdXQtY29udGVudCcpOw0KICAgIGNvbnN0IHRvZ2dsZU91dHB1dEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtb3V0cHV0Jyk7DQogICAgaWYgKG91dHB1dFBhbmVsICYmIG91dHB1dENvbnRlbnQgJiYgdG9nZ2xlT3V0cHV0QnRuKSB7DQogICAgICAgIC8vIERlZmF1bHQgY29sbGFwc2VkDQogICAgICAgIG91dHB1dFBhbmVsLmNsYXNzTGlzdC5hZGQoJ2NvbGxhcHNlZCcpOw0KICAgICAgICBvdXRwdXRDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIHRvZ2dsZU91dHB1dEJ0bi5xdWVyeVNlbGVjdG9yKCdpJykuY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLWRvd24nOw0KDQogICAgICAgIHRvZ2dsZU91dHB1dEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgY29uc3QgaXNDb2xsYXBzZWQgPSBvdXRwdXRQYW5lbC5jbGFzc0xpc3QuY29udGFpbnMoJ2NvbGxhcHNlZCcpOw0KICAgICAgICAgICAgaWYgKGlzQ29sbGFwc2VkKSB7DQogICAgICAgICAgICAgICAgb3V0cHV0UGFuZWwuY2xhc3NMaXN0LnJlbW92ZSgnY29sbGFwc2VkJyk7DQogICAgICAgICAgICAgICAgb3V0cHV0Q29udGVudC5zdHlsZS5kaXNwbGF5ID0gJyc7DQogICAgICAgICAgICAgICAgdG9nZ2xlT3V0cHV0QnRuLnF1ZXJ5U2VsZWN0b3IoJ2knKS5jbGFzc05hbWUgPSAnZmFzIGZhLWNoZXZyb24tdXAnOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBvdXRwdXRQYW5lbC5jbGFzc0xpc3QuYWRkKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgICAgICAgICBvdXRwdXRDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgdG9nZ2xlT3V0cHV0QnRuLnF1ZXJ5U2VsZWN0b3IoJ2knKS5jbGFzc05hbWUgPSAnZmFzIGZhLWNoZXZyb24tZG93bic7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0NCiAgICANCiAgICAvLyBDYW52YXMgZXZlbnRzDQogICAgZmxvd0VkaXRvci5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB3aW5kb3cuY2FudmFzTWFuYWdlci5oYW5kbGVDYW52YXNDbGljayk7DQogICAgZmxvd0VkaXRvci5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgd2luZG93LmNhbnZhc01hbmFnZXIuc3RhcnRDYW52YXNQYW4pOw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgd2luZG93LmNhbnZhc01hbmFnZXIuaGFuZGxlTW91c2VXaGVlbCwgeyBwYXNzaXZlOiBmYWxzZSB9KTsNCiAgICANCiAgICAvLyBEb2N1bWVudC1sZXZlbCBtb3VzZSBldmVudHMgZm9yIHNtb290aCBkcmFnZ2luZyBhbmQgcGFubmluZw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHdpbmRvdy5jYW52YXNNYW5hZ2VyLmhhbmRsZURvY3VtZW50TW91c2VEb3duKTsNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB3aW5kb3cuY2FudmFzTWFuYWdlci5oYW5kbGVEb2N1bWVudE1vdXNlTW92ZSk7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHdpbmRvdy5jYW52YXNNYW5hZ2VyLmhhbmRsZURvY3VtZW50TW91c2VVcCk7DQogICAgDQogICAgLy8gS2V5Ym9hcmQgc2hvcnRjdXRzDQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUtleURvd24pOw0KfQ0KDQovLyBUb2dnbGUgY29uZmlnIHBhbmVsDQpmdW5jdGlvbiB0b2dnbGVDb25maWdQYW5lbCgpIHsNCiAgICBjb25zdCBjb25maWdQYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmbG93LWNvbmZpZy1wYW5lbCcpOw0KICAgIGNvbnN0IHRvZ2dsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtY29uZmlnJyk7DQogICAgY29uc3QgaWNvbiA9IHRvZ2dsZUJ0bi5xdWVyeVNlbGVjdG9yKCdpJyk7DQogICAgDQogICAgaWYgKGNvbmZpZ1BhbmVsLmNsYXNzTGlzdC5jb250YWlucygnY29sbGFwc2VkJykpIHsNCiAgICAgICAgLy8gRXhwYW5kDQogICAgICAgIGNvbmZpZ1BhbmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2NvbGxhcHNlZCcpOw0KICAgICAgICBpY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1yaWdodCc7DQogICAgICAgIHRvZ2dsZUJ0bi50aXRsZSA9ICdDb2xsYXBzZSBDb25maWd1cmF0aW9uIFBhbmVsJzsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBDb2xsYXBzZQ0KICAgICAgICBjb25maWdQYW5lbC5jbGFzc0xpc3QuYWRkKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgaWNvbi5jbGFzc05hbWUgPSAnZmFzIGZhLWNoZXZyb24tbGVmdCc7DQogICAgICAgIHRvZ2dsZUJ0bi50aXRsZSA9ICdFeHBhbmQgQ29uZmlndXJhdGlvbiBQYW5lbCc7DQogICAgfQ0KfQ0KDQovLyBUb2dnbGUgdG9vbGJveA0KZnVuY3Rpb24gdG9nZ2xlVG9vbGJveCgpIHsNCiAgICBjb25zdCB0b29sYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zsb3ctdG9vbGJveCcpOw0KICAgIGNvbnN0IHRvb2xib3hDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rvb2xib3gtY29udGVudCcpOw0KICAgIGNvbnN0IHRvZ2dsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtdG9vbGJveCcpOw0KICAgIGNvbnN0IGljb24gPSB0b2dnbGVCdG4ucXVlcnlTZWxlY3RvcignaScpOw0KICAgIA0KICAgIGlmICh0b29sYm94LmNsYXNzTGlzdC5jb250YWlucygnY29sbGFwc2VkJykpIHsNCiAgICAgICAgLy8gRXhwYW5kDQogICAgICAgIHRvb2xib3guY2xhc3NMaXN0LnJlbW92ZSgnY29sbGFwc2VkJyk7DQogICAgICAgIHRvb2xib3hDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnJzsNCiAgICAgICAgaWNvbi5jbGFzc05hbWUgPSAnZmFzIGZhLWNoZXZyb24tbGVmdCc7DQogICAgICAgIHRvZ2dsZUJ0bi50aXRsZSA9ICdDb2xsYXBzZSBUb29sYm94JzsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBDb2xsYXBzZQ0KICAgICAgICB0b29sYm94LmNsYXNzTGlzdC5hZGQoJ2NvbGxhcHNlZCcpOw0KICAgICAgICB0b29sYm94Q29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICBpY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1yaWdodCc7DQogICAgICAgIHRvZ2dsZUJ0bi50aXRsZSA9ICdFeHBhbmQgVG9vbGJveCc7DQogICAgfQ0KfQ0KDQovLyBTZXR1cCBoYW1idXJnZXIgbWVudSBmdW5jdGlvbmFsaXR5DQpmdW5jdGlvbiBzZXR1cEhhbWJ1cmdlck1lbnUoKSB7DQogICAgY29uc3QgaGFtYnVyZ2VyQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hhbWJ1cmdlci1tZW51Jyk7DQogICAgY29uc3QgZHJvcGRvd25NZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bkb3duLW1lbnUnKTsNCiAgICANCiAgICBpZiAoIWhhbWJ1cmdlckJ0biB8fCAhZHJvcGRvd25NZW51KSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0hhbWJ1cmdlciBtZW51IGVsZW1lbnRzIG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIFRvZ2dsZSBtZW51IG9uIGhhbWJ1cmdlciBjbGljaw0KICAgIGhhbWJ1cmdlckJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgIA0KICAgICAgICAvLyBQb3NpdGlvbiB0aGUgZHJvcGRvd24gcmVsYXRpdmUgdG8gdGhlIGhhbWJ1cmdlciBidXR0b24NCiAgICAgICAgaWYgKCFkcm9wZG93bk1lbnUuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93JykpIHsNCiAgICAgICAgICAgIC8vIFVzZSBzY2FsZWQgbW91c2UgY29vcmRpbmF0ZXMgZm9yIG1vcmUgaW50dWl0aXZlIHBvc2l0aW9uaW5nDQogICAgICAgICAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8gDQogICAgICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDoNCiAgICAgICAgICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGhhbWJ1cmdlckJ0bi5jbG9zZXN0KCcuZmxvdy1lZGl0b3IsIC5hcHAtY29udGFpbmVyJyk7DQogICAgICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QgJiYgY29udGFpbmVyKSA/DQogICAgICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDoNCiAgICAgICAgICAgICAgICAoY29udGFpbmVyID8gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpIDogeyB0b3A6IDAsIGxlZnQ6IDAgfSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFBvc2l0aW9uIHJlbGF0aXZlIHRvIG1vdXNlIGNsaWNrLCBvZmZzZXQgc2xpZ2h0bHkgdG8gYXZvaWQgY292ZXJpbmcgdGhlIGJ1dHRvbg0KICAgICAgICAgICAgY29uc3QgcmVsYXRpdmVUb3AgPSBtb3VzZUNvb3Jkcy55IC0gY29udGFpbmVyUmVjdC50b3AgKyA1Ow0KICAgICAgICAgICAgY29uc3QgcmVsYXRpdmVMZWZ0ID0gbW91c2VDb29yZHMueCAtIGNvbnRhaW5lclJlY3QubGVmdCAtIDE4MCAtIDEwICsgMjA7IC8vIE1lbnUgd2lkdGggKyBzbWFsbCBnYXAsIHRoZW4gMjBweCBtb3JlIHRvIHRoZSByaWdodA0KICAgICAgICAgICAgDQogICAgICAgICAgICBkcm9wZG93bk1lbnUuc3R5bGUudG9wID0gcmVsYXRpdmVUb3AgKyAncHgnOw0KICAgICAgICAgICAgZHJvcGRvd25NZW51LnN0eWxlLmxlZnQgPSByZWxhdGl2ZUxlZnQgKyAncHgnOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBkcm9wZG93bk1lbnUuY2xhc3NMaXN0LnRvZ2dsZSgnc2hvdycpOw0KICAgIH0pOw0KICAgIA0KICAgIC8vIENsb3NlIG1lbnUgd2hlbiBjbGlja2luZyBvdXRzaWRlDQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICBpZiAoIWRyb3Bkb3duTWVudS5jb250YWlucyhlLnRhcmdldCkgJiYgIWhhbWJ1cmdlckJ0bi5jb250YWlucyhlLnRhcmdldCkpIHsNCiAgICAgICAgICAgIGRyb3Bkb3duTWVudS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICAvLyBIYW5kbGUgbWVudSBpdGVtIGNsaWNrcyAtIE9OTFkgdGhlIHNwZWNpZmljIGFjdGlvbnMgcmVxdWVzdGVkDQogICAgZHJvcGRvd25NZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgY29uc3QgbWVudUl0ZW0gPSBlLnRhcmdldC5jbG9zZXN0KCcubWVudS1pdGVtJyk7DQogICAgICAgIGlmICghbWVudUl0ZW0pIHJldHVybjsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IGFjdGlvbiA9IG1lbnVJdGVtLmRhdGFzZXQuYWN0aW9uOw0KICAgICAgICBpZiAoIWFjdGlvbikgcmV0dXJuOw0KICAgICAgICANCiAgICAgICAgLy8gQ2xvc2UgdGhlIG1lbnUNCiAgICAgICAgZHJvcGRvd25NZW51LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsNCiAgICAgICAgDQogICAgICAgIC8vIEV4ZWN1dGUgT05MWSB0aGUgcmVxdWVzdGVkIGFjdGlvbnM6IHNhdmUsIHNhdmUtYXMsIGxvYWQsIGRlbGV0ZSwgY2xlYXItYWxsLCByZXNldC12aWV3LCBhZGQtdGFnDQogICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7DQogICAgICAgICAgICBjYXNlICdzYXZlLWZsb3cnOg0KICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuZmlsZU1hbmFnZXIgJiYgd2luZG93LmZpbGVNYW5hZ2VyLnNhdmVGbG93KSB7DQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvdygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3NhdmUtZmxvdy1hcyc6DQogICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5maWxlTWFuYWdlciAmJiB3aW5kb3cuZmlsZU1hbmFnZXIuc2F2ZUZsb3dBcykgew0KICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmlsZU1hbmFnZXIuc2F2ZUZsb3dBcygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2xvYWQtZmxvdyc6DQogICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5maWxlTWFuYWdlciAmJiB3aW5kb3cuZmlsZU1hbmFnZXIubG9hZEZsb3cpIHsNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LmZpbGVNYW5hZ2VyLmxvYWRGbG93KCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnYWRkLXRhZyc6DQogICAgICAgICAgICAgICAgaWYgKHdpbmRvdy50YWdNYW5hZ2VyICYmIHdpbmRvdy50YWdNYW5hZ2VyLmFkZFRhZykgew0KICAgICAgICAgICAgICAgICAgICB3aW5kb3cudGFnTWFuYWdlci5hZGRUYWcoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdyZXNldC12aWV3JzoNCiAgICAgICAgICAgICAgICBpZiAod2luZG93LmNhbnZhc01hbmFnZXIgJiYgd2luZG93LmNhbnZhc01hbmFnZXIucmVzZXRDYW52YXNQYW4pIHsNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LmNhbnZhc01hbmFnZXIucmVzZXRDYW52YXNQYW4oKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdkZWxldGUtc2VsZWN0ZWQnOg0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGVsZXRlU2VsZWN0ZWROb2RlID09PSAnZnVuY3Rpb24nKSB7DQogICAgICAgICAgICAgICAgICAgIGRlbGV0ZVNlbGVjdGVkTm9kZSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2NsZWFyLWNhbnZhcyc6DQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjbGVhckNhbnZhcyA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgICAgICAgICBjbGVhckNhbnZhcygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KICAgIH0pOw0KfQ0KDQovLyBFeGFtcGxlOiB1aS1tYW5hZ2VyLmpzDQp3aW5kb3cudWlNYW5hZ2VyID0gew0KICAgIHBvcHVsYXRlVG9vbGJveCwNCiAgICBzZXR1cEV2ZW50SGFuZGxlcnMsDQogICAgdG9nZ2xlQ29uZmlnUGFuZWwsDQogICAgdG9nZ2xlVG9vbGJveA0KfTsNCg0KLy8gbWFpbi5qcyAtIEVudHJ5IHBvaW50IGZvciBGbG93IEVkaXRvcg0KDQovLyBHbG9iYWwgdmFyaWFibGVzIChzY29wZWQgdG8gYXZvaWQgZ2xvYmFsIHBvbGx1dGlvbikNCmxldCBmbG93RWRpdG9yID0gew0KICAgIG5vZGVzOiBuZXcgTWFwKCksDQogICAgY29ubmVjdGlvbnM6IG5ldyBNYXAoKSwNCiAgICBzZWxlY3RlZE5vZGU6IG51bGwsDQogICAgZHJhZ2dpbmdOb2RlOiBudWxsLA0KICAgIGNvbm5lY3RpbmdGcm9tOiBudWxsLA0KICAgIGNhbnZhczogbnVsbCwNCiAgICBub2RlQ291bnRlcjogMCwNCiAgICBpc1J1bm5pbmc6IGZhbHNlLA0KICAgIGN1cnJlbnRGaWxlUGF0aDogbnVsbCwNCiAgICBpc0FjdGl2ZTogdHJ1ZSwNCiAgICAvLyBDYW52YXMgcGFubmluZyBzdGF0ZQ0KICAgIGlzUGFubmluZzogZmFsc2UsDQogICAgcGFuU3RhcnQ6IHsgeDogMCwgeTogMCB9LA0KICAgIHBhbk9mZnNldDogeyB4OiAtNTAwMCwgeTogLTUwMDAgfSwgLy8gQ2VudGVyIHRoZSBsYXJnZSBjYW52YXMgaW5pdGlhbGx5DQogICAgbGFzdFBhbk9mZnNldDogeyB4OiAtNTAwMCwgeTogLTUwMDAgfSwNCiAgICAvLyBab29tIHN0YXRlDQogICAgem9vbUxldmVsOiAxLjAsDQogICAgbWluWm9vbTogMC4xLA0KICAgIG1heFpvb206IDMuMCwNCiAgICB6b29tU3RlcDogMC4xLA0KICAgIC8vIFRhZyBzeXN0ZW0NCiAgICB0YWdzOiBuZXcgTWFwKCksDQogICAgdGFnQ291bnRlcjogMCwNCiAgICBkcmFnZ2luZ1RhZzogbnVsbCwNCiAgICB0YWdEcmFnT2Zmc2V0OiBudWxsLA0KICAgIHRhZ1VwZGF0ZVRpbWVvdXQ6IG51bGwNCn07DQoNCi8vIEluaXRpYWxpemUgd2hlbiBET00gaXMgcmVhZHkNCmFzeW5jIGZ1bmN0aW9uIGluaXRGbG93RWRpdG9yKCkgew0KICAgIA0KICAgIC8vIENoZWNrIGlmIFN5cG5leEFQSSBpcyBhdmFpbGFibGUgKGxvY2FsIHZhcmlhYmxlIGluIHNhbmRib3hlZCBlbnZpcm9ubWVudCkNCiAgICBpZiAodHlwZW9mIHN5cG5leEFQSSA9PT0gJ3VuZGVmaW5lZCcgfHwgIXN5cG5leEFQSSkgew0KICAgICAgICBjb25zb2xlLndhcm4oJ1N5cG5leEFQSSBub3QgYXZhaWxhYmxlIC0gcnVubmluZyBpbiBzdGFuZGFsb25lIG1vZGUnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgc2NhbGUgZGV0ZWN0aW9uIGZvciBhcHAgc2NhbGluZyBjb21wZW5zYXRpb24NCiAgICBpZiAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmluaXRTY2FsZURldGVjdGlvbikgew0KICAgICAgICBzeXBuZXhBUEkuaW5pdFNjYWxlRGV0ZWN0aW9uKChuZXdTY2FsZSwgb2xkU2NhbGUpID0+IHsNCiAgICAgICAgICAgIC8vIFJlZHJhdyBjb25uZWN0aW9ucyB3aGVuIHNjYWxlIGNoYW5nZXMNCiAgICAgICAgICAgIGlmICh0eXBlb2YgcmVkcmF3QWxsQ29ubmVjdGlvbnMgPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgDQogICAgLy8gVGVzdCBWRlMgQVBJDQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgdGVzdFJlc3VsdCA9IGF3YWl0IHN5cG5leEFQSS5saXN0VmlydHVhbEZpbGVzKCcvJyk7DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVkZTIEFQSSB0ZXN0IGZhaWxlZDonLCBlcnJvcik7DQogICAgfQ0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgY2FudmFzDQogICAgZmxvd0VkaXRvci5jYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy1jYW52YXMnKTsNCiAgICBpZiAoIWZsb3dFZGl0b3IuY2FudmFzKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Zsb3cgY2FudmFzIG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIENyZWF0ZSBTVkcgbWFya2VyIGRlZmluaXRpb25zIGZvciBjb25uZWN0aW9uIGFycm93cw0KICAgIGNvbnN0IGRlZnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2RlZnMnKTsNCiAgICBjb25zdCBtYXJrZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ21hcmtlcicpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2Fycm93aGVhZCcpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ21hcmtlcldpZHRoJywgJzEwJyk7DQogICAgbWFya2VyLnNldEF0dHJpYnV0ZSgnbWFya2VySGVpZ2h0JywgJzcnKTsNCiAgICBtYXJrZXIuc2V0QXR0cmlidXRlKCdyZWZYJywgJzknKTsNCiAgICBtYXJrZXIuc2V0QXR0cmlidXRlKCdyZWZZJywgJzMuNScpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ29yaWVudCcsICdhdXRvJyk7DQogICAgbWFya2VyLnNldEF0dHJpYnV0ZSgnbWFya2VyVW5pdHMnLCAnc3Ryb2tlV2lkdGgnKTsNCiAgICANCiAgICBjb25zdCBwb2x5Z29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwb2x5Z29uJyk7DQogICAgcG9seWdvbi5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICcwIDAsIDEwIDMuNSwgMCA3Jyk7DQogICAgcG9seWdvbi5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnIzRDQUY1MCcpOw0KICAgIA0KICAgIG1hcmtlci5hcHBlbmRDaGlsZChwb2x5Z29uKTsNCiAgICBkZWZzLmFwcGVuZENoaWxkKG1hcmtlcik7DQogICAgDQogICAgLy8gQ3JlYXRlIGEgdGVtcG9yYXJ5IFNWRyBjb250YWluZXIgZm9yIHRoZSBtYXJrZXIgZGVmaW5pdGlvbg0KICAgIGNvbnN0IG1hcmtlclN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7DQogICAgbWFya2VyU3ZnLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsNCiAgICBtYXJrZXJTdmcuc3R5bGUud2lkdGggPSAnMCc7DQogICAgbWFya2VyU3ZnLnN0eWxlLmhlaWdodCA9ICcwJzsNCiAgICBtYXJrZXJTdmcuYXBwZW5kQ2hpbGQoZGVmcyk7DQogICAgZmxvd0VkaXRvci5jYW52YXMuYXBwZW5kQ2hpbGQobWFya2VyU3ZnKTsNCiAgICANCiAgICAvLyBJbml0aWFsaXplIGNhbnZhcyB0cmFuc2Zvcm0gZm9yIHBhbm5pbmcNCiAgICB3aW5kb3cuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICANCiAgICAvLyBMb2FkIG5vZGVzIGZyb20gVkZTDQogICAgYXdhaXQgbm9kZVJlZ2lzdHJ5LmxvYWROb2Rlc0Zyb21WRlMoKTsNCiAgICANCiAgICAvLyBQb3B1bGF0ZSB0b29sYm94IHdpdGggbG9hZGVkIG5vZGVzDQogICAgd2luZG93LnVpTWFuYWdlci5wb3B1bGF0ZVRvb2xib3goKTsNCiAgICANCiAgICAvLyBTZXQgdXAgZXZlbnQgaGFuZGxlcnMNCiAgICB3aW5kb3cudWlNYW5hZ2VyLnNldHVwRXZlbnRIYW5kbGVycygpOw0KICAgIA0KICAgIC8vIENvbm5lY3QgdG8gV2ViU29ja2V0IGZvciByZWFsLXRpbWUgdXBkYXRlcw0KICAgIGNvbm5lY3RXZWJTb2NrZXQoKTsNCiAgICANCiAgICAvLyBIYW5kbGUgd2luZG93IHJlc2l6ZSB0byB1cGRhdGUgY29ubmVjdGlvbnMNCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4gew0KICAgICAgICBzZXRUaW1lb3V0KHJlZHJhd0FsbENvbm5lY3Rpb25zLCAxMDApOw0KICAgIH0pOw0KICAgIA0KICAgIC8vIEhhbmRsZSBhcHAgY2xlYW51cCB3aGVuIHdpbmRvdyBpcyB1bmxvYWRlZA0KICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCBjbGVhbnVwRmxvd0VkaXRvcik7DQogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BhZ2VoaWRlJywgY2xlYW51cEZsb3dFZGl0b3IpOw0KICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1bmxvYWQnLCBjbGVhbnVwRmxvd0VkaXRvcik7DQogICAgDQogICAgLy8gRmxvdyBFZGl0b3IgbG9hZGVkIHN1Y2Nlc3NmdWxseSAobm8gbm90aWZpY2F0aW9uIG5lZWRlZCkNCiAgICANCiAgICAvLyBVcGRhdGUgZmlsZW5hbWUgZGlzcGxheQ0KICAgIHdpbmRvdy5maWxlTWFuYWdlci51cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICANCn0NCg0KLy8gQ2xlYW51cCBmdW5jdGlvbiB0byByZW1vdmUgdG9vbHRpcHMgYW5kIGV2ZW50IGxpc3RlbmVycw0KZnVuY3Rpb24gY2xlYW51cEZsb3dFZGl0b3IoKSB7DQogICAgLy8gTWFyayBhcHAgYXMgaW5hY3RpdmUgdG8gcHJldmVudCBuZXcgdG9vbHRpcHMNCiAgICBmbG93RWRpdG9yLmlzQWN0aXZlID0gZmFsc2U7DQogICAgDQogICAgLy8gUmVtb3ZlIGFueSBsaW5nZXJpbmcgdG9vbHRpcHMgKGNoZWNrIG11bHRpcGxlIHBvc3NpYmxlIGxvY2F0aW9ucykNCiAgICBjb25zdCB0b29sdGlwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb25uZWN0aW9uLXRvb2x0aXAsICNjb25uZWN0aW9uLXRvb2x0aXAnKTsNCiAgICB0b29sdGlwcy5mb3JFYWNoKHRvb2x0aXAgPT4gew0KICAgICAgICBpZiAodG9vbHRpcC5wYXJlbnROb2RlKSB7DQogICAgICAgICAgICB0b29sdGlwLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodG9vbHRpcCk7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICAvLyBSZW1vdmUgZ2xvYmFsIGV2ZW50IGxpc3RlbmVycw0KICAgIGlmICh3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyKSB7DQogICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHdpbmRvdy5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIpOw0KICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyID0gbnVsbDsNCiAgICB9DQogICAgDQogICAgLy8gQ2xlYXIgYW55IG90aGVyIGdsb2JhbCByZWZlcmVuY2VzDQogICAgaWYgKHdpbmRvdy5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIpIHsNCiAgICAgICAgZGVsZXRlIHdpbmRvdy5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXI7DQogICAgfQ0KICAgIA0KICAgIC8vIEFsc28gcmVtb3ZlIGFueSB0b29sdGlwcyB0aGF0IG1pZ2h0IGJlIGluIHRoZSBib2R5DQogICAgY29uc3QgYm9keVRvb2x0aXBzID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yQWxsKCcuY29ubmVjdGlvbi10b29sdGlwJyk7DQogICAgYm9keVRvb2x0aXBzLmZvckVhY2godG9vbHRpcCA9PiB7DQogICAgICAgIGlmICh0b29sdGlwLnBhcmVudE5vZGUpIHsNCiAgICAgICAgICAgIHRvb2x0aXAucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0b29sdGlwKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KfQ0KDQovLyBDb25uZWN0IHRvIFdlYlNvY2tldCBzZXJ2ZXINCmFzeW5jIGZ1bmN0aW9uIGNvbm5lY3RXZWJTb2NrZXQoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgY29ubmVjdGVkID0gYXdhaXQgc3lwbmV4QVBJLmNvbm5lY3RTb2NrZXQoKTsNCiAgICAgICAgaWYgKGNvbm5lY3RlZCkgew0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBKb2luIGZsb3cgZWRpdG9yIHJvb20NCiAgICAgICAgICAgIHN5cG5leEFQSS5qb2luUm9vbSgnZmxvdy1lZGl0b3InKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTGlzdGVuIGZvciBtZXNzYWdlcw0KICAgICAgICAgICAgc3lwbmV4QVBJLm9uKCdmbG93X3VwZGF0ZScsIChkYXRhKSA9PiB7DQogICAgICAgICAgICAgICAgaGFuZGxlRmxvd1VwZGF0ZShkYXRhKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBTZW5kIGluaXRpYWwgY29ubmVjdGlvbiBtZXNzYWdlDQogICAgICAgICAgICBzeXBuZXhBUEkuc2VuZE1lc3NhZ2UoJ2Zsb3dfY29ubmVjdGVkJywgew0KICAgICAgICAgICAgICAgIGFwcElkOiBzeXBuZXhBUEkuZ2V0QXBwSWQoKSwNCiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCkNCiAgICAgICAgICAgIH0sICdmbG93LWVkaXRvcicpOw0KICAgICAgICAgICAgDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY29ubmVjdCB0byBXZWJTb2NrZXQgc2VydmVyJyk7DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdXZWJTb2NrZXQgY29ubmVjdGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgfQ0KfQ0KDQovLyBBZGQgYSBuZXcgbm9kZSB0byB0aGUgY2FudmFzIChkeW5hbWljIHZlcnNpb24pDQpmdW5jdGlvbiBhZGROb2RlKHR5cGUpIHsNCiAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKHR5cGUpOw0KICAgIGlmICghbm9kZURlZikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdVbmtub3duIG5vZGUgdHlwZTonLCB0eXBlKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBub2RlSWQgPSBgbm9kZV8keysrZmxvd0VkaXRvci5ub2RlQ291bnRlcn1gOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBwb3NpdGlvbiByZWxhdGl2ZSB0byBjdXJyZW50IHZpZXdwb3J0IGNlbnRlcg0KICAgIGNvbnN0IGNlbnRlciA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMgPyANCiAgICAgICAgd2luZG93LmZsb3dFZGl0b3JVdGlscy5nZXRWaWV3cG9ydENlbnRlckluQ2FudmFzKCkgOg0KICAgICAgICB7IHg6IDUwMDAsIHk6IDUwMDAgfTsgLy8gRmFsbGJhY2sgdG8gY2FudmFzIGNlbnRlcg0KICAgIA0KICAgIC8vIEFkZCBzb21lIHJhbmRvbSBvZmZzZXQgYXJvdW5kIHRoZSBjZW50ZXINCiAgICBjb25zdCBvZmZzZXRYID0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMjAwOyAvLyAtMTAwIHRvICsxMDANCiAgICBjb25zdCBvZmZzZXRZID0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMjAwOyAvLyAtMTAwIHRvICsxMDANCiAgICANCiAgICBjb25zdCBub2RlID0gew0KICAgICAgICBpZDogbm9kZUlkLA0KICAgICAgICB0eXBlOiB0eXBlLA0KICAgICAgICB4OiBjZW50ZXIueCArIG9mZnNldFgsDQogICAgICAgIHk6IGNlbnRlci55ICsgb2Zmc2V0WSwNCiAgICAgICAgY29uZmlnOiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG5vZGVEZWYuY29uZmlnKSksIC8vIERlZXAgY29weQ0KICAgICAgICBkYXRhOiB7fQ0KICAgIH07DQogICAgDQogICAgLy8gSW5pdGlhbGl6ZSBzcGVjaWFsIG5vZGUgc3RhdGVzDQogICAgaWYgKHR5cGUgPT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlID0gew0KICAgICAgICAgICAgY291bnQ6IDAsDQogICAgICAgICAgICBpbnRlcnZhbDogbnVsbCwNCiAgICAgICAgICAgIGlzUnVubmluZzogZmFsc2UNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgZmxvd0VkaXRvci5ub2Rlcy5zZXQobm9kZUlkLCBub2RlKTsNCiAgICANCiAgICAvLyBDcmVhdGUgbm9kZSBlbGVtZW50IHVzaW5nIHRoZSByZW5kZXJlcg0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gbm9kZVJlbmRlcmVyLmNyZWF0ZU5vZGVFbGVtZW50KG5vZGUpOw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFwcGVuZENoaWxkKG5vZGVFbGVtZW50KTsNCiAgICANCiAgICAvLyBTZW5kIHVwZGF0ZSB2aWEgV2ViU29ja2V0DQogICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2VuZE1lc3NhZ2UpIHsNCiAgICAgICAgc3lwbmV4QVBJLnNlbmRNZXNzYWdlKCdub2RlX2FkZGVkJywgew0KICAgICAgICAgICAgbm9kZUlkOiBub2RlSWQsDQogICAgICAgICAgICB0eXBlOiB0eXBlLA0KICAgICAgICAgICAgcG9zaXRpb246IHsgeDogbm9kZS54LCB5OiBub2RlLnkgfQ0KICAgICAgICB9LCAnZmxvdy1lZGl0b3InKTsNCiAgICB9DQogICAgDQp9DQoNCi8vIEhhbmRsZSBmbG93IHVwZGF0ZXMgZnJvbSBXZWJTb2NrZXQNCmZ1bmN0aW9uIGhhbmRsZUZsb3dVcGRhdGUoZGF0YSkgew0KICAgIC8vIEhhbmRsZSByZWFsLXRpbWUgdXBkYXRlcyBmcm9tIG90aGVyIGluc3RhbmNlcw0KfQ0KDQovLyBJbml0aWFsaXplIHdoZW4gRE9NIGlzIHJlYWR5DQppZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXRGbG93RWRpdG9yKTsNCn0gZWxzZSB7DQogICAgLy8gRE9NIGlzIGFscmVhZHkgbG9hZGVkDQogICAgaW5pdEZsb3dFZGl0b3IoKTsNCn0NCg0KDQo8L3NjcmlwdD4="
  },
  "package_info": {
    "format_version": "1.0",
    "created_at": "2025-08-05T20:57:05.394600",
    "packaged_by": "Sypnex OS App Packager",
    "source_directory": ".\\flow_editor"
  },
  "additional_files": [
    {
      "vfs_path": "/nodes/nodes-pack.json",
      "filename": "nodes-pack.json",
      "data": "ew0KICAidmVyc2lvbiI6ICIxLjAuMCIsDQogICJwYWNrZWRfYXQiOiAiMjAyNS0wNy0yN1QwNTowMDo0Ni44MjEwOTAiLA0KICAidG90YWxfbm9kZXMiOiAyMSwNCiAgIm5vZGVzIjogew0KICAgICJhcnJheSI6IHsNCiAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAibmFtZSI6ICJBcnJheSBPcGVyYXRpb25zIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQcm9jZXNzIGFycmF5cyBhbmQgbGlzdHMgd2l0aCBtYXAsIGZpbHRlciwgYW5kIG90aGVyIG9wZXJhdGlvbnMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWxpc3QiLA0KICAgICAgImNvbG9yIjogInByaW1hcnkiLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAgICAgIm5hbWUiOiAiQXJyYXkiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJvYmplY3QiLA0KICAgICAgICAgICJuYW1lIjogIk9iamVjdCIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInJlc3VsdCIsDQogICAgICAgICAgIm5hbWUiOiAiUmVzdWx0IiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJsZW5ndGgiLA0KICAgICAgICAgICJuYW1lIjogIkxlbmd0aCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpcnN0IiwNCiAgICAgICAgICAibmFtZSI6ICJGaXJzdCBJdGVtIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImxhc3QiLA0KICAgICAgICAgICJuYW1lIjogIkxhc3QgSXRlbSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJvcGVyYXRpb24iOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3BlcmF0aW9uIiwNCiAgICAgICAgICAidmFsdWUiOiAibWFwIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJtYXAiLA0KICAgICAgICAgICAgImZpbHRlciIsDQogICAgICAgICAgICAibGVuZ3RoIiwNCiAgICAgICAgICAgICJqb2luIiwNCiAgICAgICAgICAgICJmaXJzdCIsDQogICAgICAgICAgICAibGFzdCIsDQogICAgICAgICAgICAic2xpY2UiLA0KICAgICAgICAgICAgInJldmVyc2UiLA0KICAgICAgICAgICAgInNvcnQiLA0KICAgICAgICAgICAgInVuaXF1ZSIsDQogICAgICAgICAgICAib2JqZWN0X2tleXMiLA0KICAgICAgICAgICAgIm9iamVjdF92YWx1ZXMiLA0KICAgICAgICAgICAgIm9iamVjdF9lbnRyaWVzIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgImZpZWxkX3BhdGgiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkZpZWxkIFBhdGggKGZvciBtYXAvZmlsdGVyKSIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogImUuZy4sIG5hbWUsIHVzZXIuZW1haWwsIGlkIg0KICAgICAgICB9LA0KICAgICAgICAiZmlsdGVyX3ZhbHVlIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWx0ZXIgVmFsdWUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJWYWx1ZSB0byBmaWx0ZXIgYnkiDQogICAgICAgIH0sDQogICAgICAgICJmaWx0ZXJfb3BlcmF0b3IiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRmlsdGVyIE9wZXJhdG9yIiwNCiAgICAgICAgICAidmFsdWUiOiAiZXF1YWxzIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJlcXVhbHMiLA0KICAgICAgICAgICAgIm5vdF9lcXVhbHMiLA0KICAgICAgICAgICAgImNvbnRhaW5zIiwNCiAgICAgICAgICAgICJncmVhdGVyX3RoYW4iLA0KICAgICAgICAgICAgImxlc3NfdGhhbiIsDQogICAgICAgICAgICAic3RhcnRzX3dpdGgiLA0KICAgICAgICAgICAgImVuZHNfd2l0aCINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJqb2luX3NlcGFyYXRvciI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiSm9pbiBTZXBhcmF0b3IiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIsICIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlNlcGFyYXRvciBmb3Igam9pbiBvcGVyYXRpb24iDQogICAgICAgIH0sDQogICAgICAgICJzbGljZV9zdGFydCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJTbGljZSBTdGFydCIsDQogICAgICAgICAgInZhbHVlIjogMCwNCiAgICAgICAgICAibWluIjogMA0KICAgICAgICB9LA0KICAgICAgICAic2xpY2VfZW5kIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIlNsaWNlIEVuZCAoMCA9IGVuZCkiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDANCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJhcnJheV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAiYXVkaW8iOiB7DQogICAgICAiaWQiOiAiYXVkaW8iLA0KICAgICAgIm5hbWUiOiAiQXVkaW8gUGxheWVyIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQbGF5IGF1ZGlvIGZpbGVzIGFuZCBjb250cm9sIHBsYXliYWNrIiwNCiAgICAgICJpY29uIjogImZhcyBmYS12b2x1bWUtdXAiLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogIm1lZGlhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJmcm9udGVuZF9vbmx5IiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJiaW5hcnkiLA0KICAgICAgICAgICJuYW1lIjogIkJpbmFyeSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImF1ZGlvX2RhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkF1ZGlvIERhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ1cmwiLA0KICAgICAgICAgICJuYW1lIjogIlVSTCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhdWRpb19kYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJBdWRpbyBEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYXVkaW9fdXJsIiwNCiAgICAgICAgICAibmFtZSI6ICJBdWRpbyBVUkwiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZHVyYXRpb24iLA0KICAgICAgICAgICJuYW1lIjogIkR1cmF0aW9uIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAib3JpZ2luYWwiLA0KICAgICAgICAgICJuYW1lIjogIk9yaWdpbmFsIiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiYXV0b1BsYXkiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQXV0byBQbGF5IiwNCiAgICAgICAgICAidmFsdWUiOiAiZmFsc2UiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgInZvbHVtZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJWb2x1bWUgKDAtMSkiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgIm1heCI6IDEsDQogICAgICAgICAgInN0ZXAiOiAwLjENCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJhdWRpb19leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAiY29uZGl0aW9uIjogew0KICAgICAgImlkIjogImNvbmRpdGlvbiIsDQogICAgICAibmFtZSI6ICJDb25kaXRpb24iLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkNvbXBhcmUgaW5wdXQgdmFsdWUgdG8gYSBjb25kaXRpb24gYW5kIG91dHB1dCB0cnVlL2ZhbHNlIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1xdWVzdGlvbi1jaXJjbGUiLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogImxvZ2ljIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidmFsdWUiLA0KICAgICAgICAgICJuYW1lIjogIlZhbHVlIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAicmVzdWx0IiwNCiAgICAgICAgICAibmFtZSI6ICJSZXN1bHQiLA0KICAgICAgICAgICJ0eXBlIjogImJvb2xlYW4iDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAib3BlcmF0b3IiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3BlcmF0b3IiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJlcXVhbHMiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImVxdWFscyIsDQogICAgICAgICAgICAibm90X2VxdWFscyIsDQogICAgICAgICAgICAiZ3JlYXRlcl90aGFuIiwNCiAgICAgICAgICAgICJsZXNzX3RoYW4iLA0KICAgICAgICAgICAgImdyZWF0ZXJfdGhhbl9vcl9lcXVhbCIsDQogICAgICAgICAgICAibGVzc190aGFuX29yX2VxdWFsIiwNCiAgICAgICAgICAgICJjb250YWlucyIsDQogICAgICAgICAgICAibm90X2NvbnRhaW5zIiwNCiAgICAgICAgICAgICJzdGFydHNfd2l0aCIsDQogICAgICAgICAgICAiZW5kc193aXRoIiwNCiAgICAgICAgICAgICJpc19lbXB0eSIsDQogICAgICAgICAgICAiaXNfbm90X2VtcHR5Ig0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgImNvbXBhcmVfdmFsdWUiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkNvbXBhcmUgVG8iLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJWYWx1ZSB0byBjb21wYXJlIGFnYWluc3QiDQogICAgICAgIH0sDQogICAgICAgICJjYXNlX3NlbnNpdGl2ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJDYXNlIFNlbnNpdGl2ZSIsDQogICAgICAgICAgInZhbHVlIjogInRydWUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJjb25kaXRpb25fZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImRlbGF5Ijogew0KICAgICAgImlkIjogImRlbGF5IiwNCiAgICAgICJuYW1lIjogIkRlbGF5IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEZWxheXMgdGhlIGZsb3cgZXhlY3V0aW9uIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1jbG9jayIsDQogICAgICAiY29sb3IiOiAid2FybmluZyIsDQogICAgICAiY2F0ZWdvcnkiOiAiZmxvdyIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImV4ZWN1dG9yIjogImRlbGF5X2V4ZWN1dG9yIiwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJkZWxheV9tcyI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJEZWxheSAobWlsbGlzZWNvbmRzKSIsDQogICAgICAgICAgInZhbHVlIjogMTAwMCwNCiAgICAgICAgICAibWluIjogMCwNCiAgICAgICAgICAibWF4IjogNjAwMDAsDQogICAgICAgICAgInN0ZXAiOiAxMDANCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQogICAgImRpc3BsYXkiOiB7DQogICAgICAiaWQiOiAiZGlzcGxheSIsDQogICAgICAibmFtZSI6ICJEaXNwbGF5IFRleHQiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkRpc3BsYXkgdGV4dCBkYXRhIGluIHZhcmlvdXMgZm9ybWF0cyIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtZXllIiwNCiAgICAgICJjb2xvciI6ICJzdWNjZXNzIiwNCiAgICAgICJjYXRlZ29yeSI6ICJvdXRwdXQiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImZyb250ZW5kX29ubHkiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAianNvbiIsDQogICAgICAgICAgIm5hbWUiOiAiSlNPTiIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJiaW5hcnkiLA0KICAgICAgICAgICJuYW1lIjogIkJpbmFyeSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRpc3BsYXllZCIsDQogICAgICAgICAgIm5hbWUiOiAiRGlzcGxheWVkIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImlucHV0X3BvcnQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiSW5wdXQgUG9ydCIsDQogICAgICAgICAgInZhbHVlIjogImF1dG8iLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImF1dG8iLA0KICAgICAgICAgICAgInRleHQiLA0KICAgICAgICAgICAgImpzb24iLA0KICAgICAgICAgICAgImRhdGEiLA0KICAgICAgICAgICAgImJpbmFyeSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJmb3JtYXQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRm9ybWF0IiwNCiAgICAgICAgICAidmFsdWUiOiAidGV4dCIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidGV4dCIsDQogICAgICAgICAgICAianNvbiIsDQogICAgICAgICAgICAiaHRtbCINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJtYXhMZW5ndGgiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiTWF4IExlbmd0aCIsDQogICAgICAgICAgInZhbHVlIjogMTAwMCwNCiAgICAgICAgICAibWluIjogMSwNCiAgICAgICAgICAibWF4IjogMTAwMDAsDQogICAgICAgICAgInN0ZXAiOiAxMDANCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJkaXNwbGF5X2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJmb3JfZWFjaCI6IHsNCiAgICAgICJpZCI6ICJmb3JfZWFjaCIsDQogICAgICAibmFtZSI6ICJGb3IgRWFjaCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiSXRlcmF0ZSB0aHJvdWdoIGFuIGFycmF5IGFuZCBleGVjdXRlIGNvbm5lY3RlZCBub2RlcyBmb3IgZWFjaCBpdGVtIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1yZXBlYXQiLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogImZsb3ciLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImFycmF5IiwNCiAgICAgICAgICAibmFtZSI6ICJBcnJheSIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImN1cnJlbnRfaXRlbSIsDQogICAgICAgICAgIm5hbWUiOiAiQ3VycmVudCBJdGVtIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImN1cnJlbnRfaW5kZXgiLA0KICAgICAgICAgICJuYW1lIjogIkN1cnJlbnQgSW5kZXgiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjb21wbGV0ZWQiLA0KICAgICAgICAgICJuYW1lIjogIkNvbXBsZXRlZCIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJzdG9wX29uX2Vycm9yIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIlN0b3Agb24gRXJyb3IiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0cnVlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJpdGVyYXRpb25fZGVsYXkiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiSXRlcmF0aW9uIERlbGF5IChtcykiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgIm1heCI6IDYwMDAwLA0KICAgICAgICAgICJzdGVwIjogMTAwLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJEZWxheSBiZXR3ZWVuIGl0ZXJhdGlvbnMgaW4gbWlsbGlzZWNvbmRzIg0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImZvcl9lYWNoX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJodHRwIjogew0KICAgICAgImlkIjogImh0dHAiLA0KICAgICAgIm5hbWUiOiAiSFRUUCBSZXF1ZXN0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJNYWtlIEhUVFAgcmVxdWVzdHMgdG8gZXh0ZXJuYWwgQVBJcyBhbmQgc2VydmljZXMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWdsb2JlIiwNCiAgICAgICJjb2xvciI6ICJwcmltYXJ5IiwNCiAgICAgICJjYXRlZ29yeSI6ICJuZXR3b3JrIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImpzb24iLA0KICAgICAgICAgICJuYW1lIjogIkpTT04iLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJzdGF0dXNfY29kZSIsDQogICAgICAgICAgIm5hbWUiOiAiU3RhdHVzIENvZGUiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJoZWFkZXJzIiwNCiAgICAgICAgICAibmFtZSI6ICJIZWFkZXJzIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInVybCIsDQogICAgICAgICAgIm5hbWUiOiAiVVJMIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgInVybCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiVVJMIiwNCiAgICAgICAgICAidmFsdWUiOiAiaHR0cHM6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3Bvc3RzLzEiDQogICAgICAgIH0sDQogICAgICAgICJtZXRob2QiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiTWV0aG9kIiwNCiAgICAgICAgICAidmFsdWUiOiAiR0VUIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJHRVQiLA0KICAgICAgICAgICAgIlBPU1QiLA0KICAgICAgICAgICAgIlBVVCIsDQogICAgICAgICAgICAiREVMRVRFIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgImhlYWRlcnMiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dGFyZWEiLA0KICAgICAgICAgICJsYWJlbCI6ICJIZWFkZXJzIChKU09OKSIsDQogICAgICAgICAgInZhbHVlIjogIntcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIn0iDQogICAgICAgIH0sDQogICAgICAgICJib2R5Ijogew0KICAgICAgICAgICJ0eXBlIjogInRleHRhcmVhIiwNCiAgICAgICAgICAibGFiZWwiOiAiQm9keSAoSlNPTikiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ7XCJtZXNzYWdlXCI6IFwie3tWQUxVRX19XCIsIFwidGltZXN0YW1wXCI6IFwie3tKU09OOnRpbWVzdGFtcH19XCJ9Ig0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImh0dHBfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImltYWdlIjogew0KICAgICAgImlkIjogImltYWdlIiwNCiAgICAgICJuYW1lIjogIkltYWdlIERpc3BsYXkiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkRpc3BsYXkgaW1hZ2VzIGFuZCBjb250cm9sIHZpc3VhbGl6YXRpb24iLA0KICAgICAgImljb24iOiAiZmFzIGZhLWltYWdlIiwNCiAgICAgICJjb2xvciI6ICJpbmZvIiwNCiAgICAgICJjYXRlZ29yeSI6ICJtZWRpYSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiZnJvbnRlbmRfb25seSIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJpbWFnZV9kYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJJbWFnZSBEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidXJsIiwNCiAgICAgICAgICAibmFtZSI6ICJVUkwiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJpbmFyeSIsDQogICAgICAgICAgIm5hbWUiOiAiQmluYXJ5IiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiaW1hZ2VfZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiSW1hZ2UgRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImltYWdlX3VybCIsDQogICAgICAgICAgIm5hbWUiOiAiSW1hZ2UgVVJMIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRpbWVuc2lvbnMiLA0KICAgICAgICAgICJuYW1lIjogIkRpbWVuc2lvbnMiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAib3JpZ2luYWwiLA0KICAgICAgICAgICJuYW1lIjogIk9yaWdpbmFsIiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAibWF4X3ByZXZpZXdfc2l6ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJNYXggUHJldmlldyBTaXplIiwNCiAgICAgICAgICAidmFsdWUiOiAzMDAsDQogICAgICAgICAgIm1pbiI6IDUwLA0KICAgICAgICAgICJtYXgiOiA4MDAsDQogICAgICAgICAgInN0ZXAiOiA1MA0KICAgICAgICB9LA0KICAgICAgICAic2hvd19pbmZvIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIlNob3cgSW5mbyIsDQogICAgICAgICAgInZhbHVlIjogInRydWUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJpbWFnZV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAianNvbl9leHRyYWN0Ijogew0KICAgICAgImlkIjogImpzb25fZXh0cmFjdCIsDQogICAgICAibmFtZSI6ICJKU09OIEV4dHJhY3QiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkV4dHJhY3QgdmFsdWVzIGZyb20gSlNPTiBkYXRhIHVzaW5nIGRvdCBub3RhdGlvbiIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtY29kZS1icmFuY2giLA0KICAgICAgImNvbG9yIjogImluZm8iLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImpzb24iLA0KICAgICAgICAgICJuYW1lIjogIkpTT04iLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJqc29uIiwNCiAgICAgICAgICAibmFtZSI6ICJKU09OIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImV4dHJhY3RlZF92YWx1ZSIsDQogICAgICAgICAgIm5hbWUiOiAiRXh0cmFjdGVkIFZhbHVlIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpZWxkX3BhdGgiLA0KICAgICAgICAgICJuYW1lIjogIkZpZWxkIFBhdGgiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAib3JpZ2luYWwiLA0KICAgICAgICAgICJuYW1lIjogIk9yaWdpbmFsIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImZpZWxkX3BhdGgiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkZpZWxkIFBhdGgiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJkYXRhLml0ZW1zIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiVXNlIGRvdCBub3RhdGlvbiAoZS5nLiwgZGF0YS5pdGVtcy4wLm5hbWUpIg0KICAgICAgICB9LA0KICAgICAgICAiZGlzcGxheV9mb3JtYXQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRGlzcGxheSBGb3JtYXQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0ZXh0IiwNCiAgICAgICAgICAgICJqc29uIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJqc29uX2V4dHJhY3RfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImxsbV9jaGF0Ijogew0KICAgICAgImlkIjogImxsbV9jaGF0IiwNCiAgICAgICJuYW1lIjogIkxMTSBDaGF0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJDaGF0IHdpdGggTGFyZ2UgTGFuZ3VhZ2UgTW9kZWxzIHVzaW5nIE9sbGFtYSIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtcm9ib3QiLA0KICAgICAgImNvbG9yIjogImluZm8iLA0KICAgICAgImNhdGVnb3J5IjogImFpIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAicHJvbXB0IiwNCiAgICAgICAgICAibmFtZSI6ICJQcm9tcHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAic3lzdGVtX21lc3NhZ2UiLA0KICAgICAgICAgICJuYW1lIjogIlN5c3RlbSBNZXNzYWdlIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImNvbnRleHQiLA0KICAgICAgICAgICJuYW1lIjogIkNvbnRleHQiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJyZXNwb25zZSIsDQogICAgICAgICAgIm5hbWUiOiAiUmVzcG9uc2UiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidG9rZW5zX3VzZWQiLA0KICAgICAgICAgICJuYW1lIjogIlRva2VucyBVc2VkIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAibW9kZWxfdXNlZCIsDQogICAgICAgICAgIm5hbWUiOiAiTW9kZWwgVXNlZCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJmdWxsX3Jlc3BvbnNlIiwNCiAgICAgICAgICAibmFtZSI6ICJGdWxsIFJlc3BvbnNlIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImVuZHBvaW50Ijogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJPbGxhbWEgRW5kcG9pbnQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJodHRwOi8vMTI3LjAuMC4xOjExNDM0L3YxIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiaHR0cDovLzEyNy4wLjAuMToxMTQzNC92MSINCiAgICAgICAgfSwNCiAgICAgICAgIm1vZGVsIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJNb2RlbCBOYW1lIiwNCiAgICAgICAgICAidmFsdWUiOiAiSGFtbWVyQUkvbW4tbWFnLW1lbGwtcjE6bGF0ZXN0IiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAibGxhbWEyLCBjb2RlbGxhbWEsIGV0Yy4iDQogICAgICAgIH0sDQogICAgICAgICJ0ZW1wZXJhdHVyZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJUZW1wZXJhdHVyZSIsDQogICAgICAgICAgInZhbHVlIjogMC43LA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJtYXgiOiAyLA0KICAgICAgICAgICJzdGVwIjogMC4xDQogICAgICAgIH0sDQogICAgICAgICJtYXhfdG9rZW5zIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIk1heCBUb2tlbnMiLA0KICAgICAgICAgICJ2YWx1ZSI6IDIwNDgsDQogICAgICAgICAgIm1pbiI6IDEsDQogICAgICAgICAgIm1heCI6IDgxOTIsDQogICAgICAgICAgInN0ZXAiOiAxDQogICAgICAgIH0sDQogICAgICAgICJzeXN0ZW1fcHJvbXB0Ijogew0KICAgICAgICAgICJ0eXBlIjogInRleHRhcmVhIiwNCiAgICAgICAgICAibGFiZWwiOiAiU3lzdGVtIFByb21wdCIsDQogICAgICAgICAgInZhbHVlIjogIllvdSBhcmUgYSBoZWxwZnVsIEFJIGFzc2lzdGFudC4iLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJEZWZpbmUgdGhlIEFJJ3Mgcm9sZSBhbmQgYmVoYXZpb3IiDQogICAgICAgIH0sDQogICAgICAgICJpbmNsdWRlX2NvbnRleHQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiSW5jbHVkZSBDb250ZXh0IiwNCiAgICAgICAgICAidmFsdWUiOiAidHJ1ZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImxsbV9jaGF0X2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJsb2dpY2FsX2dhdGUiOiB7DQogICAgICAiaWQiOiAibG9naWNhbF9nYXRlIiwNCiAgICAgICJuYW1lIjogIkxvZ2ljYWwgR2F0ZSIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiT25seSBjb250aW51ZSBleGVjdXRpb24gaWYgaW5wdXQgaXMgdHJ1ZSIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtZmlsdGVyIiwNCiAgICAgICJjb2xvciI6ICJpbmZvIiwNCiAgICAgICJjYXRlZ29yeSI6ICJsb2dpYyIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImNvbmRpdGlvbiIsDQogICAgICAgICAgIm5hbWUiOiAiQ29uZGl0aW9uIiwNCiAgICAgICAgICAidHlwZSI6ICJib29sZWFuIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJpbnZlcnQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiSW52ZXJ0IExvZ2ljIiwNCiAgICAgICAgICAidmFsdWUiOiAiZmFsc2UiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgImRlc2NyaXB0aW9uIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJEZXNjcmlwdGlvbiIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIk9wdGlvbmFsIGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhpcyBnYXRlIGRvZXMiDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAibG9naWNhbF9nYXRlX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJtYXRoIjogew0KICAgICAgImlkIjogIm1hdGgiLA0KICAgICAgIm5hbWUiOiAiTWF0aCBPcGVyYXRpb25zIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQZXJmb3JtIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG9uIG51bWVyaWMgdmFsdWVzIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1jYWxjdWxhdG9yIiwNCiAgICAgICJjb2xvciI6ICJpbmZvIiwNCiAgICAgICJjYXRlZ29yeSI6ICJkYXRhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidmFsdWVfYSIsDQogICAgICAgICAgIm5hbWUiOiAiVmFsdWUgQSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ2YWx1ZV9iIiwNCiAgICAgICAgICAibmFtZSI6ICJWYWx1ZSBCIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm51bWJlcl9hIiwNCiAgICAgICAgICAibmFtZSI6ICJOdW1iZXIgQSIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm51bWJlcl9iIiwNCiAgICAgICAgICAibmFtZSI6ICJOdW1iZXIgQiIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAicmVzdWx0IiwNCiAgICAgICAgICAibmFtZSI6ICJSZXN1bHQiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZm9ybWF0dGVkIiwNCiAgICAgICAgICAibmFtZSI6ICJGb3JtYXR0ZWQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAib3BlcmF0aW9uIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk9wZXJhdGlvbiIsDQogICAgICAgICAgInZhbHVlIjogImFkZCIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAiYWRkIiwNCiAgICAgICAgICAgICJzdWJ0cmFjdCIsDQogICAgICAgICAgICAibXVsdGlwbHkiLA0KICAgICAgICAgICAgImRpdmlkZSIsDQogICAgICAgICAgICAibW9kdWxvIiwNCiAgICAgICAgICAgICJwb3dlciIsDQogICAgICAgICAgICAibWluIiwNCiAgICAgICAgICAgICJtYXgiLA0KICAgICAgICAgICAgImFicyIsDQogICAgICAgICAgICAicm91bmQiLA0KICAgICAgICAgICAgImZsb29yIiwNCiAgICAgICAgICAgICJjZWlsIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgInZhbHVlX2EiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiVmFsdWUgQSAoaWYgbm90IGNvbm5lY3RlZCkiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgInN0ZXAiOiAwLjAxDQogICAgICAgIH0sDQogICAgICAgICJ2YWx1ZV9iIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIlZhbHVlIEIgKGlmIG5vdCBjb25uZWN0ZWQpIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJzdGVwIjogMC4wMQ0KICAgICAgICB9LA0KICAgICAgICAiZGVjaW1hbF9wbGFjZXMiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiRGVjaW1hbCBQbGFjZXMiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgIm1heCI6IDEwLA0KICAgICAgICAgICJzdGVwIjogMQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogIm1hdGhfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgIm5vZGVfcmVmZXJlbmNlIjogew0KICAgICAgImlkIjogIm5vZGVfcmVmZXJlbmNlIiwNCiAgICAgICJuYW1lIjogIk5vZGUgUmVmZXJlbmNlIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJBY2Nlc3Mgb3V0cHV0IGRhdGEgZnJvbSBhbnkgcHJldmlvdXNseSBleGVjdXRlZCBub2RlIGluIHRoZSB3b3JrZmxvdyIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtbGluayIsDQogICAgICAiY29sb3IiOiAiaW5mbyIsDQogICAgICAiY2F0ZWdvcnkiOiAiZGF0YSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiLA0KICAgICAgICAgICJvcHRpb25hbCI6IHRydWUNCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJqc29uIiwNCiAgICAgICAgICAibmFtZSI6ICJKU09OIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm51bWJlciIsDQogICAgICAgICAgIm5hbWUiOiAiTnVtYmVyIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYm9vbGVhbiIsDQogICAgICAgICAgIm5hbWUiOiAiQm9vbGVhbiIsDQogICAgICAgICAgInR5cGUiOiAiYm9vbGVhbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJiaW5hcnkiLA0KICAgICAgICAgICJuYW1lIjogIkJpbmFyeSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm9yaWdpbmFsIiwNCiAgICAgICAgICAibmFtZSI6ICJPcmlnaW5hbCIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJzb3VyY2Vfbm9kZV9pZCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJTb3VyY2UgTm9kZSIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbXSwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiU2VsZWN0IGEgbm9kZSB0byByZWZlcmVuY2UiDQogICAgICAgIH0sDQogICAgICAgICJvdXRwdXRfcG9ydF9pZCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJPdXRwdXQgUG9ydCIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbXSwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiU2VsZWN0IGFuIG91dHB1dCBwb3J0Ig0KICAgICAgICB9LA0KICAgICAgICAiZmFsbGJhY2tfdmFsdWUiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkZhbGxiYWNrIFZhbHVlIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiVmFsdWUgdG8gdXNlIGlmIHJlZmVyZW5jZSBmYWlscyINCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJub2RlX3JlZmVyZW5jZV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAicmFuZG9tIjogew0KICAgICAgImlkIjogInJhbmRvbSIsDQogICAgICAibmFtZSI6ICJSYW5kb20gTnVtYmVyIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJHZW5lcmF0ZSByYW5kb20gbnVtYmVycyB3aXRoaW4gYSBzcGVjaWZpZWQgcmFuZ2UiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWRpY2UiLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIiwNCiAgICAgICAgICAib3B0aW9uYWwiOiB0cnVlDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJudW1iZXIiLA0KICAgICAgICAgICJuYW1lIjogIk51bWJlciIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJpbnRlZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJJbnRlZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZmxvYXQiLA0KICAgICAgICAgICJuYW1lIjogIkZsb2F0IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAibWluX3ZhbHVlIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIk1pbmltdW0gVmFsdWUiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgInN0ZXAiOiAwLjAxDQogICAgICAgIH0sDQogICAgICAgICJtYXhfdmFsdWUiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiTWF4aW11bSBWYWx1ZSIsDQogICAgICAgICAgInZhbHVlIjogMTAwLA0KICAgICAgICAgICJzdGVwIjogMC4wMQ0KICAgICAgICB9LA0KICAgICAgICAiZGVjaW1hbF9wbGFjZXMiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiRGVjaW1hbCBQbGFjZXMiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgIm1heCI6IDEwLA0KICAgICAgICAgICJzdGVwIjogMQ0KICAgICAgICB9LA0KICAgICAgICAib3V0cHV0X3R5cGUiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3V0cHV0IFR5cGUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJpbnRlZ2VyIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJpbnRlZ2VyIiwNCiAgICAgICAgICAgICJmbG9hdCINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAicmFuZG9tX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJyZXBlYXRlciI6IHsNCiAgICAgICJpZCI6ICJyZXBlYXRlciIsDQogICAgICAibmFtZSI6ICJSZXBlYXRlciIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiUmVwZWF0IGNvbm5lY3RlZCB3b3JrZmxvdyBhdCBpbnRlcnZhbHMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLXJlZG8iLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogInRyaWdnZXIiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjb3VudCIsDQogICAgICAgICAgIm5hbWUiOiAiQ291bnQiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJpbnRlcnZhbCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJJbnRlcnZhbCAobXMpIiwNCiAgICAgICAgICAidmFsdWUiOiAxMDAwLA0KICAgICAgICAgICJtaW4iOiAxMDAsDQogICAgICAgICAgIm1heCI6IDMwMDAwMCwNCiAgICAgICAgICAic3RlcCI6IDEwMA0KICAgICAgICB9LA0KICAgICAgICAiY291bnQiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiQ291bnQgKDAgPSBpbmZpbml0ZSkiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgInN0ZXAiOiAxDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAicmVwZWF0ZXJfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInN0cmluZyI6IHsNCiAgICAgICJpZCI6ICJzdHJpbmciLA0KICAgICAgIm5hbWUiOiAiU3RyaW5nIE9wZXJhdGlvbnMiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIk1hbmlwdWxhdGUgYW5kIHByb2Nlc3MgdGV4dCBzdHJpbmdzIHdpdGggdmFyaW91cyBvcGVyYXRpb25zIiwNCiAgICAgICJpY29uIjogImZhcyBmYS10ZXh0LXdpZHRoIiwNCiAgICAgICJjb2xvciI6ICJzZWNvbmRhcnkiLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHRfYiIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCBCIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJyZXN1bHQiLA0KICAgICAgICAgICJuYW1lIjogIlJlc3VsdCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImFycmF5IiwNCiAgICAgICAgICAibmFtZSI6ICJBcnJheSIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJsZW5ndGgiLA0KICAgICAgICAgICJuYW1lIjogIkxlbmd0aCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIndvcmRfY291bnQiLA0KICAgICAgICAgICJuYW1lIjogIldvcmQgQ291bnQiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJvcGVyYXRpb24iOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3BlcmF0aW9uIiwNCiAgICAgICAgICAidmFsdWUiOiAiY29uY2F0ZW5hdGUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImNvbmNhdGVuYXRlIiwNCiAgICAgICAgICAgICJzcGxpdCIsDQogICAgICAgICAgICAicmVwbGFjZSIsDQogICAgICAgICAgICAidHJpbSIsDQogICAgICAgICAgICAidXBwZXJjYXNlIiwNCiAgICAgICAgICAgICJsb3dlcmNhc2UiLA0KICAgICAgICAgICAgInN1YnN0cmluZyIsDQogICAgICAgICAgICAicmVnZXhfbWF0Y2giLA0KICAgICAgICAgICAgInJlZ2V4X3JlcGxhY2UiLA0KICAgICAgICAgICAgInN0YXJ0c193aXRoIiwNCiAgICAgICAgICAgICJlbmRzX3dpdGgiLA0KICAgICAgICAgICAgImNvbnRhaW5zIiwNCiAgICAgICAgICAgICJyZXBlYXQiLA0KICAgICAgICAgICAgImxhc3RfbGluZSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJ0ZXh0X2IiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIlRleHQgQiAoaWYgbm90IGNvbm5lY3RlZCkiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJTZWNvbmQgdGV4dCBpbnB1dCINCiAgICAgICAgfSwNCiAgICAgICAgInNlcGFyYXRvciI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiU2VwYXJhdG9yL0RlbGltaXRlciIsDQogICAgICAgICAgInZhbHVlIjogIiwiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJGb3Igc3BsaXQvam9pbiBvcGVyYXRpb25zIg0KICAgICAgICB9LA0KICAgICAgICAic2VhcmNoX3RleHQiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIlNlYXJjaCBUZXh0IiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiVGV4dCB0byBzZWFyY2gvcmVwbGFjZSINCiAgICAgICAgfSwNCiAgICAgICAgInJlcGxhY2VfdGV4dCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiUmVwbGFjZSBXaXRoIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiUmVwbGFjZW1lbnQgdGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgInN0YXJ0X2luZGV4Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIlN0YXJ0IEluZGV4IiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwDQogICAgICAgIH0sDQogICAgICAgICJlbmRfaW5kZXgiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiRW5kIEluZGV4ICgwID0gZW5kKSIsDQogICAgICAgICAgInZhbHVlIjogMCwNCiAgICAgICAgICAibWluIjogMA0KICAgICAgICB9LA0KICAgICAgICAicmVwZWF0X2NvdW50Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIlJlcGVhdCBDb3VudCIsDQogICAgICAgICAgInZhbHVlIjogMSwNCiAgICAgICAgICAibWluIjogMSwNCiAgICAgICAgICAibWF4IjogMTAwDQogICAgICAgIH0sDQogICAgICAgICJjYXNlX3NlbnNpdGl2ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJDYXNlIFNlbnNpdGl2ZSIsDQogICAgICAgICAgInZhbHVlIjogInRydWUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJzdHJpbmdfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInRleHQiOiB7DQogICAgICAiaWQiOiAidGV4dCIsDQogICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJPdXRwdXQgc3RhdGljIHRleHQgY29udGVudCIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtZm9udCIsDQogICAgICAiY29sb3IiOiAic2Vjb25kYXJ5IiwNCiAgICAgICJjYXRlZ29yeSI6ICJkYXRhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInVwcGVyY2FzZSIsDQogICAgICAgICAgIm5hbWUiOiAiVXBwZXJjYXNlIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImxvd2VyY2FzZSIsDQogICAgICAgICAgIm5hbWUiOiAiTG93ZXJjYXNlIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIndvcmRfY291bnQiLA0KICAgICAgICAgICJuYW1lIjogIldvcmQgQ291bnQiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJsZW5ndGgiLA0KICAgICAgICAgICJuYW1lIjogIkxlbmd0aCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgInRleHRfY29udGVudCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0YXJlYSIsDQogICAgICAgICAgImxhYmVsIjogIlRleHQgQ29udGVudCIsDQogICAgICAgICAgInZhbHVlIjogIkhlbGxvLCBXb3JsZCEiDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAidGV4dF9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAidGltZXIiOiB7DQogICAgICAiaWQiOiAidGltZXIiLA0KICAgICAgIm5hbWUiOiAiVGltZXIiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkRlbGF5IGV4ZWN1dGlvbiBmb3Igc3BlY2lmaWVkIG1pbGxpc2Vjb25kcyIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtY2xvY2siLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogInRyaWdnZXIiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGltZXN0YW1wIiwNCiAgICAgICAgICAibmFtZSI6ICJUaW1lc3RhbXAiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJlbGFwc2VkIiwNCiAgICAgICAgICAibmFtZSI6ICJFbGFwc2VkIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiaW50ZXJ2YWwiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiSW50ZXJ2YWwgKG1zKSIsDQogICAgICAgICAgInZhbHVlIjogMTAwMCwNCiAgICAgICAgICAibWluIjogMTAwLA0KICAgICAgICAgICJtYXgiOiA2MDAwMCwNCiAgICAgICAgICAic3RlcCI6IDEwMA0KICAgICAgICB9LA0KICAgICAgICAiY291bnQiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiQ291bnQiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEsDQogICAgICAgICAgIm1pbiI6IDEsDQogICAgICAgICAgIm1heCI6IDEwMCwNCiAgICAgICAgICAic3RlcCI6IDENCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJ0aW1lcl9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAidmZzX2RpcmVjdG9yeV9saXN0Ijogew0KICAgICAgImlkIjogInZmc19kaXJlY3RvcnlfbGlzdCIsDQogICAgICAibmFtZSI6ICJWRlMgRGlyZWN0b3J5IExpc3QiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkxpc3QgYWxsIGZpbGVzIGFuZCBkaXJlY3RvcmllcyBpbiBhIFZGUyBwYXRoIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1mb2xkZXItdHJlZSIsDQogICAgICAiY29sb3IiOiAicHJpbWFyeSIsDQogICAgICAiY2F0ZWdvcnkiOiAic3RvcmFnZSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGlyZWN0b3J5X3BhdGgiLA0KICAgICAgICAgICJuYW1lIjogIkRpcmVjdG9yeSBQYXRoIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZmlsZV9saXN0IiwNCiAgICAgICAgICAibmFtZSI6ICJGaWxlIExpc3QiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZmlsZV9wYXRocyIsDQogICAgICAgICAgIm5hbWUiOiAiRmlsZSBQYXRocyIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJmaWxlX25hbWVzIiwNCiAgICAgICAgICAibmFtZSI6ICJGaWxlIE5hbWVzIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImNvdW50IiwNCiAgICAgICAgICAibmFtZSI6ICJGaWxlIENvdW50IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGlyZWN0b3JpZXMiLA0KICAgICAgICAgICJuYW1lIjogIkRpcmVjdG9yaWVzIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpbGVzX29ubHkiLA0KICAgICAgICAgICJuYW1lIjogIkZpbGVzIE9ubHkiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiZGlyZWN0b3J5X3BhdGgiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkRpcmVjdG9yeSBQYXRoIiwNCiAgICAgICAgICAidmFsdWUiOiAiLyIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIi9hYnNvbHV0ZS9wYXRoL2luL3ZmcyINCiAgICAgICAgfSwNCiAgICAgICAgImZpbHRlcl9leHRlbnNpb25zIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWxlIEV4dGVuc2lvbnMgRmlsdGVyIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAidHh0LGpzb24sbWQgKGxlYXZlIGVtcHR5IGZvciBhbGwpIg0KICAgICAgICB9LA0KICAgICAgICAiaW5jbHVkZV9kaXJlY3RvcmllcyI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJJbmNsdWRlIERpcmVjdG9yaWVzIiwNCiAgICAgICAgICAidmFsdWUiOiAidHJ1ZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAicmVjdXJzaXZlIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIlJlY3Vyc2l2ZSIsDQogICAgICAgICAgInZhbHVlIjogImZhbHNlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAidmZzX2RpcmVjdG9yeV9saXN0X2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJ2ZnNfbG9hZCI6IHsNCiAgICAgICJpZCI6ICJ2ZnNfbG9hZCIsDQogICAgICAibmFtZSI6ICJWRlMgTG9hZCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiTG9hZCBkYXRhIGZyb20gdGhlIFZpcnR1YWwgRmlsZSBTeXN0ZW0iLA0KICAgICAgImljb24iOiAiZmFzIGZhLWZvbGRlci1vcGVuIiwNCiAgICAgICJjb2xvciI6ICJwcmltYXJ5IiwNCiAgICAgICJjYXRlZ29yeSI6ICJzdG9yYWdlIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZmlsZV9wYXRoIiwNCiAgICAgICAgICAibmFtZSI6ICJGaWxlIFBhdGgiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiZmlsZV9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWxlIFBhdGgiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIvbXlfZGF0YS5qc29uIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiL2Fic29sdXRlL3BhdGgvaW4vdmZzIg0KICAgICAgICB9LA0KICAgICAgICAiZm9ybWF0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkZvcm1hdCIsDQogICAgICAgICAgInZhbHVlIjogImpzb24iLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImpzb24iLA0KICAgICAgICAgICAgInRleHQiLA0KICAgICAgICAgICAgImJpbmFyeSIsDQogICAgICAgICAgICAiYmxvYiINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJhdXRvX3JlbG9hZCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJBdXRvIFJlbG9hZCBvbiBDaGFuZ2UiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJmYWxzZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInZmc19sb2FkX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJ2ZnNfc2F2ZSI6IHsNCiAgICAgICJpZCI6ICJ2ZnNfc2F2ZSIsDQogICAgICAibmFtZSI6ICJWRlMgU2F2ZSIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiU2F2ZSBkYXRhIHRvIHRoZSBWaXJ0dWFsIEZpbGUgU3lzdGVtIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1zYXZlIiwNCiAgICAgICJjb2xvciI6ICJwcmltYXJ5IiwNCiAgICAgICJjYXRlZ29yeSI6ICJzdG9yYWdlIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInN1Y2Nlc3MiLA0KICAgICAgICAgICJuYW1lIjogIlN1Y2Nlc3MiLA0KICAgICAgICAgICJ0eXBlIjogImJvb2xlYW4iDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiZmlsZV9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWxlIFBhdGgiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIvbXlfZGF0YS5qc29uIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiL2Fic29sdXRlL3BhdGgvaW4vdmZzIg0KICAgICAgICB9LA0KICAgICAgICAiZm9ybWF0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkZvcm1hdCIsDQogICAgICAgICAgInZhbHVlIjogImpzb24iLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImpzb24iLA0KICAgICAgICAgICAgInRleHQiLA0KICAgICAgICAgICAgImJpbmFyeSIsDQogICAgICAgICAgICAiYmxvYiINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJvdmVyd3JpdGUiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3ZlcndyaXRlIiwNCiAgICAgICAgICAidmFsdWUiOiAidHJ1ZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiYXBwZW5kIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkFwcGVuZCBNb2RlIiwNCiAgICAgICAgICAidmFsdWUiOiAiZmFsc2UiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJ2ZnNfc2F2ZV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfQ0KICB9DQp9",
      "size": 38145
    }
  ]
}