{
  "app_metadata": {
    "id": "flow_editor",
    "name": "Flow Editor",
    "description": "Visual node-based workflow editor for creating and executing data processing pipelines",
    "icon": "fas fa-project-diagram",
    "keywords": [
      "flow",
      "workflow",
      "nodes",
      "pipeline",
      "visual",
      "editor"
    ],
    "author": "Sypnex OS",
    "version": "1.1.7",
    "type": "user_app",
    "scripts": [
      "js/utils.js",
      "js/node-registry.js",
      "js/canvas.js",
      "js/node-config.js",
      "js/node-renderer.js",
      "js/data-executors.js",
      "js/http-executors.js",
      "js/media-executors.js",
      "js/flow-executors.js",
      "js/ai-executors.js",
      "js/execution-engine.js",
      "js/workflow.js",
      "js/canvas-manager.js",
      "js/tag-manager.js",
      "js/file-manager.js",
      "js/ui-manager.js",
      "js/main.js"
    ],
    "styles": [
      "css/layout.css",
      "css/nodes.css",
      "css/components.css",
      "css/node-types.css",
      "css/responsive.css",
      "css/performance.css",
      "css/os-theme.css"
    ],
    "additional_files": [
      {
        "vfs_path": "/apps/installed/flow_editor/nodes-pack.json",
        "source_file": "node-definitions/nodes-pack.json"
      }
    ],
    "settings": [
      {
        "key": "DEFAULT_HTTP_TIMEOUT",
        "name": "HTTP Timeout (ms)",
        "type": "number",
        "value": 30000,
        "description": "Default timeout for HTTP requests in milliseconds"
      },
      {
        "key": "AUTO_SAVE_INTERVAL",
        "name": "Auto Save Interval (s)",
        "type": "number",
        "value": 30,
        "description": "Auto save workflows every N seconds (0 = disabled)"
      },
      {
        "key": "MAX_NODES",
        "name": "Maximum Nodes",
        "type": "number",
        "value": 50,
        "description": "Maximum number of nodes allowed in a workflow"
      }
    ]
  },
  "files": {
    "flow_editor.app": "ew0KICAiaWQiOiAiZmxvd19lZGl0b3IiLA0KICAibmFtZSI6ICJGbG93IEVkaXRvciIsDQogICJkZXNjcmlwdGlvbiI6ICJWaXN1YWwgbm9kZS1iYXNlZCB3b3JrZmxvdyBlZGl0b3IgZm9yIGNyZWF0aW5nIGFuZCBleGVjdXRpbmcgZGF0YSBwcm9jZXNzaW5nIHBpcGVsaW5lcyIsDQogICJpY29uIjogImZhcyBmYS1wcm9qZWN0LWRpYWdyYW0iLA0KICAia2V5d29yZHMiOiBbImZsb3ciLCAid29ya2Zsb3ciLCAibm9kZXMiLCAicGlwZWxpbmUiLCAidmlzdWFsIiwgImVkaXRvciJdLA0KICAiYXV0aG9yIjogIlN5cG5leCBPUyIsDQogICJ2ZXJzaW9uIjogIjEuMS43IiwNCiAgInR5cGUiOiAidXNlcl9hcHAiLA0KICAic2NyaXB0cyI6IFsNCiAgICAianMvdXRpbHMuanMiLA0KICAgICJqcy9ub2RlLXJlZ2lzdHJ5LmpzIiwNCiAgICAianMvY2FudmFzLmpzIiwNCiAgICAianMvbm9kZS1jb25maWcuanMiLA0KICAgICJqcy9ub2RlLXJlbmRlcmVyLmpzIiwNCiAgICAianMvZGF0YS1leGVjdXRvcnMuanMiLA0KICAgICJqcy9odHRwLWV4ZWN1dG9ycy5qcyIsDQogICAgImpzL21lZGlhLWV4ZWN1dG9ycy5qcyIsDQogICAgImpzL2Zsb3ctZXhlY3V0b3JzLmpzIiwNCiAgICAianMvYWktZXhlY3V0b3JzLmpzIiwNCiAgICAianMvZXhlY3V0aW9uLWVuZ2luZS5qcyIsDQogICAgImpzL3dvcmtmbG93LmpzIiwNCiAgICAianMvY2FudmFzLW1hbmFnZXIuanMiLA0KICAgICJqcy90YWctbWFuYWdlci5qcyIsDQogICAgImpzL2ZpbGUtbWFuYWdlci5qcyIsDQogICAgImpzL3VpLW1hbmFnZXIuanMiLA0KICAgICJqcy9tYWluLmpzIg0KICBdLA0KICAic3R5bGVzIjogWw0KICAgICJjc3MvbGF5b3V0LmNzcyIsDQogICAgImNzcy9ub2Rlcy5jc3MiLA0KICAgICJjc3MvY29tcG9uZW50cy5jc3MiLA0KICAgICJjc3Mvbm9kZS10eXBlcy5jc3MiLA0KICAgICJjc3MvcmVzcG9uc2l2ZS5jc3MiLA0KICAgICJjc3MvcGVyZm9ybWFuY2UuY3NzIiwNCiAgICAiY3NzL29zLXRoZW1lLmNzcyINCiAgXSwNCiAgImFkZGl0aW9uYWxfZmlsZXMiOiBbDQogICAgew0KICAgICAgInZmc19wYXRoIjogIi9hcHBzL2luc3RhbGxlZC9mbG93X2VkaXRvci9ub2Rlcy1wYWNrLmpzb24iLA0KICAgICAgInNvdXJjZV9maWxlIjogIm5vZGUtZGVmaW5pdGlvbnMvbm9kZXMtcGFjay5qc29uIg0KICAgIH0NCiAgXSwNCiAgInNldHRpbmdzIjogWw0KICAgIHsNCiAgICAgICJrZXkiOiAiREVGQVVMVF9IVFRQX1RJTUVPVVQiLA0KICAgICAgIm5hbWUiOiAiSFRUUCBUaW1lb3V0IChtcykiLA0KICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICJ2YWx1ZSI6IDMwMDAwLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkRlZmF1bHQgdGltZW91dCBmb3IgSFRUUCByZXF1ZXN0cyBpbiBtaWxsaXNlY29uZHMiDQogICAgfSwNCiAgICB7DQogICAgICAia2V5IjogIkFVVE9fU0FWRV9JTlRFUlZBTCIsDQogICAgICAibmFtZSI6ICJBdXRvIFNhdmUgSW50ZXJ2YWwgKHMpIiwNCiAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAidmFsdWUiOiAzMCwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJBdXRvIHNhdmUgd29ya2Zsb3dzIGV2ZXJ5IE4gc2Vjb25kcyAoMCA9IGRpc2FibGVkKSINCiAgICB9LA0KICAgIHsNCiAgICAgICJrZXkiOiAiTUFYX05PREVTIiwNCiAgICAgICJuYW1lIjogIk1heGltdW0gTm9kZXMiLA0KICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICJ2YWx1ZSI6IDUwLA0KICAgICAgImRlc2NyaXB0aW9uIjogIk1heGltdW0gbnVtYmVyIG9mIG5vZGVzIGFsbG93ZWQgaW4gYSB3b3JrZmxvdyINCiAgICB9DQogIF0NCn0=",
    "flow_editor.html": "PHN0eWxlIHR5cGU9InRleHQvY3NzIj4vKiA9PT09PSBTdHlsZTogY3NzL2xheW91dC5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIExheW91dCAmIFN0cnVjdHVyZSAqLw0KLyogRW5zdXJlIGFwcC1jb250YWluZXIgdXNlcyBmdWxsIGhlaWdodCBhbmQgcHJldmVudCB2aXN1YWwgZmxhc2hpbmcgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcHAtY29udGFpbmVyIHsNCiAgICBoZWlnaHQ6IDEwMHZoOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIC8qIFByZXZlbnQgdmlzdWFsIGFydGlmYWN0cyBkdXJpbmcgZnVsbHNjcmVlbiB0cmFuc2l0aW9ucyAqLw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIHRyYW5zaXRpb246IG5vbmUgIWltcG9ydGFudA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcHAtY29udGVudCB7DQogICAgZmxleDogMTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBnYXA6IDEwcHg7DQogICAgcGFkZGluZzogMTBweDsNCiAgICBtaW4taGVpZ2h0OiAwOw0KICAgIC8qIFByZXZlbnQgZmxhc2hpbmcgZHVyaW5nIHJlc2l6ZSAqLw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpDQogICAgfQ0KLyogRmxvdyBFZGl0b3IgTGF5b3V0ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1lZGl0b3Igew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleDogMTsNCiAgICBnYXA6IDA7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBtaW4taGVpZ2h0OiAwOw0KICAgIC8qIEVuaGFuY2VkIHZpc3VhbCBzdGFiaWxpdHkgKi8NCiAgICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW4NCiAgICB9DQovKiBMZWZ0IFRvb2xib3ggKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xib3ggew0KICAgIHdpZHRoOiAyNTBweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBmbGV4LXNocmluazogMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LWhlYWRlciB7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtaGVhZGVyIGg0IHsNCiAgICBtYXJnaW46IDA7DQogICAgZm9udC1zaXplOiAxNnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdICN0b2dnbGUtdG9vbGJveCB7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdG9nZ2xlLXRvb2xib3g6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQovKiBDb2xsYXBzZWQgc3RhdGUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xib3guY29sbGFwc2VkIHsNCiAgICB3aWR0aDogNTBweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xib3guY29sbGFwc2VkIC50b29sYm94LWNvbnRlbnQgew0KICAgIGRpc3BsYXk6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYm94LmNvbGxhcHNlZCAudG9vbGJveC1oZWFkZXIgaDQgew0KICAgIGRpc3BsYXk6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1jb250ZW50IHsNCiAgICBmbGV4OiAxOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgcGFkZGluZzogMTBweA0KICAgIH0NCi8qIE1haW4gV29ya3NwYWNlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy13b3Jrc3BhY2Ugew0KICAgIGZsZXg6IDE7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIG1pbi13aWR0aDogMA0KICAgIH0NCi8qIFRvb2xiYXIgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgcGFkZGluZzogMTJweCAyMHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGZsZXgtc2hyaW5rOiAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xiYXItbGVmdCB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDEwcHg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jdXJyZW50LWZpbGUtaW5mbyB7DQogICAgbWFyZ2luLWxlZnQ6IDE1cHg7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmN1cnJlbnQtZmlsZW5hbWUgew0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xiYXItcmlnaHQgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZ2FwOiA4cHg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmUNCiAgICB9DQovKiBab29tIENvbnRyb2xzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuem9vbS1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogNHB4Ow0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuem9vbS1sZXZlbCB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIG1pbi13aWR0aDogNDBweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgdXNlci1zZWxlY3Q6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuem9vbS1jb250cm9scyBidXR0b24gew0KICAgIHBhZGRpbmc6IDRweCA2cHg7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWNvbnRyb2xzIGJ1dHRvbjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC56b29tLWNvbnRyb2xzIGJ1dHRvbjphY3RpdmUgew0KICAgIHRyYW5zZm9ybTogc2NhbGUoMC45NSkNCiAgICB9DQovKiBDYW52YXMgQ29udGFpbmVyICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jYW52YXMtY29udGFpbmVyIHsNCiAgICBmbGV4OiAxOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIC8qIFByZXZlbnQgdmlzdWFsIGFydGlmYWN0cyBhbmQgZmxhc2hpbmcgKi8NCiAgICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLyogSW1wcm92ZSByZW5kZXJpbmcgcGVyZm9ybWFuY2UgKi8NCiAgICBjb250YWluOiBsYXlvdXQgc3R5bGUgcGFpbnQ7DQogICAgd2lsbC1jaGFuZ2U6IGF1dG8NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jYW52YXMgew0KICAgIHdpZHRoOiAxMDAwMHB4Ow0KICAgIGhlaWdodDogMTAwMDBweDsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCAyMHB4IDIwcHgsIHZhcigtLWJvcmRlci1jb2xvcikgMXB4LCB0cmFuc3BhcmVudCAxcHgpLCByYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDQwcHggNDBweCwgdmFyKC0tYm9yZGVyLWNvbG9yKSAxcHgsIHRyYW5zcGFyZW50IDFweCk7DQogICAgYmFja2dyb3VuZC1zaXplOiA0MHB4IDQwcHg7DQogICAgY3Vyc29yOiBncmFiOw0KICAgIHRyYW5zZm9ybS1vcmlnaW46IDAgMDsNCiAgICB3aWxsLWNoYW5nZTogdHJhbnNmb3JtOw0KICAgIC8qIEVuaGFuY2VkIEdQVSBhY2NlbGVyYXRpb24gZm9yIHNtb290aGVyIHRyYW5zZm9ybXMgKi8NCiAgICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgcGVyc3BlY3RpdmU6IDEwMDBweDsNCiAgICAtd2Via2l0LXBlcnNwZWN0aXZlOiAxMDAwcHg7DQogICAgdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZDsNCiAgICAtd2Via2l0LXRyYW5zZm9ybS1zdHlsZTogcHJlc2VydmUtM2Q7DQogICAgLyogUHJldmVudCB2aXN1YWwgYXJ0aWZhY3RzIGR1cmluZyB6b29tICovDQogICAgaW1hZ2UtcmVuZGVyaW5nOiBhdXRvOw0KICAgIC8qIFJlbW92ZWQgLXdlYmtpdC1mb250LXNtb290aGluZzogc3VicGl4ZWwtYW50aWFsaWFzZWQ7IC0gY2F1c2VzIHRleHQgYmx1ciAqLw0KICAgIC8qIEltcHJvdmUgYmFja2dyb3VuZCBwYXR0ZXJuIHNjYWxpbmcgKi8NCiAgICBiYWNrZ3JvdW5kLWF0dGFjaG1lbnQ6IGxvY2FsDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY2FudmFzOmFjdGl2ZSB7DQogICAgY3Vyc29yOiBncmFiYmluZw0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNhbnZhcy5wYW5uaW5nIHsNCiAgICBjdXJzb3I6IGdyYWJiaW5nDQogICAgfQ0KLyogQ29uZmlndXJhdGlvbiBQYW5lbCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLXBhbmVsIHsNCiAgICB3aWR0aDogMzAwcHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBmbGV4LXNocmluazogMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctaGVhZGVyIHsNCiAgICBwYWRkaW5nOiAxNXB4Ow0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWhlYWRlciBoNCB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdG9nZ2xlLWNvbmZpZyB7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAjdG9nZ2xlLWNvbmZpZzpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCi8qIENvbGxhcHNlZCBzdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlnLXBhbmVsLmNvbGxhcHNlZCB7DQogICAgd2lkdGg6IDUwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25maWctcGFuZWwuY29sbGFwc2VkIC5jb25maWctY29udGVudCB7DQogICAgZGlzcGxheTogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbmZpZy1wYW5lbC5jb2xsYXBzZWQgLmNvbmZpZy1oZWFkZXIgaDQgew0KICAgIGRpc3BsYXk6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWNvbnRlbnQgew0KICAgIGZsZXg6IDE7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBwYWRkaW5nOiAxNXB4DQogICAgfQ0KLyogT3V0cHV0IFBhbmVsICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1vdXRwdXQtcGFuZWwgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgZmxleC1zaHJpbms6IDA7DQogICAgbWF4LWhlaWdodDogMzAwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAxMnB4IDE1cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LWhlYWRlciBoNCB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LWNvbnRlbnQgew0KICAgIHBhZGRpbmc6IDE1cHg7DQogICAgbWF4LWhlaWdodDogMjUwcHg7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBvdmVyZmxvdy14OiBoaWRkZW4NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1vdXRwdXQtcGFuZWwuY29sbGFwc2VkIC5vdXRwdXQtY29udGVudCB7DQogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctb3V0cHV0LXBhbmVsIC5vdXRwdXQtaGVhZGVyIHsNCiAgICBjdXJzb3I6IHBvaW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1vdXRwdXQtcGFuZWwgLm91dHB1dC1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDhweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyDQogICAgfQ0KLyogPT09PT0gU3R5bGU6IGNzcy9ub2Rlcy5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIE5vZGVzICYgQ29ubmVjdGlvbnMgKi8NCi8qIE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgbWluLXdpZHRoOiAxNTBweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIGN1cnNvcjogZ3JhYjsNCiAgICB1c2VyLXNlbGVjdDogbm9uZTsNCiAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjEpOw0KICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4ycyBlYXNlLCB0cmFuc2Zvcm0gMC4xcyBlYXNlOw0KICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm07DQogICAgLyogRW5oYW5jZWQgdmlzdWFsIHN0YWJpbGl0eSBkdXJpbmcgem9vbSAqLw0KICAgIGJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjsNCiAgICAtd2Via2l0LWJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjsNCiAgICAvKiBJbXByb3ZlIHJlbmRlcmluZyBxdWFsaXR5IGF0IGRpZmZlcmVudCB6b29tIGxldmVscyAqLw0KICAgIGltYWdlLXJlbmRlcmluZzogYXV0bzsNCiAgICAvKiBSZW1vdmVkIC13ZWJraXQtZm9udC1zbW9vdGhpbmcgYW5kIHRyYW5zZm9ybS1zdHlsZTogcHJlc2VydmUtM2QgLSBjYXVzZXMgdGV4dCBibHVyICovDQogICAgLyogRG8gTk9UIHVzZSAnY29udGFpbicgcHJvcGVydHkgYXMgaXQgaGlkZXMgdGhlIHBvcnRzIHdoaWNoIGFyZSBwb3NpdGlvbmVkIG91dHNpZGUgKi8NCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlOmFjdGl2ZSB7DQogICAgY3Vyc29yOiBncmFiYmluZzsNCiAgICB0cmFuc2l0aW9uOiBub25lDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZTpob3ZlciB7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRleSgtMXB4KTsNCiAgICAvKiBSZW1vdmVkIHRyYW5zbGF0ZVooMCkgLSBjYXVzZXMgdGV4dCBibHVyICovDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5zZWxlY3RlZCB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtaGVhZGVyIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHg7DQogICAgbWFyZ2luLWJvdHRvbTogOHB4Ow0KICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubm9kZS1kZWxldGUtYnRuIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgcmlnaHQ6IC01cHg7DQogICAgdG9wOiAtNXB4Ow0KICAgIHdpZHRoOiAyMHB4Ow0KICAgIGhlaWdodDogMjBweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgb3BhY2l0eTogMDsNCiAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuMnMgZWFzZTsNCiAgICB6LWluZGV4OiAxMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGU6aG92ZXIgLm5vZGUtZGVsZXRlLWJ0biB7DQogICAgb3BhY2l0eTogMQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5ub2RlLWRlbGV0ZS1idG46aG92ZXIgew0KICAgIGJhY2tncm91bmQ6ICNkMzJmMmY7DQogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS10eXBlIHsNCiAgICBwYWRkaW5nOiAycHggNnB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IG5vcm1hbDsNCiAgICBiYWNrZ3JvdW5kOiAjNmM3NTdkOw0KICAgIGNvbG9yOiB3aGl0ZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtY29udGVudCB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtcG9ydHMgew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgcG9pbnRlci1ldmVudHM6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLXBvcnQgew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICB3aWR0aDogMTJweDsNCiAgICBoZWlnaHQ6IDEycHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHBvaW50ZXItZXZlbnRzOiBhbGw7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtcG9ydDpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLXBvcnQuaW5wdXQgew0KICAgIGxlZnQ6IC02cHg7DQogICAgdG9wOiA1MCU7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KC01MCUpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1wb3J0Lm91dHB1dCB7DQogICAgcmlnaHQ6IC02cHg7DQogICAgdG9wOiA1MCU7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KC01MCUpDQogICAgfQ0KLyogQ29ubmVjdGlvbiBMaW5lcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29ubmVjdGlvbiB7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHBvaW50ZXItZXZlbnRzOiBub25lOw0KICAgIHotaW5kZXg6IDE7DQogICAgLyogT3B0aW1pemUgU1ZHIHJlbmRlcmluZyBwZXJmb3JtYW5jZSAqLw0KICAgIHdpbGwtY2hhbmdlOiBhdXRvOw0KICAgIGNvbnRhaW46IGxheW91dCBzdHlsZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbm5lY3Rpb24tbGluZSB7DQogICAgc3Ryb2tlOiB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIHN0cm9rZS13aWR0aDogODsNCiAgICBmaWxsOiBub25lOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQogICAgb3BhY2l0eTogMC42Ow0KICAgIC8qIFNsaWdodGx5IHRyYW5zcGFyZW50IGJ5IGRlZmF1bHQgKi8NCiAgICAvKiBJbXByb3ZlIFNWRyByZW5kZXJpbmcgcXVhbGl0eSBhdCBkaWZmZXJlbnQgem9vbSBsZXZlbHMgKi8NCiAgICBzaGFwZS1yZW5kZXJpbmc6IGdlb21ldHJpY1ByZWNpc2lvbjsNCiAgICB2ZWN0b3ItZWZmZWN0OiBub24tc2NhbGluZy1zdHJva2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25uZWN0aW9uLWxpbmU6aG92ZXIgew0KICAgIHN0cm9rZTogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgb3BhY2l0eTogMTsNCiAgICBzdHJva2Utd2lkdGg6IDEwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29ubmVjdGlvbi1saW5lLmNvbm5lY3RlZCB7DQogICAgc3Ryb2tlOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBvcGFjaXR5OiAwLjgNCiAgICB9DQovKiBSdW5uaW5nIFN0YXRlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLnJ1bm5pbmcgew0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tc3VjY2Vzcy1jb2xvcik7DQogICAgYW5pbWF0aW9uOiBwdWxzZSAycyBpbmZpbml0ZQ0KICAgIH0NCi8qIFdhaXRpbmcgZm9yIElucHV0cyBTdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS53YWl0aW5nLWlucHV0cyB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS13YXJuaW5nLWNvbG9yKTsNCiAgICBhbmltYXRpb246IHdhaXRpbmctcHVsc2UgMnMgaW5maW5pdGUNCiAgICB9DQovKiBDb21wbGV0ZWQgU3RhdGUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUuY29tcGxldGVkIHsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXN1Y2Nlc3MtY29sb3IpDQogICAgfQ0KLyogRXJyb3IgU3RhdGUgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUuZXJyb3Igew0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpDQogICAgfQ0KQGtleWZyYW1lcyBwdWxzZSB7DQogICAgMCUgew0KICAgICAgICBib3gtc2hhZG93OiAwIDAgMCAwIHJnYmEodmFyKC0tc3VjY2Vzcy1jb2xvci1yZ2IpLCAwLjQpOw0KICAgICAgICB9IDcwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDEwcHggcmdiYSh2YXIoLS1zdWNjZXNzLWNvbG9yLXJnYiksIDApOw0KICAgICAgICB9IDEwMCUgew0KICAgICAgICBib3gtc2hhZG93OiAwIDAgMCAwIHJnYmEodmFyKC0tc3VjY2Vzcy1jb2xvci1yZ2IpLCAwKTsNCiAgICAgICAgfQ0KICAgIH0NCkBrZXlmcmFtZXMgd2FpdGluZy1wdWxzZSB7DQogICAgMCUgew0KICAgICAgICBib3gtc2hhZG93OiAwIDAgMCAwIHJnYmEodmFyKC0td2FybmluZy1jb2xvci1yZ2IpLCAwLjQpOw0KICAgICAgICB9IDcwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDEwcHggcmdiYSh2YXIoLS13YXJuaW5nLWNvbG9yLXJnYiksIDApOw0KICAgICAgICB9IDEwMCUgew0KICAgICAgICBib3gtc2hhZG93OiAwIDAgMCAwIHJnYmEodmFyKC0td2FybmluZy1jb2xvci1yZ2IpLCAwKTsNCiAgICAgICAgfQ0KICAgIH0NCi8qID09PT09IFN0eWxlOiBjc3MvY29tcG9uZW50cy5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIFVJIENvbXBvbmVudHMgKi8NCi8qIE5vZGUgQ2F0ZWdvcnkgVG9vbGJveCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm5vZGUtY2F0ZWdvcnkgew0KICAgIG1hcmdpbi1ib3R0b206IDIwcHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubm9kZS1jYXRlZ29yeSBoNSB7DQogICAgbWFyZ2luOiAwIDAgMTBweCAwOw0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOw0KICAgIGxldHRlci1zcGFjaW5nOiAwLjVweDsNCiAgICBwYWRkaW5nOiAwIDVweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LW5vZGUtYnRuIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxMHB4Ow0KICAgIHBhZGRpbmc6IDEycHggMTVweDsNCiAgICBtYXJnaW4tYm90dG9tOiA1cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgY3Vyc29yOiBncmFiOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQogICAgdGV4dC1hbGlnbjogbGVmdDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtbm9kZS1idG46aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRleSgtMXB4KTsNCiAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjEpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtbm9kZS1idG46YWN0aXZlIHsNCiAgICBjdXJzb3I6IGdyYWJiaW5nOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRleSgwKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LW5vZGUtYnRuIGkgew0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICB3aWR0aDogMjBweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudG9vbGJveC1ub2RlLWJ0biBzcGFuIHsNCiAgICBmbGV4OiAxOw0KICAgIGZvbnQtd2VpZ2h0OiA1MDANCiAgICB9DQovKiBCdXR0b25zICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4gew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDZweDsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOw0KICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0bjpob3ZlciB7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KC0xcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4tb3V0bGluZS1kYW5nZXIgew0KICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuLW91dGxpbmUtZGFuZ2VyOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuLW91dGxpbmUtc2Vjb25kYXJ5IHsNCiAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0bi1vdXRsaW5lLXNlY29uZGFyeTpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcikNCiAgICB9DQovKiBDb25maWd1cmF0aW9uIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1ncm91cCB7DQogICAgbWFyZ2luLWJvdHRvbTogMTVweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgbGFiZWwgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgIG1hcmdpbi1ib3R0b206IDVweDsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWdyb3VwIGlucHV0IHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHRyYW5zaXRpb246IGJvcmRlci1jb2xvciAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWdyb3VwIHNlbGVjdCB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICBjdXJzb3I6IHBvaW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWdyb3VwIGlucHV0OmZvY3VzIHsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeS1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWdyb3VwIHNlbGVjdDpmb2N1cyB7DQogICAgb3V0bGluZTogbm9uZTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAyMTIsIDI1NSwgMC4wNSkNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLWdyb3VwIHNlbGVjdCBvcHRpb24gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmcpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBwYWRkaW5nOiA4cHggMTJweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctZ3JvdXAgc2VsZWN0IG9wdGlvbjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1ncm91cCB0ZXh0YXJlYSB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICByZXNpemU6IHZlcnRpY2FsOw0KICAgIG1pbi1oZWlnaHQ6IDgwcHg7DQogICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZQ0KICAgIH0NCi8qIFRhZyBQYW5lbCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gI3RhZy1wYW5lbCB7DQogICAgbWFyZ2luLXRvcDogMjBweDsNCiAgICBwYWRkaW5nLXRvcDogMjBweDsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdICN0YWctcGFuZWwgaDUgew0KICAgIG1hcmdpbjogMCAwIDE1cHggMDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxMHB4Ow0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIG1hcmdpbi1ib3R0b206IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbTpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeS1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWNvbG9yIHsNCiAgICB3aWR0aDogMTJweDsNCiAgICBoZWlnaHQ6IDEycHg7DQogICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgIGZsZXgtc2hyaW5rOiAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pbmZvIHsNCiAgICBmbGV4OiAxOw0KICAgIG1pbi13aWR0aDogMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctbmFtZSB7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICBmb250LXNpemU6IDEzcHg7DQogICAgbWFyZ2luLWJvdHRvbTogMnB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1kZXNjcmlwdGlvbiB7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIG9wYWNpdHk6IDAuNw0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctZGVsZXRlIHsNCiAgICBiYWNrZ3JvdW5kOiBub25lOw0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBjb2xvcjogaW5oZXJpdDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgcGFkZGluZzogNHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBvcGFjaXR5OiAwLjY7DQogICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjJzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWRlbGV0ZTpob3ZlciB7DQogICAgb3BhY2l0eTogMTsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSkNCiAgICB9DQovKiBPdXRwdXQgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZXhlY3V0aW9uLW91dHB1dCB7DQogICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDEzcHg7DQogICAgbGluZS1oZWlnaHQ6IDEuNDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZXhlY3V0aW9uLW91dHB1dCAubG9nLWVudHJ5IHsNCiAgICBtYXJnaW4tYm90dG9tOiA1cHg7DQogICAgcGFkZGluZzogNHB4IDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZXhlY3V0aW9uLW91dHB1dCAubG9nLWVudHJ5LmluZm8gew0KICAgIGNvbG9yOiB2YXIoLS1pbmZvLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leGVjdXRpb24tb3V0cHV0IC5sb2ctZW50cnkuc3VjY2VzcyB7DQogICAgY29sb3I6IHZhcigtLXN1Y2Nlc3MtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmV4ZWN1dGlvbi1vdXRwdXQgLmxvZy1lbnRyeS5lcnJvciB7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leGVjdXRpb24tb3V0cHV0IC5sb2ctZW50cnkud2FybmluZyB7DQogICAgY29sb3I6IHZhcigtLXdhcm5pbmctY29sb3IpDQogICAgfQ0KLyogSW5wdXQvT3V0cHV0IE1hcHBpbmdzIENvbmZpZ3VyYXRpb24gU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZ3MtY29uZmlnLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmdzLWNvbmZpZyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIG1hcmdpbi10b3A6IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5nLWNvbmZpZywgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm91dHB1dC1tYXBwaW5nLWNvbmZpZyB7DQogICAgbWFyZ2luLWJvdHRvbTogOHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiAzcHg7DQogICAgYm9yZGVyLWxlZnQ6IDNweCBzb2xpZCB2YXIoLS1wcmltYXJ5LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5nLWNvbmZpZzpsYXN0LWNoaWxkLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAub3V0cHV0LW1hcHBpbmctY29uZmlnOmxhc3QtY2hpbGQgew0KICAgIG1hcmdpbi1ib3R0b206IDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZy1jb25maWcgbGFiZWwsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5vdXRwdXQtbWFwcGluZy1jb25maWcgbGFiZWwgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBtYXJnaW4tYm90dG9tOiA0cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZy1zZWxlY3QsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5vdXRwdXQtbWFwcGluZy1zZWxlY3QsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC10YXJnZXQtc2VsZWN0IHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOw0KICAgIGN1cnNvcjogcG9pbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC1tYXBwaW5nLXNlbGVjdDpmb2N1cywgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm91dHB1dC1tYXBwaW5nLXNlbGVjdDpmb2N1cywgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LXRhcmdldC1zZWxlY3Q6Zm9jdXMgew0KICAgIG91dGxpbmU6IG5vbmU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMjEyLCAyNTUsIDAuMDUpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmctc2VsZWN0IG9wdGlvbiwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm91dHB1dC1tYXBwaW5nLXNlbGVjdCBvcHRpb24sIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC10YXJnZXQtc2VsZWN0IG9wdGlvbiB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmctc2VsZWN0IG9wdGlvbjpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm91dHB1dC1tYXBwaW5nLXNlbGVjdCBvcHRpb246aG92ZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbnB1dC10YXJnZXQtc2VsZWN0IG9wdGlvbjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpDQogICAgfQ0KLyogTGVnYWN5IHN0eWxlcyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmdzIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgbWFyZ2luLXRvcDogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmcgew0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgbWFyZ2luLWJvdHRvbTogNHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBib3JkZXItcmFkaXVzOiAzcHg7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW5wdXQtbWFwcGluZzpsYXN0LWNoaWxkIHsNCiAgICBtYXJnaW4tYm90dG9tOiAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmcgLnNvdXJjZS1ub2RlIHsNCiAgICBmb250LXdlaWdodDogNjAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmlucHV0LW1hcHBpbmcgLnNvdXJjZS1wb3J0IHsNCiAgICBvcGFjaXR5OiAwLjg7DQogICAgZm9udC1zdHlsZTogaXRhbGljDQogICAgfQ0KLyogQ29sbGFwc2libGUgQ29uZmlndXJhdGlvbiBTZWN0aW9ucyAtIFVzaW5nIGV4aXN0aW5nIE9TIHRoZW1lICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLXNlY3Rpb24gew0KICAgIG1hcmdpbi1ib3R0b206IDE1cHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbi1oZWFkZXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweDsNCiAgICBwYWRkaW5nOiAxMnB4IDE1cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQogICAgdXNlci1zZWxlY3Q6IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLXNlY3Rpb24taGVhZGVyOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ib3JkZXItY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1zZWN0aW9uLWhlYWRlci5jb2xsYXBzZWQgew0KICAgIGJvcmRlci1ib3R0b206IG5vbmUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLXNlY3Rpb24taGVhZGVyIGkgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbi1oZWFkZXIgc3BhbiB7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZm9udC1zaXplOiAxNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1jb3VudCB7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICBmb250LXdlaWdodDogbm9ybWFsOw0KICAgIG1hcmdpbi1sZWZ0OiBhdXRvDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1zZWN0aW9uLWNvbnRlbnQgew0KICAgIHBhZGRpbmc6IDE1cHg7DQogICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLXNlY3Rpb24taGVhZGVyLmNvbGxhcHNlZCArIC5jb25maWctc2VjdGlvbi1jb250ZW50IHsNCiAgICBib3JkZXItdG9wOiBub25lDQogICAgfQ0KLyogQWRqdXN0IGV4aXN0aW5nIGNvbmZpZyBncm91cHMgd2l0aGluIHNlY3Rpb25zICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlnLXNlY3Rpb24gLmNvbmZpZy1ncm91cCB7DQogICAgbWFyZ2luLWJvdHRvbTogMTJweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctc2VjdGlvbiAuY29uZmlnLWdyb3VwOmxhc3QtY2hpbGQgew0KICAgIG1hcmdpbi1ib3R0b206IDANCiAgICB9DQovKiA9PT09PSBTdHlsZTogY3NzL25vZGUtdHlwZXMuY3NzID09PT09ICovDQovKiBGbG93IEVkaXRvciBOb2RlIFR5cGUgU3BlY2lmaWMgU3R5bGVzICovDQovKiBEaXNwbGF5IE5vZGUgQ29udGVudCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmRpc3BsYXktY29udGVudCB7DQogICAgcGFkZGluZzogOHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmRpc3BsYXktdGV4dCB7DQogICAgbWluLWhlaWdodDogNDBweDsNCiAgICBtYXgtaGVpZ2h0OiAyMDBweDsNCiAgICB3aWR0aDogMjIwcHg7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuMDUpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgbWFyZ2luLWJvdHRvbTogOHB4Ow0KICAgIHJlc2l6ZTogbm9uZTsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmRpc3BsYXktdGV4dCBwcmUgew0KICAgIG1hcmdpbjogMDsNCiAgICBmb250LWZhbWlseTogbW9ub3NwYWNlOw0KICAgIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsNCiAgICB3b3JkLWJyZWFrOiBicmVhay13b3JkOw0KICAgIHVzZXItc2VsZWN0OiB0ZXh0DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmRpc3BsYXktZm9ybWF0IHsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKQ0KICAgIH0NCi8qIEF1ZGlvIFBsYXllciBTdHlsZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hdWRpby1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogMTBweDsNCiAgICBtYXJnaW4tdG9wOiAxMHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuMDUpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hdWRpby1wbGF5LWJ0biwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmF1ZGlvLXN0b3AtYnRuIHsNCiAgICB3aWR0aDogMzJweDsNCiAgICBoZWlnaHQ6IDMycHg7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmF1ZGlvLXBsYXktYnRuIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXVkaW8tc3RvcC1idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXVkaW8tcGxheS1idG46aG92ZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hdWRpby1zdG9wLWJ0bjpob3ZlciB7DQogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuYXVkaW8tc3RhdHVzIHsNCiAgICBmbGV4OiAxOw0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgdGV4dC1hbGlnbjogY2VudGVyDQogICAgfQ0KLyogSlNPTiBFeHRyYWN0IERpc3BsYXkgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5qc29uLWV4dHJhY3QtZGlzcGxheSB7DQogICAgbWFyZ2luLXRvcDogMTBweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZXh0cmFjdC1sYWJlbCB7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICBtYXJnaW4tYm90dG9tOiA0cHg7DQogICAgZm9udC13ZWlnaHQ6IDUwMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leHRyYWN0LXZhbHVlIHsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgd29yZC1icmVhazogYnJlYWstYWxsOw0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogM3B4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZXh0cmFjdC12YWx1ZS5zdWNjZXNzIHsNCiAgICBjb2xvcjogdmFyKC0tc3VjY2Vzcy1jb2xvcik7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1zdWNjZXNzLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5leHRyYWN0LXZhbHVlLmVycm9yIHsNCiAgICBjb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpDQogICAgfQ0KLyogUmVwZWF0ZXIgTm9kZSBTdHlsZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5yZXBlYXRlci1jb250ZW50IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweDsNCiAgICBwYWRkaW5nOiA4cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAucmVwZWF0ZXItc3RhdHVzIHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgbWluLXdpZHRoOiA4MHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0YXR1cy5zdG9wcGVkIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuMSk7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnJlcGVhdGVyLXN0YXR1cy5ydW5uaW5nIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgYW5pbWF0aW9uOiBwdWxzZSAycyBpbmZpbml0ZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5yZXBlYXRlci1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDhweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5yZXBlYXRlci1zdGFydC1idG4sIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5yZXBlYXRlci1zdG9wLWJ0biB7DQogICAgd2lkdGg6IDI4cHg7DQogICAgaGVpZ2h0OiAyOHB4Ow0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5yZXBlYXRlci1zdGFydC1idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1Y2Nlc3MtY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5yZXBlYXRlci1zdG9wLWJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5yZXBlYXRlci1zdGFydC1idG46aG92ZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5yZXBlYXRlci1zdG9wLWJ0bjpob3ZlciB7DQogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMikNCiAgICB9DQovKiBJbWFnZSBOb2RlIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLWNvbnRhaW5lciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHg7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIG1pbi1oZWlnaHQ6IDEyMHB4Ow0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLXRodW1ibmFpbCB7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgb2JqZWN0LWZpdDogY29udGFpbjsNCiAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLXRodW1ibmFpbDpob3ZlciB7DQogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjA1KTsNCiAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjIpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLWluZm8gew0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBib3JkZXItcmFkaXVzOiAzcHg7DQogICAgd2lkdGg6IDEwMCUNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuaW1hZ2UtZXJyb3Igew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogNHB4Ow0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgdGV4dC1hbGlnbjogY2VudGVyDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLWVycm9yIGkgew0KICAgIGZvbnQtc2l6ZTogMTZweA0KICAgIH0NCi8qIEltYWdlIE1vZGFsIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLW1vZGFsIHsNCiAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgdG9wOiAwOw0KICAgIGxlZnQ6IDA7DQogICAgd2lkdGg6IDEwMCU7DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC44KTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgei1pbmRleDogMTAwMDsNCiAgICBwYWRkaW5nOiAyMHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLW1vZGFsLWNvbnRlbnQgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBtYXgtd2lkdGg6IDkwJTsNCiAgICBtYXgtaGVpZ2h0OiA5MCU7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBib3gtc2hhZG93OiAwIDRweCAyMHB4IHJnYmEoMCwgMCwgMCwgMC4zKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbWFnZS1tb2RhbC1oZWFkZXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgcGFkZGluZzogMTVweCAyMHB4Ow0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLW1vZGFsLWhlYWRlciBzcGFuIHsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5pbWFnZS1tb2RhbC1jbG9zZSB7DQogICAgYmFja2dyb3VuZDogbm9uZTsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgZm9udC1zaXplOiAyNHB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgcGFkZGluZzogMDsNCiAgICB3aWR0aDogMzBweDsNCiAgICBoZWlnaHQ6IDMwcHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLW1vZGFsLWNsb3NlOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuMSk7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLW1vZGFsLWJvZHkgew0KICAgIHBhZGRpbmc6IDIwcHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxNXB4Ow0KICAgIG1heC1oZWlnaHQ6IGNhbGMoOTB2aCAtIDEwMHB4KTsNCiAgICBvdmVyZmxvdy15OiBhdXRvDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLW1vZGFsLWltYWdlIHsNCiAgICBtYXgtd2lkdGg6IDEwMCU7DQogICAgbWF4LWhlaWdodDogNzB2aDsNCiAgICBvYmplY3QtZml0OiBjb250YWluOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjEpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmltYWdlLW1vZGFsLWluZm8gew0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHdpZHRoOiAxMDAlDQogICAgfQ0KLyogUmFuZG9tIFF1b3RlIE5vZGUgU3R5bGVzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAucXVvdGUtY29udGVudCB7DQogICAgcGFkZGluZzogMTBweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXINCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAucXVvdGUtdGV4dCB7DQogICAgbWFyZ2luLWJvdHRvbTogOHB4Ow0KICAgIG1pbi1oZWlnaHQ6IDQwcHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnF1b3RlLWRpc3BsYXkgew0KICAgIG1hcmdpbjogMDsNCiAgICBmb250LXN0eWxlOiBpdGFsaWM7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIGZvbnQtc2l6ZTogMTNweDsNCiAgICBsaW5lLWhlaWdodDogMS40Ow0KICAgIG1heC13aWR0aDogMTAwJTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAucXVvdGUtaW5mbyB7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBwYWRkaW5nLXRvcDogOHB4DQogICAgfQ0KLyogTExNIENoYXQgTm9kZSBTdHlsZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5sbG0tcmVzcG9uc2Ugew0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDIzLCAxNjIsIDE4NCwgMC4xKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgbWFyZ2luOiA0cHggMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5yZXNwb25zZS1wcmV2aWV3IHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgbGluZS1oZWlnaHQ6IDEuMzsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgd29yZC13cmFwOiBicmVhay13b3JkOw0KICAgIG1hcmdpbi1ib3R0b206IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC51c2FnZS1pbmZvIHsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMSk7DQogICAgcGFkZGluZy10b3A6IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5sbG0tZXJyb3Igew0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDIyMCwgNTMsIDY5LCAwLjEpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBtYXJnaW46IDRweCAwOw0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDZweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5sbG0tZXJyb3IgaSB7DQogICAgZm9udC1zaXplOiAxNHB4DQogICAgfQ0KLyogVGV4dCBOb2RlIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRleHQtY29udGVudCB7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMTA4LCAxMTcsIDEyNSwgMC4xKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgbWFyZ2luOiA0cHggMA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50ZXh0LXByZXZpZXcgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBsaW5lLWhlaWdodDogMS4zOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgbWFyZ2luLWJvdHRvbTogNHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRleHQtaW5mbyB7DQogICAgZm9udC1zaXplOiAxMHB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgcmdiYSgwLCAwLCAwLCAwLjEpOw0KICAgIHBhZGRpbmctdG9wOiA0cHgNCiAgICB9DQovKiBOb2RlIFN0YXR1cyBEaXNwbGF5ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubm9kZS1zdGF0dXMgew0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuMDUpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBtYXJnaW46IDRweCAwOw0KICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5zdGF0dXMtdGV4dCB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIG1hcmdpbi1ib3R0b206IDRweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5zdGF0dXMtaW5mbyB7DQogICAgZm9udC1zaXplOiAxMHB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKQ0KICAgIH0NCi8qIENvbnRlbnQgRGlzcGxheSBpbiBDb25maWcgUGFuZWwgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb250ZW50LWRpc3BsYXkgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHBhZGRpbmc6IDEycHg7DQogICAgbWFyZ2luLXRvcDogOHB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbnRlbnQtdGV4dCB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjQ7DQogICAgd2hpdGUtc3BhY2U6IHByZS13cmFwOw0KICAgIHdvcmQtYnJlYWs6IGJyZWFrLXdvcmQ7DQogICAgbWF4LWhlaWdodDogMzAwcHg7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgdXNlci1zZWxlY3Q6IHRleHQNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29udGVudC1pbmZvIHsNCiAgICBtYXJnaW4tdG9wOiA4cHg7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXINCiAgICB9DQovKiBUZXJtaW5hbCBOb2RlIFN0eWxlcyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRlcm1pbmFsLWVycm9yIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgyMjAsIDUzLCA2OSwgMC4xKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIG1hcmdpbi10b3A6IDhweA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50ZXJtaW5hbC1lcnJvciBpIHsNCiAgICBtYXJnaW4tcmlnaHQ6IDhweDsNCiAgICBjb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpDQogICAgfQ0KLyogPT09PT0gU3R5bGU6IGNzcy9yZXNwb25zaXZlLmNzcyA9PT09PSAqLw0KLyogRmxvdyBFZGl0b3IgUmVzcG9uc2l2ZSBEZXNpZ24gJiBFZmZlY3RzICovDQovKiBIYW1idXJnZXIgTWVudSBTdHlsZXMgLSBBbHdheXMgdmlzaWJsZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmhhbWJ1cmdlci1idG4gew0KICAgIHBhZGRpbmc6IDhweCAxMnB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmRyb3Bkb3duLW1lbnUgew0KICAgIGRpc3BsYXk6IG5vbmU7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjIpOw0KICAgIHotaW5kZXg6IDk5OTk7DQogICAgbWluLXdpZHRoOiAxODBweDsNCiAgICB3aWR0aDogMTgwcHg7DQogICAgbWF4LWhlaWdodDogNzB2aDsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIHBhZGRpbmc6IDA7DQogICAgbWFyZ2luOiAwDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmRyb3Bkb3duLW1lbnUuc2hvdyB7DQogICAgZGlzcGxheTogYmxvY2sgIWltcG9ydGFudA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5tZW51LXNlY3Rpb24gew0KICAgIHBhZGRpbmc6IDhweCAwOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm1lbnUtc2VjdGlvbjpsYXN0LWNoaWxkIHsNCiAgICBib3JkZXItYm90dG9tOiBub25lDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm1lbnUtc2VjdGlvbi10aXRsZSB7DQogICAgcGFkZGluZzogOHB4IDE2cHg7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7DQogICAgbGV0dGVyLXNwYWNpbmc6IDAuNXB4DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm1lbnUtaXRlbSB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogMTBweDsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nOiAxMHB4IDE2cHg7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQgMC4ycyBlYXNlOw0KICAgIHRleHQtYWxpZ246IGxlZnQNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS1pdGVtOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ib3JkZXItY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm1lbnUtaXRlbS5kYW5nZXIgew0KICAgIGNvbG9yOiAjZmY2YjZiDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLm1lbnUtaXRlbS5kYW5nZXI6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAxMDcsIDEwNywgMC4xKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5tZW51LXpvb20tY29udHJvbHMgew0KICAgIHBhZGRpbmc6IDAgMTZweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgZ2FwOiA0cHgNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubWVudS16b29tLWxldmVsIHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIHBhZGRpbmc6IDRweCAwOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG1hcmdpbjogNHB4IDANCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuem9vbS1idG4gew0KICAgIHBhZGRpbmc6IDZweCAxMnB4ICFpbXBvcnRhbnQ7DQogICAgZm9udC1zaXplOiAxMnB4ICFpbXBvcnRhbnQNCiAgICB9DQovKiBSZXNwb25zaXZlIERlc2lnbiAqLw0KQG1lZGlhIChtYXgtd2lkdGg6IDEyMDBweCkgew0KICAgIC5mbG93LWVkaXRvciB7DQogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICAgIG1pbi1oZWlnaHQ6IDANCiAgICAgICAgfQ0KICAgIC5mbG93LXRvb2xib3ggew0KICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgaGVpZ2h0OiBhdXRvOw0KICAgICAgICBib3JkZXItcmlnaHQ6IG5vbmU7DQogICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgICAgICBmbGV4LXNocmluazogMDsNCiAgICAgICAgbWF4LWhlaWdodDogMjAwcHgNCiAgICAgICAgfQ0KICAgIC50b29sYm94LWNvbnRlbnQgew0KICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICBmbGV4LXdyYXA6IHdyYXA7DQogICAgICAgIGdhcDogMTBweDsNCiAgICAgICAgcGFkZGluZzogMTVweDsNCiAgICAgICAgb3ZlcmZsb3cteTogYXV0bw0KICAgICAgICB9DQogICAgLm5vZGUtY2F0ZWdvcnkgew0KICAgICAgICBtYXJnaW4tYm90dG9tOiAwOw0KICAgICAgICBmbGV4OiAxOw0KICAgICAgICBtaW4td2lkdGg6IDIwMHB4DQogICAgICAgIH0NCiAgICAuZmxvdy13b3Jrc3BhY2Ugew0KICAgICAgICBmbGV4OiAxOw0KICAgICAgICBtaW4taGVpZ2h0OiAwDQogICAgICAgIH0NCiAgICAuZmxvdy1jb25maWctcGFuZWwgew0KICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgYm9yZGVyLWxlZnQ6IG5vbmU7DQogICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgICAgICBmbGV4LXNocmluazogMDsNCiAgICAgICAgbWF4LWhlaWdodDogMzAwcHgNCiAgICAgICAgfQ0KICAgIC5mbG93LW91dHB1dC1wYW5lbCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDIwMHB4DQogICAgICAgIH0NCiAgICAub3V0cHV0LWNvbnRlbnQgew0KICAgICAgICBtYXgtaGVpZ2h0OiAxNTBweA0KICAgICAgICB9DQogICAgfQ0KQG1lZGlhIChtYXgtd2lkdGg6IDc2OHB4KSB7DQogICAgLmFwcC1jb250ZW50IHsNCiAgICAgICAgcGFkZGluZzogNXB4Ow0KICAgICAgICBnYXA6IDVweA0KICAgICAgICB9DQogICAgLmZsb3ctdG9vbGJhciB7DQogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICAgIGdhcDogMTBweDsNCiAgICAgICAgcGFkZGluZzogOHB4IDE1cHgNCiAgICAgICAgfQ0KICAgIC50b29sYmFyLWxlZnQsIC50b29sYmFyLXJpZ2h0IHsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgICAgICBmbGV4LXdyYXA6IHdyYXANCiAgICAgICAgfQ0KICAgIC5mbG93LXRvb2xiYXIgLmJ0biB7DQogICAgICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICAgICAgcGFkZGluZzogNnB4IDEwcHgNCiAgICAgICAgfQ0KICAgIC5mbG93LXRvb2xib3ggew0KICAgICAgICBtYXgtaGVpZ2h0OiAxNTBweA0KICAgICAgICB9DQogICAgLmZsb3ctY29uZmlnLXBhbmVsIHsNCiAgICAgICAgbWF4LWhlaWdodDogMjUwcHgNCiAgICAgICAgfQ0KICAgIC5mbG93LW91dHB1dC1wYW5lbCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4DQogICAgICAgIH0NCiAgICAub3V0cHV0LWNvbnRlbnQgew0KICAgICAgICBtYXgtaGVpZ2h0OiAxMDBweDsNCiAgICAgICAgcGFkZGluZzogMTBweA0KICAgICAgICB9DQogICAgfQ0KQG1lZGlhIChtYXgtd2lkdGg6IDQ4MHB4KSB7DQogICAgLnRvb2xiYXItbGVmdCwgLnRvb2xiYXItcmlnaHQgew0KICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgICAgICBnYXA6IDVweDsNCiAgICAgICAgYWxpZ24taXRlbXM6IHN0cmV0Y2gNCiAgICAgICAgfQ0KICAgIC5mbG93LXRvb2xiYXIgLmJ0biB7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXINCiAgICAgICAgfQ0KICAgIC56b29tLWNvbnRyb2xzIHsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXINCiAgICAgICAgfQ0KICAgIH0NCi8qID09PT09IFN0eWxlOiBjc3MvcGVyZm9ybWFuY2UuY3NzID09PT09ICovDQovKiBQZXJmb3JtYW5jZSBvcHRpbWl6YXRpb25zIGFuZCBhbnRpLWZsYXNoaW5nIG1lYXN1cmVzIGZvciBGbG93IEVkaXRvciAqLw0KLyogUHJldmVudCB2aXN1YWwgYXJ0aWZhY3RzIGR1cmluZyBmdWxsc2NyZWVuIHRyYW5zaXRpb25zIGFuZCBzY2FsaW5nICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubm8tdHJhbnNpdGlvbnMgKiB7DQogICAgdHJhbnNpdGlvbjogbm9uZSAhaW1wb3J0YW50Ow0KICAgIGFuaW1hdGlvbjogbm9uZSAhaW1wb3J0YW50DQogICAgfQ0KLyogSW1wcm92ZSBvdmVyYWxsIHJlbmRlcmluZyBwZXJmb3JtYW5jZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctZWRpdG9yICogew0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3gNCiAgICB9DQovKiBSZWR1Y2UgbGF5b3V0IHRocmFzaGluZyBkdXJpbmcgem9vbSBvcGVyYXRpb25zICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jYW52YXMsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbm5lY3Rpb24gew0KICAgIGNvbnRhaW46IGxheW91dCBzdHlsZSBwYWludA0KICAgIH0NCi8qIE9wdGltaXplIGZvciBoYXJkd2FyZSBhY2NlbGVyYXRpb24gLSBidXQgYXZvaWQgbm9kZXMgdG8gcHJldmVudCB0ZXh0IGJsdXIgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNhbnZhcywgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29ubmVjdGlvbiB7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV6KDApDQogICAgfQ0KLyogUmVtb3ZlZCBoYXJkd2FyZSBhY2NlbGVyYXRpb24gZnJvbSBub2RlcyAtIGNhdXNlcyB0ZXh0IGJsdXIgKi8NCi8qIFVzZSBicm93c2VyIGRlZmF1bHQgZm9udCByZW5kZXJpbmcgLSByZW1vdmVkIG92ZXJyaWRlcyB0aGF0IGNhdXNlIGJsdXIgKi8NCi8qIFJlZHVjZSBwYWludCBjb21wbGV4aXR5IGR1cmluZyB6b29tICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlOm5vdCg6aG92ZXIpOm5vdCguc2VsZWN0ZWQpIHsNCiAgICB3aWxsLWNoYW5nZTogYXV0bw0KICAgIH0NCi8qIE9ubHkgZW5hYmxlIHdpbGwtY2hhbmdlIHdoZW4gYWN0dWFsbHkgbmVlZGVkICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlOmhvdmVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLnNlbGVjdGVkLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLmRyYWdnaW5nIHsNCiAgICB3aWxsLWNoYW5nZTogdHJhbnNmb3JtDQogICAgfQ0KLyogSW1wcm92ZSBwZXJmb3JtYW5jZSBvZiBhbmltYXRpb25zICovDQpAbWVkaWEgKHByZWZlcnMtcmVkdWNlZC1tb3Rpb246IHJlZHVjZSkgew0KICAgIC5mbG93LW5vZGUsIC5mbG93LWNvbm5lY3Rpb24tbGluZSB7DQogICAgICAgIHRyYW5zaXRpb246IG5vbmUgIWltcG9ydGFudDsNCiAgICAgICAgYW5pbWF0aW9uOiBub25lICFpbXBvcnRhbnQNCiAgICAgICAgfQ0KICAgIH0NCi8qIEZvcmNlIGNvbXBvc2l0aW5nIGxheWVyIGZvciBzbW9vdGhlciB0cmFuc2Zvcm1zIGR1cmluZyB6b29tICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jYW52YXMuem9vbWluZyB7DQogICAgd2lsbC1jaGFuZ2U6IHRyYW5zZm9ybTsNCiAgICB0cmFuc2Zvcm0tc3R5bGU6IHByZXNlcnZlLTNkDQogICAgfQ0KLyogUmVtb3ZlIGNvbXBvc2l0aW5nIGxheWVyIHdoZW4gbm90IHpvb21pbmcgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNhbnZhczpub3QoLnpvb21pbmcpIHsNCiAgICB3aWxsLWNoYW5nZTogYXV0bw0KICAgIH0NCi8qID09PT09IFN0eWxlOiBjc3Mvb3MtdGhlbWUuY3NzID09PT09ICovDQovKiBGbG93IEVkaXRvciAtIFN5cG5leE9TIFRoZW1lIEludGVncmF0aW9uICovDQovKiBUaGlzIGZpbGUgZW5zdXJlcyB0aGUgZmxvdyBlZGl0b3IgbWF0Y2hlcyB0aGUgT1MgYWVzdGhldGljIHBlcmZlY3RseSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gew0KICAgIC8qIE92ZXJyaWRlIGZsb3cgZWRpdG9yIHZhcmlhYmxlcyB3aXRoIE9TIHZhcmlhYmxlcyAqLw0KICAgIC0tc3VyZmFjZS1jb2xvcjogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIC0tYm9yZGVyLWNvbG9yOiB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIC0tdGV4dC1jb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsNCiAgICAtLXRleHQtbXV0ZWQ6IHZhcigtLXRleHQtc2Vjb25kYXJ5KTsNCiAgICAtLXByaW1hcnktY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgLS1wcmltYXJ5LWNvbG9yLXJnYjogMCwgMjEyLCAyNTU7DQogICAgLS1lcnJvci1jb2xvcjogI2ZmNDc1NzsNCiAgICAtLXN1Y2Nlc3MtY29sb3I6ICMyZWQ1NzM7DQogICAgLS13YXJuaW5nLWNvbG9yOiAjZmZhNTAyDQogICAgfQ0KLyogRW5oYW5jZWQgZ2xhc3MgbW9ycGhpc20gZm9yIGZsb3cgZWRpdG9yICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1lZGl0b3Igew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDEycHg7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgOHB4IDMycHggcmdiYSgwLCAwLCAwLCAwLjMpDQogICAgfQ0KLyogVG9vbGJveCB3aXRoIGJldHRlciBnbGFzcyBlZmZlY3QgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xib3ggew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjYsIDI2LCAyNiwgMC45KTsNCiAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxNXB4KQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50b29sYm94LWhlYWRlciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgxMCwgMTAsIDEwLCAwLjgpOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtaGVhZGVyIGg0IHsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICB0ZXh0LXNoYWRvdzogMCAwIDEwcHggcmdiYSgwLCAyMTIsIDI1NSwgMC4zKQ0KICAgIH0NCi8qIEVuaGFuY2VkIG5vZGUgc3R5bGluZyB3aXRoIGdsYXNzIG1vcnBoaXNtICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3JkZXItcmFkaXVzOiAxMnB4Ow0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KTsNCiAgICBib3gtc2hhZG93OiAwIDRweCAyMHB4IHJnYmEoMCwgMCwgMCwgMC4yKTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZTpob3ZlciB7DQogICAgYm94LXNoYWRvdzogMCA4cHggMzJweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjIpOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRleSgtMnB4KTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLnNlbGVjdGVkIHsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgYm94LXNoYWRvdzogMCAwIDAgM3B4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMyk7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAyMTIsIDI1NSwgMC4wNSkNCiAgICB9DQovKiBOb2RlIHBvcnRzIHdpdGggbmVvbiBnbG93ICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1ub2RlLXBvcnQgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJveC1zaGFkb3c6IDAgMCAxMHB4IHJnYmEoMCwgMCwgMCwgMC41KTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS1wb3J0OmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBib3gtc2hhZG93OiAwIDAgMTVweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjgpOw0KICAgIHRyYW5zZm9ybTogc2NhbGUoMS4zKQ0KICAgIH0NCi8qIENvbm5lY3Rpb24gbGluZXMgd2l0aCBuZW9uIGVmZmVjdCAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29ubmVjdGlvbi1saW5lIHsNCiAgICBzdHJva2U6IHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgc3Ryb2tlLXdpZHRoOiAzOw0KICAgIGZpbHRlcjogZHJvcC1zaGFkb3coMCAwIDNweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjMpKTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29ubmVjdGlvbi1saW5lOmhvdmVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25uZWN0aW9uLWxpbmUuY29ubmVjdGVkIHsNCiAgICBzdHJva2U6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgc3Ryb2tlLXdpZHRoOiA0Ow0KICAgIGZpbHRlcjogZHJvcC1zaGFkb3coMCAwIDhweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjgpKQ0KICAgIH0NCi8qIFRvb2xiYXIgd2l0aCBnbGFzcyBlZmZlY3QgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMTAsIDEwLCAxMCwgMC45KTsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTVweCkNCiAgICB9DQovKiBFbmhhbmNlZCBidXR0b24gc3R5bGluZyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtbm9kZS1idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRvb2xib3gtbm9kZS1idG46aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMjEyLCAyNTUsIDAuMSk7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRleSgtMXB4KTsNCiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMik7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcikNCiAgICB9DQovKiBGbG93IHRvb2xiYXIgYnV0dG9ucyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG46aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMjEyLCAyNTUsIDAuMSk7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRleSgtMXB4KTsNCiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMikNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10b29sYmFyIC5idG4tc3VjY2VzcyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuLXN1Y2Nlc3M6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1ob3Zlcik7DQogICAgYm94LXNoYWRvdzogMCA0cHggMjBweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjQpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdG9vbGJhciAuYnRuLWRhbmdlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRvb2xiYXIgLmJ0bi1kYW5nZXI6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6ICNmZjM3NDI7DQogICAgYm94LXNoYWRvdzogMCA0cHggMjBweCByZ2JhKDI1NSwgNzEsIDg3LCAwLjQpDQogICAgfQ0KLyogTm9kZSB0eXBlIHN0eWxpbmcgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUtdHlwZSB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICB0ZXh0LXNoYWRvdzogbm9uZTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHgNCiAgICB9DQovKiBOb2RlIGRlbGV0ZSBidXR0b24gKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5ub2RlLWRlbGV0ZS1idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMik7DQogICAgYm94LXNoYWRvdzogMCAycHggMTBweCByZ2JhKDI1NSwgNzEsIDg3LCAwLjMpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2UNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubm9kZS1kZWxldGUtYnRuOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiAjZmYzNzQyOw0KICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsNCiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMjU1LCA3MSwgODcsIDAuNSkNCiAgICB9DQovKiBDdXJyZW50IGZpbGVuYW1lIHN0eWxpbmcgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jdXJyZW50LWZpbGVuYW1lIHsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIHRleHQtc2hhZG93OiAwIDAgNXB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMykNCiAgICB9DQovKiBab29tIGNvbnRyb2xzICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuem9vbS1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBwYWRkaW5nOiA0cHg7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpDQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnpvb20tbGV2ZWwgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgbWluLXdpZHRoOiA0NXB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDEycHgNCiAgICB9DQovKiBMb2FkaW5nIHN0YXRlICovDQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAubG9hZGluZy1ub2RlcyB7DQogICAgY29sb3I6IHZhcigtLXRleHQtc2Vjb25kYXJ5KTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgcGFkZGluZzogMjBweDsNCiAgICBmb250LXN0eWxlOiBpdGFsaWMNCiAgICB9DQovKiBOb2RlIGNhdGVnb3JpZXMgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5ub2RlLWNhdGVnb3J5IGg1IHsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOw0KICAgIGxldHRlci1zcGFjaW5nOiAxcHg7DQogICAgZm9udC13ZWlnaHQ6IDcwMDsNCiAgICBmb250LXNpemU6IDExcHgNCiAgICB9DQovKiBDYW52YXMgdGFncyBhbmQgY29uZmlndXJhdGlvbiBsaXN0IHRhZ3MgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRhZywgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmFyZWEtdGFnLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0sIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jYW52YXMtdGFnIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQ7DQogICAgY29sb3I6IHZhcigtLXByaW1hcnktYmcpICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBib3gtc2hhZG93OiAwIDJweCAxMHB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMyk7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LXRhZzpob3ZlciwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmFyZWEtdGFnOmhvdmVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW06aG92ZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jYW52YXMtdGFnOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtaG92ZXIpICFpbXBvcnRhbnQ7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTVweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjUpOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRleSgtMXB4KQ0KICAgIH0NCi8qIFRhZyB0ZXh0IGFuZCBpY29ucyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctdGFnIC50YWctdGV4dCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmFyZWEtdGFnIC50YWctdGV4dCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtIC50YWctdGV4dCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNhbnZhcy10YWcgLnRhZy10ZXh0LCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy10YWcgaSwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmFyZWEtdGFnIGksIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbSBpLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY2FudmFzLXRhZyBpIHsNCiAgICBjb2xvcjogdmFyKC0tcHJpbWFyeS1iZykgIWltcG9ydGFudA0KICAgIH0NCi8qIFRhZyBpbmRpY2F0b3IgY2lyY2xlcy9kb3RzIGluIGNvbmZpZ3VyYXRpb24gYXJlYSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pbmRpY2F0b3IsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctY29sb3ItaW5kaWNhdG9yLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWNpcmNsZSwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1kb3QsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5hcmVhLXRhZy1pbmRpY2F0b3IsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctY29sb3Igew0KICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQNCiAgICB9DQovKiBUYWcgaXRlbXMgaW4gY29uZmlndXJhdGlvbiBsaXN0IC0gbWF0Y2ggbm9kZSBsaXN0IHN0eWxpbmcgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbSB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTBweCk7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KSAhaW1wb3J0YW50DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDIxMiwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQ7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGV5KC0xcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDE1cHggcmdiYSgwLCAyMTIsIDI1NSwgMC4yKQ0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbSAudGFnLW5hbWUgew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpICFpbXBvcnRhbnQNCiAgICB9DQpbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAudGFnLWl0ZW0gLnRhZy1pbmZvIHsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KSAhaW1wb3J0YW50DQogICAgfQ0KLyogVGFnIGRlbGV0ZSBidXR0b24gc3R5bGluZyAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1kZWxldGUsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbSAudGFnLWRlbGV0ZSB7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSkgIWltcG9ydGFudDsNCiAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudCAhaW1wb3J0YW50Ow0KICAgIGJvcmRlcjogbm9uZSAhaW1wb3J0YW50DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1kZWxldGU6aG92ZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbSAudGFnLWRlbGV0ZTpob3ZlciB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudA0KICAgIH0NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctZGVsZXRlIGksIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50YWctaXRlbSAudGFnLWRlbGV0ZSBpIHsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KSAhaW1wb3J0YW50DQogICAgfQ0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1kZWxldGU6aG92ZXIgaSwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLnRhZy1pdGVtIC50YWctZGVsZXRlOmhvdmVyIGkgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQNCiAgICB9DQovKiBDb25maWd1cmF0aW9uIGFyZWEgaGVhZGVyIHRleHQgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctaGVhZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuY29uZmlndXJhdGlvbi1oZWFkZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbmZpZy1oZWFkZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctcGxhY2Vob2xkZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWd1cmF0aW9uLXBsYWNlaG9sZGVyLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25maWctYXJlYSBwLCBbZGF0YS1hcHBpZD0iZmxvd19lZGl0b3IiXSAuZmxvdy1jb25maWctYXJlYSAucGxhY2Vob2xkZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbmZpZy1hcmVhIC5jb25maWctbWVzc2FnZSwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmNvbmZpZy1hcmVhIHAsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctYXJlYSAucGxhY2Vob2xkZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5jb25maWctYXJlYSAuY29uZmlnLW1lc3NhZ2UsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LWNvbmZpZ3VyYXRpb24gcCwgW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctY29uZmlndXJhdGlvbiAucGxhY2Vob2xkZXIsIFtkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC50ZXh0LW11dGVkIHsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1zZWNvbmRhcnkpICFpbXBvcnRhbnQNCiAgICB9DQovKiBSdW5uaW5nIHN0YXRlIHdpdGggcHVsc2luZyBlZmZlY3QgKi8NCltkYXRhLWFwcGlkPSJmbG93X2VkaXRvciJdIC5mbG93LW5vZGUucnVubmluZyB7DQogICAgYW5pbWF0aW9uOiBwdWxzZS1uZW9uIDJzIGluZmluaXRlOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tc3VjY2Vzcy1jb2xvcikNCiAgICB9DQpAa2V5ZnJhbWVzIHB1bHNlLW5lb24gew0KICAgIDAlLCAxMDAlIHsNCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDVweCByZ2JhKDQ2LCAyMTMsIDExNSwgMC41KTsNCiAgICAgICAgfSA1MCUgew0KICAgICAgICBib3gtc2hhZG93OiAwIDAgMjBweCByZ2JhKDQ2LCAyMTMsIDExNSwgMC44KSwgMCAwIDMwcHggcmdiYSg0NiwgMjEzLCAxMTUsIDAuNCk7DQogICAgICAgIH0NCiAgICB9DQovKiBFcnJvciBzdGF0ZSAqLw0KW2RhdGEtYXBwaWQ9ImZsb3dfZWRpdG9yIl0gLmZsb3ctbm9kZS5lcnJvciB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgYW5pbWF0aW9uOiBwdWxzZS1lcnJvci1uZW9uIDFzIGluZmluaXRlDQogICAgfQ0KQGtleWZyYW1lcyBwdWxzZS1lcnJvci1uZW9uIHsNCiAgICAwJSwgMTAwJSB7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCA1cHggcmdiYSgyNTUsIDcxLCA4NywgMC41KTsNCiAgICAgICAgfSA1MCUgew0KICAgICAgICBib3gtc2hhZG93OiAwIDAgMjBweCByZ2JhKDI1NSwgNzEsIDg3LCAwLjgpLCAwIDAgMzBweCByZ2JhKDI1NSwgNzEsIDg3LCAwLjQpOw0KICAgICAgICB9DQogICAgfQ0KLyogUmVzcG9uc2l2ZSBhZGp1c3RtZW50cyAqLw0KQG1lZGlhIChtYXgtd2lkdGg6IDc2OHB4KSB7DQogICAgLmZsb3ctdG9vbGJveCB7DQogICAgICAgIHdpZHRoOiAyMDBweA0KICAgICAgICB9DQogICAgLmZsb3ctbm9kZSB7DQogICAgICAgIG1pbi13aWR0aDogMTIwcHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTJweA0KICAgICAgICB9DQogICAgLnRvb2xib3gtbm9kZS1idG4gew0KICAgICAgICBwYWRkaW5nOiA4cHggMTBweDsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4DQogICAgICAgIH0NCiAgICB9PC9zdHlsZT48ZGl2IGNsYXNzPSJhcHAtY29udGFpbmVyIiBkYXRhLWFwcGlkPSJmbG93X2VkaXRvciI+DQo8ZGl2IGNsYXNzPSJhcHAtY29udGVudCI+DQo8ZGl2IGNsYXNzPSJmbG93LWVkaXRvciI+DQo8IS0tIExlZnQgVG9vbGJveCAtLT4NCjxkaXYgY2xhc3M9ImZsb3ctdG9vbGJveCIgaWQ9ImZsb3ctdG9vbGJveCI+DQo8ZGl2IGNsYXNzPSJ0b29sYm94LWhlYWRlciI+DQo8aDQ+PGkgY2xhc3M9ImZhcyBmYS10b29scyI+PC9pPiBOb2RlczwvaDQ+DQo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSIgaWQ9InRvZ2dsZS10b29sYm94IiB0aXRsZT0iQ29sbGFwc2UgVG9vbGJveCI+DQo8aSBjbGFzcz0iZmFzIGZhLWNoZXZyb24tbGVmdCI+PC9pPg0KPC9idXR0b24+DQo8L2Rpdj4NCjxkaXYgY2xhc3M9InRvb2xib3gtY29udGVudCIgaWQ9InRvb2xib3gtY29udGVudCI+DQo8IS0tIE5vZGVzIHdpbGwgYmUgbG9hZGVkIGR5bmFtaWNhbGx5IGZyb20gVkZTIC0tPg0KPGRpdiBjbGFzcz0ibG9hZGluZy1ub2RlcyI+DQo8cCBjbGFzcz0idGV4dC1tdXRlZCI+TG9hZGluZyBub2Rlcy4uLjwvcD4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCjwhLS0gTWFpbiB3b3Jrc3BhY2UgLS0+DQo8ZGl2IGNsYXNzPSJmbG93LXdvcmtzcGFjZSI+DQo8IS0tIFRvb2xiYXIgLS0+DQo8ZGl2IGNsYXNzPSJmbG93LXRvb2xiYXIiPg0KPGRpdiBjbGFzcz0idG9vbGJhci1sZWZ0Ij4NCjxidXR0b24gY2xhc3M9ImJ0biBidG4tc3VjY2VzcyIgaWQ9InJ1bi13b3JrZmxvdyI+DQo8aSBjbGFzcz0iZmFzIGZhLXBsYXkiPjwvaT4gPHNwYW4gY2xhc3M9ImJ0bi10ZXh0Ij5SdW4gV29ya2Zsb3c8L3NwYW4+DQo8L2J1dHRvbj4NCjxidXR0b24gY2xhc3M9ImJ0biBidG4tZGFuZ2VyIiBpZD0ic3RvcC13b3JrZmxvdyIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4NCjxpIGNsYXNzPSJmYXMgZmEtc3RvcCI+PC9pPiA8c3BhbiBjbGFzcz0iYnRuLXRleHQiPlN0b3A8L3NwYW4+DQo8L2J1dHRvbj4NCjxkaXYgY2xhc3M9ImN1cnJlbnQtZmlsZS1pbmZvIj4NCjxzcGFuIGNsYXNzPSJjdXJyZW50LWZpbGVuYW1lIiBpZD0iY3VycmVudC1maWxlbmFtZSI+dW50aXRsZWQuZmxvdzwvc3Bhbj4NCjwvZGl2Pg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJ0b29sYmFyLXJpZ2h0Ij4NCjwhLS0gWm9vbSBjb250cm9scyBzdGF5IHZpc2libGUgLS0+DQo8ZGl2IGNsYXNzPSJ6b29tLWNvbnRyb2xzIj4NCjxidXR0b24gY2xhc3M9ImJ0biBidG4tb3V0bGluZS1zZWNvbmRhcnkiIGlkPSJ6b29tLW91dCIgdGl0bGU9Ilpvb20gT3V0Ij4NCjxpIGNsYXNzPSJmYXMgZmEtc2VhcmNoLW1pbnVzIj48L2k+DQo8L2J1dHRvbj4NCjxzcGFuIGNsYXNzPSJ6b29tLWxldmVsIiBpZD0iem9vbS1sZXZlbCI+MTAwJTwvc3Bhbj4NCjxidXR0b24gY2xhc3M9ImJ0biBidG4tb3V0bGluZS1zZWNvbmRhcnkiIGlkPSJ6b29tLWluIiB0aXRsZT0iWm9vbSBJbiI+DQo8aSBjbGFzcz0iZmFzIGZhLXNlYXJjaC1wbHVzIj48L2k+DQo8L2J1dHRvbj4NCjxidXR0b24gY2xhc3M9ImJ0biBidG4tb3V0bGluZS1zZWNvbmRhcnkiIGlkPSJ6b29tLWZpdCIgdGl0bGU9Ilpvb20gdG8gRml0Ij4NCjxpIGNsYXNzPSJmYXMgZmEtZXhwYW5kLWFycm93cy1hbHQiPjwvaT4NCjwvYnV0dG9uPg0KPC9kaXY+DQo8IS0tIEhhbWJ1cmdlciBNZW51IEJ1dHRvbiAtLT4NCjxidXR0b24gY2xhc3M9ImJ0biBidG4tb3V0bGluZS1zZWNvbmRhcnkgaGFtYnVyZ2VyLWJ0biIgaWQ9ImhhbWJ1cmdlci1tZW51IiB0aXRsZT0iTWVudSI+DQo8aSBjbGFzcz0iZmFzIGZhLWJhcnMiPjwvaT4NCjwvYnV0dG9uPg0KPC9kaXY+DQo8L2Rpdj4NCjwhLS0gRHJvcGRvd24gTWVudSAtIE9ubHkgZmlsZSBvcGVyYXRpb25zIGFuZCBkZWxldGUvY2xlYXIgYWN0aW9ucyAtLT4NCjxkaXYgY2xhc3M9ImRyb3Bkb3duLW1lbnUiIGlkPSJkcm9wZG93bi1tZW51Ij4NCjxkaXYgY2xhc3M9Im1lbnUtc2VjdGlvbiI+DQo8ZGl2IGNsYXNzPSJtZW51LXNlY3Rpb24tdGl0bGUiPkZpbGUgQWN0aW9uczwvZGl2Pg0KPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIiBkYXRhLWFjdGlvbj0ic2F2ZS1mbG93Ij4NCjxpIGNsYXNzPSJmYXMgZmEtc2F2ZSI+PC9pPiBTYXZlDQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCjxidXR0b24gY2xhc3M9Im1lbnUtaXRlbSIgZGF0YS1hY3Rpb249InNhdmUtZmxvdy1hcyI+DQo8aSBjbGFzcz0iZmFzIGZhLXNhdmUiPjwvaT4gU2F2ZSBBcw0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0iIGRhdGEtYWN0aW9uPSJsb2FkLWZsb3ciPg0KPGkgY2xhc3M9ImZhcyBmYS1mb2xkZXItb3BlbiI+PC9pPiBMb2FkDQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCjwvZGl2Pg0KPGRpdiBjbGFzcz0ibWVudS1zZWN0aW9uIj4NCjxkaXYgY2xhc3M9Im1lbnUtc2VjdGlvbi10aXRsZSI+VmlldyBBY3Rpb25zPC9kaXY+DQo8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0iIGRhdGEtYWN0aW9uPSJhZGQtdGFnIj4NCjxpIGNsYXNzPSJmYXMgZmEtdGFnIj48L2k+IEFkZCBUYWcNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIiBkYXRhLWFjdGlvbj0icmVzZXQtdmlldyI+DQo8aSBjbGFzcz0iZmFzIGZhLWNyb3NzaGFpcnMiPjwvaT4gUmVzZXQgVmlldw0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQo8L2Rpdj4NCjxkaXYgY2xhc3M9Im1lbnUtc2VjdGlvbiI+DQo8ZGl2IGNsYXNzPSJtZW51LXNlY3Rpb24tdGl0bGUiPkVkaXQgQWN0aW9uczwvZGl2Pg0KPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIGRhbmdlciIgZGF0YS1hY3Rpb249ImRlbGV0ZS1zZWxlY3RlZCI+DQo8aSBjbGFzcz0iZmFzIGZhLXRyYXNoIj48L2k+IERlbGV0ZSBTZWxlY3RlZA0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0gZGFuZ2VyIiBkYXRhLWFjdGlvbj0iY2xlYXItY2FudmFzIj4NCjxpIGNsYXNzPSJmYXMgZmEtdHJhc2gtYWx0Ij48L2k+IENsZWFyIEFsbA0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQo8L2Rpdj4NCjwvZGl2Pg0KPCEtLSBNYWluIGNhbnZhcyBhcmVhIC0tPg0KPGRpdiBjbGFzcz0iZmxvdy1jYW52YXMtY29udGFpbmVyIj4NCjxkaXYgY2xhc3M9ImZsb3ctY2FudmFzIiBpZD0iZmxvdy1jYW52YXMiPg0KPCEtLSBOb2RlcyB3aWxsIGJlIGFkZGVkIGhlcmUgZHluYW1pY2FsbHkgLS0+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQo8IS0tIENvbmZpZ3VyYXRpb24gcGFuZWwgLS0+DQo8ZGl2IGNsYXNzPSJmbG93LWNvbmZpZy1wYW5lbCIgaWQ9ImZsb3ctY29uZmlnLXBhbmVsIj4NCjxkaXYgY2xhc3M9ImNvbmZpZy1oZWFkZXIiPg0KPGg0PjxpIGNsYXNzPSJmYXMgZmEtY29nIj48L2k+IENvbmZpZ3VyYXRpb248L2g0Pg0KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tb3V0bGluZS1zZWNvbmRhcnkiIGlkPSJ0b2dnbGUtY29uZmlnIiB0aXRsZT0iQ29sbGFwc2UgQ29uZmlndXJhdGlvbiBQYW5lbCI+DQo8aSBjbGFzcz0iZmFzIGZhLWNoZXZyb24tcmlnaHQiPjwvaT4NCjwvYnV0dG9uPg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJjb25maWctY29udGVudCIgaWQ9ImNvbmZpZy1jb250ZW50Ij4NCjxkaXYgaWQ9Im5vZGUtY29uZmlnIj4NCjxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5TZWxlY3QgYSBub2RlIHRvIGNvbmZpZ3VyZSBpdDwvcD4NCjwvZGl2Pg0KPGRpdiBpZD0idGFnLXBhbmVsIj4NCjxoNT48aSBjbGFzcz0iZmFzIGZhLXRhZ3MiPjwvaT4gQXJlYSBUYWdzPC9oNT4NCjxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5ObyB0YWdzIHlldDwvcD4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KPCEtLSBPdXRwdXQgcGFuZWwgLS0+DQo8ZGl2IGNsYXNzPSJmbG93LW91dHB1dC1wYW5lbCBjb2xsYXBzZWQiIGlkPSJmbG93LW91dHB1dC1wYW5lbCI+DQo8ZGl2IGNsYXNzPSJvdXRwdXQtaGVhZGVyIj4NCjxoND48aSBjbGFzcz0iZmFzIGZhLXRlcm1pbmFsIj48L2k+IEV4ZWN1dGlvbiBPdXRwdXQ8L2g0Pg0KPGRpdiBjbGFzcz0ib3V0cHV0LWNvbnRyb2xzIj4NCjxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiBpZD0idG9nZ2xlLW91dHB1dCIgdGl0bGU9IlNob3cvSGlkZSBPdXRwdXQiPg0KPGkgY2xhc3M9ImZhcyBmYS1jaGV2cm9uLWRvd24iPjwvaT4NCjwvYnV0dG9uPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tb3V0bGluZS1zZWNvbmRhcnkiIGlkPSJjbGVhci1vdXRwdXQiPg0KPGkgY2xhc3M9ImZhcyBmYS10cmFzaCI+PC9pPiBDbGVhcg0KICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCjwvZGl2Pg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJvdXRwdXQtY29udGVudCIgaWQ9Im91dHB1dC1jb250ZW50IiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPg0KPGRpdiBjbGFzcz0iZXhlY3V0aW9uLW91dHB1dCIgaWQ9ImV4ZWN1dGlvbi1vdXRwdXQiPg0KPHAgY2xhc3M9InRleHQtbXV0ZWQiPldvcmtmbG93IG91dHB1dCB3aWxsIGFwcGVhciBoZXJlPC9wPg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCg0KPHNjcmlwdD4vLyA9PT09PSBTY3JpcHQ6IGpzL3V0aWxzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9ub2RlLXJlZ2lzdHJ5LmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9jYW52YXMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL25vZGUtY29uZmlnLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9ub2RlLXJlbmRlcmVyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9kYXRhLWV4ZWN1dG9ycy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvaHR0cC1leGVjdXRvcnMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL21lZGlhLWV4ZWN1dG9ycy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvZmxvdy1leGVjdXRvcnMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2FpLWV4ZWN1dG9ycy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvZXhlY3V0aW9uLWVuZ2luZS5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvd29ya2Zsb3cuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2NhbnZhcy1tYW5hZ2VyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy90YWctbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvZmlsZS1tYW5hZ2VyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy91aS1tYW5hZ2VyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9tYWluLmpzID09PT09DQoNCg0KLy8gdXRpbHMuanMgLSBVdGlsaXR5IGZ1bmN0aW9ucyBmb3IgRmxvdyBFZGl0b3INCg0KLy8gQ2FudmFzLXNwZWNpZmljIGNvb3JkaW5hdGUgdHJhbnNmb3JtYXRpb24gdXRpbGl0aWVzDQovLyAoQXBwIHNjYWxpbmcgdXRpbGl0aWVzIGFyZSBub3cgY2VudHJhbGl6ZWQgaW4gc3lwbmV4QVBJLnNjYWxpbmcpDQoNCi8vIFV0aWxpdHkgZnVuY3Rpb24gdG8gZXNjYXBlIEhUTUwNCmZ1bmN0aW9uIGVzY2FwZUh0bWwodGV4dCkgew0KICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIGRpdi50ZXh0Q29udGVudCA9IHRleHQ7DQogICAgcmV0dXJuIGRpdi5pbm5lckhUTUw7DQp9DQoNCi8vIFV0aWxpdHkgZnVuY3Rpb24gdG8gZm9ybWF0IGZpbGUgc2l6ZQ0KZnVuY3Rpb24gZm9ybWF0RmlsZVNpemUoYnl0ZXMpIHsNCiAgICBpZiAoYnl0ZXMgPT09IDApIHJldHVybiAnMCBCeXRlcyc7DQogICAgY29uc3QgayA9IDEwMjQ7DQogICAgY29uc3Qgc2l6ZXMgPSBbJ0J5dGVzJywgJ0tCJywgJ01CJywgJ0dCJ107DQogICAgY29uc3QgaSA9IE1hdGguZmxvb3IoTWF0aC5sb2coYnl0ZXMpIC8gTWF0aC5sb2coaykpOw0KICAgIHJldHVybiBwYXJzZUZsb2F0KChieXRlcyAvIE1hdGgucG93KGssIGkpKS50b0ZpeGVkKDIpKSArICcgJyArIHNpemVzW2ldOw0KfQ0KDQovLyBVdGlsaXR5IGZ1bmN0aW9uIHRvIGRlYm91bmNlIGZ1bmN0aW9uIGNhbGxzDQpmdW5jdGlvbiBkZWJvdW5jZShmdW5jLCB3YWl0KSB7DQogICAgbGV0IHRpbWVvdXQ7DQogICAgcmV0dXJuIGZ1bmN0aW9uIGV4ZWN1dGVkRnVuY3Rpb24oLi4uYXJncykgew0KICAgICAgICBjb25zdCBsYXRlciA9ICgpID0+IHsNCiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTsNCiAgICAgICAgICAgIGZ1bmMoLi4uYXJncyk7DQogICAgICAgIH07DQogICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTsNCiAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHdhaXQpOw0KICAgIH07DQp9DQoNCg0KLy8gSGVscGVyIG1ldGhvZCBmb3IgdGVtcGxhdGUgcHJvY2Vzc2luZw0KZnVuY3Rpb24gcHJvY2Vzc1RlbXBsYXRlcyh0ZW1wbGF0ZSwgZGF0YSkgew0KICAgIGxldCByZXN1bHQgPSB0ZW1wbGF0ZTsNCiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdvYmplY3QnICYmIGRhdGEgIT09IG51bGwpIHsNCiAgICAgICAgLy8gQ2hlY2sgaWYgZGF0YS5kYXRhIGlzIGEgSlNPTiBzdHJpbmcgYW5kIHRyeSB0byBwYXJzZSBpdA0KICAgICAgICBsZXQgdGVtcGxhdGVEYXRhID0gZGF0YTsNCiAgICAgICAgaWYgKGRhdGEuZGF0YSAmJiB0eXBlb2YgZGF0YS5kYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWREYXRhID0gSlNPTi5wYXJzZShkYXRhLmRhdGEpOw0KICAgICAgICAgICAgICAgIC8vIE1lcmdlIHRoZSBwYXJzZWQgSlNPTiB3aXRoIHRoZSBvcmlnaW5hbCBkYXRhIG9iamVjdA0KICAgICAgICAgICAgICAgIHRlbXBsYXRlRGF0YSA9IHsgLi4uZGF0YSwgLi4ucGFyc2VkRGF0YSB9Ow0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgIC8vIElmIHBhcnNpbmcgZmFpbHMsIGp1c3QgdXNlIHRoZSBvcmlnaW5hbCBkYXRhDQogICAgICAgICAgICAgICAgdGVtcGxhdGVEYXRhID0gZGF0YTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gRmluZCBhbGwgdGVtcGxhdGUgcGF0dGVybnMgbGlrZSB7e2tleX19IG9yIHt7cGF0aC50by52YWx1ZX19DQogICAgICAgIGNvbnN0IHRlbXBsYXRlUGF0dGVybiA9IC9ce1x7KFtefV0rKVx9XH0vZzsNCiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UodGVtcGxhdGVQYXR0ZXJuLCAobWF0Y2gsIHBhdGgpID0+IHsNCiAgICAgICAgICAgIC8vIFRyeSB0byBnZXQgbmVzdGVkIHZhbHVlIHVzaW5nIGRvdCBub3RhdGlvbg0KICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBleHRyYWN0TmVzdGVkVmFsdWUodGVtcGxhdGVEYXRhLCBwYXRoKTsNCiAgICAgICAgICAgIC8vIFJldHVybiB0aGUgdmFsdWUgaWYgZm91bmQsIG90aGVyd2lzZSBrZWVwIHRoZSBvcmlnaW5hbCB0ZW1wbGF0ZQ0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZSA6IG1hdGNoOw0KICAgICAgICB9KTsNCiAgICB9DQogICAgcmV0dXJuIHJlc3VsdDsNCn0NCg0KLy8gSGVscGVyIG1ldGhvZCBmb3IgZXh0cmFjdGluZyBuZXN0ZWQgSlNPTiB2YWx1ZXMNCmZ1bmN0aW9uIGV4dHJhY3ROZXN0ZWRWYWx1ZShvYmosIHBhdGgpIHsNCiAgICBjb25zdCBrZXlzID0gcGF0aC5zcGxpdCgnLicpOw0KICAgIGxldCBjdXJyZW50ID0gb2JqOw0KDQogICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgew0KICAgICAgICBpZiAoY3VycmVudCA9PT0gbnVsbCB8fCBjdXJyZW50ID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gSGFuZGxlIGFycmF5IGFjY2VzcyBsaWtlICJpdGVtc1swXS5uYW1lIg0KICAgICAgICBjb25zdCBhcnJheU1hdGNoID0ga2V5Lm1hdGNoKC9eKC4rKVxbKFxkKylcXSQvKTsNCiAgICAgICAgaWYgKGFycmF5TWF0Y2gpIHsNCiAgICAgICAgICAgIGNvbnN0IGFycmF5S2V5ID0gYXJyYXlNYXRjaFsxXTsNCiAgICAgICAgICAgIGNvbnN0IGFycmF5SW5kZXggPSBwYXJzZUludChhcnJheU1hdGNoWzJdKTsNCg0KICAgICAgICAgICAgaWYgKGN1cnJlbnRbYXJyYXlLZXldICYmIEFycmF5LmlzQXJyYXkoY3VycmVudFthcnJheUtleV0pKSB7DQogICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnRbYXJyYXlLZXldW2FycmF5SW5kZXhdOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50W2tleV07DQogICAgICAgIH0NCiAgICB9DQoNCiAgICByZXR1cm4gY3VycmVudDsNCn0NCg0KLy8gSGVscGVyIG1ldGhvZCB0byBkZXRlY3QgaW1hZ2UgdHlwZSBmcm9tIGJhc2U2NCBkYXRhDQpmdW5jdGlvbiBkZXRlY3RJbWFnZVR5cGVGcm9tQmFzZTY0KGJhc2U2NERhdGEpIHsNCiAgICAvLyBDaGVjayB0aGUgZmlyc3QgZmV3IGJ5dGVzIHRvIGRldGVybWluZSBpbWFnZSB0eXBlDQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgYmluYXJ5U3RyaW5nID0gYXRvYihiYXNlNjREYXRhKTsNCiAgICAgICAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheShiaW5hcnlTdHJpbmcubGVuZ3RoKTsNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaW5hcnlTdHJpbmcubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGJ5dGVzW2ldID0gYmluYXJ5U3RyaW5nLmNoYXJDb2RlQXQoaSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBDaGVjayBmaWxlIHNpZ25hdHVyZXMNCiAgICAgICAgaWYgKGJ5dGVzWzBdID09PSAweEZGICYmIGJ5dGVzWzFdID09PSAweEQ4ICYmIGJ5dGVzWzJdID09PSAweEZGKSB7DQogICAgICAgICAgICByZXR1cm4gJ2ltYWdlL2pwZWcnOw0KICAgICAgICB9IGVsc2UgaWYgKGJ5dGVzWzBdID09PSAweDg5ICYmIGJ5dGVzWzFdID09PSAweDUwICYmIGJ5dGVzWzJdID09PSAweDRFICYmIGJ5dGVzWzNdID09PSAweDQ3KSB7DQogICAgICAgICAgICByZXR1cm4gJ2ltYWdlL3BuZyc7DQogICAgICAgIH0gZWxzZSBpZiAoYnl0ZXNbMF0gPT09IDB4NDcgJiYgYnl0ZXNbMV0gPT09IDB4NDkgJiYgYnl0ZXNbMl0gPT09IDB4NDYpIHsNCiAgICAgICAgICAgIHJldHVybiAnaW1hZ2UvZ2lmJzsNCiAgICAgICAgfSBlbHNlIGlmIChieXRlc1swXSA9PT0gMHg1MiAmJiBieXRlc1sxXSA9PT0gMHg0OSAmJiBieXRlc1syXSA9PT0gMHg0NiAmJiBieXRlc1szXSA9PT0gMHg0Nikgew0KICAgICAgICAgICAgcmV0dXJuICdpbWFnZS93ZWJwJzsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIERlZmF1bHQgdG8gUE5HIGlmIHdlIGNhbid0IGRldGVybWluZQ0KICAgICAgICAgICAgcmV0dXJuICdpbWFnZS9wbmcnOw0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAvLyBEZWZhdWx0IHRvIFBORyBpZiB0aGVyZSdzIGFuIGVycm9yDQogICAgICAgIHJldHVybiAnaW1hZ2UvcG5nJzsNCiAgICB9DQp9DQoNCi8vIENvbnZlcnQgdmlld3BvcnQgY29vcmRpbmF0ZXMgdG8gY2FudmFzIGNvb3JkaW5hdGVzIChhY2NvdW50aW5nIGZvciBwYW4gYW5kIHpvb20pDQpmdW5jdGlvbiB2aWV3cG9ydFRvQ2FudmFzQ29vcmRzKHZpZXdwb3J0WCwgdmlld3BvcnRZKSB7DQogICAgaWYgKHR5cGVvZiBmbG93RWRpdG9yID09PSAndW5kZWZpbmVkJykgew0KICAgICAgICByZXR1cm4geyB4OiB2aWV3cG9ydFgsIHk6IHZpZXdwb3J0WSB9Ow0KICAgIH0NCiAgICANCiAgICByZXR1cm4gew0KICAgICAgICB4OiAodmlld3BvcnRYIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueCkgLyBmbG93RWRpdG9yLnpvb21MZXZlbCwNCiAgICAgICAgeTogKHZpZXdwb3J0WSAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWwNCiAgICB9Ow0KfQ0KDQovLyBDb252ZXJ0IGNhbnZhcyBjb29yZGluYXRlcyB0byB2aWV3cG9ydCBjb29yZGluYXRlcyAoYWNjb3VudGluZyBmb3IgcGFuIGFuZCB6b29tKQ0KZnVuY3Rpb24gY2FudmFzVG9WaWV3cG9ydENvb3JkcyhjYW52YXNYLCBjYW52YXNZKSB7DQogICAgaWYgKHR5cGVvZiBmbG93RWRpdG9yID09PSAndW5kZWZpbmVkJykgew0KICAgICAgICByZXR1cm4geyB4OiBjYW52YXNYLCB5OiBjYW52YXNZIH07DQogICAgfQ0KICAgIA0KICAgIHJldHVybiB7DQogICAgICAgIHg6IChjYW52YXNYICogZmxvd0VkaXRvci56b29tTGV2ZWwpICsgZmxvd0VkaXRvci5wYW5PZmZzZXQueCwNCiAgICAgICAgeTogKGNhbnZhc1kgKiBmbG93RWRpdG9yLnpvb21MZXZlbCkgKyBmbG93RWRpdG9yLnBhbk9mZnNldC55DQogICAgfTsNCn0NCg0KLy8gR2V0IHRoZSBjZW50ZXIgb2YgdGhlIGN1cnJlbnQgdmlld3BvcnQgaW4gY2FudmFzIGNvb3JkaW5hdGVzDQpmdW5jdGlvbiBnZXRWaWV3cG9ydENlbnRlckluQ2FudmFzKCkgew0KICAgIGlmICh0eXBlb2YgZmxvd0VkaXRvciA9PT0gJ3VuZGVmaW5lZCcgfHwgIWZsb3dFZGl0b3IuY2FudmFzKSB7DQogICAgICAgIHJldHVybiB7IHg6IDAsIHk6IDAgfTsNCiAgICB9DQogICAgDQogICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICBpZiAoIWNvbnRhaW5lcikgew0KICAgICAgICByZXR1cm4geyB4OiAwLCB5OiAwIH07DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgY29uc3Qgdmlld3BvcnRDZW50ZXJYID0gY29udGFpbmVyUmVjdC53aWR0aCAvIDI7DQogICAgY29uc3Qgdmlld3BvcnRDZW50ZXJZID0gY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyOw0KICAgIA0KICAgIHJldHVybiB2aWV3cG9ydFRvQ2FudmFzQ29vcmRzKHZpZXdwb3J0Q2VudGVyWCwgdmlld3BvcnRDZW50ZXJZKTsNCn0NCg0KLy8gQ2VudGVyIHRoZSB2aWV3cG9ydCBvbiBzcGVjaWZpYyBjYW52YXMgY29vcmRpbmF0ZXMNCmZ1bmN0aW9uIGNlbnRlclZpZXdwb3J0T25DYW52YXMoY2FudmFzWCwgY2FudmFzWSkgew0KICAgIGlmICh0eXBlb2YgZmxvd0VkaXRvciA9PT0gJ3VuZGVmaW5lZCcgfHwgIWZsb3dFZGl0b3IuY2FudmFzKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICBpZiAoIWNvbnRhaW5lcikgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgY29uc3Qgdmlld3BvcnRDZW50ZXJYID0gY29udGFpbmVyUmVjdC53aWR0aCAvIDI7DQogICAgY29uc3Qgdmlld3BvcnRDZW50ZXJZID0gY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBwYW4gb2Zmc2V0IHRvIGNlbnRlciB0aGUgc3BlY2lmaWVkIGNhbnZhcyBjb29yZGluYXRlcyBpbiB0aGUgdmlld3BvcnQNCiAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gdmlld3BvcnRDZW50ZXJYIC0gKGNhbnZhc1ggKiBmbG93RWRpdG9yLnpvb21MZXZlbCk7DQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IHZpZXdwb3J0Q2VudGVyWSAtIChjYW52YXNZICogZmxvd0VkaXRvci56b29tTGV2ZWwpOw0KICAgIA0KICAgIC8vIFVwZGF0ZSB0aGUgdHJhbnNmb3JtDQogICAgaWYgKHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyICYmIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSkgew0KICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICB9DQp9DQoNCi8vIEV4cG9ydCB1dGlsaXRpZXMgZm9yIHVzZSBpbiBvdGhlciBtb2R1bGVzDQovLyBDYW52YXMtc3BlY2lmaWMgdXRpbGl0aWVzIG9ubHkgLSBzY2FsaW5nIHV0aWxpdGllcyBhcmUgbm93IGluIHN5cG5leEFQSS5zY2FsaW5nDQpzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzID0gew0KICAgIC8vIENhbnZhcy1zcGVjaWZpYyBjb29yZGluYXRlIHRyYW5zZm9ybWF0aW9ucw0KICAgIHZpZXdwb3J0VG9DYW52YXNDb29yZHMsDQogICAgY2FudmFzVG9WaWV3cG9ydENvb3JkcywNCiAgICBnZXRWaWV3cG9ydENlbnRlckluQ2FudmFzLA0KICAgIGNlbnRlclZpZXdwb3J0T25DYW52YXMsDQogICAgDQogICAgLy8gR2VuZXJhbCB1dGlsaXRpZXMNCiAgICBlc2NhcGVIdG1sLA0KICAgIGZvcm1hdEZpbGVTaXplLA0KICAgIGRlYm91bmNlLA0KICAgIHByb2Nlc3NUZW1wbGF0ZXMsDQogICAgZXh0cmFjdE5lc3RlZFZhbHVlLA0KICAgIGRldGVjdEltYWdlVHlwZUZyb21CYXNlNjQNCn07DQoNCi8vIFJlcGxhY2UgdGVtcGxhdGUgcGxhY2Vob2xkZXJzIGluIEpTT04gYm9keQ0KZnVuY3Rpb24gcmVwbGFjZVRlbXBsYXRlUGxhY2Vob2xkZXJzKGJvZHksIHRlbXBsYXRlRGF0YSkgew0KDQogICAgaWYgKCFib2R5KSB7DQogICAgICAgIHJldHVybiBib2R5Ow0KICAgIH0NCg0KICAgIC8vIEhhbmRsZSBib3RoIHN0cmluZyBhbmQgb2JqZWN0IGlucHV0cw0KICAgIGxldCBib2R5U3RyaW5nOw0KICAgIGxldCBpc0pzb25TdHJpbmcgPSBmYWxzZTsNCg0KICAgIGlmICh0eXBlb2YgYm9keSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgYm9keVN0cmluZyA9IGJvZHk7DQogICAgICAgIC8vIENoZWNrIGlmIGl0J3MgYWxyZWFkeSBhIEpTT04gc3RyaW5nDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBKU09OLnBhcnNlKGJvZHkpOw0KICAgICAgICAgICAgaXNKc29uU3RyaW5nID0gdHJ1ZTsNCiAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgLy8gTm90IGEgSlNPTiBzdHJpbmcsIHRyZWF0IGFzIHJlZ3VsYXIgc3RyaW5nDQogICAgICAgIH0NCiAgICB9IGVsc2UgaWYgKHR5cGVvZiBib2R5ID09PSAnb2JqZWN0Jykgew0KICAgICAgICBib2R5U3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoYm9keSk7DQogICAgICAgIGlzSnNvblN0cmluZyA9IHRydWU7DQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIGJvZHk7DQogICAgfQ0KDQoNCiAgICAvLyBSZXBsYWNlIHBsYWNlaG9sZGVycyB3aXRoIHRlbXBsYXRlIGRhdGENCiAgICBpZiAodGVtcGxhdGVEYXRhICE9PSB1bmRlZmluZWQgJiYgdGVtcGxhdGVEYXRhICE9PSBudWxsKSB7DQogICAgICAgIGNvbnN0IGJlZm9yZVJlcGxhY2UgPSBib2R5U3RyaW5nOw0KDQoNCiAgICAgICAgLy8gU2ltcGxlIEpTT04gZmllbGQgcmVwbGFjZW1lbnQgLSBqdXN0IHt7ZmllbGR9fSBvciB7e25lc3RlZC5maWVsZH19DQogICAgICAgIGlmICh0eXBlb2YgdGVtcGxhdGVEYXRhID09PSAnb2JqZWN0Jykgew0KDQogICAgICAgICAgICAvLyBVc2UgYSBzaW1wbGVyLCBtb3JlIGV4cGxpY2l0IHJlZ2V4DQogICAgICAgICAgICBjb25zdCBwbGFjZWhvbGRlclJlZ2V4ID0gL1x7XHsoW159XSspXH1cfS9nOw0KDQogICAgICAgICAgICAvLyBUZXN0IGlmIHRoZSByZWdleCBmaW5kcyBhbnl0aGluZw0KICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGJvZHlTdHJpbmcubWF0Y2gocGxhY2Vob2xkZXJSZWdleCk7DQoNCiAgICAgICAgICAgIGJvZHlTdHJpbmcgPSBib2R5U3RyaW5nLnJlcGxhY2UocGxhY2Vob2xkZXJSZWdleCwgKG1hdGNoLCBmaWVsZFBhdGgpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGdldE5lc3RlZFZhbHVlKHRlbXBsYXRlRGF0YSwgZmllbGRQYXRoKTsNCiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICBsZXQgcmVwbGFjZW1lbnQ7DQogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBBbHdheXMgZXNjYXBlIHRoZSBzdHJpbmcgcHJvcGVybHkgZm9yIEpTT04gY29udGV4dA0KICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnQgPSB2YWx1ZS5yZXBsYWNlKC9cXC9nLCAnXFxcXCcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyIvZywgJ1xcIicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xuL2csICdcXG4nKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cci9nLCAnXFxyJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXHQvZywgJ1xcdCcpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9yIG5vbi1zdHJpbmdzLCBjb252ZXJ0IHRvIEpTT04gc3RyaW5nDQogICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudCA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVwbGFjZW1lbnQ7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0ZW1wbGF0ZURhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAvLyBGb3Igc3RyaW5ncywganVzdCByZXBsYWNlIHt7VkFMVUV9fSBhcyBhIGZhbGxiYWNrDQogICAgICAgICAgICBib2R5U3RyaW5nID0gYm9keVN0cmluZy5yZXBsYWNlKC97e1ZBTFVFfX0vZywgSlNPTi5zdHJpbmdpZnkodGVtcGxhdGVEYXRhKSk7DQogICAgICAgIH0NCg0KICAgIH0gZWxzZSB7DQogICAgfQ0KDQogICAgaWYgKHR5cGVvZiBib2R5ID09PSAnb2JqZWN0Jykgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoYm9keVN0cmluZyk7DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGFyc2UgdGVtcGxhdGUtcmVwbGFjZWQgYm9keTonLCBlcnJvcik7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdCb2R5IHN0cmluZyB3YXM6JywgYm9keVN0cmluZyk7DQogICAgICAgICAgICByZXR1cm4gYm9keTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBib2R5U3RyaW5nOw0KICAgIH0NCn0NCg0KLy8gR2V0IG5lc3RlZCB2YWx1ZSBmcm9tIG9iamVjdCB1c2luZyBkb3Qgbm90YXRpb24NCmZ1bmN0aW9uIGdldE5lc3RlZFZhbHVlKG9iaiwgcGF0aCkgew0KICAgIGNvbnN0IHJlc3VsdCA9IHBhdGguc3BsaXQoJy4nKS5yZWR1Y2UoKGN1cnJlbnQsIGtleSkgPT4gew0KICAgICAgICBjb25zdCB2YWx1ZSA9IGN1cnJlbnQgJiYgY3VycmVudFtrZXldICE9PSB1bmRlZmluZWQgPyBjdXJyZW50W2tleV0gOiB1bmRlZmluZWQ7DQogICAgICAgIHJldHVybiB2YWx1ZTsNCiAgICB9LCBvYmopOw0KICAgIHJldHVybiByZXN1bHQ7DQp9DQoNCg0KLy8gVXBkYXRlIEpTT04gZXh0cmFjdCBub2RlIGRpc3BsYXkNCmZ1bmN0aW9uIHVwZGF0ZUpzb25FeHRyYWN0RGlzcGxheShub2RlSWQsIGxhYmVsLCB2YWx1ZSwgc3RhdHVzID0gJ25vcm1hbCcpIHsNCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgIGNvbnN0IGNvbnRlbnRFbGVtZW50ID0gbm9kZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLmZsb3ctbm9kZS1jb250ZW50Jyk7DQogICAgICAgIGlmIChjb250ZW50RWxlbWVudCkgew0KICAgICAgICAgICAgY29uc3Qgc3RhdHVzQ2xhc3MgPSBzdGF0dXMgPT09ICdlcnJvcicgPyAndGV4dC1kYW5nZXInIDogc3RhdHVzID09PSAnc3VjY2VzcycgPyAndGV4dC1zdWNjZXNzJyA6ICd0ZXh0LW11dGVkJzsNCg0KICAgICAgICAgICAgLy8gU2hvdyBqdXN0IGEgc3RhdHVzIG9uIHRoZSBub2RlLCBmdWxsIGNvbnRlbnQgd2lsbCBiZSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgICAgIGNvbnN0IHRydW5jYXRlZFZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiB2YWx1ZS5sZW5ndGggPiA1MCA/DQogICAgICAgICAgICAgICAgdmFsdWUuc3Vic3RyaW5nKDAsIDUwKSArICcuLi4nIDogdmFsdWU7DQoNCiAgICAgICAgICAgIGNvbnRlbnRFbGVtZW50LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJub2RlLXN0YXR1cyI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXR1cy10ZXh0Ij5WYWx1ZSBleHRyYWN0ZWQ8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdHVzLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPiR7bGFiZWx9OiAke2VzY2FwZUh0bWwoU3RyaW5nKHRydW5jYXRlZFZhbHVlKSl9PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBBZGQgZXhlY3V0aW9uIGxvZyBlbnRyeQ0KZnVuY3Rpb24gYWRkRXhlY3V0aW9uTG9nKG1lc3NhZ2UsIHR5cGUgPSAnaW5mbycpIHsNCiAgICBjb25zdCBvdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhlY3V0aW9uLW91dHB1dCcpOw0KICAgIGlmIChvdXRwdXQpIHsNCiAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoKTsNCiAgICAgICAgb3V0cHV0LmlubmVySFRNTCArPSBgPGRpdiBjbGFzcz0ibG9nLWVudHJ5ICR7dHlwZX0iPlske3RpbWVzdGFtcH1dICR7bWVzc2FnZX08L2Rpdj5gOw0KICAgICAgICBvdXRwdXQuc2Nyb2xsVG9wID0gb3V0cHV0LnNjcm9sbEhlaWdodDsNCiAgICB9DQp9DQoNCi8vIENsZWFyIGV4ZWN1dGlvbiBvdXRwdXQNCmZ1bmN0aW9uIGNsZWFyT3V0cHV0KCkgew0KICAgIGNvbnN0IG91dHB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleGVjdXRpb24tb3V0cHV0Jyk7DQogICAgaWYgKG91dHB1dCkgew0KICAgICAgICBvdXRwdXQuaW5uZXJIVE1MID0gJzxkaXYgY2xhc3M9ImxvZy1lbnRyeSBpbmZvIj5PdXRwdXQgY2xlYXJlZDwvZGl2Pic7DQogICAgfQ0KfQ0KDQoNCi8vIEludGVyYWN0aXZlIGhlbHBlciBmdW5jdGlvbnMgZm9yIHNwZWNpYWwgbm9kZSB0eXBlcw0KDQovLyBBdWRpbyBjb250cm9sIGZ1bmN0aW9ucw0KZnVuY3Rpb24gcGxheUF1ZGlvKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCAhbm9kZS5sYXN0QXVkaW9VcmwpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTm8gYXVkaW8gZGF0YSBhdmFpbGFibGUgZm9yIG5vZGU6Jywgbm9kZUlkKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIENyZWF0ZSBvciByZXVzZSBhdWRpbyBlbGVtZW50DQogICAgaWYgKCFub2RlLmF1ZGlvRWxlbWVudCkgew0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudCA9IG5ldyBBdWRpbyhub2RlLmxhc3RBdWRpb1VybCk7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnZvbHVtZSA9IHBhcnNlRmxvYXQobm9kZS5jb25maWcudm9sdW1lLnZhbHVlKTsNCiAgICB9DQoNCiAgICBub2RlLmF1ZGlvRWxlbWVudC5wbGF5KCkuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGxheSBhdWRpbzonLCBlcnJvcik7DQogICAgfSk7DQoNCn0NCg0KZnVuY3Rpb24gc3RvcEF1ZGlvKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCAhbm9kZS5hdWRpb0VsZW1lbnQpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTm8gYXVkaW8gZWxlbWVudCBmb3VuZCBmb3Igbm9kZTonLCBub2RlSWQpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgbm9kZS5hdWRpb0VsZW1lbnQucGF1c2UoKTsNCiAgICBub2RlLmF1ZGlvRWxlbWVudC5jdXJyZW50VGltZSA9IDA7DQoNCn0NCg0KLy8gSW1hZ2UgZGlzcGxheSBmdW5jdGlvbnMNCmZ1bmN0aW9uIHNob3dGdWxsSW1hZ2Uobm9kZUlkKSB7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlIHx8ICFub2RlLmxhc3RJbWFnZVVybCkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdObyBpbWFnZSBkYXRhIGF2YWlsYWJsZSBmb3Igbm9kZTonLCBub2RlSWQpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8gQ3JlYXRlIGEgbW9kYWwgdG8gc2hvdyB0aGUgZnVsbCBpbWFnZQ0KICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgbW9kYWwuY2xhc3NOYW1lID0gJ2ltYWdlLW1vZGFsJzsNCiAgICBtb2RhbC5zdHlsZS5jc3NUZXh0ID0gYA0KICAgICAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgICAgIHRvcDogMDsNCiAgICAgICAgbGVmdDogMDsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgIGhlaWdodDogMTAwJTsNCiAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjgpOw0KICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgICAgei1pbmRleDogMTAwMDA7DQogICAgICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBgOw0KDQogICAgY29uc3QgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7DQogICAgaW1nLnNyYyA9IG5vZGUubGFzdEltYWdlVXJsOw0KICAgIGltZy5zdHlsZS5jc3NUZXh0ID0gYA0KICAgICAgICBtYXgtd2lkdGg6IDkwJTsNCiAgICAgICAgbWF4LWhlaWdodDogOTAlOw0KICAgICAgICBvYmplY3QtZml0OiBjb250YWluOw0KICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDIwcHggcmdiYSgwLCAwLCAwLCAwLjUpOw0KICAgIGA7DQoNCiAgICBtb2RhbC5hcHBlbmRDaGlsZChpbWcpOw0KICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobW9kYWwpOw0KDQogICAgLy8gQ2xvc2UgbW9kYWwgb24gY2xpY2sNCiAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChtb2RhbCk7DQogICAgfSk7DQoNCn0NCg0KLy8gUmVwZWF0ZXIgY29udHJvbCBmdW5jdGlvbnMNCmZ1bmN0aW9uIHN0YXJ0UmVwZWF0ZXIobm9kZUlkKSB7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlIHx8IG5vZGUudHlwZSAhPT0gJ3JlcGVhdGVyJykgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIHJlcGVhdGVyIG5vZGU6Jywgbm9kZUlkKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIEV4ZWN1dGUgdGhlIHJlcGVhdGVyIG5vZGUgdG8gc3RhcnQgaXQNCiAgICBleGVjdXRpb25FbmdpbmUuZXhlY3V0ZU5vZGUobm9kZSwge30sIG5ldyBTZXQoKSkudGhlbigoKSA9PiB7DQogICAgICAgIC8vIFJlZnJlc2ggdGhlIGNvbmZpZyBwYW5lbCB0byB1cGRhdGUgdGhlIFVJDQogICAgICAgIHNob3dOb2RlQ29uZmlnKG5vZGVJZCk7DQogICAgfSkuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc3RhcnQgcmVwZWF0ZXI6JywgZXJyb3IpOw0KICAgIH0pOw0KfQ0KDQpmdW5jdGlvbiBzdG9wUmVwZWF0ZXIobm9kZUlkKSB7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlIHx8IG5vZGUudHlwZSAhPT0gJ3JlcGVhdGVyJykgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIHJlcGVhdGVyIG5vZGU6Jywgbm9kZUlkKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIFN0b3AgdGhlIHJlcGVhdGVyIHVzaW5nIHRoZSBleGVjdXRpb24gZW5naW5lIG1ldGhvZA0KICAgIGV4ZWN1dGlvbkVuZ2luZS5zdG9wUmVwZWF0ZXIobm9kZSk7DQoNCiAgICAvLyBSZWZyZXNoIHRoZSBjb25maWcgcGFuZWwgdG8gdXBkYXRlIHRoZSBVSQ0KICAgIHNob3dOb2RlQ29uZmlnKG5vZGVJZCk7DQp9DQoNCg0KDQovLyBVcGRhdGUgaW5wdXQgbWFwcGluZyB3aGVuIHVzZXIgc2VsZWN0cyBhIGRpZmZlcmVudCBvdXRwdXQgcG9ydA0KZnVuY3Rpb24gdXBkYXRlSW5wdXRNYXBwaW5nKG5vZGVJZCwgaW5wdXRQb3J0LCBzZWxlY3RlZE91dHB1dFBvcnQpIHsNCiAgICAvLyBGaW5kIHRoZSBjb25uZWN0aW9uIHRoYXQgZ29lcyB0byB0aGlzIGlucHV0IHBvcnQgKGlnbm9yZSBmcm9tLnBvcnROYW1lKQ0KICAgIGNvbnN0IGNvbm5lY3Rpb24gPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLmZpbmQoY29ubiA9Pg0KICAgICAgICBjb25uLnRvLm5vZGVJZCA9PT0gbm9kZUlkICYmIGNvbm4udG8ucG9ydE5hbWUgPT09IGlucHV0UG9ydA0KICAgICk7DQogICAgaWYgKGNvbm5lY3Rpb24pIHsNCiAgICAgICAgLy8gUmVtb3ZlIHRoZSBvbGQgY29ubmVjdGlvbg0KICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmRlbGV0ZShjb25uZWN0aW9uLmlkKTsNCiAgICAgICAgaWYgKGNvbm5lY3Rpb24uc3ZnKSBjb25uZWN0aW9uLnN2Zy5yZW1vdmUoKTsNCiAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IGNvbm5lY3Rpb24gd2l0aCB0aGUgdXBkYXRlZCBwb3J0IG5hbWUgYW5kIG5ldyBJRA0KICAgICAgICBjb25zdCBuZXdDb25uZWN0aW9uSWQgPSBgY29ubl8ke2Nvbm5lY3Rpb24uZnJvbS5ub2RlSWR9XyR7c2VsZWN0ZWRPdXRwdXRQb3J0fV8ke2Nvbm5lY3Rpb24udG8ubm9kZUlkfV8ke2Nvbm5lY3Rpb24udG8ucG9ydE5hbWV9YDsNCiAgICAgICAgY29uc3QgbmV3Q29ubmVjdGlvbiA9IHsNCiAgICAgICAgICAgIGlkOiBuZXdDb25uZWN0aW9uSWQsDQogICAgICAgICAgICBmcm9tOiB7IG5vZGVJZDogY29ubmVjdGlvbi5mcm9tLm5vZGVJZCwgcG9ydE5hbWU6IHNlbGVjdGVkT3V0cHV0UG9ydCB9LA0KICAgICAgICAgICAgdG86IHsgbm9kZUlkOiBjb25uZWN0aW9uLnRvLm5vZGVJZCwgcG9ydE5hbWU6IGNvbm5lY3Rpb24udG8ucG9ydE5hbWUgfQ0KICAgICAgICB9Ow0KICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnNldChuZXdDb25uZWN0aW9uSWQsIG5ld0Nvbm5lY3Rpb24pOw0KICAgICAgICBkcmF3Q29ubmVjdGlvbihuZXdDb25uZWN0aW9uKTsNCiAgICAgICAgLy8gUmVmcmVzaCB0aGUgbm9kZSBjb25maWcgcGFuZWwgdG8gc2hvdyB1cGRhdGVkIHN0YXRlDQogICAgICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9PT0gbm9kZUlkKSB7DQogICAgICAgICAgICBzaG93Tm9kZUNvbmZpZyhub2RlSWQpOw0KICAgICAgICB9DQogICAgICAgIC8vIEF1dG8tc2F2ZSB0aGUgd29ya2Zsb3cgdG8gcGVyc2lzdCB0aGUgbWFwcGluZyBjaGFuZ2UNCiAgICAgICAgaWYgKHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci5zYXZlRmxvdykgew0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLnNhdmVGbG93KCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIFVwZGF0ZSBvdXRwdXQgbWFwcGluZyB3aGVuIHVzZXIgc2VsZWN0cyBhIGRpZmZlcmVudCBvdXRwdXQgcG9ydA0KZnVuY3Rpb24gdXBkYXRlT3V0cHV0TWFwcGluZyhub2RlSWQsIG91dHB1dFBvcnQsIHRhcmdldE5vZGVJZCwgc2VsZWN0ZWRPdXRwdXRQb3J0KSB7DQogICAgLy8gUmVtb3ZlIGFsbCBjb25uZWN0aW9ucyBmcm9tIHRoaXMgbm9kZSB0byB0aGUgdGFyZ2V0IG5vZGUgKHJlZ2FyZGxlc3Mgb2YgcG9ydCkNCiAgICBjb25zdCBjb25uZWN0aW9uc1RvUmVtb3ZlID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5maWx0ZXIoY29ubiA9Pg0KICAgICAgICBjb25uLmZyb20ubm9kZUlkID09PSBub2RlSWQgJiYgY29ubi50by5ub2RlSWQgPT09IHRhcmdldE5vZGVJZA0KICAgICk7DQogICAgY29ubmVjdGlvbnNUb1JlbW92ZS5mb3JFYWNoKGNvbm4gPT4gew0KICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmRlbGV0ZShjb25uLmlkKTsNCiAgICAgICAgaWYgKGNvbm4uc3ZnKSBjb25uLnN2Zy5yZW1vdmUoKTsNCiAgICB9KTsNCiAgICAvLyBBZGQgdGhlIG5ldyBjb25uZWN0aW9uDQogICAgY29uc3QgbmV3Q29ubmVjdGlvbklkID0gYGNvbm5fJHtub2RlSWR9XyR7c2VsZWN0ZWRPdXRwdXRQb3J0fV8ke3RhcmdldE5vZGVJZH1gOw0KICAgIGNvbnN0IG5ld0Nvbm5lY3Rpb24gPSB7DQogICAgICAgIGlkOiBuZXdDb25uZWN0aW9uSWQsDQogICAgICAgIGZyb206IHsgbm9kZUlkOiBub2RlSWQsIHBvcnROYW1lOiBzZWxlY3RlZE91dHB1dFBvcnQgfSwNCiAgICAgICAgdG86IHsgbm9kZUlkOiB0YXJnZXROb2RlSWQsIHBvcnROYW1lOiBjb25uZWN0aW9uc1RvUmVtb3ZlWzBdPy50by5wb3J0TmFtZSB8fCAnZGF0YScgfQ0KICAgIH07DQogICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5zZXQobmV3Q29ubmVjdGlvbklkLCBuZXdDb25uZWN0aW9uKTsNCiAgICBkcmF3Q29ubmVjdGlvbihuZXdDb25uZWN0aW9uKTsNCiAgICAvLyBSZWZyZXNoIHRoZSB0YXJnZXQgbm9kZSBpZiBzZWxlY3RlZA0KICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9PT0gdGFyZ2V0Tm9kZUlkKSB7DQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgc2hvd05vZGVDb25maWcodGFyZ2V0Tm9kZUlkKTsNCiAgICAgICAgfSwgMTApOw0KICAgIH0NCiAgICAvLyBBdXRvLXNhdmUNCiAgICBpZiAoc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLnNhdmVGbG93KSBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmlsZU1hbmFnZXIuc2F2ZUZsb3coKTsNCn0NCg0KDQovLyBub2RlLXJlZ2lzdHJ5LmpzIC0gRHluYW1pYyBub2RlIHJlZ2lzdHJ5IGZvciBGbG93IEVkaXRvcg0KDQpjbGFzcyBOb2RlUmVnaXN0cnkgew0KICAgIGNvbnN0cnVjdG9yKCkgew0KICAgICAgICB0aGlzLm5vZGVUeXBlcyA9IG5ldyBNYXAoKTsNCiAgICAgICAgdGhpcy5leGVjdXRvcnMgPSBuZXcgTWFwKCk7DQogICAgICAgIHRoaXMubG9hZGVkID0gZmFsc2U7DQogICAgfQ0KICAgIA0KICAgIGFzeW5jIGxvYWROb2Rlc0Zyb21WRlMoKSB7DQogICAgICAgIGlmICh0aGlzLmxvYWRlZCkgcmV0dXJuOw0KICAgICAgICANCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTG9hZCB0aGUgcGFja2VkIG5vZGVzIGZpbGUgZGlyZWN0bHkNCiAgICAgICAgICAgIGNvbnN0IHBhY2tGaWxlUGF0aCA9ICcvYXBwcy9pbnN0YWxsZWQvZmxvd19lZGl0b3Ivbm9kZXMtcGFjay5qc29uJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVUZXh0KHBhY2tGaWxlUGF0aCk7DQogICAgICAgICAgICBjb25zdCBwYWNrRGF0YSA9IEpTT04ucGFyc2UoY29udGVudCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUmVnaXN0ZXIgYWxsIG5vZGVzIGZyb20gdGhlIHBhY2sNCiAgICAgICAgICAgIGZvciAoY29uc3QgW25vZGVJZCwgbm9kZURlZl0gb2YgT2JqZWN0LmVudHJpZXMocGFja0RhdGEubm9kZXMpKSB7DQogICAgICAgICAgICAgICAgdGhpcy5yZWdpc3Rlck5vZGUobm9kZURlZik7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIHRoaXMubG9hZGVkID0gdHJ1ZTsNCiAgICAgICAgICAgIA0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgbm9kZXMgZnJvbSBWRlMgcGFja2VkIGZpbGU6JywgZXJyb3IpOw0KICAgICAgICAgICAgdGhyb3cgZXJyb3I7IC8vIFJlLXRocm93IHRvIGluZGljYXRlIGZhaWx1cmUNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICBhc3luYyBsb2FkTm9kZUZpbGUoZmlsZVBhdGgpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlVGV4dChmaWxlUGF0aCk7DQogICAgICAgICAgICBjb25zdCBub2RlRGVmID0gSlNPTi5wYXJzZShjb250ZW50KTsNCiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJOb2RlKG5vZGVEZWYpOw0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGxvYWQgbm9kZSBmcm9tICR7ZmlsZVBhdGh9OmAsIGVycm9yKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICByZWdpc3Rlck5vZGUobm9kZURlZikgew0KICAgICAgICB0aGlzLm5vZGVUeXBlcy5zZXQobm9kZURlZi5pZCwgbm9kZURlZik7DQogICAgfQ0KICAgIA0KICAgIHJlZ2lzdGVyRXhlY3V0b3IobmFtZSwgZXhlY3V0b3IpIHsNCiAgICAgICAgdGhpcy5leGVjdXRvcnMuc2V0KG5hbWUsIGV4ZWN1dG9yKTsNCiAgICB9DQogICAgDQogICAgZ2V0Tm9kZVR5cGUoaWQpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMubm9kZVR5cGVzLmdldChpZCk7DQogICAgfQ0KICAgIA0KICAgIGdldEV4ZWN1dG9yKG5hbWUpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuZXhlY3V0b3JzLmdldChuYW1lKTsNCiAgICB9DQogICAgDQogICAgZ2V0QWxsTm9kZVR5cGVzKCkgew0KICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLm5vZGVUeXBlcy52YWx1ZXMoKSk7DQogICAgfQ0KICAgIA0KICAgIGdldE5vZGVUeXBlc0J5Q2F0ZWdvcnkoY2F0ZWdvcnkpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsTm9kZVR5cGVzKCkuZmlsdGVyKG5vZGUgPT4gbm9kZS5jYXRlZ29yeSA9PT0gY2F0ZWdvcnkpOw0KICAgIH0NCn0NCg0KLy8gR2xvYmFsIG5vZGUgcmVnaXN0cnkgaW5zdGFuY2UNCmNvbnN0IG5vZGVSZWdpc3RyeSA9IG5ldyBOb2RlUmVnaXN0cnkoKTsNCg0KDQovLyBjYW52YXMuanMgLSBDYW52YXMgZXZlbnQgaGFuZGxlcnMgYW5kIGRyYXdpbmcgbG9naWMgZm9yIEZsb3cgRWRpdG9yDQoNCi8vIFN0YXJ0IGRyYWdnaW5nIGEgbm9kZQ0KZnVuY3Rpb24gc3RhcnREcmFnZ2luZ05vZGUobm9kZUlkLCBlKSB7DQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgDQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlKSByZXR1cm47DQogICAgDQogICAgZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUgPSBub2RlSWQ7DQogICAgDQogICAgLy8gQ2FsY3VsYXRlIG9mZnNldCBmcm9tIG1vdXNlIHRvIG5vZGUgY29ybmVyIHVzaW5nIHNjYWxlZCBjb29yZGluYXRlcw0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICBjb25zdCByZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8gDQogICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3Qobm9kZUVsZW1lbnQpIDogDQogICAgICAgIG5vZGVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPyANCiAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDogDQogICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICANCiAgICBmbG93RWRpdG9yLmRyYWdPZmZzZXQgPSB7DQogICAgICAgIHg6IG1vdXNlQ29vcmRzLnggLSByZWN0LmxlZnQsDQogICAgICAgIHk6IG1vdXNlQ29vcmRzLnkgLSByZWN0LnRvcA0KICAgIH07DQogICAgDQogICAgbm9kZUVsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ2dyYWJiaW5nJzsNCiAgICBub2RlRWxlbWVudC5zdHlsZS56SW5kZXggPSAnMTAwMCc7IC8vIEJyaW5nIHRvIGZyb250IHdoaWxlIGRyYWdnaW5nDQogICAgDQogICAgLy8gQ2FjaGUgY2FudmFzIHJlY3QgZm9yIHBlcmZvcm1hbmNlIChzY2FsZWQpDQogICAgZmxvd0VkaXRvci5jYW52YXNSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8gDQogICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoZmxvd0VkaXRvci5jYW52YXMpIDogDQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KfQ0KDQovLyBTZWxlY3QgYSBub2RlDQpmdW5jdGlvbiBzZWxlY3ROb2RlKG5vZGVJZCkgew0KICAgIC8vIFJlbW92ZSBwcmV2aW91cyBzZWxlY3Rpb24NCiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmxvdy1ub2RlLnNlbGVjdGVkJykuZm9yRWFjaChub2RlID0+IHsNCiAgICAgICAgbm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpOw0KICAgIH0pOw0KICAgIA0KICAgIC8vIFNlbGVjdCBuZXcgbm9kZQ0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTsNCiAgICAgICAgZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPSBub2RlSWQ7DQogICAgICAgIHNob3dOb2RlQ29uZmlnKG5vZGVJZCk7DQogICAgfQ0KfQ0KDQoNCi8vIFN0YXJ0IGEgY29ubmVjdGlvbiBmcm9tIGEgcG9ydA0KZnVuY3Rpb24gc3RhcnRDb25uZWN0aW9uKG5vZGVJZCwgcG9ydE5hbWUsIGlzT3V0cHV0KSB7DQogICAgaWYgKGlzT3V0cHV0KSB7DQogICAgICAgIC8vIFN0YXJ0aW5nIGZyb20gb3V0cHV0IHBvcnQNCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbSA9IHsNCiAgICAgICAgICAgIG5vZGVJZDogbm9kZUlkLA0KICAgICAgICAgICAgcG9ydE5hbWU6IHBvcnROYW1lLA0KICAgICAgICAgICAgaXNPdXRwdXQ6IHRydWUNCiAgICAgICAgfTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBTdGFydGluZyBmcm9tIGlucHV0IHBvcnQgLSBjaGVjayBpZiB3ZSBoYXZlIGEgcGVuZGluZyBjb25uZWN0aW9uDQogICAgICAgIGlmIChmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tICYmIGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20uaXNPdXRwdXQpIHsNCiAgICAgICAgICAgIC8vIENvbXBsZXRlIHRoZSBjb25uZWN0aW9uDQogICAgICAgICAgICBjb25zdCBmcm9tTm9kZUlkID0gZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbS5ub2RlSWQ7DQogICAgICAgICAgICBjb25zdCBmcm9tUG9ydCA9IGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20ucG9ydE5hbWU7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNyZWF0ZUNvbm5lY3Rpb24oZnJvbU5vZGVJZCwgZnJvbVBvcnQsIG5vZGVJZCwgcG9ydE5hbWUpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbSA9IG51bGw7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIFVwZGF0ZSBjb25uZWN0aW9ucyBmb3IgYSBzcGVjaWZpYyBub2RlDQpmdW5jdGlvbiB1cGRhdGVDb25uZWN0aW9uc0Zvck5vZGUobm9kZUlkKSB7DQogICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IG5vZGVJZCB8fCBjb25uZWN0aW9uLnRvLm5vZGVJZCA9PT0gbm9kZUlkKSB7DQogICAgICAgICAgICB1cGRhdGVDb25uZWN0aW9uKGNvbm5lY3Rpb24pOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBVcGRhdGUgYSBzaW5nbGUgY29ubmVjdGlvbg0KZnVuY3Rpb24gdXBkYXRlQ29ubmVjdGlvbihjb25uZWN0aW9uKSB7DQogICAgY29uc3QgZnJvbU5vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0aW9uLmZyb20ubm9kZUlkKTsNCiAgICBjb25zdCB0b05vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgDQogICAgaWYgKCFmcm9tTm9kZSB8fCAhdG9Ob2RlIHx8ICFjb25uZWN0aW9uLnN2Zykgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIEdldCBub2RlIGRhdGEgcG9zaXRpb25zDQogICAgY29uc3QgZnJvbU5vZGVEYXRhID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCk7DQogICAgY29uc3QgdG9Ob2RlRGF0YSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICANCiAgICBpZiAoIWZyb21Ob2RlRGF0YSB8fCAhdG9Ob2RlRGF0YSkgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIEdldCBhY3R1YWwgbm9kZSBkaW1lbnNpb25zIGZyb20gY29tcHV0ZWQgc3R5bGVzDQogICAgY29uc3QgZnJvbVN0eWxlcyA9IHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5nZXRDb21wdXRlZFN0eWxlKGZyb21Ob2RlKTsNCiAgICBjb25zdCB0b1N0eWxlcyA9IHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5nZXRDb21wdXRlZFN0eWxlKHRvTm9kZSk7DQogICAgDQogICAgY29uc3QgZnJvbVdpZHRoID0gcGFyc2VGbG9hdChmcm9tU3R5bGVzLndpZHRoKSB8fCAyMDA7DQogICAgY29uc3QgZnJvbUhlaWdodCA9IHBhcnNlRmxvYXQoZnJvbVN0eWxlcy5oZWlnaHQpIHx8IDgwOw0KICAgIGNvbnN0IHRvV2lkdGggPSBwYXJzZUZsb2F0KHRvU3R5bGVzLndpZHRoKSB8fCAyMDA7DQogICAgY29uc3QgdG9IZWlnaHQgPSBwYXJzZUZsb2F0KHRvU3R5bGVzLmhlaWdodCkgfHwgODA7DQogICAgDQogICAgLy8gQ2FsY3VsYXRlIGNvbm5lY3Rpb24gcG9zaXRpb25zIGRpcmVjdGx5IGZyb20gbm9kZSBkYXRhIChubyBleHRyYSB0cmFuc2Zvcm1zKQ0KICAgIC8vIEZyb20gb3V0cHV0IHBvcnQgKHJpZ2h0IHNpZGUgb2YgZnJvbSBub2RlLCBtaWRkbGUgdmVydGljYWxseSkNCiAgICBjb25zdCBmcm9tWCA9IGZyb21Ob2RlRGF0YS54ICsgZnJvbVdpZHRoOw0KICAgIGNvbnN0IGZyb21ZID0gZnJvbU5vZGVEYXRhLnkgKyBmcm9tSGVpZ2h0IC8gMjsNCiAgICANCiAgICAvLyBUbyBpbnB1dCBwb3J0IChsZWZ0IHNpZGUgb2YgdG8gbm9kZSwgbWlkZGxlIHZlcnRpY2FsbHkpICANCiAgICBjb25zdCB0b1ggPSB0b05vZGVEYXRhLng7DQogICAgY29uc3QgdG9ZID0gdG9Ob2RlRGF0YS55ICsgdG9IZWlnaHQgLyAyOw0KICAgIA0KICAgIA0KICAgIC8vIFVwZGF0ZSB0aGUgcGF0aA0KICAgIGNvbnN0IHBhdGggPSBjb25uZWN0aW9uLnN2Zy5xdWVyeVNlbGVjdG9yKCdwYXRoJyk7DQogICAgaWYgKHBhdGgpIHsNCiAgICAgICAgY29uc3QgY29udHJvbFBvaW50MVggPSBmcm9tWCArICh0b1ggLSBmcm9tWCkgKiAwLjU7DQogICAgICAgIGNvbnN0IGNvbnRyb2xQb2ludDJYID0gZnJvbVggKyAodG9YIC0gZnJvbVgpICogMC41Ow0KICAgICAgICBjb25zdCBwYXRoRCA9IGBNICR7ZnJvbVh9ICR7ZnJvbVl9IEMgJHtjb250cm9sUG9pbnQxWH0gJHtmcm9tWX0gJHtjb250cm9sUG9pbnQyWH0gJHt0b1l9ICR7dG9YfSAke3RvWX1gOw0KICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnZCcsIHBhdGhEKTsNCiAgICB9IGVsc2Ugew0KICAgIH0NCn0NCg0KLy8gUmVkcmF3IGFsbCBjb25uZWN0aW9ucyAoZm9yIHdpbmRvdyByZXNpemUsIGV0Yy4pDQpmdW5jdGlvbiByZWRyYXdBbGxDb25uZWN0aW9ucygpIHsNCiAgICAvLyBQcmV2ZW50IG92ZXJ3aGVsbWluZyB0aGUgc3lzdGVtIHdpdGggdG9vIG1hbnkgcmVkcmF3cw0KICAgIGlmIChmbG93RWRpdG9yLnJlZHJhd0luUHJvZ3Jlc3MpIHJldHVybjsNCiAgICBmbG93RWRpdG9yLnJlZHJhd0luUHJvZ3Jlc3MgPSB0cnVlOw0KICAgIA0KICAgIC8vIFVzZSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgZm9yIHNtb290aCByZWRyYXdpbmcNCiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gew0KICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICAgICAgdXBkYXRlQ29ubmVjdGlvbihjb25uZWN0aW9uKTsNCiAgICAgICAgfQ0KICAgICAgICBmbG93RWRpdG9yLnJlZHJhd0luUHJvZ3Jlc3MgPSBmYWxzZTsNCiAgICB9KTsNCn0NCg0KLy8gRGVsZXRlIGEgbm9kZSBhbmQgYWxsIGl0cyBjb25uZWN0aW9ucw0KYXN5bmMgZnVuY3Rpb24gZGVsZXRlTm9kZShub2RlSWQpIHsNCiAgICBjb25zdCBjb25maXJtZWQgPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0NvbmZpcm1hdGlvbigNCiAgICAgICAgJ0RlbGV0ZSBOb2RlJywNCiAgICAgICAgJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyBub2RlPycsDQogICAgICAgIHsNCiAgICAgICAgICAgIHR5cGU6ICdkYW5nZXInLA0KICAgICAgICAgICAgY29uZmlybVRleHQ6ICdEZWxldGUnLA0KICAgICAgICAgICAgY2FuY2VsVGV4dDogJ0NhbmNlbCcsDQogICAgICAgICAgICBpY29uOiAnZmFzIGZhLWN1YmUnDQogICAgICAgIH0NCiAgICApOw0KICAgIA0KICAgIGlmIChjb25maXJtZWQpIHsNCiAgICAgICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhbiB1cCBhdWRpbyBlbGVtZW50cyBpZiB0aGlzIGlzIGFuIGF1ZGlvIG5vZGUNCiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS50eXBlID09PSAnYXVkaW8nICYmIG5vZGUuYXVkaW9FbGVtZW50KSB7DQogICAgICAgICAgICAvLyBQYXVzZSBhbmQgc3RvcCB0aGUgYXVkaW8NCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnBhdXNlKCk7DQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5jdXJyZW50VGltZSA9IDA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFJlbW92ZSBldmVudCBsaXN0ZW5lcnMgcHJvcGVybHkNCiAgICAgICAgICAgIGlmIChub2RlLmF1ZGlvRXZlbnRMaXN0ZW5lcnMpIHsNCiAgICAgICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdlbmRlZCcsIG5vZGUuYXVkaW9FdmVudExpc3RlbmVycy5lbmRlZCk7DQogICAgICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZXJyb3InLCBub2RlLmF1ZGlvRXZlbnRMaXN0ZW5lcnMuZXJyb3IpOw0KICAgICAgICAgICAgICAgIG5vZGUuYXVkaW9FdmVudExpc3RlbmVycyA9IG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFN0b3JlIHRoZSBzcmMgYmVmb3JlIGNsZWFyaW5nIGl0IGZvciBjbGVhbnVwDQogICAgICAgICAgICBjb25zdCBhdWRpb1NyYyA9IG5vZGUuYXVkaW9FbGVtZW50LnNyYzsNCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnNyYyA9ICcnOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBSZXZva2UgYmxvYiBVUkwgaWYgaXQgZXhpc3RzDQogICAgICAgICAgICBpZiAoYXVkaW9TcmMgJiYgYXVkaW9TcmMuc3RhcnRzV2l0aCgnYmxvYjonKSkgew0KICAgICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwoYXVkaW9TcmMpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDbGVhciB0aGUgYXVkaW8gZWxlbWVudCByZWZlcmVuY2UNCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50ID0gbnVsbDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gUmVtb3ZlIGFsbCBjb25uZWN0aW9ucyBpbnZvbHZpbmcgdGhpcyBub2RlDQogICAgICAgIGNvbnN0IGNvbm5lY3Rpb25zVG9EZWxldGUgPSBbXTsNCiAgICAgICAgZm9yIChjb25zdCBbY29ubmVjdGlvbklkLCBjb25uZWN0aW9uXSBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmVudHJpZXMoKSkgew0KICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IG5vZGVJZCB8fCBjb25uZWN0aW9uLnRvLm5vZGVJZCA9PT0gbm9kZUlkKSB7DQogICAgICAgICAgICAgICAgY29ubmVjdGlvbnNUb0RlbGV0ZS5wdXNoKGNvbm5lY3Rpb25JZCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIERlbGV0ZSBjb25uZWN0aW9ucw0KICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb25JZCBvZiBjb25uZWN0aW9uc1RvRGVsZXRlKSB7DQogICAgICAgICAgICBkZWxldGVDb25uZWN0aW9uKGNvbm5lY3Rpb25JZCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFJlbW92ZSBub2RlIGZyb20gZGF0YSBzdHJ1Y3R1cmUNCiAgICAgICAgZmxvd0VkaXRvci5ub2Rlcy5kZWxldGUobm9kZUlkKTsNCiAgICAgICAgDQogICAgICAgIC8vIFJlbW92ZSBub2RlIGVsZW1lbnQgZnJvbSBET00NCiAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LnJlbW92ZSgpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBEZXNlbGVjdCBpZiB0aGlzIHdhcyB0aGUgc2VsZWN0ZWQgbm9kZQ0KICAgICAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPT09IG5vZGVJZCkgew0KICAgICAgICAgICAgZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPSBudWxsOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUtY29uZmlnJykuaW5uZXJIVE1MID0gJzxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5TZWxlY3QgYSBub2RlIHRvIGNvbmZpZ3VyZSBpdDwvcD4nOw0KICAgICAgICB9DQogICAgICAgIA0KICAgIH0NCn0NCg0KLy8gRGVsZXRlIGEgY29ubmVjdGlvbg0KZnVuY3Rpb24gZGVsZXRlQ29ubmVjdGlvbihjb25uZWN0aW9uSWQpIHsNCiAgICBjb25zdCBjb25uZWN0aW9uID0gZmxvd0VkaXRvci5jb25uZWN0aW9ucy5nZXQoY29ubmVjdGlvbklkKTsNCiAgICBpZiAoY29ubmVjdGlvbiAmJiBjb25uZWN0aW9uLnN2Zykgew0KICAgICAgICBjb25uZWN0aW9uLnN2Zy5yZW1vdmUoKTsNCiAgICB9DQogICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5kZWxldGUoY29ubmVjdGlvbklkKTsNCn0NCg0KLy8gRGVsZXRlIHNlbGVjdGVkIG5vZGUNCmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVNlbGVjdGVkTm9kZSgpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpIHsNCiAgICAgICAgYXdhaXQgZGVsZXRlTm9kZShmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSk7DQogICAgfQ0KfQ0KDQovLyBIYW5kbGUgcG9ydCBtb3VzZSBldmVudHMgZm9yIGNvbm5lY3Rpb25zDQpmdW5jdGlvbiBoYW5kbGVQb3J0TW91c2VEb3duKGUsIG5vZGVJZCwgcG9ydE5hbWUsIGlzT3V0cHV0KSB7DQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgDQogICAgaWYgKGlzT3V0cHV0KSB7DQogICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20gPSB7IG5vZGVJZCwgcG9ydE5hbWUgfTsNCiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmFkZCgnY29ubmVjdGluZycpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIGlmIChmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tKSB7DQogICAgICAgICAgICBjcmVhdGVDb25uZWN0aW9uKGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20ubm9kZUlkLCBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tLnBvcnROYW1lLCBub2RlSWQsIHBvcnROYW1lKTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20gPSBudWxsOw0KICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZsb3ctbm9kZS1wb3J0JykuZm9yRWFjaChwb3J0ID0+IHBvcnQuY2xhc3NMaXN0LnJlbW92ZSgnY29ubmVjdGluZycpKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gQ3JlYXRlIGEgY29ubmVjdGlvbiBiZXR3ZWVuIG5vZGVzDQpmdW5jdGlvbiBjcmVhdGVDb25uZWN0aW9uKGZyb21Ob2RlSWQsIGZyb21Qb3J0LCB0b05vZGVJZCwgdG9Qb3J0KSB7DQogICAgLy8gQ2hlY2sgaWYgY29ubmVjdGlvbiBhbHJlYWR5IGV4aXN0cw0KICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBmcm9tTm9kZUlkICYmIA0KICAgICAgICAgICAgY29ubmVjdGlvbi5mcm9tLnBvcnROYW1lID09PSBmcm9tUG9ydCAmJg0KICAgICAgICAgICAgY29ubmVjdGlvbi50by5ub2RlSWQgPT09IHRvTm9kZUlkICYmIA0KICAgICAgICAgICAgY29ubmVjdGlvbi50by5wb3J0TmFtZSA9PT0gdG9Qb3J0KSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgY29uc3QgY29ubmVjdGlvbklkID0gYGNvbm5fJHtmcm9tTm9kZUlkfV8ke2Zyb21Qb3J0fV8ke3RvTm9kZUlkfV8ke3RvUG9ydH1gOw0KICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB7DQogICAgICAgIGlkOiBjb25uZWN0aW9uSWQsDQogICAgICAgIGZyb206IHsgbm9kZUlkOiBmcm9tTm9kZUlkLCBwb3J0TmFtZTogZnJvbVBvcnQgfSwNCiAgICAgICAgdG86IHsgbm9kZUlkOiB0b05vZGVJZCwgcG9ydE5hbWU6IHRvUG9ydCB9DQogICAgfTsNCiAgICANCiAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnNldChjb25uZWN0aW9uSWQsIGNvbm5lY3Rpb24pOw0KICAgIGRyYXdDb25uZWN0aW9uKGNvbm5lY3Rpb24pOw0KICAgIA0KfQ0KDQovLyBEcmF3IGEgY29ubmVjdGlvbiBvbiB0aGUgY2FudmFzDQpmdW5jdGlvbiBkcmF3Q29ubmVjdGlvbihjb25uZWN0aW9uKSB7DQogICAgY29uc3QgZnJvbU5vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0aW9uLmZyb20ubm9kZUlkKTsNCiAgICBjb25zdCB0b05vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgDQogICAgaWYgKCFmcm9tTm9kZSB8fCAhdG9Ob2RlKSByZXR1cm47DQogICAgDQogICAgLy8gQ3JlYXRlIFNWRyBlbGVtZW50IGZvciB0aGUgY29ubmVjdGlvbg0KICAgIGNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7DQogICAgc3ZnLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsNCiAgICBzdmcuc3R5bGUudG9wID0gJzAnOw0KICAgIHN2Zy5zdHlsZS5sZWZ0ID0gJzAnOw0KICAgIHN2Zy5zdHlsZS53aWR0aCA9ICcxMDAlJzsNCiAgICBzdmcuc3R5bGUuaGVpZ2h0ID0gJzEwMCUnOw0KICAgIHN2Zy5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnOyAvLyBEb24ndCBjYXB0dXJlIGV2ZW50cyBieSBkZWZhdWx0DQogICAgc3ZnLnN0eWxlLnpJbmRleCA9ICcxJzsNCiAgICBzdmcuZGF0YXNldC5jb25uZWN0aW9uSWQgPSBjb25uZWN0aW9uLmlkOw0KICAgIA0KICAgIGNvbnN0IHBhdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BhdGgnKTsNCiAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJyM0Q0FGNTAnKTsNCiAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzInKTsNCiAgICBwYXRoLnNldEF0dHJpYnV0ZSgnZmlsbCcsICdub25lJyk7DQogICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ21hcmtlci1lbmQnLCAndXJsKCNhcnJvd2hlYWQpJyk7DQogICAgcGF0aC5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7DQogICAgcGF0aC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ2F1dG8nOyAvLyBPbmx5IHRoZSBwYXRoIGNhcHR1cmVzIGV2ZW50cw0KICAgIA0KICAgIC8vIEFkZCBob3ZlciBlZmZlY3RzDQogICAgcGF0aC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4gew0KICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzQnKTsNCiAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICcjZmY2YjZiJyk7DQogICAgICAgIC8vIFNob3cgZGVsZXRlIHRvb2x0aXANCiAgICAgICAgc2hvd0Nvbm5lY3Rpb25Ub29sdGlwKGNvbm5lY3Rpb24uaWQsICdDbGljayB0byBkZWxldGUgY29ubmVjdGlvbicpOw0KICAgIH0pOw0KICAgIA0KICAgIHBhdGguYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHsNCiAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7DQogICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCdzdHJva2UnLCAnIzRDQUY1MCcpOw0KICAgICAgICBoaWRlQ29ubmVjdGlvblRvb2x0aXAoKTsNCiAgICB9KTsNCiAgICANCiAgICAvLyBBZGQgY2xpY2sgdG8gZGVsZXRlDQogICAgcGF0aC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgIGNvbnN0IGNvbmZpcm1lZCA9IGF3YWl0IHN5cG5leEFQSS5zaG93Q29uZmlybWF0aW9uKA0KICAgICAgICAgICAgJ0RlbGV0ZSBDb25uZWN0aW9uJywNCiAgICAgICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgY29ubmVjdGlvbj8nLA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHR5cGU6ICdkYW5nZXInLA0KICAgICAgICAgICAgICAgIGNvbmZpcm1UZXh0OiAnRGVsZXRlJywNCiAgICAgICAgICAgICAgICBjYW5jZWxUZXh0OiAnQ2FuY2VsJywNCiAgICAgICAgICAgICAgICBpY29uOiAnZmFzIGZhLWxpbmsnDQogICAgICAgICAgICB9DQogICAgICAgICk7DQogICAgICAgIA0KICAgICAgICBpZiAoY29uZmlybWVkKSB7DQogICAgICAgICAgICBkZWxldGVDb25uZWN0aW9uKGNvbm5lY3Rpb24uaWQpOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgc3ZnLmFwcGVuZENoaWxkKHBhdGgpOw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFwcGVuZENoaWxkKHN2Zyk7DQogICAgDQogICAgLy8gU3RvcmUgU1ZHIHJlZmVyZW5jZQ0KICAgIGNvbm5lY3Rpb24uc3ZnID0gc3ZnOw0KICAgIA0KICAgIC8vIFVwZGF0ZSBjb25uZWN0aW9uIHBvc2l0aW9uDQogICAgdXBkYXRlQ29ubmVjdGlvbihjb25uZWN0aW9uKTsNCn0NCg0KLy8gU2hvdyBjb25uZWN0aW9uIHRvb2x0aXANCmZ1bmN0aW9uIHNob3dDb25uZWN0aW9uVG9vbHRpcChjb25uZWN0aW9uSWQsIG1lc3NhZ2UpIHsNCiAgICAvLyBDaGVjayBpZiBhcHAgaXMgc3RpbGwgYWN0aXZlDQogICAgaWYgKCFmbG93RWRpdG9yLmlzQWN0aXZlKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gUmVtb3ZlIGV4aXN0aW5nIHRvb2x0aXANCiAgICBoaWRlQ29ubmVjdGlvblRvb2x0aXAoKTsNCiAgICANCiAgICBjb25zdCB0b29sdGlwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgdG9vbHRpcC5jbGFzc05hbWUgPSAnY29ubmVjdGlvbi10b29sdGlwJzsNCiAgICB0b29sdGlwLnRleHRDb250ZW50ID0gbWVzc2FnZTsNCiAgICB0b29sdGlwLnN0eWxlLmNzc1RleHQgPSBgDQogICAgICAgIHBvc2l0aW9uOiBmaXhlZDsNCiAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjgpOw0KICAgICAgICBjb2xvcjogd2hpdGU7DQogICAgICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsNCiAgICAgICAgei1pbmRleDogMTAwMDA7DQogICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7DQogICAgICAgIGRpc3BsYXk6IG5vbmU7DQogICAgYDsNCiAgICANCiAgICB0b29sdGlwLmlkID0gJ2Nvbm5lY3Rpb24tdG9vbHRpcCc7DQogICAgDQogICAgLy8gVHJ5IHRvIGFwcGVuZCB0byBhcHAgY29udGFpbmVyIGZpcnN0LCBmYWxsYmFjayB0byBib2R5DQogICAgY29uc3QgYXBwQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFwcC1jb250YWluZXInKTsNCiAgICBjb25zdCBjb250YWluZXIgPSBhcHBDb250YWluZXIgfHwgZG9jdW1lbnQuYm9keTsNCiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodG9vbHRpcCk7DQogICAgDQogICAgLy8gUG9zaXRpb24gdG9vbHRpcCBuZWFyIG1vdXNlICh3aWxsIGJlIHVwZGF0ZWQgb24gbW91c2Vtb3ZlKQ0KICAgIGNvbnN0IHRvb2x0aXBNb3VzZU1vdmVIYW5kbGVyID0gKGUpID0+IHVwZGF0ZVRvb2x0aXBQb3NpdGlvbihlKTsNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0b29sdGlwTW91c2VNb3ZlSGFuZGxlcik7DQogICAgDQogICAgLy8gU3RvcmUgdGhlIGhhbmRsZXIgcmVmZXJlbmNlIGZvciBjbGVhbnVwDQogICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlciA9IHRvb2x0aXBNb3VzZU1vdmVIYW5kbGVyOw0KICAgIA0KICAgIC8vIFNob3cgdGhlIHRvb2x0aXAgYWZ0ZXIgYSBzbWFsbCBkZWxheSB0byBwcmV2ZW50IGZsaWNrZXJpbmcNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgaWYgKHRvb2x0aXAucGFyZW50Tm9kZSAmJiBmbG93RWRpdG9yLmlzQWN0aXZlKSB7DQogICAgICAgICAgICB0b29sdGlwLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICB9DQogICAgfSwgMTApOw0KfQ0KDQovLyBVcGRhdGUgdG9vbHRpcCBwb3NpdGlvbg0KZnVuY3Rpb24gdXBkYXRlVG9vbHRpcFBvc2l0aW9uKGUpIHsNCiAgICBjb25zdCB0b29sdGlwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nvbm5lY3Rpb24tdG9vbHRpcCcpOw0KICAgIGlmICh0b29sdGlwKSB7DQogICAgICAgIC8vIFVzZSBzY2FsZWQgY29vcmRpbmF0ZXMgZm9yIHRvb2x0aXAgcG9zaXRpb25pbmcNCiAgICAgICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDogDQogICAgICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgICAgIHRvb2x0aXAuc3R5bGUubGVmdCA9IChtb3VzZUNvb3Jkcy54ICsgMTApICsgJ3B4JzsNCiAgICAgICAgdG9vbHRpcC5zdHlsZS50b3AgPSAobW91c2VDb29yZHMueSAtIDEwKSArICdweCc7DQogICAgfQ0KfQ0KDQovLyBIaWRlIGNvbm5lY3Rpb24gdG9vbHRpcA0KZnVuY3Rpb24gaGlkZUNvbm5lY3Rpb25Ub29sdGlwKCkgew0KICAgIGNvbnN0IHRvb2x0aXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29ubmVjdGlvbi10b29sdGlwJyk7DQogICAgaWYgKHRvb2x0aXApIHsNCiAgICAgICAgLy8gUmVtb3ZlIHRoZSBzcGVjaWZpYyBldmVudCBsaXN0ZW5lciB3ZSBhZGRlZA0KICAgICAgICBpZiAoc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlcikgew0KICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlcik7DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyID0gbnVsbDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gSGlkZSBhbmQgcmVtb3ZlIHRoZSB0b29sdGlwDQogICAgICAgIHRvb2x0aXAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgaWYgKHRvb2x0aXAucGFyZW50Tm9kZSkgew0KICAgICAgICAgICAgdG9vbHRpcC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRvb2x0aXApOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBDbGVhciB0aGUgY2FudmFzDQphc3luYyBmdW5jdGlvbiBjbGVhckNhbnZhcygpIHsNCiAgICBjb25zdCBjb25maXJtZWQgPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0NvbmZpcm1hdGlvbigNCiAgICAgICAgJ0NsZWFyIENhbnZhcycsDQogICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gY2xlYXIgdGhlIGNhbnZhcz8gVGhpcyB3aWxsIGRlbGV0ZSBhbGwgbm9kZXMgYW5kIGNvbm5lY3Rpb25zLicsDQogICAgICAgIHsNCiAgICAgICAgICAgIHR5cGU6ICdkYW5nZXInLA0KICAgICAgICAgICAgY29uZmlybVRleHQ6ICdDbGVhciBBbGwnLA0KICAgICAgICAgICAgY2FuY2VsVGV4dDogJ0NhbmNlbCcsDQogICAgICAgICAgICBpY29uOiAnZmFzIGZhLXRyYXNoLWFsdCcNCiAgICAgICAgfQ0KICAgICk7DQogICAgDQogICAgaWYgKGNvbmZpcm1lZCkgew0KICAgICAgICBjbGVhckNhbnZhc1NpbGVudCgpOw0KICAgIH0NCn0NCg0KLy8gQ2xlYXIgdGhlIGNhbnZhcyB3aXRob3V0IGNvbmZpcm1hdGlvbiAodXNlZCBpbnRlcm5hbGx5KQ0KZnVuY3Rpb24gY2xlYXJDYW52YXNTaWxlbnQoKSB7DQogICAgLy8gSGlkZSBhbnkgYWN0aXZlIHRvb2x0aXBzDQogICAgaGlkZUNvbm5lY3Rpb25Ub29sdGlwKCk7DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciBhbGwgY29ubmVjdGlvbnMNCiAgICAgICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLnN2Zykgew0KICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24uc3ZnLnJlbW92ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuY2xlYXIoKTsNCiAgICAgICAgDQogICAgICAgIC8vIENsZWFyIGFsbCBub2Rlcw0KICAgICAgICBmb3IgKGNvbnN0IG5vZGVJZCBvZiBmbG93RWRpdG9yLm5vZGVzLmtleXMoKSkgew0KICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQucmVtb3ZlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZmxvd0VkaXRvci5ub2Rlcy5jbGVhcigpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgYWxsIHRhZ3MNCiAgICAgICAgZm9yIChjb25zdCB0YWdJZCBvZiBmbG93RWRpdG9yLnRhZ3Mua2V5cygpKSB7DQogICAgICAgICAgICBjb25zdCB0YWdFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFnSWQpOw0KICAgICAgICAgICAgaWYgKHRhZ0VsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICB0YWdFbGVtZW50LnJlbW92ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGZsb3dFZGl0b3IudGFncy5jbGVhcigpOw0KICAgICAgICANCiAgICAgICAgLy8gVXBkYXRlIHRhZyBwYW5lbCB0byByZWZsZWN0IGNsZWFyZWQgdGFncw0KICAgICAgICBpZiAodHlwZW9mIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS50YWdNYW5hZ2VyLnVwZGF0ZVRhZ1BhbmVsID09PSAnZnVuY3Rpb24nKSB7DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkudGFnTWFuYWdlci51cGRhdGVUYWdQYW5lbCgpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBSZXNldCBjb3VudGVycw0KICAgICAgICBmbG93RWRpdG9yLm5vZGVDb3VudGVyID0gMDsNCiAgICAgICAgZmxvd0VkaXRvci50YWdDb3VudGVyID0gMDsNCiAgICAgICAgZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPSBudWxsOw0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgY3VycmVudCBmaWxlIHBhdGgNCiAgICAgICAgZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGggPSBudWxsOw0KICAgICAgICANCiAgICAgICAgLy8gUmVzZXQgcGFuIG9mZnNldCB0byBjZW50ZXIgb2YgbGFyZ2UgY2FudmFzDQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0ID0geyB4OiAtNTAwMCwgeTogLTUwMDAgfTsNCiAgICAgICAgDQogICAgICAgIC8vIFJlc2V0IHpvb20gbGV2ZWwNCiAgICAgICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSAxLjA7DQogICAgICAgIA0KICAgICAgICBpZiAodHlwZW9mIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFVwZGF0ZSBmaWxlbmFtZSBkaXNwbGF5DQogICAgICAgIGlmICh0eXBlb2Ygc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLnVwZGF0ZUZpbGVuYW1lRGlzcGxheSA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLnVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciBjb25maWcgcGFuZWwNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUtY29uZmlnJykuaW5uZXJIVE1MID0gJzxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5TZWxlY3QgYSBub2RlIHRvIGNvbmZpZ3VyZSBpdDwvcD4nOw0KfSANCg0KDQovLyBTaG93IG5vZGUgY29uZmlndXJhdGlvbg0KYXN5bmMgZnVuY3Rpb24gc2hvd05vZGVDb25maWcobm9kZUlkKSB7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlKSByZXR1cm47DQogICAgDQogICAgY29uc3Qgbm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShub2RlLnR5cGUpOw0KICAgIGlmICghbm9kZURlZikgcmV0dXJuOw0KDQogICAgLy8gTG9hZCBzYXZlZCBjb25maWd1cmF0aW9uIHNlY3Rpb24gc3RhdGVzDQogICAgbGV0IHNlY3Rpb25TdGF0ZXMgPSB7fTsNCiAgICB0cnkgew0KICAgICAgICBpZiAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNldHRpbmcpIHsNCiAgICAgICAgICAgIC8vIExvYWQgc3RhdGVzIGZvciBhbGwgcG9zc2libGUgc2VjdGlvbnMNCiAgICAgICAgICAgIGNvbnN0IHNlY3Rpb25zID0gWydub2RlLWNvbnRlbnQnLCAnaW5wdXQtY29ubmVjdGlvbnMnLCAnb3V0cHV0LWNvbm5lY3Rpb25zJywgJ25vZGUtc2V0dGluZ3MnLCAnb3V0cHV0LWRhdGEnXTsNCiAgICAgICAgICAgIGZvciAoY29uc3Qgc2VjdGlvbklkIG9mIHNlY3Rpb25zKSB7DQogICAgICAgICAgICAgICAgLy8gRGVmYXVsdCB0byBleHBhbmRlZCBmb3Igbm9kZS1jb250ZW50LCBjb2xsYXBzZWQgZm9yIG90aGVycw0KICAgICAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRFeHBhbmRlZCA9IHNlY3Rpb25JZCA9PT0gJ25vZGUtY29udGVudCc7DQogICAgICAgICAgICAgICAgc2VjdGlvblN0YXRlc1tzZWN0aW9uSWRdID0gYXdhaXQgc3lwbmV4QVBJLmdldFNldHRpbmcoYGNvbmZpZ19zZWN0aW9uXyR7c2VjdGlvbklkfWAsIGRlZmF1bHRFeHBhbmRlZCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBsb2FkIGNvbmZpZyBzZWN0aW9uIHN0YXRlczonLCBlcnJvcik7DQogICAgICAgIC8vIFVzZSBkZWZhdWx0cyBpZiBsb2FkaW5nIGZhaWxzDQogICAgICAgIHNlY3Rpb25TdGF0ZXMgPSB7DQogICAgICAgICAgICAnbm9kZS1jb250ZW50JzogdHJ1ZSwNCiAgICAgICAgICAgICdpbnB1dC1jb25uZWN0aW9ucyc6IGZhbHNlLA0KICAgICAgICAgICAgJ291dHB1dC1jb25uZWN0aW9ucyc6IGZhbHNlLA0KICAgICAgICAgICAgJ25vZGUtc2V0dGluZ3MnOiBmYWxzZSwNCiAgICAgICAgICAgICdvdXRwdXQtZGF0YSc6IGZhbHNlDQogICAgICAgIH07DQogICAgfQ0KICAgIA0KICAgIC8vIFNob3cgY29uZmlnIHBhbmVsIHdpdGggbm9kZSBjb25maWd1cmF0aW9uDQogICAgY29uc3QgY29uZmlnUGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZS1jb25maWcnKTsNCiAgICBpZiAoY29uZmlnUGFuZWwpIHsNCiAgICAgICAgbGV0IGNvbmZpZ0h0bWwgPSBgPGg0PiR7bm9kZURlZi5uYW1lfSBDb25maWd1cmF0aW9uPC9oND5gOw0KICAgICAgICANCiAgICAgICAgLy8gQWRkIHNwZWNpYWwgY29udGVudCBkaXNwbGF5IGZvciBkaWZmZXJlbnQgbm9kZSB0eXBlcw0KICAgICAgICBsZXQgaGFzU3BlY2lhbENvbnRlbnQgPSBmYWxzZTsNCiAgICAgICAgbGV0IHNwZWNpYWxDb250ZW50SHRtbCA9ICcnOw0KICAgICAgICANCiAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ2Rpc3BsYXknICYmIG5vZGUubGFzdENvbnRlbnQpIHsNCiAgICAgICAgICAgIGhhc1NwZWNpYWxDb250ZW50ID0gdHJ1ZTsNCiAgICAgICAgICAgIHNwZWNpYWxDb250ZW50SHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkxhc3QgQ29udGVudDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQtZGlzcGxheSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8cHJlIGNsYXNzPSJjb250ZW50LXRleHQiPiR7ZXNjYXBlSHRtbChub2RlLmxhc3RDb250ZW50KX08L3ByZT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQtaW5mbyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPkZvcm1hdDogJHtub2RlLmxhc3RGb3JtYXR9IOKAoiBMZW5ndGg6ICR7bm9kZS5sYXN0Q29udGVudC5sZW5ndGh9IGNoYXJzPC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0gZWxzZSBpZiAobm9kZS50eXBlID09PSAnaW1hZ2UnICYmIG5vZGUubGFzdEltYWdlRGF0YSkgew0KICAgICAgICAgICAgaGFzU3BlY2lhbENvbnRlbnQgPSB0cnVlOw0KICAgICAgICAgICAgc3BlY2lhbENvbnRlbnRIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+SW1hZ2UgUHJldmlldzwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImltYWdlLWRpc3BsYXkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9IiR7bm9kZS5sYXN0SW1hZ2VVcmx9IiBhbHQ9IkltYWdlIHByZXZpZXciIHN0eWxlPSJtYXgtd2lkdGg6IDIwMHB4OyBtYXgtaGVpZ2h0OiAxNTBweDsgYm9yZGVyOiAxcHggc29saWQgI2NjYzsgYm9yZGVyLXJhZGl1czogNHB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbWFnZS1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+U2l6ZTogJHtub2RlLmxhc3RJbWFnZUluZm8/LndpZHRoIHx8ICc/J314JHtub2RlLmxhc3RJbWFnZUluZm8/LmhlaWdodCB8fCAnPyd9IOKAoiBGb3JtYXQ6ICR7bm9kZS5sYXN0SW1hZ2VJbmZvPy5mb3JtYXQgfHwgJz8nfTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLXByaW1hcnkgbXQtMiB2aWV3LWZ1bGwtaW1hZ2UtYnRuIiBkYXRhLW5vZGUtaWQ9IiR7bm9kZUlkfSI+VmlldyBGdWxsIEltYWdlPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09ICdhdWRpbycgJiYgbm9kZS5sYXN0QXVkaW9EYXRhKSB7DQogICAgICAgICAgICBoYXNTcGVjaWFsQ29udGVudCA9IHRydWU7DQogICAgICAgICAgICBzcGVjaWFsQ29udGVudEh0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5BdWRpbyBDb250cm9sczwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImF1ZGlvLWRpc3BsYXkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXVkaW8taW5mbyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPkF1ZGlvIGxvYWRlZCBzdWNjZXNzZnVsbHk8L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhdWRpby1jb250cm9scyBtdC0yIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1zdWNjZXNzIHBsYXktYXVkaW8tYnRuIiBkYXRhLW5vZGUtaWQ9IiR7bm9kZUlkfSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtcGxheSI+PC9pPiBQbGF5DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tZGFuZ2VyIHN0b3AtYXVkaW8tYnRuIiBkYXRhLW5vZGUtaWQ9IiR7bm9kZUlkfSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc3RvcCI+PC9pPiBTdG9wDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9IGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ3Zmc19sb2FkJykgew0KICAgICAgICAgICAgaGFzU3BlY2lhbENvbnRlbnQgPSB0cnVlOw0KICAgICAgICAgICAgc3BlY2lhbENvbnRlbnRIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+VkZTIExvYWQgU3RhdHVzPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idmZzLWxvYWQtaW5mbyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+TGFzdCBsb2FkZWQ6ICR7bm9kZS5sYXN0TG9hZGVkRmlsZSB8fCAnTm9uZSd9PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9IGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ2xsbV9jaGF0JyAmJiBub2RlLmxhc3RSZXNwb25zZSkgew0KICAgICAgICAgICAgaGFzU3BlY2lhbENvbnRlbnQgPSB0cnVlOw0KICAgICAgICAgICAgc3BlY2lhbENvbnRlbnRIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+TGFzdCBSZXNwb25zZTwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQtZGlzcGxheSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8cHJlIGNsYXNzPSJjb250ZW50LXRleHQiPiR7ZXNjYXBlSHRtbChub2RlLmxhc3RSZXNwb25zZSl9PC9wcmU+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50LWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5Ub2tlbnM6ICR7bm9kZS5sYXN0VXNhZ2U/LnRvdGFsX3Rva2VucyB8fCAwfSDigKIgTW9kZWw6ICR7bm9kZS5sYXN0TW9kZWwgfHwgJ1Vua25vd24nfTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9IGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ3JlcGVhdGVyJykgew0KICAgICAgICAgICAgaGFzU3BlY2lhbENvbnRlbnQgPSB0cnVlOw0KICAgICAgICAgICAgY29uc3QgaXNSdW5uaW5nID0gbm9kZS5yZXBlYXRlclN0YXRlICYmIG5vZGUucmVwZWF0ZXJTdGF0ZS5pc1J1bm5pbmc7DQogICAgICAgICAgICBjb25zdCBjb3VudCA9IG5vZGUucmVwZWF0ZXJTdGF0ZSA/IG5vZGUucmVwZWF0ZXJTdGF0ZS5jb3VudCA6IDA7DQogICAgICAgICAgICBzcGVjaWFsQ29udGVudEh0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5SZXBlYXRlciBDb250cm9sczwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJlcGVhdGVyLWRpc3BsYXkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmVwZWF0ZXItaW5mbyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPlN0YXR1czogJHtpc1J1bm5pbmcgPyAnUnVubmluZycgOiAnU3RvcHBlZCd9IOKAoiBDb3VudDogJHtjb3VudH08L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyZXBlYXRlci1jb250cm9scyBtdC0yIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1zdWNjZXNzIHN0YXJ0LXJlcGVhdGVyLWJ0biIgZGF0YS1ub2RlLWlkPSIke25vZGVJZH0iICR7aXNSdW5uaW5nID8gJ2Rpc2FibGVkJyA6ICcnfT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1wbGF5Ij48L2k+IFN0YXJ0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tZGFuZ2VyIHN0b3AtcmVwZWF0ZXItYnRuIiBkYXRhLW5vZGUtaWQ9IiR7bm9kZUlkfSIgJHshaXNSdW5uaW5nID8gJ2Rpc2FibGVkJyA6ICcnfT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1zdG9wIj48L2k+IFN0b3ANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFdyYXAgc3BlY2lhbCBjb250ZW50IGluIGEgY29sbGFwc2libGUgc2VjdGlvbiBpZiBwcmVzZW50DQogICAgICAgIGlmIChoYXNTcGVjaWFsQ29udGVudCkgew0KICAgICAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9IHNlY3Rpb25TdGF0ZXNbJ25vZGUtY29udGVudCddOw0KICAgICAgICAgICAgY29uc3QgaGVhZGVyQ2xhc3MgPSBpc0V4cGFuZGVkID8gJycgOiAnY29sbGFwc2VkJzsNCiAgICAgICAgICAgIGNvbnN0IGljb25DbGFzcyA9IGlzRXhwYW5kZWQgPyAnZmFzIGZhLWNoZXZyb24tZG93bicgOiAnZmFzIGZhLWNoZXZyb24tcmlnaHQnOw0KICAgICAgICAgICAgY29uc3QgY29udGVudFN0eWxlID0gaXNFeHBhbmRlZCA/ICcnIDogJyBzdHlsZT0iZGlzcGxheTogbm9uZTsiJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24iPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctc2VjdGlvbi1oZWFkZXIgJHtoZWFkZXJDbGFzc30iIGRhdGEtc2VjdGlvbj0ibm9kZS1jb250ZW50Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSIke2ljb25DbGFzc30iPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPk5vZGUgQ29udGVudDwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWNvbnRlbnQiIGlkPSJub2RlLWNvbnRlbnQtY29udGVudCIke2NvbnRlbnRTdHlsZX0+DQogICAgICAgICAgICAgICAgICAgICAgICAke3NwZWNpYWxDb250ZW50SHRtbH0NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBTaG93IGlucHV0IG1hcHBpbmdzIGNvbmZpZ3VyYXRpb24gKHdoYXQgdGhpcyBub2RlIHJlY2VpdmVzIGZyb20gb3RoZXIgbm9kZXMpDQogICAgICAgIGNvbnN0IGlucHV0Q29ubmVjdGlvbnMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpDQogICAgICAgICAgICAuZmlsdGVyKGNvbm4gPT4gY29ubi50by5ub2RlSWQgPT09IG5vZGVJZCk7DQogICAgICAgIA0KICAgICAgICBpZiAoaW5wdXRDb25uZWN0aW9ucy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gc2VjdGlvblN0YXRlc1snaW5wdXQtY29ubmVjdGlvbnMnXTsNCiAgICAgICAgICAgIGNvbnN0IGhlYWRlckNsYXNzID0gaXNFeHBhbmRlZCA/ICcnIDogJ2NvbGxhcHNlZCc7DQogICAgICAgICAgICBjb25zdCBpY29uQ2xhc3MgPSBpc0V4cGFuZGVkID8gJ2ZhcyBmYS1jaGV2cm9uLWRvd24nIDogJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRTdHlsZSA9IGlzRXhwYW5kZWQgPyAnJyA6ICcgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Iic7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uIj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24taGVhZGVyICR7aGVhZGVyQ2xhc3N9IiBkYXRhLXNlY3Rpb249ImlucHV0LWNvbm5lY3Rpb25zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSIke2ljb25DbGFzc30iPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPklucHV0IENvbm5lY3Rpb25zPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsIGNsYXNzPSJjb25maWctY291bnQiPigke2lucHV0Q29ubmVjdGlvbnMubGVuZ3RofSk8L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24tY29udGVudCIgaWQ9ImlucHV0LWNvbm5lY3Rpb25zLWNvbnRlbnQiJHtjb250ZW50U3R5bGV9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5wdXQtbWFwcGluZ3MtY29uZmlnIj4NCiAgICAgICAgICAgIGA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGZvciAoY29uc3QgY29ubiBvZiBpbnB1dENvbm5lY3Rpb25zKSB7DQogICAgICAgICAgICAgICAgY29uc3Qgc291cmNlTm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGNvbm4uZnJvbS5ub2RlSWQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZU5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUoc291cmNlTm9kZT8udHlwZSB8fCAndW5rbm93bicpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZU5vZGVOYW1lID0gc291cmNlTm9kZURlZj8ubmFtZSB8fCBzb3VyY2VOb2RlPy50eXBlIHx8ICd1bmtub3duJzsNCiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZE91dHB1dCA9IHNvdXJjZU5vZGVEZWY/Lm91dHB1dHM/LmZpbmQob3V0cHV0ID0+IG91dHB1dC5pZCA9PT0gY29ubi5mcm9tLnBvcnROYW1lKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXROYW1lID0gc2VsZWN0ZWRPdXRwdXQgPyBzZWxlY3RlZE91dHB1dC5uYW1lIDogY29ubi5mcm9tLnBvcnROYW1lOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIFNpbXBsZTogU2hvdyB3aGF0IEknbSByZWNlaXZpbmcgYW5kIGxldCBtZSBjaG9vc2UgbXkgaW5wdXQgcG9ydA0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnB1dC1tYXBwaW5nLWNvbmZpZyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25uZWN0aW9uLWhlYWRlciI+RnJvbSAke3NvdXJjZU5vZGVOYW1lfSAoJHtvdXRwdXROYW1lfSk8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbm5lY3Rpb24tY29udHJvbHMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRyb2wtcm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlRvIG15IGlucHV0OjwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9ImlucHV0X3RhcmdldF8ke25vZGVJZH18JHtjb25uLnRvLnBvcnROYW1lfSIgY2xhc3M9ImlucHV0LXRhcmdldC1zZWxlY3QiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3QuLi48L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7bm9kZURlZi5pbnB1dHMubWFwKGlucHV0ID0+IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8b3B0aW9uIHZhbHVlPSIke2lucHV0LmlkfSIgJHtjb25uLnRvLnBvcnROYW1lID09PSBpbnB1dC5pZCA/ICdzZWxlY3RlZCcgOiAnJ30+JHtpbnB1dC5uYW1lfTwvb3B0aW9uPmANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuam9pbignJyl9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gU2hvdyBvdXRwdXQgbWFwcGluZ3MgY29uZmlndXJhdGlvbiAod2hhdCBvdGhlciBub2RlcyByZWNlaXZlIGZyb20gdGhpcyBub2RlKQ0KICAgICAgICBjb25zdCBvdXRwdXRDb25uZWN0aW9ucyA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkNCiAgICAgICAgICAgIC5maWx0ZXIoY29ubiA9PiBjb25uLmZyb20ubm9kZUlkID09PSBub2RlSWQpOw0KICAgICAgICANCiAgICAgICAgaWYgKG91dHB1dENvbm5lY3Rpb25zLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSBzZWN0aW9uU3RhdGVzWydvdXRwdXQtY29ubmVjdGlvbnMnXTsNCiAgICAgICAgICAgIGNvbnN0IGhlYWRlckNsYXNzID0gaXNFeHBhbmRlZCA/ICcnIDogJ2NvbGxhcHNlZCc7DQogICAgICAgICAgICBjb25zdCBpY29uQ2xhc3MgPSBpc0V4cGFuZGVkID8gJ2ZhcyBmYS1jaGV2cm9uLWRvd24nIDogJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRTdHlsZSA9IGlzRXhwYW5kZWQgPyAnJyA6ICcgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Iic7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uIj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24taGVhZGVyICR7aGVhZGVyQ2xhc3N9IiBkYXRhLXNlY3Rpb249Im91dHB1dC1jb25uZWN0aW9ucyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iJHtpY29uQ2xhc3N9Ij48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5PdXRwdXQgQ29ubmVjdGlvbnM8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c21hbGwgY2xhc3M9ImNvbmZpZy1jb3VudCI+KCR7b3V0cHV0Q29ubmVjdGlvbnMubGVuZ3RofSk8L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24tY29udGVudCIgaWQ9Im91dHB1dC1jb25uZWN0aW9ucy1jb250ZW50IiR7Y29udGVudFN0eWxlfT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im91dHB1dC1tYXBwaW5ncy1jb25maWciPg0KICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZm9yIChjb25zdCBjb25uIG9mIG91dHB1dENvbm5lY3Rpb25zKSB7DQogICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Tm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGNvbm4udG8ubm9kZUlkKTsNCiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKHRhcmdldE5vZGU/LnR5cGUgfHwgJ3Vua25vd24nKTsNCiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlTmFtZSA9IHRhcmdldE5vZGVEZWY/Lm5hbWUgfHwgdGFyZ2V0Tm9kZT8udHlwZSB8fCAndW5rbm93bic7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gR2V0IGF2YWlsYWJsZSBvdXRwdXRzIGZyb20gVEhJUyBub2RlIChzb3VyY2Ugbm9kZSkNCiAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2VOb2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgICAgICAgICAgICAgY29uc3QgYXZhaWxhYmxlT3V0cHV0cyA9IHNvdXJjZU5vZGVEZWY/Lm91dHB1dHMgfHwgW107DQogICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im91dHB1dC1tYXBwaW5nLWNvbmZpZyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25uZWN0aW9uLWhlYWRlciI+VG8gJHt0YXJnZXROb2RlTmFtZX08L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbm5lY3Rpb24tY29udHJvbHMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRyb2wtcm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlNlbmQgb3V0cHV0OjwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9Im91dHB1dF9tYXBwaW5nXyR7bm9kZUlkfXwke2Nvbm4uZnJvbS5wb3J0TmFtZX18JHtjb25uLnRvLm5vZGVJZH0iIGNsYXNzPSJvdXRwdXQtbWFwcGluZy1zZWxlY3QiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3QuLi48L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7YXZhaWxhYmxlT3V0cHV0cy5tYXAob3V0cHV0ID0+IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8b3B0aW9uIHZhbHVlPSIke291dHB1dC5pZH0iICR7Y29ubi5mcm9tLnBvcnROYW1lID09PSBvdXRwdXQuaWQgPyAnc2VsZWN0ZWQnIDogJyd9PiR7b3V0cHV0Lm5hbWV9PC9vcHRpb24+YA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5qb2luKCcnKX0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBHZW5lcmF0ZSBjb25maWd1cmF0aW9uIGZpZWxkcyAtIGdyb3VwZWQgZm9yIGJldHRlciBvcmdhbml6YXRpb24NCiAgICAgICAgY29uc3QgY29uZmlnRW50cmllcyA9IE9iamVjdC5lbnRyaWVzKG5vZGVEZWYuY29uZmlnKTsNCiAgICAgICAgaWYgKGNvbmZpZ0VudHJpZXMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9IHNlY3Rpb25TdGF0ZXNbJ25vZGUtc2V0dGluZ3MnXTsNCiAgICAgICAgICAgIGNvbnN0IGhlYWRlckNsYXNzID0gaXNFeHBhbmRlZCA/ICcnIDogJ2NvbGxhcHNlZCc7DQogICAgICAgICAgICBjb25zdCBpY29uQ2xhc3MgPSBpc0V4cGFuZGVkID8gJ2ZhcyBmYS1jaGV2cm9uLWRvd24nIDogJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRTdHlsZSA9IGlzRXhwYW5kZWQgPyAnJyA6ICcgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Iic7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uIj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24taGVhZGVyICR7aGVhZGVyQ2xhc3N9IiBkYXRhLXNlY3Rpb249Im5vZGUtc2V0dGluZ3MiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9IiR7aWNvbkNsYXNzfSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+Tm9kZSBTZXR0aW5nczwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbCBjbGFzcz0iY29uZmlnLWNvdW50Ij4oJHtjb25maWdFbnRyaWVzLmxlbmd0aH0pPC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWNvbnRlbnQiIGlkPSJub2RlLXNldHRpbmdzLWNvbnRlbnQiJHtjb250ZW50U3R5bGV9Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCBjb25maWddIG9mIGNvbmZpZ0VudHJpZXMpIHsNCiAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9ImNvbmZpZ18ke25vZGVJZH1fJHtrZXl9Ij4ke2NvbmZpZy5sYWJlbH08L2xhYmVsPg0KICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgKGNvbmZpZy50eXBlID09PSAnc2VsZWN0Jykgew0KICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8c2VsZWN0IGlkPSJjb25maWdfJHtub2RlSWR9XyR7a2V5fSI+YDsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIFNwZWNpYWwgaGFuZGxpbmcgZm9yIG5vZGVfcmVmZXJlbmNlIG5vZGUNCiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ25vZGVfcmVmZXJlbmNlJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtleSA9PT0gJ3NvdXJjZV9ub2RlX2lkJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBvcHVsYXRlIHdpdGggYWxsIGF2YWlsYWJsZSBub2RlcyAoZXhjbHVkaW5nIHRoaXMgbm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8b3B0aW9uIHZhbHVlPSIiPlNlbGVjdCBhIG5vZGUuLi48L29wdGlvbj5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2F2YWlsYWJsZU5vZGVJZCwgYXZhaWxhYmxlTm9kZV0gb2YgZmxvd0VkaXRvci5ub2Rlcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXZhaWxhYmxlTm9kZUlkICE9PSBub2RlSWQpIHsgLy8gRG9uJ3QgaW5jbHVkZSBzZWxmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdmFpbGFibGVOb2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKGF2YWlsYWJsZU5vZGUudHlwZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlTmFtZSA9IGF2YWlsYWJsZU5vZGVEZWYgPyBhdmFpbGFibGVOb2RlRGVmLm5hbWUgOiBhdmFpbGFibGVOb2RlLnR5cGU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZCA9IG5vZGUuY29uZmlnW2tleV0udmFsdWUgPT09IGF2YWlsYWJsZU5vZGVJZCA/ICdzZWxlY3RlZCcgOiAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDxvcHRpb24gdmFsdWU9IiR7YXZhaWxhYmxlTm9kZUlkfSIgJHtzZWxlY3RlZH0+JHtub2RlTmFtZX0gKCR7YXZhaWxhYmxlTm9kZUlkfSk8L29wdGlvbj5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChrZXkgPT09ICdvdXRwdXRfcG9ydF9pZCcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQb3B1bGF0ZSB3aXRoIG91dHB1dCBwb3J0cyBvZiB0aGUgc2VsZWN0ZWQgc291cmNlIG5vZGUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8b3B0aW9uIHZhbHVlPSIiPlNlbGVjdCBvdXRwdXQgcG9ydC4uLjwvb3B0aW9uPmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWROb2RlSWQgPSBub2RlLmNvbmZpZy5zb3VyY2Vfbm9kZV9pZC52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWROb2RlSWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWROb2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoc2VsZWN0ZWROb2RlSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWROb2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZE5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUoc2VsZWN0ZWROb2RlLnR5cGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZURlZiAmJiBzZWxlY3RlZE5vZGVEZWYub3V0cHV0cykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgb3V0cHV0IG9mIHNlbGVjdGVkTm9kZURlZi5vdXRwdXRzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkID0gbm9kZS5jb25maWdba2V5XS52YWx1ZSA9PT0gb3V0cHV0LmlkID8gJ3NlbGVjdGVkJyA6ICcnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8b3B0aW9uIHZhbHVlPSIke291dHB1dC5pZH0iICR7c2VsZWN0ZWR9PiR7b3V0cHV0Lm5hbWV9ICgke291dHB1dC50eXBlfSk8L29wdGlvbj5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVndWxhciBzZWxlY3QgZmllbGQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWcub3B0aW9ucy5mb3JFYWNoKG9wdGlvbiA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkID0gbm9kZS5jb25maWdba2V5XS52YWx1ZSA9PT0gb3B0aW9uID8gJ3NlbGVjdGVkJyA6ICcnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8b3B0aW9uIHZhbHVlPSIke29wdGlvbn0iICR7c2VsZWN0ZWR9PiR7b3B0aW9ufTwvb3B0aW9uPmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWd1bGFyIHNlbGVjdCBmaWVsZCBmb3Igb3RoZXIgbm9kZXMNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZy5vcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZCA9IG5vZGUuY29uZmlnW2tleV0udmFsdWUgPT09IG9wdGlvbiA/ICdzZWxlY3RlZCcgOiAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8b3B0aW9uIHZhbHVlPSIke29wdGlvbn0iICR7c2VsZWN0ZWR9PiR7b3B0aW9ufTwvb3B0aW9uPmA7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPC9zZWxlY3Q+YDsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy50eXBlID09PSAndGV4dGFyZWEnKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDx0ZXh0YXJlYSBpZD0iY29uZmlnXyR7bm9kZUlkfV8ke2tleX0iPiR7bm9kZS5jb25maWdba2V5XS52YWx1ZX08L3RleHRhcmVhPmA7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb25maWcudHlwZSA9PT0gJ251bWJlcicpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWluID0gY29uZmlnLm1pbiA/IGAgbWluPSIke2NvbmZpZy5taW59ImAgOiAnJzsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF4ID0gY29uZmlnLm1heCA/IGAgbWF4PSIke2NvbmZpZy5tYXh9ImAgOiAnJzsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RlcCA9IGNvbmZpZy5zdGVwID8gYCBzdGVwPSIke2NvbmZpZy5zdGVwfSJgIDogJyc7DQogICAgICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDxpbnB1dCB0eXBlPSJudW1iZXIiIGlkPSJjb25maWdfJHtub2RlSWR9XyR7a2V5fSIgdmFsdWU9IiR7bm9kZS5jb25maWdba2V5XS52YWx1ZX0iJHttaW59JHttYXh9JHtzdGVwfT5gOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGZpZWxkIHNob3VsZCBiZSBlbmNyeXB0ZWQgKHBhc3N3b3JkIG1hc2tlZCkNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5wdXRUeXBlID0gY29uZmlnLmVuY3J5cHQgPT09IHRydWUgPyAncGFzc3dvcmQnIDogY29uZmlnLnR5cGU7DQogICAgICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDxpbnB1dCB0eXBlPSIke2lucHV0VHlwZX0iIGlkPSJjb25maWdfJHtub2RlSWR9XyR7a2V5fSIgdmFsdWU9IiR7bm9kZS5jb25maWdba2V5XS52YWx1ZX0iPmA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDwvZGl2PmA7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFNob3cgb3V0cHV0IGRhdGEgZm9yIGFsbCBwb3J0cyAoaWYgbm9kZSBoYXMgYmVlbiBleGVjdXRlZCkgLSBhdCB0aGUgYm90dG9tDQogICAgICAgIGlmIChub2RlLmxhc3RPdXRwdXREYXRhICYmIG5vZGUubGFzdEV4ZWN1dGlvblRpbWUpIHsNCiAgICAgICAgICAgIGNvbnN0IG5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICAgICAgICAgIGNvbnN0IG91dHB1dHMgPSBub2RlRGVmLm91dHB1dHMgfHwgW107DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChvdXRwdXRzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gc2VjdGlvblN0YXRlc1snb3V0cHV0LWRhdGEnXTsNCiAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJDbGFzcyA9IGlzRXhwYW5kZWQgPyAnJyA6ICdjb2xsYXBzZWQnOw0KICAgICAgICAgICAgICAgIGNvbnN0IGljb25DbGFzcyA9IGlzRXhwYW5kZWQgPyAnZmFzIGZhLWNoZXZyb24tZG93bicgOiAnZmFzIGZhLWNoZXZyb24tcmlnaHQnOw0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRTdHlsZSA9IGlzRXhwYW5kZWQgPyAnJyA6ICcgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Iic7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1zZWN0aW9uLWhlYWRlciAke2hlYWRlckNsYXNzfSIgZGF0YS1zZWN0aW9uPSJvdXRwdXQtZGF0YSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9IiR7aWNvbkNsYXNzfSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPk91dHB1dCBEYXRhPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbCBjbGFzcz0iY29uZmlnLWNvdW50Ij4oJHtvdXRwdXRzLmxlbmd0aH0gcG9ydHMpPC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLXNlY3Rpb24tY29udGVudCIgaWQ9Im91dHB1dC1kYXRhLWNvbnRlbnQiJHtjb250ZW50U3R5bGV9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMTJweDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBtYXJnaW4tYm90dG9tOiA4cHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGFzdCBleGVjdXRlZDogJHtuZXcgRGF0ZShub2RlLmxhc3RFeGVjdXRpb25UaW1lKS50b0xvY2FsZVN0cmluZygpfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBvdXRwdXQgb2Ygb3V0cHV0cykgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXREYXRhID0gZ2V0T3V0cHV0UG9ydERhdGEobm9kZS5pZCwgb3V0cHV0LmlkKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gZm9ybWF0RGF0YVByZXZpZXcob3V0cHV0RGF0YSk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQtZGlzcGxheSIgc3R5bGU9Im1hcmdpbi1ib3R0b206IDhweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OiA1MDA7IG1hcmdpbi1ib3R0b206IDZweDsgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOyBmb250LXNpemU6IDEzcHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtvdXRwdXQubmFtZX0gPHNwYW4gc3R5bGU9ImNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC13ZWlnaHQ6IG5vcm1hbDsgZm9udC1zaXplOiAxMXB4OyI+KCR7Zm9ybWF0dGVkLnR5cGV9KTwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cHJlIGNsYXNzPSJjb250ZW50LXRleHQiIHN0eWxlPSJtYXJnaW4tYm90dG9tOiA0cHg7IG1heC1oZWlnaHQ6IDgwcHg7Ij4ke2VzY2FwZUh0bWwoZm9ybWF0dGVkLnByZXZpZXcpfTwvcHJlPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7Zm9ybWF0dGVkLmxlbmd0aCAhPT0gdW5kZWZpbmVkID8gYDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMTFweDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyI+TGVuZ3RoOiAke2Zvcm1hdHRlZC5sZW5ndGh9PC9kaXY+YCA6ICcnfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7Zm9ybWF0dGVkLmtleXMgIT09IHVuZGVmaW5lZCA/IGA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDExcHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsiPktleXM6ICR7Zm9ybWF0dGVkLmtleXN9PC9kaXY+YCA6ICcnfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7Zm9ybWF0dGVkLnNpemUgIT09IHVuZGVmaW5lZCA/IGA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDExcHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsiPlNpemU6ICR7KGZvcm1hdHRlZC5zaXplIC8gMTAyNCkudG9GaXhlZCgyKX0gS0I8L2Rpdj5gIDogJyd9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtmb3JtYXR0ZWQuZXN0aW1hdGVkU2l6ZSAhPT0gdW5kZWZpbmVkID8gYDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMTFweDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyI+RXN0LiBTaXplOiAkeyhmb3JtYXR0ZWQuZXN0aW1hdGVkU2l6ZSAvIDEwMjQpLnRvRml4ZWQoMil9IEtCPC9kaXY+YCA6ICcnfQ0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbmZpZ1BhbmVsLmlubmVySFRNTCA9IGNvbmZpZ0h0bWw7DQogICAgICAgIA0KICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzIGZvciBtYXBwaW5nIHNlbGVjdHMNCiAgICAgICAgLy8gTm8gaW5wdXQgbWFwcGluZyBzZWxlY3RzIGFueW1vcmUgLSBub2RlcyBjYW4ndCBjb250cm9sIHdoYXQgdGhleSByZWNlaXZlDQogICAgICAgIA0KICAgICAgICBjb25zdCBpbnB1dFRhcmdldFNlbGVjdHMgPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5wdXQtdGFyZ2V0LXNlbGVjdCcpOw0KICAgICAgICBpbnB1dFRhcmdldFNlbGVjdHMuZm9yRWFjaChzZWxlY3QgPT4gew0KICAgICAgICAgICAgc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3QgW25vZGVJZCwgY3VycmVudElucHV0UG9ydF0gPSBlLnRhcmdldC5pZC5yZXBsYWNlKCdpbnB1dF90YXJnZXRfJywgJycpLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRJbnB1dFBvcnQgPSBlLnRhcmdldC52YWx1ZTsNCiAgICAgICAgICAgICAgICAvLyBGaW5kIHRoZSBjb25uZWN0aW9uDQogICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkuZmluZChjb25uID0+DQogICAgICAgICAgICAgICAgICAgIGNvbm4udG8ubm9kZUlkID09PSBub2RlSWQgJiYgY29ubi50by5wb3J0TmFtZSA9PT0gY3VycmVudElucHV0UG9ydA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24gJiYgc2VsZWN0ZWRJbnB1dFBvcnQpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGFsbCBjb25uZWN0aW9ucyBmcm9tIHRoZSBzYW1lIGZyb21Ob2RlIHRvIHRoaXMgbm9kZSAocmVnYXJkbGVzcyBvZiBwb3J0KQ0KICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uc1RvUmVtb3ZlID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5maWx0ZXIoY29ubiA9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgY29ubi5mcm9tLm5vZGVJZCA9PT0gY29ubmVjdGlvbi5mcm9tLm5vZGVJZCAmJiBjb25uLnRvLm5vZGVJZCA9PT0gbm9kZUlkDQogICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25zVG9SZW1vdmUuZm9yRWFjaChjb25uID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuZGVsZXRlKGNvbm4uaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm4uc3ZnKSBjb25uLnN2Zy5yZW1vdmUoKTsNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgbmV3IGNvbm5lY3Rpb24NCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Q29ubmVjdGlvbklkID0gYGNvbm5fJHtjb25uZWN0aW9uLmZyb20ubm9kZUlkfV8ke2Nvbm5lY3Rpb24uZnJvbS5wb3J0TmFtZX1fJHtub2RlSWR9XyR7c2VsZWN0ZWRJbnB1dFBvcnR9YDsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Q29ubmVjdGlvbiA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBuZXdDb25uZWN0aW9uSWQsDQogICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiB7IG5vZGVJZDogY29ubmVjdGlvbi5mcm9tLm5vZGVJZCwgcG9ydE5hbWU6IGNvbm5lY3Rpb24uZnJvbS5wb3J0TmFtZSB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgdG86IHsgbm9kZUlkOiBub2RlSWQsIHBvcnROYW1lOiBzZWxlY3RlZElucHV0UG9ydCB9DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuc2V0KG5ld0Nvbm5lY3Rpb25JZCwgbmV3Q29ubmVjdGlvbik7DQogICAgICAgICAgICAgICAgICAgIGRyYXdDb25uZWN0aW9uKG5ld0Nvbm5lY3Rpb24pOw0KICAgICAgICAgICAgICAgICAgICAvLyBBdXRvLXNhdmUNCiAgICAgICAgICAgICAgICAgICAgaWYgKHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5zYXZlRmxvdykgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLnNhdmVGbG93KCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgY29uc3Qgb3V0cHV0TWFwcGluZ1NlbGVjdHMgPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcub3V0cHV0LW1hcHBpbmctc2VsZWN0Jyk7DQogICAgICAgIG91dHB1dE1hcHBpbmdTZWxlY3RzLmZvckVhY2goc2VsZWN0ID0+IHsNCiAgICAgICAgICAgIHNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gZS50YXJnZXQuaWQucmVwbGFjZSgnb3V0cHV0X21hcHBpbmdfJywgJycpLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gcGFydHNbMF07DQogICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0UG9ydCA9IHBhcnRzWzFdOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGVJZCA9IHBhcnRzWzJdOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkT3V0cHV0UG9ydCA9IGUudGFyZ2V0LnZhbHVlOw0KICAgICAgICAgICAgICAgIHVwZGF0ZU91dHB1dE1hcHBpbmcobm9kZUlkLCBvdXRwdXRQb3J0LCB0YXJnZXROb2RlSWQsIHNlbGVjdGVkT3V0cHV0UG9ydCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzIGZvciBzcGVjaWFsIGJ1dHRvbnMNCiAgICAgICAgY29uc3Qgdmlld0Z1bGxJbWFnZUJ0biA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3IoJy52aWV3LWZ1bGwtaW1hZ2UtYnRuJyk7DQogICAgICAgIGlmICh2aWV3RnVsbEltYWdlQnRuKSB7DQogICAgICAgICAgICB2aWV3RnVsbEltYWdlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS1pZCcpOw0KICAgICAgICAgICAgICAgIHNob3dGdWxsSW1hZ2Uobm9kZUlkKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25zdCBwbGF5QXVkaW9CdG4gPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yKCcucGxheS1hdWRpby1idG4nKTsNCiAgICAgICAgaWYgKHBsYXlBdWRpb0J0bikgew0KICAgICAgICAgICAgcGxheUF1ZGlvQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS1pZCcpOw0KICAgICAgICAgICAgICAgIHBsYXlBdWRpbyhub2RlSWQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHN0b3BBdWRpb0J0biA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3IoJy5zdG9wLWF1ZGlvLWJ0bicpOw0KICAgICAgICBpZiAoc3RvcEF1ZGlvQnRuKSB7DQogICAgICAgICAgICBzdG9wQXVkaW9CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1ub2RlLWlkJyk7DQogICAgICAgICAgICAgICAgc3RvcEF1ZGlvKG5vZGVJZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgY29uc3Qgc3RhcnRSZXBlYXRlckJ0biA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3IoJy5zdGFydC1yZXBlYXRlci1idG4nKTsNCiAgICAgICAgaWYgKHN0YXJ0UmVwZWF0ZXJCdG4pIHsNCiAgICAgICAgICAgIHN0YXJ0UmVwZWF0ZXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1ub2RlLWlkJyk7DQogICAgICAgICAgICAgICAgc3RhcnRSZXBlYXRlcihub2RlSWQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHN0b3BSZXBlYXRlckJ0biA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3IoJy5zdG9wLXJlcGVhdGVyLWJ0bicpOw0KICAgICAgICBpZiAoc3RvcFJlcGVhdGVyQnRuKSB7DQogICAgICAgICAgICBzdG9wUmVwZWF0ZXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1ub2RlLWlkJyk7DQogICAgICAgICAgICAgICAgc3RvcFJlcGVhdGVyKG5vZGVJZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQWRkIGNoYW5nZSBsaXN0ZW5lcnMNCiAgICAgICAgZm9yIChjb25zdCBba2V5LCBjb25maWddIG9mIE9iamVjdC5lbnRyaWVzKG5vZGVEZWYuY29uZmlnKSkgew0KICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjb25maWdfJHtub2RlSWR9XyR7a2V5fWApOw0KICAgICAgICAgICAgaWYgKGVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIG5vZGUuY29uZmlnW2tleV0udmFsdWUgPSBlLnRhcmdldC52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIFNwZWNpYWwgaGFuZGxpbmcgZm9yIGRpc3BsYXkgbm9kZSBmb3JtYXQgY2hhbmdlcw0KICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnZGlzcGxheScgJiYga2V5ID09PSAnZm9ybWF0Jykgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBkaXNwbGF5LWZvcm1hdC0ke25vZGVJZH1gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYXRFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0RWxlbWVudC50ZXh0Q29udGVudCA9IGUudGFyZ2V0LnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBub2RlX3JlZmVyZW5jZSBzb3VyY2Ugbm9kZSBjaGFuZ2VzDQogICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdub2RlX3JlZmVyZW5jZScgJiYga2V5ID09PSAnc291cmNlX25vZGVfaWQnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIG91dHB1dCBwb3J0IGRyb3Bkb3duIHdoZW4gc291cmNlIG5vZGUgY2hhbmdlcw0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0UG9ydFNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjb25maWdfJHtub2RlSWR9X291dHB1dF9wb3J0X2lkYCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAob3V0cHV0UG9ydFNlbGVjdCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENsZWFyIGFuZCByZXBvcHVsYXRlIG91dHB1dCBwb3J0IG9wdGlvbnMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRQb3J0U2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSIiPlNlbGVjdCBvdXRwdXQgcG9ydC4uLjwvb3B0aW9uPic7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWROb2RlSWQgPSBlLnRhcmdldC52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWROb2RlSWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWROb2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoc2VsZWN0ZWROb2RlSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWROb2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZE5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUoc2VsZWN0ZWROb2RlLnR5cGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkTm9kZURlZiAmJiBzZWxlY3RlZE5vZGVEZWYub3V0cHV0cykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgb3V0cHV0IG9mIHNlbGVjdGVkTm9kZURlZi5vdXRwdXRzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb24udmFsdWUgPSBvdXRwdXQuaWQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbi50ZXh0Q29udGVudCA9IGAke291dHB1dC5uYW1lfSAoJHtvdXRwdXQudHlwZX0pYDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0UG9ydFNlbGVjdC5hcHBlbmRDaGlsZChvcHRpb24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXNldCB0aGUgb3V0cHV0IHBvcnQgdmFsdWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmNvbmZpZy5vdXRwdXRfcG9ydF9pZC52YWx1ZSA9ICcnOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBjb2xsYXBzaWJsZSBzZWN0aW9uIGZ1bmN0aW9uYWxpdHkgd2l0aCBwZXJzaXN0ZW5jZQ0KICAgICAgICBjb25zdCBzZWN0aW9uSGVhZGVycyA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb25maWctc2VjdGlvbi1oZWFkZXInKTsNCiAgICAgICAgc2VjdGlvbkhlYWRlcnMuZm9yRWFjaChoZWFkZXIgPT4gew0KICAgICAgICAgICAgaGVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbklkID0gaGVhZGVyLmdldEF0dHJpYnV0ZSgnZGF0YS1zZWN0aW9uJyk7DQogICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke3NlY3Rpb25JZH0tY29udGVudGApOw0KICAgICAgICAgICAgICAgIGNvbnN0IGljb24gPSBoZWFkZXIucXVlcnlTZWxlY3RvcignaScpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChjb250ZW50ICYmIGljb24pIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDb2xsYXBzZWQgPSBoZWFkZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGlmIChpc0NvbGxhcHNlZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXhwYW5kDQogICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXIuY2xhc3NMaXN0LnJlbW92ZSgnY29sbGFwc2VkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLWRvd24nOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29sbGFwc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlci5jbGFzc0xpc3QuYWRkKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gU2F2ZSB0aGUgc3RhdGUgdG8gYXBwIHNldHRpbmdzICh0cnVlID0gZXhwYW5kZWQsIGZhbHNlID0gY29sbGFwc2VkKQ0KICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5zZXRTZXR0aW5nKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9ICFoZWFkZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzeXBuZXhBUEkuc2V0U2V0dGluZyhgY29uZmlnX3NlY3Rpb25fJHtzZWN0aW9uSWR9YCwgaXNFeHBhbmRlZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBzYXZlIGNvbmZpZyBzZWN0aW9uIHN0YXRlOicsIGVycm9yKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICB9DQp9DQoNCi8vIG5vZGUtcmVuZGVyZXIuanMgLSBEeW5hbWljIG5vZGUgcmVuZGVyaW5nIGZvciBGbG93IEVkaXRvcg0KDQpjbGFzcyBOb2RlUmVuZGVyZXIgew0KICAgIGNvbnN0cnVjdG9yKCkgew0KICAgICAgICB0aGlzLnRlbXBsYXRlcyA9IG5ldyBNYXAoKTsNCiAgICAgICAgdGhpcy5zZXR1cFN0YW5kYXJkVGVtcGxhdGUoKTsNCiAgICB9DQogICAgDQogICAgc2V0dXBTdGFuZGFyZFRlbXBsYXRlKCkgew0KICAgICAgICB0aGlzLnRlbXBsYXRlcy5zZXQoJ3N0YW5kYXJkJywgew0KICAgICAgICAgICAgcmVuZGVyOiAobm9kZSwgbm9kZURlZikgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0cyA9IG5vZGVEZWYuaW5wdXRzIHx8IFtdOw0KICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dHMgPSBub2RlRGVmLm91dHB1dHMgfHwgW107DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgcmV0dXJuIGANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmxvdy1ub2RlLWhlYWRlciI+DQogICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iJHtub2RlRGVmLmljb259Ij48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj4ke25vZGVEZWYubmFtZX08L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iZmxvdy1ub2RlLXR5cGUgJHtub2RlLnR5cGV9Ij4ke25vZGUudHlwZS50b1VwcGVyQ2FzZSgpfTwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Im5vZGUtZGVsZXRlLWJ0biIgdGl0bGU9IkRlbGV0ZSBub2RlIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRpbWVzIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsb3ctbm9kZS1jb250ZW50Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5vZGUtZGVmYXVsdC1jb250ZW50Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGwgY2xhc3M9InRleHQtbXV0ZWQiPiR7bm9kZURlZi5kZXNjcmlwdGlvbn08L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LW5vZGUtcG9ydHMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgJHtpbnB1dHMubWFwKGlucHV0ID0+IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8ZGl2IGNsYXNzPSJmbG93LW5vZGUtcG9ydCBpbnB1dCIgZGF0YS1wb3J0PSIke2lucHV0LmlkfSI+PC9kaXY+YA0KICAgICAgICAgICAgICAgICAgICAgICAgKS5qb2luKCcnKX0NCiAgICAgICAgICAgICAgICAgICAgICAgICR7b3V0cHV0cy5tYXAob3V0cHV0ID0+IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8ZGl2IGNsYXNzPSJmbG93LW5vZGUtcG9ydCBvdXRwdXQiIGRhdGEtcG9ydD0iJHtvdXRwdXQuaWR9Ij48L2Rpdj5gDQogICAgICAgICAgICAgICAgICAgICAgICApLmpvaW4oJycpfQ0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgDQogICAgcmVnaXN0ZXJUZW1wbGF0ZShuYW1lLCB0ZW1wbGF0ZSkgew0KICAgICAgICB0aGlzLnRlbXBsYXRlcy5zZXQobmFtZSwgdGVtcGxhdGUpOw0KICAgIH0NCiAgICANCiAgICByZW5kZXJOb2RlKG5vZGUpIHsNCiAgICAgICAgY29uc3Qgbm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShub2RlLnR5cGUpOw0KICAgICAgICBpZiAoIW5vZGVEZWYpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYE5vIG5vZGUgZGVmaW5pdGlvbiBmb3VuZCBmb3IgdHlwZTogJHtub2RlLnR5cGV9YCk7DQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHRlbXBsYXRlTmFtZSA9IG5vZGVEZWYudGVtcGxhdGUgfHwgJ3N0YW5kYXJkJzsNCiAgICAgICAgY29uc3QgdGVtcGxhdGUgPSB0aGlzLnRlbXBsYXRlcy5nZXQodGVtcGxhdGVOYW1lKTsNCiAgICAgICAgDQogICAgICAgIGlmICghdGVtcGxhdGUpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYE5vIHRlbXBsYXRlIGZvdW5kOiAke3RlbXBsYXRlTmFtZX1gKTsNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHRlbXBsYXRlLnJlbmRlcihub2RlLCBub2RlRGVmKTsNCiAgICB9DQogICAgDQogICAgY3JlYXRlTm9kZUVsZW1lbnQobm9kZSkgew0KICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgICAgICBub2RlRWxlbWVudC5jbGFzc05hbWUgPSBgZmxvdy1ub2RlICR7bm9kZS50eXBlfS1ub2RlYDsNCiAgICAgICAgbm9kZUVsZW1lbnQuaWQgPSBub2RlLmlkOw0KICAgICAgICBub2RlRWxlbWVudC5zdHlsZS5sZWZ0ID0gbm9kZS54ICsgJ3B4JzsNCiAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUudG9wID0gbm9kZS55ICsgJ3B4JzsNCiAgICAgICAgDQogICAgICAgIC8vIFJlbmRlciB0aGUgbm9kZSBjb250ZW50DQogICAgICAgIG5vZGVFbGVtZW50LmlubmVySFRNTCA9IHRoaXMucmVuZGVyTm9kZShub2RlKTsNCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lcnMgYW5kIGdldCB0aGUgdXBkYXRlZCBlbGVtZW50DQogICAgICAgIGNvbnN0IGZpbmFsRWxlbWVudCA9IHRoaXMuYWRkTm9kZUV2ZW50TGlzdGVuZXJzKG5vZGVFbGVtZW50LCBub2RlKTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiBmaW5hbEVsZW1lbnQ7DQogICAgfQ0KICAgIA0KICAgIGFkZE5vZGVFdmVudExpc3RlbmVycyhub2RlRWxlbWVudCwgbm9kZSkgew0KICAgICAgICAvLyBEZWxldGUgYnV0dG9uDQogICAgICAgIGNvbnN0IGRlbGV0ZUJ0biA9IG5vZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ub2RlLWRlbGV0ZS1idG4nKTsNCiAgICAgICAgaWYgKGRlbGV0ZUJ0bikgew0KICAgICAgICAgICAgZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgICAgIGRlbGV0ZU5vZGUobm9kZS5pZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gTm9kZSBzZWxlY3Rpb24NCiAgICAgICAgbm9kZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy5ub2RlLWRlbGV0ZS1idG4nKSkgcmV0dXJuOw0KICAgICAgICAgICAgc2VsZWN0Tm9kZShub2RlLmlkKTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyBOb2RlIGRyYWdnaW5nDQogICAgICAgIG5vZGVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7DQogICAgICAgICAgICBpZiAoZS50YXJnZXQuY2xvc2VzdCgnLm5vZGUtZGVsZXRlLWJ0bicpKSByZXR1cm47DQogICAgICAgICAgICBzdGFydERyYWdnaW5nTm9kZShub2RlLmlkLCBlKTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyBQb3J0IGNvbm5lY3Rpb25zDQogICAgICAgIGNvbnN0IHBvcnRzID0gbm9kZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZsb3ctbm9kZS1wb3J0Jyk7DQogICAgICAgIHBvcnRzLmZvckVhY2gocG9ydCA9PiB7DQogICAgICAgICAgICBwb3J0LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgICAgICBzdGFydENvbm5lY3Rpb24obm9kZS5pZCwgcG9ydC5kYXRhc2V0LnBvcnQsIHBvcnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdvdXRwdXQnKSk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICByZXR1cm4gbm9kZUVsZW1lbnQ7DQogICAgfQ0KfQ0KDQovLyBHbG9iYWwgbm9kZSByZW5kZXJlciBpbnN0YW5jZQ0KY29uc3Qgbm9kZVJlbmRlcmVyID0gbmV3IE5vZGVSZW5kZXJlcigpOw0KDQoNCi8vIFRleHQgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVRleHROb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IHRleHRDb250ZW50ID0gbm9kZS5jb25maWcudGV4dF9jb250ZW50LnZhbHVlOw0KDQogICAgcmV0dXJuIHsgdGV4dDogdGV4dENvbnRlbnQgfTsNCn0NCg0KDQovLyBKU09OIEV4dHJhY3QgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUpzb25FeHRyYWN0Tm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBmaWVsZFBhdGggPSBub2RlLmNvbmZpZy5maWVsZF9wYXRoLnZhbHVlOw0KICAgIGNvbnN0IGRlZmF1bHRWYWx1ZSA9IG5vZGUuY29uZmlnLmRlZmF1bHRfdmFsdWU/LnZhbHVlIHx8ICcnOw0KDQogICAgLy8gQWNjZXB0IGFueSBpbnB1dCBkYXRhLCBub3QganVzdCBqc29uX2RhdGENCiAgICBsZXQganNvbkRhdGEgPSBudWxsOw0KDQogICAgLy8gVHJ5IHRvIGZpbmQgSlNPTiBkYXRhIGZyb20gYW55IGlucHV0DQogICAgaWYgKGlucHV0RGF0YS5qc29uX2RhdGEpIHsNCiAgICAgICAganNvbkRhdGEgPSBpbnB1dERhdGEuanNvbl9kYXRhOw0KICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLmRhdGEpIHsNCiAgICAgICAganNvbkRhdGEgPSBpbnB1dERhdGEuZGF0YTsNCiAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS50ZXh0KSB7DQogICAgICAgIGpzb25EYXRhID0gaW5wdXREYXRhLnRleHQ7DQogICAgfSBlbHNlIGlmIChpbnB1dERhdGEucmVzcG9uc2UpIHsNCiAgICAgICAganNvbkRhdGEgPSBpbnB1dERhdGEucmVzcG9uc2U7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gVXNlIHRoZSBmaXJzdCBhdmFpbGFibGUgaW5wdXQNCiAgICAgICAgY29uc3QgZmlyc3RJbnB1dCA9IE9iamVjdC52YWx1ZXMoaW5wdXREYXRhKVswXTsNCiAgICAgICAganNvbkRhdGEgPSBmaXJzdElucHV0Ow0KICAgIH0NCg0KDQogICAgbGV0IGV4dHJhY3RlZFZhbHVlID0gbnVsbDsNCg0KICAgIHRyeSB7DQogICAgICAgIC8vIFBhcnNlIEpTT04gaWYgaXQncyBhIHN0cmluZw0KICAgICAgICBpZiAodHlwZW9mIGpzb25EYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAganNvbkRhdGEgPSBKU09OLnBhcnNlKGpzb25EYXRhKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEV4dHJhY3QgdmFsdWUgdXNpbmcgZG90IG5vdGF0aW9uDQogICAgICAgIGV4dHJhY3RlZFZhbHVlID0gc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JVdGlscy5leHRyYWN0TmVzdGVkVmFsdWUoanNvbkRhdGEsIGZpZWxkUGF0aCk7DQoNCiAgICAgICAgLy8gVXNlIGRlZmF1bHQgdmFsdWUgaWYgZXh0cmFjdGlvbiBmYWlsZWQNCiAgICAgICAgaWYgKGV4dHJhY3RlZFZhbHVlID09PSBudWxsIHx8IGV4dHJhY3RlZFZhbHVlID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGV4dHJhY3RlZFZhbHVlID0gZGVmYXVsdFZhbHVlOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gRm9ybWF0IHRoZSBvdXRwdXQgYXMgc3RyaW5nIGZvciBjb25zaXN0ZW5jeQ0KICAgICAgICBsZXQgZm9ybWF0dGVkVmFsdWUgPSBTdHJpbmcoZXh0cmFjdGVkVmFsdWUpOw0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBub2RlLmxhc3RFeHRyYWN0ZWRWYWx1ZSA9IGZvcm1hdHRlZFZhbHVlOw0KICAgICAgICBub2RlLmxhc3RGaWVsZFBhdGggPSBmaWVsZFBhdGg7DQoNCiAgICAgICAgLy8gRGVidWcgbG9nZ2luZw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkYXRhOiBmb3JtYXR0ZWRWYWx1ZSwNCiAgICAgICAgICAgIHRleHQ6IGZvcm1hdHRlZFZhbHVlLA0KICAgICAgICAgICAganNvbjogZXh0cmFjdGVkVmFsdWUsDQogICAgICAgICAgICBleHRyYWN0ZWRfdmFsdWU6IGZvcm1hdHRlZFZhbHVlLA0KICAgICAgICAgICAgZmllbGRfcGF0aDogZmllbGRQYXRoLA0KICAgICAgICAgICAgb3JpZ2luYWw6IGpzb25EYXRhDQogICAgICAgIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignSlNPTiBFeHRyYWN0IGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGRhdGE6IGRlZmF1bHRWYWx1ZSwNCiAgICAgICAgICAgIHRleHQ6IGRlZmF1bHRWYWx1ZSwNCiAgICAgICAgICAgIGpzb246IG51bGwsDQogICAgICAgICAgICBleHRyYWN0ZWRfdmFsdWU6IGRlZmF1bHRWYWx1ZSwNCiAgICAgICAgICAgIGZpZWxkX3BhdGg6IGZpZWxkUGF0aCwNCiAgICAgICAgICAgIG9yaWdpbmFsOiBqc29uRGF0YSwNCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQoNCi8vIFJhbmRvbSBMaW5lIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVSYW5kb21RdW90ZU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgc2tpcEVtcHR5ID0gbm9kZS5jb25maWcuc2tpcF9lbXB0eS52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IHRyaW1XaGl0ZXNwYWNlID0gbm9kZS5jb25maWcudHJpbV93aGl0ZXNwYWNlLnZhbHVlID09PSAndHJ1ZSc7DQogICAgY29uc3QgbWF4TGVuZ3RoID0gcGFyc2VJbnQobm9kZS5jb25maWcubWF4X2xlbmd0aC52YWx1ZSk7DQoNCg0KICAgIGxldCB0ZXh0ID0gaW5wdXREYXRhLnRleHQ7DQogICAgaWYgKHR5cGVvZiB0ZXh0ICE9PSAnc3RyaW5nJykgew0KICAgICAgICB0ZXh0ID0gSlNPTi5zdHJpbmdpZnkodGV4dCk7DQogICAgfQ0KDQoNCiAgICBjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoJ1xuJyk7DQoNCiAgICBsZXQgdmFsaWRMaW5lcyA9IGxpbmVzOw0KDQogICAgaWYgKHNraXBFbXB0eSkgew0KICAgICAgICB2YWxpZExpbmVzID0gbGluZXMuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkubGVuZ3RoID4gMCk7DQogICAgfQ0KDQogICAgaWYgKHRyaW1XaGl0ZXNwYWNlKSB7DQogICAgICAgIHZhbGlkTGluZXMgPSB2YWxpZExpbmVzLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKTsNCiAgICB9DQoNCiAgICBpZiAodmFsaWRMaW5lcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgcmV0dXJuIHsgcmFuZG9tX2xpbmU6IG51bGwsIGxpbmVfbnVtYmVyOiAwLCB0b3RhbF9saW5lczogMCB9Ow0KICAgIH0NCg0KICAgIGNvbnN0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdmFsaWRMaW5lcy5sZW5ndGgpOw0KICAgIGxldCByYW5kb21MaW5lID0gdmFsaWRMaW5lc1tyYW5kb21JbmRleF07DQoNCg0KICAgIGlmIChtYXhMZW5ndGggPiAwICYmIHJhbmRvbUxpbmUubGVuZ3RoID4gbWF4TGVuZ3RoKSB7DQogICAgICAgIHJhbmRvbUxpbmUgPSByYW5kb21MaW5lLnN1YnN0cmluZygwLCBtYXhMZW5ndGgpICsgJy4uLic7DQogICAgfQ0KDQogICAgY29uc3QgcmVzdWx0ID0gew0KICAgICAgICByYW5kb21fbGluZTogcmFuZG9tTGluZSwNCiAgICAgICAgbGluZV9udW1iZXI6IHJhbmRvbUluZGV4ICsgMSwNCiAgICAgICAgdG90YWxfbGluZXM6IHZhbGlkTGluZXMubGVuZ3RoDQogICAgfTsNCg0KICAgIHJldHVybiByZXN1bHQ7DQp9DQoNCi8vIE1hdGggT3BlcmF0aW9ucyBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlTWF0aE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgb3BlcmF0aW9uID0gbm9kZS5jb25maWcub3BlcmF0aW9uLnZhbHVlOw0KICAgIGNvbnN0IGNvbmZpZ1ZhbHVlQSA9IHBhcnNlRmxvYXQobm9kZS5jb25maWcudmFsdWVfYS52YWx1ZSkgfHwgMDsNCiAgICBjb25zdCBjb25maWdWYWx1ZUIgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLnZhbHVlX2IudmFsdWUpIHx8IDA7DQogICAgbGV0IGRlY2ltYWxQbGFjZXMgPSBwYXJzZUludChub2RlLmNvbmZpZy5kZWNpbWFsX3BsYWNlcy52YWx1ZSk7DQogICAgaWYgKGlzTmFOKGRlY2ltYWxQbGFjZXMpKSBkZWNpbWFsUGxhY2VzID0gMDsgLy8gRGVmYXVsdCB0byAwIGlmIG5vdCBhIG51bWJlcg0KDQogICAgLy8gR2V0IHZhbHVlcyBmcm9tIGlucHV0cyBvciBjb25maWcNCiAgICBsZXQgdmFsdWVBID0gaW5wdXREYXRhLnZhbHVlX2EgIT09IHVuZGVmaW5lZCA/IGlucHV0RGF0YS52YWx1ZV9hIDogDQogICAgICAgICAgICAgICAgIGlucHV0RGF0YS5udW1iZXJfYSAhPT0gdW5kZWZpbmVkID8gaW5wdXREYXRhLm51bWJlcl9hIDogY29uZmlnVmFsdWVBOw0KICAgIGxldCB2YWx1ZUIgPSBpbnB1dERhdGEudmFsdWVfYiAhPT0gdW5kZWZpbmVkID8gaW5wdXREYXRhLnZhbHVlX2IgOiANCiAgICAgICAgICAgICAgICAgaW5wdXREYXRhLm51bWJlcl9iICE9PSB1bmRlZmluZWQgPyBpbnB1dERhdGEubnVtYmVyX2IgOiBjb25maWdWYWx1ZUI7DQoNCiAgICAvLyBDb252ZXJ0IHRvIG51bWJlcnMNCiAgICBpZiAodHlwZW9mIHZhbHVlQSA9PT0gJ3N0cmluZycpIHZhbHVlQSA9IHBhcnNlRmxvYXQodmFsdWVBKSB8fCAwOw0KICAgIGlmICh0eXBlb2YgdmFsdWVCID09PSAnc3RyaW5nJykgdmFsdWVCID0gcGFyc2VGbG9hdCh2YWx1ZUIpIHx8IDA7DQogICAgaWYgKHR5cGVvZiB2YWx1ZUEgPT09ICdvYmplY3QnICYmIHZhbHVlQSAhPT0gbnVsbCkgew0KICAgICAgICAvLyBUcnkgdG8gZXh0cmFjdCBudW1lcmljIHZhbHVlIGZyb20gb2JqZWN0DQogICAgICAgIHZhbHVlQSA9IHBhcnNlRmxvYXQodmFsdWVBLnZhbHVlIHx8IHZhbHVlQS5yZXN1bHQgfHwgdmFsdWVBLmRhdGEgfHwgMCk7DQogICAgfQ0KICAgIGlmICh0eXBlb2YgdmFsdWVCID09PSAnb2JqZWN0JyAmJiB2YWx1ZUIgIT09IG51bGwpIHsNCiAgICAgICAgdmFsdWVCID0gcGFyc2VGbG9hdCh2YWx1ZUIudmFsdWUgfHwgdmFsdWVCLnJlc3VsdCB8fCB2YWx1ZUIuZGF0YSB8fCAwKTsNCiAgICB9DQoNCiAgICBsZXQgcmVzdWx0ID0gMDsNCg0KICAgIHRyeSB7DQogICAgICAgIHN3aXRjaCAob3BlcmF0aW9uKSB7DQogICAgICAgICAgICBjYXNlICdhZGQnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlQSArIHZhbHVlQjsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3N1YnRyYWN0JzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZUEgLSB2YWx1ZUI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdtdWx0aXBseSc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWVBICogdmFsdWVCOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZGl2aWRlJzoNCiAgICAgICAgICAgICAgICBpZiAodmFsdWVCID09PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ0RpdmlzaW9uIGJ5IHplcm8nKTsNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZUEgLyB2YWx1ZUI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdtb2R1bG8nOg0KICAgICAgICAgICAgICAgIGlmICh2YWx1ZUIgPT09IDApIHRocm93IG5ldyBFcnJvcignTW9kdWxvIGJ5IHplcm8nKTsNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZUEgJSB2YWx1ZUI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdwb3dlcic6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5wb3codmFsdWVBLCB2YWx1ZUIpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbWluJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLm1pbih2YWx1ZUEsIHZhbHVlQik7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdtYXgnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGgubWF4KHZhbHVlQSwgdmFsdWVCKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2Ficyc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5hYnModmFsdWVBKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JvdW5kJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLnJvdW5kKHZhbHVlQSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdmbG9vcic6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5mbG9vcih2YWx1ZUEpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnY2VpbCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5jZWlsKHZhbHVlQSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlQTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFJvdW5kIHRvIHNwZWNpZmllZCBkZWNpbWFsIHBsYWNlcw0KICAgICAgICBpZiAoZGVjaW1hbFBsYWNlcyA+PSAwKSB7DQogICAgICAgICAgICByZXN1bHQgPSBwYXJzZUZsb2F0KHJlc3VsdC50b0ZpeGVkKGRlY2ltYWxQbGFjZXMpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBub2RlLmxhc3RWYWx1ZUEgPSB2YWx1ZUE7DQogICAgICAgIG5vZGUubGFzdFZhbHVlQiA9IHZhbHVlQjsNCiAgICAgICAgbm9kZS5sYXN0UmVzdWx0ID0gcmVzdWx0Ow0KICAgICAgICBub2RlLmxhc3RPcGVyYXRpb24gPSBvcGVyYXRpb247DQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHJlc3VsdDogcmVzdWx0LA0KICAgICAgICAgICAgZGF0YTogcmVzdWx0LA0KICAgICAgICAgICAgdGV4dDogcmVzdWx0LnRvU3RyaW5nKCksDQogICAgICAgICAgICBmb3JtYXR0ZWQ6IGRlY2ltYWxQbGFjZXMgPT09IDAgPyByZXN1bHQudG9TdHJpbmcoKSA6IHJlc3VsdC50b0ZpeGVkKGRlY2ltYWxQbGFjZXMpDQogICAgICAgIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTWF0aCBvcGVyYXRpb24gZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgcmVzdWx0OiAwLA0KICAgICAgICAgICAgZGF0YTogMCwNCiAgICAgICAgICAgIHRleHQ6ICIwIiwNCiAgICAgICAgICAgIGZvcm1hdHRlZDogZGVjaW1hbFBsYWNlcyA9PT0gMCA/ICIwIiA6ICIwLjAwIiwNCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQovLyBBcnJheSBPcGVyYXRpb25zIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVBcnJheU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgb3BlcmF0aW9uID0gbm9kZS5jb25maWcub3BlcmF0aW9uLnZhbHVlOw0KICAgIGNvbnN0IGZpZWxkUGF0aCA9IG5vZGUuY29uZmlnLmZpZWxkX3BhdGgudmFsdWU7DQogICAgY29uc3QgZmlsdGVyVmFsdWUgPSBub2RlLmNvbmZpZy5maWx0ZXJfdmFsdWUudmFsdWU7DQogICAgY29uc3QgZmlsdGVyT3BlcmF0b3IgPSBub2RlLmNvbmZpZy5maWx0ZXJfb3BlcmF0b3IudmFsdWU7DQogICAgY29uc3Qgam9pblNlcGFyYXRvciA9IG5vZGUuY29uZmlnLmpvaW5fc2VwYXJhdG9yLnZhbHVlIHx8ICcsICc7DQogICAgY29uc3Qgc2xpY2VTdGFydCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLnNsaWNlX3N0YXJ0LnZhbHVlKSB8fCAwOw0KICAgIGNvbnN0IHNsaWNlRW5kID0gcGFyc2VJbnQobm9kZS5jb25maWcuc2xpY2VfZW5kLnZhbHVlKSB8fCAwOw0KDQogICAgLy8gR2V0IGFycmF5IGZyb20gaW5wdXQNCiAgICBsZXQgYXJyYXkgPSBpbnB1dERhdGEuYXJyYXkgfHwgaW5wdXREYXRhLmRhdGE7DQogICAgbGV0IG9iamVjdCA9IGlucHV0RGF0YS5vYmplY3QgfHwgaW5wdXREYXRhLmRhdGE7DQogICAgDQogICAgLy8gRm9yIG9iamVjdCBvcGVyYXRpb25zLCB3ZSB3b3JrIHdpdGggb2JqZWN0cyBpbnN0ZWFkIG9mIGFycmF5cw0KICAgIGlmIChbJ29iamVjdF9rZXlzJywgJ29iamVjdF92YWx1ZXMnLCAnb2JqZWN0X2VudHJpZXMnXS5pbmNsdWRlcyhvcGVyYXRpb24pKSB7DQogICAgICAgIC8vIFBhcnNlIG9iamVjdCBpZiBpdCdzIGEgc3RyaW5nDQogICAgICAgIGlmICh0eXBlb2Ygb2JqZWN0ID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBvYmplY3QgPSBKU09OLnBhcnNlKG9iamVjdCk7DQogICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIG9iamVjdDonLCBlKTsNCiAgICAgICAgICAgICAgICByZXR1cm4geyByZXN1bHQ6IG51bGwsIGVycm9yOiAnSW52YWxpZCBvYmplY3QgZGF0YScgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh0eXBlb2Ygb2JqZWN0ICE9PSAnb2JqZWN0JyB8fCBBcnJheS5pc0FycmF5KG9iamVjdCkgfHwgb2JqZWN0ID09PSBudWxsKSB7DQogICAgICAgICAgICByZXR1cm4geyByZXN1bHQ6IG51bGwsIGVycm9yOiAnSW5wdXQgaXMgbm90IGFuIG9iamVjdCcgfTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIFBhcnNlIGFycmF5IGlmIGl0J3MgYSBzdHJpbmcgKGV4aXN0aW5nIGxvZ2ljKQ0KICAgICAgICBpZiAodHlwZW9mIGFycmF5ID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBhcnJheSA9IEpTT04ucGFyc2UoYXJyYXkpOw0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSBhcnJheTonLCBlKTsNCiAgICAgICAgICAgICAgICByZXR1cm4geyByZXN1bHQ6IG51bGwsIGVycm9yOiAnSW52YWxpZCBhcnJheSBkYXRhJyB9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBudWxsLCBlcnJvcjogJ0lucHV0IGlzIG5vdCBhbiBhcnJheScgfTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGxldCByZXN1bHQgPSBudWxsOw0KDQogICAgdHJ5IHsNCiAgICAgICAgc3dpdGNoIChvcGVyYXRpb24pIHsNCiAgICAgICAgICAgIGNhc2UgJ21hcCc6DQogICAgICAgICAgICAgICAgaWYgKGZpZWxkUGF0aCkgew0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5tYXAoaXRlbSA9PiBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShpdGVtLCBmaWVsZFBhdGgpKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5zbGljZSgpOyAvLyBSZXR1cm4gY29weSBvZiBhcnJheQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2ZpbHRlcic6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkuZmlsdGVyKGl0ZW0gPT4gew0KICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBmaWVsZFBhdGggPyBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShpdGVtLCBmaWVsZFBhdGgpIDogaXRlbTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBlcmZvcm1GaWx0ZXJPcGVyYXRpb24odmFsdWUsIGZpbHRlclZhbHVlLCBmaWx0ZXJPcGVyYXRvcik7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdsZW5ndGgnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5Lmxlbmd0aDsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2pvaW4nOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5Lm1hcChpdGVtID0+IHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGZpZWxkUGF0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVXRpbHMuZXh0cmFjdE5lc3RlZFZhbHVlKGl0ZW0sIGZpZWxkUGF0aCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBpdGVtID09PSAnb2JqZWN0JyA/IEpTT04uc3RyaW5naWZ5KGl0ZW0pIDogU3RyaW5nKGl0ZW0pOw0KICAgICAgICAgICAgICAgIH0pLmpvaW4oam9pblNlcGFyYXRvcik7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdmaXJzdCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkubGVuZ3RoID4gMCA/IGFycmF5WzBdIDogbnVsbDsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2xhc3QnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5Lmxlbmd0aCA+IDAgPyBhcnJheVthcnJheS5sZW5ndGggLSAxXSA6IG51bGw7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdyYW5kb20nOg0KICAgICAgICAgICAgICAgIGlmIChhcnJheS5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gbnVsbDsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBjb25zdCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFycmF5Lmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5W3JhbmRvbUluZGV4XTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzbGljZSc6DQogICAgICAgICAgICAgICAgY29uc3QgZW5kID0gc2xpY2VFbmQgPiAwID8gc2xpY2VFbmQgOiBhcnJheS5sZW5ndGg7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkuc2xpY2Uoc2xpY2VTdGFydCwgZW5kKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JldmVyc2UnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5LnNsaWNlKCkucmV2ZXJzZSgpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnc29ydCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkuc2xpY2UoKS5zb3J0KChhLCBiKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZUEgPSBmaWVsZFBhdGggPyBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShhLCBmaWVsZFBhdGgpIDogYTsNCiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlQiA9IGZpZWxkUGF0aCA/IHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVXRpbHMuZXh0cmFjdE5lc3RlZFZhbHVlKGIsIGZpZWxkUGF0aCkgOiBiOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWVBIDwgdmFsdWVCID8gLTEgOiB2YWx1ZUEgPiB2YWx1ZUIgPyAxIDogMDsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3VuaXF1ZSc6DQogICAgICAgICAgICAgICAgaWYgKGZpZWxkUGF0aCkgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWVuID0gbmV3IFNldCgpOw0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5maWx0ZXIoaXRlbSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVXRpbHMuZXh0cmFjdE5lc3RlZFZhbHVlKGl0ZW0sIGZpZWxkUGF0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2Vlbi5oYXModmFsdWUpKSByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWVuLmFkZCh2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gWy4uLm5ldyBTZXQoYXJyYXkpXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdvYmplY3Rfa2V5cyc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gT2JqZWN0LmtleXMob2JqZWN0KTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ29iamVjdF92YWx1ZXMnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE9iamVjdC52YWx1ZXMob2JqZWN0KTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ29iamVjdF9lbnRyaWVzJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBPYmplY3QuZW50cmllcyhvYmplY3QpLm1hcCgoW2tleSwgdmFsdWVdKSA9PiAoew0KICAgICAgICAgICAgICAgICAgICBrZXk6IGtleSwNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlDQogICAgICAgICAgICAgICAgfSkpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBpZiAoWydvYmplY3Rfa2V5cycsICdvYmplY3RfdmFsdWVzJywgJ29iamVjdF9lbnRyaWVzJ10uaW5jbHVkZXMob3BlcmF0aW9uKSkgew0KICAgICAgICAgICAgbm9kZS5sYXN0QXJyYXkgPSBvYmplY3Q7DQogICAgICAgICAgICBub2RlLmxhc3RPYmplY3QgPSBvYmplY3Q7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBub2RlLmxhc3RBcnJheSA9IGFycmF5Ow0KICAgICAgICB9DQogICAgICAgIG5vZGUubGFzdFJlc3VsdCA9IHJlc3VsdDsNCiAgICAgICAgbm9kZS5sYXN0T3BlcmF0aW9uID0gb3BlcmF0aW9uOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXN1bHQ6IHJlc3VsdCwNCiAgICAgICAgICAgIGRhdGE6IHJlc3VsdCwNCiAgICAgICAgICAgIHRleHQ6IEFycmF5LmlzQXJyYXkocmVzdWx0KSA/IEpTT04uc3RyaW5naWZ5KHJlc3VsdCkgOiBTdHJpbmcocmVzdWx0KSwNCiAgICAgICAgICAgIGxlbmd0aDogQXJyYXkuaXNBcnJheShyZXN1bHQpID8gcmVzdWx0Lmxlbmd0aCA6IEFycmF5LmlzQXJyYXkoYXJyYXkpID8gYXJyYXkubGVuZ3RoIDogMCwNCiAgICAgICAgICAgIGZpcnN0OiBBcnJheS5pc0FycmF5KGFycmF5KSAmJiBhcnJheS5sZW5ndGggPiAwID8gYXJyYXlbMF0gOiBudWxsLA0KICAgICAgICAgICAgbGFzdDogQXJyYXkuaXNBcnJheShhcnJheSkgJiYgYXJyYXkubGVuZ3RoID4gMCA/IGFycmF5W2FycmF5Lmxlbmd0aCAtIDFdIDogbnVsbA0KICAgICAgICB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0FycmF5IG9wZXJhdGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXN1bHQ6IG51bGwsDQogICAgICAgICAgICBkYXRhOiBudWxsLA0KICAgICAgICAgICAgdGV4dDogIiIsDQogICAgICAgICAgICBsZW5ndGg6IDAsDQogICAgICAgICAgICBmaXJzdDogbnVsbCwNCiAgICAgICAgICAgIGxhc3Q6IG51bGwsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIGZvciBhcnJheSBmaWx0ZXJpbmcNCmZ1bmN0aW9uIHBlcmZvcm1GaWx0ZXJPcGVyYXRpb24odmFsdWUsIGZpbHRlclZhbHVlLCBvcGVyYXRvcikgew0KICAgIGNvbnN0IHZhbHVlU3RyID0gU3RyaW5nKHZhbHVlKS50b0xvd2VyQ2FzZSgpOw0KICAgIGNvbnN0IGZpbHRlclN0ciA9IFN0cmluZyhmaWx0ZXJWYWx1ZSkudG9Mb3dlckNhc2UoKTsNCiAgICANCiAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7DQogICAgICAgIGNhc2UgJ2VxdWFscyc6DQogICAgICAgICAgICByZXR1cm4gdmFsdWUgPT0gZmlsdGVyVmFsdWU7DQogICAgICAgIGNhc2UgJ25vdF9lcXVhbHMnOg0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlICE9IGZpbHRlclZhbHVlOw0KICAgICAgICBjYXNlICdjb250YWlucyc6DQogICAgICAgICAgICByZXR1cm4gdmFsdWVTdHIuaW5jbHVkZXMoZmlsdGVyU3RyKTsNCiAgICAgICAgY2FzZSAnZ3JlYXRlcl90aGFuJzoNCiAgICAgICAgICAgIHJldHVybiBOdW1iZXIodmFsdWUpID4gTnVtYmVyKGZpbHRlclZhbHVlKTsNCiAgICAgICAgY2FzZSAnbGVzc190aGFuJzoNCiAgICAgICAgICAgIHJldHVybiBOdW1iZXIodmFsdWUpIDwgTnVtYmVyKGZpbHRlclZhbHVlKTsNCiAgICAgICAgY2FzZSAnc3RhcnRzX3dpdGgnOg0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlU3RyLnN0YXJ0c1dpdGgoZmlsdGVyU3RyKTsNCiAgICAgICAgY2FzZSAnZW5kc193aXRoJzoNCiAgICAgICAgICAgIHJldHVybiB2YWx1ZVN0ci5lbmRzV2l0aChmaWx0ZXJTdHIpOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KfQ0KDQovLyBTdHJpbmcgT3BlcmF0aW9ucyBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlU3RyaW5nTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBvcGVyYXRpb24gPSBub2RlLmNvbmZpZy5vcGVyYXRpb24udmFsdWU7DQogICAgY29uc3QgY29uZmlnVGV4dEIgPSBub2RlLmNvbmZpZy50ZXh0X2IudmFsdWU7DQogICAgDQogICAgLy8gUHJvY2VzcyBlc2NhcGUgc2VxdWVuY2VzIGluIHNlcGFyYXRvciAoZS5nLiwgXG4sIFxyXG4sIFx0LCBldGMuKQ0KICAgIGxldCBzZXBhcmF0b3IgPSBub2RlLmNvbmZpZy5zZXBhcmF0b3IudmFsdWUgfHwgJywnOw0KICAgIHNlcGFyYXRvciA9IHNlcGFyYXRvcg0KICAgICAgICAucmVwbGFjZSgvXFxuL2csICdcbicpDQogICAgICAgIC5yZXBsYWNlKC9cXHIvZywgJ1xyJykNCiAgICAgICAgLnJlcGxhY2UoL1xcdC9nLCAnXHQnKQ0KICAgICAgICAucmVwbGFjZSgvXFxcXC9nLCAnXFwnKTsNCiAgICANCiAgICBjb25zdCBzZWFyY2hUZXh0ID0gbm9kZS5jb25maWcuc2VhcmNoX3RleHQudmFsdWU7DQogICAgY29uc3QgcmVwbGFjZVRleHQgPSBub2RlLmNvbmZpZy5yZXBsYWNlX3RleHQudmFsdWU7DQogICAgY29uc3Qgc3RhcnRJbmRleCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLnN0YXJ0X2luZGV4LnZhbHVlKSB8fCAwOw0KICAgIGNvbnN0IGVuZEluZGV4ID0gcGFyc2VJbnQobm9kZS5jb25maWcuZW5kX2luZGV4LnZhbHVlKSB8fCAwOw0KICAgIGNvbnN0IHJlcGVhdENvdW50ID0gcGFyc2VJbnQobm9kZS5jb25maWcucmVwZWF0X2NvdW50LnZhbHVlKSB8fCAxOw0KICAgIGNvbnN0IGNhc2VTZW5zaXRpdmUgPSBub2RlLmNvbmZpZy5jYXNlX3NlbnNpdGl2ZS52YWx1ZSA9PT0gJ3RydWUnOw0KDQogICAgLy8gR2V0IHRleHQgaW5wdXRzDQogICAgbGV0IHRleHRBID0gaW5wdXREYXRhLnRleHQgfHwgaW5wdXREYXRhLmRhdGEgfHwgJyc7DQogICAgbGV0IHRleHRCID0gaW5wdXREYXRhLnRleHRfYiB8fCBjb25maWdUZXh0QiB8fCAnJzsNCg0KDQoNCiAgICAvLyBDb252ZXJ0IHRvIHN0cmluZ3MNCiAgICBpZiAodHlwZW9mIHRleHRBICE9PSAnc3RyaW5nJykgdGV4dEEgPSBTdHJpbmcodGV4dEEpOw0KICAgIGlmICh0eXBlb2YgdGV4dEIgIT09ICdzdHJpbmcnKSB0ZXh0QiA9IFN0cmluZyh0ZXh0Qik7DQoNCiAgICBsZXQgcmVzdWx0ID0gJyc7DQoNCiAgICB0cnkgew0KICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbikgew0KICAgICAgICAgICAgY2FzZSAnY29uY2F0ZW5hdGUnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBICsgc2VwYXJhdG9yICsgdGV4dEI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzcGxpdCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdGV4dEEuc3BsaXQoc2VwYXJhdG9yKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JlcGxhY2UnOg0KICAgICAgICAgICAgICAgIGlmIChjYXNlU2Vuc2l0aXZlKSB7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnJlcGxhY2UobmV3IFJlZ0V4cChlc2NhcGVSZWdleChzZWFyY2hUZXh0KSwgJ2cnKSwgcmVwbGFjZVRleHQpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnJlcGxhY2UobmV3IFJlZ0V4cChlc2NhcGVSZWdleChzZWFyY2hUZXh0KSwgJ2dpJyksIHJlcGxhY2VUZXh0KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICd0cmltJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS50cmltKCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICd1cHBlcmNhc2UnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdsb3dlcmNhc2UnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzdWJzdHJpbmcnOg0KICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IGVuZEluZGV4ID4gMCA/IGVuZEluZGV4IDogdGV4dEEubGVuZ3RoOw0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnN1YnN0cmluZyhzdGFydEluZGV4LCBlbmQpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAncmVnZXhfbWF0Y2gnOg0KICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoRmxhZ3MgPSBjYXNlU2Vuc2l0aXZlID8gJ2cnIDogJ2dpJzsNCiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gdGV4dEEubWF0Y2gobmV3IFJlZ0V4cChzZWFyY2hUZXh0LCBtYXRjaEZsYWdzKSk7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gbWF0Y2hlcyB8fCBbXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JlZ2V4X3JlcGxhY2UnOg0KICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VGbGFncyA9IGNhc2VTZW5zaXRpdmUgPyAnZycgOiAnZ2knOw0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnJlcGxhY2UobmV3IFJlZ0V4cChzZWFyY2hUZXh0LCByZXBsYWNlRmxhZ3MpLCByZXBsYWNlVGV4dCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzdGFydHNfd2l0aCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gY2FzZVNlbnNpdGl2ZSA/IHRleHRBLnN0YXJ0c1dpdGgoc2VhcmNoVGV4dCkgOiANCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChzZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCkpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZW5kc193aXRoJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBjYXNlU2Vuc2l0aXZlID8gdGV4dEEuZW5kc1dpdGgoc2VhcmNoVGV4dCkgOiANCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2NvbnRhaW5zJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBjYXNlU2Vuc2l0aXZlID8gdGV4dEEuaW5jbHVkZXMoc2VhcmNoVGV4dCkgOiANCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JlcGVhdCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdGV4dEEucmVwZWF0KE1hdGgubWF4KDAsIE1hdGgubWluKHJlcGVhdENvdW50LCAxMDApKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdsYXN0X2xpbmUnOg0KICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gdGV4dEEuc3BsaXQoJ1xuJykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkubGVuZ3RoID4gMCk7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gbGluZXMubGVuZ3RoID4gMCA/IGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdIDogJyc7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU3RvcmUgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgICAgIG5vZGUubGFzdFRleHRBID0gdGV4dEE7DQogICAgICAgIG5vZGUubGFzdFRleHRCID0gdGV4dEI7DQogICAgICAgIG5vZGUubGFzdFJlc3VsdCA9IHJlc3VsdDsNCiAgICAgICAgbm9kZS5sYXN0T3BlcmF0aW9uID0gb3BlcmF0aW9uOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXN1bHQ6IEFycmF5LmlzQXJyYXkocmVzdWx0KSA/IHJlc3VsdCA6IFN0cmluZyhyZXN1bHQpLA0KICAgICAgICAgICAgZGF0YTogcmVzdWx0LA0KICAgICAgICAgICAgYXJyYXk6IEFycmF5LmlzQXJyYXkocmVzdWx0KSA/IHJlc3VsdCA6IG51bGwsDQogICAgICAgICAgICBsZW5ndGg6IFN0cmluZyhyZXN1bHQpLmxlbmd0aCwNCiAgICAgICAgICAgIHdvcmRfY291bnQ6IFN0cmluZyhyZXN1bHQpLnRyaW0oKS5zcGxpdCgvXHMrLykuZmlsdGVyKHdvcmQgPT4gd29yZC5sZW5ndGggPiAwKS5sZW5ndGgNCiAgICAgICAgfTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdTdHJpbmcgb3BlcmF0aW9uIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHJlc3VsdDogJycsDQogICAgICAgICAgICBkYXRhOiAnJywNCiAgICAgICAgICAgIGFycmF5OiBudWxsLA0KICAgICAgICAgICAgbGVuZ3RoOiAwLA0KICAgICAgICAgICAgd29yZF9jb3VudDogMCwNCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gZXNjYXBlIHJlZ2V4IHNwZWNpYWwgY2hhcmFjdGVycw0KZnVuY3Rpb24gZXNjYXBlUmVnZXgoc3RyaW5nKSB7DQogICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC9bLiorP14ke30oKXxbXF1cXF0vZywgJ1xcJCYnKTsNCn0NCg0KLy8gTm9kZSBSZWZlcmVuY2UgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZU5vZGVSZWZlcmVuY2VOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IHNvdXJjZU5vZGVJZCA9IG5vZGUuY29uZmlnLnNvdXJjZV9ub2RlX2lkLnZhbHVlOw0KICAgIGNvbnN0IG91dHB1dFBvcnRJZCA9IG5vZGUuY29uZmlnLm91dHB1dF9wb3J0X2lkLnZhbHVlOw0KICAgIGNvbnN0IGZhbGxiYWNrVmFsdWUgPSBub2RlLmNvbmZpZy5mYWxsYmFja192YWx1ZS52YWx1ZSB8fCBudWxsOw0KDQogICAgLy8gVmFsaWRhdGUgaW5wdXRzDQogICAgaWYgKCFzb3VyY2VOb2RlSWQpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCdOb2RlIFJlZmVyZW5jZTogTm8gc291cmNlIG5vZGUgc2VsZWN0ZWQnKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGRhdGE6IGZhbGxiYWNrVmFsdWUsDQogICAgICAgICAgICB0ZXh0OiBTdHJpbmcoZmFsbGJhY2tWYWx1ZSB8fCAnJyksDQogICAgICAgICAgICBqc29uOiBmYWxsYmFja1ZhbHVlLA0KICAgICAgICAgICAgbnVtYmVyOiBpc05hTihOdW1iZXIoZmFsbGJhY2tWYWx1ZSkpID8gMCA6IE51bWJlcihmYWxsYmFja1ZhbHVlKSwNCiAgICAgICAgICAgIGJvb2xlYW46IEJvb2xlYW4oZmFsbGJhY2tWYWx1ZSksDQogICAgICAgICAgICBiaW5hcnk6IG51bGwsDQogICAgICAgICAgICBvcmlnaW5hbDogZmFsbGJhY2tWYWx1ZSwNCiAgICAgICAgICAgIGVycm9yOiAnTm8gc291cmNlIG5vZGUgc2VsZWN0ZWQnDQogICAgICAgIH07DQogICAgfQ0KDQogICAgaWYgKCFvdXRwdXRQb3J0SWQpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCdOb2RlIFJlZmVyZW5jZTogTm8gb3V0cHV0IHBvcnQgc2VsZWN0ZWQnKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGRhdGE6IGZhbGxiYWNrVmFsdWUsDQogICAgICAgICAgICB0ZXh0OiBTdHJpbmcoZmFsbGJhY2tWYWx1ZSB8fCAnJyksDQogICAgICAgICAgICBqc29uOiBmYWxsYmFja1ZhbHVlLA0KICAgICAgICAgICAgbnVtYmVyOiBpc05hTihOdW1iZXIoZmFsbGJhY2tWYWx1ZSkpID8gMCA6IE51bWJlcihmYWxsYmFja1ZhbHVlKSwNCiAgICAgICAgICAgIGJvb2xlYW46IEJvb2xlYW4oZmFsbGJhY2tWYWx1ZSksDQogICAgICAgICAgICBiaW5hcnk6IG51bGwsDQogICAgICAgICAgICBvcmlnaW5hbDogZmFsbGJhY2tWYWx1ZSwNCiAgICAgICAgICAgIGVycm9yOiAnTm8gb3V0cHV0IHBvcnQgc2VsZWN0ZWQnDQogICAgICAgIH07DQogICAgfQ0KDQogICAgdHJ5IHsNCiAgICAgICAgLy8gR2V0IHRoZSByZWZlcmVuY2VkIGRhdGEgdXNpbmcgdGhlIGV4aXN0aW5nIGZ1bmN0aW9uDQogICAgICAgIGNvbnN0IHJlZmVyZW5jZWREYXRhID0gZ2V0T3V0cHV0UG9ydERhdGEoc291cmNlTm9kZUlkLCBvdXRwdXRQb3J0SWQpOw0KICAgICAgICANCiAgICAgICAgaWYgKHJlZmVyZW5jZWREYXRhID09PSBudWxsIHx8IHJlZmVyZW5jZWREYXRhID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGNvbnNvbGUud2FybihgTm9kZSBSZWZlcmVuY2U6IE5vIGRhdGEgZm91bmQgZm9yIG5vZGUgJHtzb3VyY2VOb2RlSWR9LCBwb3J0ICR7b3V0cHV0UG9ydElkfWApOw0KICAgICAgICAgICAgY29uc3QgZmFsbGJhY2sgPSBmYWxsYmFja1ZhbHVlICE9PSAnJyA/IGZhbGxiYWNrVmFsdWUgOiBudWxsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIGRhdGE6IGZhbGxiYWNrLA0KICAgICAgICAgICAgICAgIHRleHQ6IFN0cmluZyhmYWxsYmFjayB8fCAnJyksDQogICAgICAgICAgICAgICAganNvbjogZmFsbGJhY2ssDQogICAgICAgICAgICAgICAgbnVtYmVyOiBpc05hTihOdW1iZXIoZmFsbGJhY2spKSA/IDAgOiBOdW1iZXIoZmFsbGJhY2spLA0KICAgICAgICAgICAgICAgIGJvb2xlYW46IEJvb2xlYW4oZmFsbGJhY2spLA0KICAgICAgICAgICAgICAgIGJpbmFyeTogbnVsbCwNCiAgICAgICAgICAgICAgICBvcmlnaW5hbDogZmFsbGJhY2ssDQogICAgICAgICAgICAgICAgZXJyb3I6IGBObyBkYXRhIGZvdW5kIGZvciBub2RlICR7c291cmNlTm9kZUlkfSwgcG9ydCAke291dHB1dFBvcnRJZH1gDQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU3VjY2Vzc2Z1bGx5IGdvdCB0aGUgZGF0YSAtIGZvcm1hdCBpdCBmb3IgYWxsIG91dHB1dCB0eXBlcw0KICAgICAgICBsZXQgdGV4dFZhbHVlID0gU3RyaW5nKHJlZmVyZW5jZWREYXRhKTsNCiAgICAgICAgbGV0IGpzb25WYWx1ZSA9IHJlZmVyZW5jZWREYXRhOw0KICAgICAgICBsZXQgbnVtYmVyVmFsdWUgPSAwOw0KICAgICAgICBsZXQgYm9vbGVhblZhbHVlID0gQm9vbGVhbihyZWZlcmVuY2VkRGF0YSk7DQoNCiAgICAgICAgLy8gSGFuZGxlIGRpZmZlcmVudCBkYXRhIHR5cGVzIGFwcHJvcHJpYXRlbHkNCiAgICAgICAgaWYgKHR5cGVvZiByZWZlcmVuY2VkRGF0YSA9PT0gJ251bWJlcicpIHsNCiAgICAgICAgICAgIG51bWJlclZhbHVlID0gcmVmZXJlbmNlZERhdGE7DQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHJlZmVyZW5jZWREYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gTnVtYmVyKHJlZmVyZW5jZWREYXRhKTsNCiAgICAgICAgICAgIG51bWJlclZhbHVlID0gaXNOYU4ocGFyc2VkKSA/IDAgOiBwYXJzZWQ7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBGb3IgSlNPTiBvdXRwdXQsIHRyeSB0byBwcmVzZXJ2ZSBvYmplY3Qgc3RydWN0dXJlDQogICAgICAgIGlmICh0eXBlb2YgcmVmZXJlbmNlZERhdGEgPT09ICdvYmplY3QnKSB7DQogICAgICAgICAgICBqc29uVmFsdWUgPSByZWZlcmVuY2VkRGF0YTsNCiAgICAgICAgICAgIHRleHRWYWx1ZSA9IEpTT04uc3RyaW5naWZ5KHJlZmVyZW5jZWREYXRhLCBudWxsLCAyKTsNCiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcmVmZXJlbmNlZERhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBKU09ODQogICAgICAgICAgICAgICAganNvblZhbHVlID0gSlNPTi5wYXJzZShyZWZlcmVuY2VkRGF0YSk7DQogICAgICAgICAgICB9IGNhdGNoIHsNCiAgICAgICAgICAgICAgICAvLyBOb3QgdmFsaWQgSlNPTiwga2VlcCBhcyBzdHJpbmcNCiAgICAgICAgICAgICAgICBqc29uVmFsdWUgPSByZWZlcmVuY2VkRGF0YTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGRhdGE6IHJlZmVyZW5jZWREYXRhLA0KICAgICAgICAgICAgdGV4dDogdGV4dFZhbHVlLA0KICAgICAgICAgICAganNvbjoganNvblZhbHVlLA0KICAgICAgICAgICAgbnVtYmVyOiBudW1iZXJWYWx1ZSwNCiAgICAgICAgICAgIGJvb2xlYW46IGJvb2xlYW5WYWx1ZSwNCiAgICAgICAgICAgIGJpbmFyeTogKHJlZmVyZW5jZWREYXRhIGluc3RhbmNlb2YgQmxvYiB8fCByZWZlcmVuY2VkRGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSA/IHJlZmVyZW5jZWREYXRhIDogbnVsbCwNCiAgICAgICAgICAgIG9yaWdpbmFsOiByZWZlcmVuY2VkRGF0YQ0KICAgICAgICB9Ow0KDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTm9kZSBSZWZlcmVuY2UgZXhlY3V0aW9uIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgY29uc3QgZmFsbGJhY2sgPSBmYWxsYmFja1ZhbHVlICE9PSAnJyA/IGZhbGxiYWNrVmFsdWUgOiBudWxsOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGRhdGE6IGZhbGxiYWNrLA0KICAgICAgICAgICAgdGV4dDogU3RyaW5nKGZhbGxiYWNrIHx8ICcnKSwNCiAgICAgICAgICAgIGpzb246IGZhbGxiYWNrLA0KICAgICAgICAgICAgbnVtYmVyOiBpc05hTihOdW1iZXIoZmFsbGJhY2spKSA/IDAgOiBOdW1iZXIoZmFsbGJhY2spLA0KICAgICAgICAgICAgYm9vbGVhbjogQm9vbGVhbihmYWxsYmFjayksDQogICAgICAgICAgICBiaW5hcnk6IG51bGwsDQogICAgICAgICAgICBvcmlnaW5hbDogZmFsbGJhY2ssDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gUmFuZG9tIE51bWJlciBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlUmFuZG9tTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBtaW5WYWx1ZSA9IHBhcnNlRmxvYXQobm9kZS5jb25maWcubWluX3ZhbHVlLnZhbHVlKSB8fCAwOw0KICAgIGNvbnN0IG1heFZhbHVlID0gcGFyc2VGbG9hdChub2RlLmNvbmZpZy5tYXhfdmFsdWUudmFsdWUpIHx8IDEwMDsNCiAgICBjb25zdCBkZWNpbWFsUGxhY2VzID0gcGFyc2VJbnQobm9kZS5jb25maWcuZGVjaW1hbF9wbGFjZXMudmFsdWUpIHx8IDA7DQogICAgY29uc3Qgb3V0cHV0VHlwZSA9IG5vZGUuY29uZmlnLm91dHB1dF90eXBlLnZhbHVlIHx8ICdpbnRlZ2VyJzsNCg0KICAgIC8vIFZhbGlkYXRlIHJhbmdlDQogICAgaWYgKG1pblZhbHVlID49IG1heFZhbHVlKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JhbmRvbTogTWluaW11bSB2YWx1ZSBtdXN0IGJlIGxlc3MgdGhhbiBtYXhpbXVtIHZhbHVlJyk7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBudW1iZXI6IDAsDQogICAgICAgICAgICB0ZXh0OiAnMCcsDQogICAgICAgICAgICBkYXRhOiAnMCcsDQogICAgICAgICAgICBpbnRlZ2VyOiAwLA0KICAgICAgICAgICAgZmxvYXQ6IDAuMCwNCiAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCByYW5nZTogbWluaW11bSBtdXN0IGJlIGxlc3MgdGhhbiBtYXhpbXVtJw0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgIHRyeSB7DQogICAgICAgIC8vIEdlbmVyYXRlIHJhbmRvbSBudW1iZXIgYmV0d2VlbiBtaW4gYW5kIG1heA0KICAgICAgICBsZXQgcmFuZG9tVmFsdWUgPSBNYXRoLnJhbmRvbSgpICogKG1heFZhbHVlIC0gbWluVmFsdWUpICsgbWluVmFsdWU7DQoNCiAgICAgICAgLy8gQXBwbHkgb3V0cHV0IHR5cGUgYW5kIGRlY2ltYWwgcGxhY2VzDQogICAgICAgIGlmIChvdXRwdXRUeXBlID09PSAnaW50ZWdlcicgfHwgZGVjaW1hbFBsYWNlcyA9PT0gMCkgew0KICAgICAgICAgICAgcmFuZG9tVmFsdWUgPSBNYXRoLnJvdW5kKHJhbmRvbVZhbHVlKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJhbmRvbVZhbHVlID0gcGFyc2VGbG9hdChyYW5kb21WYWx1ZS50b0ZpeGVkKGRlY2ltYWxQbGFjZXMpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBub2RlLmxhc3RSYW5kb21WYWx1ZSA9IHJhbmRvbVZhbHVlOw0KICAgICAgICBub2RlLmxhc3RSYW5nZSA9IGAke21pblZhbHVlfSAtICR7bWF4VmFsdWV9YDsNCiAgICAgICAgbm9kZS5sYXN0T3V0cHV0VHlwZSA9IG91dHB1dFR5cGU7DQoNCg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgbnVtYmVyOiByYW5kb21WYWx1ZSwNCiAgICAgICAgICAgIHRleHQ6IFN0cmluZyhyYW5kb21WYWx1ZSksIC8vIENvbnZlcnQgdG8gc3RyaW5nIGZvciBWRlMgY29tcGF0aWJpbGl0eQ0KICAgICAgICAgICAgZGF0YTogU3RyaW5nKHJhbmRvbVZhbHVlKSwgLy8gQ29udmVydCB0byBzdHJpbmcgZm9yIFZGUyBjb21wYXRpYmlsaXR5ICANCiAgICAgICAgICAgIGludGVnZXI6IE1hdGgucm91bmQocmFuZG9tVmFsdWUpLA0KICAgICAgICAgICAgZmxvYXQ6IHBhcnNlRmxvYXQocmFuZG9tVmFsdWUudG9GaXhlZChNYXRoLm1heChkZWNpbWFsUGxhY2VzLCAxKSkpDQogICAgICAgIH07DQoNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdSYW5kb20gZXhlY3V0aW9uIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIG51bWJlcjogMCwNCiAgICAgICAgICAgIHRleHQ6ICcwJywNCiAgICAgICAgICAgIGRhdGE6ICcwJywNCiAgICAgICAgICAgIGludGVnZXI6IDAsDQogICAgICAgICAgICBmbG9hdDogMC4wLA0KICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UNCiAgICAgICAgfTsNCiAgICB9DQp9DQoNCi8vIEV4cG9ydCB0byBnbG9iYWwgc2NvcGUNCnN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5kYXRhRXhlY3V0b3JzID0gew0KICAgIGV4ZWN1dGVUZXh0Tm9kZSwNCiAgICBleGVjdXRlSnNvbkV4dHJhY3ROb2RlLA0KICAgIGV4ZWN1dGVSYW5kb21RdW90ZU5vZGUsDQogICAgZXhlY3V0ZU1hdGhOb2RlLA0KICAgIGV4ZWN1dGVBcnJheU5vZGUsDQogICAgZXhlY3V0ZVN0cmluZ05vZGUsDQogICAgZXhlY3V0ZU5vZGVSZWZlcmVuY2VOb2RlLA0KICAgIGV4ZWN1dGVSYW5kb21Ob2RlDQp9Ow0KDQoNCi8vIEhUVFAgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUh0dHBOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IHVybCA9IG5vZGUuY29uZmlnLnVybC52YWx1ZTsNCiAgICBjb25zdCBtZXRob2QgPSBub2RlLmNvbmZpZy5tZXRob2QudmFsdWU7DQogICAgY29uc3QgaGVhZGVycyA9IEpTT04ucGFyc2Uobm9kZS5jb25maWcuaGVhZGVycy52YWx1ZSB8fCAne30nKTsNCiAgICBjb25zdCBib2R5ID0gbm9kZS5jb25maWcuYm9keS52YWx1ZTsNCiAgICBjb25zdCB1c2VUZW1wbGF0ZSA9IHRydWU7IC8vIEFsd2F5cyBlbmFibGUgdGVtcGxhdGUgcHJvY2Vzc2luZw0KDQogICAgbGV0IHByb2Nlc3NlZEJvZHkgPSBib2R5Ow0KDQoNCg0KICAgIC8vIFByb2Nlc3MgdGVtcGxhdGVzIGZpcnN0IG9uIHRoZSBzdHJpbmcgYm9keQ0KICAgIGlmICh1c2VUZW1wbGF0ZSAmJiBpbnB1dERhdGEpIHsNCiAgICAgICAgcHJvY2Vzc2VkQm9keSA9IHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVXRpbHMucHJvY2Vzc1RlbXBsYXRlcyhwcm9jZXNzZWRCb2R5LCBpbnB1dERhdGEpOw0KDQogICAgfQ0KDQogICAgLy8gVGhlbiBwYXJzZSBhcyBKU09OIGlmIGl0J3MgYSBzdHJpbmcgYW5kIGxvb2tzIGxpa2UgSlNPTg0KICAgIGlmICh0eXBlb2YgcHJvY2Vzc2VkQm9keSA9PT0gJ3N0cmluZycgJiYgcHJvY2Vzc2VkQm9keS50cmltKCkuc3RhcnRzV2l0aCgneycpKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBwcm9jZXNzZWRCb2R5ID0gSlNPTi5wYXJzZShwcm9jZXNzZWRCb2R5KTsNCiAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gcGFyc2UgYm9keSBhcyBKU09OLCB1c2luZyBhcyBzdHJpbmc6JywgZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBVc2UgT1MgcHJveHkgdG8gYnlwYXNzIENPUlMNCiAgICBjb25zdCBwcm94eVJlcXVlc3QgPSB7DQogICAgICAgIHVybDogdXJsLA0KICAgICAgICBtZXRob2Q6IG1ldGhvZCwNCiAgICAgICAgaGVhZGVyczogaGVhZGVycywNCiAgICAgICAgYm9keTogcHJvY2Vzc2VkQm9keSwNCiAgICAgICAgdGltZW91dDogMzANCiAgICB9Ow0KDQoNCiAgICBjb25zdCBwcm94eVJlc3BvbnNlID0gYXdhaXQgc3lwbmV4QVBJLnByb3h5SFRUUChwcm94eVJlcXVlc3QpOw0KDQogICAgaWYgKCFwcm94eVJlc3BvbnNlIHx8IHByb3h5UmVzcG9uc2Uuc3RhdHVzIDwgMjAwIHx8IHByb3h5UmVzcG9uc2Uuc3RhdHVzID49IDMwMCkgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFByb3h5IHJlcXVlc3QgZmFpbGVkOiAke3Byb3h5UmVzcG9uc2U/LnN0YXR1cyB8fCAnVW5rbm93biBlcnJvcid9YCk7DQogICAgfQ0KDQogICAgY29uc3QgcHJveHlEYXRhID0gcHJveHlSZXNwb25zZTsNCg0KICAgIGlmIChwcm94eURhdGEuZXJyb3IpIHsNCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIHJlcXVlc3QgZmFpbGVkOiAke3Byb3h5RGF0YS5lcnJvcn1gKTsNCiAgICB9DQoNCiAgICAvLyBDaGVjayBpZiByZXNwb25zZSBpcyBiaW5hcnkgKGF1ZGlvLCBpbWFnZSwgZXRjLikNCiAgICBpZiAocHJveHlEYXRhLmlzX2JpbmFyeSkgew0KDQogICAgICAgIC8vIENvbnZlcnQgYmFzZTY0IGNvbnRlbnQgdG8gYmxvYiBmb3IgYmluYXJ5IGRhdGENCiAgICAgICAgY29uc3QgYmluYXJ5RGF0YSA9IGF0b2IocHJveHlEYXRhLmNvbnRlbnQpOw0KICAgICAgICBjb25zdCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGJpbmFyeURhdGEubGVuZ3RoKTsNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaW5hcnlEYXRhLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBieXRlc1tpXSA9IGJpbmFyeURhdGEuY2hhckNvZGVBdChpKTsNCiAgICAgICAgfQ0KICAgICAgICBjb25zdCBjb250ZW50VHlwZSA9IHByb3h5RGF0YS5oZWFkZXJzWydjb250ZW50LXR5cGUnXSB8fCBwcm94eURhdGEuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gfHwgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSc7DQogICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbYnl0ZXNdLCB7IHR5cGU6IGNvbnRlbnRUeXBlIH0pOw0KDQogICAgICAgIC8vIFJldHVybiBzdHJ1Y3R1cmVkIG91dHB1dCBmb3IgYmluYXJ5IHJlc3BvbnNlcyB3aXRoIGFsbCBwb3J0cw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgb3JpZ2luYWxfZGF0YTogYmxvYiwNCiAgICAgICAgICAgIHByb2Nlc3NlZF9kYXRhOiBibG9iLA0KICAgICAgICAgICAgcmVzcG9uc2U6IGJsb2IsDQogICAgICAgICAgICBzdGF0dXNfY29kZTogcHJveHlEYXRhLnN0YXR1cyB8fCAyMDAsDQogICAgICAgICAgICBoZWFkZXJzOiBwcm94eURhdGEuaGVhZGVycyB8fCB7fSwNCiAgICAgICAgICAgIHBhcnNlZF9qc29uOiBudWxsLA0KICAgICAgICAgICAgLy8gQWxzbyBwcm92aWRlIHRoZSByYXcgcmVzcG9uc2UgYXMgJ2RhdGEnIGZvciBjb21wYXRpYmlsaXR5DQogICAgICAgICAgICBkYXRhOiBibG9iLA0KICAgICAgICAgICAgLy8gQWRkIHRoZSBtaXNzaW5nIG91dHB1dCBwb3J0cyBmcm9tIG5vZGUgZGVmaW5pdGlvbg0KICAgICAgICAgICAgdGV4dDogbnVsbCwNCiAgICAgICAgICAgIGpzb246IG51bGwsDQogICAgICAgICAgICB1cmw6IHVybCwNCiAgICAgICAgICAgIGJpbmFyeTogYnl0ZXMsICAvLyBSYXcgYmluYXJ5IGRhdGEgYXMgVWludDhBcnJheQ0KICAgICAgICAgICAgYmxvYjogYmxvYiAgICAgIC8vIEJsb2Igb2JqZWN0IGZvciBjb21wYXRpYmlsaXR5DQogICAgICAgIH07DQogICAgfQ0KDQogICAgLy8gRm9yIHRleHQgcmVzcG9uc2VzLCB0cnkgdG8gcGFyc2UgYXMgSlNPTiBhbmQgcmV0dXJuIHN0cnVjdHVyZWQgb3V0cHV0DQoNCiAgICBsZXQgcGFyc2VkSnNvbiA9IG51bGw7DQogICAgdHJ5IHsNCiAgICAgICAgLy8gVHJ5IHRvIHBhcnNlIGFzIEpTT04NCiAgICAgICAgcGFyc2VkSnNvbiA9IEpTT04ucGFyc2UocHJveHlEYXRhLmNvbnRlbnQpOw0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICB9DQoNCiAgICAvLyBSZXR1cm4gc3RydWN0dXJlZCBvdXRwdXQgZm9yIHRleHQgcmVzcG9uc2VzIG1hdGNoaW5nIG5ldyBub2RlIGFyY2hpdGVjdHVyZQ0KICAgIHJldHVybiB7DQogICAgICAgIG9yaWdpbmFsX2RhdGE6IHByb3h5RGF0YS5jb250ZW50LA0KICAgICAgICBwcm9jZXNzZWRfZGF0YTogcGFyc2VkSnNvbiB8fCBwcm94eURhdGEuY29udGVudCwNCiAgICAgICAgcmVzcG9uc2U6IHByb3h5RGF0YS5jb250ZW50LA0KICAgICAgICBzdGF0dXNfY29kZTogcHJveHlEYXRhLnN0YXR1cyB8fCAyMDAsDQogICAgICAgIGhlYWRlcnM6IHByb3h5RGF0YS5oZWFkZXJzIHx8IHt9LA0KICAgICAgICBwYXJzZWRfanNvbjogcGFyc2VkSnNvbiwNCiAgICAgICAgLy8gQWxzbyBwcm92aWRlIHRoZSByYXcgcmVzcG9uc2UgYXMgJ2RhdGEnIGZvciBjb21wYXRpYmlsaXR5DQogICAgICAgIGRhdGE6IHByb3h5RGF0YS5jb250ZW50LA0KICAgICAgICAvLyBBZGQgdGhlIG1pc3Npbmcgb3V0cHV0IHBvcnRzIGZyb20gbm9kZSBkZWZpbml0aW9uDQogICAgICAgIHRleHQ6IHByb3h5RGF0YS5jb250ZW50LA0KICAgICAgICBqc29uOiBwYXJzZWRKc29uLA0KICAgICAgICB1cmw6IHVybA0KICAgIH07DQp9DQoNCi8vIFZGUyBMb2FkIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVWZnNMb2FkTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBsZXQgZmlsZVBhdGggPSBub2RlLmNvbmZpZy5maWxlX3BhdGgudmFsdWU7DQogICAgY29uc3QgZm9ybWF0ID0gbm9kZS5jb25maWcuZm9ybWF0LnZhbHVlOw0KDQogICAgLy8gUHJvY2VzcyB0ZW1wbGF0ZSB2YXJpYWJsZXMgaW4gZmlsZSBwYXRoDQogICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpOw0KICAgIGNvbnN0IGRhdGVUZW1wbGF0ZXMgPSB7DQogICAgICAgICd7e0RBVEV9fSc6IGN1cnJlbnREYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSwgLy8gWVlZWS1NTS1ERA0KICAgICAgICAne3tZWVlZfX0nOiBjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCksDQogICAgICAgICd7e01NfX0nOiAoY3VycmVudERhdGUuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSwNCiAgICAgICAgJ3t7RER9fSc6IGN1cnJlbnREYXRlLmdldERhdGUoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyksDQogICAgICAgICd7e1RJTUVTVEFNUH19JzogY3VycmVudERhdGUuZ2V0VGltZSgpLnRvU3RyaW5nKCksDQogICAgICAgICd7e0lTT19EQVRFfX0nOiBjdXJyZW50RGF0ZS50b0lTT1N0cmluZygpDQogICAgfTsNCg0KICAgIC8vIFJlcGxhY2UgYWxsIHRlbXBsYXRlIHZhcmlhYmxlcyB1c2luZyBzaW1wbGUgc3RyaW5nIHJlcGxhY2VtZW50DQogICAgZm9yIChjb25zdCBbdGVtcGxhdGUsIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhkYXRlVGVtcGxhdGVzKSkgew0KICAgICAgICBmaWxlUGF0aCA9IGZpbGVQYXRoLnJlcGxhY2VBbGwodGVtcGxhdGUsIHZhbHVlKTsNCiAgICB9DQoNCg0KICAgIHRyeSB7DQogICAgICAgIGxldCBkYXRhID0gbnVsbDsNCg0KDQogICAgICAgIGlmIChmb3JtYXQgPT09ICdqc29uJykgew0KICAgICAgICAgICAgZGF0YSA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVKU09OKGZpbGVQYXRoKTsNCiAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09ICd0ZXh0Jykgew0KICAgICAgICAgICAgZGF0YSA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVUZXh0KGZpbGVQYXRoKTsNCiAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09ICdibG9iJykgew0KICAgICAgICAgICAgLy8gRm9yIGJsb2IgZm9ybWF0LCByZWFkIGFzIHRleHQgKGRhdGEgVVJMcyBhcmUgc3RvcmVkIGFzIHRleHQpDQogICAgICAgICAgICBkYXRhID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZVRleHQoZmlsZVBhdGgpOw0KICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ2JpbmFyeScpIHsNCiAgICAgICAgICAgIC8vIEZvciBiaW5hcnkgZmlsZXMsIHVzZSB0aGUgbmV3IFN5cG5leEFQSSBtZXRob2QgdG8gZ2V0IEJsb2INCiAgICAgICAgICAgIGRhdGEgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlQmxvYihmaWxlUGF0aCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gZm9ybWF0OiAnICsgZm9ybWF0ICsgJy4gU3VwcG9ydGVkIGZvcm1hdHMgYXJlOiBqc29uLCB0ZXh0LCBibG9iLCBiaW5hcnknKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN0b3JlIHRoZSBsb2FkZWQgZGF0YSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgbm9kZS5sYXN0TG9hZGVkRmlsZSA9IGZpbGVQYXRoOw0KICAgICAgICBub2RlLmxhc3RMb2FkZWREYXRhID0gZGF0YTsNCg0KDQogICAgICAgIC8vIFJldHVybiBzdHJ1Y3R1cmVkIG91dHB1dCB3aXRoIGFwcHJvcHJpYXRlIHBvcnQgbmFtZXMNCiAgICAgICAgY29uc3QgcmVzdWx0ID0gew0KICAgICAgICAgICAgZGF0YTogZGF0YSwNCiAgICAgICAgICAgIGZpbGVfcGF0aDogZmlsZVBhdGgsICAvLyBSZXR1cm4gdGhlIGFjdHVhbCBwcm9jZXNzZWQgZmlsZSBwYXRoIHN0cmluZw0KICAgICAgICAgICAganNvbl9kYXRhOiBmb3JtYXQgPT09ICdqc29uJyA/IGRhdGEgOiBudWxsDQogICAgICAgIH07DQogICAgICAgIHJldHVybiByZXN1bHQ7DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVkZTIExvYWQgZXJyb3I6Jywgew0KICAgICAgICAgICAgb3JpZ2luYWxQYXRoOiBub2RlLmNvbmZpZy5maWxlX3BhdGgudmFsdWUsDQogICAgICAgICAgICBwcm9jZXNzZWRQYXRoOiBmaWxlUGF0aCwNCiAgICAgICAgICAgIGZvcm1hdDogZm9ybWF0LA0KICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsDQogICAgICAgICAgICBlcnJvclN0YWNrOiBlcnJvci5zdGFjaw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIHsgZGF0YTogbnVsbCwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTsNCiAgICB9DQp9DQoNCg0KLy8gVkZTIFNhdmUgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVZmc1NhdmVOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGZpbGVQYXRoID0gbm9kZS5jb25maWcuZmlsZV9wYXRoLnZhbHVlOw0KICAgIGNvbnN0IGZvcm1hdCA9IG5vZGUuY29uZmlnLmZvcm1hdC52YWx1ZTsNCiAgICBjb25zdCBvdmVyd3JpdGUgPSBub2RlLmNvbmZpZy5vdmVyd3JpdGUudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCBhcHBlbmQgPSBub2RlLmNvbmZpZy5hcHBlbmQudmFsdWUgPT09ICd0cnVlJzsNCg0KICAgIHRyeSB7DQogICAgICAgIGxldCBkYXRhID0gaW5wdXREYXRhLmRhdGE7DQogICAgICAgIGxldCBzdWNjZXNzID0gZmFsc2U7DQoNCg0KDQogICAgICAgIGlmIChmb3JtYXQgPT09ICdqc29uJykgew0KICAgICAgICAgICAgLy8gRm9yIEpTT04gZm9ybWF0IHdpdGggYXBwZW5kIG1vZGUsIHdlIG5lZWQgdG8gaGFuZGxlIGl0IHNwZWNpYWxseQ0KICAgICAgICAgICAgaWYgKGFwcGVuZCAmJiAhb3ZlcndyaXRlKSB7DQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IHRvIHJlYWQgZXhpc3RpbmcgZmlsZSBmaXJzdA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBleGlzdGluZ0RhdGEgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlSlNPTihmaWxlUGF0aCk7DQogICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGV4aXN0aW5nRGF0YSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIGV4aXN0aW5nIGRhdGEgaXMgYW4gYXJyYXksIGFwcGVuZCB0byBpdA0KICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdEYXRhLnB1c2goZGF0YSk7DQogICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gZXhpc3RpbmdEYXRhOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgZXhpc3RpbmcgZGF0YSBpcyBub3QgYW4gYXJyYXksIGNyZWF0ZSBhIG5ldyBhcnJheQ0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IFtleGlzdGluZ0RhdGEsIGRhdGFdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gRmlsZSBkb2Vzbid0IGV4aXN0IG9yIGNhbid0IGJlIHJlYWQsIGNyZWF0ZSBuZXcgYXJyYXkNCiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IFtkYXRhXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBzdWNjZXNzID0gYXdhaXQgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGVKU09OKGZpbGVQYXRoLCBkYXRhKTsNCiAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09ICd0ZXh0Jykgew0KICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgICAgIC8vIEZvciB0ZXh0IGZvcm1hdCB3aXRoIGFwcGVuZCBtb2RlDQogICAgICAgICAgICAgICAgaWYgKGFwcGVuZCAmJiAhb3ZlcndyaXRlKSB7DQogICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcmVhZCBleGlzdGluZyBmaWxlIGZpcnN0DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleGlzdGluZ1RleHQgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlVGV4dChmaWxlUGF0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gZXhpc3RpbmdUZXh0ICsgJ1xuJyArIGRhdGE7DQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBGaWxlIGRvZXNuJ3QgZXhpc3QsIHVzZSBkYXRhIGFzLWlzDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgc3VjY2VzcyA9IGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlKGZpbGVQYXRoLCBkYXRhKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUZXh0IGZvcm1hdCByZXF1aXJlcyBzdHJpbmcgZGF0YSwgcmVjZWl2ZWQ6ICcgKyB0eXBlb2YgZGF0YSArICcuIFVzZSBKU09OIGZvcm1hdCBmb3Igb2JqZWN0cy4nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09ICdiaW5hcnknKSB7DQogICAgICAgICAgICAvLyBIYW5kbGUgYmluYXJ5IGRhdGEgcHJvcGVybHkgdXNpbmcgdGhlIGJpbmFyeSB1cGxvYWQgZW5kcG9pbnQNCiAgICAgICAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgVWludDhBcnJheSkgew0KICAgICAgICAgICAgICAgIC8vIFVzZSB0aGUgYmluYXJ5IHVwbG9hZCBtZXRob2QgZm9yIHJhdyBiaW5hcnkgZGF0YQ0KICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZUJpbmFyeShmaWxlUGF0aCwgZGF0YSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8vIEJpbmFyeSBmb3JtYXQgb25seSBzdXBwb3J0cyBVaW50OEFycmF5IGZvciByYXcgYmluYXJ5IGRhdGENCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0JpbmFyeSBmb3JtYXQgcmVxdWlyZXMgVWludDhBcnJheSBkYXRhIGZvciByYXcgYmluYXJ5LCByZWNlaXZlZDogJyArIHR5cGVvZiBkYXRhICsgJy4gVXNlIGJsb2IgZm9ybWF0IGZvciBCbG9iIGRhdGEuJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAnYmxvYicpIHsNCiAgICAgICAgICAgIC8vIEhhbmRsZSBCbG9iIHRvIGRhdGEgVVJMIGNvbnZlcnNpb24NCiAgICAgICAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICAgICAgICAgIC8vIENvbnZlcnQgQmxvYiB0byBkYXRhIFVSTA0KICAgICAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7DQogICAgICAgICAgICAgICAgY29uc3QgZGF0YVVybCA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9ICgpID0+IHJlc29sdmUocmVhZGVyLnJlc3VsdCk7DQogICAgICAgICAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gcmVqZWN0Ow0KICAgICAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChkYXRhKTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBzdWNjZXNzID0gYXdhaXQgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGUoZmlsZVBhdGgsIGRhdGFVcmwpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Jsb2IgZm9ybWF0IHJlcXVpcmVzIEJsb2IgZGF0YSwgcmVjZWl2ZWQ6ICcgKyB0eXBlb2YgZGF0YSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBVbmtub3duIGZvcm1hdA0KICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIGZvcm1hdDogJyArIGZvcm1hdCArICcuIFN1cHBvcnRlZCBmb3JtYXRzIGFyZToganNvbiwgdGV4dCwgYmluYXJ5LCBibG9iJyk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBzdWNjZXNzIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVkZTIFNhdmUgZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTsNCiAgICB9DQp9DQoNCi8vIFZGUyBEaXJlY3RvcnkgTGlzdCBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlVmZzRGlyZWN0b3J5TGlzdE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgbGV0IGRpcmVjdG9yeVBhdGggPSBub2RlLmNvbmZpZy5kaXJlY3RvcnlfcGF0aC52YWx1ZTsNCiAgICBjb25zdCBmaWx0ZXJFeHRlbnNpb25zID0gbm9kZS5jb25maWcuZmlsdGVyX2V4dGVuc2lvbnMudmFsdWU7DQogICAgY29uc3QgaW5jbHVkZURpcmVjdG9yaWVzID0gbm9kZS5jb25maWcuaW5jbHVkZV9kaXJlY3Rvcmllcy52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IHJlY3Vyc2l2ZSA9IG5vZGUuY29uZmlnLnJlY3Vyc2l2ZS52YWx1ZSA9PT0gJ3RydWUnOw0KDQoNCg0KICAgIC8vIFVzZSBpbnB1dCBwYXRoIGlmIHByb3ZpZGVkLCBvdGhlcndpc2UgdXNlIGNvbmZpZw0KICAgIGlmIChpbnB1dERhdGEgJiYgaW5wdXREYXRhLmRpcmVjdG9yeV9wYXRoKSB7DQogICAgICAgIGRpcmVjdG9yeVBhdGggPSBpbnB1dERhdGEuZGlyZWN0b3J5X3BhdGg7DQoNCiAgICB9DQoNCiAgICAvLyBFbnN1cmUgZGlyZWN0b3J5UGF0aCBpcyBhIHN0cmluZyBhbmQgbm90IGVtcHR5DQogICAgaWYgKHR5cGVvZiBkaXJlY3RvcnlQYXRoICE9PSAnc3RyaW5nJyB8fCAhZGlyZWN0b3J5UGF0aCkgew0KICAgICAgICBkaXJlY3RvcnlQYXRoID0gJy8nOw0KDQogICAgfQ0KDQogICAgLy8gUHJvY2VzcyB0ZW1wbGF0ZSB2YXJpYWJsZXMgaW4gZGlyZWN0b3J5IHBhdGgNCiAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgY29uc3QgZGF0ZVRlbXBsYXRlcyA9IHsNCiAgICAgICAgJ3t7REFURX19JzogY3VycmVudERhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdLA0KICAgICAgICAne3tZWVlZfX0nOiBjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCksDQogICAgICAgICd7e01NfX0nOiAoY3VycmVudERhdGUuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSwNCiAgICAgICAgJ3t7RER9fSc6IGN1cnJlbnREYXRlLmdldERhdGUoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyksDQogICAgICAgICd7e1RJTUVTVEFNUH19JzogY3VycmVudERhdGUuZ2V0VGltZSgpLnRvU3RyaW5nKCksDQogICAgICAgICd7e0lTT19EQVRFfX0nOiBjdXJyZW50RGF0ZS50b0lTT1N0cmluZygpDQogICAgfTsNCg0KICAgIGZvciAoY29uc3QgW3RlbXBsYXRlLCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZGF0ZVRlbXBsYXRlcykpIHsNCiAgICAgICAgZGlyZWN0b3J5UGF0aCA9IGRpcmVjdG9yeVBhdGgucmVwbGFjZUFsbCh0ZW1wbGF0ZSwgdmFsdWUpOw0KICAgIH0NCg0KDQoNCiAgICB0cnkgew0KICAgICAgICAvLyBVc2UgdGhlIGV4aXN0aW5nIHN5cG5leEFQSS5saXN0VmlydHVhbEZpbGVzIG1ldGhvZA0KICAgICAgICBjb25zdCBmaWxlTGlzdERhdGEgPSBhd2FpdCBzeXBuZXhBUEkubGlzdFZpcnR1YWxGaWxlcyhkaXJlY3RvcnlQYXRoKTsNCiAgICAgICAgDQogICAgICAgIGlmICghZmlsZUxpc3REYXRhIHx8ICFmaWxlTGlzdERhdGEuaXRlbXMpIHsNCiAgICAgICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgICAgIGVycm9yOiBgRGlyZWN0b3J5IG5vdCBmb3VuZCBvciBlbXB0eTogJHtkaXJlY3RvcnlQYXRofWAsDQogICAgICAgICAgICAgICAgZmlsZV9saXN0OiBbXSwNCiAgICAgICAgICAgICAgICBmaWxlX3BhdGhzOiBbXSwNCiAgICAgICAgICAgICAgICBmaWxlX25hbWVzOiBbXSwNCiAgICAgICAgICAgICAgICBjb3VudDogMCwNCiAgICAgICAgICAgICAgICBkaXJlY3RvcmllczogW10sDQogICAgICAgICAgICAgICAgZmlsZXNfb25seTogW10NCiAgICAgICAgICAgIH07DQogICAgICAgIH0NCg0KICAgICAgICBsZXQgYWxsSXRlbXMgPSBmaWxlTGlzdERhdGEuaXRlbXM7DQogICAgICAgIA0KICAgICAgICAvLyBIYW5kbGUgcmVjdXJzaXZlIGxpc3RpbmcgaWYgZW5hYmxlZA0KICAgICAgICBpZiAocmVjdXJzaXZlKSB7DQogICAgICAgICAgICBjb25zdCBnZXRBbGxGaWxlc1JlY3Vyc2l2ZSA9IGFzeW5jIChpdGVtcywgYmFzZVBhdGgpID0+IHsNCiAgICAgICAgICAgICAgICBsZXQgYWxsRmlsZXMgPSBbXTsNCiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uaXNfZGlyZWN0b3J5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJQYXRoID0gYmFzZVBhdGggKyAoYmFzZVBhdGguZW5kc1dpdGgoJy8nKSA/ICcnIDogJy8nKSArIGl0ZW0ubmFtZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3ViRGlyRGF0YSA9IGF3YWl0IHN5cG5leEFQSS5saXN0VmlydHVhbEZpbGVzKHN1YlBhdGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJEaXJEYXRhICYmIHN1YkRpckRhdGEuaXRlbXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3ViRmlsZXMgPSBhd2FpdCBnZXRBbGxGaWxlc1JlY3Vyc2l2ZShzdWJEaXJEYXRhLml0ZW1zLCBzdWJQYXRoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsRmlsZXMgPSBhbGxGaWxlcy5jb25jYXQoc3ViRmlsZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgQ291bGQgbm90IHJlYWQgc3ViZGlyZWN0b3J5ICR7c3ViUGF0aH06YCwgZXJyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBhbGxGaWxlcy5wdXNoKHsuLi5pdGVtLCBmdWxsUGF0aDogYmFzZVBhdGggKyAoYmFzZVBhdGguZW5kc1dpdGgoJy8nKSA/ICcnIDogJy8nKSArIGl0ZW0ubmFtZX0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXR1cm4gYWxsRmlsZXM7DQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBhbGxJdGVtcyA9IGF3YWl0IGdldEFsbEZpbGVzUmVjdXJzaXZlKGFsbEl0ZW1zLCBkaXJlY3RvcnlQYXRoKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIEFkZCBmdWxsIHBhdGggZm9yIG5vbi1yZWN1cnNpdmUNCiAgICAgICAgICAgIGFsbEl0ZW1zID0gYWxsSXRlbXMubWFwKGl0ZW0gPT4gKHsNCiAgICAgICAgICAgICAgICAuLi5pdGVtLCANCiAgICAgICAgICAgICAgICBmdWxsUGF0aDogZGlyZWN0b3J5UGF0aCArIChkaXJlY3RvcnlQYXRoLmVuZHNXaXRoKCcvJykgPyAnJyA6ICcvJykgKyBpdGVtLm5hbWUNCiAgICAgICAgICAgIH0pKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEZpbHRlciBieSBmaWxlIGV4dGVuc2lvbnMgaWYgc3BlY2lmaWVkDQogICAgICAgIGxldCBmaWx0ZXJlZEl0ZW1zID0gYWxsSXRlbXM7DQogICAgICAgIGlmIChmaWx0ZXJFeHRlbnNpb25zICYmIGZpbHRlckV4dGVuc2lvbnMudHJpbSgpKSB7DQogICAgICAgICAgICBjb25zdCBleHRlbnNpb25zID0gZmlsdGVyRXh0ZW5zaW9ucy5zcGxpdCgnLCcpLm1hcChleHQgPT4gZXh0LnRyaW0oKS50b0xvd2VyQ2FzZSgpKTsNCiAgICAgICAgICAgIGZpbHRlcmVkSXRlbXMgPSBhbGxJdGVtcy5maWx0ZXIoaXRlbSA9PiB7DQogICAgICAgICAgICAgICAgLy8gQWx3YXlzIGluY2x1ZGUgZGlyZWN0b3JpZXMgaWYgaW5jbHVkZURpcmVjdG9yaWVzIGlzIHRydWUNCiAgICAgICAgICAgICAgICBpZiAoaXRlbS5pc19kaXJlY3RvcnkpIHJldHVybiBpbmNsdWRlRGlyZWN0b3JpZXM7DQogICAgICAgICAgICAgICAgLy8gRm9yIGZpbGVzLCBjaGVjayB0aGUgZXh0ZW5zaW9uDQogICAgICAgICAgICAgICAgY29uc3QgaXRlbUV4dCA9IGl0ZW0ubmFtZS5zcGxpdCgnLicpLnBvcCgpPy50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgICAgIHJldHVybiBleHRlbnNpb25zLmluY2x1ZGVzKGl0ZW1FeHQpOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIA0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU2VwYXJhdGUgZmlsZXMgYW5kIGRpcmVjdG9yaWVzDQogICAgICAgIGNvbnN0IGZpbGVzID0gZmlsdGVyZWRJdGVtcy5maWx0ZXIoaXRlbSA9PiAhaXRlbS5pc19kaXJlY3RvcnkpOw0KICAgICAgICBjb25zdCBkaXJlY3RvcmllcyA9IGZpbHRlcmVkSXRlbXMuZmlsdGVyKGl0ZW0gPT4gaXRlbS5pc19kaXJlY3RvcnkpOw0KICAgICAgICANCiAgICAgICAgLy8gQ3JlYXRlIG91dHB1dCBhcnJheXMNCiAgICAgICAgY29uc3QgZmlsZVBhdGhzID0gZmlsZXMubWFwKGZpbGUgPT4gZmlsZS5mdWxsUGF0aCk7DQogICAgICAgIGNvbnN0IGZpbGVOYW1lcyA9IGZpbGVzLm1hcChmaWxlID0+IGZpbGUubmFtZSk7DQogICAgICAgIGNvbnN0IGRpcmVjdG9yeVBhdGhzID0gZGlyZWN0b3JpZXMubWFwKGRpciA9PiBkaXIuZnVsbFBhdGgpOw0KDQogICAgICAgIC8vIEZpbmFsIGZpbGUgbGlzdCBiYXNlZCBvbiBpbmNsdWRlRGlyZWN0b3JpZXMgc2V0dGluZw0KICAgICAgICAvLyBJZiBpbmNsdWRlRGlyZWN0b3JpZXMgaXMgdHJ1ZSwgcmV0dXJuIGFsbCBmaWx0ZXJlZCBpdGVtcyAoZmlsZXMgKyBkaXJlY3RvcmllcykNCiAgICAgICAgLy8gSWYgaW5jbHVkZURpcmVjdG9yaWVzIGlzIGZhbHNlLCByZXR1cm4gb25seSBmaWxlcw0KICAgICAgICBjb25zdCBmaW5hbEZpbGVMaXN0ID0gaW5jbHVkZURpcmVjdG9yaWVzID8gZmlsdGVyZWRJdGVtcyA6IGZpbGVzOw0KDQoNCg0KICAgICAgICAvLyBTdG9yZSByZXN1bHRzIGZvciBjb25maWcgcGFuZWwgZGlzcGxheQ0KICAgICAgICBub2RlLmxhc3REaXJlY3RvcnlQYXRoID0gZGlyZWN0b3J5UGF0aDsNCiAgICAgICAgbm9kZS5sYXN0RmlsZUNvdW50ID0gZmluYWxGaWxlTGlzdC5sZW5ndGg7DQogICAgICAgIG5vZGUubGFzdEZpbGVMaXN0ID0gZmluYWxGaWxlTGlzdDsNCg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgZmlsZV9saXN0OiBmaW5hbEZpbGVMaXN0LA0KICAgICAgICAgICAgZmlsZV9wYXRoczogZmlsZVBhdGhzLA0KICAgICAgICAgICAgZmlsZV9uYW1lczogZmlsZU5hbWVzLA0KICAgICAgICAgICAgY291bnQ6IGZpbmFsRmlsZUxpc3QubGVuZ3RoLA0KICAgICAgICAgICAgZGlyZWN0b3JpZXM6IGRpcmVjdG9yeVBhdGhzLA0KICAgICAgICAgICAgZmlsZXNfb25seTogZmlsZXMNCiAgICAgICAgfTsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVkZTIERpcmVjdG9yeSBMaXN0IGVycm9yOicsIHsNCiAgICAgICAgICAgIGRpcmVjdG9yeVBhdGg6IGRpcmVjdG9yeVBhdGgsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSwNCiAgICAgICAgICAgIGVycm9yU3RhY2s6IGVycm9yLnN0YWNrDQogICAgICAgIH0pOw0KICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLA0KICAgICAgICAgICAgZmlsZV9saXN0OiBbXSwNCiAgICAgICAgICAgIGZpbGVfcGF0aHM6IFtdLA0KICAgICAgICAgICAgZmlsZV9uYW1lczogW10sDQogICAgICAgICAgICBjb3VudDogMCwNCiAgICAgICAgICAgIGRpcmVjdG9yaWVzOiBbXSwNCiAgICAgICAgICAgIGZpbGVzX29ubHk6IFtdDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQovLyBFeHBvcnQgdG8gZ2xvYmFsIHNjb3BlDQpzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuaHR0cEV4ZWN1dG9ycyA9IHsNCiAgICBleGVjdXRlSHR0cE5vZGUsDQogICAgZXhlY3V0ZVZmc0xvYWROb2RlLA0KICAgIGV4ZWN1dGVWZnNTYXZlTm9kZSwNCiAgICBleGVjdXRlVmZzRGlyZWN0b3J5TGlzdE5vZGUNCn07DQoNCi8vIEltYWdlIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVJbWFnZU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgbWF4UHJldmlld1NpemUgPSBub2RlLmNvbmZpZy5tYXhfcHJldmlld19zaXplLnZhbHVlOw0KICAgIGNvbnN0IHNob3dJbmZvID0gbm9kZS5jb25maWcuc2hvd19pbmZvLnZhbHVlID09PSAndHJ1ZSc7DQoNCiAgICBsZXQgaW1hZ2VEYXRhID0gaW5wdXREYXRhLmltYWdlX2RhdGE7DQogICAgbGV0IGltYWdlVXJsID0gbnVsbDsNCiAgICBsZXQgaW1hZ2VJbmZvID0gbnVsbDsNCg0KICAgIC8vIEhhbmRsZSBkaWZmZXJlbnQgdHlwZXMgb2YgaW1hZ2UgZGF0YQ0KICAgIGlmIChpbWFnZURhdGEgaW5zdGFuY2VvZiBCbG9iKSB7DQogICAgICAgIC8vIENyZWF0ZSBvYmplY3QgVVJMIGZvciBCbG9iIGRhdGENCiAgICAgICAgaW1hZ2VVcmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGltYWdlRGF0YSk7DQogICAgICAgIGltYWdlSW5mbyA9IHsNCiAgICAgICAgICAgIHR5cGU6IGltYWdlRGF0YS50eXBlIHx8ICdpbWFnZScsDQogICAgICAgICAgICBzaXplOiBpbWFnZURhdGEuc2l6ZQ0KICAgICAgICB9Ow0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGltYWdlRGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBiYXNlNjQgZGF0YQ0KICAgICAgICBpZiAoaW1hZ2VEYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6aW1hZ2UvJykgfHwgaW1hZ2VEYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6YXBwbGljYXRpb24vJykpIHsNCiAgICAgICAgICAgIC8vIEFscmVhZHkgYSBkYXRhIFVSTA0KICAgICAgICAgICAgaW1hZ2VVcmwgPSBpbWFnZURhdGE7DQogICAgICAgIH0gZWxzZSBpZiAoaW1hZ2VEYXRhLm1hdGNoKC9eW0EtWmEtejAtOSsvXSo9ezAsMn0kLykpIHsNCiAgICAgICAgICAgIC8vIExvb2tzIGxpa2UgYmFzZTY0IGRhdGEsIGNvbnZlcnQgdG8gZGF0YSBVUkwNCiAgICAgICAgICAgIC8vIFRyeSB0byBkZXRlY3QgaW1hZ2UgdHlwZSBmcm9tIHRoZSBkYXRhDQogICAgICAgICAgICBjb25zdCBpbWFnZVR5cGUgPSBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzLmRldGVjdEltYWdlVHlwZUZyb21CYXNlNjQoaW1hZ2VEYXRhKTsNCiAgICAgICAgICAgIGltYWdlVXJsID0gYGRhdGE6JHtpbWFnZVR5cGV9O2Jhc2U2NCwke2ltYWdlRGF0YX1gOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSByZWd1bGFyIFVSTA0KICAgICAgICAgICAgaW1hZ2VVcmwgPSBpbWFnZURhdGE7DQogICAgICAgIH0NCiAgICB9IGVsc2UgaWYgKGltYWdlRGF0YSAmJiB0eXBlb2YgaW1hZ2VEYXRhID09PSAnb2JqZWN0Jykgew0KICAgICAgICAvLyBIYW5kbGUgb2JqZWN0IHdpdGggaW1hZ2UgZGF0YQ0KICAgICAgICBpZiAoaW1hZ2VEYXRhLnVybCkgew0KICAgICAgICAgICAgaW1hZ2VVcmwgPSBpbWFnZURhdGEudXJsOw0KICAgICAgICB9IGVsc2UgaWYgKGltYWdlRGF0YS5kYXRhKSB7DQogICAgICAgICAgICBpbWFnZVVybCA9IGltYWdlRGF0YS5kYXRhOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGltYWdlRGF0YS5pbmZvKSB7DQogICAgICAgICAgICBpbWFnZUluZm8gPSBpbWFnZURhdGEuaW5mbzsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIE5vdGU6IFJlbW92ZWQgaW1hZ2UgZGltZW5zaW9uIGRldGVjdGlvbiBhcyBpdCdzIG5vdCBuZWVkZWQNCg0KICAgIC8vIFN0b3JlIGltYWdlIGRhdGEgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgbm9kZS5sYXN0SW1hZ2VEYXRhID0gaW1hZ2VEYXRhOw0KICAgIG5vZGUubGFzdEltYWdlVXJsID0gaW1hZ2VVcmw7DQogICAgbm9kZS5sYXN0SW1hZ2VJbmZvID0gaW1hZ2VJbmZvOw0KDQogICAgcmV0dXJuIHsNCiAgICAgICAgaW1hZ2VfZGF0YTogaW1hZ2VEYXRhLA0KICAgICAgICBpbWFnZV91cmw6IGltYWdlVXJsLA0KICAgICAgICBpbWFnZV9pbmZvOiBpbWFnZUluZm8sDQogICAgICAgIGRhdGE6IGltYWdlRGF0YQ0KICAgIH07DQp9DQoNCi8vIEF1ZGlvIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVBdWRpb05vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgYXV0b1BsYXkgPSBub2RlLmNvbmZpZy5hdXRvUGxheS52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IHZvbHVtZSA9IHBhcnNlRmxvYXQobm9kZS5jb25maWcudm9sdW1lLnZhbHVlKTsNCg0KICAgIGxldCBhdWRpb0RhdGEgPSBpbnB1dERhdGEuYXVkaW9fZGF0YTsNCg0KDQogICAgaWYgKCFhdWRpb0RhdGEpIHsNCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBhdWRpbyBkYXRhIHByb3ZpZGVkJyk7DQogICAgfQ0KDQogICAgLy8gU3RvcmUgYXVkaW8gZGF0YSBmb3IgbWFudWFsIHBsYXkgYnV0dG9uIHN5c3RlbSAobGlrZSBvbGQgc3lzdGVtKQ0KICAgIG5vZGUuYXVkaW9EYXRhID0gYXVkaW9EYXRhOw0KICAgIG5vZGUudm9sdW1lID0gdm9sdW1lOw0KDQogICAgLy8gQ3JlYXRlIGF1ZGlvIGVsZW1lbnQgaWYgaXQgZG9lc24ndCBleGlzdCAobGlrZSBvbGQgc3lzdGVtKQ0KICAgIGlmICghbm9kZS5hdWRpb0VsZW1lbnQpIHsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQgPSBuZXcgQXVkaW8oKTsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuY29udHJvbHMgPSB0cnVlOw0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zdHlsZS53aWR0aCA9ICcxMDAlJzsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnOw0KICAgIH0NCg0KICAgIC8vIFNldCBhdWRpbyBzb3VyY2UgKGxpa2Ugb2xkIHN5c3RlbSkNCiAgICBpZiAoYXVkaW9EYXRhIGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGF1ZGlvRGF0YSk7DQogICAgfSBlbHNlIGlmICh0eXBlb2YgYXVkaW9EYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICBpZiAoYXVkaW9EYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6YXVkaW8vJykgfHwgYXVkaW9EYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6YXBwbGljYXRpb24vJykpIHsNCiAgICAgICAgICAgIC8vIEFscmVhZHkgYSBkYXRhIFVSTA0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gYXVkaW9EYXRhOw0KICAgICAgICB9IGVsc2UgaWYgKGF1ZGlvRGF0YS5tYXRjaCgvXltBLVphLXowLTkrL10qPXswLDJ9JC8pKSB7DQogICAgICAgICAgICAvLyBMb29rcyBsaWtlIGJhc2U2NCBkYXRhLCBjb252ZXJ0IHRvIGRhdGEgVVJMDQogICAgICAgICAgICBjb25zdCBhdWRpb1R5cGUgPSAnYXVkaW8vbXBlZyc7IC8vIERlZmF1bHQgdG8gTVAzLCBjb3VsZCBiZSBlbmhhbmNlZCB0byBkZXRlY3QgdHlwZQ0KICAgICAgICAgICAgY29uc3QgZGF0YVVybCA9IGBkYXRhOiR7YXVkaW9UeXBlfTtiYXNlNjQsJHthdWRpb0RhdGF9YDsNCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnNyYyA9IGRhdGFVcmw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBBc3N1bWUgaXQncyBhIHJlZ3VsYXIgVVJMDQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zcmMgPSBhdWRpb0RhdGE7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zcmMgPSBhdWRpb0RhdGE7DQogICAgfQ0KDQogICAgLy8gU2V0IHZvbHVtZQ0KICAgIG5vZGUuYXVkaW9FbGVtZW50LnZvbHVtZSA9IHZvbHVtZTsNCg0KICAgIC8vIFN0b3JlIGZvciBjb25maWcgcGFuZWwgY29tcGF0aWJpbGl0eQ0KICAgIG5vZGUubGFzdEF1ZGlvRGF0YSA9IGF1ZGlvRGF0YTsNCiAgICBub2RlLmxhc3RBdWRpb1VybCA9IG5vZGUuYXVkaW9FbGVtZW50LnNyYzsNCg0KICAgIC8vIEF1dG8tcGxheSBpZiBjb25maWd1cmVkDQogICAgaWYgKGF1dG9QbGF5KSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBhd2FpdCBub2RlLmF1ZGlvRWxlbWVudC5wbGF5KCk7DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdBdXRvLXBsYXkgZmFpbGVkOicsIGVycm9yKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIENvbnZlcnQgYXVkaW8gZGF0YSB0byBwcm9wZXIgZGF0YSBVUkwgZm9yIFZGUyBTYXZlDQogICAgbGV0IGRhdGFVcmxGb3JTYXZlID0gbnVsbDsNCg0KICAgIGlmIChhdWRpb0RhdGEgaW5zdGFuY2VvZiBCbG9iKSB7DQogICAgICAgIC8vIENvbnZlcnQgQmxvYiB0byBkYXRhIFVSTA0KICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOw0KICAgICAgICBkYXRhVXJsRm9yU2F2ZSA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsNCiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoKSA9PiByZXNvbHZlKHJlYWRlci5yZXN1bHQpOw0KICAgICAgICAgICAgcmVhZGVyLm9uZXJyb3IgPSByZWplY3Q7DQogICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChhdWRpb0RhdGEpOw0KICAgICAgICB9KTsNCiAgICB9IGVsc2UgaWYgKHR5cGVvZiBhdWRpb0RhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgIGlmIChhdWRpb0RhdGEuc3RhcnRzV2l0aCgnZGF0YTphdWRpby8nKSB8fCBhdWRpb0RhdGEuc3RhcnRzV2l0aCgnZGF0YTphcHBsaWNhdGlvbi8nKSkgew0KICAgICAgICAgICAgLy8gQWxyZWFkeSBhIGRhdGEgVVJMDQogICAgICAgICAgICBkYXRhVXJsRm9yU2F2ZSA9IGF1ZGlvRGF0YTsNCiAgICAgICAgfSBlbHNlIGlmIChhdWRpb0RhdGEubWF0Y2goL15bQS1aYS16MC05Ky9dKj17MCwyfSQvKSkgew0KICAgICAgICAgICAgLy8gQmFzZTY0IGRhdGEsIGNvbnZlcnQgdG8gZGF0YSBVUkwNCiAgICAgICAgICAgIGNvbnN0IGF1ZGlvVHlwZSA9ICdhdWRpby9tcGVnJzsgLy8gRGVmYXVsdCB0byBNUDMsIGNvdWxkIGJlIGVuaGFuY2VkIHRvIGRldGVjdCB0eXBlDQogICAgICAgICAgICBkYXRhVXJsRm9yU2F2ZSA9IGBkYXRhOiR7YXVkaW9UeXBlfTtiYXNlNjQsJHthdWRpb0RhdGF9YDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIFJlZ3VsYXIgVVJMLCBrZWVwIGFzIGlzDQogICAgICAgICAgICBkYXRhVXJsRm9yU2F2ZSA9IGF1ZGlvRGF0YTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIEZhbGxiYWNrDQogICAgICAgIGRhdGFVcmxGb3JTYXZlID0gYXVkaW9EYXRhOw0KICAgIH0NCg0KICAgIHJldHVybiB7DQogICAgICAgIGF1ZGlvX2RhdGE6IGF1ZGlvRGF0YSwNCiAgICAgICAgYXVkaW9fdXJsOiBub2RlLmF1ZGlvRWxlbWVudC5zcmMsDQogICAgICAgIGRhdGE6IGRhdGFVcmxGb3JTYXZlICAvLyBSZXR1cm4gdGhlIGFjdHVhbCBhdWRpbyBkYXRhIGFzIGRhdGEgVVJMDQogICAgfTsNCn0NCg0KLy8gRXhwb3J0IHRvIGdsb2JhbCBzY29wZQ0Kc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLm1lZGlhRXhlY3V0b3JzID0gew0KICAgIGV4ZWN1dGVJbWFnZU5vZGUsDQogICAgZXhlY3V0ZUF1ZGlvTm9kZQ0KfTsNCg0KDQovLyBUaW1lciBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlVGltZXJOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGludGVydmFsID0gbm9kZS5jb25maWcuaW50ZXJ2YWwudmFsdWU7DQogICAgY29uc3QgY291bnQgPSBub2RlLmNvbmZpZy5jb3VudC52YWx1ZTsNCg0KICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gew0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IERhdGUubm93KCk7DQogICAgICAgICAgICByZXNvbHZlKHsNCiAgICAgICAgICAgICAgICB0cmlnZ2VyOiB0aW1lc3RhbXAsDQogICAgICAgICAgICAgICAgb3JpZ2luYWxfZGF0YTogdGltZXN0YW1wLA0KICAgICAgICAgICAgICAgIHByb2Nlc3NlZF9kYXRhOiB0aW1lc3RhbXAsDQogICAgICAgICAgICAgICAgdGltZXN0YW1wOiB0aW1lc3RhbXAsDQogICAgICAgICAgICAgICAgZWxhcHNlZDogaW50ZXJ2YWwNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9LCBpbnRlcnZhbCk7DQogICAgfSk7DQp9DQoNCi8vIERpc3BsYXkgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZURpc3BsYXlOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGZvcm1hdCA9IG5vZGUuY29uZmlnLmZvcm1hdC52YWx1ZTsNCiAgICBjb25zdCBtYXhMZW5ndGggPSBub2RlLmNvbmZpZy5tYXhMZW5ndGgudmFsdWU7DQogICAgY29uc3QgaW5wdXRQb3J0ID0gbm9kZS5jb25maWcuaW5wdXRfcG9ydD8udmFsdWUgfHwgJ2F1dG8nOw0KDQogICAgLy8gVHJ5IHRvIGZpbmQgY29udGVudCBiYXNlZCBvbiBjb25maWd1cmVkIGlucHV0IHBvcnQgb3IgYXV0by1kZXRlY3QNCiAgICBsZXQgY29udGVudCA9IG51bGw7DQoNCiAgICBpZiAoaW5wdXRQb3J0ICE9PSAnYXV0bycpIHsNCiAgICAgICAgLy8gVXNlIHRoZSBzcGVjaWZpZWQgaW5wdXQgcG9ydA0KICAgICAgICBjb250ZW50ID0gaW5wdXREYXRhW2lucHV0UG9ydF07DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gQXV0by1kZXRlY3Q6IFByaW9yaXR5IG9yZGVyOiB0ZXh0LCBqc29uLCBkYXRhLCBiaW5hcnkNCiAgICAgICAgaWYgKGlucHV0RGF0YS50ZXh0ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBpbnB1dERhdGEudGV4dDsNCiAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGEuanNvbiAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBjb250ZW50ID0gaW5wdXREYXRhLmpzb247DQogICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLmRhdGEgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgY29udGVudCA9IGlucHV0RGF0YS5kYXRhOw0KICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS5iaW5hcnkgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgY29udGVudCA9IGlucHV0RGF0YS5iaW5hcnk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBVc2UgdGhlIGZpcnN0IGF2YWlsYWJsZSBpbnB1dA0KICAgICAgICAgICAgY29uc3QgZmlyc3RJbnB1dCA9IE9iamVjdC52YWx1ZXMoaW5wdXREYXRhKVswXTsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBmaXJzdElucHV0Ow0KICAgICAgICB9DQogICAgfQ0KDQoNCiAgICAvLyBPbmx5IGNvbnZlcnQgdG8gSlNPTiBzdHJpbmcgaWYgZm9ybWF0IGlzICdqc29uJyBvciBpZiBpdCdzIGFuIG9iamVjdCBhbmQgZm9ybWF0IGlzIG5vdCBzcGVjaWZpZWQNCiAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdvYmplY3QnICYmIGZvcm1hdCA9PT0gJ2pzb24nKSB7DQogICAgICAgIGNvbnRlbnQgPSBKU09OLnN0cmluZ2lmeShjb250ZW50LCBudWxsLCAyKTsNCiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnb2JqZWN0JyAmJiBmb3JtYXQgPT09ICd0ZXh0Jykgew0KICAgICAgICAvLyBGb3IgdGV4dCBmb3JtYXQsIGV4dHJhY3QgdGhlIGFjdHVhbCB2YWx1ZSBmcm9tIGNvbW1vbiBmaWVsZHMNCiAgICAgICAgaWYgKGNvbnRlbnQgPT09IG51bGwpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSAnbnVsbCc7DQogICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShjb250ZW50KSkgew0KICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQuam9pbignLCAnKTsNCiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgICAgIC8vIExvb2sgZm9yIHRoZSBhY3R1YWwgdmFsdWUgaW4gY29tbW9uIGZpZWxkcw0KICAgICAgICAgICAgaWYgKGNvbnRlbnQuZXh0cmFjdGVkX3ZhbHVlICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICBjb250ZW50ID0gU3RyaW5nKGNvbnRlbnQuZXh0cmFjdGVkX3ZhbHVlKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGVudC52YWx1ZSAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgY29udGVudCA9IFN0cmluZyhjb250ZW50LnZhbHVlKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGVudC50ZXh0ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICBjb250ZW50ID0gU3RyaW5nKGNvbnRlbnQudGV4dCk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRlbnQuZGF0YSAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgY29udGVudCA9IFN0cmluZyhjb250ZW50LmRhdGEpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvLyBJZiBubyBjb21tb24gZmllbGRzIGZvdW5kLCBqdXN0IHNob3cgdGhlIGZpcnN0IHZhbHVlDQogICAgICAgICAgICAgICAgY29uc3QgZmlyc3RWYWx1ZSA9IE9iamVjdC52YWx1ZXMoY29udGVudClbMF07DQogICAgICAgICAgICAgICAgY29udGVudCA9IFN0cmluZyhmaXJzdFZhbHVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmIChjb250ZW50ICYmIGNvbnRlbnQubGVuZ3RoID4gbWF4TGVuZ3RoKSB7DQogICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnN1YnN0cmluZygwLCBtYXhMZW5ndGgpICsgJy4uLic7DQogICAgfQ0KDQogICAgLy8gVXBkYXRlIGRpc3BsYXkgbm9kZSBjb250ZW50DQogICAgdXBkYXRlRGlzcGxheU5vZGVDb250ZW50KG5vZGUuaWQsIGNvbnRlbnQsIGZvcm1hdCk7DQoNCiAgICByZXR1cm4gew0KICAgICAgICBvcmlnaW5hbF9kYXRhOiBjb250ZW50LA0KICAgICAgICBkaXNwbGF5ZWQ6IGNvbnRlbnQsDQogICAgICAgIHByb2Nlc3NlZF9kYXRhOiBjb250ZW50DQogICAgfTsNCn0NCg0KDQovLyBSZXBlYXRlciBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlUmVwZWF0ZXJOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGludGVydmFsID0gcGFyc2VJbnQobm9kZS5jb25maWcuaW50ZXJ2YWwudmFsdWUpOw0KICAgIGNvbnN0IGNvdW50ID0gcGFyc2VJbnQobm9kZS5jb25maWcuY291bnQudmFsdWUpOw0KDQogICAgLy8gSW5pdGlhbGl6ZSByZXBlYXRlciBzdGF0ZSBpZiBub3QgZXhpc3RzDQogICAgaWYgKCFub2RlLnJlcGVhdGVyU3RhdGUpIHsNCiAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlID0gew0KICAgICAgICAgICAgY291bnQ6IDAsDQogICAgICAgICAgICBpbnRlcnZhbDogbnVsbCwNCiAgICAgICAgICAgIGlzUnVubmluZzogZmFsc2UNCiAgICAgICAgfTsNCiAgICB9DQoNCiAgICAvLyBJZiB0aGlzIGlzIGEgbWFudWFsIHRyaWdnZXIgKG5vdCBmcm9tIGludGVydmFsKSwgc3RhcnQgdGhlIHJlcGVhdGVyDQogICAgaWYgKCFub2RlLnJlcGVhdGVyU3RhdGUuaXNSdW5uaW5nKSB7DQogICAgICAgIG5vZGUucmVwZWF0ZXJTdGF0ZS5pc1J1bm5pbmcgPSB0cnVlOw0KICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUuY291bnQgPSAwOw0KDQogICAgICAgIC8vIFN0YXJ0IHRoZSBpbnRlcnZhbA0KICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7DQogICAgICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUuY291bnQrKzsNCg0KICAgICAgICAgICAgLy8gRXhlY3V0ZSB0aGUgY29ubmVjdGVkIHdvcmtmbG93DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3RlZE5vZGVzID0gZmluZENvbm5lY3RlZE5vZGVzKG5vZGUuaWQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGV4ZWN1dGVkID0gbmV3IFNldCgpOw0KDQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0ZWROb2RlIG9mIGNvbm5lY3RlZE5vZGVzKSB7DQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGV4ZWN1dGVOb2RlKGNvbm5lY3RlZE5vZGUubm9kZSwgeyB0cmlnZ2VyOiBEYXRlLm5vdygpIH0sIGV4ZWN1dGVkKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGV4ZWN1dGluZyByZXBlYXRlciB3b3JrZmxvdzonLCBlcnJvcik7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFN0b3AgaWYgY291bnQgbGltaXQgcmVhY2hlZA0KICAgICAgICAgICAgaWYgKGNvdW50ID4gMCAmJiBub2RlLnJlcGVhdGVyU3RhdGUuY291bnQgPj0gY291bnQpIHsNCiAgICAgICAgICAgICAgICBlbmdpbmUuc3RvcFJlcGVhdGVyKG5vZGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LCBpbnRlcnZhbCk7DQogICAgfQ0KDQogICAgcmV0dXJuIHsgdHJpZ2dlcjogRGF0ZS5ub3coKSwgY291bnQ6IG5vZGUucmVwZWF0ZXJTdGF0ZS5jb3VudCwgaXNSdW5uaW5nOiBub2RlLnJlcGVhdGVyU3RhdGUuaXNSdW5uaW5nIH07DQp9DQoNCi8vIENvbmRpdGlvbiBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlQ29uZGl0aW9uTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBvcGVyYXRvciA9IG5vZGUuY29uZmlnLm9wZXJhdG9yLnZhbHVlOw0KICAgIGNvbnN0IGNvbXBhcmVWYWx1ZSA9IG5vZGUuY29uZmlnLmNvbXBhcmVfdmFsdWUudmFsdWU7DQogICAgY29uc3QgY2FzZVNlbnNpdGl2ZSA9IG5vZGUuY29uZmlnLmNhc2Vfc2Vuc2l0aXZlLnZhbHVlID09PSAndHJ1ZSc7DQoNCiAgICBsZXQgaW5wdXRWYWx1ZSA9IGlucHV0RGF0YS52YWx1ZTsNCiAgICBsZXQgcmVzdWx0ID0gZmFsc2U7DQoNCiAgICAvLyBDb252ZXJ0IGlucHV0IHRvIHN0cmluZyBmb3IgY29tcGFyaXNvbiBpZiBuZWVkZWQNCiAgICBsZXQgaW5wdXRTdHIgPSBTdHJpbmcoaW5wdXRWYWx1ZSk7DQogICAgbGV0IGNvbXBhcmVTdHIgPSBTdHJpbmcoY29tcGFyZVZhbHVlKTsNCg0KICAgIC8vIERlYnVnIGxvZ2dpbmcgZm9yIHN0cmluZyBjb21wYXJpc29ucw0KDQogICAgLy8gSGFuZGxlIGNhc2Ugc2Vuc2l0aXZpdHkNCiAgICBpZiAoIWNhc2VTZW5zaXRpdmUpIHsNCiAgICAgICAgaW5wdXRTdHIgPSBpbnB1dFN0ci50b0xvd2VyQ2FzZSgpOw0KICAgICAgICBjb21wYXJlU3RyID0gY29tcGFyZVN0ci50b0xvd2VyQ2FzZSgpOw0KICAgIH0NCg0KICAgIC8vIFBlcmZvcm0gY29tcGFyaXNvbiBiYXNlZCBvbiBvcGVyYXRvcg0KICAgIHN3aXRjaCAob3BlcmF0b3IpIHsNCiAgICAgICAgY2FzZSAnZXF1YWxzJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IGlucHV0U3RyID09PSBjb21wYXJlU3RyOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ25vdF9lcXVhbHMnOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIgIT09IGNvbXBhcmVTdHI7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnZ3JlYXRlcl90aGFuJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IE51bWJlcihpbnB1dFZhbHVlKSA+IE51bWJlcihjb21wYXJlVmFsdWUpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2xlc3NfdGhhbic6DQogICAgICAgICAgICByZXN1bHQgPSBOdW1iZXIoaW5wdXRWYWx1ZSkgPCBOdW1iZXIoY29tcGFyZVZhbHVlKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdncmVhdGVyX3RoYW5fb3JfZXF1YWwnOg0KICAgICAgICAgICAgcmVzdWx0ID0gTnVtYmVyKGlucHV0VmFsdWUpID49IE51bWJlcihjb21wYXJlVmFsdWUpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2xlc3NfdGhhbl9vcl9lcXVhbCc6DQogICAgICAgICAgICByZXN1bHQgPSBOdW1iZXIoaW5wdXRWYWx1ZSkgPD0gTnVtYmVyKGNvbXBhcmVWYWx1ZSk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnY29udGFpbnMnOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIuaW5jbHVkZXMoY29tcGFyZVN0cik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnbm90X2NvbnRhaW5zJzoNCiAgICAgICAgICAgIHJlc3VsdCA9ICFpbnB1dFN0ci5pbmNsdWRlcyhjb21wYXJlU3RyKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdzdGFydHNfd2l0aCc6DQogICAgICAgICAgICByZXN1bHQgPSBpbnB1dFN0ci5zdGFydHNXaXRoKGNvbXBhcmVTdHIpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2VuZHNfd2l0aCc6DQogICAgICAgICAgICByZXN1bHQgPSBpbnB1dFN0ci5lbmRzV2l0aChjb21wYXJlU3RyKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdpc19lbXB0eSc6DQogICAgICAgICAgICByZXN1bHQgPSBpbnB1dFN0ci50cmltKCkgPT09ICcnOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2lzX25vdF9lbXB0eSc6DQogICAgICAgICAgICByZXN1bHQgPSBpbnB1dFN0ci50cmltKCkgIT09ICcnOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICByZXN1bHQgPSBmYWxzZTsNCiAgICB9DQoNCiAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICBub2RlLmxhc3RJbnB1dFZhbHVlID0gaW5wdXRWYWx1ZTsNCiAgICBub2RlLmxhc3RDb21wYXJlVmFsdWUgPSBjb21wYXJlVmFsdWU7DQogICAgbm9kZS5sYXN0UmVzdWx0ID0gcmVzdWx0Ow0KICAgIG5vZGUubGFzdE9wZXJhdG9yID0gb3BlcmF0b3I7DQoNCiAgICByZXR1cm4geyByZXN1bHQ6IHJlc3VsdCB9Ow0KfQ0KDQovLyBMb2dpY2FsIEdhdGUgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUxvZ2ljYWxHYXRlTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBpbnZlcnQgPSBub2RlLmNvbmZpZy5pbnZlcnQudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IG5vZGUuY29uZmlnLmRlc2NyaXB0aW9uLnZhbHVlOw0KDQogICAgbGV0IGNvbmRpdGlvbiA9IGlucHV0RGF0YS5jb25kaXRpb247DQoNCiAgICAvLyBDb252ZXJ0IHRvIGJvb2xlYW4gaWYgbmVlZGVkDQogICAgaWYgKHR5cGVvZiBjb25kaXRpb24gPT09ICdzdHJpbmcnKSB7DQogICAgICAgIGNvbmRpdGlvbiA9IGNvbmRpdGlvbi50b0xvd2VyQ2FzZSgpID09PSAndHJ1ZSc7DQogICAgfSBlbHNlIGlmICh0eXBlb2YgY29uZGl0aW9uID09PSAnbnVtYmVyJykgew0KICAgICAgICBjb25kaXRpb24gPSBjb25kaXRpb24gIT09IDA7DQogICAgfSBlbHNlIGlmICh0eXBlb2YgY29uZGl0aW9uID09PSAnb2JqZWN0Jykgew0KICAgICAgICAvLyBJZiBpdCdzIGFuIG9iamVjdCB3aXRoIGEgcmVzdWx0IGZpZWxkIChmcm9tIGNvbmRpdGlvbiBub2RlKQ0KICAgICAgICBjb25kaXRpb24gPSBjb25kaXRpb24ucmVzdWx0ID09PSB0cnVlOw0KICAgIH0NCg0KICAgIC8vIEFwcGx5IGludmVyc2lvbiBpZiBjb25maWd1cmVkDQogICAgaWYgKGludmVydCkgew0KICAgICAgICBjb25kaXRpb24gPSAhY29uZGl0aW9uOw0KICAgIH0NCg0KICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgIG5vZGUubGFzdENvbmRpdGlvbiA9IGNvbmRpdGlvbjsNCiAgICBub2RlLmxhc3RJbnZlcnRlZCA9IGludmVydDsNCiAgICBub2RlLmxhc3REZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uOw0KDQogICAgLy8gT25seSByZXR1cm4gdHJpZ2dlciBpZiBjb25kaXRpb24gaXMgdHJ1ZQ0KICAgIGlmIChjb25kaXRpb24pIHsNCiAgICAgICAgcmV0dXJuIHsgdHJpZ2dlcjogRGF0ZS5ub3coKSB9Ow0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIFJldHVybiBzcGVjaWFsIG9iamVjdCB0byBpbmRpY2F0ZSBleGVjdXRpb24gc2hvdWxkIHN0b3ANCiAgICAgICAgcmV0dXJuIHsgX19zdG9wX2V4ZWN1dGlvbjogdHJ1ZSB9Ow0KICAgIH0NCn0NCg0KLy8gRm9yIEVhY2ggTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUZvckVhY2hOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IHN0b3BPbkVycm9yID0gbm9kZS5jb25maWcuc3RvcF9vbl9lcnJvci52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIA0KICAgIC8vIEdldCB0aGUgaXRlcmF0aW9uIGRlbGF5IGZyb20gY29uZmlnIChpbiBtaWxsaXNlY29uZHMpDQogICAgY29uc3QgaXRlcmF0aW9uRGVsYXkgPSBub2RlLmNvbmZpZy5pdGVyYXRpb25fZGVsYXk/LnZhbHVlIHx8IDA7DQogICAgDQogICAgLy8gR2V0IHRoZSBhcnJheSBmcm9tIGlucHV0DQogICAgbGV0IGFycmF5ID0gaW5wdXREYXRhLmFycmF5Ow0KICAgIA0KICAgIC8vIElmIGFycmF5IGlzIG5vdCBwcm92aWRlZCwgdHJ5IG90aGVyIGNvbW1vbiBpbnB1dCBuYW1lcw0KICAgIGlmICghQXJyYXkuaXNBcnJheShhcnJheSkpIHsNCiAgICAgICAgYXJyYXkgPSBpbnB1dERhdGEuZGF0YSB8fCBpbnB1dERhdGEuZmlsZV9uYW1lcyB8fCBpbnB1dERhdGEuaXRlbXM7DQogICAgfQ0KICAgIA0KICAgIC8vIEVuc3VyZSB3ZSBoYXZlIGEgdmFsaWQgYXJyYXkNCiAgICBpZiAoIUFycmF5LmlzQXJyYXkoYXJyYXkpKSB7DQogICAgICAgIHRocm93IG5ldyBFcnJvcignRm9yIEVhY2ggbm9kZSByZXF1aXJlcyBhbiBhcnJheSBpbnB1dCcpOw0KICAgIH0NCg0KDQogICAgLy8gSW5pdGlhbGl6ZSBpdGVyYXRpb24gc3RhdGUgaWYgbm90IGV4aXN0cw0KICAgIGlmICghbm9kZS5mb3JFYWNoU3RhdGUpIHsNCiAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUgPSB7DQogICAgICAgICAgICBjdXJyZW50SW5kZXg6IDAsDQogICAgICAgICAgICBhcnJheTogYXJyYXksDQogICAgICAgICAgICBpc0l0ZXJhdGluZzogZmFsc2UsDQogICAgICAgICAgICBpc0V4ZWN1dGluZ0l0ZXJhdGlvbjogZmFsc2UsDQogICAgICAgICAgICBpbnRlcnZhbDogbnVsbA0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgIC8vIElmIHRoaXMgaXMgYSBtYW51YWwgdHJpZ2dlciAobm90IGZyb20gaW50ZXJ2YWwpLCBzdGFydCB0aGUgaXRlcmF0b3INCiAgICBpZiAoIW5vZGUuZm9yRWFjaFN0YXRlLmlzSXRlcmF0aW5nKSB7DQogICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmlzSXRlcmF0aW5nID0gdHJ1ZTsNCiAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuY3VycmVudEluZGV4ID0gMDsNCiAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuYXJyYXkgPSBhcnJheTsNCg0KICAgICAgICAvLyBTdGFydCB0aGUgaXRlcmF0aW9uIHByb2Nlc3Npbmcgd2l0aCBwcm9wZXIgdGltaW5nDQogICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmludGVydmFsID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4gew0KICAgICAgICAgICAgLy8gU2tpcCBpZiBwcmV2aW91cyBpdGVyYXRpb24gaXMgc3RpbGwgcnVubmluZw0KICAgICAgICAgICAgaWYgKG5vZGUuZm9yRWFjaFN0YXRlLmlzRXhlY3V0aW5nSXRlcmF0aW9uKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAobm9kZS5mb3JFYWNoU3RhdGUuY3VycmVudEluZGV4IDwgbm9kZS5mb3JFYWNoU3RhdGUuYXJyYXkubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgbm9kZS5mb3JFYWNoU3RhdGUuaXNFeGVjdXRpbmdJdGVyYXRpb24gPSB0cnVlOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRJdGVtID0gbm9kZS5mb3JFYWNoU3RhdGUuYXJyYXlbbm9kZS5mb3JFYWNoU3RhdGUuY3VycmVudEluZGV4XTsNCiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50SW5kZXggPSBub2RlLmZvckVhY2hTdGF0ZS5jdXJyZW50SW5kZXg7DQogICAgICAgICAgICAgICAgDQoNCiAgICAgICAgICAgICAgICAvLyBDbGVhciBidWZmZXIgZm9yIG11bHRpLWlucHV0IG5vZGVzIGF0IHN0YXJ0IG9mIGVhY2ggaXRlcmF0aW9uDQogICAgICAgICAgICAgICAgaWYgKHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5nbG9iYWxOb2RlSW5wdXRCdWZmZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgYW55IGRvd25zdHJlYW0gbXVsdGktaW5wdXQgbm9kZSBidWZmZXJzIHRvIGVuc3VyZSBmcmVzaCBzdGF0ZSBmb3IgdGhpcyBpdGVyYXRpb24NCiAgICAgICAgICAgICAgICAgICAgLy8gQnV0IGJlIG1vcmUgc2VsZWN0aXZlIC0gb25seSBjbGVhciBub2RlcyB0aGF0IGFyZW4ndCBpbW1lZGlhdGUgY2hpbGRyZW4NCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW1tZWRpYXRlQ2hpbGRJZHMgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWxsRG93bnN0cmVhbUlkcyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBub2RlLmlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1tZWRpYXRlQ2hpbGRJZHMucHVzaChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgYWxsIGRvd25zdHJlYW0gbm9kZXMgKGNoaWxkcmVuIG9mIGNoaWxkcmVuKQ0KICAgICAgICAgICAgICAgICAgICBjb25zdCBmaW5kQWxsRG93bnN0cmVhbSA9IChub2RlSWRzLCB2aXNpdGVkID0gbmV3IFNldCgpKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGVJZCBvZiBub2RlSWRzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpc2l0ZWQuaGFzKG5vZGVJZCkpIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2l0ZWQuYWRkKG5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsRG93bnN0cmVhbUlkcy5wdXNoKG5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGRJZHMgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZElkcy5wdXNoKGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5kQWxsRG93bnN0cmVhbShjaGlsZElkcywgdmlzaXRlZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBmaW5kQWxsRG93bnN0cmVhbShpbW1lZGlhdGVDaGlsZElkcyk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGNsZWFyIGJ1ZmZlcnMgZm9yIGRvd25zdHJlYW0gbm9kZXMgdGhhdCBhcmVuJ3QgaW1tZWRpYXRlIGNoaWxkcmVuDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVzVG9DbGVhciA9IGFsbERvd25zdHJlYW1JZHMuZmlsdGVyKGlkID0+ICFpbW1lZGlhdGVDaGlsZElkcy5pbmNsdWRlcyhpZCkpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBub2RlSWQgb2Ygbm9kZXNUb0NsZWFyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmdsb2JhbE5vZGVJbnB1dEJ1ZmZlci5oYXMobm9kZUlkKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5nbG9iYWxOb2RlSW5wdXRCdWZmZXIuZGVsZXRlKG5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvLyBFeGVjdXRlIHRoZSBjb25uZWN0ZWQgd29ya2Zsb3cgLSB1c2UgdGhlIGV4ZWN1dGlvbiBlbmdpbmUgZGlyZWN0bHkNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIG5vZGVzIGNvbm5lY3RlZCB0byB0aGUgY3VycmVudF9pdGVtIG91dHB1dCBwb3J0DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3RlZE5vZGVzID0gW107DQogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZS5pZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldE5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGVkTm9kZXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlOiB0YXJnZXROb2RlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRQb3J0OiBjb25uZWN0aW9uLnRvLnBvcnROYW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0UG9ydDogY29ubmVjdGlvbi5mcm9tLnBvcnROYW1lDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIFNldCBhbGwgY29ubmVjdGVkIG5vZGVzIHRvIHJ1bm5pbmcgc3RhdGUgYmVmb3JlIGV4ZWN1dGlvbg0KICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3RlZE5vZGVJbmZvIG9mIGNvbm5lY3RlZE5vZGVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbm5lY3RlZE5vZGVJbmZvLm5vZGUuaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnY29tcGxldGVkJywgJ2Vycm9yJywgJ3dhaXRpbmctaW5wdXRzJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncnVubmluZycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSBlYWNoIGNvbm5lY3RlZCBub2RlIHdpdGggdGhlIGFwcHJvcHJpYXRlIGRhdGENCiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHNoYXJlZCBidWZmZXIgZm9yIHRoZSBlbnRpcmUgaXRlcmF0aW9uIHNvIG11bHRpLWlucHV0IG5vZGVzIGNhbiBhY2N1bXVsYXRlDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZXJhdGlvbkV4ZWN1dGVkID0gbmV3IFNldCgpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVyYXRpb25JbnB1dEJ1ZmZlciA9IG5ldyBNYXAoKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIENvcHkgYW55IGV4aXN0aW5nIGJ1ZmZlciBkYXRhIGZyb20gZ2xvYmFsIGJ1ZmZlciB0aGF0IG1pZ2h0IGJlIG5lZWRlZA0KICAgICAgICAgICAgICAgICAgICBpZiAoc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmdsb2JhbE5vZGVJbnB1dEJ1ZmZlcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBbbm9kZUlkLCBidWZmZXJEYXRhXSBvZiBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZ2xvYmFsTm9kZUlucHV0QnVmZmVyLmVudHJpZXMoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZXJhdGlvbklucHV0QnVmZmVyLnNldChub2RlSWQsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWl2ZWRJbnB1dHM6IHsgLi4uYnVmZmVyRGF0YS5yZWNlaXZlZElucHV0cyB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0ZWRQb3J0czogWy4uLmJ1ZmZlckRhdGEuY29ubmVjdGVkUG9ydHNdDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGVkTm9kZUluZm8gb2YgY29ubmVjdGVkTm9kZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbnB1dFZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBNYXAgdGhlIEZvciBFYWNoIG91dHB1dHMgdG8gdGhlIGNvbm5lY3RlZCBub2RlJ3MgaW5wdXQNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25uZWN0ZWROb2RlSW5mby5vdXRwdXRQb3J0ID09PSAnY3VycmVudF9pdGVtJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBjdXJyZW50SXRlbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29ubmVjdGVkTm9kZUluZm8ub3V0cHV0UG9ydCA9PT0gJ2N1cnJlbnRfaW5kZXgnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29udmVydCBpbmRleCB0byBzdHJpbmcgZm9yIGNvbXBhdGliaWxpdHkgd2l0aCB0ZXh0LWJhc2VkIG5vZGVzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IFN0cmluZyhjdXJyZW50SW5kZXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFZhbHVlID0gY3VycmVudEl0ZW07IC8vIERlZmF1bHQgdG8gY3VycmVudCBpdGVtDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBpbnB1dCBkYXRhIGZvciB0aGUgY29ubmVjdGVkIG5vZGUNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJbnB1dERhdGEgPSB7fTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJbnB1dERhdGFbY29ubmVjdGVkTm9kZUluZm8uaW5wdXRQb3J0XSA9IGlucHV0VmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHRoZSB3b3JrZmxvdyBleGVjdXRpb24gc3lzdGVtIHRvIGVuc3VyZSBkb3duc3RyZWFtIG5vZGVzIGV4ZWN1dGUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIHdpbGwgdHJpZ2dlciB0aGUgY29tcGxldGUgZXhlY3V0aW9uIGNoYWluIChsbG0g4oaSIGh0dHAg4oaSIGV0Yy4pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXhlY3V0ZU5vZGVTbWFydCgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGVkTm9kZUluZm8ubm9kZSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3RlZE5vZGVJbmZvLmlucHV0UG9ydCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRpb25FeGVjdXRlZCwgLy8gVXNlIHNoYXJlZCBleGVjdXRlZCBzZXQgZm9yIHRoaXMgaXRlcmF0aW9uDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZXJhdGlvbklucHV0QnVmZmVyICAvLyBVc2Ugc2hhcmVkIGJ1ZmZlciBmb3IgdGhpcyBpdGVyYXRpb24NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgbm9kZSBhcyBjb21wbGV0ZWQgYWZ0ZXIgc3VjY2Vzc2Z1bCBleGVjdXRpb24NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbm5lY3RlZE5vZGVJbmZvLm5vZGUuaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NvbXBsZXRlZCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKG5vZGVFcnJvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgbm9kZSBhcyBlcnJvciBpZiBleGVjdXRpb24gZmFpbHMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbm5lY3RlZE5vZGVJbmZvLm5vZGUuaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlLXRocm93IHRoZSBlcnJvciB0byBiZSBoYW5kbGVkIGJ5IHRoZSBvdXRlciBjYXRjaA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5vZGVFcnJvcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gTWFyayB0aGlzIGl0ZXJhdGlvbiBhcyBjb21wbGV0ZQ0KICAgICAgICAgICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pc0V4ZWN1dGluZ0l0ZXJhdGlvbiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBleGVjdXRpbmcgZm9yIGVhY2ggaXRlcmF0aW9uOicsIGVycm9yKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgdGhpcyBpdGVyYXRpb24gYXMgY29tcGxldGUgZXZlbiBvbiBlcnJvcg0KICAgICAgICAgICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pc0V4ZWN1dGluZ0l0ZXJhdGlvbiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gTWFyayBhbnkgc3RpbGwtcnVubmluZyBjb25uZWN0ZWQgbm9kZXMgYXMgZXJyb3INCiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGVkTm9kZXMgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBub2RlLmlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Tm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0Tm9kZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0ZWROb2Rlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGU6IHRhcmdldE5vZGUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFBvcnQ6IGNvbm5lY3Rpb24udG8ucG9ydE5hbWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRQb3J0OiBjb25uZWN0aW9uLmZyb20ucG9ydE5hbWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3RlZE5vZGVJbmZvIG9mIGNvbm5lY3RlZE5vZGVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbm5lY3RlZE5vZGVJbmZvLm5vZGUuaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50ICYmIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygncnVubmluZycpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGlmIChzdG9wT25FcnJvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RvcCB0aGUgaXRlcmF0aW9uDQogICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKG5vZGUuZm9yRWFjaFN0YXRlLmludGVydmFsKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmlzSXRlcmF0aW5nID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pbnRlcnZhbCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvLyBNb3ZlIHRvIG5leHQgaXRlbQ0KICAgICAgICAgICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmN1cnJlbnRJbmRleCsrOw0KDQogICAgICAgICAgICAgICAgLy8gU3RvcCBpZiB3ZSd2ZSBwcm9jZXNzZWQgYWxsIGl0ZW1zDQogICAgICAgICAgICAgICAgaWYgKG5vZGUuZm9yRWFjaFN0YXRlLmN1cnJlbnRJbmRleCA+PSBub2RlLmZvckVhY2hTdGF0ZS5hcnJheS5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChub2RlLmZvckVhY2hTdGF0ZS5pbnRlcnZhbCk7DQogICAgICAgICAgICAgICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmlzSXRlcmF0aW5nID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIG5vZGUuZm9yRWFjaFN0YXRlLmludGVydmFsID0gbnVsbDsNCg0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gRW5zdXJlIGFsbCBjb25uZWN0ZWQgbm9kZXMgc2hvdyBmaW5hbCBjb21wbGV0ZWQgc3RhdHVzDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3RlZE5vZGVzID0gW107DQogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZS5pZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldE5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGVkTm9kZXMucHVzaCh0YXJnZXROb2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGVkTm9kZSBvZiBjb25uZWN0ZWROb2Rlcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0ZWROb2RlLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCAmJiAhbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlcnJvcicpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycsICd3YWl0aW5nLWlucHV0cycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NvbXBsZXRlZCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LCBpdGVyYXRpb25EZWxheSk7IC8vIFVzZSBjb25maWd1cmFibGUgaXRlcmF0aW9uIGRlbGF5DQogICAgICAgIA0KICAgICAgICAvLyBEb24ndCByZXR1cm4gYW55IGRhdGEgaW1tZWRpYXRlbHkgLSBsZXQgdGhlIGludGVydmFsIGhhbmRsZSBhbGwgZXhlY3V0aW9ucw0KICAgICAgICAvLyBVc2UgYSBzcGVjaWFsIGZsYWcgdG8gcHJldmVudCBtYWluIHdvcmtmbG93IGZyb20gZXhlY3V0aW5nIGRvd25zdHJlYW0gbm9kZXMNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHN0YXJ0ZWQ6IHRydWUsDQogICAgICAgICAgICB0b3RhbF9pdGVtczogYXJyYXkubGVuZ3RoLA0KICAgICAgICAgICAgaXRlcmF0aW9uX2RlbGF5OiBpdGVyYXRpb25EZWxheSwNCiAgICAgICAgICAgIG1lc3NhZ2U6IGBGb3IgRWFjaCBpdGVyYXRpb24gc3RhcnRlZCB3aXRoICR7aXRlcmF0aW9uRGVsYXl9bXMgZGVsYXlgLA0KICAgICAgICAgICAgX19mb3JfZWFjaF9jb250cm9sOiB0cnVlICAvLyBTcGVjaWFsIGZsYWcgdG8gcHJldmVudCBkb3duc3RyZWFtIGV4ZWN1dGlvbiBieSBtYWluIHdvcmtmbG93DQogICAgICAgIH07DQogICAgfQ0KDQogICAgLy8gSWYgYWxyZWFkeSBpdGVyYXRpbmcsIHJldHVybiBjdXJyZW50IHN0YXRlDQogICAgcmV0dXJuIHsNCiAgICAgICAgaXNJdGVyYXRpbmc6IG5vZGUuZm9yRWFjaFN0YXRlLmlzSXRlcmF0aW5nLA0KICAgICAgICBjdXJyZW50X2luZGV4OiBub2RlLmZvckVhY2hTdGF0ZS5jdXJyZW50SW5kZXgsDQogICAgICAgIHRvdGFsX2l0ZW1zOiBub2RlLmZvckVhY2hTdGF0ZS5hcnJheS5sZW5ndGgNCiAgICB9Ow0KfQ0KDQovLyBEZWxheSBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlRGVsYXlOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGRlbGF5TXMgPSBwYXJzZUludChub2RlLmNvbmZpZy5kZWxheV9tcz8udmFsdWUgfHwgbm9kZS5jb25maWcuZGVsYXlfbXMgfHwgMTAwMCk7DQogICAgDQoNCiAgICANCiAgICAvLyBHZXQgdGhlIGlucHV0IGRhdGEgdG8gcGFzcyB0aHJvdWdoIGFmdGVyIGRlbGF5DQogICAgbGV0IGRhdGFUb1Bhc3NUaHJvdWdoID0gaW5wdXREYXRhLmRhdGE7DQogICAgDQogICAgLy8gSWYgbm8gc3BlY2lmaWMgZGF0YSBpbnB1dCwgdXNlIHRoZSBmaXJzdCBhdmFpbGFibGUgaW5wdXQNCiAgICBpZiAoZGF0YVRvUGFzc1Rocm91Z2ggPT09IHVuZGVmaW5lZCkgew0KICAgICAgICBjb25zdCBpbnB1dEtleXMgPSBPYmplY3Qua2V5cyhpbnB1dERhdGEpOw0KICAgICAgICBpZiAoaW5wdXRLZXlzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIGRhdGFUb1Bhc3NUaHJvdWdoID0gaW5wdXREYXRhW2lucHV0S2V5c1swXV07DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgLy8gV2FpdCBmb3IgdGhlIHNwZWNpZmllZCBkZWxheQ0KICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gew0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIHJlc29sdmUoKTsNCiAgICAgICAgfSwgZGVsYXlNcyk7DQogICAgfSk7DQogICAgDQogICAgLy8gUmV0dXJuIHRoZSBzYW1lIGRhdGEgdGhhdCB3YXMgaW5wdXQNCiAgICByZXR1cm4gew0KICAgICAgICBkYXRhOiBkYXRhVG9QYXNzVGhyb3VnaCwNCiAgICAgICAgb3JpZ2luYWxfZGF0YTogZGF0YVRvUGFzc1Rocm91Z2gsDQogICAgICAgIHByb2Nlc3NlZF9kYXRhOiBkYXRhVG9QYXNzVGhyb3VnaCwNCiAgICAgICAgZGVsYXlfbXM6IGRlbGF5TXMsDQogICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKQ0KICAgIH07DQp9DQoNCi8vIEV4cG9ydCB0byBnbG9iYWwgc2NvcGUgdXNpbmcgZ2V0QXBwV2luZG93IGZvciBhdXRvbWF0aWMgY2xlYW51cA0Kc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFeGVjdXRvcnMgPSB7DQogICAgZXhlY3V0ZVRpbWVyTm9kZSwNCiAgICBleGVjdXRlRGlzcGxheU5vZGUsDQogICAgZXhlY3V0ZVJlcGVhdGVyTm9kZSwNCiAgICBleGVjdXRlQ29uZGl0aW9uTm9kZSwNCiAgICBleGVjdXRlTG9naWNhbEdhdGVOb2RlLA0KICAgIGV4ZWN1dGVGb3JFYWNoTm9kZSwNCiAgICBleGVjdXRlRGVsYXlOb2RlDQp9Ow0KDQoNCi8vIExMTSBDaGF0IE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVMbG1DaGF0Tm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBlbmRwb2ludCA9IG5vZGUuY29uZmlnLmVuZHBvaW50LnZhbHVlOw0KICAgIGNvbnN0IG1vZGVsID0gbm9kZS5jb25maWcubW9kZWwudmFsdWU7DQogICAgY29uc3QgdGVtcGVyYXR1cmUgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLnRlbXBlcmF0dXJlLnZhbHVlKTsNCiAgICBjb25zdCBtYXhUb2tlbnMgPSBwYXJzZUludChub2RlLmNvbmZpZy5tYXhfdG9rZW5zLnZhbHVlKTsNCiAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBub2RlLmNvbmZpZy5zeXN0ZW1fcHJvbXB0LnZhbHVlOw0KICAgIGNvbnN0IGluY2x1ZGVDb250ZXh0ID0gbm9kZS5jb25maWcuaW5jbHVkZV9jb250ZXh0LnZhbHVlID09PSAndHJ1ZSc7DQogICAgY29uc3QgYXBpS2V5ID0gbm9kZS5jb25maWcuYXBpX2tleS52YWx1ZTsNCg0KICAgIC8vIEFjY2VwdCBwcm9tcHQgZnJvbSBlaXRoZXIgJ3Byb21wdCcgb3IgJ3RleHQnIGlucHV0DQogICAgbGV0IHByb21wdCA9IGlucHV0RGF0YS5wcm9tcHQ7DQogICAgaWYgKCFwcm9tcHQgJiYgaW5wdXREYXRhLnRleHQpIHsNCiAgICAgICAgcHJvbXB0ID0gaW5wdXREYXRhLnRleHQ7DQogICAgfQ0KICAgIGlmICghcHJvbXB0ICYmIGlucHV0RGF0YS5jb250ZXh0KSB7DQogICAgICAgIC8vIElmIGNvbnRleHQgaXMgYSBzdHJpbmcsIHVzZSBpdCBhcyBwcm9tcHQNCiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dERhdGEuY29udGV4dCA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIHByb21wdCA9IGlucHV0RGF0YS5jb250ZXh0Ow0KICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS5jb250ZXh0ICYmIHR5cGVvZiBpbnB1dERhdGEuY29udGV4dCA9PT0gJ29iamVjdCcgJiYgaW5wdXREYXRhLmNvbnRleHQudGV4dCkgew0KICAgICAgICAgICAgLy8gSWYgY29udGV4dCBpcyBhbiBvYmplY3Qgd2l0aCB0ZXh0IGZpZWxkLCB1c2UgdGhhdA0KICAgICAgICAgICAgcHJvbXB0ID0gaW5wdXREYXRhLmNvbnRleHQudGV4dDsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBpZiAoIXByb21wdCkgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xMTSBDaGF0IHJlcXVpcmVzIGEgcHJvbXB0IGlucHV0LiBDb25uZWN0IGEgVGV4dCBub2RlIHRvIHByb3ZpZGUgdGhlIHByb21wdC4nKTsNCiAgICB9DQoNCiAgICB0cnkgew0KICAgICAgICBjb25zdCBtZXNzYWdlcyA9IFtdOw0KDQogICAgICAgIGlmIChzeXN0ZW1Qcm9tcHQpIHsNCiAgICAgICAgICAgIG1lc3NhZ2VzLnB1c2goeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH0pOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGluY2x1ZGVDb250ZXh0ICYmIGlucHV0RGF0YS5jb250ZXh0KSB7DQogICAgICAgICAgICBtZXNzYWdlcy5wdXNoKHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiBgQ29udGV4dDogJHtKU09OLnN0cmluZ2lmeShpbnB1dERhdGEuY29udGV4dCl9XG5cblByb21wdDogJHtwcm9tcHR9YCB9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIG1lc3NhZ2VzLnB1c2goeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9KTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFVzZSB0aGUgbmV3IExMTSBBUEkgZm9yIHVuaXZlcnNhbCBwcm92aWRlciBzdXBwb3J0DQogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgc3lwbmV4QVBJLmxsbUNvbXBsZXRlKHsNCiAgICAgICAgICAgIHByb3ZpZGVyOiAnb3BlbmFpJywNCiAgICAgICAgICAgIGVuZHBvaW50OiBgJHtlbmRwb2ludH0vY2hhdC9jb21wbGV0aW9uc2AsDQogICAgICAgICAgICBtb2RlbDogbW9kZWwsDQogICAgICAgICAgICBtZXNzYWdlczogbWVzc2FnZXMsDQogICAgICAgICAgICB0ZW1wZXJhdHVyZTogdGVtcGVyYXR1cmUsDQogICAgICAgICAgICBtYXhUb2tlbnM6IG1heFRva2VucywNCiAgICAgICAgICAgIHN0cmVhbTogZmFsc2UsDQogICAgICAgICAgICBhcGlLZXk6IGFwaUtleQ0KICAgICAgICB9KTsNCg0KICAgICAgICAvLyBIYW5kbGUgcHJveHkgcmVzcG9uc2UgZm9ybWF0DQogICAgICAgIC8vIGlmICghcmVzcG9uc2UgfHwgcmVzcG9uc2Uuc3RhdHVzIDwgMjAwIHx8IHJlc3BvbnNlLnN0YXR1cyA+PSAzMDApIHsNCiAgICAgICAgLy8gICAgIHRocm93IG5ldyBFcnJvcihgUHJveHkgcmVxdWVzdCBmYWlsZWQ6ICR7cmVzcG9uc2U/LnN0YXR1cyB8fCAnVW5rbm93biBlcnJvcid9YCk7DQogICAgICAgIC8vIH0NCg0KICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3IpIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTExNIHJlcXVlc3QgZmFpbGVkOiAke3Jlc3BvbnNlLmVycm9yfWApOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gLy8gUGFyc2UgdGhlIEpTT04gcmVzcG9uc2UgY29udGVudCBmcm9tIHByb3h5DQogICAgICAgIC8vIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmNvbnRlbnQpOw0KDQogICAgICAgIC8vIGlmIChkYXRhLmVycm9yKSB7DQogICAgICAgIC8vICAgICB0aHJvdyBuZXcgRXJyb3IoZGF0YS5lcnJvci5tZXNzYWdlIHx8ICdMTE0gQVBJIGVycm9yJyk7DQogICAgICAgIC8vIH0NCg0KICAgICAgICAvL2NvbnNvbGUubG9nKHJlc3BvbnNlKTsNCiAgICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gcmVzcG9uc2UuY29udGVudCB8fCAnJzsNCg0KICAgICAgICAvL2NvbnN0IHJlc3BvbnNlVGV4dCA9IGRhdGEuY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCB8fCAnJzsNCg0KICAgICAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgbm9kZS5sYXN0UmVzcG9uc2UgPSByZXNwb25zZVRleHQ7DQogICAgICAgIG5vZGUubGFzdFVzYWdlID0gcmVzcG9uc2UudXNhZ2U7DQogICAgICAgIG5vZGUubGFzdE1vZGVsID0gcmVzcG9uc2UubW9kZWw7DQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHJlc3BvbnNlOiByZXNwb25zZVRleHQsDQogICAgICAgICAgICB0b2tlbnNfdXNlZDogcmVzcG9uc2UudXNhZ2U/LnRvdGFsX3Rva2VucyB8fCAwLA0KICAgICAgICAgICAgbW9kZWxfdXNlZDogcmVzcG9uc2UubW9kZWwsDQogICAgICAgICAgICBmdWxsX3Jlc3BvbnNlOiByZXNwb25zZQ0KICAgICAgICB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0xMTSBDaGF0IGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsgcmVzcG9uc2U6IG51bGwsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07DQogICAgfQ0KfQ0KDQoNCi8vIFRlcm1pbmFsIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVUZXJtaW5hbE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgY29tbWFuZCA9IG5vZGUuY29uZmlnLmNvbW1hbmQudmFsdWU7DQogICAgY29uc3QgdXNlSW5wdXRDb21tYW5kID0gbm9kZS5jb25maWcudXNlX2lucHV0X2NvbW1hbmQudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCB3b3JraW5nRGlyZWN0b3J5ID0gbm9kZS5jb25maWcud29ya2luZ19kaXJlY3RvcnkudmFsdWU7DQogICAgY29uc3QgdGltZW91dCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLnRpbWVvdXQudmFsdWUpOw0KDQogICAgbGV0IGZpbmFsQ29tbWFuZCA9IGNvbW1hbmQ7DQogICAgaWYgKHVzZUlucHV0Q29tbWFuZCAmJiBpbnB1dERhdGEuY29tbWFuZCkgew0KICAgICAgICBmaW5hbENvbW1hbmQgPSBpbnB1dERhdGEuY29tbWFuZDsNCiAgICB9DQoNCiAgICB0cnkgew0KICAgICAgICAvLyBUaGlzIHdvdWxkIG5lZWQgdG8gYmUgaW1wbGVtZW50ZWQgd2l0aCBhY3R1YWwgdGVybWluYWwgZXhlY3V0aW9uDQogICAgICAgIC8vIEZvciBub3csIHdlJ2xsIHJldHVybiBhIHBsYWNlaG9sZGVyDQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIG91dHB1dDogYENvbW1hbmQgZXhlY3V0ZWQ6ICR7ZmluYWxDb21tYW5kfWAsDQogICAgICAgICAgICBzdWNjZXNzOiB0cnVlLA0KICAgICAgICAgICAgZXJyb3I6IG51bGwsDQogICAgICAgICAgICBleGl0X2NvZGU6IDANCiAgICAgICAgfTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdUZXJtaW5hbCBleGVjdXRpb24gZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgb3V0cHV0OiBudWxsLA0KICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSwNCiAgICAgICAgICAgIGV4aXRfY29kZTogMQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gRXhwb3J0IHRvIGdsb2JhbCBzY29wZQ0Kc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmFpRXhlY3V0b3JzID0gew0KICAgIGV4ZWN1dGVMbG1DaGF0Tm9kZSwNCiAgICBleGVjdXRlVGVybWluYWxOb2RlDQp9Ow0KDQovLyBleGVjdXRpb24tZW5naW5lLmpzIC0gRHluYW1pYyBleGVjdXRpb24gZW5naW5lIGZvciBGbG93IEVkaXRvcg0KDQpjbGFzcyBFeGVjdXRpb25FbmdpbmUgew0KICAgIGNvbnN0cnVjdG9yKHJlZ2lzdHJ5KSB7DQogICAgICAgIHRoaXMucmVnaXN0cnkgPSByZWdpc3RyeTsNCiAgICAgICAgdGhpcy5zZXR1cEV4ZWN1dG9ycygpOw0KICAgIH0NCg0KICAgIHNldHVwRXhlY3V0b3JzKCkgew0KICAgICAgICAvLyBSZWdpc3RlciBleGVjdXRvcnMgZnJvbSBleHRlcm5hbCBmaWxlcyB3aXRoIGVuZ2luZSBpbnN0YW5jZSBwYXNzZWQgYXMgZmlyc3QgcGFyYW1ldGVyDQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignaHR0cF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5odHRwRXhlY3V0b3JzLmV4ZWN1dGVIdHRwTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigndmZzX3NhdmVfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuaHR0cEV4ZWN1dG9ycy5leGVjdXRlVmZzU2F2ZU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3Zmc19sb2FkX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmh0dHBFeGVjdXRvcnMuZXhlY3V0ZVZmc0xvYWROb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd2ZnNfZGlyZWN0b3J5X2xpc3RfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuaHR0cEV4ZWN1dG9ycy5leGVjdXRlVmZzRGlyZWN0b3J5TGlzdE5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICAgICAgDQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigndGltZXJfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0V4ZWN1dG9ycy5leGVjdXRlVGltZXJOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdkaXNwbGF5X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFeGVjdXRvcnMuZXhlY3V0ZURpc3BsYXlOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdyZXBlYXRlcl9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RXhlY3V0b3JzLmV4ZWN1dGVSZXBlYXRlck5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2NvbmRpdGlvbl9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RXhlY3V0b3JzLmV4ZWN1dGVDb25kaXRpb25Ob2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdsb2dpY2FsX2dhdGVfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0V4ZWN1dG9ycy5leGVjdXRlTG9naWNhbEdhdGVOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdmb3JfZWFjaF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RXhlY3V0b3JzLmV4ZWN1dGVGb3JFYWNoTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignZGVsYXlfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0V4ZWN1dG9ycy5leGVjdXRlRGVsYXlOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgICAgIA0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2F1ZGlvX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLm1lZGlhRXhlY3V0b3JzLmV4ZWN1dGVBdWRpb05vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2ltYWdlX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLm1lZGlhRXhlY3V0b3JzLmV4ZWN1dGVJbWFnZU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICAgICAgDQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignanNvbl9leHRyYWN0X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmRhdGFFeGVjdXRvcnMuZXhlY3V0ZUpzb25FeHRyYWN0Tm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigncmFuZG9tX2xpbmVfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZGF0YUV4ZWN1dG9ycy5leGVjdXRlUmFuZG9tUXVvdGVOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd0ZXh0X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmRhdGFFeGVjdXRvcnMuZXhlY3V0ZVRleHROb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdtYXRoX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmRhdGFFeGVjdXRvcnMuZXhlY3V0ZU1hdGhOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdhcnJheV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVBcnJheU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3N0cmluZ19leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVTdHJpbmdOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdub2RlX3JlZmVyZW5jZV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVOb2RlUmVmZXJlbmNlTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigncmFuZG9tX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmRhdGFFeGVjdXRvcnMuZXhlY3V0ZVJhbmRvbU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICAgICAgDQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignbGxtX2NoYXRfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuYWlFeGVjdXRvcnMuZXhlY3V0ZUxsbUNoYXROb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd0ZXJtaW5hbF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5haUV4ZWN1dG9ycy5leGVjdXRlVGVybWluYWxOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICB9DQoNCiAgICBhc3luYyBleGVjdXRlTm9kZShub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgICAgIGNvbnN0IG5vZGVEZWYgPSB0aGlzLnJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgICAgIGlmICghbm9kZURlZikgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBub2RlIGRlZmluaXRpb24gZm91bmQgZm9yIHR5cGU6ICR7bm9kZS50eXBlfWApOw0KICAgICAgICB9DQoNCiAgICAgICAgY29uc3QgZXhlY3V0b3JOYW1lID0gbm9kZURlZi5leGVjdXRvcjsNCiAgICAgICAgY29uc3QgZXhlY3V0b3IgPSB0aGlzLnJlZ2lzdHJ5LmdldEV4ZWN1dG9yKGV4ZWN1dG9yTmFtZSk7DQoNCiAgICAgICAgaWYgKCFleGVjdXRvcikgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBleGVjdXRvciBmb3VuZCBmb3I6ICR7ZXhlY3V0b3JOYW1lfWApOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGF3YWl0IGV4ZWN1dG9yKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpOw0KICAgIH0NCg0KDQoNCiAgICAvLyBTdG9wIHJlcGVhdGVyIG1ldGhvZA0KICAgIHN0b3BSZXBlYXRlcihub2RlKSB7DQogICAgICAgIGlmIChub2RlLnJlcGVhdGVyU3RhdGUgJiYgbm9kZS5yZXBlYXRlclN0YXRlLmludGVydmFsKSB7DQogICAgICAgICAgICBjbGVhckludGVydmFsKG5vZGUucmVwZWF0ZXJTdGF0ZS5pbnRlcnZhbCk7DQogICAgICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUuaW50ZXJ2YWwgPSBudWxsOw0KICAgICAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmlzUnVubmluZyA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gU3RvcCBmb3IgZWFjaCBtZXRob2QNCiAgICBzdG9wRm9yRWFjaChub2RlKSB7DQogICAgICAgIGlmIChub2RlLmZvckVhY2hTdGF0ZSAmJiBub2RlLmZvckVhY2hTdGF0ZS5pbnRlcnZhbCkgew0KICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChub2RlLmZvckVhY2hTdGF0ZS5pbnRlcnZhbCk7DQogICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pbnRlcnZhbCA9IG51bGw7DQogICAgICAgICAgICBub2RlLmZvckVhY2hTdGF0ZS5pc0l0ZXJhdGluZyA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQoNCg0KDQp9DQoNCi8vIEdsb2JhbCBleGVjdXRpb24gZW5naW5lIGluc3RhbmNlDQpjb25zdCBleGVjdXRpb25FbmdpbmUgPSBuZXcgRXhlY3V0aW9uRW5naW5lKG5vZGVSZWdpc3RyeSk7DQoNCg0KLy8gd29ya2Zsb3cuanMgLSBXb3JrZmxvdyBleGVjdXRpb24gbG9naWMgZm9yIEZsb3cgRWRpdG9yDQoNCi8vIFJ1biB0aGUgd29ya2Zsb3cNCmFzeW5jIGZ1bmN0aW9uIHJ1bldvcmtmbG93KCkgew0KICAgIGlmIChmbG93RWRpdG9yLmlzUnVubmluZykgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGZsb3dFZGl0b3IuaXNSdW5uaW5nID0gdHJ1ZTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncnVuLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcC13b3JrZmxvdycpLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWZsZXgnOw0KICAgIA0KICAgIC8vIENsZWFyIGFsbCB2aXN1YWwgc3RhdGVzIGZyb20gcHJldmlvdXMgcnVucw0KICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mbG93LW5vZGUnKS5mb3JFYWNoKG5vZGUgPT4gew0KICAgICAgICBub2RlLmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnLCAnd2FpdGluZy1pbnB1dHMnLCAnY29tcGxldGVkJywgJ2Vycm9yJyk7DQogICAgfSk7DQogICAgDQogICAgLy8gQ2xlYXIgb3V0cHV0DQogICAgY29uc3Qgb3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4ZWN1dGlvbi1vdXRwdXQnKTsNCiAgICBvdXRwdXQuaW5uZXJIVE1MID0gJzxkaXYgY2xhc3M9ImxvZy1lbnRyeSBpbmZvIj5TdGFydGluZyB3b3JrZmxvdyBleGVjdXRpb24uLi48L2Rpdj4nOw0KICAgIA0KICAgIHRyeSB7DQogICAgICAgIC8vIEZpbmQgc3RhcnQgbm9kZXMgKG5vZGVzIHdpdGggbm8gaW5wdXRzIHRoYXQgYXJlIHBhcnQgb2YgYSBjb25uZWN0ZWQgd29ya2Zsb3cpDQogICAgICAgIGNvbnN0IHN0YXJ0Tm9kZXMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3Iubm9kZXMudmFsdWVzKCkpLmZpbHRlcihub2RlID0+IHsNCiAgICAgICAgICAgIGNvbnN0IG5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICAgICAgICAgIGlmICghbm9kZURlZikgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgTm8gbm9kZSBkZWZpbml0aW9uIGZvdW5kIGZvciB0eXBlOiAke25vZGUudHlwZX1gKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gVGltZXIgYW5kIFJlcGVhdGVyIG5vZGVzIGFyZSBzdGFydCBub2RlcyAoY2FuIHRyaWdnZXIgdGhlbXNlbHZlcykNCiAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICd0aW1lcicgfHwgbm9kZS50eXBlID09PSAncmVwZWF0ZXInKSB7DQogICAgICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ3JlcGVhdGVyJykgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1J1bm5pbmcgPSBub2RlLnJlcGVhdGVyU3RhdGUgJiYgbm9kZS5yZXBlYXRlclN0YXRlLmlzUnVubmluZzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy8gVGltZXIvUmVwZWF0ZXIgaXMgYSBzdGFydCBub2RlIGlmIGl0IGhhcyBjb25uZWN0ZWQgb3V0cHV0cw0KICAgICAgICAgICAgICAgIGNvbnN0IGhhc0Nvbm5lY3RlZE91dHB1dHMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLnNvbWUoY29ubiA9PiANCiAgICAgICAgICAgICAgICAgICAgY29ubi5mcm9tLm5vZGVJZCA9PT0gbm9kZS5pZA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGhhc0Nvbm5lY3RlZE91dHB1dHM7IC8vIFRpbWVyL1JlcGVhdGVyIGlzIGEgc3RhcnQgbm9kZSBpZiBjb25uZWN0ZWQNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gSWYgbm9kZSBoYXMgbm8gaW5wdXRzLCBjaGVjayBpZiBpdCdzIHBhcnQgb2YgYSBjb25uZWN0ZWQgd29ya2Zsb3cNCiAgICAgICAgICAgIGlmIChub2RlRGVmLmlucHV0cy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIG5vZGUgaGFzIGFueSBvdXRwdXRzIHRoYXQgYXJlIGNvbm5lY3RlZCB0byBvdGhlciBub2Rlcw0KICAgICAgICAgICAgICAgIGNvbnN0IGhhc0Nvbm5lY3RlZE91dHB1dHMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLnNvbWUoY29ubiA9PiANCiAgICAgICAgICAgICAgICAgICAgY29ubi5mcm9tLm5vZGVJZCA9PT0gbm9kZS5pZA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gT25seSBpbmNsdWRlIGlmIGl0J3MgY29ubmVjdGVkIHRvIHRoZSB3b3JrZmxvdw0KICAgICAgICAgICAgICAgIHJldHVybiBoYXNDb25uZWN0ZWRPdXRwdXRzOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBub2RlcyB3aXRoIG9wdGlvbmFsIGlucHV0cw0KICAgICAgICAgICAgY29uc3Qgb3B0aW9uYWxJbnB1dHMgPSBub2RlRGVmLmlucHV0cy5maWx0ZXIoaW5wdXQgPT4gaW5wdXQub3B0aW9uYWwpOw0KICAgICAgICAgICAgaWYgKG9wdGlvbmFsSW5wdXRzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIG5vZGUgaGFzIGNvbm5lY3RlZCBvdXRwdXRzDQogICAgICAgICAgICAgICAgY29uc3QgaGFzQ29ubmVjdGVkT3V0cHV0cyA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkuc29tZShjb25uID0+IA0KICAgICAgICAgICAgICAgICAgICBjb25uLmZyb20ubm9kZUlkID09PSBub2RlLmlkDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gaGFzQ29ubmVjdGVkT3V0cHV0czsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTm9kZXMgd2l0aCByZXF1aXJlZCBpbnB1dHMgYXJlIG5vdCBzdGFydCBub2RlcyAtIHRoZXkgc2hvdWxkIGJlIHRyaWdnZXJlZCBieSBvdGhlciBub2Rlcw0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIGlmIChzdGFydE5vZGVzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gJ05vIHN0YXJ0IG5vZGVzIGZvdW5kLiBBZGQgbm9kZXMgd2l0aCBubyBpbnB1dHMgKFRpbWVyKSBvciBub2RlcyB3aXRoIG9wdGlvbmFsIGlucHV0cyB0aGF0IGFyZW5cJ3QgY29ubmVjdGVkIChIVFRQIFJlcXVlc3QpJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gU2hvdyBzaG9ydCwgY2xlYXIgbm90aWZpY2F0aW9uIHRvIHVzZXINCiAgICAgICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24pIHsNCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignTm8gc3RhcnQgbm9kZXMgZm91bmQgLSBjaGVjayBleGVjdXRpb24gb3V0cHV0IGZvciBkZXRhaWxzJywgJ2Vycm9yJywgNDAwMCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBFeGVjdXRlIHdvcmtmbG93DQogICAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBleGVjdXRlV29ya2Zsb3coc3RhcnROb2Rlcyk7DQogICAgICAgIA0KICAgICAgICAvLyBEaXNwbGF5IHJlc3VsdHMNCiAgICAgICAgb3V0cHV0LmlubmVySFRNTCArPSAnPGRpdiBjbGFzcz0ibG9nLWVudHJ5IHN1Y2Nlc3MiPldvcmtmbG93IGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkhPC9kaXY+JzsNCiAgICAgICAgZm9yIChjb25zdCByZXN1bHQgb2YgcmVzdWx0cykgew0KICAgICAgICAgICAgb3V0cHV0LmlubmVySFRNTCArPSBgPGRpdiBjbGFzcz0ibG9nLWVudHJ5IGluZm8iPiR7cmVzdWx0Lm5vZGVJZH06ICR7cmVzdWx0Lm91dHB1dH08L2Rpdj5gOw0KICAgICAgICB9DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dvcmtmbG93IGV4ZWN1dGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIG91dHB1dC5pbm5lckhUTUwgKz0gYDxkaXYgY2xhc3M9ImxvZy1lbnRyeSBlcnJvciI+RXJyb3I6ICR7ZXJyb3IubWVzc2FnZX08L2Rpdj5gOw0KICAgIH0gZmluYWxseSB7DQogICAgICAgIGZsb3dFZGl0b3IuaXNSdW5uaW5nID0gZmFsc2U7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdydW4td29ya2Zsb3cnKS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1mbGV4JzsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0b3Atd29ya2Zsb3cnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIH0NCn0NCg0KLy8gRXhlY3V0ZSB3b3JrZmxvdw0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVdvcmtmbG93KHN0YXJ0Tm9kZXMpIHsNCiAgICBjb25zdCByZXN1bHRzID0gW107DQogICAgY29uc3QgZXhlY3V0ZWQgPSBuZXcgU2V0KCk7DQogICAgY29uc3Qgbm9kZUlucHV0QnVmZmVyID0gbmV3IE1hcCgpOyAvLyBUcmFjayBpbnB1dHMgZm9yIG11bHRpLWlucHV0IG5vZGVzDQogICAgDQogICAgLy8gU3RvcmUgZ2xvYmFsbHkgc28gRm9yIEVhY2ggY2FuIGFjY2VzcyBpdA0KICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5nbG9iYWxOb2RlSW5wdXRCdWZmZXIgPSBub2RlSW5wdXRCdWZmZXI7DQogICAgDQogICAgZm9yIChjb25zdCBzdGFydE5vZGUgb2Ygc3RhcnROb2Rlcykgew0KICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBleGVjdXRlTm9kZShzdGFydE5vZGUsIHt9LCBleGVjdXRlZCwgbm9kZUlucHV0QnVmZmVyKTsNCiAgICAgICAgaWYgKHJlc3VsdCkgcmVzdWx0cy5wdXNoKHJlc3VsdCk7DQogICAgfQ0KICAgIA0KICAgIHJldHVybiByZXN1bHRzOw0KfQ0KDQovLyBFeGVjdXRlIGEgc2luZ2xlIG5vZGUgKGR5bmFtaWMgdmVyc2lvbikNCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVOb2RlKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQsIG5vZGVJbnB1dEJ1ZmZlcikgew0KICAgIGlmIChleGVjdXRlZC5oYXMobm9kZS5pZCkpIHsNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIGV4ZWN1dGVkLmFkZChub2RlLmlkKTsNCiAgICANCiAgICAvLyBNYXJrIG5vZGUgYXMgcnVubmluZw0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZS5pZCk7DQogICAgaWYgKG5vZGVFbGVtZW50KSBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdydW5uaW5nJyk7DQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgLy8gVXNlIHRoZSBkeW5hbWljIGV4ZWN1dGlvbiBlbmdpbmUNCiAgICAgICAgY29uc3Qgb3V0cHV0ID0gYXdhaXQgZXhlY3V0aW9uRW5naW5lLmV4ZWN1dGVOb2RlKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpOw0KICAgICAgICANCiAgICAgICAgLy8gU3RvcmUgb3V0cHV0IGRhdGEgZm9yIGNvbmZpZyBwYW5lbCBkaXNwbGF5DQogICAgICAgIG5vZGUubGFzdE91dHB1dERhdGEgPSBvdXRwdXQ7DQogICAgICAgIG5vZGUubGFzdEV4ZWN1dGlvblRpbWUgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7DQogICAgICAgIA0KICAgICAgICAvLyBDaGVjayBpZiBvdXRwdXQgaW5kaWNhdGVzIGV4ZWN1dGlvbiBzaG91bGQgc3RvcCAobG9naWNhbCBnYXRlIHNwZWNpZmljKQ0KICAgICAgICBpZiAob3V0cHV0ICYmIHR5cGVvZiBvdXRwdXQgPT09ICdvYmplY3QnICYmIG91dHB1dC5fX3N0b3BfZXhlY3V0aW9uID09PSB0cnVlKSB7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIE1hcmsgbm9kZSBhcyBjb21wbGV0ZWQNCiAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnKTsNCiAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZWQnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgcmV0dXJuIHsgbm9kZUlkOiBub2RlLmlkLCBvdXRwdXQ6IG51bGwgfTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQ2hlY2sgZm9yIGZvcl9lYWNoIGNvbnRyb2wgZmxhZyAtIHNraXAgZG93bnN0cmVhbSBleGVjdXRpb24sIGxldCBpbnRlcnZhbCBoYW5kbGUgaXQNCiAgICAgICAgaWYgKG91dHB1dCAmJiB0eXBlb2Ygb3V0cHV0ID09PSAnb2JqZWN0JyAmJiBvdXRwdXQuX19mb3JfZWFjaF9jb250cm9sID09PSB0cnVlKSB7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIE1hcmsgbm9kZSBhcyBjb21wbGV0ZWQgYnV0IGRvbid0IGV4ZWN1dGUgZG93bnN0cmVhbSBub2Rlcw0KICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NvbXBsZXRlZCcpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICByZXR1cm4geyBub2RlSWQ6IG5vZGUuaWQsIG91dHB1dDogb3V0cHV0IH07DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEZpbmQgY29ubmVjdGVkIG5vZGVzIGFuZCBleGVjdXRlIHRoZW0NCiAgICAgICAgY29uc3QgY29ubmVjdGVkTm9kZXMgPSBmaW5kQ29ubmVjdGVkTm9kZXMobm9kZS5pZCk7DQogICAgICAgIA0KICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3RlZE5vZGUgb2YgY29ubmVjdGVkTm9kZXMpIHsNCiAgICAgICAgICAgIC8vIENoZWNrIGZvciBjeWNsZXMgYmVmb3JlIGV4ZWN1dGluZw0KICAgICAgICAgICAgaWYgKGV4ZWN1dGVkLmhhcyhjb25uZWN0ZWROb2RlLm5vZGUuaWQpKSB7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gSGFuZGxlIG91dHB1dCBtYXBwaW5nIHRvIGlucHV0IHBvcnRzIC0gRElSRUNUIE1BUFBJTkcNCiAgICAgICAgICAgIGxldCBpbnB1dFZhbHVlID0gb3V0cHV0Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAob3V0cHV0IGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICAgICAgICAgIC8vIEJsb2Igb3V0cHV0IC0gcGFzcyBkaXJlY3RseSB0byB0aGUgaW5wdXQgcG9ydA0KICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBvdXRwdXQ7DQogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvdXRwdXQgPT09ICdvYmplY3QnICYmIG91dHB1dCAhPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIC8vIE9iamVjdCBvdXRwdXQgLSBleHRyYWN0IHRoZSBFWEFDVCBvdXRwdXQgcG9ydCBmaWVsZA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChjb25uZWN0ZWROb2RlLm91dHB1dFBvcnQgaW4gb3V0cHV0KSB7DQogICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBvdXRwdXRbY29ubmVjdGVkTm9kZS5vdXRwdXRQb3J0XTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBOb2RlICR7bm9kZS5pZH0gLT4gJHtjb25uZWN0ZWROb2RlLm5vZGUuaWR9OiBFUlJPUiAtIE91dHB1dCBwb3J0ICcke2Nvbm5lY3RlZE5vZGUub3V0cHV0UG9ydH0nIG5vdCBmb3VuZCBpbiBvdXRwdXQhYCk7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEF2YWlsYWJsZSBmaWVsZHM6YCwgT2JqZWN0LmtleXMob3V0cHV0KSk7DQogICAgICAgICAgICAgICAgICAgIC8vIFNraXAgdGhpcyBjb25uZWN0aW9uIGluc3RlYWQgb2YgcGFzc2luZyBudWxsDQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy8gU2ltcGxlIHZhbHVlIG91dHB1dCAtIHBhc3MgZGlyZWN0bHkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIC8vIFVzZSBzbWFydCBleGVjdXRpb24gdGhhdCBoYW5kbGVzIG11bHRpLWlucHV0IHN5bmNocm9uaXphdGlvbg0KICAgICAgICAgICAgICAgIGF3YWl0IGV4ZWN1dGVOb2RlU21hcnQoY29ubmVjdGVkTm9kZS5ub2RlLCBjb25uZWN0ZWROb2RlLmlucHV0UG9ydCwgaW5wdXRWYWx1ZSwgZXhlY3V0ZWQsIG5vZGVJbnB1dEJ1ZmZlcik7DQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGV4ZWN1dGluZyBjb25uZWN0ZWQgbm9kZSAke2Nvbm5lY3RlZE5vZGUubm9kZS5pZH06YCwgZXJyb3IpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dFBhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4ZWN1dGlvbi1vdXRwdXQnKTsNCiAgICAgICAgICAgICAgICBvdXRwdXRQYW5lbC5pbm5lckhUTUwgKz0gYDxkaXYgY2xhc3M9ImxvZy1lbnRyeSBlcnJvciI+RXJyb3IgaW4gY29ubmVjdGVkIG5vZGUgJHtjb25uZWN0ZWROb2RlLm5vZGUuaWR9OiAke2Vycm9yLm1lc3NhZ2V9PC9kaXY+YDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gTWFyayBub2RlIGFzIGNvbXBsZXRlZA0KICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnKTsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NvbXBsZXRlZCcpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICByZXR1cm4geyBub2RlSWQ6IG5vZGUuaWQsIG91dHB1dDogb3V0cHV0IH07DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGV4ZWN1dGluZyBub2RlICR7bm9kZS5pZH06YCwgZXJyb3IpOw0KICAgICAgICANCiAgICAgICAgLy8gTWFyayBub2RlIGFzIGVycm9yDQogICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZXJyb3InKTsNCiAgICB9DQogICAgDQogICAgICAgIHRocm93IGVycm9yOw0KICAgIH0gZmluYWxseSB7DQogICAgICAgIC8vIFJlbW92ZSBydW5uaW5nIHN0YXRlDQogICAgICAgIGlmIChub2RlRWxlbWVudCkgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgIH0NCn0NCg0KLy8gU21hcnQgZXhlY3V0aW9uIGZ1bmN0aW9uIHRoYXQgaGFuZGxlcyBtdWx0aS1pbnB1dCBzeW5jaHJvbml6YXRpb24NCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVOb2RlU21hcnQobm9kZSwgaW5wdXRQb3J0LCBpbnB1dFZhbHVlLCBleGVjdXRlZCwgbm9kZUlucHV0QnVmZmVyKSB7DQogICAgY29uc3Qgbm9kZUlkID0gbm9kZS5pZDsNCiAgICANCiAgICAvLyBHZXQgYWxsIGNvbm5lY3RlZCBpbnB1dCBwb3J0cyBmb3IgdGhpcyBub2RlDQogICAgY29uc3QgY29ubmVjdGVkSW5wdXRQb3J0cyA9IGdldENvbm5lY3RlZElucHV0UG9ydHMobm9kZUlkKTsNCiAgICANCg0KICAgIA0KICAgIC8vIElmIG5vZGUgaGFzIDAgb3IgMSBpbnB1dCBjb25uZWN0aW9ucywgZXhlY3V0ZSBpbW1lZGlhdGVseQ0KICAgIGlmIChjb25uZWN0ZWRJbnB1dFBvcnRzLmxlbmd0aCA8PSAxKSB7DQogICAgICAgIHJldHVybiBhd2FpdCBleGVjdXRlTm9kZShub2RlLCB7IFtpbnB1dFBvcnRdOiBpbnB1dFZhbHVlIH0sIGV4ZWN1dGVkLCBub2RlSW5wdXRCdWZmZXIpOw0KICAgIH0NCiAgICANCiAgICAvLyBNdWx0aS1pbnB1dCBub2RlIC0gbmVlZCB0byBjb2xsZWN0IGFsbCBpbnB1dHMgYmVmb3JlIGV4ZWN1dGluZw0KICAgIGlmICghbm9kZUlucHV0QnVmZmVyLmhhcyhub2RlSWQpKSB7DQogICAgICAgIG5vZGVJbnB1dEJ1ZmZlci5zZXQobm9kZUlkLCB7DQogICAgICAgICAgICByZWNlaXZlZElucHV0czoge30sDQogICAgICAgICAgICBjb25uZWN0ZWRQb3J0czogY29ubmVjdGVkSW5wdXRQb3J0cw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIC8vIE1hcmsgbm9kZSBhcyB3YWl0aW5nIGZvciBpbnB1dHMgKHZpc3VhbCBmZWVkYmFjaykNCiAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3dhaXRpbmctaW5wdXRzJyk7DQogICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjb21wbGV0ZWQnLCAnZXJyb3InKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICBjb25zdCBidWZmZXIgPSBub2RlSW5wdXRCdWZmZXIuZ2V0KG5vZGVJZCk7DQogICAgDQoNCiAgICANCiAgICAvLyBTdG9yZSB0aGlzIGlucHV0DQogICAgYnVmZmVyLnJlY2VpdmVkSW5wdXRzW2lucHV0UG9ydF0gPSBpbnB1dFZhbHVlOw0KICAgIA0KIA0KICAgIA0KICAgIC8vIENoZWNrIGlmIHdlIGhhdmUgYWxsIHJlcXVpcmVkIGlucHV0cw0KICAgIGNvbnN0IGhhc0FsbElucHV0cyA9IGJ1ZmZlci5jb25uZWN0ZWRQb3J0cy5ldmVyeShwb3J0ID0+IHBvcnQgaW4gYnVmZmVyLnJlY2VpdmVkSW5wdXRzKTsNCiAgICANCg0KICAgIA0KICAgIGlmICghaGFzQWxsSW5wdXRzKSB7DQoNCiAgICAgICAgLy8gU3RpbGwgd2FpdGluZyBmb3IgbW9yZSBpbnB1dHMNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIA0KICAgIC8vIEFsbCBpbnB1dHMgcmVhZHkgLSByZW1vdmUgd2FpdGluZyBzdGF0ZSBhbmQgZXhlY3V0ZSENCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3dhaXRpbmctaW5wdXRzJyk7DQogICAgfQ0KICAgIA0KICAgIA0KICAgIC8vIENsZWFyIGJ1ZmZlciBmb3IgbmV4dCBleGVjdXRpb24NCiAgICBub2RlSW5wdXRCdWZmZXIuZGVsZXRlKG5vZGVJZCk7DQogICAgDQogICAgLy8gRXhlY3V0ZSB3aXRoIGFsbCBhZ2dyZWdhdGVkIGlucHV0cw0KICAgIHJldHVybiBhd2FpdCBleGVjdXRlTm9kZShub2RlLCBidWZmZXIucmVjZWl2ZWRJbnB1dHMsIGV4ZWN1dGVkLCBub2RlSW5wdXRCdWZmZXIpOw0KfQ0KDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gZ2V0IGNvbm5lY3RlZCBpbnB1dCBwb3J0cyBmb3IgYSBub2RlDQpmdW5jdGlvbiBnZXRDb25uZWN0ZWRJbnB1dFBvcnRzKG5vZGVJZCkgew0KICAgIGxldCBjb25uZWN0aW9ucyA9IG51bGw7DQogICAgDQogICAgLy8gRGVidWc6IExvZyB3aGF0J3MgYXZhaWxhYmxlIG9uIGZsb3dFZGl0b3IgKHRyeSBib3RoIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yIGFuZCBmbG93RWRpdG9yKQ0KICAgIA0KICAgIC8vIFRyeSB0byBhY2Nlc3MgZmxvd0VkaXRvciBkaXJlY3RseSAobm90IHZpYSB3aW5kb3cpDQogICAgbGV0IGVkaXRvciA9IG51bGw7DQogICAgaWYgKHR5cGVvZiBmbG93RWRpdG9yICE9PSAndW5kZWZpbmVkJyAmJiBmbG93RWRpdG9yKSB7DQogICAgICAgIGVkaXRvciA9IGZsb3dFZGl0b3I7DQogICAgfSBlbHNlIGlmIChzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvcikgew0KICAgICAgICBlZGl0b3IgPSBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvcjsNCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gW107DQogICAgfQ0KICAgIA0KICAgIA0KICAgIC8vIFRyeSBtdWx0aXBsZSB3YXlzIHRvIGFjY2VzcyBjb25uZWN0aW9ucyBkYXRhDQogICAgaWYgKGVkaXRvci5jb25uZWN0aW9ucykgew0KICAgICAgICBjb25uZWN0aW9ucyA9IGVkaXRvci5jb25uZWN0aW9uczsNCiAgICB9IGVsc2UgaWYgKGVkaXRvci53b3JrZmxvdyAmJiBlZGl0b3Iud29ya2Zsb3cuY29ubmVjdGlvbnMpIHsNCiAgICAgICAgY29ubmVjdGlvbnMgPSBuZXcgTWFwKGVkaXRvci53b3JrZmxvdy5jb25uZWN0aW9ucy5tYXAoY29ubiA9PiBbY29ubi5pZCwgY29ubl0pKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gW107DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGFsbENvbm5lY3Rpb25zID0gQXJyYXkuZnJvbShjb25uZWN0aW9ucy52YWx1ZXMoKSk7DQogICAgDQogICAgLy8gTG9nIGFsbCBjb25uZWN0aW9ucyBmb3IgZGVidWdnaW5nDQogICAgYWxsQ29ubmVjdGlvbnMuZm9yRWFjaCgoY29ubiwgaW5kZXgpID0+IHsNCiAgICB9KTsNCiAgICANCiAgICBjb25zdCBjb25uZWN0ZWRQb3J0cyA9IGFsbENvbm5lY3Rpb25zDQogICAgICAgIC5maWx0ZXIoY29ubiA9PiB7DQogICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gY29ubi50by5ub2RlSWQgPT09IG5vZGVJZDsNCiAgICAgICAgICAgIGlmIChtYXRjaGVzKSB7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gbWF0Y2hlczsNCiAgICAgICAgfSkNCiAgICAgICAgLm1hcChjb25uID0+IGNvbm4udG8ucG9ydE5hbWUpOw0KICAgICAgICANCiAgICByZXR1cm4gY29ubmVjdGVkUG9ydHM7DQp9DQogICAgDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gdXBkYXRlIGRpc3BsYXkgbm9kZSBjb250ZW50ICh1c2VkIGJ5IGV4ZWN1dGlvbiBlbmdpbmUpDQpmdW5jdGlvbiB1cGRhdGVEaXNwbGF5Tm9kZUNvbnRlbnQobm9kZUlkLCBjb250ZW50LCBmb3JtYXQpIHsNCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgaWYgKCFub2RlRWxlbWVudCkgcmV0dXJuOw0KICAgIA0KICAgIGNvbnN0IGRpc3BsYXlUZXh0ID0gbm9kZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLmRpc3BsYXktdGV4dCcpOw0KICAgIGNvbnN0IGZvcm1hdEVsZW1lbnQgPSBub2RlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZGlzcGxheS1mb3JtYXQgc3BhbicpOw0KICAgIA0KICAgIGlmIChkaXNwbGF5VGV4dCkgew0KICAgICAgICBsZXQgZm9ybWF0dGVkQ29udGVudCA9IGNvbnRlbnQ7DQogICAgICAgIA0KICAgIHN3aXRjaCAoZm9ybWF0KSB7DQogICAgICAgIGNhc2UgJ2pzb24nOg0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gdHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnID8gSlNPTi5wYXJzZShjb250ZW50KSA6IGNvbnRlbnQ7DQogICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZENvbnRlbnQgPSBKU09OLnN0cmluZ2lmeShwYXJzZWQsIG51bGwsIDIpOw0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRDb250ZW50ID0gY29udGVudDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdodG1sJzoNCiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRDb250ZW50ID0gY29udGVudDsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICd0ZXh0JzoNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRDb250ZW50ID0gY29udGVudDsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgIH0NCiAgICANCiAgICAgICAgZGlzcGxheVRleHQuaW5uZXJIVE1MID0gYDxwcmUgY2xhc3M9ImNvbnRlbnQtdGV4dCI+JHtlc2NhcGVIdG1sKGZvcm1hdHRlZENvbnRlbnQpfTwvcHJlPmA7DQogICAgfQ0KICAgIA0KICAgIGlmIChmb3JtYXRFbGVtZW50KSB7DQogICAgICAgIGZvcm1hdEVsZW1lbnQudGV4dENvbnRlbnQgPSBmb3JtYXQ7DQogICAgfQ0KICAgIA0KICAgIC8vIFN0b3JlIGZvciBjb25maWcgcGFuZWwgZGlzcGxheQ0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmIChub2RlKSB7DQogICAgICAgIG5vZGUubGFzdENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICBub2RlLmxhc3RGb3JtYXQgPSBmb3JtYXQ7DQogICAgfQ0KfQ0KDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gZXNjYXBlIEhUTUwNCmZ1bmN0aW9uIGVzY2FwZUh0bWwodGV4dCkgew0KICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIGRpdi50ZXh0Q29udGVudCA9IHRleHQ7DQogICAgcmV0dXJuIGRpdi5pbm5lckhUTUw7DQp9DQoNCi8vIEhlbHBlciBmdW5jdGlvbiB0byByZXBsYWNlIHRlbXBsYXRlIHBsYWNlaG9sZGVycw0KZnVuY3Rpb24gcmVwbGFjZVRlbXBsYXRlUGxhY2Vob2xkZXJzKHRlbXBsYXRlLCBkYXRhKSB7DQogICAgaWYgKHR5cGVvZiB0ZW1wbGF0ZSAhPT0gJ29iamVjdCcgfHwgdGVtcGxhdGUgPT09IG51bGwpIHsNCiAgICAgICAgcmV0dXJuIHRlbXBsYXRlOw0KICAgIH0NCiAgICANCiAgICBpZiAoQXJyYXkuaXNBcnJheSh0ZW1wbGF0ZSkpIHsNCiAgICAgICAgcmV0dXJuIHRlbXBsYXRlLm1hcChpdGVtID0+IHJlcGxhY2VUZW1wbGF0ZVBsYWNlaG9sZGVycyhpdGVtLCBkYXRhKSk7DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IHJlc3VsdCA9IHt9Ow0KICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRlbXBsYXRlKSkgew0KICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgbGV0IHJlcGxhY2VkVmFsdWUgPSB2YWx1ZTsNCiAgICANCiAgICAgICAgICAgIC8vIFJlcGxhY2Uge3tWQUxVRX19IHdpdGggdGhlIGZ1bGwgZGF0YSBvYmplY3QNCiAgICAgICAgICAgIGlmICh2YWx1ZS5pbmNsdWRlcygne3tWQUxVRX19JykpIHsNCiAgICAgICAgICAgICAgICByZXBsYWNlZFZhbHVlID0gdmFsdWUucmVwbGFjZSgne3tWQUxVRX19JywgSlNPTi5zdHJpbmdpZnkoZGF0YSkpOw0KfQ0KDQogICAgICAgICAgICAvLyBSZXBsYWNlIHt7SlNPTjpmaWVsZH19IHdpdGggc3BlY2lmaWMgZmllbGQNCiAgICAgICAgICAgIGNvbnN0IGpzb25NYXRjaGVzID0gdmFsdWUubWF0Y2goL1x7XHtKU09OOihbXn1dKylcfVx9L2cpOw0KICAgICAgICAgICAgaWYgKGpzb25NYXRjaGVzKSB7DQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBtYXRjaCBvZiBqc29uTWF0Y2hlcykgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZCA9IG1hdGNoLm1hdGNoKC9ce1x7SlNPTjooW159XSspXH1cfS8pWzFdOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZFZhbHVlID0gZ2V0TmVzdGVkVmFsdWUoZGF0YSwgZmllbGQpOw0KICAgICAgICAgICAgICAgICAgICByZXBsYWNlZFZhbHVlID0gcmVwbGFjZWRWYWx1ZS5yZXBsYWNlKG1hdGNoLCBKU09OLnN0cmluZ2lmeShmaWVsZFZhbHVlKSk7DQogICAgICAgICAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAgICAgICAgIC8vIFJlcGxhY2Uge3tmaWVsZH19IHdpdGggc3BlY2lmaWMgZmllbGQgdmFsdWUNCiAgICAgICAgICAgIGNvbnN0IGZpZWxkTWF0Y2hlcyA9IHZhbHVlLm1hdGNoKC9ce1x7KFtefV0rKVx9XH0vZyk7DQogICAgICAgICAgICBpZiAoZmllbGRNYXRjaGVzKSB7DQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBtYXRjaCBvZiBmaWVsZE1hdGNoZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGQgPSBtYXRjaC5tYXRjaCgvXHtceyhbXn1dKylcfVx9LylbMV07DQogICAgICAgICAgICAgICAgICAgIGlmIChmaWVsZCAhPT0gJ1ZBTFVFJyAmJiAhZmllbGQuc3RhcnRzV2l0aCgnSlNPTjonKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IGdldE5lc3RlZFZhbHVlKGRhdGEsIGZpZWxkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VkVmFsdWUgPSByZXBsYWNlZFZhbHVlLnJlcGxhY2UobWF0Y2gsIGZpZWxkVmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICByZXN1bHRba2V5XSA9IHJlcGxhY2VkVmFsdWU7DQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAhPT0gbnVsbCkgew0KICAgICAgICAgICAgcmVzdWx0W2tleV0gPSByZXBsYWNlVGVtcGxhdGVQbGFjZWhvbGRlcnModmFsdWUsIGRhdGEpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmVzdWx0W2tleV0gPSB2YWx1ZTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICByZXR1cm4gcmVzdWx0Ow0KfQ0KDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gZ2V0IG5lc3RlZCBvYmplY3QgdmFsdWVzDQpmdW5jdGlvbiBnZXROZXN0ZWRWYWx1ZShvYmosIHBhdGgpIHsNCiAgICBjb25zdCBrZXlzID0gcGF0aC5zcGxpdCgnLicpOw0KICAgIGxldCBjdXJyZW50ID0gb2JqOw0KICAgIA0KICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHsNCiAgICAgICAgaWYgKGN1cnJlbnQgPT09IG51bGwgfHwgY3VycmVudCA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gSGFuZGxlIGFycmF5IGFjY2VzcyBsaWtlICJpdGVtc1swXS5uYW1lIg0KICAgICAgICBjb25zdCBhcnJheU1hdGNoID0ga2V5Lm1hdGNoKC9eKC4rKVxbKFxkKylcXSQvKTsNCiAgICAgICAgaWYgKGFycmF5TWF0Y2gpIHsNCiAgICAgICAgICAgIGNvbnN0IGFycmF5S2V5ID0gYXJyYXlNYXRjaFsxXTsNCiAgICAgICAgICAgIGNvbnN0IGFycmF5SW5kZXggPSBwYXJzZUludChhcnJheU1hdGNoWzJdKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGN1cnJlbnRbYXJyYXlLZXldICYmIEFycmF5LmlzQXJyYXkoY3VycmVudFthcnJheUtleV0pKSB7DQogICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnRbYXJyYXlLZXldW2FycmF5SW5kZXhdOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnRba2V5XTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICByZXR1cm4gY3VycmVudDsNCn0NCg0KLy8gU3RvcCB3b3JrZmxvdyBleGVjdXRpb24NCmZ1bmN0aW9uIHN0b3BXb3JrZmxvdygpIHsNCiAgICAgICAgZmxvd0VkaXRvci5pc1J1bm5pbmcgPSBmYWxzZTsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3J1bi13b3JrZmxvdycpLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWZsZXgnOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcC13b3JrZmxvdycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIA0KICAgIC8vIENsZWFyIHJ1bm5pbmcgc3RhdGVzIGZyb20gYWxsIG5vZGVzDQogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mbG93LW5vZGUucnVubmluZywgLmZsb3ctbm9kZS53YWl0aW5nLWlucHV0cycpLmZvckVhY2gobm9kZSA9PiB7DQogICAgICAgICAgICBub2RlLmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnLCAnd2FpdGluZy1pbnB1dHMnKTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgIGNvbnN0IG91dHB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleGVjdXRpb24tb3V0cHV0Jyk7DQogICAgb3V0cHV0LmlubmVySFRNTCArPSAnPGRpdiBjbGFzcz0ibG9nLWVudHJ5IHdhcm5pbmciPldvcmtmbG93IGV4ZWN1dGlvbiBzdG9wcGVkIGJ5IHVzZXI8L2Rpdj4nOw0KICAgIA0KfQ0KDQovLyBGaW5kIG5vZGVzIGNvbm5lY3RlZCB0byBhIHNwZWNpZmljIG5vZGUNCmZ1bmN0aW9uIGZpbmRDb25uZWN0ZWROb2Rlcyhub2RlSWQpIHsNCiAgICBjb25zdCBjb25uZWN0ZWROb2RlcyA9IFtdOw0KICAgIA0KICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBub2RlSWQpIHsNCiAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgICAgICAgICBpZiAodGFyZ2V0Tm9kZSkgew0KICAgICAgICAgICAgICAgIGNvbm5lY3RlZE5vZGVzLnB1c2goew0KICAgICAgICAgICAgICAgICAgICBub2RlOiB0YXJnZXROb2RlLA0KICAgICAgICAgICAgICAgICAgICBpbnB1dFBvcnQ6IGNvbm5lY3Rpb24udG8ucG9ydE5hbWUsDQogICAgICAgICAgICAgICAgICAgIG91dHB1dFBvcnQ6IGNvbm5lY3Rpb24uZnJvbS5wb3J0TmFtZQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIHJldHVybiBjb25uZWN0ZWROb2RlczsNCn0NCg0KLy8gRm9ybWF0IGRhdGEgZm9yIHByZXZpZXcgaW4gY29uZmlnIHBhbmVsDQpmdW5jdGlvbiBmb3JtYXREYXRhUHJldmlldyhkYXRhLCBtYXhMZW5ndGggPSAyMDApIHsNCiAgICBpZiAoZGF0YSA9PT0gbnVsbCB8fCBkYXRhID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgcmV0dXJuIHsgdHlwZTogJ251bGwnLCBwcmV2aWV3OiAnbnVsbCcgfTsNCiAgICB9DQogICAgDQogICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBCbG9iKSB7DQogICAgICAgIGNvbnN0IHNpemVLQiA9IChkYXRhLnNpemUgLyAxMDI0KS50b0ZpeGVkKDIpOw0KICAgICAgICBjb25zdCBzaXplTUIgPSBkYXRhLnNpemUgPiAxMDI0ICogMTAyNCA/IGAgKCR7KGRhdGEuc2l6ZSAvICgxMDI0ICogMTAyNCkpLnRvRml4ZWQoMil9IE1CKWAgOiAnJzsNCiAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICB0eXBlOiAnQmxvYicsIA0KICAgICAgICAgICAgcHJldmlldzogYCR7ZGF0YS50eXBlIHx8ICd1bmtub3duJ30gLSAke3NpemVLQn0gS0Ike3NpemVNQn1gLA0KICAgICAgICAgICAgc2l6ZTogZGF0YS5zaXplDQogICAgICAgIH07DQogICAgfQ0KICAgIA0KICAgIGlmIChkYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsNCiAgICAgICAgY29uc3Qgc2l6ZUtCID0gKGRhdGEuYnl0ZUxlbmd0aCAvIDEwMjQpLnRvRml4ZWQoMik7DQogICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgdHlwZTogJ0FycmF5QnVmZmVyJywgDQogICAgICAgICAgICBwcmV2aWV3OiBgQmluYXJ5IGRhdGEgLSAke3NpemVLQn0gS0JgLA0KICAgICAgICAgICAgc2l6ZTogZGF0YS5ieXRlTGVuZ3RoDQogICAgICAgIH07DQogICAgfQ0KICAgIA0KICAgIGlmIChkYXRhIGluc3RhbmNlb2YgVWludDhBcnJheSB8fCBkYXRhIGluc3RhbmNlb2YgSW50OEFycmF5IHx8IA0KICAgICAgICBkYXRhIGluc3RhbmNlb2YgVWludDE2QXJyYXkgfHwgZGF0YSBpbnN0YW5jZW9mIEludDE2QXJyYXkgfHwNCiAgICAgICAgZGF0YSBpbnN0YW5jZW9mIFVpbnQzMkFycmF5IHx8IGRhdGEgaW5zdGFuY2VvZiBJbnQzMkFycmF5IHx8DQogICAgICAgIGRhdGEgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXkgfHwgZGF0YSBpbnN0YW5jZW9mIEZsb2F0NjRBcnJheSkgew0KICAgICAgICBjb25zdCBzaXplS0IgPSAoZGF0YS5ieXRlTGVuZ3RoIC8gMTAyNCkudG9GaXhlZCgyKTsNCiAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICB0eXBlOiBkYXRhLmNvbnN0cnVjdG9yLm5hbWUsIA0KICAgICAgICAgICAgcHJldmlldzogYEJpbmFyeSBhcnJheSAtICR7c2l6ZUtCfSBLQmAsDQogICAgICAgICAgICBzaXplOiBkYXRhLmJ5dGVMZW5ndGgNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgaWYgKEFycmF5LmlzQXJyYXkoZGF0YSkpIHsNCiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBsaWtlbHkgYmluYXJ5IGRhdGEgKGFycmF5IG9mIG51bWJlcnMgMC0yNTUpDQogICAgICAgIGlmIChkYXRhLmxlbmd0aCA+IDAgJiYgZGF0YS5ldmVyeShpdGVtID0+IHR5cGVvZiBpdGVtID09PSAnbnVtYmVyJyAmJiBpdGVtID49IDAgJiYgaXRlbSA8PSAyNTUpKSB7DQogICAgICAgICAgICBjb25zdCBzaXplS0IgPSAoZGF0YS5sZW5ndGggLyAxMDI0KS50b0ZpeGVkKDIpOw0KICAgICAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICAgICAgdHlwZTogJ0JpbmFyeSBBcnJheScsIA0KICAgICAgICAgICAgICAgIHByZXZpZXc6IGBCaW5hcnkgZGF0YSBhcnJheSAtICR7c2l6ZUtCfSBLQmAsDQogICAgICAgICAgICAgICAgbGVuZ3RoOiBkYXRhLmxlbmd0aA0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgY29uc3QgcHJldmlldyA9IGRhdGEubGVuZ3RoID4gMyANCiAgICAgICAgICAgID8gYFske2RhdGEuc2xpY2UoMCwgMykubWFwKGl0ZW0gPT4gSlNPTi5zdHJpbmdpZnkoaXRlbSkpLmpvaW4oJywgJyl9LCAuLi5dYA0KICAgICAgICAgICAgOiBKU09OLnN0cmluZ2lmeShkYXRhKTsNCiAgICAgICAgY29uc3QgdHJ1bmNhdGVkID0gcHJldmlldy5sZW5ndGggPiBtYXhMZW5ndGggPyBwcmV2aWV3LnN1YnN0cmluZygwLCBtYXhMZW5ndGgpICsgJy4uLicgOiBwcmV2aWV3Ow0KICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgIHR5cGU6ICdBcnJheScsIA0KICAgICAgICAgICAgcHJldmlldzogdHJ1bmNhdGVkLA0KICAgICAgICAgICAgbGVuZ3RoOiBkYXRhLmxlbmd0aA0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdvYmplY3QnKSB7DQogICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhkYXRhKTsNCiAgICAgICAgDQogICAgICAgIC8vIENoZWNrIGlmIGl0IGxvb2tzIGxpa2UgYSBsYXJnZSBkYXRhIG9iamVjdCAoaGFzIGNvbW1vbiBsYXJnZSBkYXRhIGluZGljYXRvcnMpDQogICAgICAgIGNvbnN0IGhhc0xhcmdlRGF0YUluZGljYXRvcnMgPSBrZXlzLnNvbWUoa2V5ID0+IA0KICAgICAgICAgICAga2V5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2RhdGEnKSB8fCANCiAgICAgICAgICAgIGtleS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdidWZmZXInKSB8fA0KICAgICAgICAgICAga2V5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2Jhc2U2NCcpIHx8DQogICAgICAgICAgICBrZXkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYmluYXJ5JykNCiAgICAgICAgKTsNCiAgICAgICAgDQogICAgICAgIGlmIChoYXNMYXJnZURhdGFJbmRpY2F0b3JzKSB7DQogICAgICAgICAgICAvLyBDaGVjayBzaXplcyBvZiB2YWx1ZXMgdGhhdCBtaWdodCBiZSBsYXJnZQ0KICAgICAgICAgICAgbGV0IHRvdGFsU2l6ZSA9IDA7DQogICAgICAgICAgICBsZXQgaGFzTGFyZ2VWYWx1ZXMgPSBmYWxzZTsNCiAgICAgICAgICAgIGNvbnN0IHN1bW1hcnkgPSB7fTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgew0KICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZGF0YVtrZXldOw0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmIHZhbHVlLmxlbmd0aCA+IDEwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeVtrZXldID0gYFN0cmluZyAoJHsodmFsdWUubGVuZ3RoIC8gMTAyNCkudG9GaXhlZCgyKX0gS0IpYDsNCiAgICAgICAgICAgICAgICAgICAgdG90YWxTaXplICs9IHZhbHVlLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgaGFzTGFyZ2VWYWx1ZXMgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgew0KICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5W2tleV0gPSBgQXJyYXlCdWZmZXIgKCR7KHZhbHVlLmJ5dGVMZW5ndGggLyAxMDI0KS50b0ZpeGVkKDIpfSBLQilgOw0KICAgICAgICAgICAgICAgICAgICB0b3RhbFNpemUgKz0gdmFsdWUuYnl0ZUxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgaGFzTGFyZ2VWYWx1ZXMgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID4gMTAwMCkgew0KICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5W2tleV0gPSBgQXJyYXlbJHt2YWx1ZS5sZW5ndGh9XSAoJHsodmFsdWUubGVuZ3RoIC8gMTAyNCkudG9GaXhlZCgyKX0gS0IgZXN0LilgOw0KICAgICAgICAgICAgICAgICAgICB0b3RhbFNpemUgKz0gdmFsdWUubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICBoYXNMYXJnZVZhbHVlcyA9IHRydWU7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeVtrZXldID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IGAiJHt2YWx1ZS5zdWJzdHJpbmcoMCwgMzApfS4uLiJgIDogdHlwZW9mIHZhbHVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGhhc0xhcmdlVmFsdWVzKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdMYXJnZSBPYmplY3QnLCANCiAgICAgICAgICAgICAgICAgICAgcHJldmlldzogSlNPTi5zdHJpbmdpZnkoc3VtbWFyeSwgbnVsbCwgMiksDQogICAgICAgICAgICAgICAgICAgIGtleXM6IGtleXMubGVuZ3RoLA0KICAgICAgICAgICAgICAgICAgICBlc3RpbWF0ZWRTaXplOiB0b3RhbFNpemUNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBSZWd1bGFyIG9iamVjdCBoYW5kbGluZw0KICAgICAgICBjb25zdCBwcmV2aWV3ID0ga2V5cy5sZW5ndGggPiAzDQogICAgICAgICAgICA/IGB7JHtrZXlzLnNsaWNlKDAsIDMpLmpvaW4oJywgJyl9LCAuLi59YA0KICAgICAgICAgICAgOiBKU09OLnN0cmluZ2lmeShkYXRhKTsNCiAgICAgICAgY29uc3QgdHJ1bmNhdGVkID0gcHJldmlldy5sZW5ndGggPiBtYXhMZW5ndGggPyBwcmV2aWV3LnN1YnN0cmluZygwLCBtYXhMZW5ndGgpICsgJy4uLicgOiBwcmV2aWV3Ow0KICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgIHR5cGU6ICdPYmplY3QnLCANCiAgICAgICAgICAgIHByZXZpZXc6IHRydW5jYXRlZCwNCiAgICAgICAgICAgIGtleXM6IGtleXMubGVuZ3RoDQogICAgICAgIH07DQogICAgfQ0KICAgIA0KICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBiYXNlNjQgZGF0YQ0KICAgICAgICBjb25zdCBpc0Jhc2U2NCA9IC9eW0EtWmEtejAtOSsvXSo9ezAsMn0kLy50ZXN0KGRhdGEpICYmIGRhdGEubGVuZ3RoID4gMTAwICYmIGRhdGEubGVuZ3RoICUgNCA9PT0gMDsNCiAgICAgICAgaWYgKGlzQmFzZTY0KSB7DQogICAgICAgICAgICBjb25zdCBzaXplS0IgPSAoZGF0YS5sZW5ndGggKiAwLjc1IC8gMTAyNCkudG9GaXhlZCgyKTsgLy8gQmFzZTY0IGlzIH4zMyUgbGFyZ2VyIHRoYW4gYmluYXJ5DQogICAgICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgICAgICB0eXBlOiAnQmFzZTY0IERhdGEnLCANCiAgICAgICAgICAgICAgICBwcmV2aWV3OiBgQmFzZTY0IGVuY29kZWQgZGF0YSAtICR7c2l6ZUtCfSBLQmAsDQogICAgICAgICAgICAgICAgbGVuZ3RoOiBkYXRhLmxlbmd0aA0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBhIGRhdGEgVVJMDQogICAgICAgIGlmIChkYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6JykpIHsNCiAgICAgICAgICAgIGNvbnN0IGNvbW1hSW5kZXggPSBkYXRhLmluZGV4T2YoJywnKTsNCiAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IGNvbW1hSW5kZXggPiAwID8gZGF0YS5zdWJzdHJpbmcoMCwgY29tbWFJbmRleCkgOiBkYXRhLnN1YnN0cmluZygwLCA1MCk7DQogICAgICAgICAgICBjb25zdCBkYXRhU2l6ZSA9IGNvbW1hSW5kZXggPiAwID8gZGF0YS5sZW5ndGggLSBjb21tYUluZGV4IC0gMSA6IGRhdGEubGVuZ3RoOw0KICAgICAgICAgICAgY29uc3Qgc2l6ZUtCID0gKGRhdGFTaXplICogMC43NSAvIDEwMjQpLnRvRml4ZWQoMik7DQogICAgICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgICAgICB0eXBlOiAnRGF0YSBVUkwnLCANCiAgICAgICAgICAgICAgICBwcmV2aWV3OiBgJHtoZWFkZXJ9Li4uIC0gJHtzaXplS0J9IEtCYCwNCiAgICAgICAgICAgICAgICBsZW5ndGg6IGRhdGEubGVuZ3RoDQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBSZWd1bGFyIHN0cmluZyBoYW5kbGluZw0KICAgICAgICBjb25zdCB0cnVuY2F0ZWQgPSBkYXRhLmxlbmd0aCA+IG1heExlbmd0aCA/IGRhdGEuc3Vic3RyaW5nKDAsIG1heExlbmd0aCkgKyAnLi4uJyA6IGRhdGE7DQogICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgdHlwZTogJ1N0cmluZycsIA0KICAgICAgICAgICAgcHJldmlldzogdHJ1bmNhdGVkLA0KICAgICAgICAgICAgbGVuZ3RoOiBkYXRhLmxlbmd0aA0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICByZXR1cm4geyANCiAgICAgICAgdHlwZTogdHlwZW9mIGRhdGEsIA0KICAgICAgICBwcmV2aWV3OiBTdHJpbmcoZGF0YSkgDQogICAgfTsNCn0NCg0KLy8gR2V0IG91dHB1dCBwb3J0IGRhdGEgZm9yIGEgc3BlY2lmaWMgbm9kZSBhbmQgcG9ydA0KZnVuY3Rpb24gZ2V0T3V0cHV0UG9ydERhdGEobm9kZUlkLCBwb3J0SWQpIHsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUgfHwgIW5vZGUubGFzdE91dHB1dERhdGEpIHsNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIA0KICAgIC8vIElmIHRoZSBvdXRwdXQgZGF0YSBpcyBhbiBvYmplY3Qgd2l0aCBuYW1lZCBwb3J0cywgZXh0cmFjdCB0aGUgc3BlY2lmaWMgcG9ydA0KICAgIGlmICh0eXBlb2Ygbm9kZS5sYXN0T3V0cHV0RGF0YSA9PT0gJ29iamVjdCcgJiYgbm9kZS5sYXN0T3V0cHV0RGF0YSAhPT0gbnVsbCAmJiAhQXJyYXkuaXNBcnJheShub2RlLmxhc3RPdXRwdXREYXRhKSAmJiAhKG5vZGUubGFzdE91dHB1dERhdGEgaW5zdGFuY2VvZiBCbG9iKSAmJiAhKG5vZGUubGFzdE91dHB1dERhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikpIHsNCiAgICAgICAgaWYgKHBvcnRJZCBpbiBub2RlLmxhc3RPdXRwdXREYXRhKSB7DQogICAgICAgICAgICByZXR1cm4gbm9kZS5sYXN0T3V0cHV0RGF0YVtwb3J0SWRdOw0KICAgICAgICB9DQogICAgICAgIC8vIFBvcnQgbm90IGZvdW5kIGluIG91dHB1dCBvYmplY3QNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIA0KICAgIC8vIEZvciBzaW5nbGUgb3V0cHV0IG5vZGVzIG9yIG5vbi1vYmplY3Qgb3V0cHV0cyAoQmxvYiwgQXJyYXlCdWZmZXIsIHByaW1pdGl2ZXMpLCANCiAgICAvLyBvbmx5IHJldHVybiBkYXRhIGZvciB0aGUgZmlyc3QvcHJpbWFyeSBvdXRwdXQgcG9ydA0KICAgIGNvbnN0IG5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICBpZiAobm9kZURlZiAmJiBub2RlRGVmLm91dHB1dHMgJiYgbm9kZURlZi5vdXRwdXRzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgLy8gT25seSByZXR1cm4gZGF0YSBmb3IgdGhlIGZpcnN0IG91dHB1dCBwb3J0LCBvdGhlcnMgZ2V0IG51bGwNCiAgICAgICAgaWYgKHBvcnRJZCA9PT0gbm9kZURlZi5vdXRwdXRzWzBdLmlkKSB7DQogICAgICAgICAgICByZXR1cm4gbm9kZS5sYXN0T3V0cHV0RGF0YTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQogICAgDQogICAgLy8gRmFsbGJhY2s6IHJldHVybiB0aGUgZGF0YSAoc2hvdWxkbid0IG5vcm1hbGx5IHJlYWNoIGhlcmUpDQogICAgcmV0dXJuIG5vZGUubGFzdE91dHB1dERhdGE7DQp9IA0KDQovLyBVcGRhdGUgY2FudmFzIHRyYW5zZm9ybSBmb3IgcGFubmluZyBhbmQgem9vbWluZw0KZnVuY3Rpb24gdXBkYXRlQ2FudmFzVHJhbnNmb3JtKCkgew0KICAgIGlmIChmbG93RWRpdG9yLmNhbnZhcykgew0KICAgICAgICAvLyBVc2UgcmVxdWVzdEFuaW1hdGlvbkZyYW1lIHRvIHByZXZlbnQgdmlzdWFsIGZsYXNoaW5nDQogICAgICAgIGlmIChmbG93RWRpdG9yLnRyYW5zZm9ybVVwZGF0ZVJlcXVlc3RlZCkgcmV0dXJuOw0KICAgICAgICBmbG93RWRpdG9yLnRyYW5zZm9ybVVwZGF0ZVJlcXVlc3RlZCA9IHRydWU7DQogICAgICAgIA0KICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gew0KICAgICAgICAgICAgaWYgKGZsb3dFZGl0b3IuY2FudmFzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgdHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke2Zsb3dFZGl0b3IucGFuT2Zmc2V0Lnh9cHgsICR7Zmxvd0VkaXRvci5wYW5PZmZzZXQueX1weCkgc2NhbGUoJHtmbG93RWRpdG9yLnpvb21MZXZlbH0pYDsNCiAgICAgICAgICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS50cmFuc2Zvcm0gPSB0cmFuc2Zvcm07DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gVXBkYXRlIHpvb20gbGV2ZWwgZGlzcGxheQ0KICAgICAgICAgICAgICAgIGNvbnN0IHpvb21EaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvb20tbGV2ZWwnKTsNCiAgICAgICAgICAgICAgICBpZiAoem9vbURpc3BsYXkpIHsNCiAgICAgICAgICAgICAgICAgICAgem9vbURpc3BsYXkudGV4dENvbnRlbnQgPSBNYXRoLnJvdW5kKGZsb3dFZGl0b3Iuem9vbUxldmVsICogMTAwKSArICclJzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmbG93RWRpdG9yLnRyYW5zZm9ybVVwZGF0ZVJlcXVlc3RlZCA9IGZhbHNlOw0KICAgICAgICB9KTsNCiAgICB9DQp9DQoNCi8vIFN0YXJ0IGNhbnZhcyBwYW5uaW5nDQpmdW5jdGlvbiBzdGFydENhbnZhc1BhbihlKSB7DQogICAgLy8gT25seSBzdGFydCBwYW5uaW5nIGlmIGNsaWNraW5nIGRpcmVjdGx5IG9uIGNhbnZhcyAobm90IG9uIG5vZGVzIG9yIG90aGVyIGVsZW1lbnRzKQ0KICAgIC8vIGFuZCBub3QgYWxyZWFkeSBkcmFnZ2luZyBhIG5vZGUNCiAgICBpZiAoZS50YXJnZXQgPT09IGZsb3dFZGl0b3IuY2FudmFzICYmICFmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSkgew0KICAgICAgICBmbG93RWRpdG9yLmlzUGFubmluZyA9IHRydWU7DQogICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPw0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDoNCiAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgZmxvd0VkaXRvci5wYW5TdGFydCA9IHsgeDogbW91c2VDb29yZHMueCwgeTogbW91c2VDb29yZHMueSB9Ow0KICAgICAgICBmbG93RWRpdG9yLmxhc3RQYW5PZmZzZXQgPSB7IC4uLmZsb3dFZGl0b3IucGFuT2Zmc2V0IH07DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLmN1cnNvciA9ICdncmFiYmluZyc7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLmNsYXNzTGlzdC5hZGQoJ3Bhbm5pbmcnKTsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgIH0NCn0NCg0KLy8gVXBkYXRlIGNhbnZhcyBwYW5uaW5nDQpmdW5jdGlvbiB1cGRhdGVDYW52YXNQYW4oZSkgew0KICAgIGlmIChmbG93RWRpdG9yLmlzUGFubmluZykgew0KICAgICAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8NCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6DQogICAgICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgICAgIGNvbnN0IGRlbHRhWCA9IG1vdXNlQ29vcmRzLnggLSBmbG93RWRpdG9yLnBhblN0YXJ0Lng7DQogICAgICAgIGNvbnN0IGRlbHRhWSA9IG1vdXNlQ29vcmRzLnkgLSBmbG93RWRpdG9yLnBhblN0YXJ0Lnk7DQoNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IGZsb3dFZGl0b3IubGFzdFBhbk9mZnNldC54ICsgZGVsdGFYOw0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC55ID0gZmxvd0VkaXRvci5sYXN0UGFuT2Zmc2V0LnkgKyBkZWx0YVk7DQoNCiAgICAgICAgdXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICB9DQp9DQoNCi8vIFN0b3AgY2FudmFzIHBhbm5pbmcNCmZ1bmN0aW9uIHN0b3BDYW52YXNQYW4oKSB7DQogICAgaWYgKGZsb3dFZGl0b3IuaXNQYW5uaW5nKSB7DQogICAgICAgIGZsb3dFZGl0b3IuaXNQYW5uaW5nID0gZmFsc2U7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLmN1cnNvciA9ICdncmFiJzsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuY2xhc3NMaXN0LnJlbW92ZSgncGFubmluZycpOw0KICAgIH0NCn0NCg0KLy8gUmVzZXQgY2FudmFzIHBhbiB0byBjZW50ZXINCmZ1bmN0aW9uIHJlc2V0Q2FudmFzUGFuKCkgew0KICAgIC8vIFByZXZlbnQgY29uY3VycmVudCBvcGVyYXRpb25zDQogICAgaWYgKGZsb3dFZGl0b3IuaXNSZXNldHRpbmcpIHJldHVybjsNCiAgICBmbG93RWRpdG9yLmlzUmVzZXR0aW5nID0gdHJ1ZTsNCiAgICANCiAgICAvLyBBZGQgc21vb3RoIHRyYW5zaXRpb24gZm9yIHJlc2V0IHdpdGggaW1wcm92ZWQgZWFzaW5nDQogICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICd0cmFuc2Zvcm0gMC41cyBjdWJpYy1iZXppZXIoMC4yNSwgMC40NiwgMC40NSwgMC45NCknOw0KDQogICAgLy8gQ2FsY3VsYXRlIGNlbnRlciBvZiBhbGwgbm9kZXMgaWYgYW55IGV4aXN0DQogICAgaWYgKGZsb3dFZGl0b3Iubm9kZXMuc2l6ZSA+IDApIHsNCiAgICAgICAgY29uc3Qgbm9kZXMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3Iubm9kZXMudmFsdWVzKCkpOw0KICAgICAgICBjb25zdCBtaW5YID0gTWF0aC5taW4oLi4ubm9kZXMubWFwKG4gPT4gbi54KSk7DQogICAgICAgIGNvbnN0IG1heFggPSBNYXRoLm1heCguLi5ub2Rlcy5tYXAobiA9PiBuLngpKTsNCiAgICAgICAgY29uc3QgbWluWSA9IE1hdGgubWluKC4uLm5vZGVzLm1hcChuID0+IG4ueSkpOw0KICAgICAgICBjb25zdCBtYXhZID0gTWF0aC5tYXgoLi4ubm9kZXMubWFwKG4gPT4gbi55KSk7DQoNCiAgICAgICAgY29uc3QgY2VudGVyWCA9IChtaW5YICsgbWF4WCkgLyAyOw0KICAgICAgICBjb25zdCBjZW50ZXJZID0gKG1pblkgKyBtYXhZKSAvIDI7DQoNCiAgICAgICAgLy8gR2V0IGNhbnZhcyBjb250YWluZXIgZGltZW5zaW9ucyAoc2NhbGVkKQ0KICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8NCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6DQogICAgICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQoNCiAgICAgICAgLy8gQ2FsY3VsYXRlIHBhbiBvZmZzZXQgdG8gY2VudGVyIHRoZSBub2RlcyBpbiB0aGUgdmlld3BvcnQNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IC1jZW50ZXJYICsgY29udGFpbmVyUmVjdC53aWR0aCAvIDI7DQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSAtY2VudGVyWSArIGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBJZiBubyBub2RlcywgcmVzZXQgdG8gY2VudGVyIG9mIHRoZSBsYXJnZSBjYW52YXMNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQgPSB7IHg6IC01MDAwLCB5OiAtNTAwMCB9Ow0KICAgIH0NCg0KICAgIC8vIFJlc2V0IHpvb20gdG8gMTAwJQ0KICAgIGZsb3dFZGl0b3Iuem9vbUxldmVsID0gMS4wOw0KDQogICAgdXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQoNCiAgICAvLyBSZW1vdmUgdHJhbnNpdGlvbiBhZnRlciBhbmltYXRpb24gY29tcGxldGVzIHdpdGggcHJvcGVyIHRpbWluZw0KICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnJlc2V0VGltZW91dCk7DQogICAgZmxvd0VkaXRvci5yZXNldFRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICcnOw0KICAgICAgICBmbG93RWRpdG9yLmlzUmVzZXR0aW5nID0gZmFsc2U7DQogICAgfSwgNTAwKTsgLy8gTWF0Y2ggdHJhbnNpdGlvbiBkdXJhdGlvbg0KfQ0KDQovLyBab29tIGZ1bmN0aW9ucw0KZnVuY3Rpb24gem9vbUluKCkgew0KICAgIGNvbnN0IG5ld1pvb20gPSBNYXRoLm1pbihmbG93RWRpdG9yLnpvb21MZXZlbCArIGZsb3dFZGl0b3Iuem9vbVN0ZXAsIGZsb3dFZGl0b3IubWF4Wm9vbSk7DQogICAgc2V0Wm9vbUxldmVsKG5ld1pvb20pOw0KfQ0KDQpmdW5jdGlvbiB6b29tT3V0KCkgew0KICAgIGNvbnN0IG5ld1pvb20gPSBNYXRoLm1heChmbG93RWRpdG9yLnpvb21MZXZlbCAtIGZsb3dFZGl0b3Iuem9vbVN0ZXAsIGZsb3dFZGl0b3IubWluWm9vbSk7DQogICAgc2V0Wm9vbUxldmVsKG5ld1pvb20pOw0KfQ0KDQpmdW5jdGlvbiBzZXRab29tTGV2ZWwoem9vbUxldmVsKSB7DQogICAgLy8gUHJldmVudCBjb25jdXJyZW50IHpvb20gb3BlcmF0aW9ucyB0byBhdm9pZCB2aXN1YWwgYXJ0aWZhY3RzDQogICAgaWYgKGZsb3dFZGl0b3IuaXNab29taW5nKSByZXR1cm47DQogICAgZmxvd0VkaXRvci5pc1pvb21pbmcgPSB0cnVlOw0KICAgIA0KICAgIC8vIEFkZCB6b29taW5nIGNsYXNzIGZvciBwZXJmb3JtYW5jZSBvcHRpbWl6YXRpb25zDQogICAgZmxvd0VkaXRvci5jYW52YXMuY2xhc3NMaXN0LmFkZCgnem9vbWluZycpOw0KICAgIA0KICAgIC8vIEdldCB0aGUgY2VudGVyIG9mIHRoZSBjYW52YXMgY29udGFpbmVyIGZvciB6b29tIG9yaWdpbg0KICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgY29uc3QgY29udGFpbmVyUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/DQogICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6DQogICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICANCiAgICBjb25zdCBjZW50ZXJYID0gY29udGFpbmVyUmVjdC53aWR0aCAvIDI7DQogICAgY29uc3QgY2VudGVyWSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICANCiAgICAvLyBDYWxjdWxhdGUgdGhlIHBvaW50IGluIGNhbnZhcyBjb29yZGluYXRlcyB0aGF0IHNob3VsZCByZW1haW4gZml4ZWQNCiAgICBjb25zdCBjYW52YXNYID0gKGNlbnRlclggLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIGNvbnN0IGNhbnZhc1kgPSAoY2VudGVyWSAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgDQogICAgLy8gVXBkYXRlIHpvb20gbGV2ZWwNCiAgICBmbG93RWRpdG9yLnpvb21MZXZlbCA9IE1hdGgubWF4KGZsb3dFZGl0b3IubWluWm9vbSwgTWF0aC5taW4oZmxvd0VkaXRvci5tYXhab29tLCB6b29tTGV2ZWwpKTsNCiAgICANCiAgICAvLyBBZGp1c3QgcGFuIG9mZnNldCB0byBrZWVwIHRoZSBjZW50ZXIgcG9pbnQgZml4ZWQNCiAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gY2VudGVyWCAtIGNhbnZhc1ggKiBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICBmbG93RWRpdG9yLnBhbk9mZnNldC55ID0gY2VudGVyWSAtIGNhbnZhc1kgKiBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICANCiAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICANCiAgICAvLyBDb25zb2xpZGF0ZWQgcmVkcmF3IHRpbWluZyB0byBwcmV2ZW50IG11bHRpcGxlIHJlZHJhd3MNCiAgICBjbGVhclRpbWVvdXQoZmxvd0VkaXRvci56b29tUmVkcmF3VGltZW91dCk7DQogICAgZmxvd0VkaXRvci56b29tUmVkcmF3VGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5jbGFzc0xpc3QucmVtb3ZlKCd6b29taW5nJyk7DQogICAgICAgIGZsb3dFZGl0b3IuaXNab29taW5nID0gZmFsc2U7DQogICAgfSwgMzIpOyAvLyBJbmNyZWFzZWQgZnJvbSAxNm1zIHRvIHByZXZlbnQgdG9vIGZyZXF1ZW50IHJlZHJhd3MNCn0NCg0KZnVuY3Rpb24gem9vbVRvRml0KCkgew0KICAgIGlmIChmbG93RWRpdG9yLm5vZGVzLnNpemUgPT09IDApIHsNCiAgICAgICAgLy8gSWYgbm8gbm9kZXMsIHJlc2V0IHRvIDEwMCUgem9vbSBhbmQgY2VudGVyDQogICAgICAgIGZsb3dFZGl0b3Iuem9vbUxldmVsID0gMS4wOw0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldCA9IHsgeDogLTUwMDAsIHk6IC01MDAwIH07DQogICAgICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIFByZXZlbnQgY29uY3VycmVudCB6b29tIG9wZXJhdGlvbnMNCiAgICBpZiAoZmxvd0VkaXRvci5pc1pvb21pbmcpIHJldHVybjsNCiAgICBmbG93RWRpdG9yLmlzWm9vbWluZyA9IHRydWU7DQogICAgDQogICAgLy8gRmluZCBib3VuZHMgb2YgYWxsIG5vZGVzDQogICAgY29uc3Qgbm9kZXMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3Iubm9kZXMudmFsdWVzKCkpOw0KICAgIGNvbnN0IHBhZGRpbmcgPSAxMDA7IC8vIEV4dHJhIHBhZGRpbmcgYXJvdW5kIG5vZGVzDQogICAgDQogICAgbGV0IG1pblggPSBJbmZpbml0eSwgbWF4WCA9IC1JbmZpbml0eTsNCiAgICBsZXQgbWluWSA9IEluZmluaXR5LCBtYXhZID0gLUluZmluaXR5Ow0KICAgIA0KICAgIG5vZGVzLmZvckVhY2gobm9kZSA9PiB7DQogICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZS5pZCk7DQogICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgY29uc3QgcmVjdCA9IG5vZGVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICAgICAgbWluWCA9IE1hdGgubWluKG1pblgsIG5vZGUueCk7DQogICAgICAgICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgbm9kZS54ICsgcmVjdC53aWR0aCk7DQogICAgICAgICAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgbm9kZS55KTsNCiAgICAgICAgICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCBub2RlLnkgKyByZWN0LmhlaWdodCk7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICAvLyBBZGQgcGFkZGluZw0KICAgIG1pblggLT0gcGFkZGluZzsNCiAgICBtYXhYICs9IHBhZGRpbmc7DQogICAgbWluWSAtPSBwYWRkaW5nOw0KICAgIG1heFkgKz0gcGFkZGluZzsNCiAgICANCiAgICBjb25zdCBjb250ZW50V2lkdGggPSBtYXhYIC0gbWluWDsNCiAgICBjb25zdCBjb250ZW50SGVpZ2h0ID0gbWF4WSAtIG1pblk7DQogICAgDQogICAgLy8gR2V0IGNvbnRhaW5lciBkaW1lbnNpb25zDQogICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8NCiAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDoNCiAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSB6b29tIHRvIGZpdA0KICAgIGNvbnN0IHpvb21YID0gY29udGFpbmVyUmVjdC53aWR0aCAvIGNvbnRlbnRXaWR0aDsNCiAgICBjb25zdCB6b29tWSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gY29udGVudEhlaWdodDsNCiAgICBjb25zdCBuZXdab29tID0gTWF0aC5taW4oem9vbVgsIHpvb21ZLCBmbG93RWRpdG9yLm1heFpvb20pOw0KICAgIA0KICAgIC8vIFNldCB6b29tIGxldmVsDQogICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSBNYXRoLm1heChmbG93RWRpdG9yLm1pblpvb20sIG5ld1pvb20pOw0KICAgIA0KICAgIC8vIENlbnRlciB0aGUgY29udGVudA0KICAgIGNvbnN0IGNlbnRlclggPSAobWluWCArIG1heFgpIC8gMjsNCiAgICBjb25zdCBjZW50ZXJZID0gKG1pblkgKyBtYXhZKSAvIDI7DQogICAgDQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyIC0gY2VudGVyWCAqIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSBjb250YWluZXJSZWN0LmhlaWdodCAvIDIgLSBjZW50ZXJZICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgDQogICAgLy8gQWRkIHNtb290aCB0cmFuc2l0aW9uIHdpdGggYmV0dGVyIHRpbWluZw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zaXRpb24gPSAndHJhbnNmb3JtIDAuNHMgY3ViaWMtYmV6aWVyKDAuMjUsIDAuNDYsIDAuNDUsIDAuOTQpJzsNCiAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICANCiAgICAvLyBSZW1vdmUgdHJhbnNpdGlvbiBhbmQgcmVkcmF3IHdpdGggcHJvcGVyIHRpbWluZw0KICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnpvb21GaXRUaW1lb3V0KTsNCiAgICBmbG93RWRpdG9yLnpvb21GaXRUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zaXRpb24gPSAnJzsNCiAgICAgICAgLy8gVXNlIHJlcXVlc3RBbmltYXRpb25GcmFtZSBmb3Igc21vb3RoIHJlZHJhdw0KICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gew0KICAgICAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IuaXNab29taW5nID0gZmFsc2U7DQogICAgICAgIH0pOw0KICAgIH0sIDQwMCk7IC8vIE1hdGNoIHRyYW5zaXRpb24gZHVyYXRpb24NCn0NCg0KLy8gSGFuZGxlIG1vdXNlIHdoZWVsIHpvb20NCmZ1bmN0aW9uIGhhbmRsZU1vdXNlV2hlZWwoZSkgew0KICAgIGlmIChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgDQogICAgICAgIC8vIFRocm90dGxlIHdoZWVsIGV2ZW50cyB0byBwcmV2ZW50IG92ZXJ3aGVsbWluZyB0aGUgc3lzdGVtDQogICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7DQogICAgICAgIGlmIChmbG93RWRpdG9yLmxhc3RXaGVlbFRpbWUgJiYgbm93IC0gZmxvd0VkaXRvci5sYXN0V2hlZWxUaW1lIDwgMTYpIHsNCiAgICAgICAgICAgIHJldHVybjsgLy8gTGltaXQgdG8gfjYwZnBzDQogICAgICAgIH0NCiAgICAgICAgZmxvd0VkaXRvci5sYXN0V2hlZWxUaW1lID0gbm93Ow0KICAgICAgICANCiAgICAgICAgLy8gR2V0IG1vdXNlIHBvc2l0aW9uIHJlbGF0aXZlIHRvIGNvbnRhaW5lcg0KICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8NCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6DQogICAgICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICAgIA0KICAgICAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8NCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6DQogICAgICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgICAgIA0KICAgICAgICBjb25zdCBtb3VzZVggPSBtb3VzZUNvb3Jkcy54IC0gY29udGFpbmVyUmVjdC5sZWZ0Ow0KICAgICAgICBjb25zdCBtb3VzZVkgPSBtb3VzZUNvb3Jkcy55IC0gY29udGFpbmVyUmVjdC50b3A7DQogICAgICAgIA0KICAgICAgICAvLyBDYWxjdWxhdGUgem9vbSBkZWx0YQ0KICAgICAgICBjb25zdCB6b29tRGVsdGEgPSBlLmRlbHRhWSA+IDAgPyAtZmxvd0VkaXRvci56b29tU3RlcCA6IGZsb3dFZGl0b3Iuem9vbVN0ZXA7DQogICAgICAgIGNvbnN0IG5ld1pvb20gPSBNYXRoLm1heChmbG93RWRpdG9yLm1pblpvb20sIE1hdGgubWluKGZsb3dFZGl0b3IubWF4Wm9vbSwgZmxvd0VkaXRvci56b29tTGV2ZWwgKyB6b29tRGVsdGEpKTsNCiAgICAgICAgDQogICAgICAgIGlmIChuZXdab29tICE9PSBmbG93RWRpdG9yLnpvb21MZXZlbCkgew0KICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSBwb2ludCBpbiBjYW52YXMgY29vcmRpbmF0ZXMgdGhhdCBzaG91bGQgcmVtYWluIGZpeGVkICh1bmRlciBtb3VzZSkNCiAgICAgICAgICAgIGNvbnN0IGNhbnZhc1ggPSAobW91c2VYIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueCkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIGNvbnN0IGNhbnZhc1kgPSAobW91c2VZIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gVXBkYXRlIHpvb20gbGV2ZWwNCiAgICAgICAgICAgIGZsb3dFZGl0b3Iuem9vbUxldmVsID0gbmV3Wm9vbTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQWRqdXN0IHBhbiBvZmZzZXQgdG8ga2VlcCB0aGUgbW91c2UgcG9pbnQgZml4ZWQNCiAgICAgICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnggPSBtb3VzZVggLSBjYW52YXNYICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC55ID0gbW91c2VZIC0gY2FudmFzWSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ29uc29saWRhdGVkIHJlZHJhdyB0aW1pbmcgd2l0aCBkZWJvdW5jaW5nDQogICAgICAgICAgICBjbGVhclRpbWVvdXQoZmxvd0VkaXRvci56b29tUmVkcmF3VGltZW91dCk7DQogICAgICAgICAgICBmbG93RWRpdG9yLnpvb21SZWRyYXdUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICAgICAgICAgIH0sIDEwMCk7IC8vIEluY3JlYXNlZCBkZWJvdW5jZSB0aW1lIGZvciB3aGVlbCB6b29taW5nDQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIEhhbmRsZSBjYW52YXMgY2xpY2sgZXZlbnRzDQpmdW5jdGlvbiBoYW5kbGVDYW52YXNDbGljayhlKSB7DQogICAgaWYgKGUudGFyZ2V0ID09PSBmbG93RWRpdG9yLmNhbnZhcykgew0KICAgICAgICAvLyBEZXNlbGVjdCBub2RlDQogICAgICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSkgew0KICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSk7DQogICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7DQogICAgICAgICAgICBmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9IG51bGw7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZS1jb25maWcnKS5pbm5lckhUTUwgPSAnPHAgY2xhc3M9InRleHQtbXV0ZWQiPlNlbGVjdCBhIG5vZGUgdG8gY29uZmlndXJlIGl0PC9wPic7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIEhhbmRsZSBkb2N1bWVudCBtb3VzZSBldmVudHMgZm9yIHNtb290aCBkcmFnZ2luZw0KZnVuY3Rpb24gaGFuZGxlRG9jdW1lbnRNb3VzZURvd24oZSkgew0KICAgIC8vIERvbid0IHN0YXJ0IGRyYWdnaW5nIGlmIGNsaWNraW5nIG9uIFVJIGVsZW1lbnRzDQogICAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy5mbG93LXRvb2xiYXInKSB8fCANCiAgICAgICAgZS50YXJnZXQuY2xvc2VzdCgnLmZsb3ctY29uZmlnLXBhbmVsJykgfHwgDQogICAgICAgIGUudGFyZ2V0LmNsb3Nlc3QoJy5mbG93LW91dHB1dC1wYW5lbCcpIHx8DQogICAgICAgIGUudGFyZ2V0LmNsb3Nlc3QoJy5ub2RlLWRlbGV0ZS1idG4nKSkgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIERvbid0IHN0YXJ0IGRyYWdnaW5nIGlmIHdlJ3JlIHBhbm5pbmcNCiAgICBpZiAoZmxvd0VkaXRvci5pc1Bhbm5pbmcpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBPbmx5IGFsbG93IGRyYWdnaW5nIGZyb20gdGhlIG5vZGUgaGVhZGVyDQogICAgY29uc3QgaGVhZGVyRWxlbWVudCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5mbG93LW5vZGUtaGVhZGVyJyk7DQogICAgaWYgKCFoZWFkZXJFbGVtZW50KSByZXR1cm47DQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBoZWFkZXJFbGVtZW50LmNsb3Nlc3QoJy5mbG93LW5vZGUnKTsNCiAgICBpZiAoIW5vZGVFbGVtZW50KSByZXR1cm47DQogICAgDQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgY29uc3Qgbm9kZUlkID0gbm9kZUVsZW1lbnQuaWQ7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgDQogICAgaWYgKG5vZGUpIHsNCiAgICAgICAgZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUgPSBub2RlSWQ7DQogICAgICAgIA0KICAgICAgICAvLyBDYWxjdWxhdGUgb2Zmc2V0IGZyb20gbW91c2UgdG8gbm9kZSBjb3JuZXIsIGFjY291bnRpbmcgZm9yIHpvb20NCiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDogDQogICAgICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICAgIA0KICAgICAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8gDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOiANCiAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgDQogICAgICAgIC8vIENvbnZlcnQgbW91c2UgcG9zaXRpb24gdG8gY2FudmFzIGNvb3JkaW5hdGVzDQogICAgICAgIGNvbnN0IGNhbnZhc01vdXNlWCA9IChtb3VzZUNvb3Jkcy54IC0gY29udGFpbmVyUmVjdC5sZWZ0IC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueCkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgY29uc3QgY2FudmFzTW91c2VZID0gKG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgIA0KICAgICAgICAvLyBDYWxjdWxhdGUgb2Zmc2V0IGluIGNhbnZhcyBjb29yZGluYXRlcw0KICAgICAgICBmbG93RWRpdG9yLmRyYWdPZmZzZXQgPSB7DQogICAgICAgICAgICB4OiAoY2FudmFzTW91c2VYIC0gbm9kZS54KSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsLA0KICAgICAgICAgICAgeTogKGNhbnZhc01vdXNlWSAtIG5vZGUueSkgKiBmbG93RWRpdG9yLnpvb21MZXZlbA0KICAgICAgICB9Ow0KICAgICAgICANCiAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ2dyYWJiaW5nJzsNCiAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUuekluZGV4ID0gJzEwMDAnOyAvLyBCcmluZyB0byBmcm9udCB3aGlsZSBkcmFnZ2luZw0KICAgICAgICANCiAgICAgICAgLy8gQ2FjaGUgY29udGFpbmVyIHJlY3QgZm9yIHBlcmZvcm1hbmNlDQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzUmVjdCA9IGNvbnRhaW5lclJlY3Q7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBoYW5kbGVEb2N1bWVudE1vdXNlTW92ZShlKSB7DQogICAgLy8gSGFuZGxlIGNhbnZhcyBwYW5uaW5nDQogICAgaWYgKGZsb3dFZGl0b3IuaXNQYW5uaW5nKSB7DQogICAgICAgIHVwZGF0ZUNhbnZhc1BhbihlKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBHZXQgc2NhbGVkIGNvb3JkaW5hdGVzDQogICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/IA0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOiANCiAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgIA0KICAgIC8vIEhhbmRsZSB0YWcgZHJhZ2dpbmcNCiAgICBpZiAoZmxvd0VkaXRvci5kcmFnZ2luZ1RhZyAmJiBmbG93RWRpdG9yLnRhZ0RyYWdPZmZzZXQpIHsNCiAgICAgICAgY29uc3QgdGFnID0gZmxvd0VkaXRvci50YWdzLmdldChmbG93RWRpdG9yLmRyYWdnaW5nVGFnKTsNCiAgICAgICAgaWYgKHRhZykgew0KICAgICAgICAgICAgLy8gR2V0IGNvbnRhaW5lciBkaW1lbnNpb25zIGZvciBjb29yZGluYXRlIGNvbnZlcnNpb24NCiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8gDQogICAgICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDogDQogICAgICAgICAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDb252ZXJ0IG1vdXNlIGNvb3JkaW5hdGVzIHRvIGNhbnZhcyBjb29yZGluYXRlcywgYWNjb3VudGluZyBmb3IgcGFuIGFuZCB6b29tDQogICAgICAgICAgICBjb25zdCBjYW52YXNNb3VzZVggPSAobW91c2VDb29yZHMueCAtIGNvbnRhaW5lclJlY3QubGVmdCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICBjb25zdCBjYW52YXNNb3VzZVkgPSAobW91c2VDb29yZHMueSAtIGNvbnRhaW5lclJlY3QudG9wIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBwb3NpdGlvbiB3aXRoIG9mZnNldCAoZHJhZyBvZmZzZXQgaXMgYWxzbyBpbiBzY3JlZW4gY29vcmRpbmF0ZXMsIHNvIGNvbnZlcnQgaXQpDQogICAgICAgICAgICBjb25zdCBkcmFnT2Zmc2V0WCA9IGZsb3dFZGl0b3IudGFnRHJhZ09mZnNldC54IC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICBjb25zdCBkcmFnT2Zmc2V0WSA9IGZsb3dFZGl0b3IudGFnRHJhZ09mZnNldC55IC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIHRhZy54ID0gY2FudmFzTW91c2VYIC0gZHJhZ09mZnNldFg7DQogICAgICAgICAgICB0YWcueSA9IGNhbnZhc01vdXNlWSAtIGRyYWdPZmZzZXRZOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCB0YWdFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmxvd0VkaXRvci5kcmFnZ2luZ1RhZyk7DQogICAgICAgICAgICBpZiAodGFnRWxlbWVudCkgew0KICAgICAgICAgICAgICAgIC8vIFVzZSBsZWZ0L3RvcCBmb3IgcG9zaXRpb25pbmcNCiAgICAgICAgICAgICAgICB0YWdFbGVtZW50LnN0eWxlLmxlZnQgPSB0YWcueCArICdweCc7DQogICAgICAgICAgICAgICAgdGFnRWxlbWVudC5zdHlsZS50b3AgPSB0YWcueSArICdweCc7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFRocm90dGxlIHVwZGF0ZXMgZm9yIGJldHRlciBwZXJmb3JtYW5jZQ0KICAgICAgICAgICAgaWYgKCFmbG93RWRpdG9yLnRhZ1VwZGF0ZVRpbWVvdXQpIHsNCiAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnRhZ1VwZGF0ZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci50YWdVcGRhdGVUaW1lb3V0ID0gbnVsbDsNCiAgICAgICAgICAgICAgICB9LCAxNik7IC8vIH42MGZwcw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgaWYgKGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlICYmIGZsb3dFZGl0b3IuZHJhZ09mZnNldCkgew0KICAgICAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUpOw0KICAgICAgICBpZiAobm9kZSkgew0KICAgICAgICAgICAgLy8gR2V0IGNvbnRhaW5lciBkaW1lbnNpb25zIGZvciBjb29yZGluYXRlIGNvbnZlcnNpb24NCiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8gDQogICAgICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDogDQogICAgICAgICAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDb252ZXJ0IG1vdXNlIGNvb3JkaW5hdGVzIHRvIGNhbnZhcyBjb29yZGluYXRlcywgYWNjb3VudGluZyBmb3IgcGFuIGFuZCB6b29tDQogICAgICAgICAgICBjb25zdCBjYW52YXNNb3VzZVggPSAobW91c2VDb29yZHMueCAtIGNvbnRhaW5lclJlY3QubGVmdCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICBjb25zdCBjYW52YXNNb3VzZVkgPSAobW91c2VDb29yZHMueSAtIGNvbnRhaW5lclJlY3QudG9wIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBwb3NpdGlvbiB3aXRoIG9mZnNldCAoZHJhZyBvZmZzZXQgaXMgYWxzbyBpbiBzY3JlZW4gY29vcmRpbmF0ZXMsIHNvIGNvbnZlcnQgaXQpDQogICAgICAgICAgICBjb25zdCBkcmFnT2Zmc2V0WCA9IGZsb3dFZGl0b3IuZHJhZ09mZnNldC54IC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICBjb25zdCBkcmFnT2Zmc2V0WSA9IGZsb3dFZGl0b3IuZHJhZ09mZnNldC55IC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIG5vZGUueCA9IGNhbnZhc01vdXNlWCAtIGRyYWdPZmZzZXRYOw0KICAgICAgICAgICAgbm9kZS55ID0gY2FudmFzTW91c2VZIC0gZHJhZ09mZnNldFk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUpOw0KICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUubGVmdCA9IG5vZGUueCArICdweCc7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUudG9wID0gbm9kZS55ICsgJ3B4JzsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgYWxsIGNvbm5lY3Rpb25zIGZvciB0aGlzIG5vZGUgKHRocm90dGxlZCBmb3IgcGVyZm9ybWFuY2UpDQogICAgICAgICAgICAgICAgaWYgKCFmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQpIHsNCiAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVDb25uZWN0aW9uc0Zvck5vZGUobm9kZS5pZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9LCAxNik7IC8vIH42MGZwcw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gaGFuZGxlRG9jdW1lbnRNb3VzZVVwKGUpIHsNCiAgICAvLyBIYW5kbGUgY2FudmFzIHBhbm5pbmcgc3RvcA0KICAgIGlmIChmbG93RWRpdG9yLmlzUGFubmluZykgew0KICAgICAgICBzdG9wQ2FudmFzUGFuKCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gSGFuZGxlIHRhZyBkcmFnZ2luZyBzdG9wDQogICAgaWYgKGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcpIHsNCiAgICAgICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcpOw0KICAgICAgICBpZiAodGFnRWxlbWVudCkgew0KICAgICAgICAgICAgdGFnRWxlbWVudC5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7DQogICAgICAgICAgICB0YWdFbGVtZW50LnN0eWxlLnpJbmRleCA9ICcxMDAnOw0KICAgICAgICAgICAgdGFnRWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gJ2JveC1zaGFkb3cgMC4ycyBlYXNlLCB0cmFuc2Zvcm0gMC4ycyBlYXNlJzsgLy8gUmVzdG9yZSB0cmFuc2l0aW9ucw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBmbG93RWRpdG9yLmRyYWdnaW5nVGFnID0gbnVsbDsNCiAgICAgICAgZmxvd0VkaXRvci50YWdEcmFnT2Zmc2V0ID0gbnVsbDsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBpZiAoZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUpIHsNCiAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSk7DQogICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ2dyYWInOw0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUuekluZGV4ID0gJyc7IC8vIFJlc2V0IHotaW5kZXgNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgYW55IHBlbmRpbmcgY29ubmVjdGlvbiB1cGRhdGVzDQogICAgICAgIGlmIChmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQpIHsNCiAgICAgICAgICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0ID0gbnVsbDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gRmluYWwgY29ubmVjdGlvbiB1cGRhdGUNCiAgICAgICAgdXBkYXRlQ29ubmVjdGlvbnNGb3JOb2RlKGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKTsNCiAgICAgICAgDQogICAgICAgIGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlID0gbnVsbDsNCiAgICAgICAgZmxvd0VkaXRvci5kcmFnT2Zmc2V0ID0gbnVsbDsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXNSZWN0ID0gbnVsbDsNCiAgICB9DQp9DQoNCg0KLy8gRXhhbXBsZTogY2FudmFzLW1hbmFnZXIuanMNCnN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyID0gew0KICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSwNCiAgICBzdGFydENhbnZhc1BhbiwNCiAgICB1cGRhdGVDYW52YXNQYW4sDQogICAgc3RvcENhbnZhc1BhbiwNCiAgICByZXNldENhbnZhc1BhbiwNCiAgICBoYW5kbGVDYW52YXNDbGljaywNCiAgICBoYW5kbGVEb2N1bWVudE1vdXNlRG93biwNCiAgICBoYW5kbGVEb2N1bWVudE1vdXNlTW92ZSwNCiAgICBoYW5kbGVEb2N1bWVudE1vdXNlVXAsDQogICAgem9vbUluLA0KICAgIHpvb21PdXQsDQogICAgc2V0Wm9vbUxldmVsLA0KICAgIHpvb21Ub0ZpdCwNCiAgICBoYW5kbGVNb3VzZVdoZWVsDQp9Ow0KDQoNCi8vIEFkZCBhIG5ldyB0YWcgYXQgY3VycmVudCB2aWV3cG9ydCBjZW50ZXINCmFzeW5jIGZ1bmN0aW9uIGFkZFRhZygpIHsNCiAgICBjb25zdCB0YWdOYW1lID0gYXdhaXQgc3lwbmV4QVBJLnNob3dJbnB1dE1vZGFsKA0KICAgICAgICAnQ3JlYXRlIE5ldyBUYWcnLA0KICAgICAgICAnVGFnIE5hbWU6JywNCiAgICAgICAgew0KICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICdFbnRlciB0YWcgbmFtZScsDQogICAgICAgICAgICBjb25maXJtVGV4dDogJ0NyZWF0ZSBUYWcnLA0KICAgICAgICAgICAgY2FuY2VsVGV4dDogJ0NhbmNlbCcsDQogICAgICAgICAgICBpY29uOiAnZmFzIGZhLXRhZycNCiAgICAgICAgfQ0KICAgICk7DQogICAgDQogICAgaWYgKCF0YWdOYW1lIHx8IHRhZ05hbWUudHJpbSgpID09PSAnJykgcmV0dXJuOw0KDQogICAgY29uc3QgdGFnSWQgPSBgdGFnXyR7KytmbG93RWRpdG9yLnRhZ0NvdW50ZXJ9YDsNCg0KICAgIC8vIENhbGN1bGF0ZSBwb3NpdGlvbiBhdCBjdXJyZW50IHZpZXdwb3J0IGNlbnRlcg0KICAgIC8vIEdldCBjZW50ZXIgcG9zaXRpb24gaW4gY2FudmFzIGNvb3JkaW5hdGVzDQogICAgY29uc3QgY2VudGVyID0gc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JVdGlscyA/IA0KICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzLmdldFZpZXdwb3J0Q2VudGVySW5DYW52YXMoKSA6DQogICAgICAgIHsgeDogNTAwMCwgeTogNTAwMCB9OyAvLyBGYWxsYmFjayB0byBjYW52YXMgY2VudGVyDQoNCiAgICBjb25zdCB0YWcgPSB7DQogICAgICAgIGlkOiB0YWdJZCwNCiAgICAgICAgbmFtZTogdGFnTmFtZS50cmltKCksDQogICAgICAgIGRlc2NyaXB0aW9uOiAnJywNCiAgICAgICAgeDogY2VudGVyLngsDQogICAgICAgIHk6IGNlbnRlci55LA0KICAgICAgICBjb2xvcjogJyM0Q0FGNTAnIC8vIEdyZWVuIGNvbG9yDQogICAgfTsNCg0KICAgIGZsb3dFZGl0b3IudGFncy5zZXQodGFnSWQsIHRhZyk7DQogICAgY3JlYXRlVGFnRWxlbWVudCh0YWcpOw0KICAgIHVwZGF0ZVRhZ1BhbmVsKCk7DQoNCn0NCg0KLy8gQ3JlYXRlIHRhZyBlbGVtZW50IG9uIGNhbnZhcw0KZnVuY3Rpb24gY3JlYXRlVGFnRWxlbWVudCh0YWcpIHsNCiAgICBjb25zdCB0YWdFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgdGFnRWxlbWVudC5pZCA9IHRhZy5pZDsNCiAgICB0YWdFbGVtZW50LmNsYXNzTmFtZSA9ICdjYW52YXMtdGFnJzsNCiAgICB0YWdFbGVtZW50LnN0eWxlLmNzc1RleHQgPSBgDQogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgbGVmdDogJHt0YWcueH1weDsNCiAgICAgICAgdG9wOiAke3RhZy55fXB4Ow0KICAgICAgICBiYWNrZ3JvdW5kOiAke3RhZy5jb2xvcn07DQogICAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgICAgcGFkZGluZzogNHB4IDhweDsNCiAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgICAgICBmb250LXdlaWdodDogNTAwOw0KICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAgIHVzZXItc2VsZWN0OiBub25lOw0KICAgICAgICB6LWluZGV4OiAxMDA7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsMCwwLDAuMik7DQogICAgICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4ycyBlYXNlLCB0cmFuc2Zvcm0gMC4ycyBlYXNlOw0KICAgIGA7DQogICAgdGFnRWxlbWVudC50ZXh0Q29udGVudCA9IHRhZy5uYW1lOw0KDQogICAgLy8gTWFrZSB0YWcgZHJhZ2dhYmxlDQogICAgdGFnRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZSkgPT4gew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgIHN0YXJ0RHJhZ2dpbmdUYWcodGFnLmlkLCBlKTsNCiAgICB9KTsNCg0KICAgIC8vIENsaWNrIHRvIGp1bXAgdG8gdGFnDQogICAgdGFnRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgIGlmICghZmxvd0VkaXRvci5kcmFnZ2luZ1RhZykgew0KICAgICAgICAgICAganVtcFRvVGFnKHRhZy5pZCk7DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgIC8vIEhvdmVyIGVmZmVjdHMNCiAgICB0YWdFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7DQogICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDEuMDUpJzsNCiAgICAgICAgdGFnRWxlbWVudC5zdHlsZS5ib3hTaGFkb3cgPSAnMCA0cHggOHB4IHJnYmEoMCwwLDAsMC4zKSc7DQogICAgfSk7DQoNCiAgICB0YWdFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7DQogICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDEpJzsNCiAgICAgICAgdGFnRWxlbWVudC5zdHlsZS5ib3hTaGFkb3cgPSAnMCAycHggNHB4IHJnYmEoMCwwLDAsMC4yKSc7DQogICAgfSk7DQoNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5hcHBlbmRDaGlsZCh0YWdFbGVtZW50KTsNCn0NCg0KLy8gU3RhcnQgZHJhZ2dpbmcgYSB0YWcNCmZ1bmN0aW9uIHN0YXJ0RHJhZ2dpbmdUYWcodGFnSWQsIGUpIHsNCiAgICBjb25zdCB0YWcgPSBmbG93RWRpdG9yLnRhZ3MuZ2V0KHRhZ0lkKTsNCiAgICBpZiAoIXRhZykgcmV0dXJuOw0KDQogICAgZmxvd0VkaXRvci5kcmFnZ2luZ1RhZyA9IHRhZ0lkOw0KDQogICAgLy8gQ2FsY3VsYXRlIG9mZnNldCBmcm9tIG1vdXNlIHRvIHRhZyBjb3JuZXIsIGFjY291bnRpbmcgZm9yIHpvb20NCiAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPyANCiAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDogDQogICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICANCiAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8gDQogICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6IA0KICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgDQogICAgLy8gQ29udmVydCBtb3VzZSBwb3NpdGlvbiB0byBjYW52YXMgY29vcmRpbmF0ZXMNCiAgICBjb25zdCBjYW52YXNNb3VzZVggPSAobW91c2VDb29yZHMueCAtIGNvbnRhaW5lclJlY3QubGVmdCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgY29uc3QgY2FudmFzTW91c2VZID0gKG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgDQogICAgLy8gQ2FsY3VsYXRlIG9mZnNldCBpbiBjYW52YXMgY29vcmRpbmF0ZXMNCiAgICBmbG93RWRpdG9yLnRhZ0RyYWdPZmZzZXQgPSB7DQogICAgICAgIHg6IChjYW52YXNNb3VzZVggLSB0YWcueCkgKiBmbG93RWRpdG9yLnpvb21MZXZlbCwNCiAgICAgICAgeTogKGNhbnZhc01vdXNlWSAtIHRhZy55KSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsDQogICAgfTsNCg0KICAgIGNvbnN0IHRhZ0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWdJZCk7DQogICAgdGFnRWxlbWVudC5zdHlsZS5jdXJzb3IgPSAnZ3JhYmJpbmcnOw0KICAgIHRhZ0VsZW1lbnQuc3R5bGUuekluZGV4ID0gJzEwMDEnOw0KICAgIHRhZ0VsZW1lbnQuc3R5bGUudHJhbnNpdGlvbiA9ICdub25lJzsgLy8gRGlzYWJsZSB0cmFuc2l0aW9ucyBkdXJpbmcgZHJhZw0KfQ0KDQovLyBKdW1wIHRvIHRhZyBsb2NhdGlvbg0KZnVuY3Rpb24ganVtcFRvVGFnKHRhZ0lkKSB7DQogICAgY29uc3QgdGFnID0gZmxvd0VkaXRvci50YWdzLmdldCh0YWdJZCk7DQogICAgaWYgKCF0YWcpIHJldHVybjsNCg0KICAgIC8vIEFkZCBzbW9vdGggdHJhbnNpdGlvbg0KICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zaXRpb24gPSAndHJhbnNmb3JtIDAuNXMgZWFzZS1vdXQnOw0KDQogICAgLy8gVXNlIHV0aWxpdHkgZnVuY3Rpb24gdG8gY2VudGVyIHZpZXdwb3J0IG9uIHRhZyBjb29yZGluYXRlcw0KICAgIGlmIChzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzICYmIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVXRpbHMuY2VudGVyVmlld3BvcnRPbkNhbnZhcykgew0KICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzLmNlbnRlclZpZXdwb3J0T25DYW52YXModGFnLngsIHRhZy55KTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBGYWxsYmFjayBtZXRob2QNCiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOw0KICAgICAgICBjb25zdCB2aWV3cG9ydENlbnRlclkgPSBjb250YWluZXJSZWN0LmhlaWdodCAvIDI7DQogICAgICAgIA0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gdmlld3BvcnRDZW50ZXJYIC0gKHRhZy54ICogZmxvd0VkaXRvci56b29tTGV2ZWwpOw0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC55ID0gdmlld3BvcnRDZW50ZXJZIC0gKHRhZy55ICogZmxvd0VkaXRvci56b29tTGV2ZWwpOw0KICAgICAgICANCiAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgfQ0KDQogICAgLy8gUmVtb3ZlIHRyYW5zaXRpb24gYWZ0ZXIgYW5pbWF0aW9uIGNvbXBsZXRlcw0KICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS50cmFuc2l0aW9uID0gJyc7DQogICAgfSwgNTAwKTsNCn0NCg0KLy8gVXBkYXRlIHRhZyBwYW5lbA0KZnVuY3Rpb24gdXBkYXRlVGFnUGFuZWwoKSB7DQogICAgY29uc3QgdGFnUGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFnLXBhbmVsJyk7DQogICAgaWYgKCF0YWdQYW5lbCkgcmV0dXJuOw0KDQogICAgaWYgKGZsb3dFZGl0b3IudGFncy5zaXplID09PSAwKSB7DQogICAgICAgIHRhZ1BhbmVsLmlubmVySFRNTCA9ICc8cCBjbGFzcz0idGV4dC1tdXRlZCI+Tm8gdGFncyB5ZXQ8L3A+JzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGxldCB0YWdIdG1sID0gJyc7DQogICAgZmxvd0VkaXRvci50YWdzLmZvckVhY2godGFnID0+IHsNCiAgICAgICAgdGFnSHRtbCArPSBgDQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWctaXRlbSIgZGF0YS10YWctaWQ9IiR7dGFnLmlkfSI+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFnLWNvbG9yIiBzdHlsZT0iYmFja2dyb3VuZDogJHt0YWcuY29sb3J9Ij48L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWctaW5mbyI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRhZy1uYW1lIj4ke3RhZy5uYW1lfTwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAke3RhZy5kZXNjcmlwdGlvbiA/IGA8ZGl2IGNsYXNzPSJ0YWctZGVzY3JpcHRpb24iPiR7dGFnLmRlc2NyaXB0aW9ufTwvZGl2PmAgOiAnJ30NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ0YWctZGVsZXRlIiBkYXRhLXRhZy1pZD0iJHt0YWcuaWR9Ij4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS10aW1lcyI+PC9pPg0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgIGA7DQogICAgfSk7DQoNCiAgICB0YWdQYW5lbC5pbm5lckhUTUwgPSB0YWdIdG1sOw0KDQogICAgLy8gQWRkIGV2ZW50IGxpc3RlbmVycw0KICAgIHRhZ1BhbmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWctaXRlbScpLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgaWYgKCFlLnRhcmdldC5jbG9zZXN0KCcudGFnLWRlbGV0ZScpKSB7DQogICAgICAgICAgICAgICAgY29uc3QgdGFnSWQgPSBpdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS10YWctaWQnKTsNCiAgICAgICAgICAgICAgICBqdW1wVG9UYWcodGFnSWQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9KTsNCg0KICAgIHRhZ1BhbmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWctZGVsZXRlJykuZm9yRWFjaChidG4gPT4gew0KICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgIGNvbnN0IHRhZ0lkID0gYnRuLmdldEF0dHJpYnV0ZSgnZGF0YS10YWctaWQnKTsNCiAgICAgICAgICAgIGRlbGV0ZVRhZyh0YWdJZCk7DQogICAgICAgIH0pOw0KICAgIH0pOw0KfQ0KDQovLyBEZWxldGUgYSB0YWcNCmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVRhZyh0YWdJZCkgew0KICAgIGNvbnN0IGNvbmZpcm1lZCA9IGF3YWl0IHN5cG5leEFQSS5zaG93Q29uZmlybWF0aW9uKA0KICAgICAgICAnRGVsZXRlIFRhZycsDQogICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgdGFnPycsDQogICAgICAgIHsNCiAgICAgICAgICAgIHR5cGU6ICdkYW5nZXInLA0KICAgICAgICAgICAgY29uZmlybVRleHQ6ICdEZWxldGUnLA0KICAgICAgICAgICAgY2FuY2VsVGV4dDogJ0NhbmNlbCcsDQogICAgICAgICAgICBpY29uOiAnZmFzIGZhLXRhZycNCiAgICAgICAgfQ0KICAgICk7DQogICAgDQogICAgaWYgKGNvbmZpcm1lZCkgew0KICAgICAgICBjb25zdCB0YWdFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFnSWQpOw0KICAgICAgICBpZiAodGFnRWxlbWVudCkgew0KICAgICAgICAgICAgdGFnRWxlbWVudC5yZW1vdmUoKTsNCiAgICAgICAgfQ0KICAgICAgICBmbG93RWRpdG9yLnRhZ3MuZGVsZXRlKHRhZ0lkKTsNCiAgICAgICAgdXBkYXRlVGFnUGFuZWwoKTsNCiAgICB9DQp9DQoNCi8vIEV4YW1wbGU6IHRhZy1tYW5hZ2VyLmpzDQpzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkudGFnTWFuYWdlciA9IHsNCiAgICBhZGRUYWcsDQogICAgY3JlYXRlVGFnRWxlbWVudCwNCiAgICBzdGFydERyYWdnaW5nVGFnLA0KICAgIGp1bXBUb1RhZywNCiAgICB1cGRhdGVUYWdQYW5lbCwNCiAgICBkZWxldGVUYWcNCn07DQoNCi8vIEVuY3J5cHQgc2Vuc2l0aXZlIHZhbHVlcyBpbiBub2RlIGNvbmZpZyBiZWZvcmUgc2F2aW5nDQphc3luYyBmdW5jdGlvbiBlbmNyeXB0Tm9kZUNvbmZpZyhub2RlQ29uZmlnLCBub2RlVHlwZSkgew0KICAgIGlmICghc3lwbmV4QVBJIHx8ICFzeXBuZXhBUEkuZW5jcnlwdCkgew0KICAgICAgICByZXR1cm4gbm9kZUNvbmZpZzsgLy8gTm8gZW5jcnlwdGlvbiBhdmFpbGFibGUNCiAgICB9DQogICAgDQogICAgLy8gR2V0IG5vZGUgZGVmaW5pdGlvbiB0byBjaGVjayBmb3IgZW5jcnlwdGVkIGZpZWxkcw0KICAgIGNvbnN0IG5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZVR5cGUpOw0KICAgIGlmICghbm9kZURlZiB8fCAhbm9kZURlZi5jb25maWcpIHsNCiAgICAgICAgcmV0dXJuIG5vZGVDb25maWc7DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGVuY3J5cHRlZENvbmZpZyA9IHt9Ow0KICAgIA0KICAgIGZvciAoY29uc3QgW2ZpZWxkTmFtZSwgZmllbGRDb25maWddIG9mIE9iamVjdC5lbnRyaWVzKG5vZGVDb25maWcpKSB7DQogICAgICAgIGNvbnN0IGNvbmZpZ0RlZiA9IG5vZGVEZWYuY29uZmlnW2ZpZWxkTmFtZV07IC8vIEFjY2VzcyBhcyBvYmplY3QgcHJvcGVydHksIG5vdCBhcnJheQ0KICAgICAgICANCiAgICAgICAgaWYgKGNvbmZpZ0RlZiAmJiBjb25maWdEZWYuZW5jcnlwdCA9PT0gdHJ1ZSAmJiBmaWVsZENvbmZpZy52YWx1ZSkgew0KICAgICAgICAgICAgLy8gRW5jcnlwdCB0aGUgdmFsdWUNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgY29uc3QgZW5jcnlwdGVkVmFsdWUgPSBhd2FpdCBzeXBuZXhBUEkuZW5jcnlwdChmaWVsZENvbmZpZy52YWx1ZSk7DQogICAgICAgICAgICAgICAgZW5jcnlwdGVkQ29uZmlnW2ZpZWxkTmFtZV0gPSB7DQogICAgICAgICAgICAgICAgICAgIC4uLmZpZWxkQ29uZmlnLA0KICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZW5jcnlwdGVkVmFsdWUNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gZW5jcnlwdCBmaWVsZCAke2ZpZWxkTmFtZX06YCwgZXJyb3IpOw0KICAgICAgICAgICAgICAgIGVuY3J5cHRlZENvbmZpZ1tmaWVsZE5hbWVdID0gZmllbGRDb25maWc7IC8vIEtlZXAgb3JpZ2luYWwgaWYgZW5jcnlwdGlvbiBmYWlscw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgZW5jcnlwdGVkQ29uZmlnW2ZpZWxkTmFtZV0gPSBmaWVsZENvbmZpZzsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICByZXR1cm4gZW5jcnlwdGVkQ29uZmlnOw0KfQ0KDQovLyBEZWNyeXB0IHNlbnNpdGl2ZSB2YWx1ZXMgaW4gbm9kZSBjb25maWcgYWZ0ZXIgbG9hZGluZw0KYXN5bmMgZnVuY3Rpb24gZGVjcnlwdE5vZGVDb25maWcobm9kZUNvbmZpZywgbm9kZVR5cGUpIHsNCiAgICBpZiAoIXN5cG5leEFQSSB8fCAhc3lwbmV4QVBJLmRlY3J5cHQpIHsNCiAgICAgICAgcmV0dXJuIG5vZGVDb25maWc7IC8vIE5vIGRlY3J5cHRpb24gYXZhaWxhYmxlDQogICAgfQ0KICAgIA0KICAgIC8vIEdldCBub2RlIGRlZmluaXRpb24gdG8gY2hlY2sgZm9yIGVuY3J5cHRlZCBmaWVsZHMNCiAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGVUeXBlKTsNCiAgICBpZiAoIW5vZGVEZWYgfHwgIW5vZGVEZWYuY29uZmlnKSB7DQogICAgICAgIHJldHVybiBub2RlQ29uZmlnOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBkZWNyeXB0ZWRDb25maWcgPSB7fTsNCiAgICANCiAgICBmb3IgKGNvbnN0IFtmaWVsZE5hbWUsIGZpZWxkQ29uZmlnXSBvZiBPYmplY3QuZW50cmllcyhub2RlQ29uZmlnKSkgew0KICAgICAgICBjb25zdCBjb25maWdEZWYgPSBub2RlRGVmLmNvbmZpZ1tmaWVsZE5hbWVdOyAvLyBBY2Nlc3MgYXMgb2JqZWN0IHByb3BlcnR5LCBub3QgYXJyYXkNCiAgICAgICAgDQogICAgICAgIGlmIChjb25maWdEZWYgJiYgY29uZmlnRGVmLmVuY3J5cHQgPT09IHRydWUgJiYgZmllbGRDb25maWcudmFsdWUpIHsNCiAgICAgICAgICAgIC8vIERlY3J5cHQgdGhlIHZhbHVlDQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIGNvbnN0IGRlY3J5cHRlZFZhbHVlID0gYXdhaXQgc3lwbmV4QVBJLmRlY3J5cHQoZmllbGRDb25maWcudmFsdWUpOw0KICAgICAgICAgICAgICAgIGRlY3J5cHRlZENvbmZpZ1tmaWVsZE5hbWVdID0gew0KICAgICAgICAgICAgICAgICAgICAuLi5maWVsZENvbmZpZywNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGRlY3J5cHRlZFZhbHVlDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGRlY3J5cHQgZmllbGQgJHtmaWVsZE5hbWV9OmAsIGVycm9yKTsNCiAgICAgICAgICAgICAgICBkZWNyeXB0ZWRDb25maWdbZmllbGROYW1lXSA9IGZpZWxkQ29uZmlnOyAvLyBLZWVwIG9yaWdpbmFsIGlmIGRlY3J5cHRpb24gZmFpbHMNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGRlY3J5cHRlZENvbmZpZ1tmaWVsZE5hbWVdID0gZmllbGRDb25maWc7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIGRlY3J5cHRlZENvbmZpZzsNCn0NCg0KLy8gU2F2ZSBmbG93IHRvIHZpcnR1YWwgZmlsZSBzeXN0ZW0NCmFzeW5jIGZ1bmN0aW9uIHNhdmVGbG93KCkgew0KICAgIC8vIEVuY3J5cHQgc2Vuc2l0aXZlIGZpZWxkcyBiZWZvcmUgc2F2aW5nDQogICAgY29uc3QgZW5jcnlwdGVkTm9kZXMgPSBbXTsNCiAgICBmb3IgKGNvbnN0IG5vZGUgb2YgZmxvd0VkaXRvci5ub2Rlcy52YWx1ZXMoKSkgew0KICAgICAgICBjb25zdCBlbmNyeXB0ZWRDb25maWcgPSBhd2FpdCBlbmNyeXB0Tm9kZUNvbmZpZyhub2RlLmNvbmZpZywgbm9kZS50eXBlKTsNCiAgICAgICAgZW5jcnlwdGVkTm9kZXMucHVzaCh7DQogICAgICAgICAgICBpZDogbm9kZS5pZCwNCiAgICAgICAgICAgIHR5cGU6IG5vZGUudHlwZSwNCiAgICAgICAgICAgIHg6IG5vZGUueCwNCiAgICAgICAgICAgIHk6IG5vZGUueSwNCiAgICAgICAgICAgIGNvbmZpZzogZW5jcnlwdGVkQ29uZmlnDQogICAgICAgIH0pOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBmbG93RGF0YSA9IHsNCiAgICAgICAgbm9kZXM6IGVuY3J5cHRlZE5vZGVzLA0KICAgICAgICBjb25uZWN0aW9uczogQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5tYXAoY29ubiA9PiAoew0KICAgICAgICAgICAgaWQ6IGNvbm4uaWQsDQogICAgICAgICAgICBmcm9tOiBjb25uLmZyb20sDQogICAgICAgICAgICB0bzogY29ubi50bw0KICAgICAgICB9KSksDQogICAgICAgIHRhZ3M6IEFycmF5LmZyb20oZmxvd0VkaXRvci50YWdzLnZhbHVlcygpKSwNCiAgICAgICAgbWV0YWRhdGE6IHsNCiAgICAgICAgICAgIHNhdmVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwNCiAgICAgICAgICAgIG5vZGVDb3VudDogZmxvd0VkaXRvci5ub2Rlcy5zaXplLA0KICAgICAgICAgICAgY29ubmVjdGlvbkNvdW50OiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnNpemUsDQogICAgICAgICAgICB0YWdDb3VudDogZmxvd0VkaXRvci50YWdzLnNpemUNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICB0cnkgew0KICAgICAgICBsZXQgZmlsZVBhdGggPSBmbG93RWRpdG9yLmN1cnJlbnRGaWxlUGF0aDsNCiAgICAgICAgDQogICAgICAgIC8vIElmIG5vIGN1cnJlbnQgZmlsZSBwYXRoLCBzaG93IGZpbGUgZXhwbG9yZXINCiAgICAgICAgaWYgKCFmaWxlUGF0aCkgew0KICAgICAgICAgICAgZmlsZVBhdGggPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0ZpbGVFeHBsb3Jlcih7DQogICAgICAgICAgICAgICAgbW9kZTogJ3NhdmUnLA0KICAgICAgICAgICAgICAgIHRpdGxlOiAnU2F2ZSBGbG93IEZpbGUnLA0KICAgICAgICAgICAgICAgIGluaXRpYWxQYXRoOiAnLycsDQogICAgICAgICAgICAgICAgZmlsZU5hbWU6ICdmbG93X3dvcmtmbG93Lmpzb24nLA0KICAgICAgICAgICAgICAgIGZpbGVFeHRlbnNpb246ICcuanNvbicsDQogICAgICAgICAgICAgICAgb25TZWxlY3Q6IChzZWxlY3RlZFBhdGgpID0+IHsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgICAgICByZXR1cm47IC8vIFVzZXIgY2FuY2VsbGVkDQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyBTYXZlIHRvIHZpcnR1YWwgZmlsZSBzeXN0ZW0NCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZUpTT04pIHsNCiAgICAgICAgICAgIGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlSlNPTihmaWxlUGF0aCwgZmxvd0RhdGEpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGggPSBmaWxlUGF0aDsNCiAgICAgICAgICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZsb3cgc2F2ZWQgdG86ICR7ZmlsZVBhdGh9YCwgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgfQ0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIGZsb3c6JywgZXJyb3IpOw0KICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKSB7DQogICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignRmFpbGVkIHRvIHNhdmUgZmxvdzogJyArIGVycm9yLm1lc3NhZ2UsICdlcnJvcicpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBTYXZlIGZsb3cgYXMgKGFsd2F5cyBzaG93IGZpbGUgZXhwbG9yZXIpDQphc3luYyBmdW5jdGlvbiBzYXZlRmxvd0FzKCkgew0KICAgIC8vIEVuY3J5cHQgc2Vuc2l0aXZlIGZpZWxkcyBiZWZvcmUgc2F2aW5nDQogICAgY29uc3QgZW5jcnlwdGVkTm9kZXMgPSBbXTsNCiAgICBmb3IgKGNvbnN0IG5vZGUgb2YgZmxvd0VkaXRvci5ub2Rlcy52YWx1ZXMoKSkgew0KICAgICAgICBjb25zdCBlbmNyeXB0ZWRDb25maWcgPSBhd2FpdCBlbmNyeXB0Tm9kZUNvbmZpZyhub2RlLmNvbmZpZywgbm9kZS50eXBlKTsNCiAgICAgICAgZW5jcnlwdGVkTm9kZXMucHVzaCh7DQogICAgICAgICAgICBpZDogbm9kZS5pZCwNCiAgICAgICAgICAgIHR5cGU6IG5vZGUudHlwZSwNCiAgICAgICAgICAgIHg6IG5vZGUueCwNCiAgICAgICAgICAgIHk6IG5vZGUueSwNCiAgICAgICAgICAgIGNvbmZpZzogZW5jcnlwdGVkQ29uZmlnDQogICAgICAgIH0pOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBmbG93RGF0YSA9IHsNCiAgICAgICAgbm9kZXM6IGVuY3J5cHRlZE5vZGVzLA0KICAgICAgICBjb25uZWN0aW9uczogQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5tYXAoY29ubiA9PiAoew0KICAgICAgICAgICAgaWQ6IGNvbm4uaWQsDQogICAgICAgICAgICBmcm9tOiBjb25uLmZyb20sDQogICAgICAgICAgICB0bzogY29ubi50bw0KICAgICAgICB9KSksDQogICAgICAgIHRhZ3M6IEFycmF5LmZyb20oZmxvd0VkaXRvci50YWdzLnZhbHVlcygpKSwNCiAgICAgICAgbWV0YWRhdGE6IHsNCiAgICAgICAgICAgIHNhdmVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwNCiAgICAgICAgICAgIG5vZGVDb3VudDogZmxvd0VkaXRvci5ub2Rlcy5zaXplLA0KICAgICAgICAgICAgY29ubmVjdGlvbkNvdW50OiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnNpemUsDQogICAgICAgICAgICB0YWdDb3VudDogZmxvd0VkaXRvci50YWdzLnNpemUNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICB0cnkgew0KICAgICAgICAvLyBTaG93IGZpbGUgZXhwbG9yZXIgZm9yIHNhdmluZw0KICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGF3YWl0IHN5cG5leEFQSS5zaG93RmlsZUV4cGxvcmVyKHsNCiAgICAgICAgICAgIG1vZGU6ICdzYXZlJywNCiAgICAgICAgICAgIHRpdGxlOiAnU2F2ZSBGbG93IEZpbGUgQXMnLA0KICAgICAgICAgICAgaW5pdGlhbFBhdGg6ICcvJywNCiAgICAgICAgICAgIGZpbGVOYW1lOiAnZmxvd193b3JrZmxvdy5qc29uJywNCiAgICAgICAgICAgIGZpbGVFeHRlbnNpb246ICcuanNvbicsDQogICAgICAgICAgICBvblNlbGVjdDogKHNlbGVjdGVkUGF0aCkgPT4gew0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBjYW5jZWxsZWQNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFNhdmUgdG8gdmlydHVhbCBmaWxlIHN5c3RlbQ0KICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlSlNPTikgew0KICAgICAgICAgICAgYXdhaXQgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGVKU09OKGZpbGVQYXRoLCBmbG93RGF0YSk7DQogICAgICAgICAgICBmbG93RWRpdG9yLmN1cnJlbnRGaWxlUGF0aCA9IGZpbGVQYXRoOw0KICAgICAgICAgICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmxvdyBzYXZlZCBhczogJHtmaWxlUGF0aH1gLCAnc3VjY2VzcycpOw0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNhdmUgZmxvdyBhczonLCBlcnJvcik7DQogICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24pIHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdGYWlsZWQgdG8gc2F2ZSBmbG93IGFzOiAnICsgZXJyb3IubWVzc2FnZSwgJ2Vycm9yJyk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIExvYWQgZmxvdyBmcm9tIHZpcnR1YWwgZmlsZSBzeXN0ZW0NCmFzeW5jIGZ1bmN0aW9uIGxvYWRGbG93KCkgew0KICAgIHRyeSB7DQogICAgICAgIC8vIFNob3cgZmlsZSBleHBsb3JlciBmb3IgbG9hZGluZw0KICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGF3YWl0IHN5cG5leEFQSS5zaG93RmlsZUV4cGxvcmVyKHsNCiAgICAgICAgICAgIG1vZGU6ICdvcGVuJywNCiAgICAgICAgICAgIHRpdGxlOiAnTG9hZCBGbG93IEZpbGUnLA0KICAgICAgICAgICAgaW5pdGlhbFBhdGg6ICcvJywNCiAgICAgICAgICAgIG9uU2VsZWN0OiAoc2VsZWN0ZWRQYXRoKSA9PiB7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgb25DYW5jZWw6ICgpID0+IHsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgaWYgKCFmaWxlUGF0aCkgew0KICAgICAgICAgICAgcmV0dXJuOyAvLyBVc2VyIGNhbmNlbGxlZA0KICAgICAgICB9DQoNCiAgICAgICAgbGV0IGZsb3dEYXRhID0gbnVsbDsNCiAgICAgICAgDQogICAgICAgIC8vIFRyeSB2aXJ0dWFsIGZpbGUgc3lzdGVtIGZpcnN0DQogICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZUpTT04pIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgZmxvd0RhdGEgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlSlNPTihmaWxlUGF0aCk7DQogICAgICAgICAgICB9IGNhdGNoICh2ZnNFcnJvcikgew0KICAgICAgICAgICAgICAgIHRocm93IHZmc0Vycm9yOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBpZiAoZmxvd0RhdGEpIHsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ2xlYXIgY3VycmVudCBjYW52YXMgKHdpdGhvdXQgY29uZmlybWF0aW9uIHNpbmNlIHdlJ3JlIGxvYWRpbmcgYSBmaWxlKQ0KICAgICAgICAgICAgY2xlYXJDYW52YXNTaWxlbnQoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUmVzZXQgcGFuIG9mZnNldCB0byBjZW50ZXIgb2YgbGFyZ2UgY2FudmFzIGZvciBuZXcgd29ya2Zsb3cNCiAgICAgICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0ID0geyB4OiAtNTAwMCwgeTogLTUwMDAgfTsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBSZXNldCBub2RlIGNvdW50ZXIgdG8gYXZvaWQgSUQgY29uZmxpY3RzDQogICAgICAgICAgICBmbG93RWRpdG9yLm5vZGVDb3VudGVyID0gMDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTG9hZCBub2Rlcw0KICAgICAgICAgICAgaWYgKGZsb3dEYXRhLm5vZGVzKSB7DQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBub2RlRGF0YSBvZiBmbG93RGF0YS5ub2Rlcykgew0KICAgICAgICAgICAgICAgICAgICAvLyBEZWNyeXB0IHNlbnNpdGl2ZSBmaWVsZHMgYWZ0ZXIgbG9hZGluZw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBkZWNyeXB0ZWRDb25maWcgPSBhd2FpdCBkZWNyeXB0Tm9kZUNvbmZpZyhub2RlRGF0YS5jb25maWcsIG5vZGVEYXRhLnR5cGUpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5vZGUgd2l0aCBwcm9wZXIgSUQNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gbm9kZURhdGEuaWQ7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGUgPSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZDogbm9kZUlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogbm9kZURhdGEudHlwZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHg6IG5vZGVEYXRhLngsDQogICAgICAgICAgICAgICAgICAgICAgICB5OiBub2RlRGF0YS55LA0KICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnOiBkZWNyeXB0ZWRDb25maWcsDQogICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7fQ0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIG5vZGUgY291bnRlcg0KICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlTnVtID0gcGFyc2VJbnQobm9kZUlkLnJlcGxhY2UoJ25vZGVfJywgJycpKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVOdW0gPiBmbG93RWRpdG9yLm5vZGVDb3VudGVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLm5vZGVDb3VudGVyID0gbm9kZU51bTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci5ub2Rlcy5zZXQobm9kZUlkLCBub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBub2RlIGVsZW1lbnQgdXNpbmcgdGhlIHJlbmRlcmVyIGFuZCBhZGQgdG8gY2FudmFzDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gbm9kZVJlbmRlcmVyLmNyZWF0ZU5vZGVFbGVtZW50KG5vZGUpOw0KICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5hcHBlbmRDaGlsZChub2RlRWxlbWVudCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBMb2FkIGNvbm5lY3Rpb25zIGFmdGVyIG5vZGVzIGFyZSBmdWxseSBjcmVhdGVkIGFuZCBwb3NpdGlvbmVkDQogICAgICAgICAgICBpZiAoZmxvd0RhdGEuY29ubmVjdGlvbnMpIHsNCiAgICAgICAgICAgICAgICBmbG93RGF0YS5jb25uZWN0aW9ucy5mb3JFYWNoKGNvbm5EYXRhID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY3JlYXRlQ29ubmVjdGlvbihjb25uRGF0YS5mcm9tLm5vZGVJZCwgY29ubkRhdGEuZnJvbS5wb3J0TmFtZSwgY29ubkRhdGEudG8ubm9kZUlkLCBjb25uRGF0YS50by5wb3J0TmFtZSk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gSW1tZWRpYXRlbHkgcmVkcmF3IGNvbm5lY3Rpb25zIG5vdyB0aGF0IGFsbCBTVkcgZWxlbWVudHMgZXhpc3QNCiAgICAgICAgICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBMb2FkIHRhZ3MNCiAgICAgICAgICAgIGlmIChmbG93RGF0YS50YWdzKSB7DQogICAgICAgICAgICAgICAgZmxvd0RhdGEudGFncy5mb3JFYWNoKHRhZ0RhdGEgPT4gew0KICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWcgPSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZDogdGFnRGF0YS5pZCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRhZ0RhdGEubmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0YWdEYXRhLmRlc2NyaXB0aW9uIHx8ICcnLA0KICAgICAgICAgICAgICAgICAgICAgICAgeDogdGFnRGF0YS54LA0KICAgICAgICAgICAgICAgICAgICAgICAgeTogdGFnRGF0YS55LA0KICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IHRhZ0RhdGEuY29sb3IgfHwgJyM0Q0FGNTAnDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGFnIGNvdW50ZXINCiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFnTnVtID0gcGFyc2VJbnQodGFnRGF0YS5pZC5yZXBsYWNlKCd0YWdfJywgJycpKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRhZ051bSA+IGZsb3dFZGl0b3IudGFnQ291bnRlcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci50YWdDb3VudGVyID0gdGFnTnVtOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnRhZ3Muc2V0KHRhZ0RhdGEuaWQsIHRhZyk7DQogICAgICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS50YWdNYW5hZ2VyLmNyZWF0ZVRhZ0VsZW1lbnQodGFnKTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGNlbnRlciBvZiBsb2FkZWQgbm9kZXMgYW5kIGFkanVzdCBwYW4gdG8gY2VudGVyIHRoZW0NCiAgICAgICAgICAgIGlmIChmbG93RGF0YS5ub2RlcyAmJiBmbG93RGF0YS5ub2Rlcy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgY29uc3QgbWluWCA9IE1hdGgubWluKC4uLmZsb3dEYXRhLm5vZGVzLm1hcChuID0+IG4ueCkpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG1heFggPSBNYXRoLm1heCguLi5mbG93RGF0YS5ub2Rlcy5tYXAobiA9PiBuLngpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBtaW5ZID0gTWF0aC5taW4oLi4uZmxvd0RhdGEubm9kZXMubWFwKG4gPT4gbi55KSk7DQogICAgICAgICAgICAgICAgY29uc3QgbWF4WSA9IE1hdGgubWF4KC4uLmZsb3dEYXRhLm5vZGVzLm1hcChuID0+IG4ueSkpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbnN0IGNlbnRlclggPSAobWluWCArIG1heFgpIC8gMjsNCiAgICAgICAgICAgICAgICBjb25zdCBjZW50ZXJZID0gKG1pblkgKyBtYXhZKSAvIDI7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gR2V0IGNhbnZhcyBjb250YWluZXIgZGltZW5zaW9ucw0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgICAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgcGFuIG9mZnNldCB0byBjZW50ZXIgdGhlIG5vZGVzIGluIHRoZSB2aWV3cG9ydA0KICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnggPSAtY2VudGVyWCArIGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOw0KICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSAtY2VudGVyWSArIGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gRmluYWwgY29ubmVjdGlvbiByZWRyYXcgYWZ0ZXIgYWxsIHBvc2l0aW9uaW5nIGlzIGNvbXBsZXRlDQogICAgICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBVcGRhdGUgdGFnIHBhbmVsDQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkudGFnTWFuYWdlci51cGRhdGVUYWdQYW5lbCgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBVcGRhdGUgY3VycmVudCBmaWxlIHBhdGgNCiAgICAgICAgICAgIGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgICAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbikgew0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGbG93IGxvYWRlZCBmcm9tOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKSB7DQogICAgICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ05vIHZhbGlkIGZsb3cgZGF0YSBmb3VuZCBpbiB0aGUgc2VsZWN0ZWQgZmlsZS4nLCAnd2FybmluZycpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgZmxvdzonLCBlcnJvcik7DQogICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24pIHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdGYWlsZWQgdG8gbG9hZCBmbG93OiAnICsgZXJyb3IubWVzc2FnZSwgJ2Vycm9yJyk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIFVwZGF0ZSBmaWxlbmFtZSBkaXNwbGF5DQpmdW5jdGlvbiB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKSB7DQogICAgY29uc3QgZmlsZW5hbWVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1cnJlbnQtZmlsZW5hbWUnKTsNCiAgICBpZiAoZmlsZW5hbWVFbGVtZW50KSB7DQogICAgICAgIGNvbnN0IGZpbGVuYW1lID0gZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGggPyBmbG93RWRpdG9yLmN1cnJlbnRGaWxlUGF0aC5zcGxpdCgnLycpLnBvcCgpIDogJ3VudGl0bGVkLmZsb3cnOw0KICAgICAgICBmaWxlbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBmaWxlbmFtZTsNCiAgICB9DQp9DQoNCg0KLy8gRXhwb3J0IHRvIGdsb2JhbCBzY29wZQ0Kc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyID0gew0KICAgIHNhdmVGbG93LA0KICAgIHNhdmVGbG93QXMsDQogICAgbG9hZEZsb3csDQogICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5DQp9Ow0KDQoNCi8vIFBvcHVsYXRlIHRvb2xib3ggd2l0aCBsb2FkZWQgbm9kZXMNCmZ1bmN0aW9uIHBvcHVsYXRlVG9vbGJveCgpIHsNCiAgICBjb25zdCB0b29sYm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZsb3ctdG9vbGJveCcpOw0KICAgIGlmICghdG9vbGJveCkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdUb29sYm94IG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIENsZWFyIGV4aXN0aW5nIHRvb2xib3ggY29udGVudA0KICAgIGNvbnN0IHRvb2xib3hDb250ZW50ID0gdG9vbGJveC5xdWVyeVNlbGVjdG9yKCcudG9vbGJveC1jb250ZW50Jyk7DQogICAgaWYgKHRvb2xib3hDb250ZW50KSB7DQogICAgICAgIHRvb2xib3hDb250ZW50LmlubmVySFRNTCA9ICcnOw0KICAgIH0NCiAgICANCiAgICAvLyBHcm91cCBub2RlcyBieSBjYXRlZ29yeQ0KICAgIGNvbnN0IGNhdGVnb3JpZXMgPSB7fTsNCiAgICBjb25zdCBhbGxOb2RlcyA9IG5vZGVSZWdpc3RyeS5nZXRBbGxOb2RlVHlwZXMoKTsNCiAgICANCiAgICANCiAgICBhbGxOb2Rlcy5mb3JFYWNoKG5vZGVEZWYgPT4gew0KICAgICAgICBjb25zdCBjYXRlZ29yeSA9IG5vZGVEZWYuY2F0ZWdvcnkgfHwgJ290aGVyJzsNCiAgICAgICAgaWYgKCFjYXRlZ29yaWVzW2NhdGVnb3J5XSkgew0KICAgICAgICAgICAgY2F0ZWdvcmllc1tjYXRlZ29yeV0gPSBbXTsNCiAgICAgICAgfQ0KICAgICAgICBjYXRlZ29yaWVzW2NhdGVnb3J5XS5wdXNoKG5vZGVEZWYpOw0KICAgIH0pOw0KICAgIA0KICAgIA0KICAgIC8vIENyZWF0ZSB0b29sYm94IHNlY3Rpb25zIGZvciBlYWNoIGNhdGVnb3J5DQogICAgT2JqZWN0LmVudHJpZXMoY2F0ZWdvcmllcykuZm9yRWFjaCgoW2NhdGVnb3J5LCBub2Rlc10pID0+IHsNCiAgICAgICAgY29uc3QgY2F0ZWdvcnlTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgICAgIGNhdGVnb3J5U2VjdGlvbi5jbGFzc05hbWUgPSAnbm9kZS1jYXRlZ29yeSc7DQogICAgICAgIGNhdGVnb3J5U2VjdGlvbi5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICA8aDU+JHtjYXRlZ29yeS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGNhdGVnb3J5LnNsaWNlKDEpfTwvaDU+DQogICAgICAgICAgICAke25vZGVzLm1hcChub2RlRGVmID0+IGANCiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ0b29sYm94LW5vZGUtYnRuIiBkYXRhLW5vZGUtdHlwZT0iJHtub2RlRGVmLmlkfSIgdGl0bGU9IiR7bm9kZURlZi5kZXNjcmlwdGlvbn0iPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iJHtub2RlRGVmLmljb259Ij48L2k+DQogICAgICAgICAgICAgICAgICAgIDxzcGFuPiR7bm9kZURlZi5uYW1lfTwvc3Bhbj4NCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgIGApLmpvaW4oJycpfQ0KICAgICAgICBgOw0KICAgICAgICANCiAgICAgICAgaWYgKHRvb2xib3hDb250ZW50KSB7DQogICAgICAgICAgICB0b29sYm94Q29udGVudC5hcHBlbmRDaGlsZChjYXRlZ29yeVNlY3Rpb24pOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gUmUtYXR0YWNoIGV2ZW50IGxpc3RlbmVycw0KICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b29sYm94LW5vZGUtYnRuJykuZm9yRWFjaChidG4gPT4gew0KICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgY29uc3Qgbm9kZVR5cGUgPSBidG4uZ2V0QXR0cmlidXRlKCdkYXRhLW5vZGUtdHlwZScpOw0KICAgICAgICAgICAgaWYgKG5vZGVUeXBlKSB7DQogICAgICAgICAgICAgICAgYWRkTm9kZShub2RlVHlwZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0pOw0KICAgIA0KfQ0KDQovLyBTZXQgdXAgZXZlbnQgaGFuZGxlcnMNCmZ1bmN0aW9uIHNldHVwRXZlbnRIYW5kbGVycygpIHsNCiAgICAvLyBOb3RlOiBUb29sYm94IG5vZGUgYnV0dG9uIGV2ZW50IGxpc3RlbmVycyBhcmUgc2V0IHVwIGluIHBvcHVsYXRlVG9vbGJveCgpDQogICAgLy8gdG8gYXZvaWQgZHVwbGljYXRlcyB3aGVuIHRoZSB0b29sYm94IGlzIHJlcG9wdWxhdGVkDQogICAgDQogICAgLy8gV29ya2Zsb3cgYWN0aW9ucw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdydW4td29ya2Zsb3cnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBydW5Xb3JrZmxvdyk7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0b3Atd29ya2Zsb3cnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdG9wV29ya2Zsb3cpOw0KICAgIC8vIE5vdGU6IGRlbGV0ZS1zZWxlY3RlZCwgY2xlYXItY2FudmFzLCByZXNldC12aWV3LCBhbmQgYWRkLXRhZyBhcmUgbm93IGhhbmRsZWQgYnkgaGFtYnVyZ2VyIG1lbnUNCiAgICANCiAgICAvLyBab29tIGNvbnRyb2xzDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvb20taW4nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci56b29tSW4pOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b29tLW91dCcpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnpvb21PdXQpOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b29tLWZpdCcpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnpvb21Ub0ZpdCk7DQogICAgDQogICAgLy8gTm90ZTogRmlsZSBvcGVyYXRpb25zIChzYXZlLCBzYXZlLWFzLCBsb2FkKSBhcmUgbm93IGhhbmRsZWQgYnkgaGFtYnVyZ2VyIG1lbnUNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2xlYXItb3V0cHV0Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xlYXJPdXRwdXQpOw0KICAgIA0KICAgIC8vIEhhbWJ1cmdlciBtZW51DQogICAgc2V0dXBIYW1idXJnZXJNZW51KCk7DQogICAgDQogICAgLy8gQ29uZmlnIHBhbmVsIHRvZ2dsZQ0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtY29uZmlnJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlQ29uZmlnUGFuZWwpOw0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgY29uZmlnIHBhbmVsIHN0YXRlICh3aXRob3V0IG92ZXJyaWRpbmcgaWNvbnMpDQogICAgY29uc3QgY29uZmlnUGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy1jb25maWctcGFuZWwnKTsNCiAgICBpZiAoY29uZmlnUGFuZWwpIHsNCiAgICAgICAgLy8gRGVmYXVsdCBleHBhbmRlZCAobm90IGNvbGxhcHNlZCkNCiAgICAgICAgY29uZmlnUGFuZWwuY2xhc3NMaXN0LnJlbW92ZSgnY29sbGFwc2VkJyk7DQogICAgfQ0KICAgIA0KICAgIC8vIFRvb2xib3ggdG9nZ2xlDQogICAgY29uc3QgdG9vbGJveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmbG93LXRvb2xib3gnKTsNCiAgICBjb25zdCB0b29sYm94Q29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b29sYm94LWNvbnRlbnQnKTsNCiAgICBjb25zdCB0b2dnbGVUb29sYm94QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS10b29sYm94Jyk7DQogICAgaWYgKHRvb2xib3ggJiYgdG9vbGJveENvbnRlbnQgJiYgdG9nZ2xlVG9vbGJveEJ0bikgew0KICAgICAgICAvLyBEZWZhdWx0IGV4cGFuZGVkIChub3QgY29sbGFwc2VkKQ0KICAgICAgICB0b29sYm94LmNsYXNzTGlzdC5yZW1vdmUoJ2NvbGxhcHNlZCcpOw0KICAgICAgICB0b29sYm94Q29udGVudC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoNCiAgICAgICAgdG9nZ2xlVG9vbGJveEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgdG9nZ2xlVG9vbGJveCgpOw0KICAgICAgICB9KTsNCiAgICB9DQogICAgDQogICAgLy8gT3V0cHV0IHBhbmVsIHRvZ2dsZQ0KICAgIGNvbnN0IG91dHB1dFBhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zsb3ctb3V0cHV0LXBhbmVsJyk7DQogICAgY29uc3Qgb3V0cHV0Q29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdXRwdXQtY29udGVudCcpOw0KICAgIGNvbnN0IHRvZ2dsZU91dHB1dEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtb3V0cHV0Jyk7DQogICAgaWYgKG91dHB1dFBhbmVsICYmIG91dHB1dENvbnRlbnQgJiYgdG9nZ2xlT3V0cHV0QnRuKSB7DQogICAgICAgIC8vIERlZmF1bHQgY29sbGFwc2VkDQogICAgICAgIG91dHB1dFBhbmVsLmNsYXNzTGlzdC5hZGQoJ2NvbGxhcHNlZCcpOw0KICAgICAgICBvdXRwdXRDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIHRvZ2dsZU91dHB1dEJ0bi5xdWVyeVNlbGVjdG9yKCdpJykuY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLWRvd24nOw0KDQogICAgICAgIHRvZ2dsZU91dHB1dEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgY29uc3QgaXNDb2xsYXBzZWQgPSBvdXRwdXRQYW5lbC5jbGFzc0xpc3QuY29udGFpbnMoJ2NvbGxhcHNlZCcpOw0KICAgICAgICAgICAgaWYgKGlzQ29sbGFwc2VkKSB7DQogICAgICAgICAgICAgICAgb3V0cHV0UGFuZWwuY2xhc3NMaXN0LnJlbW92ZSgnY29sbGFwc2VkJyk7DQogICAgICAgICAgICAgICAgb3V0cHV0Q29udGVudC5zdHlsZS5kaXNwbGF5ID0gJyc7DQogICAgICAgICAgICAgICAgdG9nZ2xlT3V0cHV0QnRuLnF1ZXJ5U2VsZWN0b3IoJ2knKS5jbGFzc05hbWUgPSAnZmFzIGZhLWNoZXZyb24tdXAnOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBvdXRwdXRQYW5lbC5jbGFzc0xpc3QuYWRkKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgICAgICAgICBvdXRwdXRDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgdG9nZ2xlT3V0cHV0QnRuLnF1ZXJ5U2VsZWN0b3IoJ2knKS5jbGFzc05hbWUgPSAnZmFzIGZhLWNoZXZyb24tZG93bic7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0NCiAgICANCiAgICAvLyBDYW52YXMgZXZlbnRzDQogICAgZmxvd0VkaXRvci5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci5oYW5kbGVDYW52YXNDbGljayk7DQogICAgZmxvd0VkaXRvci5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIuc3RhcnRDYW52YXNQYW4pOw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIuaGFuZGxlTW91c2VXaGVlbCwgeyBwYXNzaXZlOiBmYWxzZSB9KTsNCiAgICANCiAgICAvLyBEb2N1bWVudC1sZXZlbCBtb3VzZSBldmVudHMgZm9yIHNtb290aCBkcmFnZ2luZyBhbmQgcGFubmluZw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLmhhbmRsZURvY3VtZW50TW91c2VEb3duKTsNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci5oYW5kbGVEb2N1bWVudE1vdXNlTW92ZSk7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLmhhbmRsZURvY3VtZW50TW91c2VVcCk7DQogICAgDQoNCn0NCg0KLy8gVG9nZ2xlIGNvbmZpZyBwYW5lbA0KZnVuY3Rpb24gdG9nZ2xlQ29uZmlnUGFuZWwoKSB7DQogICAgY29uc3QgY29uZmlnUGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy1jb25maWctcGFuZWwnKTsNCiAgICBjb25zdCB0b2dnbGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlLWNvbmZpZycpOw0KICAgIGNvbnN0IGljb24gPSB0b2dnbGVCdG4ucXVlcnlTZWxlY3RvcignaScpOw0KICAgIA0KICAgIGlmIChjb25maWdQYW5lbC5jbGFzc0xpc3QuY29udGFpbnMoJ2NvbGxhcHNlZCcpKSB7DQogICAgICAgIC8vIEV4cGFuZA0KICAgICAgICBjb25maWdQYW5lbC5jbGFzc0xpc3QucmVtb3ZlKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgaWNvbi5jbGFzc05hbWUgPSAnZmFzIGZhLWNoZXZyb24tcmlnaHQnOw0KICAgICAgICB0b2dnbGVCdG4udGl0bGUgPSAnQ29sbGFwc2UgQ29uZmlndXJhdGlvbiBQYW5lbCc7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gQ29sbGFwc2UNCiAgICAgICAgY29uZmlnUGFuZWwuY2xhc3NMaXN0LmFkZCgnY29sbGFwc2VkJyk7DQogICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLWxlZnQnOw0KICAgICAgICB0b2dnbGVCdG4udGl0bGUgPSAnRXhwYW5kIENvbmZpZ3VyYXRpb24gUGFuZWwnOw0KICAgIH0NCn0NCg0KLy8gVG9nZ2xlIHRvb2xib3gNCmZ1bmN0aW9uIHRvZ2dsZVRvb2xib3goKSB7DQogICAgY29uc3QgdG9vbGJveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmbG93LXRvb2xib3gnKTsNCiAgICBjb25zdCB0b29sYm94Q29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b29sYm94LWNvbnRlbnQnKTsNCiAgICBjb25zdCB0b2dnbGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlLXRvb2xib3gnKTsNCiAgICBjb25zdCBpY29uID0gdG9nZ2xlQnRuLnF1ZXJ5U2VsZWN0b3IoJ2knKTsNCiAgICANCiAgICBpZiAodG9vbGJveC5jbGFzc0xpc3QuY29udGFpbnMoJ2NvbGxhcHNlZCcpKSB7DQogICAgICAgIC8vIEV4cGFuZA0KICAgICAgICB0b29sYm94LmNsYXNzTGlzdC5yZW1vdmUoJ2NvbGxhcHNlZCcpOw0KICAgICAgICB0b29sYm94Q29udGVudC5zdHlsZS5kaXNwbGF5ID0gJyc7DQogICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLWxlZnQnOw0KICAgICAgICB0b2dnbGVCdG4udGl0bGUgPSAnQ29sbGFwc2UgVG9vbGJveCc7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gQ29sbGFwc2UNCiAgICAgICAgdG9vbGJveC5jbGFzc0xpc3QuYWRkKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgdG9vbGJveENvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgaWNvbi5jbGFzc05hbWUgPSAnZmFzIGZhLWNoZXZyb24tcmlnaHQnOw0KICAgICAgICB0b2dnbGVCdG4udGl0bGUgPSAnRXhwYW5kIFRvb2xib3gnOw0KICAgIH0NCn0NCg0KLy8gU2V0dXAgaGFtYnVyZ2VyIG1lbnUgZnVuY3Rpb25hbGl0eQ0KZnVuY3Rpb24gc2V0dXBIYW1idXJnZXJNZW51KCkgew0KICAgIGNvbnN0IGhhbWJ1cmdlckJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoYW1idXJnZXItbWVudScpOw0KICAgIGNvbnN0IGRyb3Bkb3duTWVudSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wZG93bi1tZW51Jyk7DQogICAgDQogICAgaWYgKCFoYW1idXJnZXJCdG4gfHwgIWRyb3Bkb3duTWVudSkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdIYW1idXJnZXIgbWVudSBlbGVtZW50cyBub3QgZm91bmQnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBUb2dnbGUgbWVudSBvbiBoYW1idXJnZXIgY2xpY2sNCiAgICBoYW1idXJnZXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICANCiAgICAgICAgLy8gUG9zaXRpb24gdGhlIGRyb3Bkb3duIHJlbGF0aXZlIHRvIHRoZSBoYW1idXJnZXIgYnV0dG9uDQogICAgICAgIGlmICghZHJvcGRvd25NZW51LmNsYXNzTGlzdC5jb250YWlucygnc2hvdycpKSB7DQogICAgICAgICAgICAvLyBVc2Ugc2NhbGVkIG1vdXNlIGNvb3JkaW5hdGVzIGZvciBtb3JlIGludHVpdGl2ZSBwb3NpdGlvbmluZw0KICAgICAgICAgICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/IA0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6DQogICAgICAgICAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBoYW1idXJnZXJCdG4uY2xvc2VzdCgnLmZsb3ctZWRpdG9yLCAuYXBwLWNvbnRhaW5lcicpOw0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0ICYmIGNvbnRhaW5lcikgPw0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6DQogICAgICAgICAgICAgICAgKGNvbnRhaW5lciA/IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSA6IHsgdG9wOiAwLCBsZWZ0OiAwIH0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBQb3NpdGlvbiByZWxhdGl2ZSB0byBtb3VzZSBjbGljaywgb2Zmc2V0IHNsaWdodGx5IHRvIGF2b2lkIGNvdmVyaW5nIHRoZSBidXR0b24NCiAgICAgICAgICAgIGNvbnN0IHJlbGF0aXZlVG9wID0gbW91c2VDb29yZHMueSAtIGNvbnRhaW5lclJlY3QudG9wICsgNTsNCiAgICAgICAgICAgIGNvbnN0IHJlbGF0aXZlTGVmdCA9IG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQgLSAxODAgLSAxMCArIDIwOyAvLyBNZW51IHdpZHRoICsgc21hbGwgZ2FwLCB0aGVuIDIwcHggbW9yZSB0byB0aGUgcmlnaHQNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZHJvcGRvd25NZW51LnN0eWxlLnRvcCA9IHJlbGF0aXZlVG9wICsgJ3B4JzsNCiAgICAgICAgICAgIGRyb3Bkb3duTWVudS5zdHlsZS5sZWZ0ID0gcmVsYXRpdmVMZWZ0ICsgJ3B4JzsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgZHJvcGRvd25NZW51LmNsYXNzTGlzdC50b2dnbGUoJ3Nob3cnKTsNCiAgICB9KTsNCiAgICANCiAgICAvLyBDbG9zZSBtZW51IHdoZW4gY2xpY2tpbmcgb3V0c2lkZQ0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgaWYgKCFkcm9wZG93bk1lbnUuY29udGFpbnMoZS50YXJnZXQpICYmICFoYW1idXJnZXJCdG4uY29udGFpbnMoZS50YXJnZXQpKSB7DQogICAgICAgICAgICBkcm9wZG93bk1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gSGFuZGxlIG1lbnUgaXRlbSBjbGlja3MgLSBPTkxZIHRoZSBzcGVjaWZpYyBhY3Rpb25zIHJlcXVlc3RlZA0KICAgIGRyb3Bkb3duTWVudS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgIGNvbnN0IG1lbnVJdGVtID0gZS50YXJnZXQuY2xvc2VzdCgnLm1lbnUtaXRlbScpOw0KICAgICAgICBpZiAoIW1lbnVJdGVtKSByZXR1cm47DQogICAgICAgIA0KICAgICAgICBjb25zdCBhY3Rpb24gPSBtZW51SXRlbS5kYXRhc2V0LmFjdGlvbjsNCiAgICAgICAgaWYgKCFhY3Rpb24pIHJldHVybjsNCiAgICAgICAgDQogICAgICAgIC8vIENsb3NlIHRoZSBtZW51DQogICAgICAgIGRyb3Bkb3duTWVudS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7DQogICAgICAgIA0KICAgICAgICAvLyBFeGVjdXRlIE9OTFkgdGhlIHJlcXVlc3RlZCBhY3Rpb25zOiBzYXZlLCBzYXZlLWFzLCBsb2FkLCBkZWxldGUsIGNsZWFyLWFsbCwgcmVzZXQtdmlldywgYWRkLXRhZw0KICAgICAgICBzd2l0Y2ggKGFjdGlvbikgew0KICAgICAgICAgICAgY2FzZSAnc2F2ZS1mbG93JzoNCiAgICAgICAgICAgICAgICBpZiAoc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyICYmIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci5zYXZlRmxvdykgew0KICAgICAgICAgICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmlsZU1hbmFnZXIuc2F2ZUZsb3coKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzYXZlLWZsb3ctYXMnOg0KICAgICAgICAgICAgICAgIGlmIChzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmlsZU1hbmFnZXIgJiYgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLnNhdmVGbG93QXMpIHsNCiAgICAgICAgICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLnNhdmVGbG93QXMoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdsb2FkLWZsb3cnOg0KICAgICAgICAgICAgICAgIGlmIChzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmlsZU1hbmFnZXIgJiYgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLmxvYWRGbG93KSB7DQogICAgICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci5sb2FkRmxvdygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2FkZC10YWcnOg0KICAgICAgICAgICAgICAgIGlmIChzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkudGFnTWFuYWdlciAmJiBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkudGFnTWFuYWdlci5hZGRUYWcpIHsNCiAgICAgICAgICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLnRhZ01hbmFnZXIuYWRkVGFnKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAncmVzZXQtdmlldyc6DQogICAgICAgICAgICAgICAgaWYgKHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyICYmIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnJlc2V0Q2FudmFzUGFuKSB7DQogICAgICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnJlc2V0Q2FudmFzUGFuKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZGVsZXRlLXNlbGVjdGVkJzoNCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRlbGV0ZVNlbGVjdGVkTm9kZSA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgICAgICAgICBkZWxldGVTZWxlY3RlZE5vZGUoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdjbGVhci1jYW52YXMnOg0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY2xlYXJDYW52YXMgPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgICAgICAgICAgY2xlYXJDYW52YXMoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICB9KTsNCn0NCg0KLy8gRXhhbXBsZTogdWktbWFuYWdlci5qcw0Kc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLnVpTWFuYWdlciA9IHsNCiAgICBwb3B1bGF0ZVRvb2xib3gsDQogICAgc2V0dXBFdmVudEhhbmRsZXJzLA0KICAgIHRvZ2dsZUNvbmZpZ1BhbmVsLA0KICAgIHRvZ2dsZVRvb2xib3gNCn07DQoNCi8vIG1haW4uanMgLSBFbnRyeSBwb2ludCBmb3IgRmxvdyBFZGl0b3INCg0KLy8gR2xvYmFsIHZhcmlhYmxlcyAoc2NvcGVkIHRvIGF2b2lkIGdsb2JhbCBwb2xsdXRpb24pDQpsZXQgZmxvd0VkaXRvciA9IHsNCiAgICBub2RlczogbmV3IE1hcCgpLA0KICAgIGNvbm5lY3Rpb25zOiBuZXcgTWFwKCksDQogICAgc2VsZWN0ZWROb2RlOiBudWxsLA0KICAgIGRyYWdnaW5nTm9kZTogbnVsbCwNCiAgICBjb25uZWN0aW5nRnJvbTogbnVsbCwNCiAgICBjYW52YXM6IG51bGwsDQogICAgbm9kZUNvdW50ZXI6IDAsDQogICAgaXNSdW5uaW5nOiBmYWxzZSwNCiAgICBjdXJyZW50RmlsZVBhdGg6IG51bGwsDQogICAgaXNBY3RpdmU6IHRydWUsDQogICAgLy8gQ2FudmFzIHBhbm5pbmcgc3RhdGUNCiAgICBpc1Bhbm5pbmc6IGZhbHNlLA0KICAgIHBhblN0YXJ0OiB7IHg6IDAsIHk6IDAgfSwNCiAgICBwYW5PZmZzZXQ6IHsgeDogLTUwMDAsIHk6IC01MDAwIH0sIC8vIENlbnRlciB0aGUgbGFyZ2UgY2FudmFzIGluaXRpYWxseQ0KICAgIGxhc3RQYW5PZmZzZXQ6IHsgeDogLTUwMDAsIHk6IC01MDAwIH0sDQogICAgLy8gWm9vbSBzdGF0ZQ0KICAgIHpvb21MZXZlbDogMS4wLA0KICAgIG1pblpvb206IDAuMSwNCiAgICBtYXhab29tOiAzLjAsDQogICAgem9vbVN0ZXA6IDAuMSwNCiAgICAvLyBUYWcgc3lzdGVtDQogICAgdGFnczogbmV3IE1hcCgpLA0KICAgIHRhZ0NvdW50ZXI6IDAsDQogICAgZHJhZ2dpbmdUYWc6IG51bGwsDQogICAgdGFnRHJhZ09mZnNldDogbnVsbCwNCiAgICB0YWdVcGRhdGVUaW1lb3V0OiBudWxsLA0KICAgIC8vIFZpc3VhbCBwZXJmb3JtYW5jZSBmbGFncw0KICAgIHRyYW5zZm9ybVVwZGF0ZVJlcXVlc3RlZDogZmFsc2UsDQogICAgaXNab29taW5nOiBmYWxzZSwNCiAgICBpc1Jlc2V0dGluZzogZmFsc2UsDQogICAgcmVkcmF3SW5Qcm9ncmVzczogZmFsc2UsDQogICAgbGFzdFdoZWVsVGltZTogMCwNCiAgICAvLyBUaW1lb3V0IElEcyBmb3IgY2xlYW51cA0KICAgIHpvb21SZWRyYXdUaW1lb3V0OiBudWxsLA0KICAgIHpvb21GaXRUaW1lb3V0OiBudWxsLA0KICAgIHJlc2V0VGltZW91dDogbnVsbA0KfTsNCg0KLy8gSW5pdGlhbGl6ZSB3aGVuIERPTSBpcyByZWFkeQ0KYXN5bmMgZnVuY3Rpb24gaW5pdEZsb3dFZGl0b3IoKSB7DQogICAgDQogICAgLy8gQ2hlY2sgaWYgU3lwbmV4QVBJIGlzIGF2YWlsYWJsZSAobG9jYWwgdmFyaWFibGUgaW4gc2FuZGJveGVkIGVudmlyb25tZW50KQ0KICAgIGlmICh0eXBlb2Ygc3lwbmV4QVBJID09PSAndW5kZWZpbmVkJyB8fCAhc3lwbmV4QVBJKSB7DQogICAgICAgIGNvbnNvbGUud2FybignU3lwbmV4QVBJIG5vdCBhdmFpbGFibGUgLSBydW5uaW5nIGluIHN0YW5kYWxvbmUgbW9kZScpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgDQogICAgLy8gSW5pdGlhbGl6ZSBzY2FsZSBkZXRlY3Rpb24gZm9yIGFwcCBzY2FsaW5nIGNvbXBlbnNhdGlvbg0KICAgIGlmICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuaW5pdFNjYWxlRGV0ZWN0aW9uKSB7DQogICAgICAgIHN5cG5leEFQSS5pbml0U2NhbGVEZXRlY3Rpb24oKG5ld1NjYWxlLCBvbGRTY2FsZSkgPT4gew0KICAgICAgICAgICAgLy8gUmVkcmF3IGNvbm5lY3Rpb25zIHdoZW4gc2NhbGUgY2hhbmdlcw0KICAgICAgICAgICAgaWYgKHR5cGVvZiByZWRyYXdBbGxDb25uZWN0aW9ucyA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0NCiAgICANCiAgICAvLyBUZXN0IFZGUyBBUEkNCiAgICB0cnkgew0KICAgICAgICBjb25zdCB0ZXN0UmVzdWx0ID0gYXdhaXQgc3lwbmV4QVBJLmxpc3RWaXJ0dWFsRmlsZXMoJy8nKTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdWRlMgQVBJIHRlc3QgZmFpbGVkOicsIGVycm9yKTsNCiAgICB9DQogICAgDQogICAgLy8gSW5pdGlhbGl6ZSBjYW52YXMNCiAgICBmbG93RWRpdG9yLmNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmbG93LWNhbnZhcycpOw0KICAgIGlmICghZmxvd0VkaXRvci5jYW52YXMpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmxvdyBjYW52YXMgbm90IGZvdW5kJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gQ3JlYXRlIFNWRyBtYXJrZXIgZGVmaW5pdGlvbnMgZm9yIGNvbm5lY3Rpb24gYXJyb3dzDQogICAgY29uc3QgZGVmcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnZGVmcycpOw0KICAgIGNvbnN0IG1hcmtlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbWFya2VyJyk7DQogICAgbWFya2VyLnNldEF0dHJpYnV0ZSgnaWQnLCAnYXJyb3doZWFkJyk7DQogICAgbWFya2VyLnNldEF0dHJpYnV0ZSgnbWFya2VyV2lkdGgnLCAnMTAnKTsNCiAgICBtYXJrZXIuc2V0QXR0cmlidXRlKCdtYXJrZXJIZWlnaHQnLCAnNycpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ3JlZlgnLCAnOScpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ3JlZlknLCAnMy41Jyk7DQogICAgbWFya2VyLnNldEF0dHJpYnV0ZSgnb3JpZW50JywgJ2F1dG8nKTsNCiAgICBtYXJrZXIuc2V0QXR0cmlidXRlKCdtYXJrZXJVbml0cycsICdzdHJva2VXaWR0aCcpOw0KICAgIA0KICAgIGNvbnN0IHBvbHlnb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BvbHlnb24nKTsNCiAgICBwb2x5Z29uLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzAgMCwgMTAgMy41LCAwIDcnKTsNCiAgICBwb2x5Z29uLnNldEF0dHJpYnV0ZSgnZmlsbCcsICcjNENBRjUwJyk7DQogICAgDQogICAgbWFya2VyLmFwcGVuZENoaWxkKHBvbHlnb24pOw0KICAgIGRlZnMuYXBwZW5kQ2hpbGQobWFya2VyKTsNCiAgICANCiAgICAvLyBDcmVhdGUgYSB0ZW1wb3JhcnkgU1ZHIGNvbnRhaW5lciBmb3IgdGhlIG1hcmtlciBkZWZpbml0aW9uDQogICAgY29uc3QgbWFya2VyU3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTsNCiAgICBtYXJrZXJTdmcuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOw0KICAgIG1hcmtlclN2Zy5zdHlsZS53aWR0aCA9ICcwJzsNCiAgICBtYXJrZXJTdmcuc3R5bGUuaGVpZ2h0ID0gJzAnOw0KICAgIG1hcmtlclN2Zy5hcHBlbmRDaGlsZChkZWZzKTsNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5hcHBlbmRDaGlsZChtYXJrZXJTdmcpOw0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgY2FudmFzIHRyYW5zZm9ybSBmb3IgcGFubmluZw0KICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgIA0KICAgIC8vIExvYWQgbm9kZXMgZnJvbSBWRlMNCiAgICBhd2FpdCBub2RlUmVnaXN0cnkubG9hZE5vZGVzRnJvbVZGUygpOw0KICAgIA0KICAgIC8vIFBvcHVsYXRlIHRvb2xib3ggd2l0aCBsb2FkZWQgbm9kZXMNCiAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkudWlNYW5hZ2VyLnBvcHVsYXRlVG9vbGJveCgpOw0KICAgIA0KICAgIC8vIFNldCB1cCBldmVudCBoYW5kbGVycw0KICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS51aU1hbmFnZXIuc2V0dXBFdmVudEhhbmRsZXJzKCk7DQogICAgDQogICAgLy8gU2V0IHVwIGtleWJvYXJkIHNob3J0Y3V0cyB1c2luZyBuZXcgU3lwbmV4QVBJDQogICAgc2V0dXBLZXlib2FyZFNob3J0Y3V0cygpOw0KICAgIA0KICAgIC8vIEhhbmRsZSBmdWxsc2NyZWVuIGNoYW5nZXMgdG8gcHJldmVudCB2aXN1YWwgZmxhc2hpbmcNCiAgICBmdW5jdGlvbiBoYW5kbGVGdWxsc2NyZWVuQ2hhbmdlKCkgew0KICAgICAgICBjb25zdCBpc0Z1bGxzY3JlZW4gPSAhIShkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCB8fCBkb2N1bWVudC53ZWJraXRGdWxsc2NyZWVuRWxlbWVudCB8fCBkb2N1bWVudC5tb3pGdWxsU2NyZWVuRWxlbWVudCB8fCBkb2N1bWVudC5tc0Z1bGxzY3JlZW5FbGVtZW50KTsNCiAgICAgICAgDQogICAgICAgIGlmIChpc0Z1bGxzY3JlZW4pIHsNCiAgICAgICAgICAgIC8vIEFkZCBuby10cmFuc2l0aW9ucyBjbGFzcyB3aGVuIGVudGVyaW5nIGZ1bGxzY3JlZW4NCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnbm8tdHJhbnNpdGlvbnMnKTsNCiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnbm8tdHJhbnNpdGlvbnMnKTsNCiAgICAgICAgICAgICAgICAvLyBSZWRyYXcgY29ubmVjdGlvbnMgYWZ0ZXIgZnVsbHNjcmVlbiB0cmFuc2l0aW9uDQogICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0sIDUwMCk7IC8vIEFsbG93IGZ1bGxzY3JlZW4gdHJhbnNpdGlvbiB0byBjb21wbGV0ZQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gQWRkIG5vLXRyYW5zaXRpb25zIGNsYXNzIHdoZW4gZXhpdGluZyBmdWxsc2NyZWVuDQogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ25vLXRyYW5zaXRpb25zJyk7DQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ25vLXRyYW5zaXRpb25zJyk7DQogICAgICAgICAgICAgICAgLy8gUmVkcmF3IGNvbm5lY3Rpb25zIGFmdGVyIGZ1bGxzY3JlZW4gdHJhbnNpdGlvbg0KICAgICAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9LCA1MDApOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIC8vIExpc3RlbiBmb3IgZnVsbHNjcmVlbiBjaGFuZ2VzDQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZnVsbHNjcmVlbmNoYW5nZScsIGhhbmRsZUZ1bGxzY3JlZW5DaGFuZ2UpOw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3dlYmtpdGZ1bGxzY3JlZW5jaGFuZ2UnLCBoYW5kbGVGdWxsc2NyZWVuQ2hhbmdlKTsNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3pmdWxsc2NyZWVuY2hhbmdlJywgaGFuZGxlRnVsbHNjcmVlbkNoYW5nZSk7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignTVNGdWxsc2NyZWVuQ2hhbmdlJywgaGFuZGxlRnVsbHNjcmVlbkNoYW5nZSk7DQogICAgDQogICAgLy8gSGFuZGxlIHdpbmRvdyByZXNpemUgdG8gdXBkYXRlIGNvbm5lY3Rpb25zIHdpdGggZGVib3VuY2luZw0KICAgIGxldCByZXNpemVUaW1lb3V0Ow0KICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKSA9PiB7DQogICAgICAgIC8vIEFkZCBuby10cmFuc2l0aW9ucyBjbGFzcyBkdXJpbmcgcmVzaXplIHRvIHByZXZlbnQgZmxhc2hpbmcNCiAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCduby10cmFuc2l0aW9ucycpOw0KICAgICAgICANCiAgICAgICAgLy8gRGVib3VuY2UgcmVzaXplIGV2ZW50cyB0byBwcmV2ZW50IG92ZXJ3aGVsbWluZyB0aGUgc3lzdGVtDQogICAgICAgIGNsZWFyVGltZW91dChyZXNpemVUaW1lb3V0KTsNCiAgICAgICAgcmVzaXplVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgLy8gUmVtb3ZlIG5vLXRyYW5zaXRpb25zIGNsYXNzDQogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ25vLXRyYW5zaXRpb25zJyk7DQogICAgICAgICAgICAvLyBVc2UgcmVxdWVzdEFuaW1hdGlvbkZyYW1lIGZvciBzbW9vdGggdXBkYXRlcw0KICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHsNCiAgICAgICAgICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0sIDE1MCk7IC8vIDE1MG1zIGRlYm91bmNlDQogICAgfSk7DQogICAgDQogICAgLy8gSGFuZGxlIGFwcCBjbGVhbnVwIHdoZW4gd2luZG93IGlzIHVubG9hZGVkDQogICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIGNsZWFudXBGbG93RWRpdG9yKTsNCiAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuYWRkRXZlbnRMaXN0ZW5lcigncGFnZWhpZGUnLCBjbGVhbnVwRmxvd0VkaXRvcik7DQogICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmFkZEV2ZW50TGlzdGVuZXIoJ3VubG9hZCcsIGNsZWFudXBGbG93RWRpdG9yKTsNCiAgICANCiAgICAvLyBGbG93IEVkaXRvciBsb2FkZWQgc3VjY2Vzc2Z1bGx5IChubyBub3RpZmljYXRpb24gbmVlZGVkKQ0KICAgIA0KICAgIC8vIFVwZGF0ZSBmaWxlbmFtZSBkaXNwbGF5DQogICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLnVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgIA0KfQ0KDQovLyBDbGVhbnVwIGZ1bmN0aW9uIHRvIHJlbW92ZSB0b29sdGlwcyBhbmQgZXZlbnQgbGlzdGVuZXJzDQpmdW5jdGlvbiBjbGVhbnVwRmxvd0VkaXRvcigpIHsNCiAgICAvLyBNYXJrIGFwcCBhcyBpbmFjdGl2ZSB0byBwcmV2ZW50IG5ldyB0b29sdGlwcw0KICAgIGZsb3dFZGl0b3IuaXNBY3RpdmUgPSBmYWxzZTsNCiAgICANCiAgICAvLyBDbGVhciBhbGwgdGltZW91dHMgdG8gcHJldmVudCBtZW1vcnkgbGVha3MNCiAgICBjbGVhclRpbWVvdXQoZmxvd0VkaXRvci56b29tUmVkcmF3VGltZW91dCk7DQogICAgY2xlYXJUaW1lb3V0KGZsb3dFZGl0b3Iuem9vbUZpdFRpbWVvdXQpOw0KICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnJlc2V0VGltZW91dCk7DQogICAgY2xlYXJUaW1lb3V0KGZsb3dFZGl0b3IudGFnVXBkYXRlVGltZW91dCk7DQogICAgY2xlYXJUaW1lb3V0KGZsb3dFZGl0b3IudXBkYXRlVGltZW91dCk7DQogICAgDQogICAgLy8gUmVtb3ZlIGFueSBsaW5nZXJpbmcgdG9vbHRpcHMgKGNoZWNrIG11bHRpcGxlIHBvc3NpYmxlIGxvY2F0aW9ucykNCiAgICBjb25zdCB0b29sdGlwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb25uZWN0aW9uLXRvb2x0aXAsICNjb25uZWN0aW9uLXRvb2x0aXAnKTsNCiAgICB0b29sdGlwcy5mb3JFYWNoKHRvb2x0aXAgPT4gew0KICAgICAgICBpZiAodG9vbHRpcC5wYXJlbnROb2RlKSB7DQogICAgICAgICAgICB0b29sdGlwLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodG9vbHRpcCk7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICAvLyBSZW1vdmUgZ2xvYmFsIGV2ZW50IGxpc3RlbmVycw0KICAgIGlmIChzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyKSB7DQogICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIpOw0KICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyID0gbnVsbDsNCiAgICB9DQogICAgDQogICAgLy8gQ2xlYXIgYW55IG90aGVyIGdsb2JhbCByZWZlcmVuY2VzDQogICAgaWYgKHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIpIHsNCiAgICAgICAgZGVsZXRlIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXI7DQogICAgfQ0KICAgIA0KICAgIC8vIFJlc2V0IHZpc3VhbCBzdGF0ZSBmbGFncw0KICAgIGZsb3dFZGl0b3IudHJhbnNmb3JtVXBkYXRlUmVxdWVzdGVkID0gZmFsc2U7DQogICAgZmxvd0VkaXRvci5pc1pvb21pbmcgPSBmYWxzZTsNCiAgICBmbG93RWRpdG9yLmlzUmVzZXR0aW5nID0gZmFsc2U7DQogICAgZmxvd0VkaXRvci5yZWRyYXdJblByb2dyZXNzID0gZmFsc2U7DQogICAgDQogICAgLy8gQWxzbyByZW1vdmUgYW55IHRvb2x0aXBzIHRoYXQgbWlnaHQgYmUgaW4gdGhlIGJvZHkNCiAgICBjb25zdCBib2R5VG9vbHRpcHMgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb25uZWN0aW9uLXRvb2x0aXAnKTsNCiAgICBib2R5VG9vbHRpcHMuZm9yRWFjaCh0b29sdGlwID0+IHsNCiAgICAgICAgaWYgKHRvb2x0aXAucGFyZW50Tm9kZSkgew0KICAgICAgICAgICAgdG9vbHRpcC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRvb2x0aXApOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQp9DQoNCi8vIEFkZCBhIG5ldyBub2RlIHRvIHRoZSBjYW52YXMgKGR5bmFtaWMgdmVyc2lvbikNCmZ1bmN0aW9uIGFkZE5vZGUodHlwZSkgew0KICAgIGNvbnN0IG5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUodHlwZSk7DQogICAgaWYgKCFub2RlRGVmKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Vua25vd24gbm9kZSB0eXBlOicsIHR5cGUpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IG5vZGVJZCA9IGBub2RlXyR7KytmbG93RWRpdG9yLm5vZGVDb3VudGVyfWA7DQogICAgDQogICAgLy8gQ2FsY3VsYXRlIHBvc2l0aW9uIHJlbGF0aXZlIHRvIGN1cnJlbnQgdmlld3BvcnQgY2VudGVyDQogICAgY29uc3QgY2VudGVyID0gc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZsb3dFZGl0b3JVdGlscyA/IA0KICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmxvd0VkaXRvclV0aWxzLmdldFZpZXdwb3J0Q2VudGVySW5DYW52YXMoKSA6DQogICAgICAgIHsgeDogNTAwMCwgeTogNTAwMCB9OyAvLyBGYWxsYmFjayB0byBjYW52YXMgY2VudGVyDQogICAgDQogICAgLy8gQWRkIHNvbWUgcmFuZG9tIG9mZnNldCBhcm91bmQgdGhlIGNlbnRlcg0KICAgIGNvbnN0IG9mZnNldFggPSAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiAyMDA7IC8vIC0xMDAgdG8gKzEwMA0KICAgIGNvbnN0IG9mZnNldFkgPSAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiAyMDA7IC8vIC0xMDAgdG8gKzEwMA0KICAgIA0KICAgIGNvbnN0IG5vZGUgPSB7DQogICAgICAgIGlkOiBub2RlSWQsDQogICAgICAgIHR5cGU6IHR5cGUsDQogICAgICAgIHg6IGNlbnRlci54ICsgb2Zmc2V0WCwNCiAgICAgICAgeTogY2VudGVyLnkgKyBvZmZzZXRZLA0KICAgICAgICBjb25maWc6IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkobm9kZURlZi5jb25maWcpKSwgLy8gRGVlcCBjb3B5DQogICAgICAgIGRhdGE6IHt9DQogICAgfTsNCiAgICANCiAgICAvLyBJbml0aWFsaXplIHNwZWNpYWwgbm9kZSBzdGF0ZXMNCiAgICBpZiAodHlwZSA9PT0gJ3JlcGVhdGVyJykgew0KICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUgPSB7DQogICAgICAgICAgICBjb3VudDogMCwNCiAgICAgICAgICAgIGludGVydmFsOiBudWxsLA0KICAgICAgICAgICAgaXNSdW5uaW5nOiBmYWxzZQ0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICBmbG93RWRpdG9yLm5vZGVzLnNldChub2RlSWQsIG5vZGUpOw0KICAgIA0KICAgIC8vIENyZWF0ZSBub2RlIGVsZW1lbnQgdXNpbmcgdGhlIHJlbmRlcmVyDQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBub2RlUmVuZGVyZXIuY3JlYXRlTm9kZUVsZW1lbnQobm9kZSk7DQogICAgZmxvd0VkaXRvci5jYW52YXMuYXBwZW5kQ2hpbGQobm9kZUVsZW1lbnQpOw0KICAgIA0KfQ0KDQovLyBTZXR1cCBrZXlib2FyZCBzaG9ydGN1dHMgdXNpbmcgbmV3IFN5cG5leEFQSQ0KZnVuY3Rpb24gc2V0dXBLZXlib2FyZFNob3J0Y3V0cygpIHsNCiAgICAvLyBDaGVjayBpZiBTeXBuZXhBUEkga2V5Ym9hcmQgZnVuY3Rpb25hbGl0eSBpcyBhdmFpbGFibGUNCiAgICBpZiAodHlwZW9mIHN5cG5leEFQSSA9PT0gJ3VuZGVmaW5lZCcgfHwgIXN5cG5leEFQSSB8fCAhc3lwbmV4QVBJLnJlZ2lzdGVyS2V5Ym9hcmRTaG9ydGN1dHMpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCdTeXBuZXhBUEkga2V5Ym9hcmQgc2hvcnRjdXRzIG5vdCBhdmFpbGFibGUgLSBGbG93IEVkaXRvciBrZXlib2FyZCBzaG9ydGN1dHMgZGlzYWJsZWQnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBSZWdpc3RlciBrZXlib2FyZCBzaG9ydGN1dHMgdXNpbmcgdGhlIG5ldyBTeXBuZXhBUEkNCiAgICAvLyBNYXAga2V5cyB0byB0aGVpciBoYW5kbGVycywgcHJlc2VydmluZyBhbGwgdGhlIG9yaWdpbmFsIGxvZ2ljIGZyb20gaGFuZGxlS2V5RG93bg0KICAgIHN5cG5leEFQSS5yZWdpc3RlcktleWJvYXJkU2hvcnRjdXRzKHsNCiAgICAgICAgJ2RlbGV0ZSc6ICgpID0+IHsNCiAgICAgICAgICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSkgew0KICAgICAgICAgICAgICAgIGRlbGV0ZVNlbGVjdGVkTm9kZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICAnY3RybCtiYWNrc3BhY2UnOiAoKSA9PiB7DQogICAgICAgICAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpIHsNCiAgICAgICAgICAgICAgICBkZWxldGVTZWxlY3RlZE5vZGUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgJ2NtZCtiYWNrc3BhY2UnOiAoKSA9PiB7DQogICAgICAgICAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpIHsNCiAgICAgICAgICAgICAgICBkZWxldGVTZWxlY3RlZE5vZGUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgJ2VzY2FwZSc6ICgpID0+IHsNCiAgICAgICAgICAgIC8vIERlc2VsZWN0IG5vZGUNCiAgICAgICAgICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSkgew0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpOw0KICAgICAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTsNCiAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9IG51bGw7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUtY29uZmlnJykuaW5uZXJIVE1MID0gJzxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5TZWxlY3QgYSBub2RlIHRvIGNvbmZpZ3VyZSBpdDwvcD4nOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICAnY3RybCtzJzogKCkgPT4gew0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLnNhdmVGbG93KCk7DQogICAgICAgIH0sDQogICAgICAgICdjbWQrcyc6ICgpID0+IHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci5zYXZlRmxvdygpOw0KICAgICAgICB9LA0KICAgICAgICAnY3RybCtzaGlmdCtzJzogKCkgPT4gew0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLnNhdmVGbG93QXMoKTsNCiAgICAgICAgfSwNCiAgICAgICAgJ2NtZCtzaGlmdCtzJzogKCkgPT4gew0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmZpbGVNYW5hZ2VyLnNhdmVGbG93QXMoKTsNCiAgICAgICAgfSwNCiAgICAgICAgJ2N0cmwrbyc6ICgpID0+IHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5maWxlTWFuYWdlci5sb2FkRmxvdygpOw0KICAgICAgICB9LA0KICAgICAgICAnY21kK28nOiAoKSA9PiB7DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuZmlsZU1hbmFnZXIubG9hZEZsb3coKTsNCiAgICAgICAgfSwNCiAgICAgICAgJ2N0cmwrPSc6ICgpID0+IHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnpvb21JbigpOw0KICAgICAgICB9LA0KICAgICAgICAnY21kKz0nOiAoKSA9PiB7DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci56b29tSW4oKTsNCiAgICAgICAgfSwNCiAgICAgICAgJ2N0cmwrLSc6ICgpID0+IHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnpvb21PdXQoKTsNCiAgICAgICAgfSwNCiAgICAgICAgJ2NtZCstJzogKCkgPT4gew0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIuem9vbU91dCgpOw0KICAgICAgICB9LA0KICAgICAgICAnY3RybCswJzogKCkgPT4gew0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIucmVzZXRDYW52YXNQYW4oKTsNCiAgICAgICAgfSwNCiAgICAgICAgJ2NtZCswJzogKCkgPT4gew0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldEFwcFdpbmRvdygpLmNhbnZhc01hbmFnZXIucmVzZXRDYW52YXNQYW4oKTsNCiAgICAgICAgfSwNCiAgICAgICAgJ2N0cmwrc2hpZnQrZic6ICgpID0+IHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRBcHBXaW5kb3coKS5jYW52YXNNYW5hZ2VyLnpvb21Ub0ZpdCgpOw0KICAgICAgICB9LA0KICAgICAgICAnY21kK3NoaWZ0K2YnOiAoKSA9PiB7DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0QXBwV2luZG93KCkuY2FudmFzTWFuYWdlci56b29tVG9GaXQoKTsNCiAgICAgICAgfQ0KICAgIH0sIHsNCiAgICAgICAgcHJldmVudERlZmF1bHQ6IHRydWUsDQogICAgICAgIHN0b3BQcm9wYWdhdGlvbjogZmFsc2UNCiAgICB9KTsNCiAgICANCg0KfQ0KDQovLyBJbml0aWFsaXplIHdoZW4gRE9NIGlzIHJlYWR5DQppZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXRGbG93RWRpdG9yKTsNCn0gZWxzZSB7DQogICAgLy8gRE9NIGlzIGFscmVhZHkgbG9hZGVkDQogICAgaW5pdEZsb3dFZGl0b3IoKTsNCn0NCg0KDQo8L3NjcmlwdD4="
  },
  "package_info": {
    "format_version": "1.0",
    "created_at": "2025-08-12T01:31:41.693684",
    "packaged_by": "Sypnex OS App Packager",
    "source_directory": ".\\flow_editor"
  },
  "additional_files": [
    {
      "vfs_path": "/apps/installed/flow_editor/nodes-pack.json",
      "filename": "nodes-pack.json",
      "data": "ew0KICAidmVyc2lvbiI6ICIxLjAuMCIsDQogICJwYWNrZWRfYXQiOiAiMjAyNS0wOC0wOFQxNDo0NjoyMy4zNjQzNDYiLA0KICAidG90YWxfbm9kZXMiOiAyMSwNCiAgIm5vZGVzIjogew0KICAgICJhcnJheSI6IHsNCiAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAibmFtZSI6ICJBcnJheSBPcGVyYXRpb25zIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQcm9jZXNzIGFycmF5cyBhbmQgbGlzdHMgd2l0aCBtYXAsIGZpbHRlciwgYW5kIG90aGVyIG9wZXJhdGlvbnMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWxpc3QiLA0KICAgICAgImNvbG9yIjogInByaW1hcnkiLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAgICAgIm5hbWUiOiAiQXJyYXkiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJvYmplY3QiLA0KICAgICAgICAgICJuYW1lIjogIk9iamVjdCIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInJlc3VsdCIsDQogICAgICAgICAgIm5hbWUiOiAiUmVzdWx0IiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJsZW5ndGgiLA0KICAgICAgICAgICJuYW1lIjogIkxlbmd0aCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpcnN0IiwNCiAgICAgICAgICAibmFtZSI6ICJGaXJzdCBJdGVtIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImxhc3QiLA0KICAgICAgICAgICJuYW1lIjogIkxhc3QgSXRlbSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJyYW5kb20iLA0KICAgICAgICAgICJuYW1lIjogIlJhbmRvbSBJdGVtIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgIm9wZXJhdGlvbiI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJPcGVyYXRpb24iLA0KICAgICAgICAgICJ2YWx1ZSI6ICJtYXAiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgIm1hcCIsDQogICAgICAgICAgICAiZmlsdGVyIiwNCiAgICAgICAgICAgICJsZW5ndGgiLA0KICAgICAgICAgICAgImpvaW4iLA0KICAgICAgICAgICAgImZpcnN0IiwNCiAgICAgICAgICAgICJsYXN0IiwNCiAgICAgICAgICAgICJyYW5kb20iLA0KICAgICAgICAgICAgInNsaWNlIiwNCiAgICAgICAgICAgICJyZXZlcnNlIiwNCiAgICAgICAgICAgICJzb3J0IiwNCiAgICAgICAgICAgICJ1bmlxdWUiLA0KICAgICAgICAgICAgIm9iamVjdF9rZXlzIiwNCiAgICAgICAgICAgICJvYmplY3RfdmFsdWVzIiwNCiAgICAgICAgICAgICJvYmplY3RfZW50cmllcyINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJmaWVsZF9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWVsZCBQYXRoIChmb3IgbWFwL2ZpbHRlcikiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJlLmcuLCBuYW1lLCB1c2VyLmVtYWlsLCBpZCINCiAgICAgICAgfSwNCiAgICAgICAgImZpbHRlcl92YWx1ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRmlsdGVyIFZhbHVlIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiVmFsdWUgdG8gZmlsdGVyIGJ5Ig0KICAgICAgICB9LA0KICAgICAgICAiZmlsdGVyX29wZXJhdG9yIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkZpbHRlciBPcGVyYXRvciIsDQogICAgICAgICAgInZhbHVlIjogImVxdWFscyIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAiZXF1YWxzIiwNCiAgICAgICAgICAgICJub3RfZXF1YWxzIiwNCiAgICAgICAgICAgICJjb250YWlucyIsDQogICAgICAgICAgICAiZ3JlYXRlcl90aGFuIiwNCiAgICAgICAgICAgICJsZXNzX3RoYW4iLA0KICAgICAgICAgICAgInN0YXJ0c193aXRoIiwNCiAgICAgICAgICAgICJlbmRzX3dpdGgiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiam9pbl9zZXBhcmF0b3IiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkpvaW4gU2VwYXJhdG9yIiwNCiAgICAgICAgICAidmFsdWUiOiAiLCAiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJTZXBhcmF0b3IgZm9yIGpvaW4gb3BlcmF0aW9uIg0KICAgICAgICB9LA0KICAgICAgICAic2xpY2Vfc3RhcnQiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiU2xpY2UgU3RhcnQiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDANCiAgICAgICAgfSwNCiAgICAgICAgInNsaWNlX2VuZCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJTbGljZSBFbmQgKDAgPSBlbmQpIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiYXJyYXlfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImF1ZGlvIjogew0KICAgICAgImlkIjogImF1ZGlvIiwNCiAgICAgICJuYW1lIjogIkF1ZGlvIFBsYXllciIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheSBhdWRpbyBmaWxlcyBhbmQgY29udHJvbCBwbGF5YmFjayIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtdm9sdW1lLXVwIiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJtZWRpYSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiZnJvbnRlbmRfb25seSIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhdWRpb19kYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJBdWRpbyBEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidXJsIiwNCiAgICAgICAgICAibmFtZSI6ICJVUkwiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJpbmFyeSIsDQogICAgICAgICAgIm5hbWUiOiAiQmluYXJ5IiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYXVkaW9fZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiQXVkaW8gRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImF1ZGlvX3VybCIsDQogICAgICAgICAgIm5hbWUiOiAiQXVkaW8gVVJMIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImR1cmF0aW9uIiwNCiAgICAgICAgICAibmFtZSI6ICJEdXJhdGlvbiIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm9yaWdpbmFsIiwNCiAgICAgICAgICAibmFtZSI6ICJPcmlnaW5hbCIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImF1dG9QbGF5Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkF1dG8gUGxheSIsDQogICAgICAgICAgInZhbHVlIjogImZhbHNlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJ2b2x1bWUiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiVm9sdW1lICgwLTEpIiwNCiAgICAgICAgICAidmFsdWUiOiAxLA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJtYXgiOiAxLA0KICAgICAgICAgICJzdGVwIjogMC4xDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiYXVkaW9fZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImNvbmRpdGlvbiI6IHsNCiAgICAgICJpZCI6ICJjb25kaXRpb24iLA0KICAgICAgIm5hbWUiOiAiQ29uZGl0aW9uIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJDb21wYXJlIGlucHV0IHZhbHVlIHRvIGEgY29uZGl0aW9uIGFuZCBvdXRwdXQgdHJ1ZS9mYWxzZSIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtcXVlc3Rpb24tY2lyY2xlIiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJsb2dpYyIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInZhbHVlIiwNCiAgICAgICAgICAibmFtZSI6ICJWYWx1ZSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInJlc3VsdCIsDQogICAgICAgICAgIm5hbWUiOiAiUmVzdWx0IiwNCiAgICAgICAgICAidHlwZSI6ICJib29sZWFuIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgIm9wZXJhdG9yIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk9wZXJhdG9yIiwNCiAgICAgICAgICAidmFsdWUiOiAiZXF1YWxzIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJlcXVhbHMiLA0KICAgICAgICAgICAgIm5vdF9lcXVhbHMiLA0KICAgICAgICAgICAgImdyZWF0ZXJfdGhhbiIsDQogICAgICAgICAgICAibGVzc190aGFuIiwNCiAgICAgICAgICAgICJncmVhdGVyX3RoYW5fb3JfZXF1YWwiLA0KICAgICAgICAgICAgImxlc3NfdGhhbl9vcl9lcXVhbCIsDQogICAgICAgICAgICAiY29udGFpbnMiLA0KICAgICAgICAgICAgIm5vdF9jb250YWlucyIsDQogICAgICAgICAgICAic3RhcnRzX3dpdGgiLA0KICAgICAgICAgICAgImVuZHNfd2l0aCIsDQogICAgICAgICAgICAiaXNfZW1wdHkiLA0KICAgICAgICAgICAgImlzX25vdF9lbXB0eSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJjb21wYXJlX3ZhbHVlIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJDb21wYXJlIFRvIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiVmFsdWUgdG8gY29tcGFyZSBhZ2FpbnN0Ig0KICAgICAgICB9LA0KICAgICAgICAiY2FzZV9zZW5zaXRpdmUiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQ2FzZSBTZW5zaXRpdmUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0cnVlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiY29uZGl0aW9uX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJkZWxheSI6IHsNCiAgICAgICJpZCI6ICJkZWxheSIsDQogICAgICAibmFtZSI6ICJEZWxheSIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiRGVsYXlzIHRoZSBmbG93IGV4ZWN1dGlvbiIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtY2xvY2siLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogImZsb3ciLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJleGVjdXRvciI6ICJkZWxheV9leGVjdXRvciIsDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiZGVsYXlfbXMiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiRGVsYXkgKG1pbGxpc2Vjb25kcykiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEwMDAsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgIm1heCI6IDYwMDAwLA0KICAgICAgICAgICJzdGVwIjogMTAwDQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KICAgICJkaXNwbGF5Ijogew0KICAgICAgImlkIjogImRpc3BsYXkiLA0KICAgICAgIm5hbWUiOiAiRGlzcGxheSBUZXh0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEaXNwbGF5IHRleHQgZGF0YSBpbiB2YXJpb3VzIGZvcm1hdHMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWV5ZSIsDQogICAgICAiY29sb3IiOiAic3VjY2VzcyIsDQogICAgICAiY2F0ZWdvcnkiOiAib3V0cHV0IiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJmcm9udGVuZF9vbmx5IiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImpzb24iLA0KICAgICAgICAgICJuYW1lIjogIkpTT04iLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkaXNwbGF5ZWQiLA0KICAgICAgICAgICJuYW1lIjogIkRpc3BsYXllZCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJpbnB1dF9wb3J0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIklucHV0IFBvcnQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJhdXRvIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJhdXRvIiwNCiAgICAgICAgICAgICJ0ZXh0IiwNCiAgICAgICAgICAgICJqc29uIiwNCiAgICAgICAgICAgICJkYXRhIiwNCiAgICAgICAgICAgICJiaW5hcnkiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiZm9ybWF0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkZvcm1hdCIsDQogICAgICAgICAgInZhbHVlIjogInRleHQiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRleHQiLA0KICAgICAgICAgICAgImpzb24iLA0KICAgICAgICAgICAgImh0bWwiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAibWF4TGVuZ3RoIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIk1heCBMZW5ndGgiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEwMDAsDQogICAgICAgICAgIm1pbiI6IDEsDQogICAgICAgICAgIm1heCI6IDEwMDAwLA0KICAgICAgICAgICJzdGVwIjogMTAwDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiZGlzcGxheV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAiZm9yX2VhY2giOiB7DQogICAgICAiaWQiOiAiZm9yX2VhY2giLA0KICAgICAgIm5hbWUiOiAiRm9yIEVhY2giLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkl0ZXJhdGUgdGhyb3VnaCBhbiBhcnJheSBhbmQgZXhlY3V0ZSBjb25uZWN0ZWQgbm9kZXMgZm9yIGVhY2ggaXRlbSIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtcmVwZWF0IiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJmbG93IiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAgICAgIm5hbWUiOiAiQXJyYXkiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjdXJyZW50X2l0ZW0iLA0KICAgICAgICAgICJuYW1lIjogIkN1cnJlbnQgSXRlbSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjdXJyZW50X2luZGV4IiwNCiAgICAgICAgICAibmFtZSI6ICJDdXJyZW50IEluZGV4IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiY29tcGxldGVkIiwNCiAgICAgICAgICAibmFtZSI6ICJDb21wbGV0ZWQiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAic3RvcF9vbl9lcnJvciI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJTdG9wIG9uIEVycm9yIiwNCiAgICAgICAgICAidmFsdWUiOiAidHJ1ZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiaXRlcmF0aW9uX2RlbGF5Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkl0ZXJhdGlvbiBEZWxheSAobXMpIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJtYXgiOiA2MDAwMCwNCiAgICAgICAgICAic3RlcCI6IDEwMCwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiRGVsYXkgYmV0d2VlbiBpdGVyYXRpb25zIGluIG1pbGxpc2Vjb25kcyINCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJmb3JfZWFjaF9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAiaHR0cCI6IHsNCiAgICAgICJpZCI6ICJodHRwIiwNCiAgICAgICJuYW1lIjogIkhUVFAgUmVxdWVzdCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiTWFrZSBIVFRQIHJlcXVlc3RzIHRvIGV4dGVybmFsIEFQSXMgYW5kIHNlcnZpY2VzIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1nbG9iZSIsDQogICAgICAiY29sb3IiOiAicHJpbWFyeSIsDQogICAgICAiY2F0ZWdvcnkiOiAibmV0d29yayIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJqc29uIiwNCiAgICAgICAgICAibmFtZSI6ICJKU09OIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJpbmFyeSIsDQogICAgICAgICAgIm5hbWUiOiAiQmluYXJ5IiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAic3RhdHVzX2NvZGUiLA0KICAgICAgICAgICJuYW1lIjogIlN0YXR1cyBDb2RlIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiaGVhZGVycyIsDQogICAgICAgICAgIm5hbWUiOiAiSGVhZGVycyIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ1cmwiLA0KICAgICAgICAgICJuYW1lIjogIlVSTCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJ1cmwiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIlVSTCIsDQogICAgICAgICAgInZhbHVlIjogImh0dHBzOi8vanNvbnBsYWNlaG9sZGVyLnR5cGljb2RlLmNvbS9wb3N0cy8xIg0KICAgICAgICB9LA0KICAgICAgICAibWV0aG9kIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk1ldGhvZCIsDQogICAgICAgICAgInZhbHVlIjogIkdFVCIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAiR0VUIiwNCiAgICAgICAgICAgICJQT1NUIiwNCiAgICAgICAgICAgICJQVVQiLA0KICAgICAgICAgICAgIkRFTEVURSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJoZWFkZXJzIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHRhcmVhIiwNCiAgICAgICAgICAibGFiZWwiOiAiSGVhZGVycyAoSlNPTikiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ7XCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJ9Ig0KICAgICAgICB9LA0KICAgICAgICAiYm9keSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0YXJlYSIsDQogICAgICAgICAgImxhYmVsIjogIkJvZHkgKEpTT04pIiwNCiAgICAgICAgICAidmFsdWUiOiAie1wibWVzc2FnZVwiOiBcInt7VkFMVUV9fVwiLCBcInRpbWVzdGFtcFwiOiBcInt7SlNPTjp0aW1lc3RhbXB9fVwifSINCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJodHRwX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJpbWFnZSI6IHsNCiAgICAgICJpZCI6ICJpbWFnZSIsDQogICAgICAibmFtZSI6ICJJbWFnZSBEaXNwbGF5IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEaXNwbGF5IGltYWdlcyBhbmQgY29udHJvbCB2aXN1YWxpemF0aW9uIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1pbWFnZSIsDQogICAgICAiY29sb3IiOiAiaW5mbyIsDQogICAgICAiY2F0ZWdvcnkiOiAibWVkaWEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImZyb250ZW5kX29ubHkiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJpbmFyeSIsDQogICAgICAgICAgIm5hbWUiOiAiQmluYXJ5IiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiaW1hZ2VfZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiSW1hZ2UgRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInVybCIsDQogICAgICAgICAgIm5hbWUiOiAiVVJMIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJiaW5hcnkiLA0KICAgICAgICAgICJuYW1lIjogIkJpbmFyeSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImltYWdlX2RhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkltYWdlIERhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJpbWFnZV91cmwiLA0KICAgICAgICAgICJuYW1lIjogIkltYWdlIFVSTCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkaW1lbnNpb25zIiwNCiAgICAgICAgICAibmFtZSI6ICJEaW1lbnNpb25zIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm9yaWdpbmFsIiwNCiAgICAgICAgICAibmFtZSI6ICJPcmlnaW5hbCIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgIm1heF9wcmV2aWV3X3NpemUiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiTWF4IFByZXZpZXcgU2l6ZSIsDQogICAgICAgICAgInZhbHVlIjogMzAwLA0KICAgICAgICAgICJtaW4iOiA1MCwNCiAgICAgICAgICAibWF4IjogODAwLA0KICAgICAgICAgICJzdGVwIjogNTANCiAgICAgICAgfSwNCiAgICAgICAgInNob3dfaW5mbyI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJTaG93IEluZm8iLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0cnVlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiaW1hZ2VfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImpzb25fZXh0cmFjdCI6IHsNCiAgICAgICJpZCI6ICJqc29uX2V4dHJhY3QiLA0KICAgICAgIm5hbWUiOiAiSlNPTiBFeHRyYWN0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJFeHRyYWN0IHZhbHVlcyBmcm9tIEpTT04gZGF0YSB1c2luZyBkb3Qgbm90YXRpb24iLA0KICAgICAgImljb24iOiAiZmFzIGZhLWNvZGUtYnJhbmNoIiwNCiAgICAgICJjb2xvciI6ICJpbmZvIiwNCiAgICAgICJjYXRlZ29yeSI6ICJkYXRhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJqc29uIiwNCiAgICAgICAgICAibmFtZSI6ICJKU09OIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAianNvbiIsDQogICAgICAgICAgIm5hbWUiOiAiSlNPTiIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJleHRyYWN0ZWRfdmFsdWUiLA0KICAgICAgICAgICJuYW1lIjogIkV4dHJhY3RlZCBWYWx1ZSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJmaWVsZF9wYXRoIiwNCiAgICAgICAgICAibmFtZSI6ICJGaWVsZCBQYXRoIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm9yaWdpbmFsIiwNCiAgICAgICAgICAibmFtZSI6ICJPcmlnaW5hbCIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJmaWVsZF9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWVsZCBQYXRoIiwNCiAgICAgICAgICAidmFsdWUiOiAiZGF0YS5pdGVtcyIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlVzZSBkb3Qgbm90YXRpb24gKGUuZy4sIGRhdGEuaXRlbXMuMC5uYW1lKSINCiAgICAgICAgfSwNCiAgICAgICAgImRpc3BsYXlfZm9ybWF0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkRpc3BsYXkgRm9ybWF0IiwNCiAgICAgICAgICAidmFsdWUiOiAidGV4dCIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidGV4dCIsDQogICAgICAgICAgICAianNvbiINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAianNvbl9leHRyYWN0X2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJsbG1fY2hhdCI6IHsNCiAgICAgICJpZCI6ICJsbG1fY2hhdCIsDQogICAgICAibmFtZSI6ICJMTE0gQ2hhdCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiQ2hhdCB3aXRoIExhcmdlIExhbmd1YWdlIE1vZGVscyB1c2luZyBPbGxhbWEiLA0KICAgICAgImljb24iOiAiZmFzIGZhLXJvYm90IiwNCiAgICAgICJjb2xvciI6ICJpbmZvIiwNCiAgICAgICJjYXRlZ29yeSI6ICJhaSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInByb21wdCIsDQogICAgICAgICAgIm5hbWUiOiAiUHJvbXB0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInN5c3RlbV9tZXNzYWdlIiwNCiAgICAgICAgICAibmFtZSI6ICJTeXN0ZW0gTWVzc2FnZSIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjb250ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJDb250ZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAicmVzcG9uc2UiLA0KICAgICAgICAgICJuYW1lIjogIlJlc3BvbnNlIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRva2Vuc191c2VkIiwNCiAgICAgICAgICAibmFtZSI6ICJUb2tlbnMgVXNlZCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm1vZGVsX3VzZWQiLA0KICAgICAgICAgICJuYW1lIjogIk1vZGVsIFVzZWQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZnVsbF9yZXNwb25zZSIsDQogICAgICAgICAgIm5hbWUiOiAiRnVsbCBSZXNwb25zZSIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJlbmRwb2ludCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT2xsYW1hIEVuZHBvaW50IiwNCiAgICAgICAgICAidmFsdWUiOiAiaHR0cDovLzEyNy4wLjAuMToxMTQzNC92MSIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogImh0dHA6Ly8xMjcuMC4wLjE6MTE0MzQvdjEiDQogICAgICAgIH0sDQogICAgICAgICJtb2RlbCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiTW9kZWwgTmFtZSIsDQogICAgICAgICAgInZhbHVlIjogIkhhbW1lckFJL21uLW1hZy1tZWxsLXIxOmxhdGVzdCIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogImxsYW1hMiwgY29kZWxsYW1hLCBldGMuIg0KICAgICAgICB9LA0KICAgICAgICAidGVtcGVyYXR1cmUiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiVGVtcGVyYXR1cmUiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAuNywNCiAgICAgICAgICAibWluIjogMCwNCiAgICAgICAgICAibWF4IjogMiwNCiAgICAgICAgICAic3RlcCI6IDAuMQ0KICAgICAgICB9LA0KICAgICAgICAibWF4X3Rva2VucyI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJNYXggVG9rZW5zIiwNCiAgICAgICAgICAidmFsdWUiOiAyMDQ4LA0KICAgICAgICAgICJtaW4iOiAxLA0KICAgICAgICAgICJtYXgiOiA4MTkyLA0KICAgICAgICAgICJzdGVwIjogMQ0KICAgICAgICB9LA0KICAgICAgICAic3lzdGVtX3Byb21wdCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0YXJlYSIsDQogICAgICAgICAgImxhYmVsIjogIlN5c3RlbSBQcm9tcHQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJZb3UgYXJlIGEgaGVscGZ1bCBBSSBhc3Npc3RhbnQuIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiRGVmaW5lIHRoZSBBSSdzIHJvbGUgYW5kIGJlaGF2aW9yIg0KICAgICAgICB9LA0KICAgICAgICAiYXBpX2tleSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQVBJIEtleSIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIkVudGVyIHlvdXIgQVBJIGtleSAob3B0aW9uYWwgZm9yIGxvY2FsIG1vZGVscykiLA0KICAgICAgICAgICJlbmNyeXB0IjogdHJ1ZQ0KICAgICAgICB9LA0KICAgICAgICAiaW5jbHVkZV9jb250ZXh0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkluY2x1ZGUgQ29udGV4dCIsDQogICAgICAgICAgInZhbHVlIjogInRydWUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJsbG1fY2hhdF9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAibG9naWNhbF9nYXRlIjogew0KICAgICAgImlkIjogImxvZ2ljYWxfZ2F0ZSIsDQogICAgICAibmFtZSI6ICJMb2dpY2FsIEdhdGUiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIk9ubHkgY29udGludWUgZXhlY3V0aW9uIGlmIGlucHV0IGlzIHRydWUiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWZpbHRlciIsDQogICAgICAiY29sb3IiOiAiaW5mbyIsDQogICAgICAiY2F0ZWdvcnkiOiAibG9naWMiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjb25kaXRpb24iLA0KICAgICAgICAgICJuYW1lIjogIkNvbmRpdGlvbiIsDQogICAgICAgICAgInR5cGUiOiAiYm9vbGVhbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiaW52ZXJ0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkludmVydCBMb2dpYyIsDQogICAgICAgICAgInZhbHVlIjogImZhbHNlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJkZXNjcmlwdGlvbiI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRGVzY3JpcHRpb24iLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJPcHRpb25hbCBkZXNjcmlwdGlvbiBvZiB3aGF0IHRoaXMgZ2F0ZSBkb2VzIg0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImxvZ2ljYWxfZ2F0ZV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAibWF0aCI6IHsNCiAgICAgICJpZCI6ICJtYXRoIiwNCiAgICAgICJuYW1lIjogIk1hdGggT3BlcmF0aW9ucyIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiUGVyZm9ybSBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvbiBudW1lcmljIHZhbHVlcyIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtY2FsY3VsYXRvciIsDQogICAgICAiY29sb3IiOiAiaW5mbyIsDQogICAgICAiY2F0ZWdvcnkiOiAiZGF0YSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInZhbHVlX2EiLA0KICAgICAgICAgICJuYW1lIjogIlZhbHVlIEEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidmFsdWVfYiIsDQogICAgICAgICAgIm5hbWUiOiAiVmFsdWUgQiIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJudW1iZXJfYSIsDQogICAgICAgICAgIm5hbWUiOiAiTnVtYmVyIEEiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJudW1iZXJfYiIsDQogICAgICAgICAgIm5hbWUiOiAiTnVtYmVyIEIiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInJlc3VsdCIsDQogICAgICAgICAgIm5hbWUiOiAiUmVzdWx0IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZvcm1hdHRlZCIsDQogICAgICAgICAgIm5hbWUiOiAiRm9ybWF0dGVkIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgIm9wZXJhdGlvbiI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJPcGVyYXRpb24iLA0KICAgICAgICAgICJ2YWx1ZSI6ICJhZGQiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImFkZCIsDQogICAgICAgICAgICAic3VidHJhY3QiLA0KICAgICAgICAgICAgIm11bHRpcGx5IiwNCiAgICAgICAgICAgICJkaXZpZGUiLA0KICAgICAgICAgICAgIm1vZHVsbyIsDQogICAgICAgICAgICAicG93ZXIiLA0KICAgICAgICAgICAgIm1pbiIsDQogICAgICAgICAgICAibWF4IiwNCiAgICAgICAgICAgICJhYnMiLA0KICAgICAgICAgICAgInJvdW5kIiwNCiAgICAgICAgICAgICJmbG9vciIsDQogICAgICAgICAgICAiY2VpbCINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJ2YWx1ZV9hIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIlZhbHVlIEEgKGlmIG5vdCBjb25uZWN0ZWQpIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJzdGVwIjogMC4wMQ0KICAgICAgICB9LA0KICAgICAgICAidmFsdWVfYiI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJWYWx1ZSBCIChpZiBub3QgY29ubmVjdGVkKSIsDQogICAgICAgICAgInZhbHVlIjogMCwNCiAgICAgICAgICAic3RlcCI6IDAuMDENCiAgICAgICAgfSwNCiAgICAgICAgImRlY2ltYWxfcGxhY2VzIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkRlY2ltYWwgUGxhY2VzIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJtYXgiOiAxMCwNCiAgICAgICAgICAic3RlcCI6IDENCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJtYXRoX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJub2RlX3JlZmVyZW5jZSI6IHsNCiAgICAgICJpZCI6ICJub2RlX3JlZmVyZW5jZSIsDQogICAgICAibmFtZSI6ICJOb2RlIFJlZmVyZW5jZSIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiQWNjZXNzIG91dHB1dCBkYXRhIGZyb20gYW55IHByZXZpb3VzbHkgZXhlY3V0ZWQgbm9kZSBpbiB0aGUgd29ya2Zsb3ciLA0KICAgICAgImljb24iOiAiZmFzIGZhLWxpbmsiLA0KICAgICAgImNvbG9yIjogImluZm8iLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIiwNCiAgICAgICAgICAib3B0aW9uYWwiOiB0cnVlDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAianNvbiIsDQogICAgICAgICAgIm5hbWUiOiAiSlNPTiIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJudW1iZXIiLA0KICAgICAgICAgICJuYW1lIjogIk51bWJlciIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJvb2xlYW4iLA0KICAgICAgICAgICJuYW1lIjogIkJvb2xlYW4iLA0KICAgICAgICAgICJ0eXBlIjogImJvb2xlYW4iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJvcmlnaW5hbCIsDQogICAgICAgICAgIm5hbWUiOiAiT3JpZ2luYWwiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAic291cmNlX25vZGVfaWQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiU291cmNlIE5vZGUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJvcHRpb25zIjogW10sDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlNlbGVjdCBhIG5vZGUgdG8gcmVmZXJlbmNlIg0KICAgICAgICB9LA0KICAgICAgICAib3V0cHV0X3BvcnRfaWQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3V0cHV0IFBvcnQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJvcHRpb25zIjogW10sDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlNlbGVjdCBhbiBvdXRwdXQgcG9ydCINCiAgICAgICAgfSwNCiAgICAgICAgImZhbGxiYWNrX3ZhbHVlIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGYWxsYmFjayBWYWx1ZSIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlZhbHVlIHRvIHVzZSBpZiByZWZlcmVuY2UgZmFpbHMiDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAibm9kZV9yZWZlcmVuY2VfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInJhbmRvbSI6IHsNCiAgICAgICJpZCI6ICJyYW5kb20iLA0KICAgICAgIm5hbWUiOiAiUmFuZG9tIE51bWJlciIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiR2VuZXJhdGUgcmFuZG9tIG51bWJlcnMgd2l0aGluIGEgc3BlY2lmaWVkIHJhbmdlIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1kaWNlIiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJkYXRhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSIsDQogICAgICAgICAgIm9wdGlvbmFsIjogdHJ1ZQ0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAibnVtYmVyIiwNCiAgICAgICAgICAibmFtZSI6ICJOdW1iZXIiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiaW50ZWdlciIsDQogICAgICAgICAgIm5hbWUiOiAiSW50ZWdlciIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZsb2F0IiwNCiAgICAgICAgICAibmFtZSI6ICJGbG9hdCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgIm1pbl92YWx1ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJNaW5pbXVtIFZhbHVlIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJzdGVwIjogMC4wMQ0KICAgICAgICB9LA0KICAgICAgICAibWF4X3ZhbHVlIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIk1heGltdW0gVmFsdWUiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEwMCwNCiAgICAgICAgICAic3RlcCI6IDAuMDENCiAgICAgICAgfSwNCiAgICAgICAgImRlY2ltYWxfcGxhY2VzIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkRlY2ltYWwgUGxhY2VzIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJtYXgiOiAxMCwNCiAgICAgICAgICAic3RlcCI6IDENCiAgICAgICAgfSwNCiAgICAgICAgIm91dHB1dF90eXBlIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk91dHB1dCBUeXBlIiwNCiAgICAgICAgICAidmFsdWUiOiAiaW50ZWdlciIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAiaW50ZWdlciIsDQogICAgICAgICAgICAiZmxvYXQiDQogICAgICAgICAgXQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInJhbmRvbV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAicmVwZWF0ZXIiOiB7DQogICAgICAiaWQiOiAicmVwZWF0ZXIiLA0KICAgICAgIm5hbWUiOiAiUmVwZWF0ZXIiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIlJlcGVhdCBjb25uZWN0ZWQgd29ya2Zsb3cgYXQgaW50ZXJ2YWxzIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1yZWRvIiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJ0cmlnZ2VyIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiY291bnQiLA0KICAgICAgICAgICJuYW1lIjogIkNvdW50IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiaW50ZXJ2YWwiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiSW50ZXJ2YWwgKG1zKSIsDQogICAgICAgICAgInZhbHVlIjogMTAwMCwNCiAgICAgICAgICAibWluIjogMTAwLA0KICAgICAgICAgICJtYXgiOiAzMDAwMDAsDQogICAgICAgICAgInN0ZXAiOiAxMDANCiAgICAgICAgfSwNCiAgICAgICAgImNvdW50Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkNvdW50ICgwID0gaW5maW5pdGUpIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJzdGVwIjogMQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInJlcGVhdGVyX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJzdHJpbmciOiB7DQogICAgICAiaWQiOiAic3RyaW5nIiwNCiAgICAgICJuYW1lIjogIlN0cmluZyBPcGVyYXRpb25zIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJNYW5pcHVsYXRlIGFuZCBwcm9jZXNzIHRleHQgc3RyaW5ncyB3aXRoIHZhcmlvdXMgb3BlcmF0aW9ucyIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtdGV4dC13aWR0aCIsDQogICAgICAiY29sb3IiOiAic2Vjb25kYXJ5IiwNCiAgICAgICJjYXRlZ29yeSI6ICJkYXRhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0X2IiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQgQiIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAicmVzdWx0IiwNCiAgICAgICAgICAibmFtZSI6ICJSZXN1bHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAgICAgIm5hbWUiOiAiQXJyYXkiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAibGVuZ3RoIiwNCiAgICAgICAgICAibmFtZSI6ICJMZW5ndGgiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ3b3JkX2NvdW50IiwNCiAgICAgICAgICAibmFtZSI6ICJXb3JkIENvdW50IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAib3BlcmF0aW9uIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk9wZXJhdGlvbiIsDQogICAgICAgICAgInZhbHVlIjogImNvbmNhdGVuYXRlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJjb25jYXRlbmF0ZSIsDQogICAgICAgICAgICAic3BsaXQiLA0KICAgICAgICAgICAgInJlcGxhY2UiLA0KICAgICAgICAgICAgInRyaW0iLA0KICAgICAgICAgICAgInVwcGVyY2FzZSIsDQogICAgICAgICAgICAibG93ZXJjYXNlIiwNCiAgICAgICAgICAgICJzdWJzdHJpbmciLA0KICAgICAgICAgICAgInJlZ2V4X21hdGNoIiwNCiAgICAgICAgICAgICJyZWdleF9yZXBsYWNlIiwNCiAgICAgICAgICAgICJzdGFydHNfd2l0aCIsDQogICAgICAgICAgICAiZW5kc193aXRoIiwNCiAgICAgICAgICAgICJjb250YWlucyIsDQogICAgICAgICAgICAicmVwZWF0IiwNCiAgICAgICAgICAgICJsYXN0X2xpbmUiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAidGV4dF9iIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJUZXh0IEIgKGlmIG5vdCBjb25uZWN0ZWQpIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiU2Vjb25kIHRleHQgaW5wdXQiDQogICAgICAgIH0sDQogICAgICAgICJzZXBhcmF0b3IiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIlNlcGFyYXRvci9EZWxpbWl0ZXIiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIsIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiRm9yIHNwbGl0L2pvaW4gb3BlcmF0aW9ucyINCiAgICAgICAgfSwNCiAgICAgICAgInNlYXJjaF90ZXh0Ijogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJTZWFyY2ggVGV4dCIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlRleHQgdG8gc2VhcmNoL3JlcGxhY2UiDQogICAgICAgIH0sDQogICAgICAgICJyZXBsYWNlX3RleHQiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIlJlcGxhY2UgV2l0aCIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlJlcGxhY2VtZW50IHRleHQiDQogICAgICAgIH0sDQogICAgICAgICJzdGFydF9pbmRleCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJTdGFydCBJbmRleCIsDQogICAgICAgICAgInZhbHVlIjogMCwNCiAgICAgICAgICAibWluIjogMA0KICAgICAgICB9LA0KICAgICAgICAiZW5kX2luZGV4Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkVuZCBJbmRleCAoMCA9IGVuZCkiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDANCiAgICAgICAgfSwNCiAgICAgICAgInJlcGVhdF9jb3VudCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJSZXBlYXQgQ291bnQiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEsDQogICAgICAgICAgIm1pbiI6IDEsDQogICAgICAgICAgIm1heCI6IDEwMA0KICAgICAgICB9LA0KICAgICAgICAiY2FzZV9zZW5zaXRpdmUiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQ2FzZSBTZW5zaXRpdmUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0cnVlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAic3RyaW5nX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJ0ZXh0Ijogew0KICAgICAgImlkIjogInRleHQiLA0KICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiT3V0cHV0IHN0YXRpYyB0ZXh0IGNvbnRlbnQiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWZvbnQiLA0KICAgICAgImNvbG9yIjogInNlY29uZGFyeSIsDQogICAgICAiY2F0ZWdvcnkiOiAiZGF0YSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ1cHBlcmNhc2UiLA0KICAgICAgICAgICJuYW1lIjogIlVwcGVyY2FzZSIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJsb3dlcmNhc2UiLA0KICAgICAgICAgICJuYW1lIjogIkxvd2VyY2FzZSIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ3b3JkX2NvdW50IiwNCiAgICAgICAgICAibmFtZSI6ICJXb3JkIENvdW50IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAibGVuZ3RoIiwNCiAgICAgICAgICAibmFtZSI6ICJMZW5ndGgiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJ0ZXh0X2NvbnRlbnQiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dGFyZWEiLA0KICAgICAgICAgICJsYWJlbCI6ICJUZXh0IENvbnRlbnQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJIZWxsbywgV29ybGQhIg0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInRleHRfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInRpbWVyIjogew0KICAgICAgImlkIjogInRpbWVyIiwNCiAgICAgICJuYW1lIjogIlRpbWVyIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEZWxheSBleGVjdXRpb24gZm9yIHNwZWNpZmllZCBtaWxsaXNlY29uZHMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWNsb2NrIiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJ0cmlnZ2VyIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRpbWVzdGFtcCIsDQogICAgICAgICAgIm5hbWUiOiAiVGltZXN0YW1wIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZWxhcHNlZCIsDQogICAgICAgICAgIm5hbWUiOiAiRWxhcHNlZCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImludGVydmFsIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkludGVydmFsIChtcykiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEwMDAsDQogICAgICAgICAgIm1pbiI6IDEwMCwNCiAgICAgICAgICAibWF4IjogNjAwMDAsDQogICAgICAgICAgInN0ZXAiOiAxMDANCiAgICAgICAgfSwNCiAgICAgICAgImNvdW50Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkNvdW50IiwNCiAgICAgICAgICAidmFsdWUiOiAxLA0KICAgICAgICAgICJtaW4iOiAxLA0KICAgICAgICAgICJtYXgiOiAxMDAsDQogICAgICAgICAgInN0ZXAiOiAxDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAidGltZXJfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInZmc19kaXJlY3RvcnlfbGlzdCI6IHsNCiAgICAgICJpZCI6ICJ2ZnNfZGlyZWN0b3J5X2xpc3QiLA0KICAgICAgIm5hbWUiOiAiVkZTIERpcmVjdG9yeSBMaXN0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJMaXN0IGFsbCBmaWxlcyBhbmQgZGlyZWN0b3JpZXMgaW4gYSBWRlMgcGF0aCIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtZm9sZGVyLXRyZWUiLA0KICAgICAgImNvbG9yIjogInByaW1hcnkiLA0KICAgICAgImNhdGVnb3J5IjogInN0b3JhZ2UiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRpcmVjdG9yeV9wYXRoIiwNCiAgICAgICAgICAibmFtZSI6ICJEaXJlY3RvcnkgUGF0aCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpbGVfbGlzdCIsDQogICAgICAgICAgIm5hbWUiOiAiRmlsZSBMaXN0IiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpbGVfcGF0aHMiLA0KICAgICAgICAgICJuYW1lIjogIkZpbGUgUGF0aHMiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZmlsZV9uYW1lcyIsDQogICAgICAgICAgIm5hbWUiOiAiRmlsZSBOYW1lcyIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjb3VudCIsDQogICAgICAgICAgIm5hbWUiOiAiRmlsZSBDb3VudCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRpcmVjdG9yaWVzIiwNCiAgICAgICAgICAibmFtZSI6ICJEaXJlY3RvcmllcyIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJmaWxlc19vbmx5IiwNCiAgICAgICAgICAibmFtZSI6ICJGaWxlcyBPbmx5IiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImRpcmVjdG9yeV9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJEaXJlY3RvcnkgUGF0aCIsDQogICAgICAgICAgInZhbHVlIjogIi8iLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICIvYWJzb2x1dGUvcGF0aC9pbi92ZnMiDQogICAgICAgIH0sDQogICAgICAgICJmaWx0ZXJfZXh0ZW5zaW9ucyI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRmlsZSBFeHRlbnNpb25zIEZpbHRlciIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogInR4dCxqc29uLG1kIChsZWF2ZSBlbXB0eSBmb3IgYWxsKSINCiAgICAgICAgfSwNCiAgICAgICAgImluY2x1ZGVfZGlyZWN0b3JpZXMiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiSW5jbHVkZSBEaXJlY3RvcmllcyIsDQogICAgICAgICAgInZhbHVlIjogInRydWUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgInJlY3Vyc2l2ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJSZWN1cnNpdmUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJmYWxzZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInZmc19kaXJlY3RvcnlfbGlzdF9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAidmZzX2xvYWQiOiB7DQogICAgICAiaWQiOiAidmZzX2xvYWQiLA0KICAgICAgIm5hbWUiOiAiVkZTIExvYWQiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkxvYWQgZGF0YSBmcm9tIHRoZSBWaXJ0dWFsIEZpbGUgU3lzdGVtIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1mb2xkZXItb3BlbiIsDQogICAgICAiY29sb3IiOiAicHJpbWFyeSIsDQogICAgICAiY2F0ZWdvcnkiOiAic3RvcmFnZSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpbGVfcGF0aCIsDQogICAgICAgICAgIm5hbWUiOiAiRmlsZSBQYXRoIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImZpbGVfcGF0aCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRmlsZSBQYXRoIiwNCiAgICAgICAgICAidmFsdWUiOiAiL215X2RhdGEuanNvbiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIi9hYnNvbHV0ZS9wYXRoL2luL3ZmcyINCiAgICAgICAgfSwNCiAgICAgICAgImZvcm1hdCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJGb3JtYXQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJqc29uIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJqc29uIiwNCiAgICAgICAgICAgICJ0ZXh0IiwNCiAgICAgICAgICAgICJiaW5hcnkiLA0KICAgICAgICAgICAgImJsb2IiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiYXV0b19yZWxvYWQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQXV0byBSZWxvYWQgb24gQ2hhbmdlIiwNCiAgICAgICAgICAidmFsdWUiOiAiZmFsc2UiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJ2ZnNfbG9hZF9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAidmZzX3NhdmUiOiB7DQogICAgICAiaWQiOiAidmZzX3NhdmUiLA0KICAgICAgIm5hbWUiOiAiVkZTIFNhdmUiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIlNhdmUgZGF0YSB0byB0aGUgVmlydHVhbCBGaWxlIFN5c3RlbSIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtc2F2ZSIsDQogICAgICAiY29sb3IiOiAicHJpbWFyeSIsDQogICAgICAiY2F0ZWdvcnkiOiAic3RvcmFnZSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJzdWNjZXNzIiwNCiAgICAgICAgICAibmFtZSI6ICJTdWNjZXNzIiwNCiAgICAgICAgICAidHlwZSI6ICJib29sZWFuIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImZpbGVfcGF0aCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRmlsZSBQYXRoIiwNCiAgICAgICAgICAidmFsdWUiOiAiL215X2RhdGEuanNvbiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIi9hYnNvbHV0ZS9wYXRoL2luL3ZmcyINCiAgICAgICAgfSwNCiAgICAgICAgImZvcm1hdCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJGb3JtYXQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJqc29uIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJqc29uIiwNCiAgICAgICAgICAgICJ0ZXh0IiwNCiAgICAgICAgICAgICJiaW5hcnkiLA0KICAgICAgICAgICAgImJsb2IiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAib3ZlcndyaXRlIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk92ZXJ3cml0ZSIsDQogICAgICAgICAgInZhbHVlIjogInRydWUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgImFwcGVuZCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJBcHBlbmQgTW9kZSIsDQogICAgICAgICAgInZhbHVlIjogImZhbHNlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAidmZzX3NhdmVfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0NCiAgfQ0KfQ==",
      "size": 38497
    }
  ]
}