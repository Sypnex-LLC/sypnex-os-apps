{
  "app_metadata": {
    "id": "flow_editor",
    "name": "Flow Editor",
    "description": "Visual node-based workflow editor for creating and executing data processing pipelines",
    "icon": "fas fa-project-diagram",
    "keywords": [
      "flow",
      "workflow",
      "nodes",
      "pipeline",
      "visual",
      "editor"
    ],
    "author": "Sypnex OS",
    "version": "1.1.0",
    "type": "user_app",
    "scripts": [
      "js/utils.js",
      "js/node-registry.js",
      "js/canvas.js",
      "js/node-config.js",
      "js/node-renderer.js",
      "js/data-executors.js",
      "js/http-executors.js",
      "js/media-executors.js",
      "js/flow-executors.js",
      "js/ai-executors.js",
      "js/execution-engine.js",
      "js/workflow.js",
      "js/canvas-manager.js",
      "js/tag-manager.js",
      "js/file-manager.js",
      "js/ui-manager.js",
      "js/main.js"
    ],
    "styles": [
      "css/layout.css",
      "css/nodes.css",
      "css/components.css",
      "css/node-types.css",
      "css/responsive.css",
      "css/os-theme.css"
    ],
    "additional_files": [
      {
        "vfs_path": "/nodes/nodes-pack.json",
        "source_file": "node-definitions/nodes-pack.json"
      }
    ],
    "settings": [
      {
        "key": "DEFAULT_HTTP_TIMEOUT",
        "name": "HTTP Timeout (ms)",
        "type": "number",
        "value": 30000,
        "description": "Default timeout for HTTP requests in milliseconds"
      },
      {
        "key": "AUTO_SAVE_INTERVAL",
        "name": "Auto Save Interval (s)",
        "type": "number",
        "value": 30,
        "description": "Auto save workflows every N seconds (0 = disabled)"
      },
      {
        "key": "MAX_NODES",
        "name": "Maximum Nodes",
        "type": "number",
        "value": 50,
        "description": "Maximum number of nodes allowed in a workflow"
      }
    ]
  },
  "files": {
    "flow_editor.app": "ew0KICAiaWQiOiAiZmxvd19lZGl0b3IiLA0KICAibmFtZSI6ICJGbG93IEVkaXRvciIsDQogICJkZXNjcmlwdGlvbiI6ICJWaXN1YWwgbm9kZS1iYXNlZCB3b3JrZmxvdyBlZGl0b3IgZm9yIGNyZWF0aW5nIGFuZCBleGVjdXRpbmcgZGF0YSBwcm9jZXNzaW5nIHBpcGVsaW5lcyIsDQogICJpY29uIjogImZhcyBmYS1wcm9qZWN0LWRpYWdyYW0iLA0KICAia2V5d29yZHMiOiBbImZsb3ciLCAid29ya2Zsb3ciLCAibm9kZXMiLCAicGlwZWxpbmUiLCAidmlzdWFsIiwgImVkaXRvciJdLA0KICAiYXV0aG9yIjogIlN5cG5leCBPUyIsDQogICJ2ZXJzaW9uIjogIjEuMS4wIiwNCiAgInR5cGUiOiAidXNlcl9hcHAiLA0KICAic2NyaXB0cyI6IFsNCiAgICAianMvdXRpbHMuanMiLA0KICAgICJqcy9ub2RlLXJlZ2lzdHJ5LmpzIiwNCiAgICAianMvY2FudmFzLmpzIiwNCiAgICAianMvbm9kZS1jb25maWcuanMiLA0KICAgICJqcy9ub2RlLXJlbmRlcmVyLmpzIiwNCiAgICAianMvZGF0YS1leGVjdXRvcnMuanMiLA0KICAgICJqcy9odHRwLWV4ZWN1dG9ycy5qcyIsDQogICAgImpzL21lZGlhLWV4ZWN1dG9ycy5qcyIsDQogICAgImpzL2Zsb3ctZXhlY3V0b3JzLmpzIiwNCiAgICAianMvYWktZXhlY3V0b3JzLmpzIiwNCiAgICAianMvZXhlY3V0aW9uLWVuZ2luZS5qcyIsDQogICAgImpzL3dvcmtmbG93LmpzIiwNCiAgICAianMvY2FudmFzLW1hbmFnZXIuanMiLA0KICAgICJqcy90YWctbWFuYWdlci5qcyIsDQogICAgImpzL2ZpbGUtbWFuYWdlci5qcyIsDQogICAgImpzL3VpLW1hbmFnZXIuanMiLA0KICAgICJqcy9tYWluLmpzIg0KICBdLA0KICAic3R5bGVzIjogWw0KICAgICJjc3MvbGF5b3V0LmNzcyIsDQogICAgImNzcy9ub2Rlcy5jc3MiLA0KICAgICJjc3MvY29tcG9uZW50cy5jc3MiLA0KICAgICJjc3Mvbm9kZS10eXBlcy5jc3MiLA0KICAgICJjc3MvcmVzcG9uc2l2ZS5jc3MiLA0KICAgICJjc3Mvb3MtdGhlbWUuY3NzIg0KICBdLA0KICAiYWRkaXRpb25hbF9maWxlcyI6IFsNCiAgICB7DQogICAgICAidmZzX3BhdGgiOiAiL25vZGVzL25vZGVzLXBhY2suanNvbiIsDQogICAgICAic291cmNlX2ZpbGUiOiAibm9kZS1kZWZpbml0aW9ucy9ub2Rlcy1wYWNrLmpzb24iDQogICAgfQ0KICBdLA0KICAic2V0dGluZ3MiOiBbDQogICAgew0KICAgICAgImtleSI6ICJERUZBVUxUX0hUVFBfVElNRU9VVCIsDQogICAgICAibmFtZSI6ICJIVFRQIFRpbWVvdXQgKG1zKSIsDQogICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgInZhbHVlIjogMzAwMDAsDQogICAgICAiZGVzY3JpcHRpb24iOiAiRGVmYXVsdCB0aW1lb3V0IGZvciBIVFRQIHJlcXVlc3RzIGluIG1pbGxpc2Vjb25kcyINCiAgICB9LA0KICAgIHsNCiAgICAgICJrZXkiOiAiQVVUT19TQVZFX0lOVEVSVkFMIiwNCiAgICAgICJuYW1lIjogIkF1dG8gU2F2ZSBJbnRlcnZhbCAocykiLA0KICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICJ2YWx1ZSI6IDMwLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkF1dG8gc2F2ZSB3b3JrZmxvd3MgZXZlcnkgTiBzZWNvbmRzICgwID0gZGlzYWJsZWQpIg0KICAgIH0sDQogICAgew0KICAgICAgImtleSI6ICJNQVhfTk9ERVMiLA0KICAgICAgIm5hbWUiOiAiTWF4aW11bSBOb2RlcyIsDQogICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgInZhbHVlIjogNTAsDQogICAgICAiZGVzY3JpcHRpb24iOiAiTWF4aW11bSBudW1iZXIgb2Ygbm9kZXMgYWxsb3dlZCBpbiBhIHdvcmtmbG93Ig0KICAgIH0NCiAgXQ0KfQ==",
    "flow_editor.html": "PGRpdiBjbGFzcz0iYXBwLWNvbnRhaW5lciI+DQogICAgPGRpdiBjbGFzcz0iYXBwLWNvbnRlbnQiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LWVkaXRvciI+DQogICAgICAgICAgICA8IS0tIExlZnQgVG9vbGJveCAtLT4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsb3ctdG9vbGJveCIgaWQ9ImZsb3ctdG9vbGJveCI+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idG9vbGJveC1oZWFkZXIiPg0KICAgICAgICAgICAgICAgICAgICA8aDQ+PGkgY2xhc3M9ImZhcyBmYS10b29scyI+PC9pPiBOb2RlczwvaDQ+DQogICAgICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InRvZ2dsZS10b29sYm94IiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tb3V0bGluZS1zZWNvbmRhcnkiIHRpdGxlPSJDb2xsYXBzZSBUb29sYm94Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtY2hldnJvbi1sZWZ0Ij48L2k+DQogICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRvb2xib3gtY29udGVudCIgaWQ9InRvb2xib3gtY29udGVudCI+DQogICAgICAgICAgICAgICAgICAgIDwhLS0gTm9kZXMgd2lsbCBiZSBsb2FkZWQgZHluYW1pY2FsbHkgZnJvbSBWRlMgLS0+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxvYWRpbmctbm9kZXMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9InRleHQtbXV0ZWQiPkxvYWRpbmcgbm9kZXMuLi48L3A+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgICAgIDwhLS0gTWFpbiB3b3Jrc3BhY2UgLS0+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LXdvcmtzcGFjZSI+DQogICAgICAgICAgICAgICAgPCEtLSBUb29sYmFyIC0tPg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsb3ctdG9vbGJhciI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRvb2xiYXItbGVmdCI+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJydW4td29ya2Zsb3ciIGNsYXNzPSJidG4gYnRuLXN1Y2Nlc3MiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtcGxheSI+PC9pPiA8c3BhbiBjbGFzcz0iYnRuLXRleHQiPlJ1biBXb3JrZmxvdzwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ic3RvcC13b3JrZmxvdyIgY2xhc3M9ImJ0biBidG4tZGFuZ2VyIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc3RvcCI+PC9pPiA8c3BhbiBjbGFzcz0iYnRuLXRleHQiPlN0b3A8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImN1cnJlbnQtZmlsZS1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBpZD0iY3VycmVudC1maWxlbmFtZSIgY2xhc3M9ImN1cnJlbnQtZmlsZW5hbWUiPnVudGl0bGVkLmZsb3c8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0b29sYmFyLXJpZ2h0Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gWm9vbSBjb250cm9scyBzdGF5IHZpc2libGUgLS0+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ6b29tLWNvbnRyb2xzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ6b29tLW91dCIgY2xhc3M9ImJ0biBidG4tb3V0bGluZS1zZWNvbmRhcnkiIHRpdGxlPSJab29tIE91dCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2VhcmNoLW1pbnVzIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gaWQ9Inpvb20tbGV2ZWwiIGNsYXNzPSJ6b29tLWxldmVsIj4xMDAlPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9Inpvb20taW4iIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiB0aXRsZT0iWm9vbSBJbiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2VhcmNoLXBsdXMiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ6b29tLWZpdCIgY2xhc3M9ImJ0biBidG4tb3V0bGluZS1zZWNvbmRhcnkiIHRpdGxlPSJab29tIHRvIEZpdCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZXhwYW5kLWFycm93cy1hbHQiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICA8IS0tIEhhbWJ1cmdlciBNZW51IEJ1dHRvbiAtLT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9ImhhbWJ1cmdlci1tZW51IiBjbGFzcz0iYnRuIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSBoYW1idXJnZXItYnRuIiB0aXRsZT0iTWVudSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1iYXJzIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgPCEtLSBEcm9wZG93biBNZW51IC0gT25seSBmaWxlIG9wZXJhdGlvbnMgYW5kIGRlbGV0ZS9jbGVhciBhY3Rpb25zIC0tPg0KICAgICAgICAgICAgICAgIDxkaXYgaWQ9ImRyb3Bkb3duLW1lbnUiIGNsYXNzPSJkcm9wZG93bi1tZW51Ij4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWVudS1zZWN0aW9uIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1lbnUtc2VjdGlvbi10aXRsZSI+RmlsZSBBY3Rpb25zPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0iIGRhdGEtYWN0aW9uPSJzYXZlLWZsb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2F2ZSI+PC9pPiBTYXZlDQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Im1lbnUtaXRlbSIgZGF0YS1hY3Rpb249InNhdmUtZmxvdy1hcyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1zYXZlIj48L2k+IFNhdmUgQXMNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIiBkYXRhLWFjdGlvbj0ibG9hZC1mbG93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWZvbGRlci1vcGVuIj48L2k+IExvYWQNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1lbnUtc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtZW51LXNlY3Rpb24tdGl0bGUiPlZpZXcgQWN0aW9uczwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIiBkYXRhLWFjdGlvbj0iYWRkLXRhZyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS10YWciPjwvaT4gQWRkIFRhZw0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0iIGRhdGEtYWN0aW9uPSJyZXNldC12aWV3Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWNyb3NzaGFpcnMiPjwvaT4gUmVzZXQgVmlldw0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWVudS1zZWN0aW9uIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1lbnUtc2VjdGlvbi10aXRsZSI+RWRpdCBBY3Rpb25zPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0gZGFuZ2VyIiBkYXRhLWFjdGlvbj0iZGVsZXRlLXNlbGVjdGVkIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRyYXNoIj48L2k+IERlbGV0ZSBTZWxlY3RlZA0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0gZGFuZ2VyIiBkYXRhLWFjdGlvbj0iY2xlYXItY2FudmFzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRyYXNoLWFsdCI+PC9pPiBDbGVhciBBbGwNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCg0KICAgICAgICAgICAgICAgIDwhLS0gTWFpbiBjYW52YXMgYXJlYSAtLT4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LWNhbnZhcy1jb250YWluZXIiPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSJmbG93LWNhbnZhcyIgY2xhc3M9ImZsb3ctY2FudmFzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gTm9kZXMgd2lsbCBiZSBhZGRlZCBoZXJlIGR5bmFtaWNhbGx5IC0tPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDwvZGl2Pg0KDQogICAgICAgICAgICA8IS0tIENvbmZpZ3VyYXRpb24gcGFuZWwgLS0+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LWNvbmZpZy1wYW5lbCIgaWQ9ImZsb3ctY29uZmlnLXBhbmVsIj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctaGVhZGVyIj4NCiAgICAgICAgICAgICAgICAgICAgPGg0PjxpIGNsYXNzPSJmYXMgZmEtY29nIj48L2k+IENvbmZpZ3VyYXRpb248L2g0Pg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ0b2dnbGUtY29uZmlnIiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tb3V0bGluZS1zZWNvbmRhcnkiIHRpdGxlPSJDb2xsYXBzZSBDb25maWd1cmF0aW9uIFBhbmVsIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtY2hldnJvbi1yaWdodCI+PC9pPg0KICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctY29udGVudCIgaWQ9ImNvbmZpZy1jb250ZW50Ij4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0ibm9kZS1jb25maWciPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9InRleHQtbXV0ZWQiPlNlbGVjdCBhIG5vZGUgdG8gY29uZmlndXJlIGl0PC9wPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0idGFnLXBhbmVsIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxoNT48aSBjbGFzcz0iZmFzIGZhLXRhZ3MiPjwvaT4gQXJlYSBUYWdzPC9oNT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5ObyB0YWdzIHlldDwvcD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgPCEtLSBPdXRwdXQgcGFuZWwgLS0+DQogICAgICAgIDxkaXYgY2xhc3M9ImZsb3ctb3V0cHV0LXBhbmVsIGNvbGxhcHNlZCIgaWQ9ImZsb3ctb3V0cHV0LXBhbmVsIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im91dHB1dC1oZWFkZXIiPg0KICAgICAgICAgICAgICAgIDxoND48aSBjbGFzcz0iZmFzIGZhLXRlcm1pbmFsIj48L2k+IEV4ZWN1dGlvbiBPdXRwdXQ8L2g0Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im91dHB1dC1jb250cm9scyI+DQogICAgICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InRvZ2dsZS1vdXRwdXQiIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSIgdGl0bGU9IlNob3cvSGlkZSBPdXRwdXQiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1jaGV2cm9uLWRvd24iPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9ImNsZWFyLW91dHB1dCIgY2xhc3M9ImJ0biBidG4tc20gYnRuLW91dGxpbmUtc2Vjb25kYXJ5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtdHJhc2giPjwvaT4gQ2xlYXINCiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im91dHB1dC1jb250ZW50IiBpZD0ib3V0cHV0LWNvbnRlbnQiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQogICAgICAgICAgICAgICAgPGRpdiBpZD0iZXhlY3V0aW9uLW91dHB1dCIgY2xhc3M9ImV4ZWN1dGlvbi1vdXRwdXQiPg0KICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz0idGV4dC1tdXRlZCI+V29ya2Zsb3cgb3V0cHV0IHdpbGwgYXBwZWFyIGhlcmU8L3A+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQo8L2Rpdj4NCjxzdHlsZT4vKiA9PT09PSBTdHlsZTogY3NzL2xheW91dC5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIExheW91dCAmIFN0cnVjdHVyZSAqLw0KDQovKiBFbnN1cmUgYXBwLWNvbnRhaW5lciB1c2VzIGZ1bGwgaGVpZ2h0ICovDQouYXBwLWNvbnRhaW5lciB7DQogICAgaGVpZ2h0OiAxMDB2aDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCn0NCg0KLmFwcC1jb250ZW50IHsNCiAgICBmbGV4OiAxOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIGdhcDogMTBweDsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIG1pbi1oZWlnaHQ6IDA7DQp9DQoNCi8qIEZsb3cgRWRpdG9yIExheW91dCAqLw0KLmZsb3ctZWRpdG9yIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXg6IDE7DQogICAgZ2FwOiAwOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgbWluLWhlaWdodDogMDsNCn0NCg0KLyogTGVmdCBUb29sYm94ICovDQouZmxvdy10b29sYm94IHsNCiAgICB3aWR0aDogMjUwcHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgZmxleC1zaHJpbms6IDA7DQp9DQoNCi50b29sYm94LWhlYWRlciB7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KfQ0KDQoudG9vbGJveC1oZWFkZXIgaDQgew0KICAgIG1hcmdpbjogMDsNCiAgICBmb250LXNpemU6IDE2cHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KfQ0KDQojdG9nZ2xlLXRvb2xib3ggew0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOw0KfQ0KDQojdG9nZ2xlLXRvb2xib3g6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcik7DQp9DQoNCi8qIENvbGxhcHNlZCBzdGF0ZSAqLw0KLmZsb3ctdG9vbGJveC5jb2xsYXBzZWQgew0KICAgIHdpZHRoOiA1MHB4Ow0KfQ0KDQouZmxvdy10b29sYm94LmNvbGxhcHNlZCAudG9vbGJveC1jb250ZW50IHsNCiAgICBkaXNwbGF5OiBub25lOw0KfQ0KDQouZmxvdy10b29sYm94LmNvbGxhcHNlZCAudG9vbGJveC1oZWFkZXIgaDQgew0KICAgIGRpc3BsYXk6IG5vbmU7DQp9DQoNCi50b29sYm94LWNvbnRlbnQgew0KICAgIGZsZXg6IDE7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KfQ0KDQovKiBNYWluIFdvcmtzcGFjZSAqLw0KLmZsb3ctd29ya3NwYWNlIHsNCiAgICBmbGV4OiAxOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBtaW4td2lkdGg6IDA7DQp9DQoNCi8qIFRvb2xiYXIgKi8NCi5mbG93LXRvb2xiYXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgcGFkZGluZzogMTJweCAyMHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGZsZXgtc2hyaW5rOiAwOw0KfQ0KDQoudG9vbGJhci1sZWZ0IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGdhcDogMTBweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KfQ0KDQouY3VycmVudC1maWxlLWluZm8gew0KICAgIG1hcmdpbi1sZWZ0OiAxNXB4Ow0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCn0NCg0KLmN1cnJlbnQtZmlsZW5hbWUgew0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KfQ0KDQoudG9vbGJhci1yaWdodCB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDhweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCn0NCg0KLyogWm9vbSBDb250cm9scyAqLw0KLnpvb20tY29udHJvbHMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDRweDsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KfQ0KDQouem9vbS1sZXZlbCB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIG1pbi13aWR0aDogNDBweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgdXNlci1zZWxlY3Q6IG5vbmU7DQp9DQoNCi56b29tLWNvbnRyb2xzIGJ1dHRvbiB7DQogICAgcGFkZGluZzogNHB4IDZweDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOw0KfQ0KDQouem9vbS1jb250cm9scyBidXR0b246aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcik7DQp9DQoNCi56b29tLWNvbnRyb2xzIGJ1dHRvbjphY3RpdmUgew0KICAgIHRyYW5zZm9ybTogc2NhbGUoMC45NSk7DQp9DQoNCi8qIENhbnZhcyBDb250YWluZXIgKi8NCi5mbG93LWNhbnZhcy1jb250YWluZXIgew0KICAgIGZsZXg6IDE7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIG92ZXJmbG93OiBoaWRkZW47DQp9DQoNCi5mbG93LWNhbnZhcyB7DQogICAgd2lkdGg6IDEwMDAwcHg7DQogICAgaGVpZ2h0OiAxMDAwMHB4Ow0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICBiYWNrZ3JvdW5kOiANCiAgICAgICAgcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCAyMHB4IDIwcHgsIHZhcigtLWJvcmRlci1jb2xvcikgMXB4LCB0cmFuc3BhcmVudCAxcHgpLA0KICAgICAgICByYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDQwcHggNDBweCwgdmFyKC0tYm9yZGVyLWNvbG9yKSAxcHgsIHRyYW5zcGFyZW50IDFweCk7DQogICAgYmFja2dyb3VuZC1zaXplOiA0MHB4IDQwcHg7DQogICAgY3Vyc29yOiBncmFiOw0KICAgIHRyYW5zZm9ybS1vcmlnaW46IDAgMDsNCiAgICB3aWxsLWNoYW5nZTogdHJhbnNmb3JtOw0KfQ0KDQouZmxvdy1jYW52YXM6YWN0aXZlIHsNCiAgICBjdXJzb3I6IGdyYWJiaW5nOw0KfQ0KDQouZmxvdy1jYW52YXMucGFubmluZyB7DQogICAgY3Vyc29yOiBncmFiYmluZzsNCn0NCg0KLyogQ29uZmlndXJhdGlvbiBQYW5lbCAqLw0KLmZsb3ctY29uZmlnLXBhbmVsIHsNCiAgICB3aWR0aDogMzAwcHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBmbGV4LXNocmluazogMDsNCn0NCg0KLmNvbmZpZy1oZWFkZXIgew0KICAgIHBhZGRpbmc6IDE1cHg7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCn0NCg0KLmNvbmZpZy1oZWFkZXIgaDQgew0KICAgIG1hcmdpbjogMDsNCiAgICBmb250LXNpemU6IDE2cHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KfQ0KDQojdG9nZ2xlLWNvbmZpZyB7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQp9DQoNCiN0b2dnbGUtY29uZmlnOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ib3JkZXItY29sb3IpOw0KfQ0KDQovKiBDb2xsYXBzZWQgc3RhdGUgKi8NCi5mbG93LWNvbmZpZy1wYW5lbC5jb2xsYXBzZWQgew0KICAgIHdpZHRoOiA1MHB4Ow0KfQ0KDQouZmxvdy1jb25maWctcGFuZWwuY29sbGFwc2VkIC5jb25maWctY29udGVudCB7DQogICAgZGlzcGxheTogbm9uZTsNCn0NCg0KLmZsb3ctY29uZmlnLXBhbmVsLmNvbGxhcHNlZCAuY29uZmlnLWhlYWRlciBoNCB7DQogICAgZGlzcGxheTogbm9uZTsNCn0NCg0KLmNvbmZpZy1jb250ZW50IHsNCiAgICBmbGV4OiAxOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgcGFkZGluZzogMTVweDsNCn0NCg0KLyogT3V0cHV0IFBhbmVsICovDQouZmxvdy1vdXRwdXQtcGFuZWwgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgZmxleC1zaHJpbms6IDA7DQogICAgbWF4LWhlaWdodDogMzAwcHg7DQp9DQoNCi5vdXRwdXQtaGVhZGVyIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIHBhZGRpbmc6IDEycHggMTVweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCn0NCg0KLm91dHB1dC1oZWFkZXIgaDQgew0KICAgIG1hcmdpbjogMDsNCiAgICBmb250LXNpemU6IDE2cHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KfQ0KDQoub3V0cHV0LWNvbnRlbnQgew0KICAgIHBhZGRpbmc6IDE1cHg7DQogICAgbWF4LWhlaWdodDogMjUwcHg7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBvdmVyZmxvdy14OiBoaWRkZW47DQp9DQoNCi5mbG93LW91dHB1dC1wYW5lbC5jb2xsYXBzZWQgLm91dHB1dC1jb250ZW50IHsNCiAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7DQp9DQoNCi5mbG93LW91dHB1dC1wYW5lbCAub3V0cHV0LWhlYWRlciB7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KfQ0KDQouZmxvdy1vdXRwdXQtcGFuZWwgLm91dHB1dC1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDhweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KfQ0KDQoNCi8qID09PT09IFN0eWxlOiBjc3Mvbm9kZXMuY3NzID09PT09ICovDQovKiBGbG93IEVkaXRvciBOb2RlcyAmIENvbm5lY3Rpb25zICovDQoNCi8qIE5vZGUgU3R5bGVzICovDQouZmxvdy1ub2RlIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgbWluLXdpZHRoOiAxNTBweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIGN1cnNvcjogZ3JhYjsNCiAgICB1c2VyLXNlbGVjdDogbm9uZTsNCiAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLDAsMCwwLjEpOw0KICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4ycyBlYXNlLCB0cmFuc2Zvcm0gMC4xcyBlYXNlOw0KICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm07DQp9DQoNCi5mbG93LW5vZGU6YWN0aXZlIHsNCiAgICBjdXJzb3I6IGdyYWJiaW5nOw0KICAgIHRyYW5zaXRpb246IG5vbmU7DQp9DQoNCi5mbG93LW5vZGU6aG92ZXIgew0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLDAsMCwwLjE1KTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7DQp9DQoNCi5mbG93LW5vZGUuc2VsZWN0ZWQgew0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgYm94LXNoYWRvdzogMCAwIDAgMnB4IHJnYmEodmFyKC0tcHJpbWFyeS1jb2xvci1yZ2IpLCAwLjIpOw0KfQ0KDQouZmxvdy1ub2RlLWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIG1hcmdpbi1ib3R0b206IDhweDsNCiAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KfQ0KDQoubm9kZS1kZWxldGUtYnRuIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgcmlnaHQ6IC01cHg7DQogICAgdG9wOiAtNXB4Ow0KICAgIHdpZHRoOiAyMHB4Ow0KICAgIGhlaWdodDogMjBweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgb3BhY2l0eTogMDsNCiAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuMnMgZWFzZTsNCiAgICB6LWluZGV4OiAxMDsNCn0NCg0KLmZsb3ctbm9kZTpob3ZlciAubm9kZS1kZWxldGUtYnRuIHsNCiAgICBvcGFjaXR5OiAxOw0KfQ0KDQoubm9kZS1kZWxldGUtYnRuOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiAjZDMyZjJmOw0KICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsNCn0NCg0KLmZsb3ctbm9kZS10eXBlIHsNCiAgICBwYWRkaW5nOiAycHggNnB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IG5vcm1hbDsNCiAgICBiYWNrZ3JvdW5kOiAjNmM3NTdkOw0KICAgIGNvbG9yOiB3aGl0ZTsNCn0NCg0KLmZsb3ctbm9kZS1jb250ZW50IHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KfQ0KDQouZmxvdy1ub2RlLXBvcnRzIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgd2lkdGg6IDEwMCU7DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIHBvaW50ZXItZXZlbnRzOiBub25lOw0KfQ0KDQouZmxvdy1ub2RlLXBvcnQgew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICB3aWR0aDogMTJweDsNCiAgICBoZWlnaHQ6IDEycHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHBvaW50ZXItZXZlbnRzOiBhbGw7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCn0NCg0KLmZsb3ctbm9kZS1wb3J0OmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIHRyYW5zZm9ybTogc2NhbGUoMS4yKTsNCn0NCg0KLmZsb3ctbm9kZS1wb3J0LmlucHV0IHsNCiAgICBsZWZ0OiAtNnB4Ow0KICAgIHRvcDogNTAlOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsNCn0NCg0KLmZsb3ctbm9kZS1wb3J0Lm91dHB1dCB7DQogICAgcmlnaHQ6IC02cHg7DQogICAgdG9wOiA1MCU7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOw0KfQ0KDQovKiBDb25uZWN0aW9uIExpbmVzICovDQouZmxvdy1jb25uZWN0aW9uIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgcG9pbnRlci1ldmVudHM6IG5vbmU7DQogICAgei1pbmRleDogMTsNCn0NCg0KLmZsb3ctY29ubmVjdGlvbi1saW5lIHsNCiAgICBzdHJva2U6IHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgc3Ryb2tlLXdpZHRoOiA4Ow0KICAgIGZpbGw6IG5vbmU7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICBvcGFjaXR5OiAwLjY7IC8qIFNsaWdodGx5IHRyYW5zcGFyZW50IGJ5IGRlZmF1bHQgKi8NCn0NCg0KLmZsb3ctY29ubmVjdGlvbi1saW5lOmhvdmVyIHsNCiAgICBzdHJva2U6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIG9wYWNpdHk6IDE7DQogICAgc3Ryb2tlLXdpZHRoOiAxMDsNCn0NCg0KLmZsb3ctY29ubmVjdGlvbi1saW5lLmNvbm5lY3RlZCB7DQogICAgc3Ryb2tlOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBvcGFjaXR5OiAwLjg7DQp9DQoNCi8qIFJ1bm5pbmcgU3RhdGUgKi8NCi5mbG93LW5vZGUucnVubmluZyB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsNCiAgICBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlOw0KfQ0KDQovKiBXYWl0aW5nIGZvciBJbnB1dHMgU3RhdGUgKi8NCi5mbG93LW5vZGUud2FpdGluZy1pbnB1dHMgew0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0td2FybmluZy1jb2xvcik7DQogICAgYW5pbWF0aW9uOiB3YWl0aW5nLXB1bHNlIDJzIGluZmluaXRlOw0KfQ0KDQovKiBDb21wbGV0ZWQgU3RhdGUgKi8NCi5mbG93LW5vZGUuY29tcGxldGVkIHsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXN1Y2Nlc3MtY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHJnYmEodmFyKC0tc3VjY2Vzcy1jb2xvci1yZ2IpLCAwLjEpOw0KfQ0KDQovKiBFcnJvciBTdGF0ZSAqLw0KLmZsb3ctbm9kZS5lcnJvciB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgYmFja2dyb3VuZDogcmdiYSh2YXIoLS1lcnJvci1jb2xvci1yZ2IpLCAwLjEpOw0KfQ0KDQpAa2V5ZnJhbWVzIHB1bHNlIHsNCiAgICAwJSB7IGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS1zdWNjZXNzLWNvbG9yLXJnYiksIDAuNCk7IH0NCiAgICA3MCUgeyBib3gtc2hhZG93OiAwIDAgMCAxMHB4IHJnYmEodmFyKC0tc3VjY2Vzcy1jb2xvci1yZ2IpLCAwKTsgfQ0KICAgIDEwMCUgeyBib3gtc2hhZG93OiAwIDAgMCAwIHJnYmEodmFyKC0tc3VjY2Vzcy1jb2xvci1yZ2IpLCAwKTsgfQ0KfQ0KDQpAa2V5ZnJhbWVzIHdhaXRpbmctcHVsc2Ugew0KICAgIDAlIHsgYm94LXNoYWRvdzogMCAwIDAgMCByZ2JhKHZhcigtLXdhcm5pbmctY29sb3ItcmdiKSwgMC40KTsgfQ0KICAgIDcwJSB7IGJveC1zaGFkb3c6IDAgMCAwIDEwcHggcmdiYSh2YXIoLS13YXJuaW5nLWNvbG9yLXJnYiksIDApOyB9DQogICAgMTAwJSB7IGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS13YXJuaW5nLWNvbG9yLXJnYiksIDApOyB9DQp9DQoNCg0KLyogPT09PT0gU3R5bGU6IGNzcy9jb21wb25lbnRzLmNzcyA9PT09PSAqLw0KLyogRmxvdyBFZGl0b3IgVUkgQ29tcG9uZW50cyAqLw0KDQovKiBOb2RlIENhdGVnb3J5IFRvb2xib3ggKi8NCi5ub2RlLWNhdGVnb3J5IHsNCiAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KfQ0KDQoubm9kZS1jYXRlZ29yeSBoNSB7DQogICAgbWFyZ2luOiAwIDAgMTBweCAwOw0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOw0KICAgIGxldHRlci1zcGFjaW5nOiAwLjVweDsNCiAgICBwYWRkaW5nOiAwIDVweDsNCn0NCg0KLnRvb2xib3gtbm9kZS1idG4gew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDEwcHg7DQogICAgcGFkZGluZzogMTJweCAxNXB4Ow0KICAgIG1hcmdpbi1ib3R0b206IDVweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBjdXJzb3I6IGdyYWI7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICB0ZXh0LWFsaWduOiBsZWZ0Ow0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQp9DQoNCi50b29sYm94LW5vZGUtYnRuOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwwLDAsMC4xKTsNCn0NCg0KLnRvb2xib3gtbm9kZS1idG46YWN0aXZlIHsNCiAgICBjdXJzb3I6IGdyYWJiaW5nOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsNCn0NCg0KLnRvb2xib3gtbm9kZS1idG4gaSB7DQogICAgZm9udC1zaXplOiAxNnB4Ow0KICAgIHdpZHRoOiAyMHB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCg0KLnRvb2xib3gtbm9kZS1idG4gc3BhbiB7DQogICAgZmxleDogMTsNCiAgICBmb250LXdlaWdodDogNTAwOw0KfQ0KDQovKiBCdXR0b25zICovDQouZmxvdy10b29sYmFyIC5idG4gew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDZweDsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOw0KICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTsNCn0NCg0KLmZsb3ctdG9vbGJhciAuYnRuOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwwLDAsMC4xKTsNCn0NCg0KLmZsb3ctdG9vbGJhciAuYnRuLW91dGxpbmUtZGFuZ2VyIHsNCiAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCn0NCg0KLmZsb3ctdG9vbGJhciAuYnRuLW91dGxpbmUtZGFuZ2VyOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KfQ0KDQouZmxvdy10b29sYmFyIC5idG4tb3V0bGluZS1zZWNvbmRhcnkgew0KICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KfQ0KDQouZmxvdy10b29sYmFyIC5idG4tb3V0bGluZS1zZWNvbmRhcnk6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KfQ0KDQovKiBDb25maWd1cmF0aW9uIFN0eWxlcyAqLw0KLmNvbmZpZy1ncm91cCB7DQogICAgbWFyZ2luLWJvdHRvbTogMTVweDsNCn0NCg0KLmNvbmZpZy1ncm91cCBsYWJlbCB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgbWFyZ2luLWJvdHRvbTogNXB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCn0NCg0KLmNvbmZpZy1ncm91cCBpbnB1dCB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB0cmFuc2l0aW9uOiBib3JkZXItY29sb3IgMC4ycyBlYXNlOw0KfQ0KDQouY29uZmlnLWdyb3VwIHNlbGVjdCB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQp9DQoNCi5jb25maWctZ3JvdXAgaW5wdXQ6Zm9jdXMgew0KICAgIG91dGxpbmU6IG5vbmU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBib3gtc2hhZG93OiAwIDAgMCAycHggcmdiYSh2YXIoLS1wcmltYXJ5LWNvbG9yLXJnYiksIDAuMSk7DQp9DQoNCi5jb25maWctZ3JvdXAgc2VsZWN0OmZvY3VzIHsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDIxMiwgMjU1LCAwLjA1KTsNCn0NCg0KLmNvbmZpZy1ncm91cCBzZWxlY3Qgb3B0aW9uIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWJnKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQp9DQoNCi5jb25maWctZ3JvdXAgc2VsZWN0IG9wdGlvbjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KfQ0KDQouY29uZmlnLWdyb3VwIHRleHRhcmVhIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHJlc2l6ZTogdmVydGljYWw7DQogICAgbWluLWhlaWdodDogODBweDsNCiAgICBmb250LWZhbWlseTogbW9ub3NwYWNlOw0KfQ0KDQovKiBUYWcgUGFuZWwgKi8NCiN0YWctcGFuZWwgew0KICAgIG1hcmdpbi10b3A6IDIwcHg7DQogICAgcGFkZGluZy10b3A6IDIwcHg7DQogICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQp9DQoNCiN0YWctcGFuZWwgaDUgew0KICAgIG1hcmdpbjogMCAwIDE1cHggMDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KfQ0KDQoudGFnLWl0ZW0gew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDEwcHg7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQogICAgbWFyZ2luLWJvdHRvbTogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOw0KfQ0KDQoudGFnLWl0ZW06aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXByaW1hcnktY29sb3IpOw0KfQ0KDQoudGFnLWNvbG9yIHsNCiAgICB3aWR0aDogMTJweDsNCiAgICBoZWlnaHQ6IDEycHg7DQogICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgIGZsZXgtc2hyaW5rOiAwOw0KfQ0KDQoudGFnLWluZm8gew0KICAgIGZsZXg6IDE7DQogICAgbWluLXdpZHRoOiAwOw0KfQ0KDQoudGFnLW5hbWUgew0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgZm9udC1zaXplOiAxM3B4Ow0KICAgIG1hcmdpbi1ib3R0b206IDJweDsNCn0NCg0KLnRhZy1kZXNjcmlwdGlvbiB7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIG9wYWNpdHk6IDAuNzsNCn0NCg0KLnRhZy1kZWxldGUgew0KICAgIGJhY2tncm91bmQ6IG5vbmU7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGNvbG9yOiBpbmhlcml0Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBwYWRkaW5nOiA0cHg7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG9wYWNpdHk6IDAuNjsNCiAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuMnMgZWFzZTsNCn0NCg0KLnRhZy1kZWxldGU6aG92ZXIgew0KICAgIG9wYWNpdHk6IDE7DQogICAgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwwLjEpOw0KfQ0KDQovKiBPdXRwdXQgU3R5bGVzICovDQouZXhlY3V0aW9uLW91dHB1dCB7DQogICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDEzcHg7DQogICAgbGluZS1oZWlnaHQ6IDEuNDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQp9DQoNCi5leGVjdXRpb24tb3V0cHV0IC5sb2ctZW50cnkgew0KICAgIG1hcmdpbi1ib3R0b206IDVweDsNCiAgICBwYWRkaW5nOiA0cHggMDsNCn0NCg0KLmV4ZWN1dGlvbi1vdXRwdXQgLmxvZy1lbnRyeS5pbmZvIHsNCiAgICBjb2xvcjogdmFyKC0taW5mby1jb2xvcik7DQp9DQoNCi5leGVjdXRpb24tb3V0cHV0IC5sb2ctZW50cnkuc3VjY2VzcyB7DQogICAgY29sb3I6IHZhcigtLXN1Y2Nlc3MtY29sb3IpOw0KfQ0KDQouZXhlY3V0aW9uLW91dHB1dCAubG9nLWVudHJ5LmVycm9yIHsNCiAgICBjb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpOw0KfQ0KDQouZXhlY3V0aW9uLW91dHB1dCAubG9nLWVudHJ5Lndhcm5pbmcgew0KICAgIGNvbG9yOiB2YXIoLS13YXJuaW5nLWNvbG9yKTsNCn0NCg0KLyogSW5wdXQvT3V0cHV0IE1hcHBpbmdzIENvbmZpZ3VyYXRpb24gU3R5bGVzICovDQouaW5wdXQtbWFwcGluZ3MtY29uZmlnLA0KLm91dHB1dC1tYXBwaW5ncy1jb25maWcgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBtYXJnaW4tdG9wOiA0cHg7DQp9DQoNCi5pbnB1dC1tYXBwaW5nLWNvbmZpZywNCi5vdXRwdXQtbWFwcGluZy1jb25maWcgew0KICAgIG1hcmdpbi1ib3R0b206IDhweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjAyKTsNCiAgICBib3JkZXItcmFkaXVzOiAzcHg7DQogICAgYm9yZGVyLWxlZnQ6IDNweCBzb2xpZCB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCn0NCg0KLmlucHV0LW1hcHBpbmctY29uZmlnOmxhc3QtY2hpbGQsDQoub3V0cHV0LW1hcHBpbmctY29uZmlnOmxhc3QtY2hpbGQgew0KICAgIG1hcmdpbi1ib3R0b206IDA7DQp9DQoNCi5pbnB1dC1tYXBwaW5nLWNvbmZpZyBsYWJlbCwNCi5vdXRwdXQtbWFwcGluZy1jb25maWcgbGFiZWwgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBtYXJnaW4tYm90dG9tOiA0cHg7DQp9DQoNCi5pbnB1dC1tYXBwaW5nLXNlbGVjdCwNCi5vdXRwdXQtbWFwcGluZy1zZWxlY3Qgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiAzcHg7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCn0NCg0KLmlucHV0LW1hcHBpbmctc2VsZWN0OmZvY3VzLA0KLm91dHB1dC1tYXBwaW5nLXNlbGVjdDpmb2N1cyB7DQogICAgb3V0bGluZTogbm9uZTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIGJveC1zaGFkb3c6IDAgMCAwIDJweCByZ2JhKDAsIDEyMywgMjU1LCAwLjEpOw0KfQ0KDQovKiBMZWdhY3kgc3R5bGVzIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5ICovDQouaW5wdXQtbWFwcGluZ3Mgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBtYXJnaW4tdG9wOiA0cHg7DQp9DQoNCi5pbnB1dC1tYXBwaW5nIHsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIG1hcmdpbi1ib3R0b206IDRweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgYm9yZGVyLXJhZGl1czogM3B4Ow0KICAgIGZvbnQtc2l6ZTogMTFweDsNCiAgICBsaW5lLWhlaWdodDogMS4yOw0KfQ0KDQouaW5wdXQtbWFwcGluZzpsYXN0LWNoaWxkIHsNCiAgICBtYXJnaW4tYm90dG9tOiAwOw0KfQ0KDQouaW5wdXQtbWFwcGluZyAuc291cmNlLW5vZGUgew0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQp9DQoNCi5pbnB1dC1tYXBwaW5nIC5zb3VyY2UtcG9ydCB7DQogICAgb3BhY2l0eTogMC44Ow0KICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsNCn0NCg0KDQovKiA9PT09PSBTdHlsZTogY3NzL25vZGUtdHlwZXMuY3NzID09PT09ICovDQovKiBGbG93IEVkaXRvciBOb2RlIFR5cGUgU3BlY2lmaWMgU3R5bGVzICovDQoNCi8qIERpc3BsYXkgTm9kZSBDb250ZW50ICovDQouZGlzcGxheS1jb250ZW50IHsNCiAgICBwYWRkaW5nOiA4cHg7DQp9DQoNCi5kaXNwbGF5LXRleHQgew0KICAgIG1pbi1oZWlnaHQ6IDQwcHg7DQogICAgbWF4LWhlaWdodDogMjAwcHg7DQogICAgd2lkdGg6IDIyMHB4Ow0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjA1KTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIG1hcmdpbi1ib3R0b206IDhweDsNCiAgICByZXNpemU6IG5vbmU7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCn0NCg0KLmRpc3BsYXktdGV4dCBwcmUgew0KICAgIG1hcmdpbjogMDsNCiAgICBmb250LWZhbWlseTogbW9ub3NwYWNlOw0KICAgIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsNCiAgICB3b3JkLWJyZWFrOiBicmVhay13b3JkOw0KICAgIHVzZXItc2VsZWN0OiB0ZXh0Ow0KfQ0KDQouZGlzcGxheS1mb3JtYXQgew0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KfQ0KDQovKiBBdWRpbyBQbGF5ZXIgU3R5bGVzICovDQouYXVkaW8tY29udHJvbHMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDEwcHg7DQogICAgbWFyZ2luLXRvcDogMTBweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjA1KTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQp9DQoNCi5hdWRpby1wbGF5LWJ0biwNCi5hdWRpby1zdG9wLWJ0biB7DQogICAgd2lkdGg6IDMycHg7DQogICAgaGVpZ2h0OiAzMnB4Ow0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCn0NCg0KLmF1ZGlvLXBsYXktYnRuIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQp9DQoNCi5hdWRpby1zdG9wLWJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCn0NCg0KLmF1ZGlvLXBsYXktYnRuOmhvdmVyLA0KLmF1ZGlvLXN0b3AtYnRuOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwwLDAsMC4yKTsNCn0NCg0KLmF1ZGlvLXN0YXR1cyB7DQogICAgZmxleDogMTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCg0KLyogSlNPTiBFeHRyYWN0IERpc3BsYXkgKi8NCi5qc29uLWV4dHJhY3QtZGlzcGxheSB7DQogICAgbWFyZ2luLXRvcDogMTBweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjA1KTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQp9DQoNCi5leHRyYWN0LWxhYmVsIHsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIG1hcmdpbi1ib3R0b206IDRweDsNCiAgICBmb250LXdlaWdodDogNTAwOw0KfQ0KDQouZXh0cmFjdC12YWx1ZSB7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KfQ0KDQouZXh0cmFjdC12YWx1ZS5zdWNjZXNzIHsNCiAgICBjb2xvcjogdmFyKC0tc3VjY2Vzcy1jb2xvcik7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsNCn0NCg0KLmV4dHJhY3QtdmFsdWUuZXJyb3Igew0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQp9DQoNCi8qIFJlcGVhdGVyIE5vZGUgU3R5bGVzICovDQoucmVwZWF0ZXItY29udGVudCB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHg7DQogICAgcGFkZGluZzogOHB4Ow0KfQ0KDQoucmVwZWF0ZXItc3RhdHVzIHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgbWluLXdpZHRoOiA4MHB4Ow0KfQ0KDQoucmVwZWF0ZXItc3RhdHVzLnN0b3BwZWQgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC4xKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQp9DQoNCi5yZXBlYXRlci1zdGF0dXMucnVubmluZyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VjY2Vzcy1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGFuaW1hdGlvbjogcHVsc2UgMnMgaW5maW5pdGU7DQp9DQoNCi5yZXBlYXRlci1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDhweDsNCn0NCg0KLnJlcGVhdGVyLXN0YXJ0LWJ0biwNCi5yZXBlYXRlci1zdG9wLWJ0biB7DQogICAgd2lkdGg6IDI4cHg7DQogICAgaGVpZ2h0OiAyOHB4Ow0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCn0NCg0KLnJlcGVhdGVyLXN0YXJ0LWJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VjY2Vzcy1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KfQ0KDQoucmVwZWF0ZXItc3RvcC1idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQp9DQoNCi5yZXBlYXRlci1zdGFydC1idG46aG92ZXIsDQoucmVwZWF0ZXItc3RvcC1idG46aG92ZXIgew0KICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsNCiAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLDAsMCwwLjIpOw0KfQ0KDQovKiBJbWFnZSBOb2RlIFN0eWxlcyAqLw0KLmltYWdlLWNvbnRhaW5lciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA4cHg7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIG1pbi1oZWlnaHQ6IDEyMHB4Ow0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KfQ0KDQouaW1hZ2UtdGh1bWJuYWlsIHsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBvYmplY3QtZml0OiBjb250YWluOw0KICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2U7DQp9DQoNCi5pbWFnZS10aHVtYm5haWw6aG92ZXIgew0KICAgIHRyYW5zZm9ybTogc2NhbGUoMS4wNSk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwwLDAsMC4yKTsNCn0NCg0KLmltYWdlLWluZm8gew0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC4wNSk7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBib3JkZXItcmFkaXVzOiAzcHg7DQogICAgd2lkdGg6IDEwMCU7DQp9DQoNCi5pbWFnZS1lcnJvciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA0cHg7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQoNCi5pbWFnZS1lcnJvciBpIHsNCiAgICBmb250LXNpemU6IDE2cHg7DQp9DQoNCi8qIEltYWdlIE1vZGFsIFN0eWxlcyAqLw0KLmltYWdlLW1vZGFsIHsNCiAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgdG9wOiAwOw0KICAgIGxlZnQ6IDA7DQogICAgd2lkdGg6IDEwMCU7DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC44KTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgei1pbmRleDogMTAwMDsNCiAgICBwYWRkaW5nOiAyMHB4Ow0KfQ0KDQouaW1hZ2UtbW9kYWwtY29udGVudCB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIG1heC13aWR0aDogOTAlOw0KICAgIG1heC1oZWlnaHQ6IDkwJTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDIwcHggcmdiYSgwLDAsMCwwLjMpOw0KfQ0KDQouaW1hZ2UtbW9kYWwtaGVhZGVyIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIHBhZGRpbmc6IDE1cHggMjBweDsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCn0NCg0KLmltYWdlLW1vZGFsLWhlYWRlciBzcGFuIHsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCn0NCg0KLmltYWdlLW1vZGFsLWNsb3NlIHsNCiAgICBiYWNrZ3JvdW5kOiBub25lOw0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBmb250LXNpemU6IDI0cHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBwYWRkaW5nOiAwOw0KICAgIHdpZHRoOiAzMHB4Ow0KICAgIGhlaWdodDogMzBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQp9DQoNCi5pbWFnZS1tb2RhbC1jbG9zZTpob3ZlciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjEpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCn0NCg0KLmltYWdlLW1vZGFsLWJvZHkgew0KICAgIHBhZGRpbmc6IDIwcHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxNXB4Ow0KICAgIG1heC1oZWlnaHQ6IGNhbGMoOTB2aCAtIDEwMHB4KTsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KfQ0KDQouaW1hZ2UtbW9kYWwtaW1hZ2Ugew0KICAgIG1heC13aWR0aDogMTAwJTsNCiAgICBtYXgtaGVpZ2h0OiA3MHZoOw0KICAgIG9iamVjdC1maXQ6IGNvbnRhaW47DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsMCwwLDAuMSk7DQp9DQoNCi5pbWFnZS1tb2RhbC1pbmZvIHsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgcGFkZGluZzogMTBweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuMDUpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICB3aWR0aDogMTAwJTsNCn0NCg0KLyogUmFuZG9tIFF1b3RlIE5vZGUgU3R5bGVzICovDQoucXVvdGUtY29udGVudCB7DQogICAgcGFkZGluZzogMTBweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQoNCi5xdW90ZS10ZXh0IHsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgbWluLWhlaWdodDogNDBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQp9DQoNCi5xdW90ZS1kaXNwbGF5IHsNCiAgICBtYXJnaW46IDA7DQogICAgZm9udC1zdHlsZTogaXRhbGljOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBmb250LXNpemU6IDEzcHg7DQogICAgbGluZS1oZWlnaHQ6IDEuNDsNCiAgICBtYXgtd2lkdGg6IDEwMCU7DQogICAgd29yZC13cmFwOiBicmVhay13b3JkOw0KfQ0KDQoucXVvdGUtaW5mbyB7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBwYWRkaW5nLXRvcDogOHB4Ow0KfQ0KDQovKiBMTE0gQ2hhdCBOb2RlIFN0eWxlcyAqLw0KLmxsbS1yZXNwb25zZSB7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjMsIDE2MiwgMTg0LCAwLjEpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBtYXJnaW46IDRweCAwOw0KfQ0KDQoucmVzcG9uc2UtcHJldmlldyB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjM7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsNCiAgICBtYXJnaW4tYm90dG9tOiA0cHg7DQp9DQoNCi51c2FnZS1pbmZvIHsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCByZ2JhKDAsMCwwLDAuMSk7DQogICAgcGFkZGluZy10b3A6IDRweDsNCn0NCg0KLmxsbS1lcnJvciB7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjIwLCA1MywgNjksIDAuMSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG1hcmdpbjogNHB4IDA7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogNnB4Ow0KfQ0KDQoubGxtLWVycm9yIGkgew0KICAgIGZvbnQtc2l6ZTogMTRweDsNCn0NCg0KLyogVGV4dCBOb2RlIFN0eWxlcyAqLw0KLnRleHQtY29udGVudCB7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMTA4LCAxMTcsIDEyNSwgMC4xKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgbWFyZ2luOiA0cHggMDsNCn0NCg0KLnRleHQtcHJldmlldyB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjM7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsNCiAgICBtYXJnaW4tYm90dG9tOiA0cHg7DQp9DQoNCi50ZXh0LWluZm8gew0KICAgIGZvbnQtc2l6ZTogMTBweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHJnYmEoMCwwLDAsMC4xKTsNCiAgICBwYWRkaW5nLXRvcDogNHB4Ow0KfQ0KDQovKiBOb2RlIFN0YXR1cyBEaXNwbGF5ICovDQoubm9kZS1zdGF0dXMgew0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuMDUpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBtYXJnaW46IDRweCAwOw0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCg0KLnN0YXR1cy10ZXh0IHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgbWFyZ2luLWJvdHRvbTogNHB4Ow0KfQ0KDQouc3RhdHVzLWluZm8gew0KICAgIGZvbnQtc2l6ZTogMTBweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQp9DQoNCi8qIENvbnRlbnQgRGlzcGxheSBpbiBDb25maWcgUGFuZWwgKi8NCi5jb250ZW50LWRpc3BsYXkgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHBhZGRpbmc6IDEycHg7DQogICAgbWFyZ2luLXRvcDogOHB4Ow0KfQ0KDQouY29udGVudC10ZXh0IHsNCiAgICBtYXJnaW46IDA7DQogICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgbGluZS1oZWlnaHQ6IDEuNDsNCiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7DQogICAgd29yZC1icmVhazogYnJlYWstd29yZDsNCiAgICBtYXgtaGVpZ2h0OiAzMDBweDsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogM3B4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICB1c2VyLXNlbGVjdDogdGV4dDsNCn0NCg0KLmNvbnRlbnQtaW5mbyB7DQogICAgbWFyZ2luLXRvcDogOHB4Ow0KICAgIGZvbnQtc2l6ZTogMTFweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KfQ0KDQovKiBUZXJtaW5hbCBOb2RlIFN0eWxlcyAqLw0KLnRlcm1pbmFsLWVycm9yIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgyMjAsIDUzLCA2OSwgMC4xKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIG1hcmdpbi10b3A6IDhweDsNCn0NCg0KLnRlcm1pbmFsLWVycm9yIGkgew0KICAgIG1hcmdpbi1yaWdodDogOHB4Ow0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQp9DQoNCg0KLyogPT09PT0gU3R5bGU6IGNzcy9yZXNwb25zaXZlLmNzcyA9PT09PSAqLw0KLyogRmxvdyBFZGl0b3IgUmVzcG9uc2l2ZSBEZXNpZ24gJiBFZmZlY3RzICovDQoNCi8qIEhhbWJ1cmdlciBNZW51IFN0eWxlcyAtIEFsd2F5cyB2aXNpYmxlICovDQouaGFtYnVyZ2VyLWJ0biB7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQp9DQoNCi5kcm9wZG93bi1tZW51IHsNCiAgICBkaXNwbGF5OiBub25lOw0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC4yKTsNCiAgICB6LWluZGV4OiA5OTk5Ow0KICAgIG1pbi13aWR0aDogMTgwcHg7DQogICAgd2lkdGg6IDE4MHB4Ow0KICAgIG1heC1oZWlnaHQ6IDcwdmg7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBwYWRkaW5nOiAwOw0KICAgIG1hcmdpbjogMDsNCn0NCg0KLmRyb3Bkb3duLW1lbnUuc2hvdyB7DQogICAgZGlzcGxheTogYmxvY2sgIWltcG9ydGFudDsNCn0NCg0KLm1lbnUtc2VjdGlvbiB7DQogICAgcGFkZGluZzogOHB4IDA7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQp9DQoNCi5tZW51LXNlY3Rpb246bGFzdC1jaGlsZCB7DQogICAgYm9yZGVyLWJvdHRvbTogbm9uZTsNCn0NCg0KLm1lbnUtc2VjdGlvbi10aXRsZSB7DQogICAgcGFkZGluZzogOHB4IDE2cHg7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7DQogICAgbGV0dGVyLXNwYWNpbmc6IDAuNXB4Ow0KfQ0KDQoubWVudS1pdGVtIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxMHB4Ow0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDEwcHggMTZweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAwLjJzIGVhc2U7DQogICAgdGV4dC1hbGlnbjogbGVmdDsNCn0NCg0KLm1lbnUtaXRlbTpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYm9yZGVyLWNvbG9yKTsNCn0NCg0KLm1lbnUtaXRlbS5kYW5nZXIgew0KICAgIGNvbG9yOiAjZmY2YjZiOw0KfQ0KDQoubWVudS1pdGVtLmRhbmdlcjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDEwNywgMTA3LCAwLjEpOw0KfQ0KDQoubWVudS16b29tLWNvbnRyb2xzIHsNCiAgICBwYWRkaW5nOiAwIDE2cHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGdhcDogNHB4Ow0KfQ0KDQoubWVudS16b29tLWxldmVsIHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIHBhZGRpbmc6IDRweCAwOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG1hcmdpbjogNHB4IDA7DQp9DQoNCi56b29tLWJ0biB7DQogICAgcGFkZGluZzogNnB4IDEycHggIWltcG9ydGFudDsNCiAgICBmb250LXNpemU6IDEycHggIWltcG9ydGFudDsNCn0NCg0KLyogUmVzcG9uc2l2ZSBEZXNpZ24gKi8NCkBtZWRpYSAobWF4LXdpZHRoOiAxMjAwcHgpIHsNCiAgICAuZmxvdy1lZGl0b3Igew0KICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgICAgICBtaW4taGVpZ2h0OiAwOw0KICAgIH0NCiAgICANCiAgICAuZmxvdy10b29sYm94IHsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgIGhlaWdodDogYXV0bzsNCiAgICAgICAgYm9yZGVyLXJpZ2h0OiBub25lOw0KICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICAgICAgZmxleC1zaHJpbms6IDA7DQogICAgICAgIG1heC1oZWlnaHQ6IDIwMHB4Ow0KICAgIH0NCiAgICANCiAgICAudG9vbGJveC1jb250ZW50IHsNCiAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgZmxleC13cmFwOiB3cmFwOw0KICAgICAgICBnYXA6IDEwcHg7DQogICAgICAgIHBhZGRpbmc6IDE1cHg7DQogICAgICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgfQ0KICAgIA0KICAgIC5ub2RlLWNhdGVnb3J5IHsNCiAgICAgICAgbWFyZ2luLWJvdHRvbTogMDsNCiAgICAgICAgZmxleDogMTsNCiAgICAgICAgbWluLXdpZHRoOiAyMDBweDsNCiAgICB9DQogICAgDQogICAgLmZsb3ctd29ya3NwYWNlIHsNCiAgICAgICAgZmxleDogMTsNCiAgICAgICAgbWluLWhlaWdodDogMDsNCiAgICB9DQogICAgDQogICAgLmZsb3ctY29uZmlnLXBhbmVsIHsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgIGJvcmRlci1sZWZ0OiBub25lOw0KICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICAgICAgZmxleC1zaHJpbms6IDA7DQogICAgICAgIG1heC1oZWlnaHQ6IDMwMHB4Ow0KICAgIH0NCiAgICANCiAgICAuZmxvdy1vdXRwdXQtcGFuZWwgew0KICAgICAgICBtYXgtaGVpZ2h0OiAyMDBweDsNCiAgICB9DQogICAgDQogICAgLm91dHB1dC1jb250ZW50IHsNCiAgICAgICAgbWF4LWhlaWdodDogMTUwcHg7DQogICAgfQ0KfQ0KDQpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsNCiAgICAuYXBwLWNvbnRlbnQgew0KICAgICAgICBwYWRkaW5nOiA1cHg7DQogICAgICAgIGdhcDogNXB4Ow0KICAgIH0NCiAgICANCiAgICAuZmxvdy10b29sYmFyIHsNCiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgZ2FwOiAxMHB4Ow0KICAgICAgICBwYWRkaW5nOiA4cHggMTVweDsNCiAgICB9DQogICAgDQogICAgLnRvb2xiYXItbGVmdCwNCiAgICAudG9vbGJhci1yaWdodCB7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICAgICAgZmxleC13cmFwOiB3cmFwOw0KICAgIH0NCiAgICANCiAgICAuZmxvdy10b29sYmFyIC5idG4gew0KICAgICAgICBmb250LXNpemU6IDEycHg7DQogICAgICAgIHBhZGRpbmc6IDZweCAxMHB4Ow0KICAgIH0NCiAgICANCiAgICAuZmxvdy10b29sYm94IHsNCiAgICAgICAgbWF4LWhlaWdodDogMTUwcHg7DQogICAgfQ0KICAgIA0KICAgIC5mbG93LWNvbmZpZy1wYW5lbCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDI1MHB4Ow0KICAgIH0NCiAgICANCiAgICAuZmxvdy1vdXRwdXQtcGFuZWwgew0KICAgICAgICBtYXgtaGVpZ2h0OiAxNTBweDsNCiAgICB9DQogICAgDQogICAgLm91dHB1dC1jb250ZW50IHsNCiAgICAgICAgbWF4LWhlaWdodDogMTAwcHg7DQogICAgICAgIHBhZGRpbmc6IDEwcHg7DQogICAgfQ0KfQ0KDQpAbWVkaWEgKG1heC13aWR0aDogNDgwcHgpIHsNCiAgICAudG9vbGJhci1sZWZ0LA0KICAgIC50b29sYmFyLXJpZ2h0IHsNCiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgZ2FwOiA1cHg7DQogICAgICAgIGFsaWduLWl0ZW1zOiBzdHJldGNoOw0KICAgIH0NCiAgICANCiAgICAuZmxvdy10b29sYmFyIC5idG4gew0KICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIH0NCiAgICANCiAgICAuem9vbS1jb250cm9scyB7DQogICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgIH0NCn0NCg0KDQovKiA9PT09PSBTdHlsZTogY3NzL29zLXRoZW1lLmNzcyA9PT09PSAqLw0KLyogRmxvdyBFZGl0b3IgLSBTeXBuZXhPUyBUaGVtZSBJbnRlZ3JhdGlvbiAqLw0KLyogVGhpcyBmaWxlIGVuc3VyZXMgdGhlIGZsb3cgZWRpdG9yIG1hdGNoZXMgdGhlIE9TIGFlc3RoZXRpYyBwZXJmZWN0bHkgKi8NCg0KOnJvb3Qgew0KICAgIC8qIE92ZXJyaWRlIGZsb3cgZWRpdG9yIHZhcmlhYmxlcyB3aXRoIE9TIHZhcmlhYmxlcyAqLw0KICAgIC0tc3VyZmFjZS1jb2xvcjogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIC0tYm9yZGVyLWNvbG9yOiB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIC0tdGV4dC1jb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsNCiAgICAtLXRleHQtbXV0ZWQ6IHZhcigtLXRleHQtc2Vjb25kYXJ5KTsNCiAgICAtLXByaW1hcnktY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgLS1wcmltYXJ5LWNvbG9yLXJnYjogMCwgMjEyLCAyNTU7DQogICAgLS1lcnJvci1jb2xvcjogI2ZmNDc1NzsNCiAgICAtLXN1Y2Nlc3MtY29sb3I6ICMyZWQ1NzM7DQogICAgLS13YXJuaW5nLWNvbG9yOiAjZmZhNTAyOw0KfQ0KDQovKiBFbmhhbmNlZCBnbGFzcyBtb3JwaGlzbSBmb3IgZmxvdyBlZGl0b3IgKi8NCi5mbG93LWVkaXRvciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm9yZGVyLXJhZGl1czogMTJweDsNCiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTBweCk7DQogICAgYm94LXNoYWRvdzogMCA4cHggMzJweCByZ2JhKDAsIDAsIDAsIDAuMyk7DQp9DQoNCi8qIFRvb2xib3ggd2l0aCBiZXR0ZXIgZ2xhc3MgZWZmZWN0ICovDQouZmxvdy10b29sYm94IHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI2LCAyNiwgMjYsIDAuOSk7DQogICAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTVweCk7DQp9DQoNCi50b29sYm94LWhlYWRlciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgxMCwgMTAsIDEwLCAwLjgpOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KfQ0KDQoudG9vbGJveC1oZWFkZXIgaDQgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIHRleHQtc2hhZG93OiAwIDAgMTBweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjMpOw0KfQ0KDQovKiBFbmhhbmNlZCBub2RlIHN0eWxpbmcgd2l0aCBnbGFzcyBtb3JwaGlzbSAqLw0KLmZsb3ctbm9kZSB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm9yZGVyLXJhZGl1czogMTJweDsNCiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTBweCk7DQogICAgYm94LXNoYWRvdzogMCA0cHggMjBweCByZ2JhKDAsIDAsIDAsIDAuMik7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCn0NCg0KLmZsb3ctbm9kZTpob3ZlciB7DQogICAgYm94LXNoYWRvdzogMCA4cHggMzJweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjIpOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMnB4KTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQp9DQoNCi5mbG93LW5vZGUuc2VsZWN0ZWQgew0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBib3gtc2hhZG93OiAwIDAgMCAzcHggcmdiYSgwLCAyMTIsIDI1NSwgMC4zKTsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDIxMiwgMjU1LCAwLjA1KTsNCn0NCg0KLyogTm9kZSBwb3J0cyB3aXRoIG5lb24gZ2xvdyAqLw0KLmZsb3ctbm9kZS1wb3J0IHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3gtc2hhZG93OiAwIDAgMTBweCByZ2JhKDAsIDAsIDAsIDAuNSk7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCn0NCg0KLmZsb3ctbm9kZS1wb3J0OmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBib3gtc2hhZG93OiAwIDAgMTVweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjgpOw0KICAgIHRyYW5zZm9ybTogc2NhbGUoMS4zKTsNCn0NCg0KLyogQ29ubmVjdGlvbiBsaW5lcyB3aXRoIG5lb24gZWZmZWN0ICovDQouZmxvdy1jb25uZWN0aW9uLWxpbmUgew0KICAgIHN0cm9rZTogdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBzdHJva2Utd2lkdGg6IDM7DQogICAgZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgM3B4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMykpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7DQp9DQoNCi5mbG93LWNvbm5lY3Rpb24tbGluZTpob3ZlciwNCi5mbG93LWNvbm5lY3Rpb24tbGluZS5jb25uZWN0ZWQgew0KICAgIHN0cm9rZTogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBzdHJva2Utd2lkdGg6IDQ7DQogICAgZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgOHB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuOCkpOw0KfQ0KDQovKiBUb29sYmFyIHdpdGggZ2xhc3MgZWZmZWN0ICovDQouZmxvdy10b29sYmFyIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDEwLCAxMCwgMTAsIDAuOSk7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDE1cHgpOw0KfQ0KDQovKiBFbmhhbmNlZCBidXR0b24gc3R5bGluZyAqLw0KLnRvb2xib3gtbm9kZS1idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOw0KfQ0KDQoudG9vbGJveC1ub2RlLWJ0bjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAyMTIsIDI1NSwgMC4xKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDE1cHggcmdiYSgwLCAyMTIsIDI1NSwgMC4yKTsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCn0NCg0KLyogRmxvdyB0b29sYmFyIGJ1dHRvbnMgKi8NCi5mbG93LXRvb2xiYXIgLmJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOw0KfQ0KDQouZmxvdy10b29sYmFyIC5idG46aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMjEyLCAyNTUsIDAuMSk7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsNCiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMik7DQp9DQoNCi5mbG93LXRvb2xiYXIgLmJ0bi1zdWNjZXNzIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWJnKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQp9DQoNCi5mbG93LXRvb2xiYXIgLmJ0bi1zdWNjZXNzOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtaG92ZXIpOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDIwcHggcmdiYSgwLCAyMTIsIDI1NSwgMC40KTsNCn0NCg0KLmZsb3ctdG9vbGJhciAuYnRuLWRhbmdlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCn0NCg0KLmZsb3ctdG9vbGJhciAuYnRuLWRhbmdlcjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogI2ZmMzc0MjsNCiAgICBib3gtc2hhZG93OiAwIDRweCAyMHB4IHJnYmEoMjU1LCA3MSwgODcsIDAuNCk7DQp9DQoNCi8qIE5vZGUgdHlwZSBzdHlsaW5nICovDQouZmxvdy1ub2RlLXR5cGUgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgY29sb3I6IHZhcigtLXByaW1hcnktYmcpOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgdGV4dC1zaGFkb3c6IG5vbmU7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KfQ0KDQovKiBOb2RlIGRlbGV0ZSBidXR0b24gKi8NCi5ub2RlLWRlbGV0ZS1idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMik7DQogICAgYm94LXNoYWRvdzogMCAycHggMTBweCByZ2JhKDI1NSwgNzEsIDg3LCAwLjMpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7DQp9DQoNCi5ub2RlLWRlbGV0ZS1idG46aG92ZXIgew0KICAgIGJhY2tncm91bmQ6ICNmZjM3NDI7DQogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDE1cHggcmdiYSgyNTUsIDcxLCA4NywgMC41KTsNCn0NCg0KLyogQ3VycmVudCBmaWxlbmFtZSBzdHlsaW5nICovDQouY3VycmVudC1maWxlbmFtZSB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICB0ZXh0LXNoYWRvdzogMCAwIDVweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjMpOw0KfQ0KDQovKiBab29tIGNvbnRyb2xzICovDQouem9vbS1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBwYWRkaW5nOiA0cHg7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOw0KfQ0KDQouem9vbS1sZXZlbCB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBtaW4td2lkdGg6IDQ1cHg7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMTJweDsNCn0NCg0KLyogTG9hZGluZyBzdGF0ZSAqLw0KLmxvYWRpbmctbm9kZXMgew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXNlY29uZGFyeSk7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIHBhZGRpbmc6IDIwcHg7DQogICAgZm9udC1zdHlsZTogaXRhbGljOw0KfQ0KDQovKiBOb2RlIGNhdGVnb3JpZXMgKi8NCi5ub2RlLWNhdGVnb3J5IGg1IHsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOw0KICAgIGxldHRlci1zcGFjaW5nOiAxcHg7DQogICAgZm9udC13ZWlnaHQ6IDcwMDsNCiAgICBmb250LXNpemU6IDExcHg7DQp9DQoNCi8qIENhbnZhcyB0YWdzIGFuZCBjb25maWd1cmF0aW9uIGxpc3QgdGFncyAqLw0KLmZsb3ctdGFnLA0KLmFyZWEtdGFnLA0KLnRhZy1pdGVtLA0KLmNhbnZhcy10YWcgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudDsNCiAgICBjb2xvcjogdmFyKC0tcHJpbWFyeS1iZykgIWltcG9ydGFudDsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDEwcHggcmdiYSgwLCAyMTIsIDI1NSwgMC4zKTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOw0KfQ0KDQouZmxvdy10YWc6aG92ZXIsDQouYXJlYS10YWc6aG92ZXIsDQoudGFnLWl0ZW06aG92ZXIsDQouY2FudmFzLXRhZzpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWhvdmVyKSAhaW1wb3J0YW50Ow0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDE1cHggcmdiYSgwLCAyMTIsIDI1NSwgMC41KTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7DQp9DQoNCi8qIFRhZyB0ZXh0IGFuZCBpY29ucyAqLw0KLmZsb3ctdGFnIC50YWctdGV4dCwNCi5hcmVhLXRhZyAudGFnLXRleHQsDQoudGFnLWl0ZW0gLnRhZy10ZXh0LA0KLmNhbnZhcy10YWcgLnRhZy10ZXh0LA0KLmZsb3ctdGFnIGksDQouYXJlYS10YWcgaSwNCi50YWctaXRlbSBpLA0KLmNhbnZhcy10YWcgaSB7DQogICAgY29sb3I6IHZhcigtLXByaW1hcnktYmcpICFpbXBvcnRhbnQ7DQp9DQoNCi8qIFRhZyBpbmRpY2F0b3IgY2lyY2xlcy9kb3RzIGluIGNvbmZpZ3VyYXRpb24gYXJlYSAqLw0KLnRhZy1pbmRpY2F0b3IsDQoudGFnLWNvbG9yLWluZGljYXRvciwNCi50YWctY2lyY2xlLA0KLnRhZy1kb3QsDQouYXJlYS10YWctaW5kaWNhdG9yLA0KLnRhZy1jb2xvciB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudDsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudDsNCn0NCg0KLyogVGFnIGl0ZW1zIGluIGNvbmZpZ3VyYXRpb24gbGlzdCAtIG1hdGNoIG5vZGUgbGlzdCBzdHlsaW5nICovDQoudGFnLWl0ZW0gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcikgIWltcG9ydGFudDsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSkgIWltcG9ydGFudDsNCn0NCg0KLnRhZy1pdGVtOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDIxMiwgMjU1LCAwLjEpICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQ7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDE1cHggcmdiYSgwLCAyMTIsIDI1NSwgMC4yKTsNCn0NCg0KLnRhZy1pdGVtIC50YWctbmFtZSB7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSkgIWltcG9ydGFudDsNCn0NCg0KLnRhZy1pdGVtIC50YWctaW5mbyB7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSkgIWltcG9ydGFudDsNCn0NCg0KLyogVGFnIGRlbGV0ZSBidXR0b24gc3R5bGluZyAqLw0KLnRhZy1kZWxldGUsDQoudGFnLWl0ZW0gLnRhZy1kZWxldGUgew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpICFpbXBvcnRhbnQ7DQogICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQgIWltcG9ydGFudDsNCiAgICBib3JkZXI6IG5vbmUgIWltcG9ydGFudDsNCn0NCg0KLnRhZy1kZWxldGU6aG92ZXIsDQoudGFnLWl0ZW0gLnRhZy1kZWxldGU6aG92ZXIgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQ7DQp9DQoNCi50YWctZGVsZXRlIGksDQoudGFnLWl0ZW0gLnRhZy1kZWxldGUgaSB7DQogICAgY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSkgIWltcG9ydGFudDsNCn0NCg0KLnRhZy1kZWxldGU6aG92ZXIgaSwNCi50YWctaXRlbSAudGFnLWRlbGV0ZTpob3ZlciBpIHsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50Ow0KfQ0KDQovKiBDb25maWd1cmF0aW9uIGFyZWEgaGVhZGVyIHRleHQgKi8NCi5jb25maWctaGVhZGVyLA0KLmNvbmZpZ3VyYXRpb24taGVhZGVyLA0KLmZsb3ctY29uZmlnLWhlYWRlciwNCi5jb25maWctcGxhY2Vob2xkZXIsDQouY29uZmlndXJhdGlvbi1wbGFjZWhvbGRlciwNCi5mbG93LWNvbmZpZy1hcmVhIHAsDQouZmxvdy1jb25maWctYXJlYSAucGxhY2Vob2xkZXIsDQouZmxvdy1jb25maWctYXJlYSAuY29uZmlnLW1lc3NhZ2UsDQouY29uZmlnLWFyZWEgcCwNCi5jb25maWctYXJlYSAucGxhY2Vob2xkZXIsDQouY29uZmlnLWFyZWEgLmNvbmZpZy1tZXNzYWdlLA0KLmZsb3ctY29uZmlndXJhdGlvbiBwLA0KLmZsb3ctY29uZmlndXJhdGlvbiAucGxhY2Vob2xkZXIsDQoudGV4dC1tdXRlZCB7DQogICAgY29sb3I6IHZhcigtLXRleHQtc2Vjb25kYXJ5KSAhaW1wb3J0YW50Ow0KfQ0KDQovKiBSdW5uaW5nIHN0YXRlIHdpdGggcHVsc2luZyBlZmZlY3QgKi8NCi5mbG93LW5vZGUucnVubmluZyB7DQogICAgYW5pbWF0aW9uOiBwdWxzZS1uZW9uIDJzIGluZmluaXRlOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tc3VjY2Vzcy1jb2xvcik7DQp9DQoNCkBrZXlmcmFtZXMgcHVsc2UtbmVvbiB7DQogICAgMCUsIDEwMCUgeyANCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDVweCByZ2JhKDQ2LCAyMTMsIDExNSwgMC41KTsNCiAgICB9DQogICAgNTAlIHsgDQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAyMHB4IHJnYmEoNDYsIDIxMywgMTE1LCAwLjgpLCAwIDAgMzBweCByZ2JhKDQ2LCAyMTMsIDExNSwgMC40KTsNCiAgICB9DQp9DQoNCi8qIEVycm9yIHN0YXRlICovDQouZmxvdy1ub2RlLmVycm9yIHsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBhbmltYXRpb246IHB1bHNlLWVycm9yLW5lb24gMXMgaW5maW5pdGU7DQp9DQoNCkBrZXlmcmFtZXMgcHVsc2UtZXJyb3ItbmVvbiB7DQogICAgMCUsIDEwMCUgeyANCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDVweCByZ2JhKDI1NSwgNzEsIDg3LCAwLjUpOw0KICAgIH0NCiAgICA1MCUgeyANCiAgICAgICAgYm94LXNoYWRvdzogMCAwIDIwcHggcmdiYSgyNTUsIDcxLCA4NywgMC44KSwgMCAwIDMwcHggcmdiYSgyNTUsIDcxLCA4NywgMC40KTsNCiAgICB9DQp9DQoNCi8qIFJlc3BvbnNpdmUgYWRqdXN0bWVudHMgKi8NCkBtZWRpYSAobWF4LXdpZHRoOiA3NjhweCkgew0KICAgIC5mbG93LXRvb2xib3ggew0KICAgICAgICB3aWR0aDogMjAwcHg7DQogICAgfQ0KICAgIA0KICAgIC5mbG93LW5vZGUgew0KICAgICAgICBtaW4td2lkdGg6IDEyMHB4Ow0KICAgICAgICBmb250LXNpemU6IDEycHg7DQogICAgfQ0KICAgIA0KICAgIC50b29sYm94LW5vZGUtYnRuIHsNCiAgICAgICAgcGFkZGluZzogOHB4IDEwcHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICB9DQp9DQo8L3N0eWxlPg0KPHNjcmlwdD4vLyA9PT09PSBTY3JpcHQ6IGpzL3V0aWxzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9ub2RlLXJlZ2lzdHJ5LmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9jYW52YXMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL25vZGUtY29uZmlnLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9ub2RlLXJlbmRlcmVyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9kYXRhLWV4ZWN1dG9ycy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvaHR0cC1leGVjdXRvcnMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL21lZGlhLWV4ZWN1dG9ycy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvZmxvdy1leGVjdXRvcnMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2FpLWV4ZWN1dG9ycy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvZXhlY3V0aW9uLWVuZ2luZS5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvd29ya2Zsb3cuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2NhbnZhcy1tYW5hZ2VyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy90YWctbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvZmlsZS1tYW5hZ2VyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy91aS1tYW5hZ2VyLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9tYWluLmpzID09PT09DQoNCg0KLy8gdXRpbHMuanMgLSBVdGlsaXR5IGZ1bmN0aW9ucyBmb3IgRmxvdyBFZGl0b3INCg0KLy8gQ2FudmFzLXNwZWNpZmljIGNvb3JkaW5hdGUgdHJhbnNmb3JtYXRpb24gdXRpbGl0aWVzDQovLyAoQXBwIHNjYWxpbmcgdXRpbGl0aWVzIGFyZSBub3cgY2VudHJhbGl6ZWQgaW4gc3lwbmV4QVBJLnNjYWxpbmcpDQoNCi8vIFV0aWxpdHkgZnVuY3Rpb24gdG8gZXNjYXBlIEhUTUwNCmZ1bmN0aW9uIGVzY2FwZUh0bWwodGV4dCkgew0KICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIGRpdi50ZXh0Q29udGVudCA9IHRleHQ7DQogICAgcmV0dXJuIGRpdi5pbm5lckhUTUw7DQp9DQoNCi8vIFV0aWxpdHkgZnVuY3Rpb24gdG8gZm9ybWF0IGZpbGUgc2l6ZQ0KZnVuY3Rpb24gZm9ybWF0RmlsZVNpemUoYnl0ZXMpIHsNCiAgICBpZiAoYnl0ZXMgPT09IDApIHJldHVybiAnMCBCeXRlcyc7DQogICAgY29uc3QgayA9IDEwMjQ7DQogICAgY29uc3Qgc2l6ZXMgPSBbJ0J5dGVzJywgJ0tCJywgJ01CJywgJ0dCJ107DQogICAgY29uc3QgaSA9IE1hdGguZmxvb3IoTWF0aC5sb2coYnl0ZXMpIC8gTWF0aC5sb2coaykpOw0KICAgIHJldHVybiBwYXJzZUZsb2F0KChieXRlcyAvIE1hdGgucG93KGssIGkpKS50b0ZpeGVkKDIpKSArICcgJyArIHNpemVzW2ldOw0KfQ0KDQovLyBVdGlsaXR5IGZ1bmN0aW9uIHRvIGRlYm91bmNlIGZ1bmN0aW9uIGNhbGxzDQpmdW5jdGlvbiBkZWJvdW5jZShmdW5jLCB3YWl0KSB7DQogICAgbGV0IHRpbWVvdXQ7DQogICAgcmV0dXJuIGZ1bmN0aW9uIGV4ZWN1dGVkRnVuY3Rpb24oLi4uYXJncykgew0KICAgICAgICBjb25zdCBsYXRlciA9ICgpID0+IHsNCiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTsNCiAgICAgICAgICAgIGZ1bmMoLi4uYXJncyk7DQogICAgICAgIH07DQogICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTsNCiAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHdhaXQpOw0KICAgIH07DQp9DQoNCg0KLy8gSGVscGVyIG1ldGhvZCBmb3IgdGVtcGxhdGUgcHJvY2Vzc2luZw0KZnVuY3Rpb24gcHJvY2Vzc1RlbXBsYXRlcyh0ZW1wbGF0ZSwgZGF0YSkgew0KICAgIC8vIFNpbXBsZSB0ZW1wbGF0ZSBwcm9jZXNzaW5nIC0gY2FuIGJlIGVuaGFuY2VkDQogICAgbGV0IHJlc3VsdCA9IHRlbXBsYXRlOw0KICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZGF0YSkpIHsNCiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKG5ldyBSZWdFeHAoYHt7JHtrZXl9fX1gLCAnZycpLCB2YWx1ZSk7DQogICAgICAgIH0NCiAgICB9DQogICAgcmV0dXJuIHJlc3VsdDsNCn0NCg0KLy8gSGVscGVyIG1ldGhvZCBmb3IgZXh0cmFjdGluZyBuZXN0ZWQgSlNPTiB2YWx1ZXMNCmZ1bmN0aW9uIGV4dHJhY3ROZXN0ZWRWYWx1ZShvYmosIHBhdGgpIHsNCiAgICBjb25zdCBrZXlzID0gcGF0aC5zcGxpdCgnLicpOw0KICAgIGxldCBjdXJyZW50ID0gb2JqOw0KDQogICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgew0KICAgICAgICBpZiAoY3VycmVudCA9PT0gbnVsbCB8fCBjdXJyZW50ID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gSGFuZGxlIGFycmF5IGFjY2VzcyBsaWtlICJpdGVtc1swXS5uYW1lIg0KICAgICAgICBjb25zdCBhcnJheU1hdGNoID0ga2V5Lm1hdGNoKC9eKC4rKVxbKFxkKylcXSQvKTsNCiAgICAgICAgaWYgKGFycmF5TWF0Y2gpIHsNCiAgICAgICAgICAgIGNvbnN0IGFycmF5S2V5ID0gYXJyYXlNYXRjaFsxXTsNCiAgICAgICAgICAgIGNvbnN0IGFycmF5SW5kZXggPSBwYXJzZUludChhcnJheU1hdGNoWzJdKTsNCg0KICAgICAgICAgICAgaWYgKGN1cnJlbnRbYXJyYXlLZXldICYmIEFycmF5LmlzQXJyYXkoY3VycmVudFthcnJheUtleV0pKSB7DQogICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnRbYXJyYXlLZXldW2FycmF5SW5kZXhdOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50W2tleV07DQogICAgICAgIH0NCiAgICB9DQoNCiAgICByZXR1cm4gY3VycmVudDsNCn0NCg0KLy8gSGVscGVyIG1ldGhvZCB0byBkZXRlY3QgaW1hZ2UgdHlwZSBmcm9tIGJhc2U2NCBkYXRhDQpmdW5jdGlvbiBkZXRlY3RJbWFnZVR5cGVGcm9tQmFzZTY0KGJhc2U2NERhdGEpIHsNCiAgICAvLyBDaGVjayB0aGUgZmlyc3QgZmV3IGJ5dGVzIHRvIGRldGVybWluZSBpbWFnZSB0eXBlDQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgYmluYXJ5U3RyaW5nID0gYXRvYihiYXNlNjREYXRhKTsNCiAgICAgICAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheShiaW5hcnlTdHJpbmcubGVuZ3RoKTsNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaW5hcnlTdHJpbmcubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGJ5dGVzW2ldID0gYmluYXJ5U3RyaW5nLmNoYXJDb2RlQXQoaSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBDaGVjayBmaWxlIHNpZ25hdHVyZXMNCiAgICAgICAgaWYgKGJ5dGVzWzBdID09PSAweEZGICYmIGJ5dGVzWzFdID09PSAweEQ4ICYmIGJ5dGVzWzJdID09PSAweEZGKSB7DQogICAgICAgICAgICByZXR1cm4gJ2ltYWdlL2pwZWcnOw0KICAgICAgICB9IGVsc2UgaWYgKGJ5dGVzWzBdID09PSAweDg5ICYmIGJ5dGVzWzFdID09PSAweDUwICYmIGJ5dGVzWzJdID09PSAweDRFICYmIGJ5dGVzWzNdID09PSAweDQ3KSB7DQogICAgICAgICAgICByZXR1cm4gJ2ltYWdlL3BuZyc7DQogICAgICAgIH0gZWxzZSBpZiAoYnl0ZXNbMF0gPT09IDB4NDcgJiYgYnl0ZXNbMV0gPT09IDB4NDkgJiYgYnl0ZXNbMl0gPT09IDB4NDYpIHsNCiAgICAgICAgICAgIHJldHVybiAnaW1hZ2UvZ2lmJzsNCiAgICAgICAgfSBlbHNlIGlmIChieXRlc1swXSA9PT0gMHg1MiAmJiBieXRlc1sxXSA9PT0gMHg0OSAmJiBieXRlc1syXSA9PT0gMHg0NiAmJiBieXRlc1szXSA9PT0gMHg0Nikgew0KICAgICAgICAgICAgcmV0dXJuICdpbWFnZS93ZWJwJzsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIERlZmF1bHQgdG8gUE5HIGlmIHdlIGNhbid0IGRldGVybWluZQ0KICAgICAgICAgICAgcmV0dXJuICdpbWFnZS9wbmcnOw0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAvLyBEZWZhdWx0IHRvIFBORyBpZiB0aGVyZSdzIGFuIGVycm9yDQogICAgICAgIHJldHVybiAnaW1hZ2UvcG5nJzsNCiAgICB9DQp9DQoNCi8vIENvbnZlcnQgdmlld3BvcnQgY29vcmRpbmF0ZXMgdG8gY2FudmFzIGNvb3JkaW5hdGVzIChhY2NvdW50aW5nIGZvciBwYW4gYW5kIHpvb20pDQpmdW5jdGlvbiB2aWV3cG9ydFRvQ2FudmFzQ29vcmRzKHZpZXdwb3J0WCwgdmlld3BvcnRZKSB7DQogICAgaWYgKHR5cGVvZiBmbG93RWRpdG9yID09PSAndW5kZWZpbmVkJykgew0KICAgICAgICByZXR1cm4geyB4OiB2aWV3cG9ydFgsIHk6IHZpZXdwb3J0WSB9Ow0KICAgIH0NCiAgICANCiAgICByZXR1cm4gew0KICAgICAgICB4OiAodmlld3BvcnRYIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueCkgLyBmbG93RWRpdG9yLnpvb21MZXZlbCwNCiAgICAgICAgeTogKHZpZXdwb3J0WSAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWwNCiAgICB9Ow0KfQ0KDQovLyBDb252ZXJ0IGNhbnZhcyBjb29yZGluYXRlcyB0byB2aWV3cG9ydCBjb29yZGluYXRlcyAoYWNjb3VudGluZyBmb3IgcGFuIGFuZCB6b29tKQ0KZnVuY3Rpb24gY2FudmFzVG9WaWV3cG9ydENvb3JkcyhjYW52YXNYLCBjYW52YXNZKSB7DQogICAgaWYgKHR5cGVvZiBmbG93RWRpdG9yID09PSAndW5kZWZpbmVkJykgew0KICAgICAgICByZXR1cm4geyB4OiBjYW52YXNYLCB5OiBjYW52YXNZIH07DQogICAgfQ0KICAgIA0KICAgIHJldHVybiB7DQogICAgICAgIHg6IChjYW52YXNYICogZmxvd0VkaXRvci56b29tTGV2ZWwpICsgZmxvd0VkaXRvci5wYW5PZmZzZXQueCwNCiAgICAgICAgeTogKGNhbnZhc1kgKiBmbG93RWRpdG9yLnpvb21MZXZlbCkgKyBmbG93RWRpdG9yLnBhbk9mZnNldC55DQogICAgfTsNCn0NCg0KLy8gR2V0IHRoZSBjZW50ZXIgb2YgdGhlIGN1cnJlbnQgdmlld3BvcnQgaW4gY2FudmFzIGNvb3JkaW5hdGVzDQpmdW5jdGlvbiBnZXRWaWV3cG9ydENlbnRlckluQ2FudmFzKCkgew0KICAgIGlmICh0eXBlb2YgZmxvd0VkaXRvciA9PT0gJ3VuZGVmaW5lZCcgfHwgIWZsb3dFZGl0b3IuY2FudmFzKSB7DQogICAgICAgIHJldHVybiB7IHg6IDAsIHk6IDAgfTsNCiAgICB9DQogICAgDQogICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICBpZiAoIWNvbnRhaW5lcikgew0KICAgICAgICByZXR1cm4geyB4OiAwLCB5OiAwIH07DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgY29uc3Qgdmlld3BvcnRDZW50ZXJYID0gY29udGFpbmVyUmVjdC53aWR0aCAvIDI7DQogICAgY29uc3Qgdmlld3BvcnRDZW50ZXJZID0gY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyOw0KICAgIA0KICAgIHJldHVybiB2aWV3cG9ydFRvQ2FudmFzQ29vcmRzKHZpZXdwb3J0Q2VudGVyWCwgdmlld3BvcnRDZW50ZXJZKTsNCn0NCg0KLy8gQ2VudGVyIHRoZSB2aWV3cG9ydCBvbiBzcGVjaWZpYyBjYW52YXMgY29vcmRpbmF0ZXMNCmZ1bmN0aW9uIGNlbnRlclZpZXdwb3J0T25DYW52YXMoY2FudmFzWCwgY2FudmFzWSkgew0KICAgIGlmICh0eXBlb2YgZmxvd0VkaXRvciA9PT0gJ3VuZGVmaW5lZCcgfHwgIWZsb3dFZGl0b3IuY2FudmFzKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICBpZiAoIWNvbnRhaW5lcikgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgY29uc3Qgdmlld3BvcnRDZW50ZXJYID0gY29udGFpbmVyUmVjdC53aWR0aCAvIDI7DQogICAgY29uc3Qgdmlld3BvcnRDZW50ZXJZID0gY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBwYW4gb2Zmc2V0IHRvIGNlbnRlciB0aGUgc3BlY2lmaWVkIGNhbnZhcyBjb29yZGluYXRlcyBpbiB0aGUgdmlld3BvcnQNCiAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gdmlld3BvcnRDZW50ZXJYIC0gKGNhbnZhc1ggKiBmbG93RWRpdG9yLnpvb21MZXZlbCk7DQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IHZpZXdwb3J0Q2VudGVyWSAtIChjYW52YXNZICogZmxvd0VkaXRvci56b29tTGV2ZWwpOw0KICAgIA0KICAgIC8vIFVwZGF0ZSB0aGUgdHJhbnNmb3JtDQogICAgaWYgKHdpbmRvdy5jYW52YXNNYW5hZ2VyICYmIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSkgew0KICAgICAgICB3aW5kb3cuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICB9DQp9DQoNCi8vIEV4cG9ydCB1dGlsaXRpZXMgZm9yIHVzZSBpbiBvdGhlciBtb2R1bGVzDQovLyBDYW52YXMtc3BlY2lmaWMgdXRpbGl0aWVzIG9ubHkgLSBzY2FsaW5nIHV0aWxpdGllcyBhcmUgbm93IGluIHN5cG5leEFQSS5zY2FsaW5nDQp3aW5kb3cuZmxvd0VkaXRvclV0aWxzID0gew0KICAgIC8vIENhbnZhcy1zcGVjaWZpYyBjb29yZGluYXRlIHRyYW5zZm9ybWF0aW9ucw0KICAgIHZpZXdwb3J0VG9DYW52YXNDb29yZHMsDQogICAgY2FudmFzVG9WaWV3cG9ydENvb3JkcywNCiAgICBnZXRWaWV3cG9ydENlbnRlckluQ2FudmFzLA0KICAgIGNlbnRlclZpZXdwb3J0T25DYW52YXMsDQogICAgDQogICAgLy8gR2VuZXJhbCB1dGlsaXRpZXMNCiAgICBlc2NhcGVIdG1sLA0KICAgIGZvcm1hdEZpbGVTaXplLA0KICAgIGRlYm91bmNlLA0KICAgIHByb2Nlc3NUZW1wbGF0ZXMsDQogICAgZXh0cmFjdE5lc3RlZFZhbHVlLA0KICAgIGRldGVjdEltYWdlVHlwZUZyb21CYXNlNjQNCn07DQoNCi8vIFJlcGxhY2UgdGVtcGxhdGUgcGxhY2Vob2xkZXJzIGluIEpTT04gYm9keQ0KZnVuY3Rpb24gcmVwbGFjZVRlbXBsYXRlUGxhY2Vob2xkZXJzKGJvZHksIHRlbXBsYXRlRGF0YSkgew0KDQogICAgaWYgKCFib2R5KSB7DQogICAgICAgIHJldHVybiBib2R5Ow0KICAgIH0NCg0KICAgIC8vIEhhbmRsZSBib3RoIHN0cmluZyBhbmQgb2JqZWN0IGlucHV0cw0KICAgIGxldCBib2R5U3RyaW5nOw0KICAgIGxldCBpc0pzb25TdHJpbmcgPSBmYWxzZTsNCg0KICAgIGlmICh0eXBlb2YgYm9keSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgYm9keVN0cmluZyA9IGJvZHk7DQogICAgICAgIC8vIENoZWNrIGlmIGl0J3MgYWxyZWFkeSBhIEpTT04gc3RyaW5nDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBKU09OLnBhcnNlKGJvZHkpOw0KICAgICAgICAgICAgaXNKc29uU3RyaW5nID0gdHJ1ZTsNCiAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgLy8gTm90IGEgSlNPTiBzdHJpbmcsIHRyZWF0IGFzIHJlZ3VsYXIgc3RyaW5nDQogICAgICAgIH0NCiAgICB9IGVsc2UgaWYgKHR5cGVvZiBib2R5ID09PSAnb2JqZWN0Jykgew0KICAgICAgICBib2R5U3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoYm9keSk7DQogICAgICAgIGlzSnNvblN0cmluZyA9IHRydWU7DQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIGJvZHk7DQogICAgfQ0KDQoNCiAgICAvLyBSZXBsYWNlIHBsYWNlaG9sZGVycyB3aXRoIHRlbXBsYXRlIGRhdGENCiAgICBpZiAodGVtcGxhdGVEYXRhICE9PSB1bmRlZmluZWQgJiYgdGVtcGxhdGVEYXRhICE9PSBudWxsKSB7DQogICAgICAgIGNvbnN0IGJlZm9yZVJlcGxhY2UgPSBib2R5U3RyaW5nOw0KDQoNCiAgICAgICAgLy8gU2ltcGxlIEpTT04gZmllbGQgcmVwbGFjZW1lbnQgLSBqdXN0IHt7ZmllbGR9fSBvciB7e25lc3RlZC5maWVsZH19DQogICAgICAgIGlmICh0eXBlb2YgdGVtcGxhdGVEYXRhID09PSAnb2JqZWN0Jykgew0KDQogICAgICAgICAgICAvLyBVc2UgYSBzaW1wbGVyLCBtb3JlIGV4cGxpY2l0IHJlZ2V4DQogICAgICAgICAgICBjb25zdCBwbGFjZWhvbGRlclJlZ2V4ID0gL1x7XHsoW159XSspXH1cfS9nOw0KDQogICAgICAgICAgICAvLyBUZXN0IGlmIHRoZSByZWdleCBmaW5kcyBhbnl0aGluZw0KICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGJvZHlTdHJpbmcubWF0Y2gocGxhY2Vob2xkZXJSZWdleCk7DQoNCiAgICAgICAgICAgIGJvZHlTdHJpbmcgPSBib2R5U3RyaW5nLnJlcGxhY2UocGxhY2Vob2xkZXJSZWdleCwgKG1hdGNoLCBmaWVsZFBhdGgpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGdldE5lc3RlZFZhbHVlKHRlbXBsYXRlRGF0YSwgZmllbGRQYXRoKTsNCiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICBsZXQgcmVwbGFjZW1lbnQ7DQogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBBbHdheXMgZXNjYXBlIHRoZSBzdHJpbmcgcHJvcGVybHkgZm9yIEpTT04gY29udGV4dA0KICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnQgPSB2YWx1ZS5yZXBsYWNlKC9cXC9nLCAnXFxcXCcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyIvZywgJ1xcIicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xuL2csICdcXG4nKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cci9nLCAnXFxyJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXHQvZywgJ1xcdCcpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9yIG5vbi1zdHJpbmdzLCBjb252ZXJ0IHRvIEpTT04gc3RyaW5nDQogICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudCA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVwbGFjZW1lbnQ7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0ZW1wbGF0ZURhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAvLyBGb3Igc3RyaW5ncywganVzdCByZXBsYWNlIHt7VkFMVUV9fSBhcyBhIGZhbGxiYWNrDQogICAgICAgICAgICBib2R5U3RyaW5nID0gYm9keVN0cmluZy5yZXBsYWNlKC97e1ZBTFVFfX0vZywgSlNPTi5zdHJpbmdpZnkodGVtcGxhdGVEYXRhKSk7DQogICAgICAgIH0NCg0KICAgIH0gZWxzZSB7DQogICAgfQ0KDQogICAgaWYgKHR5cGVvZiBib2R5ID09PSAnb2JqZWN0Jykgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoYm9keVN0cmluZyk7DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGFyc2UgdGVtcGxhdGUtcmVwbGFjZWQgYm9keTonLCBlcnJvcik7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdCb2R5IHN0cmluZyB3YXM6JywgYm9keVN0cmluZyk7DQogICAgICAgICAgICByZXR1cm4gYm9keTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBib2R5U3RyaW5nOw0KICAgIH0NCn0NCg0KLy8gR2V0IG5lc3RlZCB2YWx1ZSBmcm9tIG9iamVjdCB1c2luZyBkb3Qgbm90YXRpb24NCmZ1bmN0aW9uIGdldE5lc3RlZFZhbHVlKG9iaiwgcGF0aCkgew0KICAgIGNvbnN0IHJlc3VsdCA9IHBhdGguc3BsaXQoJy4nKS5yZWR1Y2UoKGN1cnJlbnQsIGtleSkgPT4gew0KICAgICAgICBjb25zdCB2YWx1ZSA9IGN1cnJlbnQgJiYgY3VycmVudFtrZXldICE9PSB1bmRlZmluZWQgPyBjdXJyZW50W2tleV0gOiB1bmRlZmluZWQ7DQogICAgICAgIHJldHVybiB2YWx1ZTsNCiAgICB9LCBvYmopOw0KICAgIHJldHVybiByZXN1bHQ7DQp9DQoNCg0KLy8gVXBkYXRlIEpTT04gZXh0cmFjdCBub2RlIGRpc3BsYXkNCmZ1bmN0aW9uIHVwZGF0ZUpzb25FeHRyYWN0RGlzcGxheShub2RlSWQsIGxhYmVsLCB2YWx1ZSwgc3RhdHVzID0gJ25vcm1hbCcpIHsNCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgIGNvbnN0IGNvbnRlbnRFbGVtZW50ID0gbm9kZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLmZsb3ctbm9kZS1jb250ZW50Jyk7DQogICAgICAgIGlmIChjb250ZW50RWxlbWVudCkgew0KICAgICAgICAgICAgY29uc3Qgc3RhdHVzQ2xhc3MgPSBzdGF0dXMgPT09ICdlcnJvcicgPyAndGV4dC1kYW5nZXInIDogc3RhdHVzID09PSAnc3VjY2VzcycgPyAndGV4dC1zdWNjZXNzJyA6ICd0ZXh0LW11dGVkJzsNCg0KICAgICAgICAgICAgLy8gU2hvdyBqdXN0IGEgc3RhdHVzIG9uIHRoZSBub2RlLCBmdWxsIGNvbnRlbnQgd2lsbCBiZSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgICAgIGNvbnN0IHRydW5jYXRlZFZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiB2YWx1ZS5sZW5ndGggPiA1MCA/DQogICAgICAgICAgICAgICAgdmFsdWUuc3Vic3RyaW5nKDAsIDUwKSArICcuLi4nIDogdmFsdWU7DQoNCiAgICAgICAgICAgIGNvbnRlbnRFbGVtZW50LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJub2RlLXN0YXR1cyI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXR1cy10ZXh0Ij5WYWx1ZSBleHRyYWN0ZWQ8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdHVzLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPiR7bGFiZWx9OiAke2VzY2FwZUh0bWwoU3RyaW5nKHRydW5jYXRlZFZhbHVlKSl9PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBBZGQgZXhlY3V0aW9uIGxvZyBlbnRyeQ0KZnVuY3Rpb24gYWRkRXhlY3V0aW9uTG9nKG1lc3NhZ2UsIHR5cGUgPSAnaW5mbycpIHsNCiAgICBjb25zdCBvdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhlY3V0aW9uLW91dHB1dCcpOw0KICAgIGlmIChvdXRwdXQpIHsNCiAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoKTsNCiAgICAgICAgb3V0cHV0LmlubmVySFRNTCArPSBgPGRpdiBjbGFzcz0ibG9nLWVudHJ5ICR7dHlwZX0iPlske3RpbWVzdGFtcH1dICR7bWVzc2FnZX08L2Rpdj5gOw0KICAgICAgICBvdXRwdXQuc2Nyb2xsVG9wID0gb3V0cHV0LnNjcm9sbEhlaWdodDsNCiAgICB9DQp9DQoNCi8vIENsZWFyIGV4ZWN1dGlvbiBvdXRwdXQNCmZ1bmN0aW9uIGNsZWFyT3V0cHV0KCkgew0KICAgIGNvbnN0IG91dHB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleGVjdXRpb24tb3V0cHV0Jyk7DQogICAgaWYgKG91dHB1dCkgew0KICAgICAgICBvdXRwdXQuaW5uZXJIVE1MID0gJzxkaXYgY2xhc3M9ImxvZy1lbnRyeSBpbmZvIj5PdXRwdXQgY2xlYXJlZDwvZGl2Pic7DQogICAgfQ0KfQ0KDQoNCi8vIEludGVyYWN0aXZlIGhlbHBlciBmdW5jdGlvbnMgZm9yIHNwZWNpYWwgbm9kZSB0eXBlcw0KDQovLyBBdWRpbyBjb250cm9sIGZ1bmN0aW9ucw0KZnVuY3Rpb24gcGxheUF1ZGlvKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCAhbm9kZS5sYXN0QXVkaW9VcmwpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTm8gYXVkaW8gZGF0YSBhdmFpbGFibGUgZm9yIG5vZGU6Jywgbm9kZUlkKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIENyZWF0ZSBvciByZXVzZSBhdWRpbyBlbGVtZW50DQogICAgaWYgKCFub2RlLmF1ZGlvRWxlbWVudCkgew0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudCA9IG5ldyBBdWRpbyhub2RlLmxhc3RBdWRpb1VybCk7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnZvbHVtZSA9IHBhcnNlRmxvYXQobm9kZS5jb25maWcudm9sdW1lLnZhbHVlKTsNCiAgICB9DQoNCiAgICBub2RlLmF1ZGlvRWxlbWVudC5wbGF5KCkuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGxheSBhdWRpbzonLCBlcnJvcik7DQogICAgfSk7DQoNCn0NCg0KZnVuY3Rpb24gc3RvcEF1ZGlvKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCAhbm9kZS5hdWRpb0VsZW1lbnQpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTm8gYXVkaW8gZWxlbWVudCBmb3VuZCBmb3Igbm9kZTonLCBub2RlSWQpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgbm9kZS5hdWRpb0VsZW1lbnQucGF1c2UoKTsNCiAgICBub2RlLmF1ZGlvRWxlbWVudC5jdXJyZW50VGltZSA9IDA7DQoNCn0NCg0KLy8gSW1hZ2UgZGlzcGxheSBmdW5jdGlvbnMNCmZ1bmN0aW9uIHNob3dGdWxsSW1hZ2Uobm9kZUlkKSB7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlIHx8ICFub2RlLmxhc3RJbWFnZVVybCkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdObyBpbWFnZSBkYXRhIGF2YWlsYWJsZSBmb3Igbm9kZTonLCBub2RlSWQpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8gQ3JlYXRlIGEgbW9kYWwgdG8gc2hvdyB0aGUgZnVsbCBpbWFnZQ0KICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgbW9kYWwuY2xhc3NOYW1lID0gJ2ltYWdlLW1vZGFsJzsNCiAgICBtb2RhbC5zdHlsZS5jc3NUZXh0ID0gYA0KICAgICAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgICAgIHRvcDogMDsNCiAgICAgICAgbGVmdDogMDsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgIGhlaWdodDogMTAwJTsNCiAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjgpOw0KICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgICAgei1pbmRleDogMTAwMDA7DQogICAgICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBgOw0KDQogICAgY29uc3QgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7DQogICAgaW1nLnNyYyA9IG5vZGUubGFzdEltYWdlVXJsOw0KICAgIGltZy5zdHlsZS5jc3NUZXh0ID0gYA0KICAgICAgICBtYXgtd2lkdGg6IDkwJTsNCiAgICAgICAgbWF4LWhlaWdodDogOTAlOw0KICAgICAgICBvYmplY3QtZml0OiBjb250YWluOw0KICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDIwcHggcmdiYSgwLCAwLCAwLCAwLjUpOw0KICAgIGA7DQoNCiAgICBtb2RhbC5hcHBlbmRDaGlsZChpbWcpOw0KICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobW9kYWwpOw0KDQogICAgLy8gQ2xvc2UgbW9kYWwgb24gY2xpY2sNCiAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChtb2RhbCk7DQogICAgfSk7DQoNCn0NCg0KLy8gUmVwZWF0ZXIgY29udHJvbCBmdW5jdGlvbnMNCmZ1bmN0aW9uIHN0YXJ0UmVwZWF0ZXIobm9kZUlkKSB7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlIHx8IG5vZGUudHlwZSAhPT0gJ3JlcGVhdGVyJykgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIHJlcGVhdGVyIG5vZGU6Jywgbm9kZUlkKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIEV4ZWN1dGUgdGhlIHJlcGVhdGVyIG5vZGUgdG8gc3RhcnQgaXQNCiAgICBleGVjdXRpb25FbmdpbmUuZXhlY3V0ZU5vZGUobm9kZSwge30sIG5ldyBTZXQoKSkudGhlbigoKSA9PiB7DQogICAgICAgIC8vIFJlZnJlc2ggdGhlIGNvbmZpZyBwYW5lbCB0byB1cGRhdGUgdGhlIFVJDQogICAgICAgIHNob3dOb2RlQ29uZmlnKG5vZGVJZCk7DQogICAgfSkuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc3RhcnQgcmVwZWF0ZXI6JywgZXJyb3IpOw0KICAgIH0pOw0KfQ0KDQpmdW5jdGlvbiBzdG9wUmVwZWF0ZXIobm9kZUlkKSB7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlIHx8IG5vZGUudHlwZSAhPT0gJ3JlcGVhdGVyJykgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIHJlcGVhdGVyIG5vZGU6Jywgbm9kZUlkKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIFN0b3AgdGhlIHJlcGVhdGVyIHVzaW5nIHRoZSBleGVjdXRpb24gZW5naW5lIG1ldGhvZA0KICAgIGV4ZWN1dGlvbkVuZ2luZS5zdG9wUmVwZWF0ZXIobm9kZSk7DQoNCiAgICAvLyBSZWZyZXNoIHRoZSBjb25maWcgcGFuZWwgdG8gdXBkYXRlIHRoZSBVSQ0KICAgIHNob3dOb2RlQ29uZmlnKG5vZGVJZCk7DQp9DQoNCg0KDQovLyBVcGRhdGUgaW5wdXQgbWFwcGluZyB3aGVuIHVzZXIgc2VsZWN0cyBhIGRpZmZlcmVudCBvdXRwdXQgcG9ydA0KZnVuY3Rpb24gdXBkYXRlSW5wdXRNYXBwaW5nKG5vZGVJZCwgaW5wdXRQb3J0LCBzZWxlY3RlZE91dHB1dFBvcnQpIHsNCiAgICAvLyBGaW5kIHRoZSBjb25uZWN0aW9uIHRoYXQgZ29lcyB0byB0aGlzIGlucHV0IHBvcnQgKGlnbm9yZSBmcm9tLnBvcnROYW1lKQ0KICAgIGNvbnN0IGNvbm5lY3Rpb24gPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLmZpbmQoY29ubiA9Pg0KICAgICAgICBjb25uLnRvLm5vZGVJZCA9PT0gbm9kZUlkICYmIGNvbm4udG8ucG9ydE5hbWUgPT09IGlucHV0UG9ydA0KICAgICk7DQogICAgaWYgKGNvbm5lY3Rpb24pIHsNCiAgICAgICAgLy8gUmVtb3ZlIHRoZSBvbGQgY29ubmVjdGlvbg0KICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmRlbGV0ZShjb25uZWN0aW9uLmlkKTsNCiAgICAgICAgaWYgKGNvbm5lY3Rpb24uc3ZnKSBjb25uZWN0aW9uLnN2Zy5yZW1vdmUoKTsNCiAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IGNvbm5lY3Rpb24gd2l0aCB0aGUgdXBkYXRlZCBwb3J0IG5hbWUgYW5kIG5ldyBJRA0KICAgICAgICBjb25zdCBuZXdDb25uZWN0aW9uSWQgPSBgY29ubl8ke2Nvbm5lY3Rpb24uZnJvbS5ub2RlSWR9XyR7c2VsZWN0ZWRPdXRwdXRQb3J0fV8ke2Nvbm5lY3Rpb24udG8ubm9kZUlkfV8ke2Nvbm5lY3Rpb24udG8ucG9ydE5hbWV9YDsNCiAgICAgICAgY29uc3QgbmV3Q29ubmVjdGlvbiA9IHsNCiAgICAgICAgICAgIGlkOiBuZXdDb25uZWN0aW9uSWQsDQogICAgICAgICAgICBmcm9tOiB7IG5vZGVJZDogY29ubmVjdGlvbi5mcm9tLm5vZGVJZCwgcG9ydE5hbWU6IHNlbGVjdGVkT3V0cHV0UG9ydCB9LA0KICAgICAgICAgICAgdG86IHsgbm9kZUlkOiBjb25uZWN0aW9uLnRvLm5vZGVJZCwgcG9ydE5hbWU6IGNvbm5lY3Rpb24udG8ucG9ydE5hbWUgfQ0KICAgICAgICB9Ow0KICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnNldChuZXdDb25uZWN0aW9uSWQsIG5ld0Nvbm5lY3Rpb24pOw0KICAgICAgICBkcmF3Q29ubmVjdGlvbihuZXdDb25uZWN0aW9uKTsNCiAgICAgICAgLy8gUmVmcmVzaCB0aGUgbm9kZSBjb25maWcgcGFuZWwgdG8gc2hvdyB1cGRhdGVkIHN0YXRlDQogICAgICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9PT0gbm9kZUlkKSB7DQogICAgICAgICAgICBzaG93Tm9kZUNvbmZpZyhub2RlSWQpOw0KICAgICAgICB9DQogICAgICAgIC8vIEF1dG8tc2F2ZSB0aGUgd29ya2Zsb3cgdG8gcGVyc2lzdCB0aGUgbWFwcGluZyBjaGFuZ2UNCiAgICAgICAgaWYgKHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvdykgew0KICAgICAgICAgICAgd2luZG93LmZpbGVNYW5hZ2VyLnNhdmVGbG93KCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIFVwZGF0ZSBvdXRwdXQgbWFwcGluZyB3aGVuIHVzZXIgc2VsZWN0cyBhIGRpZmZlcmVudCBvdXRwdXQgcG9ydA0KZnVuY3Rpb24gdXBkYXRlT3V0cHV0TWFwcGluZyhub2RlSWQsIG91dHB1dFBvcnQsIHRhcmdldE5vZGVJZCwgc2VsZWN0ZWRPdXRwdXRQb3J0KSB7DQogICAgLy8gUmVtb3ZlIGFsbCBjb25uZWN0aW9ucyBmcm9tIHRoaXMgbm9kZSB0byB0aGUgdGFyZ2V0IG5vZGUgKHJlZ2FyZGxlc3Mgb2YgcG9ydCkNCiAgICBjb25zdCBjb25uZWN0aW9uc1RvUmVtb3ZlID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5maWx0ZXIoY29ubiA9Pg0KICAgICAgICBjb25uLmZyb20ubm9kZUlkID09PSBub2RlSWQgJiYgY29ubi50by5ub2RlSWQgPT09IHRhcmdldE5vZGVJZA0KICAgICk7DQogICAgY29ubmVjdGlvbnNUb1JlbW92ZS5mb3JFYWNoKGNvbm4gPT4gew0KICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmRlbGV0ZShjb25uLmlkKTsNCiAgICAgICAgaWYgKGNvbm4uc3ZnKSBjb25uLnN2Zy5yZW1vdmUoKTsNCiAgICB9KTsNCiAgICAvLyBBZGQgdGhlIG5ldyBjb25uZWN0aW9uDQogICAgY29uc3QgbmV3Q29ubmVjdGlvbklkID0gYGNvbm5fJHtub2RlSWR9XyR7c2VsZWN0ZWRPdXRwdXRQb3J0fV8ke3RhcmdldE5vZGVJZH1gOw0KICAgIGNvbnN0IG5ld0Nvbm5lY3Rpb24gPSB7DQogICAgICAgIGlkOiBuZXdDb25uZWN0aW9uSWQsDQogICAgICAgIGZyb206IHsgbm9kZUlkOiBub2RlSWQsIHBvcnROYW1lOiBzZWxlY3RlZE91dHB1dFBvcnQgfSwNCiAgICAgICAgdG86IHsgbm9kZUlkOiB0YXJnZXROb2RlSWQsIHBvcnROYW1lOiBjb25uZWN0aW9uc1RvUmVtb3ZlWzBdPy50by5wb3J0TmFtZSB8fCAnZGF0YScgfQ0KICAgIH07DQogICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5zZXQobmV3Q29ubmVjdGlvbklkLCBuZXdDb25uZWN0aW9uKTsNCiAgICBkcmF3Q29ubmVjdGlvbihuZXdDb25uZWN0aW9uKTsNCiAgICAvLyBSZWZyZXNoIHRoZSB0YXJnZXQgbm9kZSBpZiBzZWxlY3RlZA0KICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9PT0gdGFyZ2V0Tm9kZUlkKSB7DQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgc2hvd05vZGVDb25maWcodGFyZ2V0Tm9kZUlkKTsNCiAgICAgICAgfSwgMTApOw0KICAgIH0NCiAgICAvLyBBdXRvLXNhdmUNCiAgICBpZiAod2luZG93LmZpbGVNYW5hZ2VyLnNhdmVGbG93KSB3aW5kb3cuZmlsZU1hbmFnZXIuc2F2ZUZsb3coKTsNCn0NCg0KDQovLyBub2RlLXJlZ2lzdHJ5LmpzIC0gRHluYW1pYyBub2RlIHJlZ2lzdHJ5IGZvciBGbG93IEVkaXRvcg0KDQpjbGFzcyBOb2RlUmVnaXN0cnkgew0KICAgIGNvbnN0cnVjdG9yKCkgew0KICAgICAgICB0aGlzLm5vZGVUeXBlcyA9IG5ldyBNYXAoKTsNCiAgICAgICAgdGhpcy5leGVjdXRvcnMgPSBuZXcgTWFwKCk7DQogICAgICAgIHRoaXMubG9hZGVkID0gZmFsc2U7DQogICAgfQ0KICAgIA0KICAgIGFzeW5jIGxvYWROb2Rlc0Zyb21WRlMoKSB7DQogICAgICAgIGlmICh0aGlzLmxvYWRlZCkgcmV0dXJuOw0KICAgICAgICANCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTG9hZCB0aGUgcGFja2VkIG5vZGVzIGZpbGUgZGlyZWN0bHkNCiAgICAgICAgICAgIGNvbnN0IHBhY2tGaWxlUGF0aCA9ICcvbm9kZXMvbm9kZXMtcGFjay5qc29uJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVUZXh0KHBhY2tGaWxlUGF0aCk7DQogICAgICAgICAgICBjb25zdCBwYWNrRGF0YSA9IEpTT04ucGFyc2UoY29udGVudCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUmVnaXN0ZXIgYWxsIG5vZGVzIGZyb20gdGhlIHBhY2sNCiAgICAgICAgICAgIGZvciAoY29uc3QgW25vZGVJZCwgbm9kZURlZl0gb2YgT2JqZWN0LmVudHJpZXMocGFja0RhdGEubm9kZXMpKSB7DQogICAgICAgICAgICAgICAgdGhpcy5yZWdpc3Rlck5vZGUobm9kZURlZik7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIHRoaXMubG9hZGVkID0gdHJ1ZTsNCiAgICAgICAgICAgIA0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgbm9kZXMgZnJvbSBWRlMgcGFja2VkIGZpbGU6JywgZXJyb3IpOw0KICAgICAgICAgICAgdGhyb3cgZXJyb3I7IC8vIFJlLXRocm93IHRvIGluZGljYXRlIGZhaWx1cmUNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICBhc3luYyBsb2FkTm9kZUZpbGUoZmlsZVBhdGgpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlVGV4dChmaWxlUGF0aCk7DQogICAgICAgICAgICBjb25zdCBub2RlRGVmID0gSlNPTi5wYXJzZShjb250ZW50KTsNCiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJOb2RlKG5vZGVEZWYpOw0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGxvYWQgbm9kZSBmcm9tICR7ZmlsZVBhdGh9OmAsIGVycm9yKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICByZWdpc3Rlck5vZGUobm9kZURlZikgew0KICAgICAgICB0aGlzLm5vZGVUeXBlcy5zZXQobm9kZURlZi5pZCwgbm9kZURlZik7DQogICAgfQ0KICAgIA0KICAgIHJlZ2lzdGVyRXhlY3V0b3IobmFtZSwgZXhlY3V0b3IpIHsNCiAgICAgICAgdGhpcy5leGVjdXRvcnMuc2V0KG5hbWUsIGV4ZWN1dG9yKTsNCiAgICB9DQogICAgDQogICAgZ2V0Tm9kZVR5cGUoaWQpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMubm9kZVR5cGVzLmdldChpZCk7DQogICAgfQ0KICAgIA0KICAgIGdldEV4ZWN1dG9yKG5hbWUpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuZXhlY3V0b3JzLmdldChuYW1lKTsNCiAgICB9DQogICAgDQogICAgZ2V0QWxsTm9kZVR5cGVzKCkgew0KICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLm5vZGVUeXBlcy52YWx1ZXMoKSk7DQogICAgfQ0KICAgIA0KICAgIGdldE5vZGVUeXBlc0J5Q2F0ZWdvcnkoY2F0ZWdvcnkpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsTm9kZVR5cGVzKCkuZmlsdGVyKG5vZGUgPT4gbm9kZS5jYXRlZ29yeSA9PT0gY2F0ZWdvcnkpOw0KICAgIH0NCn0NCg0KLy8gR2xvYmFsIG5vZGUgcmVnaXN0cnkgaW5zdGFuY2UNCmNvbnN0IG5vZGVSZWdpc3RyeSA9IG5ldyBOb2RlUmVnaXN0cnkoKTsNCg0KDQovLyBjYW52YXMuanMgLSBDYW52YXMgZXZlbnQgaGFuZGxlcnMgYW5kIGRyYXdpbmcgbG9naWMgZm9yIEZsb3cgRWRpdG9yDQoNCi8vIFN0YXJ0IGRyYWdnaW5nIGEgbm9kZQ0KZnVuY3Rpb24gc3RhcnREcmFnZ2luZ05vZGUobm9kZUlkLCBlKSB7DQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgDQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlKSByZXR1cm47DQogICAgDQogICAgZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUgPSBub2RlSWQ7DQogICAgDQogICAgLy8gQ2FsY3VsYXRlIG9mZnNldCBmcm9tIG1vdXNlIHRvIG5vZGUgY29ybmVyIHVzaW5nIHNjYWxlZCBjb29yZGluYXRlcw0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICBjb25zdCByZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8gDQogICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3Qobm9kZUVsZW1lbnQpIDogDQogICAgICAgIG5vZGVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPyANCiAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDogDQogICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICANCiAgICBmbG93RWRpdG9yLmRyYWdPZmZzZXQgPSB7DQogICAgICAgIHg6IG1vdXNlQ29vcmRzLnggLSByZWN0LmxlZnQsDQogICAgICAgIHk6IG1vdXNlQ29vcmRzLnkgLSByZWN0LnRvcA0KICAgIH07DQogICAgDQogICAgbm9kZUVsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ2dyYWJiaW5nJzsNCiAgICBub2RlRWxlbWVudC5zdHlsZS56SW5kZXggPSAnMTAwMCc7IC8vIEJyaW5nIHRvIGZyb250IHdoaWxlIGRyYWdnaW5nDQogICAgDQogICAgLy8gQ2FjaGUgY2FudmFzIHJlY3QgZm9yIHBlcmZvcm1hbmNlIChzY2FsZWQpDQogICAgZmxvd0VkaXRvci5jYW52YXNSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8gDQogICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoZmxvd0VkaXRvci5jYW52YXMpIDogDQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KfQ0KDQovLyBTZWxlY3QgYSBub2RlDQpmdW5jdGlvbiBzZWxlY3ROb2RlKG5vZGVJZCkgew0KICAgIC8vIFJlbW92ZSBwcmV2aW91cyBzZWxlY3Rpb24NCiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmxvdy1ub2RlLnNlbGVjdGVkJykuZm9yRWFjaChub2RlID0+IHsNCiAgICAgICAgbm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpOw0KICAgIH0pOw0KICAgIA0KICAgIC8vIFNlbGVjdCBuZXcgbm9kZQ0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTsNCiAgICAgICAgZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPSBub2RlSWQ7DQogICAgICAgIHNob3dOb2RlQ29uZmlnKG5vZGVJZCk7DQogICAgfQ0KfQ0KDQoNCi8vIFN0YXJ0IGEgY29ubmVjdGlvbiBmcm9tIGEgcG9ydA0KZnVuY3Rpb24gc3RhcnRDb25uZWN0aW9uKG5vZGVJZCwgcG9ydE5hbWUsIGlzT3V0cHV0KSB7DQogICAgaWYgKGlzT3V0cHV0KSB7DQogICAgICAgIC8vIFN0YXJ0aW5nIGZyb20gb3V0cHV0IHBvcnQNCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbSA9IHsNCiAgICAgICAgICAgIG5vZGVJZDogbm9kZUlkLA0KICAgICAgICAgICAgcG9ydE5hbWU6IHBvcnROYW1lLA0KICAgICAgICAgICAgaXNPdXRwdXQ6IHRydWUNCiAgICAgICAgfTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBTdGFydGluZyBmcm9tIGlucHV0IHBvcnQgLSBjaGVjayBpZiB3ZSBoYXZlIGEgcGVuZGluZyBjb25uZWN0aW9uDQogICAgICAgIGlmIChmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tICYmIGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20uaXNPdXRwdXQpIHsNCiAgICAgICAgICAgIC8vIENvbXBsZXRlIHRoZSBjb25uZWN0aW9uDQogICAgICAgICAgICBjb25zdCBmcm9tTm9kZUlkID0gZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbS5ub2RlSWQ7DQogICAgICAgICAgICBjb25zdCBmcm9tUG9ydCA9IGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20ucG9ydE5hbWU7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNyZWF0ZUNvbm5lY3Rpb24oZnJvbU5vZGVJZCwgZnJvbVBvcnQsIG5vZGVJZCwgcG9ydE5hbWUpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbSA9IG51bGw7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIFVwZGF0ZSBjb25uZWN0aW9ucyBmb3IgYSBzcGVjaWZpYyBub2RlDQpmdW5jdGlvbiB1cGRhdGVDb25uZWN0aW9uc0Zvck5vZGUobm9kZUlkKSB7DQogICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IG5vZGVJZCB8fCBjb25uZWN0aW9uLnRvLm5vZGVJZCA9PT0gbm9kZUlkKSB7DQogICAgICAgICAgICB1cGRhdGVDb25uZWN0aW9uKGNvbm5lY3Rpb24pOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBVcGRhdGUgYSBzaW5nbGUgY29ubmVjdGlvbg0KZnVuY3Rpb24gdXBkYXRlQ29ubmVjdGlvbihjb25uZWN0aW9uKSB7DQogICAgY29uc3QgZnJvbU5vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0aW9uLmZyb20ubm9kZUlkKTsNCiAgICBjb25zdCB0b05vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgDQogICAgaWYgKCFmcm9tTm9kZSB8fCAhdG9Ob2RlIHx8ICFjb25uZWN0aW9uLnN2Zykgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIEdldCBub2RlIGRhdGEgcG9zaXRpb25zDQogICAgY29uc3QgZnJvbU5vZGVEYXRhID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCk7DQogICAgY29uc3QgdG9Ob2RlRGF0YSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICANCiAgICBpZiAoIWZyb21Ob2RlRGF0YSB8fCAhdG9Ob2RlRGF0YSkgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIEdldCBhY3R1YWwgbm9kZSBkaW1lbnNpb25zIGZyb20gY29tcHV0ZWQgc3R5bGVzDQogICAgY29uc3QgZnJvbVN0eWxlcyA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGZyb21Ob2RlKTsNCiAgICBjb25zdCB0b1N0eWxlcyA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRvTm9kZSk7DQogICAgDQogICAgY29uc3QgZnJvbVdpZHRoID0gcGFyc2VGbG9hdChmcm9tU3R5bGVzLndpZHRoKSB8fCAyMDA7DQogICAgY29uc3QgZnJvbUhlaWdodCA9IHBhcnNlRmxvYXQoZnJvbVN0eWxlcy5oZWlnaHQpIHx8IDgwOw0KICAgIGNvbnN0IHRvV2lkdGggPSBwYXJzZUZsb2F0KHRvU3R5bGVzLndpZHRoKSB8fCAyMDA7DQogICAgY29uc3QgdG9IZWlnaHQgPSBwYXJzZUZsb2F0KHRvU3R5bGVzLmhlaWdodCkgfHwgODA7DQogICAgDQogICAgLy8gQ2FsY3VsYXRlIGNvbm5lY3Rpb24gcG9zaXRpb25zIGRpcmVjdGx5IGZyb20gbm9kZSBkYXRhIChubyBleHRyYSB0cmFuc2Zvcm1zKQ0KICAgIC8vIEZyb20gb3V0cHV0IHBvcnQgKHJpZ2h0IHNpZGUgb2YgZnJvbSBub2RlLCBtaWRkbGUgdmVydGljYWxseSkNCiAgICBjb25zdCBmcm9tWCA9IGZyb21Ob2RlRGF0YS54ICsgZnJvbVdpZHRoOw0KICAgIGNvbnN0IGZyb21ZID0gZnJvbU5vZGVEYXRhLnkgKyBmcm9tSGVpZ2h0IC8gMjsNCiAgICANCiAgICAvLyBUbyBpbnB1dCBwb3J0IChsZWZ0IHNpZGUgb2YgdG8gbm9kZSwgbWlkZGxlIHZlcnRpY2FsbHkpICANCiAgICBjb25zdCB0b1ggPSB0b05vZGVEYXRhLng7DQogICAgY29uc3QgdG9ZID0gdG9Ob2RlRGF0YS55ICsgdG9IZWlnaHQgLyAyOw0KICAgIA0KICAgIA0KICAgIC8vIFVwZGF0ZSB0aGUgcGF0aA0KICAgIGNvbnN0IHBhdGggPSBjb25uZWN0aW9uLnN2Zy5xdWVyeVNlbGVjdG9yKCdwYXRoJyk7DQogICAgaWYgKHBhdGgpIHsNCiAgICAgICAgY29uc3QgY29udHJvbFBvaW50MVggPSBmcm9tWCArICh0b1ggLSBmcm9tWCkgKiAwLjU7DQogICAgICAgIGNvbnN0IGNvbnRyb2xQb2ludDJYID0gZnJvbVggKyAodG9YIC0gZnJvbVgpICogMC41Ow0KICAgICAgICBjb25zdCBwYXRoRCA9IGBNICR7ZnJvbVh9ICR7ZnJvbVl9IEMgJHtjb250cm9sUG9pbnQxWH0gJHtmcm9tWX0gJHtjb250cm9sUG9pbnQyWH0gJHt0b1l9ICR7dG9YfSAke3RvWX1gOw0KICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnZCcsIHBhdGhEKTsNCiAgICB9IGVsc2Ugew0KICAgIH0NCn0NCg0KLy8gUmVkcmF3IGFsbCBjb25uZWN0aW9ucyAoZm9yIHdpbmRvdyByZXNpemUsIGV0Yy4pDQpmdW5jdGlvbiByZWRyYXdBbGxDb25uZWN0aW9ucygpIHsNCiAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICB1cGRhdGVDb25uZWN0aW9uKGNvbm5lY3Rpb24pOw0KICAgIH0NCn0NCg0KLy8gRGVsZXRlIGEgbm9kZSBhbmQgYWxsIGl0cyBjb25uZWN0aW9ucw0KYXN5bmMgZnVuY3Rpb24gZGVsZXRlTm9kZShub2RlSWQpIHsNCiAgICBjb25zdCBjb25maXJtZWQgPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0NvbmZpcm1hdGlvbigNCiAgICAgICAgJ0RlbGV0ZSBOb2RlJywNCiAgICAgICAgJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyBub2RlPycsDQogICAgICAgIHsNCiAgICAgICAgICAgIHR5cGU6ICdkYW5nZXInLA0KICAgICAgICAgICAgY29uZmlybVRleHQ6ICdEZWxldGUnLA0KICAgICAgICAgICAgY2FuY2VsVGV4dDogJ0NhbmNlbCcsDQogICAgICAgICAgICBpY29uOiAnZmFzIGZhLWN1YmUnDQogICAgICAgIH0NCiAgICApOw0KICAgIA0KICAgIGlmIChjb25maXJtZWQpIHsNCiAgICAgICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhbiB1cCBhdWRpbyBlbGVtZW50cyBpZiB0aGlzIGlzIGFuIGF1ZGlvIG5vZGUNCiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS50eXBlID09PSAnYXVkaW8nICYmIG5vZGUuYXVkaW9FbGVtZW50KSB7DQogICAgICAgICAgICAvLyBQYXVzZSBhbmQgc3RvcCB0aGUgYXVkaW8NCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnBhdXNlKCk7DQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5jdXJyZW50VGltZSA9IDA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFJlbW92ZSBldmVudCBsaXN0ZW5lcnMgcHJvcGVybHkNCiAgICAgICAgICAgIGlmIChub2RlLmF1ZGlvRXZlbnRMaXN0ZW5lcnMpIHsNCiAgICAgICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdlbmRlZCcsIG5vZGUuYXVkaW9FdmVudExpc3RlbmVycy5lbmRlZCk7DQogICAgICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZXJyb3InLCBub2RlLmF1ZGlvRXZlbnRMaXN0ZW5lcnMuZXJyb3IpOw0KICAgICAgICAgICAgICAgIG5vZGUuYXVkaW9FdmVudExpc3RlbmVycyA9IG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFN0b3JlIHRoZSBzcmMgYmVmb3JlIGNsZWFyaW5nIGl0IGZvciBjbGVhbnVwDQogICAgICAgICAgICBjb25zdCBhdWRpb1NyYyA9IG5vZGUuYXVkaW9FbGVtZW50LnNyYzsNCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnNyYyA9ICcnOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBSZXZva2UgYmxvYiBVUkwgaWYgaXQgZXhpc3RzDQogICAgICAgICAgICBpZiAoYXVkaW9TcmMgJiYgYXVkaW9TcmMuc3RhcnRzV2l0aCgnYmxvYjonKSkgew0KICAgICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwoYXVkaW9TcmMpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDbGVhciB0aGUgYXVkaW8gZWxlbWVudCByZWZlcmVuY2UNCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50ID0gbnVsbDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gUmVtb3ZlIGFsbCBjb25uZWN0aW9ucyBpbnZvbHZpbmcgdGhpcyBub2RlDQogICAgICAgIGNvbnN0IGNvbm5lY3Rpb25zVG9EZWxldGUgPSBbXTsNCiAgICAgICAgZm9yIChjb25zdCBbY29ubmVjdGlvbklkLCBjb25uZWN0aW9uXSBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmVudHJpZXMoKSkgew0KICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IG5vZGVJZCB8fCBjb25uZWN0aW9uLnRvLm5vZGVJZCA9PT0gbm9kZUlkKSB7DQogICAgICAgICAgICAgICAgY29ubmVjdGlvbnNUb0RlbGV0ZS5wdXNoKGNvbm5lY3Rpb25JZCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIERlbGV0ZSBjb25uZWN0aW9ucw0KICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb25JZCBvZiBjb25uZWN0aW9uc1RvRGVsZXRlKSB7DQogICAgICAgICAgICBkZWxldGVDb25uZWN0aW9uKGNvbm5lY3Rpb25JZCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFJlbW92ZSBub2RlIGZyb20gZGF0YSBzdHJ1Y3R1cmUNCiAgICAgICAgZmxvd0VkaXRvci5ub2Rlcy5kZWxldGUobm9kZUlkKTsNCiAgICAgICAgDQogICAgICAgIC8vIFJlbW92ZSBub2RlIGVsZW1lbnQgZnJvbSBET00NCiAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LnJlbW92ZSgpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBEZXNlbGVjdCBpZiB0aGlzIHdhcyB0aGUgc2VsZWN0ZWQgbm9kZQ0KICAgICAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPT09IG5vZGVJZCkgew0KICAgICAgICAgICAgZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPSBudWxsOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUtY29uZmlnJykuaW5uZXJIVE1MID0gJzxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5TZWxlY3QgYSBub2RlIHRvIGNvbmZpZ3VyZSBpdDwvcD4nOw0KICAgICAgICB9DQogICAgICAgIA0KICAgIH0NCn0NCg0KLy8gRGVsZXRlIGEgY29ubmVjdGlvbg0KZnVuY3Rpb24gZGVsZXRlQ29ubmVjdGlvbihjb25uZWN0aW9uSWQpIHsNCiAgICBjb25zdCBjb25uZWN0aW9uID0gZmxvd0VkaXRvci5jb25uZWN0aW9ucy5nZXQoY29ubmVjdGlvbklkKTsNCiAgICBpZiAoY29ubmVjdGlvbiAmJiBjb25uZWN0aW9uLnN2Zykgew0KICAgICAgICBjb25uZWN0aW9uLnN2Zy5yZW1vdmUoKTsNCiAgICB9DQogICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5kZWxldGUoY29ubmVjdGlvbklkKTsNCn0NCg0KLy8gRGVsZXRlIHNlbGVjdGVkIG5vZGUNCmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVNlbGVjdGVkTm9kZSgpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpIHsNCiAgICAgICAgYXdhaXQgZGVsZXRlTm9kZShmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSk7DQogICAgfQ0KfQ0KDQovLyBIYW5kbGUga2V5Ym9hcmQgc2hvcnRjdXRzDQpmdW5jdGlvbiBoYW5kbGVLZXlEb3duKGUpIHsNCiAgICBpZiAoZS5rZXkgPT09ICdEZWxldGUnIHx8IChlLmtleSA9PT0gJ0JhY2tzcGFjZScgJiYgZS5jdHJsS2V5KSkgew0KICAgICAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpIHsNCiAgICAgICAgICAgIGRlbGV0ZVNlbGVjdGVkTm9kZSgpOw0KICAgICAgICB9DQogICAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHsNCiAgICAgICAgLy8gRGVzZWxlY3Qgbm9kZQ0KICAgICAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpIHsNCiAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpOw0KICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPSBudWxsOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUtY29uZmlnJykuaW5uZXJIVE1MID0gJzxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5TZWxlY3QgYSBub2RlIHRvIGNvbmZpZ3VyZSBpdDwvcD4nOw0KICAgICAgICB9DQogICAgfSBlbHNlIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkgPT09ICdzJyAmJiAhZS5zaGlmdEtleSkgew0KICAgICAgICAvLyBDdHJsL0NtZCArIFM6IFNhdmUNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICB3aW5kb3cuZmlsZU1hbmFnZXIuc2F2ZUZsb3coKTsNCiAgICB9IGVsc2UgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLnNoaWZ0S2V5ICYmIGUua2V5ID09PSAnUycpIHsNCiAgICAgICAgLy8gQ3RybC9DbWQgKyBTaGlmdCArIFM6IFNhdmUgQXMNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICB3aW5kb3cuZmlsZU1hbmFnZXIuc2F2ZUZsb3dBcygpOw0KICAgIH0gZWxzZSBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5ID09PSAnbycpIHsNCiAgICAgICAgLy8gQ3RybC9DbWQgKyBPOiBMb2FkDQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgd2luZG93LmZpbGVNYW5hZ2VyLmxvYWRGbG93KCk7DQogICAgfSBlbHNlIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkgPT09ICc9Jykgew0KICAgICAgICAvLyBDdHJsL0NtZCArID06IFpvb20gSW4NCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICB3aW5kb3cuY2FudmFzTWFuYWdlci56b29tSW4oKTsNCiAgICB9IGVsc2UgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJy0nKSB7DQogICAgICAgIC8vIEN0cmwvQ21kICsgLTogWm9vbSBPdXQNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICB3aW5kb3cuY2FudmFzTWFuYWdlci56b29tT3V0KCk7DQogICAgfSBlbHNlIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkgPT09ICcwJykgew0KICAgICAgICAvLyBDdHJsL0NtZCArIDA6IFJlc2V0IHpvb20gYW5kIHBhbg0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnJlc2V0Q2FudmFzUGFuKCk7DQogICAgfSBlbHNlIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgKGUuc2hpZnRLZXkpICYmIGUua2V5ID09PSAnRicpIHsNCiAgICAgICAgLy8gQ3RybC9DbWQgKyBTaGlmdCArIEY6IFpvb20gdG8gZml0DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgd2luZG93LmNhbnZhc01hbmFnZXIuem9vbVRvRml0KCk7DQogICAgfQ0KfQ0KDQovLyBIYW5kbGUgcG9ydCBtb3VzZSBldmVudHMgZm9yIGNvbm5lY3Rpb25zDQpmdW5jdGlvbiBoYW5kbGVQb3J0TW91c2VEb3duKGUsIG5vZGVJZCwgcG9ydE5hbWUsIGlzT3V0cHV0KSB7DQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgDQogICAgaWYgKGlzT3V0cHV0KSB7DQogICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20gPSB7IG5vZGVJZCwgcG9ydE5hbWUgfTsNCiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmFkZCgnY29ubmVjdGluZycpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIGlmIChmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tKSB7DQogICAgICAgICAgICBjcmVhdGVDb25uZWN0aW9uKGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20ubm9kZUlkLCBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tLnBvcnROYW1lLCBub2RlSWQsIHBvcnROYW1lKTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20gPSBudWxsOw0KICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZsb3ctbm9kZS1wb3J0JykuZm9yRWFjaChwb3J0ID0+IHBvcnQuY2xhc3NMaXN0LnJlbW92ZSgnY29ubmVjdGluZycpKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gQ3JlYXRlIGEgY29ubmVjdGlvbiBiZXR3ZWVuIG5vZGVzDQpmdW5jdGlvbiBjcmVhdGVDb25uZWN0aW9uKGZyb21Ob2RlSWQsIGZyb21Qb3J0LCB0b05vZGVJZCwgdG9Qb3J0KSB7DQogICAgLy8gQ2hlY2sgaWYgY29ubmVjdGlvbiBhbHJlYWR5IGV4aXN0cw0KICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgIGlmIChjb25uZWN0aW9uLmZyb20ubm9kZUlkID09PSBmcm9tTm9kZUlkICYmIA0KICAgICAgICAgICAgY29ubmVjdGlvbi5mcm9tLnBvcnROYW1lID09PSBmcm9tUG9ydCAmJg0KICAgICAgICAgICAgY29ubmVjdGlvbi50by5ub2RlSWQgPT09IHRvTm9kZUlkICYmIA0KICAgICAgICAgICAgY29ubmVjdGlvbi50by5wb3J0TmFtZSA9PT0gdG9Qb3J0KSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgY29uc3QgY29ubmVjdGlvbklkID0gYGNvbm5fJHtmcm9tTm9kZUlkfV8ke2Zyb21Qb3J0fV8ke3RvTm9kZUlkfV8ke3RvUG9ydH1gOw0KICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB7DQogICAgICAgIGlkOiBjb25uZWN0aW9uSWQsDQogICAgICAgIGZyb206IHsgbm9kZUlkOiBmcm9tTm9kZUlkLCBwb3J0TmFtZTogZnJvbVBvcnQgfSwNCiAgICAgICAgdG86IHsgbm9kZUlkOiB0b05vZGVJZCwgcG9ydE5hbWU6IHRvUG9ydCB9DQogICAgfTsNCiAgICANCiAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnNldChjb25uZWN0aW9uSWQsIGNvbm5lY3Rpb24pOw0KICAgIGRyYXdDb25uZWN0aW9uKGNvbm5lY3Rpb24pOw0KICAgIA0KfQ0KDQovLyBEcmF3IGEgY29ubmVjdGlvbiBvbiB0aGUgY2FudmFzDQpmdW5jdGlvbiBkcmF3Q29ubmVjdGlvbihjb25uZWN0aW9uKSB7DQogICAgY29uc3QgZnJvbU5vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0aW9uLmZyb20ubm9kZUlkKTsNCiAgICBjb25zdCB0b05vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25uZWN0aW9uLnRvLm5vZGVJZCk7DQogICAgDQogICAgaWYgKCFmcm9tTm9kZSB8fCAhdG9Ob2RlKSByZXR1cm47DQogICAgDQogICAgLy8gQ3JlYXRlIFNWRyBlbGVtZW50IGZvciB0aGUgY29ubmVjdGlvbg0KICAgIGNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7DQogICAgc3ZnLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsNCiAgICBzdmcuc3R5bGUudG9wID0gJzAnOw0KICAgIHN2Zy5zdHlsZS5sZWZ0ID0gJzAnOw0KICAgIHN2Zy5zdHlsZS53aWR0aCA9ICcxMDAlJzsNCiAgICBzdmcuc3R5bGUuaGVpZ2h0ID0gJzEwMCUnOw0KICAgIHN2Zy5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnOyAvLyBEb24ndCBjYXB0dXJlIGV2ZW50cyBieSBkZWZhdWx0DQogICAgc3ZnLnN0eWxlLnpJbmRleCA9ICcxJzsNCiAgICBzdmcuZGF0YXNldC5jb25uZWN0aW9uSWQgPSBjb25uZWN0aW9uLmlkOw0KICAgIA0KICAgIGNvbnN0IHBhdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BhdGgnKTsNCiAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJyM0Q0FGNTAnKTsNCiAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzInKTsNCiAgICBwYXRoLnNldEF0dHJpYnV0ZSgnZmlsbCcsICdub25lJyk7DQogICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ21hcmtlci1lbmQnLCAndXJsKCNhcnJvd2hlYWQpJyk7DQogICAgcGF0aC5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7DQogICAgcGF0aC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ2F1dG8nOyAvLyBPbmx5IHRoZSBwYXRoIGNhcHR1cmVzIGV2ZW50cw0KICAgIA0KICAgIC8vIEFkZCBob3ZlciBlZmZlY3RzDQogICAgcGF0aC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4gew0KICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzQnKTsNCiAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICcjZmY2YjZiJyk7DQogICAgICAgIC8vIFNob3cgZGVsZXRlIHRvb2x0aXANCiAgICAgICAgc2hvd0Nvbm5lY3Rpb25Ub29sdGlwKGNvbm5lY3Rpb24uaWQsICdDbGljayB0byBkZWxldGUgY29ubmVjdGlvbicpOw0KICAgIH0pOw0KICAgIA0KICAgIHBhdGguYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHsNCiAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7DQogICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCdzdHJva2UnLCAnIzRDQUY1MCcpOw0KICAgICAgICBoaWRlQ29ubmVjdGlvblRvb2x0aXAoKTsNCiAgICB9KTsNCiAgICANCiAgICAvLyBBZGQgY2xpY2sgdG8gZGVsZXRlDQogICAgcGF0aC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgIGNvbnN0IGNvbmZpcm1lZCA9IGF3YWl0IHN5cG5leEFQSS5zaG93Q29uZmlybWF0aW9uKA0KICAgICAgICAgICAgJ0RlbGV0ZSBDb25uZWN0aW9uJywNCiAgICAgICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgY29ubmVjdGlvbj8nLA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHR5cGU6ICdkYW5nZXInLA0KICAgICAgICAgICAgICAgIGNvbmZpcm1UZXh0OiAnRGVsZXRlJywNCiAgICAgICAgICAgICAgICBjYW5jZWxUZXh0OiAnQ2FuY2VsJywNCiAgICAgICAgICAgICAgICBpY29uOiAnZmFzIGZhLWxpbmsnDQogICAgICAgICAgICB9DQogICAgICAgICk7DQogICAgICAgIA0KICAgICAgICBpZiAoY29uZmlybWVkKSB7DQogICAgICAgICAgICBkZWxldGVDb25uZWN0aW9uKGNvbm5lY3Rpb24uaWQpOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgc3ZnLmFwcGVuZENoaWxkKHBhdGgpOw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFwcGVuZENoaWxkKHN2Zyk7DQogICAgDQogICAgLy8gU3RvcmUgU1ZHIHJlZmVyZW5jZQ0KICAgIGNvbm5lY3Rpb24uc3ZnID0gc3ZnOw0KICAgIA0KICAgIC8vIFVwZGF0ZSBjb25uZWN0aW9uIHBvc2l0aW9uDQogICAgdXBkYXRlQ29ubmVjdGlvbihjb25uZWN0aW9uKTsNCn0NCg0KLy8gU2hvdyBjb25uZWN0aW9uIHRvb2x0aXANCmZ1bmN0aW9uIHNob3dDb25uZWN0aW9uVG9vbHRpcChjb25uZWN0aW9uSWQsIG1lc3NhZ2UpIHsNCiAgICAvLyBDaGVjayBpZiBhcHAgaXMgc3RpbGwgYWN0aXZlDQogICAgaWYgKCFmbG93RWRpdG9yLmlzQWN0aXZlKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gUmVtb3ZlIGV4aXN0aW5nIHRvb2x0aXANCiAgICBoaWRlQ29ubmVjdGlvblRvb2x0aXAoKTsNCiAgICANCiAgICBjb25zdCB0b29sdGlwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgdG9vbHRpcC5jbGFzc05hbWUgPSAnY29ubmVjdGlvbi10b29sdGlwJzsNCiAgICB0b29sdGlwLnRleHRDb250ZW50ID0gbWVzc2FnZTsNCiAgICB0b29sdGlwLnN0eWxlLmNzc1RleHQgPSBgDQogICAgICAgIHBvc2l0aW9uOiBmaXhlZDsNCiAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjgpOw0KICAgICAgICBjb2xvcjogd2hpdGU7DQogICAgICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsNCiAgICAgICAgei1pbmRleDogMTAwMDA7DQogICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7DQogICAgICAgIGRpc3BsYXk6IG5vbmU7DQogICAgYDsNCiAgICANCiAgICB0b29sdGlwLmlkID0gJ2Nvbm5lY3Rpb24tdG9vbHRpcCc7DQogICAgDQogICAgLy8gVHJ5IHRvIGFwcGVuZCB0byBhcHAgY29udGFpbmVyIGZpcnN0LCBmYWxsYmFjayB0byBib2R5DQogICAgY29uc3QgYXBwQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFwcC1jb250YWluZXInKTsNCiAgICBjb25zdCBjb250YWluZXIgPSBhcHBDb250YWluZXIgfHwgZG9jdW1lbnQuYm9keTsNCiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodG9vbHRpcCk7DQogICAgDQogICAgLy8gUG9zaXRpb24gdG9vbHRpcCBuZWFyIG1vdXNlICh3aWxsIGJlIHVwZGF0ZWQgb24gbW91c2Vtb3ZlKQ0KICAgIGNvbnN0IHRvb2x0aXBNb3VzZU1vdmVIYW5kbGVyID0gKGUpID0+IHVwZGF0ZVRvb2x0aXBQb3NpdGlvbihlKTsNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0b29sdGlwTW91c2VNb3ZlSGFuZGxlcik7DQogICAgDQogICAgLy8gU3RvcmUgdGhlIGhhbmRsZXIgcmVmZXJlbmNlIGZvciBjbGVhbnVwDQogICAgd2luZG93LmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlciA9IHRvb2x0aXBNb3VzZU1vdmVIYW5kbGVyOw0KICAgIA0KICAgIC8vIFNob3cgdGhlIHRvb2x0aXAgYWZ0ZXIgYSBzbWFsbCBkZWxheSB0byBwcmV2ZW50IGZsaWNrZXJpbmcNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgaWYgKHRvb2x0aXAucGFyZW50Tm9kZSAmJiBmbG93RWRpdG9yLmlzQWN0aXZlKSB7DQogICAgICAgICAgICB0b29sdGlwLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICB9DQogICAgfSwgMTApOw0KfQ0KDQovLyBVcGRhdGUgdG9vbHRpcCBwb3NpdGlvbg0KZnVuY3Rpb24gdXBkYXRlVG9vbHRpcFBvc2l0aW9uKGUpIHsNCiAgICBjb25zdCB0b29sdGlwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nvbm5lY3Rpb24tdG9vbHRpcCcpOw0KICAgIGlmICh0b29sdGlwKSB7DQogICAgICAgIC8vIFVzZSBzY2FsZWQgY29vcmRpbmF0ZXMgZm9yIHRvb2x0aXAgcG9zaXRpb25pbmcNCiAgICAgICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDogDQogICAgICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgICAgIHRvb2x0aXAuc3R5bGUubGVmdCA9IChtb3VzZUNvb3Jkcy54ICsgMTApICsgJ3B4JzsNCiAgICAgICAgdG9vbHRpcC5zdHlsZS50b3AgPSAobW91c2VDb29yZHMueSAtIDEwKSArICdweCc7DQogICAgfQ0KfQ0KDQovLyBIaWRlIGNvbm5lY3Rpb24gdG9vbHRpcA0KZnVuY3Rpb24gaGlkZUNvbm5lY3Rpb25Ub29sdGlwKCkgew0KICAgIGNvbnN0IHRvb2x0aXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29ubmVjdGlvbi10b29sdGlwJyk7DQogICAgaWYgKHRvb2x0aXApIHsNCiAgICAgICAgLy8gUmVtb3ZlIHRoZSBzcGVjaWZpYyBldmVudCBsaXN0ZW5lciB3ZSBhZGRlZA0KICAgICAgICBpZiAod2luZG93LmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlcikgew0KICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgd2luZG93LmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlcik7DQogICAgICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyID0gbnVsbDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gSGlkZSBhbmQgcmVtb3ZlIHRoZSB0b29sdGlwDQogICAgICAgIHRvb2x0aXAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgaWYgKHRvb2x0aXAucGFyZW50Tm9kZSkgew0KICAgICAgICAgICAgdG9vbHRpcC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRvb2x0aXApOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBDbGVhciB0aGUgY2FudmFzDQphc3luYyBmdW5jdGlvbiBjbGVhckNhbnZhcygpIHsNCiAgICBjb25zdCBjb25maXJtZWQgPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0NvbmZpcm1hdGlvbigNCiAgICAgICAgJ0NsZWFyIENhbnZhcycsDQogICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gY2xlYXIgdGhlIGNhbnZhcz8gVGhpcyB3aWxsIGRlbGV0ZSBhbGwgbm9kZXMgYW5kIGNvbm5lY3Rpb25zLicsDQogICAgICAgIHsNCiAgICAgICAgICAgIHR5cGU6ICdkYW5nZXInLA0KICAgICAgICAgICAgY29uZmlybVRleHQ6ICdDbGVhciBBbGwnLA0KICAgICAgICAgICAgY2FuY2VsVGV4dDogJ0NhbmNlbCcsDQogICAgICAgICAgICBpY29uOiAnZmFzIGZhLXRyYXNoLWFsdCcNCiAgICAgICAgfQ0KICAgICk7DQogICAgDQogICAgaWYgKGNvbmZpcm1lZCkgew0KICAgICAgICBjbGVhckNhbnZhc1NpbGVudCgpOw0KICAgIH0NCn0NCg0KLy8gQ2xlYXIgdGhlIGNhbnZhcyB3aXRob3V0IGNvbmZpcm1hdGlvbiAodXNlZCBpbnRlcm5hbGx5KQ0KZnVuY3Rpb24gY2xlYXJDYW52YXNTaWxlbnQoKSB7DQogICAgLy8gSGlkZSBhbnkgYWN0aXZlIHRvb2x0aXBzDQogICAgaGlkZUNvbm5lY3Rpb25Ub29sdGlwKCk7DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciBhbGwgY29ubmVjdGlvbnMNCiAgICAgICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLnN2Zykgew0KICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24uc3ZnLnJlbW92ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuY2xlYXIoKTsNCiAgICAgICAgDQogICAgICAgIC8vIENsZWFyIGFsbCBub2Rlcw0KICAgICAgICBmb3IgKGNvbnN0IG5vZGVJZCBvZiBmbG93RWRpdG9yLm5vZGVzLmtleXMoKSkgew0KICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQucmVtb3ZlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZmxvd0VkaXRvci5ub2Rlcy5jbGVhcigpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgYWxsIHRhZ3MNCiAgICAgICAgZm9yIChjb25zdCB0YWdJZCBvZiBmbG93RWRpdG9yLnRhZ3Mua2V5cygpKSB7DQogICAgICAgICAgICBjb25zdCB0YWdFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFnSWQpOw0KICAgICAgICAgICAgaWYgKHRhZ0VsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICB0YWdFbGVtZW50LnJlbW92ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGZsb3dFZGl0b3IudGFncy5jbGVhcigpOw0KICAgICAgICANCiAgICAgICAgLy8gVXBkYXRlIHRhZyBwYW5lbCB0byByZWZsZWN0IGNsZWFyZWQgdGFncw0KICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy50YWdNYW5hZ2VyLnVwZGF0ZVRhZ1BhbmVsID09PSAnZnVuY3Rpb24nKSB7DQogICAgICAgICAgICB3aW5kb3cudGFnTWFuYWdlci51cGRhdGVUYWdQYW5lbCgpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBSZXNldCBjb3VudGVycw0KICAgICAgICBmbG93RWRpdG9yLm5vZGVDb3VudGVyID0gMDsNCiAgICAgICAgZmxvd0VkaXRvci50YWdDb3VudGVyID0gMDsNCiAgICAgICAgZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPSBudWxsOw0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgY3VycmVudCBmaWxlIHBhdGgNCiAgICAgICAgZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGggPSBudWxsOw0KICAgICAgICANCiAgICAgICAgLy8gUmVzZXQgcGFuIG9mZnNldCB0byBjZW50ZXIgb2YgbGFyZ2UgY2FudmFzDQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0ID0geyB4OiAtNTAwMCwgeTogLTUwMDAgfTsNCiAgICAgICAgDQogICAgICAgIC8vIFJlc2V0IHpvb20gbGV2ZWwNCiAgICAgICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSAxLjA7DQogICAgICAgIA0KICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgd2luZG93LmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFVwZGF0ZSBmaWxlbmFtZSBkaXNwbGF5DQogICAgICAgIGlmICh0eXBlb2Ygd2luZG93LmZpbGVNYW5hZ2VyLnVwZGF0ZUZpbGVuYW1lRGlzcGxheSA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgd2luZG93LmZpbGVNYW5hZ2VyLnVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciBjb25maWcgcGFuZWwNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUtY29uZmlnJykuaW5uZXJIVE1MID0gJzxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5TZWxlY3QgYSBub2RlIHRvIGNvbmZpZ3VyZSBpdDwvcD4nOw0KfSANCg0KDQovLyBTaG93IG5vZGUgY29uZmlndXJhdGlvbg0KZnVuY3Rpb24gc2hvd05vZGVDb25maWcobm9kZUlkKSB7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlKSByZXR1cm47DQogICAgDQogICAgY29uc3Qgbm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShub2RlLnR5cGUpOw0KICAgIGlmICghbm9kZURlZikgcmV0dXJuOw0KICAgIA0KICAgIC8vIFNob3cgY29uZmlnIHBhbmVsIHdpdGggbm9kZSBjb25maWd1cmF0aW9uDQogICAgY29uc3QgY29uZmlnUGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZS1jb25maWcnKTsNCiAgICBpZiAoY29uZmlnUGFuZWwpIHsNCiAgICAgICAgbGV0IGNvbmZpZ0h0bWwgPSBgPGg0PiR7bm9kZURlZi5uYW1lfSBDb25maWd1cmF0aW9uPC9oND5gOw0KICAgICAgICANCiAgICAgICAgLy8gQWRkIHNwZWNpYWwgY29udGVudCBkaXNwbGF5IGZvciBkaWZmZXJlbnQgbm9kZSB0eXBlcw0KICAgICAgICBpZiAobm9kZS50eXBlID09PSAnZGlzcGxheScgJiYgbm9kZS5sYXN0Q29udGVudCkgew0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkxhc3QgQ29udGVudDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQtZGlzcGxheSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8cHJlIGNsYXNzPSJjb250ZW50LXRleHQiPiR7ZXNjYXBlSHRtbChub2RlLmxhc3RDb250ZW50KX08L3ByZT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQtaW5mbyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPkZvcm1hdDogJHtub2RlLmxhc3RGb3JtYXR9IOKAoiBMZW5ndGg6ICR7bm9kZS5sYXN0Q29udGVudC5sZW5ndGh9IGNoYXJzPC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0gZWxzZSBpZiAobm9kZS50eXBlID09PSAnaW1hZ2UnICYmIG5vZGUubGFzdEltYWdlRGF0YSkgew0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkltYWdlIFByZXZpZXc8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbWFnZS1kaXNwbGF5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSIke25vZGUubGFzdEltYWdlVXJsfSIgYWx0PSJJbWFnZSBwcmV2aWV3IiBzdHlsZT0ibWF4LXdpZHRoOiAyMDBweDsgbWF4LWhlaWdodDogMTUwcHg7IGJvcmRlcjogMXB4IHNvbGlkICNjY2M7IGJvcmRlci1yYWRpdXM6IDRweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW1hZ2UtaW5mbyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPlNpemU6ICR7bm9kZS5sYXN0SW1hZ2VJbmZvPy53aWR0aCB8fCAnPyd9eCR7bm9kZS5sYXN0SW1hZ2VJbmZvPy5oZWlnaHQgfHwgJz8nfSDigKIgRm9ybWF0OiAke25vZGUubGFzdEltYWdlSW5mbz8uZm9ybWF0IHx8ICc/J308L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1wcmltYXJ5IG10LTIgdmlldy1mdWxsLWltYWdlLWJ0biIgZGF0YS1ub2RlLWlkPSIke25vZGVJZH0iPlZpZXcgRnVsbCBJbWFnZTwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0gZWxzZSBpZiAobm9kZS50eXBlID09PSAnYXVkaW8nICYmIG5vZGUubGFzdEF1ZGlvRGF0YSkgew0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkF1ZGlvIENvbnRyb2xzPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXVkaW8tZGlzcGxheSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhdWRpby1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+QXVkaW8gbG9hZGVkIHN1Y2Nlc3NmdWxseTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImF1ZGlvLWNvbnRyb2xzIG10LTIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLXN1Y2Nlc3MgcGxheS1hdWRpby1idG4iIGRhdGEtbm9kZS1pZD0iJHtub2RlSWR9Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1wbGF5Ij48L2k+IFBsYXkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1kYW5nZXIgc3RvcC1hdWRpby1idG4iIGRhdGEtbm9kZS1pZD0iJHtub2RlSWR9Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1zdG9wIj48L2k+IFN0b3ANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0gZWxzZSBpZiAobm9kZS50eXBlID09PSAndmZzX2xvYWQnKSB7DQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+VkZTIExvYWQgU3RhdHVzPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idmZzLWxvYWQtaW5mbyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+TGFzdCBsb2FkZWQ6ICR7bm9kZS5sYXN0TG9hZGVkRmlsZSB8fCAnTm9uZSd9PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9IGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ2xsbV9jaGF0JyAmJiBub2RlLmxhc3RSZXNwb25zZSkgew0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkxhc3QgUmVzcG9uc2U8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50LWRpc3BsYXkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHByZSBjbGFzcz0iY29udGVudC10ZXh0Ij4ke2VzY2FwZUh0bWwobm9kZS5sYXN0UmVzcG9uc2UpfTwvcHJlPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udGVudC1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+VG9rZW5zOiAke25vZGUubGFzdFVzYWdlPy50b3RhbF90b2tlbnMgfHwgMH0g4oCiIE1vZGVsOiAke25vZGUubGFzdE1vZGVsIHx8ICdVbmtub3duJ308L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgICAgIGNvbnN0IGlzUnVubmluZyA9IG5vZGUucmVwZWF0ZXJTdGF0ZSAmJiBub2RlLnJlcGVhdGVyU3RhdGUuaXNSdW5uaW5nOw0KICAgICAgICAgICAgY29uc3QgY291bnQgPSBub2RlLnJlcGVhdGVyU3RhdGUgPyBub2RlLnJlcGVhdGVyU3RhdGUuY291bnQgOiAwOw0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlJlcGVhdGVyIENvbnRyb2xzPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmVwZWF0ZXItZGlzcGxheSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyZXBlYXRlci1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+U3RhdHVzOiAke2lzUnVubmluZyA/ICdSdW5uaW5nJyA6ICdTdG9wcGVkJ30g4oCiIENvdW50OiAke2NvdW50fTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJlcGVhdGVyLWNvbnRyb2xzIG10LTIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLXN1Y2Nlc3Mgc3RhcnQtcmVwZWF0ZXItYnRuIiBkYXRhLW5vZGUtaWQ9IiR7bm9kZUlkfSIgJHtpc1J1bm5pbmcgPyAnZGlzYWJsZWQnIDogJyd9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXBsYXkiPjwvaT4gU3RhcnQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1kYW5nZXIgc3RvcC1yZXBlYXRlci1idG4iIGRhdGEtbm9kZS1pZD0iJHtub2RlSWR9IiAkeyFpc1J1bm5pbmcgPyAnZGlzYWJsZWQnIDogJyd9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXN0b3AiPjwvaT4gU3RvcA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gU2hvdyBpbnB1dCBtYXBwaW5ncyBjb25maWd1cmF0aW9uICh3aGF0IHRoaXMgbm9kZSByZWNlaXZlcyBmcm9tIG90aGVyIG5vZGVzKQ0KICAgICAgICBjb25zdCBpbnB1dENvbm5lY3Rpb25zID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKQ0KICAgICAgICAgICAgLmZpbHRlcihjb25uID0+IGNvbm4udG8ubm9kZUlkID09PSBub2RlSWQpOw0KICAgICAgICANCiAgICAgICAgaWYgKGlucHV0Q29ubmVjdGlvbnMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlJlY2VpdmluZyBGcm9tPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5wdXQtbWFwcGluZ3MtY29uZmlnIj4NCiAgICAgICAgICAgIGA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGZvciAoY29uc3QgY29ubiBvZiBpbnB1dENvbm5lY3Rpb25zKSB7DQogICAgICAgICAgICAgICAgY29uc3Qgc291cmNlTm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGNvbm4uZnJvbS5ub2RlSWQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZU5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUoc291cmNlTm9kZT8udHlwZSB8fCAndW5rbm93bicpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZU5vZGVOYW1lID0gc291cmNlTm9kZURlZj8ubmFtZSB8fCBzb3VyY2VOb2RlPy50eXBlIHx8ICd1bmtub3duJzsNCiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZE91dHB1dCA9IHNvdXJjZU5vZGVEZWY/Lm91dHB1dHM/LmZpbmQob3V0cHV0ID0+IG91dHB1dC5pZCA9PT0gY29ubi5mcm9tLnBvcnROYW1lKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXROYW1lID0gc2VsZWN0ZWRPdXRwdXQgPyBzZWxlY3RlZE91dHB1dC5uYW1lIDogY29ubi5mcm9tLnBvcnROYW1lOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIFNpbXBsZTogU2hvdyB3aGF0IEknbSByZWNlaXZpbmcgYW5kIGxldCBtZSBjaG9vc2UgbXkgaW5wdXQgcG9ydA0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnB1dC1tYXBwaW5nLWNvbmZpZyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25uZWN0aW9uLWhlYWRlciI+RnJvbSAke3NvdXJjZU5vZGVOYW1lfSAoJHtvdXRwdXROYW1lfSk8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbm5lY3Rpb24tY29udHJvbHMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRyb2wtcm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlRvIG15IGlucHV0OjwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9ImlucHV0X3RhcmdldF8ke25vZGVJZH18JHtjb25uLnRvLnBvcnROYW1lfSIgY2xhc3M9ImlucHV0LXRhcmdldC1zZWxlY3QiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3QuLi48L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7bm9kZURlZi5pbnB1dHMubWFwKGlucHV0ID0+IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8b3B0aW9uIHZhbHVlPSIke2lucHV0LmlkfSIgJHtjb25uLnRvLnBvcnROYW1lID09PSBpbnB1dC5pZCA/ICdzZWxlY3RlZCcgOiAnJ30+JHtpbnB1dC5uYW1lfTwvb3B0aW9uPmANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuam9pbignJyl9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFNob3cgb3V0cHV0IG1hcHBpbmdzIGNvbmZpZ3VyYXRpb24gKHdoYXQgb3RoZXIgbm9kZXMgcmVjZWl2ZSBmcm9tIHRoaXMgbm9kZSkNCiAgICAgICAgY29uc3Qgb3V0cHV0Q29ubmVjdGlvbnMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpDQogICAgICAgICAgICAuZmlsdGVyKGNvbm4gPT4gY29ubi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkKTsNCiAgICAgICAgDQogICAgICAgIGlmIChvdXRwdXRDb25uZWN0aW9ucy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+U2VuZGluZyBUbzwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im91dHB1dC1tYXBwaW5ncy1jb25maWciPg0KICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZm9yIChjb25zdCBjb25uIG9mIG91dHB1dENvbm5lY3Rpb25zKSB7DQogICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Tm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGNvbm4udG8ubm9kZUlkKTsNCiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKHRhcmdldE5vZGU/LnR5cGUgfHwgJ3Vua25vd24nKTsNCiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlTmFtZSA9IHRhcmdldE5vZGVEZWY/Lm5hbWUgfHwgdGFyZ2V0Tm9kZT8udHlwZSB8fCAndW5rbm93bic7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gR2V0IGF2YWlsYWJsZSBvdXRwdXRzIGZyb20gVEhJUyBub2RlIChzb3VyY2Ugbm9kZSkNCiAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2VOb2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgICAgICAgICAgICAgY29uc3QgYXZhaWxhYmxlT3V0cHV0cyA9IHNvdXJjZU5vZGVEZWY/Lm91dHB1dHMgfHwgW107DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im91dHB1dC1tYXBwaW5nLWNvbmZpZyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25uZWN0aW9uLWhlYWRlciI+VG8gJHt0YXJnZXROb2RlTmFtZX08L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbm5lY3Rpb24tY29udHJvbHMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRyb2wtcm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlNlbmQgb3V0cHV0OjwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9Im91dHB1dF9tYXBwaW5nXyR7bm9kZUlkfXwke2Nvbm4uZnJvbS5wb3J0TmFtZX18JHtjb25uLnRvLm5vZGVJZH0iIGNsYXNzPSJvdXRwdXQtbWFwcGluZy1zZWxlY3QiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3QuLi48L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7YXZhaWxhYmxlT3V0cHV0cy5tYXAob3V0cHV0ID0+IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8b3B0aW9uIHZhbHVlPSIke291dHB1dC5pZH0iICR7Y29ubi5mcm9tLnBvcnROYW1lID09PSBvdXRwdXQuaWQgPyAnc2VsZWN0ZWQnIDogJyd9PiR7b3V0cHV0Lm5hbWV9PC9vcHRpb24+YA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5qb2luKCcnKX0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gR2VuZXJhdGUgY29uZmlndXJhdGlvbiBmaWVsZHMNCiAgICAgICAgZm9yIChjb25zdCBba2V5LCBjb25maWddIG9mIE9iamVjdC5lbnRyaWVzKG5vZGVEZWYuY29uZmlnKSkgew0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0iY29uZmlnXyR7bm9kZUlkfV8ke2tleX0iPiR7Y29uZmlnLmxhYmVsfTwvbGFiZWw+DQogICAgICAgICAgICBgOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoY29uZmlnLnR5cGUgPT09ICdzZWxlY3QnKSB7DQogICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPHNlbGVjdCBpZD0iY29uZmlnXyR7bm9kZUlkfV8ke2tleX0iPmA7DQogICAgICAgICAgICAgICAgY29uZmlnLm9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4gew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZCA9IG5vZGUuY29uZmlnW2tleV0udmFsdWUgPT09IG9wdGlvbiA/ICdzZWxlY3RlZCcgOiAnJzsNCiAgICAgICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPG9wdGlvbiB2YWx1ZT0iJHtvcHRpb259IiAke3NlbGVjdGVkfT4ke29wdGlvbn08L29wdGlvbj5gOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDwvc2VsZWN0PmA7DQogICAgICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy50eXBlID09PSAndGV4dGFyZWEnKSB7DQogICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPHRleHRhcmVhIGlkPSJjb25maWdfJHtub2RlSWR9XyR7a2V5fSI+JHtub2RlLmNvbmZpZ1trZXldLnZhbHVlfTwvdGV4dGFyZWE+YDsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnR5cGUgPT09ICdudW1iZXInKSB7DQogICAgICAgICAgICAgICAgY29uc3QgbWluID0gY29uZmlnLm1pbiA/IGAgbWluPSIke2NvbmZpZy5taW59ImAgOiAnJzsNCiAgICAgICAgICAgICAgICBjb25zdCBtYXggPSBjb25maWcubWF4ID8gYCBtYXg9IiR7Y29uZmlnLm1heH0iYCA6ICcnOw0KICAgICAgICAgICAgICAgIGNvbnN0IHN0ZXAgPSBjb25maWcuc3RlcCA/IGAgc3RlcD0iJHtjb25maWcuc3RlcH0iYCA6ICcnOw0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDxpbnB1dCB0eXBlPSJudW1iZXIiIGlkPSJjb25maWdfJHtub2RlSWR9XyR7a2V5fSIgdmFsdWU9IiR7bm9kZS5jb25maWdba2V5XS52YWx1ZX0iJHttaW59JHttYXh9JHtzdGVwfT5gOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8aW5wdXQgdHlwZT0iJHtjb25maWcudHlwZX0iIGlkPSJjb25maWdfJHtub2RlSWR9XyR7a2V5fSIgdmFsdWU9IiR7bm9kZS5jb25maWdba2V5XS52YWx1ZX0iPmA7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDwvZGl2PmA7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFNob3cgb3V0cHV0IGRhdGEgZm9yIGFsbCBwb3J0cyAoaWYgbm9kZSBoYXMgYmVlbiBleGVjdXRlZCkgLSBhdCB0aGUgYm90dG9tDQogICAgICAgIGlmIChub2RlLmxhc3RPdXRwdXREYXRhICYmIG5vZGUubGFzdEV4ZWN1dGlvblRpbWUpIHsNCiAgICAgICAgICAgIGNvbnN0IG5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICAgICAgICAgIGNvbnN0IG91dHB1dHMgPSBub2RlRGVmLm91dHB1dHMgfHwgW107DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChvdXRwdXRzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uZmlnLWdyb3VwIiBzdHlsZT0ibWFyZ2luLXRvcDogMjBweDsgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7IHBhZGRpbmctdG9wOiAxNXB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+T3V0cHV0IFBvcnQgRGF0YTwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDEycHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgbWFyZ2luLWJvdHRvbTogOHB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgTGFzdCBleGVjdXRlZDogJHtuZXcgRGF0ZShub2RlLmxhc3RFeGVjdXRpb25UaW1lKS50b0xvY2FsZVN0cmluZygpfQ0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgYDsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG91dHB1dCBvZiBvdXRwdXRzKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dERhdGEgPSBnZXRPdXRwdXRQb3J0RGF0YShub2RlLmlkLCBvdXRwdXQuaWQpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBmb3JtYXREYXRhUHJldmlldyhvdXRwdXREYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udGVudC1kaXNwbGF5IiBzdHlsZT0ibWFyZ2luLWJvdHRvbTogOHB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC13ZWlnaHQ6IDUwMDsgbWFyZ2luLWJvdHRvbTogNnB4OyBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7IGZvbnQtc2l6ZTogMTNweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke291dHB1dC5uYW1lfSA8c3BhbiBzdHlsZT0iY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBmb250LXdlaWdodDogbm9ybWFsOyBmb250LXNpemU6IDExcHg7Ij4oJHtmb3JtYXR0ZWQudHlwZX0pPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwcmUgY2xhc3M9ImNvbnRlbnQtdGV4dCIgc3R5bGU9Im1hcmdpbi1ib3R0b206IDRweDsgbWF4LWhlaWdodDogODBweDsiPiR7ZXNjYXBlSHRtbChmb3JtYXR0ZWQucHJldmlldyl9PC9wcmU+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtmb3JtYXR0ZWQubGVuZ3RoICE9PSB1bmRlZmluZWQgPyBgPGRpdiBzdHlsZT0iZm9udC1zaXplOiAxMXB4OyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7Ij5MZW5ndGg6ICR7Zm9ybWF0dGVkLmxlbmd0aH08L2Rpdj5gIDogJyd9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtmb3JtYXR0ZWQua2V5cyAhPT0gdW5kZWZpbmVkID8gYDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMTFweDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyI+S2V5czogJHtmb3JtYXR0ZWQua2V5c308L2Rpdj5gIDogJyd9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtmb3JtYXR0ZWQuc2l6ZSAhPT0gdW5kZWZpbmVkID8gYDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMTFweDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyI+U2l6ZTogJHsoZm9ybWF0dGVkLnNpemUgLyAxMDI0KS50b0ZpeGVkKDIpfSBLQjwvZGl2PmAgOiAnJ30NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2Zvcm1hdHRlZC5lc3RpbWF0ZWRTaXplICE9PSB1bmRlZmluZWQgPyBgPGRpdiBzdHlsZT0iZm9udC1zaXplOiAxMXB4OyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7Ij5Fc3QuIFNpemU6ICR7KGZvcm1hdHRlZC5lc3RpbWF0ZWRTaXplIC8gMTAyNCkudG9GaXhlZCgyKX0gS0I8L2Rpdj5gIDogJyd9DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgYDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbmZpZ1BhbmVsLmlubmVySFRNTCA9IGNvbmZpZ0h0bWw7DQogICAgICAgIA0KICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzIGZvciBtYXBwaW5nIHNlbGVjdHMNCiAgICAgICAgLy8gTm8gaW5wdXQgbWFwcGluZyBzZWxlY3RzIGFueW1vcmUgLSBub2RlcyBjYW4ndCBjb250cm9sIHdoYXQgdGhleSByZWNlaXZlDQogICAgICAgIA0KICAgICAgICBjb25zdCBpbnB1dFRhcmdldFNlbGVjdHMgPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5wdXQtdGFyZ2V0LXNlbGVjdCcpOw0KICAgICAgICBpbnB1dFRhcmdldFNlbGVjdHMuZm9yRWFjaChzZWxlY3QgPT4gew0KICAgICAgICAgICAgc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3QgW25vZGVJZCwgY3VycmVudElucHV0UG9ydF0gPSBlLnRhcmdldC5pZC5yZXBsYWNlKCdpbnB1dF90YXJnZXRfJywgJycpLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRJbnB1dFBvcnQgPSBlLnRhcmdldC52YWx1ZTsNCiAgICAgICAgICAgICAgICAvLyBGaW5kIHRoZSBjb25uZWN0aW9uDQogICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkuZmluZChjb25uID0+DQogICAgICAgICAgICAgICAgICAgIGNvbm4udG8ubm9kZUlkID09PSBub2RlSWQgJiYgY29ubi50by5wb3J0TmFtZSA9PT0gY3VycmVudElucHV0UG9ydA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24gJiYgc2VsZWN0ZWRJbnB1dFBvcnQpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGFsbCBjb25uZWN0aW9ucyBmcm9tIHRoZSBzYW1lIGZyb21Ob2RlIHRvIHRoaXMgbm9kZSAocmVnYXJkbGVzcyBvZiBwb3J0KQ0KICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uc1RvUmVtb3ZlID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5maWx0ZXIoY29ubiA9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgY29ubi5mcm9tLm5vZGVJZCA9PT0gY29ubmVjdGlvbi5mcm9tLm5vZGVJZCAmJiBjb25uLnRvLm5vZGVJZCA9PT0gbm9kZUlkDQogICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25zVG9SZW1vdmUuZm9yRWFjaChjb25uID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuZGVsZXRlKGNvbm4uaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm4uc3ZnKSBjb25uLnN2Zy5yZW1vdmUoKTsNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgbmV3IGNvbm5lY3Rpb24NCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Q29ubmVjdGlvbklkID0gYGNvbm5fJHtjb25uZWN0aW9uLmZyb20ubm9kZUlkfV8ke2Nvbm5lY3Rpb24uZnJvbS5wb3J0TmFtZX1fJHtub2RlSWR9XyR7c2VsZWN0ZWRJbnB1dFBvcnR9YDsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Q29ubmVjdGlvbiA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBuZXdDb25uZWN0aW9uSWQsDQogICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiB7IG5vZGVJZDogY29ubmVjdGlvbi5mcm9tLm5vZGVJZCwgcG9ydE5hbWU6IGNvbm5lY3Rpb24uZnJvbS5wb3J0TmFtZSB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgdG86IHsgbm9kZUlkOiBub2RlSWQsIHBvcnROYW1lOiBzZWxlY3RlZElucHV0UG9ydCB9DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuc2V0KG5ld0Nvbm5lY3Rpb25JZCwgbmV3Q29ubmVjdGlvbik7DQogICAgICAgICAgICAgICAgICAgIGRyYXdDb25uZWN0aW9uKG5ld0Nvbm5lY3Rpb24pOw0KICAgICAgICAgICAgICAgICAgICAvLyBBdXRvLXNhdmUNCiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5zYXZlRmxvdykgd2luZG93LnNhdmVGbG93KCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgY29uc3Qgb3V0cHV0TWFwcGluZ1NlbGVjdHMgPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcub3V0cHV0LW1hcHBpbmctc2VsZWN0Jyk7DQogICAgICAgIG91dHB1dE1hcHBpbmdTZWxlY3RzLmZvckVhY2goc2VsZWN0ID0+IHsNCiAgICAgICAgICAgIHNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gZS50YXJnZXQuaWQucmVwbGFjZSgnb3V0cHV0X21hcHBpbmdfJywgJycpLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gcGFydHNbMF07DQogICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0UG9ydCA9IHBhcnRzWzFdOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGVJZCA9IHBhcnRzWzJdOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkT3V0cHV0UG9ydCA9IGUudGFyZ2V0LnZhbHVlOw0KICAgICAgICAgICAgICAgIHVwZGF0ZU91dHB1dE1hcHBpbmcobm9kZUlkLCBvdXRwdXRQb3J0LCB0YXJnZXROb2RlSWQsIHNlbGVjdGVkT3V0cHV0UG9ydCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzIGZvciBzcGVjaWFsIGJ1dHRvbnMNCiAgICAgICAgY29uc3Qgdmlld0Z1bGxJbWFnZUJ0biA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3IoJy52aWV3LWZ1bGwtaW1hZ2UtYnRuJyk7DQogICAgICAgIGlmICh2aWV3RnVsbEltYWdlQnRuKSB7DQogICAgICAgICAgICB2aWV3RnVsbEltYWdlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS1pZCcpOw0KICAgICAgICAgICAgICAgIHNob3dGdWxsSW1hZ2Uobm9kZUlkKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25zdCBwbGF5QXVkaW9CdG4gPSBjb25maWdQYW5lbC5xdWVyeVNlbGVjdG9yKCcucGxheS1hdWRpby1idG4nKTsNCiAgICAgICAgaWYgKHBsYXlBdWRpb0J0bikgew0KICAgICAgICAgICAgcGxheUF1ZGlvQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS1pZCcpOw0KICAgICAgICAgICAgICAgIHBsYXlBdWRpbyhub2RlSWQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHN0b3BBdWRpb0J0biA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3IoJy5zdG9wLWF1ZGlvLWJ0bicpOw0KICAgICAgICBpZiAoc3RvcEF1ZGlvQnRuKSB7DQogICAgICAgICAgICBzdG9wQXVkaW9CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1ub2RlLWlkJyk7DQogICAgICAgICAgICAgICAgc3RvcEF1ZGlvKG5vZGVJZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgY29uc3Qgc3RhcnRSZXBlYXRlckJ0biA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3IoJy5zdGFydC1yZXBlYXRlci1idG4nKTsNCiAgICAgICAgaWYgKHN0YXJ0UmVwZWF0ZXJCdG4pIHsNCiAgICAgICAgICAgIHN0YXJ0UmVwZWF0ZXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1ub2RlLWlkJyk7DQogICAgICAgICAgICAgICAgc3RhcnRSZXBlYXRlcihub2RlSWQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHN0b3BSZXBlYXRlckJ0biA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3IoJy5zdG9wLXJlcGVhdGVyLWJ0bicpOw0KICAgICAgICBpZiAoc3RvcFJlcGVhdGVyQnRuKSB7DQogICAgICAgICAgICBzdG9wUmVwZWF0ZXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1ub2RlLWlkJyk7DQogICAgICAgICAgICAgICAgc3RvcFJlcGVhdGVyKG5vZGVJZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQWRkIGNoYW5nZSBsaXN0ZW5lcnMNCiAgICAgICAgZm9yIChjb25zdCBba2V5LCBjb25maWddIG9mIE9iamVjdC5lbnRyaWVzKG5vZGVEZWYuY29uZmlnKSkgew0KICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjb25maWdfJHtub2RlSWR9XyR7a2V5fWApOw0KICAgICAgICAgICAgaWYgKGVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIG5vZGUuY29uZmlnW2tleV0udmFsdWUgPSBlLnRhcmdldC52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIFNwZWNpYWwgaGFuZGxpbmcgZm9yIGRpc3BsYXkgbm9kZSBmb3JtYXQgY2hhbmdlcw0KICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnZGlzcGxheScgJiYga2V5ID09PSAnZm9ybWF0Jykgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBkaXNwbGF5LWZvcm1hdC0ke25vZGVJZH1gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYXRFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0RWxlbWVudC50ZXh0Q29udGVudCA9IGUudGFyZ2V0LnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIG5vZGUtcmVuZGVyZXIuanMgLSBEeW5hbWljIG5vZGUgcmVuZGVyaW5nIGZvciBGbG93IEVkaXRvcg0KDQpjbGFzcyBOb2RlUmVuZGVyZXIgew0KICAgIGNvbnN0cnVjdG9yKCkgew0KICAgICAgICB0aGlzLnRlbXBsYXRlcyA9IG5ldyBNYXAoKTsNCiAgICAgICAgdGhpcy5zZXR1cFN0YW5kYXJkVGVtcGxhdGUoKTsNCiAgICB9DQogICAgDQogICAgc2V0dXBTdGFuZGFyZFRlbXBsYXRlKCkgew0KICAgICAgICB0aGlzLnRlbXBsYXRlcy5zZXQoJ3N0YW5kYXJkJywgew0KICAgICAgICAgICAgcmVuZGVyOiAobm9kZSwgbm9kZURlZikgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0cyA9IG5vZGVEZWYuaW5wdXRzIHx8IFtdOw0KICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dHMgPSBub2RlRGVmLm91dHB1dHMgfHwgW107DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgcmV0dXJuIGANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmxvdy1ub2RlLWhlYWRlciI+DQogICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iJHtub2RlRGVmLmljb259Ij48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj4ke25vZGVEZWYubmFtZX08L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iZmxvdy1ub2RlLXR5cGUgJHtub2RlLnR5cGV9Ij4ke25vZGUudHlwZS50b1VwcGVyQ2FzZSgpfTwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Im5vZGUtZGVsZXRlLWJ0biIgdGl0bGU9IkRlbGV0ZSBub2RlIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRpbWVzIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsb3ctbm9kZS1jb250ZW50Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5vZGUtZGVmYXVsdC1jb250ZW50Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGwgY2xhc3M9InRleHQtbXV0ZWQiPiR7bm9kZURlZi5kZXNjcmlwdGlvbn08L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LW5vZGUtcG9ydHMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgJHtpbnB1dHMubWFwKGlucHV0ID0+IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8ZGl2IGNsYXNzPSJmbG93LW5vZGUtcG9ydCBpbnB1dCIgZGF0YS1wb3J0PSIke2lucHV0LmlkfSI+PC9kaXY+YA0KICAgICAgICAgICAgICAgICAgICAgICAgKS5qb2luKCcnKX0NCiAgICAgICAgICAgICAgICAgICAgICAgICR7b3V0cHV0cy5tYXAob3V0cHV0ID0+IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8ZGl2IGNsYXNzPSJmbG93LW5vZGUtcG9ydCBvdXRwdXQiIGRhdGEtcG9ydD0iJHtvdXRwdXQuaWR9Ij48L2Rpdj5gDQogICAgICAgICAgICAgICAgICAgICAgICApLmpvaW4oJycpfQ0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgDQogICAgcmVnaXN0ZXJUZW1wbGF0ZShuYW1lLCB0ZW1wbGF0ZSkgew0KICAgICAgICB0aGlzLnRlbXBsYXRlcy5zZXQobmFtZSwgdGVtcGxhdGUpOw0KICAgIH0NCiAgICANCiAgICByZW5kZXJOb2RlKG5vZGUpIHsNCiAgICAgICAgY29uc3Qgbm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShub2RlLnR5cGUpOw0KICAgICAgICBpZiAoIW5vZGVEZWYpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYE5vIG5vZGUgZGVmaW5pdGlvbiBmb3VuZCBmb3IgdHlwZTogJHtub2RlLnR5cGV9YCk7DQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHRlbXBsYXRlTmFtZSA9IG5vZGVEZWYudGVtcGxhdGUgfHwgJ3N0YW5kYXJkJzsNCiAgICAgICAgY29uc3QgdGVtcGxhdGUgPSB0aGlzLnRlbXBsYXRlcy5nZXQodGVtcGxhdGVOYW1lKTsNCiAgICAgICAgDQogICAgICAgIGlmICghdGVtcGxhdGUpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYE5vIHRlbXBsYXRlIGZvdW5kOiAke3RlbXBsYXRlTmFtZX1gKTsNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHRlbXBsYXRlLnJlbmRlcihub2RlLCBub2RlRGVmKTsNCiAgICB9DQogICAgDQogICAgY3JlYXRlTm9kZUVsZW1lbnQobm9kZSkgew0KICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgICAgICBub2RlRWxlbWVudC5jbGFzc05hbWUgPSBgZmxvdy1ub2RlICR7bm9kZS50eXBlfS1ub2RlYDsNCiAgICAgICAgbm9kZUVsZW1lbnQuaWQgPSBub2RlLmlkOw0KICAgICAgICBub2RlRWxlbWVudC5zdHlsZS5sZWZ0ID0gbm9kZS54ICsgJ3B4JzsNCiAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUudG9wID0gbm9kZS55ICsgJ3B4JzsNCiAgICAgICAgDQogICAgICAgIC8vIFJlbmRlciB0aGUgbm9kZSBjb250ZW50DQogICAgICAgIG5vZGVFbGVtZW50LmlubmVySFRNTCA9IHRoaXMucmVuZGVyTm9kZShub2RlKTsNCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lcnMgYW5kIGdldCB0aGUgdXBkYXRlZCBlbGVtZW50DQogICAgICAgIGNvbnN0IGZpbmFsRWxlbWVudCA9IHRoaXMuYWRkTm9kZUV2ZW50TGlzdGVuZXJzKG5vZGVFbGVtZW50LCBub2RlKTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiBmaW5hbEVsZW1lbnQ7DQogICAgfQ0KICAgIA0KICAgIGFkZE5vZGVFdmVudExpc3RlbmVycyhub2RlRWxlbWVudCwgbm9kZSkgew0KICAgICAgICAvLyBEZWxldGUgYnV0dG9uDQogICAgICAgIGNvbnN0IGRlbGV0ZUJ0biA9IG5vZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ub2RlLWRlbGV0ZS1idG4nKTsNCiAgICAgICAgaWYgKGRlbGV0ZUJ0bikgew0KICAgICAgICAgICAgZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgICAgIGRlbGV0ZU5vZGUobm9kZS5pZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gTm9kZSBzZWxlY3Rpb24NCiAgICAgICAgbm9kZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy5ub2RlLWRlbGV0ZS1idG4nKSkgcmV0dXJuOw0KICAgICAgICAgICAgc2VsZWN0Tm9kZShub2RlLmlkKTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyBOb2RlIGRyYWdnaW5nDQogICAgICAgIG5vZGVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7DQogICAgICAgICAgICBpZiAoZS50YXJnZXQuY2xvc2VzdCgnLm5vZGUtZGVsZXRlLWJ0bicpKSByZXR1cm47DQogICAgICAgICAgICBzdGFydERyYWdnaW5nTm9kZShub2RlLmlkLCBlKTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyBQb3J0IGNvbm5lY3Rpb25zDQogICAgICAgIGNvbnN0IHBvcnRzID0gbm9kZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZsb3ctbm9kZS1wb3J0Jyk7DQogICAgICAgIHBvcnRzLmZvckVhY2gocG9ydCA9PiB7DQogICAgICAgICAgICBwb3J0LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgICAgICBzdGFydENvbm5lY3Rpb24obm9kZS5pZCwgcG9ydC5kYXRhc2V0LnBvcnQsIHBvcnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdvdXRwdXQnKSk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICByZXR1cm4gbm9kZUVsZW1lbnQ7DQogICAgfQ0KfQ0KDQovLyBHbG9iYWwgbm9kZSByZW5kZXJlciBpbnN0YW5jZQ0KY29uc3Qgbm9kZVJlbmRlcmVyID0gbmV3IE5vZGVSZW5kZXJlcigpOw0KDQoNCi8vIFRleHQgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVRleHROb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IHRleHRDb250ZW50ID0gbm9kZS5jb25maWcudGV4dF9jb250ZW50LnZhbHVlOw0KDQogICAgcmV0dXJuIHsgdGV4dDogdGV4dENvbnRlbnQgfTsNCn0NCg0KDQovLyBKU09OIEV4dHJhY3QgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUpzb25FeHRyYWN0Tm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBmaWVsZFBhdGggPSBub2RlLmNvbmZpZy5maWVsZF9wYXRoLnZhbHVlOw0KICAgIGNvbnN0IGRlZmF1bHRWYWx1ZSA9IG5vZGUuY29uZmlnLmRlZmF1bHRfdmFsdWU/LnZhbHVlIHx8ICcnOw0KDQogICAgLy8gQWNjZXB0IGFueSBpbnB1dCBkYXRhLCBub3QganVzdCBqc29uX2RhdGENCiAgICBsZXQganNvbkRhdGEgPSBudWxsOw0KDQogICAgLy8gVHJ5IHRvIGZpbmQgSlNPTiBkYXRhIGZyb20gYW55IGlucHV0DQogICAgaWYgKGlucHV0RGF0YS5qc29uX2RhdGEpIHsNCiAgICAgICAganNvbkRhdGEgPSBpbnB1dERhdGEuanNvbl9kYXRhOw0KICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLmRhdGEpIHsNCiAgICAgICAganNvbkRhdGEgPSBpbnB1dERhdGEuZGF0YTsNCiAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS50ZXh0KSB7DQogICAgICAgIGpzb25EYXRhID0gaW5wdXREYXRhLnRleHQ7DQogICAgfSBlbHNlIGlmIChpbnB1dERhdGEucmVzcG9uc2UpIHsNCiAgICAgICAganNvbkRhdGEgPSBpbnB1dERhdGEucmVzcG9uc2U7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gVXNlIHRoZSBmaXJzdCBhdmFpbGFibGUgaW5wdXQNCiAgICAgICAgY29uc3QgZmlyc3RJbnB1dCA9IE9iamVjdC52YWx1ZXMoaW5wdXREYXRhKVswXTsNCiAgICAgICAganNvbkRhdGEgPSBmaXJzdElucHV0Ow0KICAgIH0NCg0KDQogICAgbGV0IGV4dHJhY3RlZFZhbHVlID0gbnVsbDsNCg0KICAgIHRyeSB7DQogICAgICAgIC8vIFBhcnNlIEpTT04gaWYgaXQncyBhIHN0cmluZw0KICAgICAgICBpZiAodHlwZW9mIGpzb25EYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAganNvbkRhdGEgPSBKU09OLnBhcnNlKGpzb25EYXRhKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEV4dHJhY3QgdmFsdWUgdXNpbmcgZG90IG5vdGF0aW9uDQogICAgICAgIGV4dHJhY3RlZFZhbHVlID0gd2luZG93LmZsb3dFZGl0b3JVdGlscy5leHRyYWN0TmVzdGVkVmFsdWUoanNvbkRhdGEsIGZpZWxkUGF0aCk7DQoNCiAgICAgICAgLy8gVXNlIGRlZmF1bHQgdmFsdWUgaWYgZXh0cmFjdGlvbiBmYWlsZWQNCiAgICAgICAgaWYgKGV4dHJhY3RlZFZhbHVlID09PSBudWxsIHx8IGV4dHJhY3RlZFZhbHVlID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGV4dHJhY3RlZFZhbHVlID0gZGVmYXVsdFZhbHVlOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gRm9ybWF0IHRoZSBvdXRwdXQgYXMgc3RyaW5nIGZvciBjb25zaXN0ZW5jeQ0KICAgICAgICBsZXQgZm9ybWF0dGVkVmFsdWUgPSBTdHJpbmcoZXh0cmFjdGVkVmFsdWUpOw0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBub2RlLmxhc3RFeHRyYWN0ZWRWYWx1ZSA9IGZvcm1hdHRlZFZhbHVlOw0KICAgICAgICBub2RlLmxhc3RGaWVsZFBhdGggPSBmaWVsZFBhdGg7DQoNCiAgICAgICAgLy8gRGVidWcgbG9nZ2luZw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkYXRhOiBmb3JtYXR0ZWRWYWx1ZSwNCiAgICAgICAgICAgIHRleHQ6IGZvcm1hdHRlZFZhbHVlLA0KICAgICAgICAgICAganNvbjogZXh0cmFjdGVkVmFsdWUsDQogICAgICAgICAgICBleHRyYWN0ZWRfdmFsdWU6IGZvcm1hdHRlZFZhbHVlLA0KICAgICAgICAgICAgZmllbGRfcGF0aDogZmllbGRQYXRoLA0KICAgICAgICAgICAgb3JpZ2luYWw6IGpzb25EYXRhDQogICAgICAgIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignSlNPTiBFeHRyYWN0IGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGRhdGE6IGRlZmF1bHRWYWx1ZSwNCiAgICAgICAgICAgIHRleHQ6IGRlZmF1bHRWYWx1ZSwNCiAgICAgICAgICAgIGpzb246IG51bGwsDQogICAgICAgICAgICBleHRyYWN0ZWRfdmFsdWU6IGRlZmF1bHRWYWx1ZSwNCiAgICAgICAgICAgIGZpZWxkX3BhdGg6IGZpZWxkUGF0aCwNCiAgICAgICAgICAgIG9yaWdpbmFsOiBqc29uRGF0YSwNCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQoNCi8vIFJhbmRvbSBMaW5lIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVSYW5kb21RdW90ZU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgc2tpcEVtcHR5ID0gbm9kZS5jb25maWcuc2tpcF9lbXB0eS52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IHRyaW1XaGl0ZXNwYWNlID0gbm9kZS5jb25maWcudHJpbV93aGl0ZXNwYWNlLnZhbHVlID09PSAndHJ1ZSc7DQogICAgY29uc3QgbWF4TGVuZ3RoID0gcGFyc2VJbnQobm9kZS5jb25maWcubWF4X2xlbmd0aC52YWx1ZSk7DQoNCg0KICAgIGxldCB0ZXh0ID0gaW5wdXREYXRhLnRleHQ7DQogICAgaWYgKHR5cGVvZiB0ZXh0ICE9PSAnc3RyaW5nJykgew0KICAgICAgICB0ZXh0ID0gSlNPTi5zdHJpbmdpZnkodGV4dCk7DQogICAgfQ0KDQoNCiAgICBjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoJ1xuJyk7DQoNCiAgICBsZXQgdmFsaWRMaW5lcyA9IGxpbmVzOw0KDQogICAgaWYgKHNraXBFbXB0eSkgew0KICAgICAgICB2YWxpZExpbmVzID0gbGluZXMuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkubGVuZ3RoID4gMCk7DQogICAgfQ0KDQogICAgaWYgKHRyaW1XaGl0ZXNwYWNlKSB7DQogICAgICAgIHZhbGlkTGluZXMgPSB2YWxpZExpbmVzLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKTsNCiAgICB9DQoNCiAgICBpZiAodmFsaWRMaW5lcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgcmV0dXJuIHsgcmFuZG9tX2xpbmU6IG51bGwsIGxpbmVfbnVtYmVyOiAwLCB0b3RhbF9saW5lczogMCB9Ow0KICAgIH0NCg0KICAgIGNvbnN0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdmFsaWRMaW5lcy5sZW5ndGgpOw0KICAgIGxldCByYW5kb21MaW5lID0gdmFsaWRMaW5lc1tyYW5kb21JbmRleF07DQoNCg0KICAgIGlmIChtYXhMZW5ndGggPiAwICYmIHJhbmRvbUxpbmUubGVuZ3RoID4gbWF4TGVuZ3RoKSB7DQogICAgICAgIHJhbmRvbUxpbmUgPSByYW5kb21MaW5lLnN1YnN0cmluZygwLCBtYXhMZW5ndGgpICsgJy4uLic7DQogICAgfQ0KDQogICAgY29uc3QgcmVzdWx0ID0gew0KICAgICAgICByYW5kb21fbGluZTogcmFuZG9tTGluZSwNCiAgICAgICAgbGluZV9udW1iZXI6IHJhbmRvbUluZGV4ICsgMSwNCiAgICAgICAgdG90YWxfbGluZXM6IHZhbGlkTGluZXMubGVuZ3RoDQogICAgfTsNCg0KICAgIHJldHVybiByZXN1bHQ7DQp9DQoNCi8vIE1hdGggT3BlcmF0aW9ucyBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlTWF0aE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgb3BlcmF0aW9uID0gbm9kZS5jb25maWcub3BlcmF0aW9uLnZhbHVlOw0KICAgIGNvbnN0IGNvbmZpZ1ZhbHVlQSA9IHBhcnNlRmxvYXQobm9kZS5jb25maWcudmFsdWVfYS52YWx1ZSkgfHwgMDsNCiAgICBjb25zdCBjb25maWdWYWx1ZUIgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLnZhbHVlX2IudmFsdWUpIHx8IDA7DQogICAgbGV0IGRlY2ltYWxQbGFjZXMgPSBwYXJzZUludChub2RlLmNvbmZpZy5kZWNpbWFsX3BsYWNlcy52YWx1ZSk7DQogICAgaWYgKGlzTmFOKGRlY2ltYWxQbGFjZXMpKSBkZWNpbWFsUGxhY2VzID0gMDsgLy8gRGVmYXVsdCB0byAwIGlmIG5vdCBhIG51bWJlcg0KDQogICAgLy8gR2V0IHZhbHVlcyBmcm9tIGlucHV0cyBvciBjb25maWcNCiAgICBsZXQgdmFsdWVBID0gaW5wdXREYXRhLnZhbHVlX2EgIT09IHVuZGVmaW5lZCA/IGlucHV0RGF0YS52YWx1ZV9hIDogDQogICAgICAgICAgICAgICAgIGlucHV0RGF0YS5udW1iZXJfYSAhPT0gdW5kZWZpbmVkID8gaW5wdXREYXRhLm51bWJlcl9hIDogY29uZmlnVmFsdWVBOw0KICAgIGxldCB2YWx1ZUIgPSBpbnB1dERhdGEudmFsdWVfYiAhPT0gdW5kZWZpbmVkID8gaW5wdXREYXRhLnZhbHVlX2IgOiANCiAgICAgICAgICAgICAgICAgaW5wdXREYXRhLm51bWJlcl9iICE9PSB1bmRlZmluZWQgPyBpbnB1dERhdGEubnVtYmVyX2IgOiBjb25maWdWYWx1ZUI7DQoNCiAgICAvLyBDb252ZXJ0IHRvIG51bWJlcnMNCiAgICBpZiAodHlwZW9mIHZhbHVlQSA9PT0gJ3N0cmluZycpIHZhbHVlQSA9IHBhcnNlRmxvYXQodmFsdWVBKSB8fCAwOw0KICAgIGlmICh0eXBlb2YgdmFsdWVCID09PSAnc3RyaW5nJykgdmFsdWVCID0gcGFyc2VGbG9hdCh2YWx1ZUIpIHx8IDA7DQogICAgaWYgKHR5cGVvZiB2YWx1ZUEgPT09ICdvYmplY3QnICYmIHZhbHVlQSAhPT0gbnVsbCkgew0KICAgICAgICAvLyBUcnkgdG8gZXh0cmFjdCBudW1lcmljIHZhbHVlIGZyb20gb2JqZWN0DQogICAgICAgIHZhbHVlQSA9IHBhcnNlRmxvYXQodmFsdWVBLnZhbHVlIHx8IHZhbHVlQS5yZXN1bHQgfHwgdmFsdWVBLmRhdGEgfHwgMCk7DQogICAgfQ0KICAgIGlmICh0eXBlb2YgdmFsdWVCID09PSAnb2JqZWN0JyAmJiB2YWx1ZUIgIT09IG51bGwpIHsNCiAgICAgICAgdmFsdWVCID0gcGFyc2VGbG9hdCh2YWx1ZUIudmFsdWUgfHwgdmFsdWVCLnJlc3VsdCB8fCB2YWx1ZUIuZGF0YSB8fCAwKTsNCiAgICB9DQoNCiAgICBsZXQgcmVzdWx0ID0gMDsNCg0KICAgIHRyeSB7DQogICAgICAgIHN3aXRjaCAob3BlcmF0aW9uKSB7DQogICAgICAgICAgICBjYXNlICdhZGQnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlQSArIHZhbHVlQjsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3N1YnRyYWN0JzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZUEgLSB2YWx1ZUI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdtdWx0aXBseSc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWVBICogdmFsdWVCOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZGl2aWRlJzoNCiAgICAgICAgICAgICAgICBpZiAodmFsdWVCID09PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ0RpdmlzaW9uIGJ5IHplcm8nKTsNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZUEgLyB2YWx1ZUI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdtb2R1bG8nOg0KICAgICAgICAgICAgICAgIGlmICh2YWx1ZUIgPT09IDApIHRocm93IG5ldyBFcnJvcignTW9kdWxvIGJ5IHplcm8nKTsNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZUEgJSB2YWx1ZUI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdwb3dlcic6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5wb3codmFsdWVBLCB2YWx1ZUIpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnbWluJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLm1pbih2YWx1ZUEsIHZhbHVlQik7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdtYXgnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGgubWF4KHZhbHVlQSwgdmFsdWVCKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2Ficyc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5hYnModmFsdWVBKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JvdW5kJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLnJvdW5kKHZhbHVlQSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdmbG9vcic6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5mbG9vcih2YWx1ZUEpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnY2VpbCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5jZWlsKHZhbHVlQSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlQTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFJvdW5kIHRvIHNwZWNpZmllZCBkZWNpbWFsIHBsYWNlcw0KICAgICAgICBpZiAoZGVjaW1hbFBsYWNlcyA+PSAwKSB7DQogICAgICAgICAgICByZXN1bHQgPSBwYXJzZUZsb2F0KHJlc3VsdC50b0ZpeGVkKGRlY2ltYWxQbGFjZXMpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBub2RlLmxhc3RWYWx1ZUEgPSB2YWx1ZUE7DQogICAgICAgIG5vZGUubGFzdFZhbHVlQiA9IHZhbHVlQjsNCiAgICAgICAgbm9kZS5sYXN0UmVzdWx0ID0gcmVzdWx0Ow0KICAgICAgICBub2RlLmxhc3RPcGVyYXRpb24gPSBvcGVyYXRpb247DQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHJlc3VsdDogcmVzdWx0LA0KICAgICAgICAgICAgZGF0YTogcmVzdWx0LA0KICAgICAgICAgICAgdGV4dDogcmVzdWx0LnRvU3RyaW5nKCksDQogICAgICAgICAgICBmb3JtYXR0ZWQ6IGRlY2ltYWxQbGFjZXMgPT09IDAgPyByZXN1bHQudG9TdHJpbmcoKSA6IHJlc3VsdC50b0ZpeGVkKGRlY2ltYWxQbGFjZXMpDQogICAgICAgIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTWF0aCBvcGVyYXRpb24gZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgcmVzdWx0OiAwLA0KICAgICAgICAgICAgZGF0YTogMCwNCiAgICAgICAgICAgIHRleHQ6ICIwIiwNCiAgICAgICAgICAgIGZvcm1hdHRlZDogZGVjaW1hbFBsYWNlcyA9PT0gMCA/ICIwIiA6ICIwLjAwIiwNCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQovLyBBcnJheSBPcGVyYXRpb25zIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVBcnJheU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgb3BlcmF0aW9uID0gbm9kZS5jb25maWcub3BlcmF0aW9uLnZhbHVlOw0KICAgIGNvbnN0IGZpZWxkUGF0aCA9IG5vZGUuY29uZmlnLmZpZWxkX3BhdGgudmFsdWU7DQogICAgY29uc3QgZmlsdGVyVmFsdWUgPSBub2RlLmNvbmZpZy5maWx0ZXJfdmFsdWUudmFsdWU7DQogICAgY29uc3QgZmlsdGVyT3BlcmF0b3IgPSBub2RlLmNvbmZpZy5maWx0ZXJfb3BlcmF0b3IudmFsdWU7DQogICAgY29uc3Qgam9pblNlcGFyYXRvciA9IG5vZGUuY29uZmlnLmpvaW5fc2VwYXJhdG9yLnZhbHVlIHx8ICcsICc7DQogICAgY29uc3Qgc2xpY2VTdGFydCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLnNsaWNlX3N0YXJ0LnZhbHVlKSB8fCAwOw0KICAgIGNvbnN0IHNsaWNlRW5kID0gcGFyc2VJbnQobm9kZS5jb25maWcuc2xpY2VfZW5kLnZhbHVlKSB8fCAwOw0KDQogICAgLy8gR2V0IGFycmF5IGZyb20gaW5wdXQNCiAgICBsZXQgYXJyYXkgPSBpbnB1dERhdGEuYXJyYXkgfHwgaW5wdXREYXRhLmRhdGE7DQogICAgDQogICAgLy8gUGFyc2UgaWYgaXQncyBhIHN0cmluZw0KICAgIGlmICh0eXBlb2YgYXJyYXkgPT09ICdzdHJpbmcnKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBhcnJheSA9IEpTT04ucGFyc2UoYXJyYXkpOw0KICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGFyc2UgYXJyYXk6JywgZSk7DQogICAgICAgICAgICByZXR1cm4geyByZXN1bHQ6IG51bGwsIGVycm9yOiAnSW52YWxpZCBhcnJheSBkYXRhJyB9Ow0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKCFBcnJheS5pc0FycmF5KGFycmF5KSkgew0KICAgICAgICByZXR1cm4geyByZXN1bHQ6IG51bGwsIGVycm9yOiAnSW5wdXQgaXMgbm90IGFuIGFycmF5JyB9Ow0KICAgIH0NCg0KICAgIGxldCByZXN1bHQgPSBudWxsOw0KDQogICAgdHJ5IHsNCiAgICAgICAgc3dpdGNoIChvcGVyYXRpb24pIHsNCiAgICAgICAgICAgIGNhc2UgJ21hcCc6DQogICAgICAgICAgICAgICAgaWYgKGZpZWxkUGF0aCkgew0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5tYXAoaXRlbSA9PiB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShpdGVtLCBmaWVsZFBhdGgpKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5zbGljZSgpOyAvLyBSZXR1cm4gY29weSBvZiBhcnJheQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2ZpbHRlcic6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkuZmlsdGVyKGl0ZW0gPT4gew0KICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBmaWVsZFBhdGggPyB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShpdGVtLCBmaWVsZFBhdGgpIDogaXRlbTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBlcmZvcm1GaWx0ZXJPcGVyYXRpb24odmFsdWUsIGZpbHRlclZhbHVlLCBmaWx0ZXJPcGVyYXRvcik7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdsZW5ndGgnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5Lmxlbmd0aDsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2pvaW4nOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5Lm1hcChpdGVtID0+IHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGZpZWxkUGF0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZXh0cmFjdE5lc3RlZFZhbHVlKGl0ZW0sIGZpZWxkUGF0aCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBpdGVtID09PSAnb2JqZWN0JyA/IEpTT04uc3RyaW5naWZ5KGl0ZW0pIDogU3RyaW5nKGl0ZW0pOw0KICAgICAgICAgICAgICAgIH0pLmpvaW4oam9pblNlcGFyYXRvcik7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdmaXJzdCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkubGVuZ3RoID4gMCA/IGFycmF5WzBdIDogbnVsbDsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2xhc3QnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5Lmxlbmd0aCA+IDAgPyBhcnJheVthcnJheS5sZW5ndGggLSAxXSA6IG51bGw7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzbGljZSc6DQogICAgICAgICAgICAgICAgY29uc3QgZW5kID0gc2xpY2VFbmQgPiAwID8gc2xpY2VFbmQgOiBhcnJheS5sZW5ndGg7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkuc2xpY2Uoc2xpY2VTdGFydCwgZW5kKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JldmVyc2UnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5LnNsaWNlKCkucmV2ZXJzZSgpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnc29ydCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXkuc2xpY2UoKS5zb3J0KChhLCBiKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZUEgPSBmaWVsZFBhdGggPyB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShhLCBmaWVsZFBhdGgpIDogYTsNCiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlQiA9IGZpZWxkUGF0aCA/IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZXh0cmFjdE5lc3RlZFZhbHVlKGIsIGZpZWxkUGF0aCkgOiBiOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWVBIDwgdmFsdWVCID8gLTEgOiB2YWx1ZUEgPiB2YWx1ZUIgPyAxIDogMDsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3VuaXF1ZSc6DQogICAgICAgICAgICAgICAgaWYgKGZpZWxkUGF0aCkgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWVuID0gbmV3IFNldCgpOw0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheS5maWx0ZXIoaXRlbSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZXh0cmFjdE5lc3RlZFZhbHVlKGl0ZW0sIGZpZWxkUGF0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2Vlbi5oYXModmFsdWUpKSByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWVuLmFkZCh2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gWy4uLm5ldyBTZXQoYXJyYXkpXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5Ow0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU3RvcmUgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgICAgIG5vZGUubGFzdEFycmF5ID0gYXJyYXk7DQogICAgICAgIG5vZGUubGFzdFJlc3VsdCA9IHJlc3VsdDsNCiAgICAgICAgbm9kZS5sYXN0T3BlcmF0aW9uID0gb3BlcmF0aW9uOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXN1bHQ6IHJlc3VsdCwNCiAgICAgICAgICAgIGRhdGE6IHJlc3VsdCwNCiAgICAgICAgICAgIHRleHQ6IEFycmF5LmlzQXJyYXkocmVzdWx0KSA/IEpTT04uc3RyaW5naWZ5KHJlc3VsdCkgOiBTdHJpbmcocmVzdWx0KSwNCiAgICAgICAgICAgIGxlbmd0aDogQXJyYXkuaXNBcnJheShyZXN1bHQpID8gcmVzdWx0Lmxlbmd0aCA6IEFycmF5LmlzQXJyYXkoYXJyYXkpID8gYXJyYXkubGVuZ3RoIDogMCwNCiAgICAgICAgICAgIGZpcnN0OiBBcnJheS5pc0FycmF5KGFycmF5KSAmJiBhcnJheS5sZW5ndGggPiAwID8gYXJyYXlbMF0gOiBudWxsLA0KICAgICAgICAgICAgbGFzdDogQXJyYXkuaXNBcnJheShhcnJheSkgJiYgYXJyYXkubGVuZ3RoID4gMCA/IGFycmF5W2FycmF5Lmxlbmd0aCAtIDFdIDogbnVsbA0KICAgICAgICB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0FycmF5IG9wZXJhdGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXN1bHQ6IG51bGwsDQogICAgICAgICAgICBkYXRhOiBudWxsLA0KICAgICAgICAgICAgdGV4dDogIiIsDQogICAgICAgICAgICBsZW5ndGg6IDAsDQogICAgICAgICAgICBmaXJzdDogbnVsbCwNCiAgICAgICAgICAgIGxhc3Q6IG51bGwsDQogICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZQ0KICAgICAgICB9Ow0KICAgIH0NCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIGZvciBhcnJheSBmaWx0ZXJpbmcNCmZ1bmN0aW9uIHBlcmZvcm1GaWx0ZXJPcGVyYXRpb24odmFsdWUsIGZpbHRlclZhbHVlLCBvcGVyYXRvcikgew0KICAgIGNvbnN0IHZhbHVlU3RyID0gU3RyaW5nKHZhbHVlKS50b0xvd2VyQ2FzZSgpOw0KICAgIGNvbnN0IGZpbHRlclN0ciA9IFN0cmluZyhmaWx0ZXJWYWx1ZSkudG9Mb3dlckNhc2UoKTsNCiAgICANCiAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7DQogICAgICAgIGNhc2UgJ2VxdWFscyc6DQogICAgICAgICAgICByZXR1cm4gdmFsdWUgPT0gZmlsdGVyVmFsdWU7DQogICAgICAgIGNhc2UgJ25vdF9lcXVhbHMnOg0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlICE9IGZpbHRlclZhbHVlOw0KICAgICAgICBjYXNlICdjb250YWlucyc6DQogICAgICAgICAgICByZXR1cm4gdmFsdWVTdHIuaW5jbHVkZXMoZmlsdGVyU3RyKTsNCiAgICAgICAgY2FzZSAnZ3JlYXRlcl90aGFuJzoNCiAgICAgICAgICAgIHJldHVybiBOdW1iZXIodmFsdWUpID4gTnVtYmVyKGZpbHRlclZhbHVlKTsNCiAgICAgICAgY2FzZSAnbGVzc190aGFuJzoNCiAgICAgICAgICAgIHJldHVybiBOdW1iZXIodmFsdWUpIDwgTnVtYmVyKGZpbHRlclZhbHVlKTsNCiAgICAgICAgY2FzZSAnc3RhcnRzX3dpdGgnOg0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlU3RyLnN0YXJ0c1dpdGgoZmlsdGVyU3RyKTsNCiAgICAgICAgY2FzZSAnZW5kc193aXRoJzoNCiAgICAgICAgICAgIHJldHVybiB2YWx1ZVN0ci5lbmRzV2l0aChmaWx0ZXJTdHIpOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KfQ0KDQovLyBTdHJpbmcgT3BlcmF0aW9ucyBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlU3RyaW5nTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBvcGVyYXRpb24gPSBub2RlLmNvbmZpZy5vcGVyYXRpb24udmFsdWU7DQogICAgY29uc3QgY29uZmlnVGV4dEIgPSBub2RlLmNvbmZpZy50ZXh0X2IudmFsdWU7DQogICAgY29uc3Qgc2VwYXJhdG9yID0gbm9kZS5jb25maWcuc2VwYXJhdG9yLnZhbHVlIHx8ICcsJzsNCiAgICBjb25zdCBzZWFyY2hUZXh0ID0gbm9kZS5jb25maWcuc2VhcmNoX3RleHQudmFsdWU7DQogICAgY29uc3QgcmVwbGFjZVRleHQgPSBub2RlLmNvbmZpZy5yZXBsYWNlX3RleHQudmFsdWU7DQogICAgY29uc3Qgc3RhcnRJbmRleCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLnN0YXJ0X2luZGV4LnZhbHVlKSB8fCAwOw0KICAgIGNvbnN0IGVuZEluZGV4ID0gcGFyc2VJbnQobm9kZS5jb25maWcuZW5kX2luZGV4LnZhbHVlKSB8fCAwOw0KICAgIGNvbnN0IHJlcGVhdENvdW50ID0gcGFyc2VJbnQobm9kZS5jb25maWcucmVwZWF0X2NvdW50LnZhbHVlKSB8fCAxOw0KICAgIGNvbnN0IGNhc2VTZW5zaXRpdmUgPSBub2RlLmNvbmZpZy5jYXNlX3NlbnNpdGl2ZS52YWx1ZSA9PT0gJ3RydWUnOw0KDQogICAgLy8gR2V0IHRleHQgaW5wdXRzDQogICAgbGV0IHRleHRBID0gaW5wdXREYXRhLnRleHQgfHwgaW5wdXREYXRhLmRhdGEgfHwgJyc7DQogICAgbGV0IHRleHRCID0gaW5wdXREYXRhLnRleHRfYiB8fCBjb25maWdUZXh0QiB8fCAnJzsNCg0KICAgIC8vIERlYnVnIGxvZ2dpbmcgZm9yIGlucHV0IHN5bmNocm9uaXphdGlvbg0KICAgIGNvbnNvbGUubG9nKGBTdHJpbmcgT3BlcmF0aW9ucyBOb2RlIERlYnVnOmAsIHsNCiAgICAgICAgb3BlcmF0aW9uOiBvcGVyYXRpb24sDQogICAgICAgIGlucHV0RGF0YTogaW5wdXREYXRhLA0KICAgICAgICBpbnB1dERhdGFLZXlzOiBPYmplY3Qua2V5cyhpbnB1dERhdGEpLA0KICAgICAgICB0ZXh0QTogdGV4dEEsDQogICAgICAgIHRleHRCOiB0ZXh0QiwNCiAgICAgICAgY29uZmlnVGV4dEI6IGNvbmZpZ1RleHRCDQogICAgfSk7DQoNCiAgICAvLyBDb252ZXJ0IHRvIHN0cmluZ3MNCiAgICBpZiAodHlwZW9mIHRleHRBICE9PSAnc3RyaW5nJykgdGV4dEEgPSBTdHJpbmcodGV4dEEpOw0KICAgIGlmICh0eXBlb2YgdGV4dEIgIT09ICdzdHJpbmcnKSB0ZXh0QiA9IFN0cmluZyh0ZXh0Qik7DQoNCiAgICBsZXQgcmVzdWx0ID0gJyc7DQoNCiAgICB0cnkgew0KICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbikgew0KICAgICAgICAgICAgY2FzZSAnY29uY2F0ZW5hdGUnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBICsgdGV4dEI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzcGxpdCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdGV4dEEuc3BsaXQoc2VwYXJhdG9yKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JlcGxhY2UnOg0KICAgICAgICAgICAgICAgIGlmIChjYXNlU2Vuc2l0aXZlKSB7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnJlcGxhY2UobmV3IFJlZ0V4cChlc2NhcGVSZWdleChzZWFyY2hUZXh0KSwgJ2cnKSwgcmVwbGFjZVRleHQpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnJlcGxhY2UobmV3IFJlZ0V4cChlc2NhcGVSZWdleChzZWFyY2hUZXh0KSwgJ2dpJyksIHJlcGxhY2VUZXh0KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICd0cmltJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0QS50cmltKCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICd1cHBlcmNhc2UnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdsb3dlcmNhc2UnOg0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzdWJzdHJpbmcnOg0KICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IGVuZEluZGV4ID4gMCA/IGVuZEluZGV4IDogdGV4dEEubGVuZ3RoOw0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnN1YnN0cmluZyhzdGFydEluZGV4LCBlbmQpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAncmVnZXhfbWF0Y2gnOg0KICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoRmxhZ3MgPSBjYXNlU2Vuc2l0aXZlID8gJ2cnIDogJ2dpJzsNCiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gdGV4dEEubWF0Y2gobmV3IFJlZ0V4cChzZWFyY2hUZXh0LCBtYXRjaEZsYWdzKSk7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gbWF0Y2hlcyB8fCBbXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JlZ2V4X3JlcGxhY2UnOg0KICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VGbGFncyA9IGNhc2VTZW5zaXRpdmUgPyAnZycgOiAnZ2knOw0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBLnJlcGxhY2UobmV3IFJlZ0V4cChzZWFyY2hUZXh0LCByZXBsYWNlRmxhZ3MpLCByZXBsYWNlVGV4dCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzdGFydHNfd2l0aCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gY2FzZVNlbnNpdGl2ZSA/IHRleHRBLnN0YXJ0c1dpdGgoc2VhcmNoVGV4dCkgOiANCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChzZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCkpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZW5kc193aXRoJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBjYXNlU2Vuc2l0aXZlID8gdGV4dEEuZW5kc1dpdGgoc2VhcmNoVGV4dCkgOiANCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2NvbnRhaW5zJzoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBjYXNlU2Vuc2l0aXZlID8gdGV4dEEuaW5jbHVkZXMoc2VhcmNoVGV4dCkgOiANCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3JlcGVhdCc6DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gdGV4dEEucmVwZWF0KE1hdGgubWF4KDAsIE1hdGgubWluKHJlcGVhdENvdW50LCAxMDApKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRleHRBOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU3RvcmUgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgICAgIG5vZGUubGFzdFRleHRBID0gdGV4dEE7DQogICAgICAgIG5vZGUubGFzdFRleHRCID0gdGV4dEI7DQogICAgICAgIG5vZGUubGFzdFJlc3VsdCA9IHJlc3VsdDsNCiAgICAgICAgbm9kZS5sYXN0T3BlcmF0aW9uID0gb3BlcmF0aW9uOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXN1bHQ6IEFycmF5LmlzQXJyYXkocmVzdWx0KSA/IHJlc3VsdCA6IFN0cmluZyhyZXN1bHQpLA0KICAgICAgICAgICAgZGF0YTogcmVzdWx0LA0KICAgICAgICAgICAgYXJyYXk6IEFycmF5LmlzQXJyYXkocmVzdWx0KSA/IHJlc3VsdCA6IG51bGwsDQogICAgICAgICAgICBsZW5ndGg6IFN0cmluZyhyZXN1bHQpLmxlbmd0aCwNCiAgICAgICAgICAgIHdvcmRfY291bnQ6IFN0cmluZyhyZXN1bHQpLnRyaW0oKS5zcGxpdCgvXHMrLykuZmlsdGVyKHdvcmQgPT4gd29yZC5sZW5ndGggPiAwKS5sZW5ndGgNCiAgICAgICAgfTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdTdHJpbmcgb3BlcmF0aW9uIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHJlc3VsdDogJycsDQogICAgICAgICAgICBkYXRhOiAnJywNCiAgICAgICAgICAgIGFycmF5OiBudWxsLA0KICAgICAgICAgICAgbGVuZ3RoOiAwLA0KICAgICAgICAgICAgd29yZF9jb3VudDogMCwNCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gZXNjYXBlIHJlZ2V4IHNwZWNpYWwgY2hhcmFjdGVycw0KZnVuY3Rpb24gZXNjYXBlUmVnZXgoc3RyaW5nKSB7DQogICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC9bLiorP14ke30oKXxbXF1cXF0vZywgJ1xcJCYnKTsNCn0NCg0KLy8gRXhwb3J0IHRvIGdsb2JhbCBzY29wZQ0Kd2luZG93LmRhdGFFeGVjdXRvcnMgPSB7DQogICAgZXhlY3V0ZVRleHROb2RlLA0KICAgIGV4ZWN1dGVKc29uRXh0cmFjdE5vZGUsDQogICAgZXhlY3V0ZVJhbmRvbVF1b3RlTm9kZSwNCiAgICBleGVjdXRlTWF0aE5vZGUsDQogICAgZXhlY3V0ZUFycmF5Tm9kZSwNCiAgICBleGVjdXRlU3RyaW5nTm9kZQ0KfTsNCg0KDQovLyBIVFRQIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVIdHRwTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCB1cmwgPSBub2RlLmNvbmZpZy51cmwudmFsdWU7DQogICAgY29uc3QgbWV0aG9kID0gbm9kZS5jb25maWcubWV0aG9kLnZhbHVlOw0KICAgIGNvbnN0IGhlYWRlcnMgPSBKU09OLnBhcnNlKG5vZGUuY29uZmlnLmhlYWRlcnMudmFsdWUgfHwgJ3t9Jyk7DQogICAgY29uc3QgYm9keSA9IG5vZGUuY29uZmlnLmJvZHkudmFsdWU7DQogICAgY29uc3QgdXNlVGVtcGxhdGUgPSAobm9kZS5jb25maWcudXNlX3RlbXBsYXRlPy52YWx1ZSB8fCAnZmFsc2UnKSA9PT0gJ3RydWUnOw0KDQogICAgbGV0IHByb2Nlc3NlZEJvZHkgPSBib2R5Ow0KDQogICAgLy8gUGFyc2UgYm9keSBhcyBKU09OIGlmIGl0J3MgYSBzdHJpbmcgYW5kIGxvb2tzIGxpa2UgSlNPTg0KICAgIGlmICh0eXBlb2YgcHJvY2Vzc2VkQm9keSA9PT0gJ3N0cmluZycgJiYgcHJvY2Vzc2VkQm9keS50cmltKCkuc3RhcnRzV2l0aCgneycpKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBwcm9jZXNzZWRCb2R5ID0gSlNPTi5wYXJzZShwcm9jZXNzZWRCb2R5KTsNCiAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gcGFyc2UgYm9keSBhcyBKU09OLCB1c2luZyBhcyBzdHJpbmc6JywgZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAodXNlVGVtcGxhdGUgJiYgaW5wdXREYXRhLnRlbXBsYXRlX2RhdGEpIHsNCiAgICAgICAgcHJvY2Vzc2VkQm9keSA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMucHJvY2Vzc1RlbXBsYXRlcyhwcm9jZXNzZWRCb2R5LCBpbnB1dERhdGEudGVtcGxhdGVfZGF0YSk7DQogICAgfQ0KDQogICAgLy8gVXNlIE9TIHByb3h5IHRvIGJ5cGFzcyBDT1JTDQogICAgY29uc3QgcHJveHlSZXF1ZXN0ID0gew0KICAgICAgICB1cmw6IHVybCwNCiAgICAgICAgbWV0aG9kOiBtZXRob2QsDQogICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsDQogICAgICAgIGJvZHk6IHByb2Nlc3NlZEJvZHksDQogICAgICAgIHRpbWVvdXQ6IDMwDQogICAgfTsNCg0KDQogICAgY29uc3QgcHJveHlSZXNwb25zZSA9IGF3YWl0IHN5cG5leEFQSS5wcm94eUhUVFAocHJveHlSZXF1ZXN0KTsNCg0KICAgIGlmICghcHJveHlSZXNwb25zZSB8fCBwcm94eVJlc3BvbnNlLnN0YXR1cyA8IDIwMCB8fCBwcm94eVJlc3BvbnNlLnN0YXR1cyA+PSAzMDApIHsNCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQcm94eSByZXF1ZXN0IGZhaWxlZDogJHtwcm94eVJlc3BvbnNlPy5zdGF0dXMgfHwgJ1Vua25vd24gZXJyb3InfWApOw0KICAgIH0NCg0KICAgIGNvbnN0IHByb3h5RGF0YSA9IHByb3h5UmVzcG9uc2U7DQoNCiAgICBpZiAocHJveHlEYXRhLmVycm9yKSB7DQogICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCByZXF1ZXN0IGZhaWxlZDogJHtwcm94eURhdGEuZXJyb3J9YCk7DQogICAgfQ0KDQogICAgLy8gQ2hlY2sgaWYgcmVzcG9uc2UgaXMgYmluYXJ5IChhdWRpbywgaW1hZ2UsIGV0Yy4pDQogICAgaWYgKHByb3h5RGF0YS5pc19iaW5hcnkpIHsNCg0KICAgICAgICAvLyBDb252ZXJ0IGJhc2U2NCBjb250ZW50IHRvIGJsb2IgZm9yIGJpbmFyeSBkYXRhDQogICAgICAgIGNvbnN0IGJpbmFyeURhdGEgPSBhdG9iKHByb3h5RGF0YS5jb250ZW50KTsNCiAgICAgICAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheShiaW5hcnlEYXRhLmxlbmd0aCk7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmluYXJ5RGF0YS5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgYnl0ZXNbaV0gPSBiaW5hcnlEYXRhLmNoYXJDb2RlQXQoaSk7DQogICAgICAgIH0NCiAgICAgICAgY29uc3QgY29udGVudFR5cGUgPSBwcm94eURhdGEuaGVhZGVyc1snY29udGVudC10eXBlJ10gfHwgcHJveHlEYXRhLmhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddIHx8ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nOw0KICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2J5dGVzXSwgeyB0eXBlOiBjb250ZW50VHlwZSB9KTsNCg0KICAgICAgICAvLyBSZXR1cm4gYmxvYiBkaXJlY3RseSBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSB3aXRoIGltYWdlL2F1ZGlvIG5vZGVzDQogICAgICAgIC8vIFRoZSB3b3JrZmxvdyBleGVjdXRpb24gd2lsbCBoYW5kbGUgbWFwcGluZyB0byB0aGUgY29ycmVjdCBwb3J0cw0KICAgICAgICByZXR1cm4gYmxvYjsNCiAgICB9DQoNCiAgICAvLyBGb3IgdGV4dCByZXNwb25zZXMsIHRyeSB0byBwYXJzZSBhcyBKU09OIGFuZCByZXR1cm4gc3RydWN0dXJlZCBvdXRwdXQNCg0KICAgIGxldCBwYXJzZWRKc29uID0gbnVsbDsNCiAgICB0cnkgew0KICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgSlNPTg0KICAgICAgICBwYXJzZWRKc29uID0gSlNPTi5wYXJzZShwcm94eURhdGEuY29udGVudCk7DQogICAgfSBjYXRjaCAoZSkgew0KICAgIH0NCg0KICAgIC8vIFJldHVybiBzdHJ1Y3R1cmVkIG91dHB1dCBmb3IgdGV4dCByZXNwb25zZXMgbWF0Y2hpbmcgbmV3IG5vZGUgYXJjaGl0ZWN0dXJlDQogICAgcmV0dXJuIHsNCiAgICAgICAgb3JpZ2luYWxfZGF0YTogcHJveHlEYXRhLmNvbnRlbnQsDQogICAgICAgIHByb2Nlc3NlZF9kYXRhOiBwYXJzZWRKc29uIHx8IHByb3h5RGF0YS5jb250ZW50LA0KICAgICAgICByZXNwb25zZTogcHJveHlEYXRhLmNvbnRlbnQsDQogICAgICAgIHN0YXR1c19jb2RlOiBwcm94eURhdGEuc3RhdHVzIHx8IDIwMCwNCiAgICAgICAgaGVhZGVyczogcHJveHlEYXRhLmhlYWRlcnMgfHwge30sDQogICAgICAgIHBhcnNlZF9qc29uOiBwYXJzZWRKc29uLA0KICAgICAgICAvLyBBbHNvIHByb3ZpZGUgdGhlIHJhdyByZXNwb25zZSBhcyAnZGF0YScgZm9yIGNvbXBhdGliaWxpdHkNCiAgICAgICAgZGF0YTogcHJveHlEYXRhLmNvbnRlbnQsDQogICAgICAgIC8vIEFkZCB0aGUgbWlzc2luZyBvdXRwdXQgcG9ydHMgZnJvbSBub2RlIGRlZmluaXRpb24NCiAgICAgICAgdGV4dDogcHJveHlEYXRhLmNvbnRlbnQsDQogICAgICAgIGpzb246IHBhcnNlZEpzb24sDQogICAgICAgIHVybDogdXJsDQogICAgfTsNCn0NCg0KLy8gVkZTIExvYWQgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVZmc0xvYWROb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGZpbGVQYXRoID0gbm9kZS5jb25maWcuZmlsZV9wYXRoLnZhbHVlOw0KICAgIGNvbnN0IGZvcm1hdCA9IG5vZGUuY29uZmlnLmZvcm1hdC52YWx1ZTsNCg0KDQogICAgdHJ5IHsNCiAgICAgICAgbGV0IGRhdGEgPSBudWxsOw0KDQogICAgICAgIGlmIChmb3JtYXQgPT09ICdqc29uJykgew0KICAgICAgICAgICAgZGF0YSA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVKU09OKGZpbGVQYXRoKTsNCiAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09ICd0ZXh0Jykgew0KICAgICAgICAgICAgZGF0YSA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVUZXh0KGZpbGVQYXRoKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIEZvciBiaW5hcnkgZmlsZXMsIHVzZSB0aGUgZGlyZWN0IFVSTCBtZXRob2QNCiAgICAgICAgICAgIGNvbnN0IGZpbGVVcmwgPSBzeXBuZXhBUEkuZ2V0VmlydHVhbEZpbGVVcmwoZmlsZVBhdGgpOw0KDQogICAgICAgICAgICAvLyBDaGVjayBmaWxlIGV4dGVuc2lvbiB0byBkZXRlcm1pbmUgaWYgaXQncyBhdWRpbw0KICAgICAgICAgICAgY29uc3QgZXh0ZW5zaW9uID0gZmlsZVBhdGguc3BsaXQoJy4nKS5wb3AoKT8udG9Mb3dlckNhc2UoKTsNCiAgICAgICAgICAgIGNvbnN0IGlzQXVkaW9GaWxlID0gWydtcDMnLCAnd2F2JywgJ29nZycsICdtNGEnLCAnYWFjJywgJ2ZsYWMnXS5pbmNsdWRlcyhleHRlbnNpb24pOw0KICAgICAgICAgICAgY29uc3QgaXNJbWFnZUZpbGUgPSBbJ3BuZycsICdqcGcnLCAnanBlZycsICdnaWYnLCAnd2VicCcsICdzdmcnXS5pbmNsdWRlcyhleHRlbnNpb24pOw0KDQogICAgICAgICAgICBpZiAoaXNBdWRpb0ZpbGUpIHsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNJbWFnZUZpbGUpIHsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIEZldGNoIHRoZSBiaW5hcnkgZGF0YSBhcyBhIEJsb2INCiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZmlsZVVybCk7DQogICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggYmluYXJ5IGZpbGU6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGRhdGEgPSBhd2FpdCByZXNwb25zZS5ibG9iKCk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBTdG9yZSB0aGUgbG9hZGVkIGRhdGEgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgICAgIG5vZGUubGFzdExvYWRlZEZpbGUgPSBmaWxlUGF0aDsNCiAgICAgICAgbm9kZS5sYXN0TG9hZGVkRGF0YSA9IGRhdGE7DQoNCiAgICAgICAgLy8gUmV0dXJuIHN0cnVjdHVyZWQgb3V0cHV0IHdpdGggYXBwcm9wcmlhdGUgcG9ydCBuYW1lcw0KICAgICAgICBjb25zdCByZXN1bHQgPSB7DQogICAgICAgICAgICBkYXRhOiBkYXRhLA0KICAgICAgICAgICAgZmlsZV9wYXRoOiBmaWxlUGF0aCwgIC8vIFJldHVybiB0aGUgYWN0dWFsIGZpbGUgcGF0aCBzdHJpbmcNCiAgICAgICAgICAgIGpzb25fZGF0YTogZm9ybWF0ID09PSAnanNvbicgPyBkYXRhIDogbnVsbA0KICAgICAgICB9Ow0KICAgICAgICByZXR1cm4gcmVzdWx0Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1ZGUyBMb2FkIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsgZGF0YTogbnVsbCwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTsNCiAgICB9DQp9DQoNCg0KLy8gVkZTIFNhdmUgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVZmc1NhdmVOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGZpbGVQYXRoID0gbm9kZS5jb25maWcuZmlsZV9wYXRoLnZhbHVlOw0KICAgIGNvbnN0IGZvcm1hdCA9IG5vZGUuY29uZmlnLmZvcm1hdC52YWx1ZTsNCiAgICBjb25zdCBvdmVyd3JpdGUgPSBub2RlLmNvbmZpZy5vdmVyd3JpdGUudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCBhcHBlbmQgPSBub2RlLmNvbmZpZy5hcHBlbmQudmFsdWUgPT09ICd0cnVlJzsNCg0KICAgIHRyeSB7DQogICAgICAgIGxldCBkYXRhID0gaW5wdXREYXRhLmRhdGE7DQogICAgICAgIGxldCBzdWNjZXNzID0gZmFsc2U7DQoNCg0KICAgICAgICBpZiAoZm9ybWF0ID09PSAnanNvbicpIHsNCiAgICAgICAgICAgIHN1Y2Nlc3MgPSBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZUpTT04oZmlsZVBhdGgsIGRhdGEpOw0KICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ3RleHQnKSB7DQogICAgICAgICAgICBjb25zdCB0ZXh0RGF0YSA9IHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJyA/IGRhdGEgOiBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKTsNCiAgICAgICAgICAgIHN1Y2Nlc3MgPSBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZShmaWxlUGF0aCwgdGV4dERhdGEpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gRm9yIGJpbmFyeSBkYXRhIChsaWtlIEJsb2JzKSwgY29udmVydCB0byBkYXRhIFVSTA0KICAgICAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBCbG9iKSB7DQogICAgICAgICAgICAgICAgLy8gQ29udmVydCBCbG9iIHRvIGRhdGEgVVJMDQogICAgICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBkYXRhVXJsID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gew0KICAgICAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gKCkgPT4gcmVzb2x2ZShyZWFkZXIucmVzdWx0KTsNCiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLm9uZXJyb3IgPSByZWplY3Q7DQogICAgICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGRhdGEpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZShmaWxlUGF0aCwgZGF0YVVybCk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgICAgIC8vIElmIGl0J3MgYWxyZWFkeSBhIGRhdGEgVVJMLCBzYXZlIGl0IGRpcmVjdGx5DQogICAgICAgICAgICAgICAgc3VjY2VzcyA9IGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlKGZpbGVQYXRoLCBkYXRhKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy8gRmFsbGJhY2sgdG8gSlNPTiBzdHJpbmcNCiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0RGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpOw0KICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZShmaWxlUGF0aCwgdGV4dERhdGEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHsgc3VjY2Vzczogc3VjY2VzcyB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1ZGUyBTYXZlIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07DQogICAgfQ0KfQ0KDQovLyBFeHBvcnQgdG8gZ2xvYmFsIHNjb3BlDQp3aW5kb3cuaHR0cEV4ZWN1dG9ycyA9IHsNCiAgICBleGVjdXRlSHR0cE5vZGUsDQogICAgZXhlY3V0ZVZmc0xvYWROb2RlLA0KICAgIGV4ZWN1dGVWZnNTYXZlTm9kZQ0KfTsNCg0KLy8gSW1hZ2UgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUltYWdlTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBtYXhQcmV2aWV3U2l6ZSA9IG5vZGUuY29uZmlnLm1heF9wcmV2aWV3X3NpemUudmFsdWU7DQogICAgY29uc3Qgc2hvd0luZm8gPSBub2RlLmNvbmZpZy5zaG93X2luZm8udmFsdWUgPT09ICd0cnVlJzsNCg0KICAgIGxldCBpbWFnZURhdGEgPSBpbnB1dERhdGEuaW1hZ2VfZGF0YTsNCiAgICBsZXQgaW1hZ2VVcmwgPSBudWxsOw0KICAgIGxldCBpbWFnZUluZm8gPSBudWxsOw0KDQogICAgLy8gSGFuZGxlIGRpZmZlcmVudCB0eXBlcyBvZiBpbWFnZSBkYXRhDQogICAgaWYgKGltYWdlRGF0YSBpbnN0YW5jZW9mIEJsb2IpIHsNCiAgICAgICAgLy8gQ3JlYXRlIG9iamVjdCBVUkwgZm9yIEJsb2IgZGF0YQ0KICAgICAgICBpbWFnZVVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoaW1hZ2VEYXRhKTsNCiAgICAgICAgaW1hZ2VJbmZvID0gew0KICAgICAgICAgICAgdHlwZTogaW1hZ2VEYXRhLnR5cGUgfHwgJ2ltYWdlJywNCiAgICAgICAgICAgIHNpemU6IGltYWdlRGF0YS5zaXplDQogICAgICAgIH07DQogICAgfSBlbHNlIGlmICh0eXBlb2YgaW1hZ2VEYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAvLyBDaGVjayBpZiBpdCdzIGJhc2U2NCBkYXRhDQogICAgICAgIGlmIChpbWFnZURhdGEuc3RhcnRzV2l0aCgnZGF0YTppbWFnZS8nKSB8fCBpbWFnZURhdGEuc3RhcnRzV2l0aCgnZGF0YTphcHBsaWNhdGlvbi8nKSkgew0KICAgICAgICAgICAgLy8gQWxyZWFkeSBhIGRhdGEgVVJMDQogICAgICAgICAgICBpbWFnZVVybCA9IGltYWdlRGF0YTsNCiAgICAgICAgfSBlbHNlIGlmIChpbWFnZURhdGEubWF0Y2goL15bQS1aYS16MC05Ky9dKj17MCwyfSQvKSkgew0KICAgICAgICAgICAgLy8gTG9va3MgbGlrZSBiYXNlNjQgZGF0YSwgY29udmVydCB0byBkYXRhIFVSTA0KICAgICAgICAgICAgLy8gVHJ5IHRvIGRldGVjdCBpbWFnZSB0eXBlIGZyb20gdGhlIGRhdGENCiAgICAgICAgICAgIGNvbnN0IGltYWdlVHlwZSA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZGV0ZWN0SW1hZ2VUeXBlRnJvbUJhc2U2NChpbWFnZURhdGEpOw0KICAgICAgICAgICAgaW1hZ2VVcmwgPSBgZGF0YToke2ltYWdlVHlwZX07YmFzZTY0LCR7aW1hZ2VEYXRhfWA7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBBc3N1bWUgaXQncyBhIHJlZ3VsYXIgVVJMDQogICAgICAgICAgICBpbWFnZVVybCA9IGltYWdlRGF0YTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSBpZiAoaW1hZ2VEYXRhICYmIHR5cGVvZiBpbWFnZURhdGEgPT09ICdvYmplY3QnKSB7DQogICAgICAgIC8vIEhhbmRsZSBvYmplY3Qgd2l0aCBpbWFnZSBkYXRhDQogICAgICAgIGlmIChpbWFnZURhdGEudXJsKSB7DQogICAgICAgICAgICBpbWFnZVVybCA9IGltYWdlRGF0YS51cmw7DQogICAgICAgIH0gZWxzZSBpZiAoaW1hZ2VEYXRhLmRhdGEpIHsNCiAgICAgICAgICAgIGltYWdlVXJsID0gaW1hZ2VEYXRhLmRhdGE7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaW1hZ2VEYXRhLmluZm8pIHsNCiAgICAgICAgICAgIGltYWdlSW5mbyA9IGltYWdlRGF0YS5pbmZvOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gTm90ZTogUmVtb3ZlZCBpbWFnZSBkaW1lbnNpb24gZGV0ZWN0aW9uIGFzIGl0J3Mgbm90IG5lZWRlZA0KDQogICAgLy8gU3RvcmUgaW1hZ2UgZGF0YSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICBub2RlLmxhc3RJbWFnZURhdGEgPSBpbWFnZURhdGE7DQogICAgbm9kZS5sYXN0SW1hZ2VVcmwgPSBpbWFnZVVybDsNCiAgICBub2RlLmxhc3RJbWFnZUluZm8gPSBpbWFnZUluZm87DQoNCiAgICByZXR1cm4gew0KICAgICAgICBpbWFnZV9kYXRhOiBpbWFnZURhdGEsDQogICAgICAgIGltYWdlX3VybDogaW1hZ2VVcmwsDQogICAgICAgIGltYWdlX2luZm86IGltYWdlSW5mbywNCiAgICAgICAgZGF0YTogaW1hZ2VEYXRhDQogICAgfTsNCn0NCg0KLy8gQXVkaW8gTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUF1ZGlvTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBhdXRvUGxheSA9IG5vZGUuY29uZmlnLmF1dG9QbGF5LnZhbHVlID09PSAndHJ1ZSc7DQogICAgY29uc3Qgdm9sdW1lID0gcGFyc2VGbG9hdChub2RlLmNvbmZpZy52b2x1bWUudmFsdWUpOw0KDQogICAgbGV0IGF1ZGlvRGF0YSA9IGlucHV0RGF0YS5hdWRpb19kYXRhOw0KDQoNCiAgICBpZiAoIWF1ZGlvRGF0YSkgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGF1ZGlvIGRhdGEgcHJvdmlkZWQnKTsNCiAgICB9DQoNCiAgICAvLyBTdG9yZSBhdWRpbyBkYXRhIGZvciBtYW51YWwgcGxheSBidXR0b24gc3lzdGVtIChsaWtlIG9sZCBzeXN0ZW0pDQogICAgbm9kZS5hdWRpb0RhdGEgPSBhdWRpb0RhdGE7DQogICAgbm9kZS52b2x1bWUgPSB2b2x1bWU7DQoNCiAgICAvLyBDcmVhdGUgYXVkaW8gZWxlbWVudCBpZiBpdCBkb2Vzbid0IGV4aXN0IChsaWtlIG9sZCBzeXN0ZW0pDQogICAgaWYgKCFub2RlLmF1ZGlvRWxlbWVudCkgew0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudCA9IG5ldyBBdWRpbygpOw0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5jb250cm9scyA9IHRydWU7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnN0eWxlLndpZHRoID0gJzEwMCUnOw0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zdHlsZS5tYXJnaW5Ub3AgPSAnMTBweCc7DQogICAgfQ0KDQogICAgLy8gU2V0IGF1ZGlvIHNvdXJjZSAobGlrZSBvbGQgc3lzdGVtKQ0KICAgIGlmIChhdWRpb0RhdGEgaW5zdGFuY2VvZiBCbG9iKSB7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYXVkaW9EYXRhKTsNCiAgICB9IGVsc2UgaWYgKHR5cGVvZiBhdWRpb0RhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgIGlmIChhdWRpb0RhdGEuc3RhcnRzV2l0aCgnZGF0YTphdWRpby8nKSB8fCBhdWRpb0RhdGEuc3RhcnRzV2l0aCgnZGF0YTphcHBsaWNhdGlvbi8nKSkgew0KICAgICAgICAgICAgLy8gQWxyZWFkeSBhIGRhdGEgVVJMDQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zcmMgPSBhdWRpb0RhdGE7DQogICAgICAgIH0gZWxzZSBpZiAoYXVkaW9EYXRhLm1hdGNoKC9eW0EtWmEtejAtOSsvXSo9ezAsMn0kLykpIHsNCiAgICAgICAgICAgIC8vIExvb2tzIGxpa2UgYmFzZTY0IGRhdGEsIGNvbnZlcnQgdG8gZGF0YSBVUkwNCiAgICAgICAgICAgIGNvbnN0IGF1ZGlvVHlwZSA9ICdhdWRpby9tcGVnJzsgLy8gRGVmYXVsdCB0byBNUDMsIGNvdWxkIGJlIGVuaGFuY2VkIHRvIGRldGVjdCB0eXBlDQogICAgICAgICAgICBjb25zdCBkYXRhVXJsID0gYGRhdGE6JHthdWRpb1R5cGV9O2Jhc2U2NCwke2F1ZGlvRGF0YX1gOw0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gZGF0YVVybDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIEFzc3VtZSBpdCdzIGEgcmVndWxhciBVUkwNCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnNyYyA9IGF1ZGlvRGF0YTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnNyYyA9IGF1ZGlvRGF0YTsNCiAgICB9DQoNCiAgICAvLyBTZXQgdm9sdW1lDQogICAgbm9kZS5hdWRpb0VsZW1lbnQudm9sdW1lID0gdm9sdW1lOw0KDQogICAgLy8gU3RvcmUgZm9yIGNvbmZpZyBwYW5lbCBjb21wYXRpYmlsaXR5DQogICAgbm9kZS5sYXN0QXVkaW9EYXRhID0gYXVkaW9EYXRhOw0KICAgIG5vZGUubGFzdEF1ZGlvVXJsID0gbm9kZS5hdWRpb0VsZW1lbnQuc3JjOw0KDQogICAgLy8gQXV0by1wbGF5IGlmIGNvbmZpZ3VyZWQNCiAgICBpZiAoYXV0b1BsYXkpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGF3YWl0IG5vZGUuYXVkaW9FbGVtZW50LnBsYXkoKTsNCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0F1dG8tcGxheSBmYWlsZWQ6JywgZXJyb3IpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gQ29udmVydCBhdWRpbyBkYXRhIHRvIHByb3BlciBkYXRhIFVSTCBmb3IgVkZTIFNhdmUNCiAgICBsZXQgZGF0YVVybEZvclNhdmUgPSBudWxsOw0KDQogICAgaWYgKGF1ZGlvRGF0YSBpbnN0YW5jZW9mIEJsb2IpIHsNCiAgICAgICAgLy8gQ29udmVydCBCbG9iIHRvIGRhdGEgVVJMDQogICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7DQogICAgICAgIGRhdGFVcmxGb3JTYXZlID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gew0KICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9ICgpID0+IHJlc29sdmUocmVhZGVyLnJlc3VsdCk7DQogICAgICAgICAgICByZWFkZXIub25lcnJvciA9IHJlamVjdDsNCiAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGF1ZGlvRGF0YSk7DQogICAgICAgIH0pOw0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGF1ZGlvRGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgaWYgKGF1ZGlvRGF0YS5zdGFydHNXaXRoKCdkYXRhOmF1ZGlvLycpIHx8IGF1ZGlvRGF0YS5zdGFydHNXaXRoKCdkYXRhOmFwcGxpY2F0aW9uLycpKSB7DQogICAgICAgICAgICAvLyBBbHJlYWR5IGEgZGF0YSBVUkwNCiAgICAgICAgICAgIGRhdGFVcmxGb3JTYXZlID0gYXVkaW9EYXRhOw0KICAgICAgICB9IGVsc2UgaWYgKGF1ZGlvRGF0YS5tYXRjaCgvXltBLVphLXowLTkrL10qPXswLDJ9JC8pKSB7DQogICAgICAgICAgICAvLyBCYXNlNjQgZGF0YSwgY29udmVydCB0byBkYXRhIFVSTA0KICAgICAgICAgICAgY29uc3QgYXVkaW9UeXBlID0gJ2F1ZGlvL21wZWcnOyAvLyBEZWZhdWx0IHRvIE1QMywgY291bGQgYmUgZW5oYW5jZWQgdG8gZGV0ZWN0IHR5cGUNCiAgICAgICAgICAgIGRhdGFVcmxGb3JTYXZlID0gYGRhdGE6JHthdWRpb1R5cGV9O2Jhc2U2NCwke2F1ZGlvRGF0YX1gOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gUmVndWxhciBVUkwsIGtlZXAgYXMgaXMNCiAgICAgICAgICAgIGRhdGFVcmxGb3JTYXZlID0gYXVkaW9EYXRhOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gRmFsbGJhY2sNCiAgICAgICAgZGF0YVVybEZvclNhdmUgPSBhdWRpb0RhdGE7DQogICAgfQ0KDQogICAgcmV0dXJuIHsNCiAgICAgICAgYXVkaW9fZGF0YTogYXVkaW9EYXRhLA0KICAgICAgICBhdWRpb191cmw6IG5vZGUuYXVkaW9FbGVtZW50LnNyYywNCiAgICAgICAgZGF0YTogZGF0YVVybEZvclNhdmUgIC8vIFJldHVybiB0aGUgYWN0dWFsIGF1ZGlvIGRhdGEgYXMgZGF0YSBVUkwNCiAgICB9Ow0KfQ0KDQovLyBFeHBvcnQgdG8gZ2xvYmFsIHNjb3BlDQp3aW5kb3cubWVkaWFFeGVjdXRvcnMgPSB7DQogICAgZXhlY3V0ZUltYWdlTm9kZSwNCiAgICBleGVjdXRlQXVkaW9Ob2RlDQp9Ow0KDQoNCi8vIFRpbWVyIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVUaW1lck5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgaW50ZXJ2YWwgPSBub2RlLmNvbmZpZy5pbnRlcnZhbC52YWx1ZTsNCiAgICBjb25zdCBjb3VudCA9IG5vZGUuY29uZmlnLmNvdW50LnZhbHVlOw0KDQogICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7DQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKTsNCiAgICAgICAgICAgIHJlc29sdmUoew0KICAgICAgICAgICAgICAgIHRyaWdnZXI6IHRpbWVzdGFtcCwNCiAgICAgICAgICAgICAgICBvcmlnaW5hbF9kYXRhOiB0aW1lc3RhbXAsDQogICAgICAgICAgICAgICAgcHJvY2Vzc2VkX2RhdGE6IHRpbWVzdGFtcCwNCiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IHRpbWVzdGFtcCwNCiAgICAgICAgICAgICAgICBlbGFwc2VkOiBpbnRlcnZhbA0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0sIGludGVydmFsKTsNCiAgICB9KTsNCn0NCg0KLy8gRGlzcGxheSBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlRGlzcGxheU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgZm9ybWF0ID0gbm9kZS5jb25maWcuZm9ybWF0LnZhbHVlOw0KICAgIGNvbnN0IG1heExlbmd0aCA9IG5vZGUuY29uZmlnLm1heExlbmd0aC52YWx1ZTsNCiAgICBjb25zdCBpbnB1dFBvcnQgPSBub2RlLmNvbmZpZy5pbnB1dF9wb3J0Py52YWx1ZSB8fCAnYXV0byc7DQoNCiAgICAvLyBUcnkgdG8gZmluZCBjb250ZW50IGJhc2VkIG9uIGNvbmZpZ3VyZWQgaW5wdXQgcG9ydCBvciBhdXRvLWRldGVjdA0KICAgIGxldCBjb250ZW50ID0gbnVsbDsNCg0KICAgIGlmIChpbnB1dFBvcnQgIT09ICdhdXRvJykgew0KICAgICAgICAvLyBVc2UgdGhlIHNwZWNpZmllZCBpbnB1dCBwb3J0DQogICAgICAgIGNvbnRlbnQgPSBpbnB1dERhdGFbaW5wdXRQb3J0XTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBBdXRvLWRldGVjdDogUHJpb3JpdHkgb3JkZXI6IHRleHQsIGpzb24sIGRhdGEsIGJpbmFyeQ0KICAgICAgICBpZiAoaW5wdXREYXRhLnRleHQgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgY29udGVudCA9IGlucHV0RGF0YS50ZXh0Ow0KICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS5qc29uICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBpbnB1dERhdGEuanNvbjsNCiAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGEuZGF0YSAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBjb250ZW50ID0gaW5wdXREYXRhLmRhdGE7DQogICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLmJpbmFyeSAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBjb250ZW50ID0gaW5wdXREYXRhLmJpbmFyeTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIFVzZSB0aGUgZmlyc3QgYXZhaWxhYmxlIGlucHV0DQogICAgICAgICAgICBjb25zdCBmaXJzdElucHV0ID0gT2JqZWN0LnZhbHVlcyhpbnB1dERhdGEpWzBdOw0KICAgICAgICAgICAgY29udGVudCA9IGZpcnN0SW5wdXQ7DQogICAgICAgIH0NCiAgICB9DQoNCg0KICAgIC8vIE9ubHkgY29udmVydCB0byBKU09OIHN0cmluZyBpZiBmb3JtYXQgaXMgJ2pzb24nIG9yIGlmIGl0J3MgYW4gb2JqZWN0IGFuZCBmb3JtYXQgaXMgbm90IHNwZWNpZmllZA0KICAgIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ29iamVjdCcgJiYgZm9ybWF0ID09PSAnanNvbicpIHsNCiAgICAgICAgY29udGVudCA9IEpTT04uc3RyaW5naWZ5KGNvbnRlbnQsIG51bGwsIDIpOw0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdvYmplY3QnICYmIGZvcm1hdCA9PT0gJ3RleHQnKSB7DQogICAgICAgIC8vIEZvciB0ZXh0IGZvcm1hdCwgZXh0cmFjdCB0aGUgYWN0dWFsIHZhbHVlIGZyb20gY29tbW9uIGZpZWxkcw0KICAgICAgICBpZiAoY29udGVudCA9PT0gbnVsbCkgew0KICAgICAgICAgICAgY29udGVudCA9ICdudWxsJzsNCiAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGNvbnRlbnQpKSB7DQogICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5qb2luKCcsICcpOw0KICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnb2JqZWN0Jykgew0KICAgICAgICAgICAgLy8gTG9vayBmb3IgdGhlIGFjdHVhbCB2YWx1ZSBpbiBjb21tb24gZmllbGRzDQogICAgICAgICAgICBpZiAoY29udGVudC5leHRyYWN0ZWRfdmFsdWUgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBTdHJpbmcoY29udGVudC5leHRyYWN0ZWRfdmFsdWUpOw0KICAgICAgICAgICAgfSBlbHNlIGlmIChjb250ZW50LnZhbHVlICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICBjb250ZW50ID0gU3RyaW5nKGNvbnRlbnQudmFsdWUpOw0KICAgICAgICAgICAgfSBlbHNlIGlmIChjb250ZW50LnRleHQgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBTdHJpbmcoY29udGVudC50ZXh0KTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGVudC5kYXRhICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICBjb250ZW50ID0gU3RyaW5nKGNvbnRlbnQuZGF0YSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8vIElmIG5vIGNvbW1vbiBmaWVsZHMgZm91bmQsIGp1c3Qgc2hvdyB0aGUgZmlyc3QgdmFsdWUNCiAgICAgICAgICAgICAgICBjb25zdCBmaXJzdFZhbHVlID0gT2JqZWN0LnZhbHVlcyhjb250ZW50KVswXTsNCiAgICAgICAgICAgICAgICBjb250ZW50ID0gU3RyaW5nKGZpcnN0VmFsdWUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKGNvbnRlbnQgJiYgY29udGVudC5sZW5ndGggPiBtYXhMZW5ndGgpIHsNCiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3Vic3RyaW5nKDAsIG1heExlbmd0aCkgKyAnLi4uJzsNCiAgICB9DQoNCiAgICAvLyBVcGRhdGUgZGlzcGxheSBub2RlIGNvbnRlbnQNCiAgICB1cGRhdGVEaXNwbGF5Tm9kZUNvbnRlbnQobm9kZS5pZCwgY29udGVudCwgZm9ybWF0KTsNCg0KICAgIHJldHVybiB7DQogICAgICAgIG9yaWdpbmFsX2RhdGE6IGNvbnRlbnQsDQogICAgICAgIGRpc3BsYXllZDogY29udGVudCwNCiAgICAgICAgcHJvY2Vzc2VkX2RhdGE6IGNvbnRlbnQNCiAgICB9Ow0KfQ0KDQoNCi8vIFJlcGVhdGVyIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVSZXBlYXRlck5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgaW50ZXJ2YWwgPSBwYXJzZUludChub2RlLmNvbmZpZy5pbnRlcnZhbC52YWx1ZSk7DQogICAgY29uc3QgY291bnQgPSBwYXJzZUludChub2RlLmNvbmZpZy5jb3VudC52YWx1ZSk7DQoNCiAgICAvLyBJbml0aWFsaXplIHJlcGVhdGVyIHN0YXRlIGlmIG5vdCBleGlzdHMNCiAgICBpZiAoIW5vZGUucmVwZWF0ZXJTdGF0ZSkgew0KICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUgPSB7DQogICAgICAgICAgICBjb3VudDogMCwNCiAgICAgICAgICAgIGludGVydmFsOiBudWxsLA0KICAgICAgICAgICAgaXNSdW5uaW5nOiBmYWxzZQ0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgIC8vIElmIHRoaXMgaXMgYSBtYW51YWwgdHJpZ2dlciAobm90IGZyb20gaW50ZXJ2YWwpLCBzdGFydCB0aGUgcmVwZWF0ZXINCiAgICBpZiAoIW5vZGUucmVwZWF0ZXJTdGF0ZS5pc1J1bm5pbmcpIHsNCiAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmlzUnVubmluZyA9IHRydWU7DQogICAgICAgIG5vZGUucmVwZWF0ZXJTdGF0ZS5jb3VudCA9IDA7DQoNCiAgICAgICAgLy8gU3RhcnQgdGhlIGludGVydmFsDQogICAgICAgIG5vZGUucmVwZWF0ZXJTdGF0ZS5pbnRlcnZhbCA9IHNldEludGVydmFsKGFzeW5jICgpID0+IHsNCiAgICAgICAgICAgIG5vZGUucmVwZWF0ZXJTdGF0ZS5jb3VudCsrOw0KDQogICAgICAgICAgICAvLyBFeGVjdXRlIHRoZSBjb25uZWN0ZWQgd29ya2Zsb3cNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGVkTm9kZXMgPSBmaW5kQ29ubmVjdGVkTm9kZXMobm9kZS5pZCk7DQogICAgICAgICAgICAgICAgY29uc3QgZXhlY3V0ZWQgPSBuZXcgU2V0KCk7DQoNCiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3RlZE5vZGUgb2YgY29ubmVjdGVkTm9kZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXhlY3V0ZU5vZGUoY29ubmVjdGVkTm9kZS5ub2RlLCB7IHRyaWdnZXI6IERhdGUubm93KCkgfSwgZXhlY3V0ZWQpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZXhlY3V0aW5nIHJlcGVhdGVyIHdvcmtmbG93OicsIGVycm9yKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gU3RvcCBpZiBjb3VudCBsaW1pdCByZWFjaGVkDQogICAgICAgICAgICBpZiAoY291bnQgPiAwICYmIG5vZGUucmVwZWF0ZXJTdGF0ZS5jb3VudCA+PSBjb3VudCkgew0KICAgICAgICAgICAgICAgIGVuZ2luZS5zdG9wUmVwZWF0ZXIobm9kZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sIGludGVydmFsKTsNCiAgICB9DQoNCiAgICByZXR1cm4geyB0cmlnZ2VyOiBEYXRlLm5vdygpLCBjb3VudDogbm9kZS5yZXBlYXRlclN0YXRlLmNvdW50LCBpc1J1bm5pbmc6IG5vZGUucmVwZWF0ZXJTdGF0ZS5pc1J1bm5pbmcgfTsNCn0NCg0KLy8gQ29uZGl0aW9uIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVDb25kaXRpb25Ob2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IG9wZXJhdG9yID0gbm9kZS5jb25maWcub3BlcmF0b3IudmFsdWU7DQogICAgY29uc3QgY29tcGFyZVZhbHVlID0gbm9kZS5jb25maWcuY29tcGFyZV92YWx1ZS52YWx1ZTsNCiAgICBjb25zdCBjYXNlU2Vuc2l0aXZlID0gbm9kZS5jb25maWcuY2FzZV9zZW5zaXRpdmUudmFsdWUgPT09ICd0cnVlJzsNCg0KICAgIGxldCBpbnB1dFZhbHVlID0gaW5wdXREYXRhLnZhbHVlOw0KICAgIGxldCByZXN1bHQgPSBmYWxzZTsNCg0KICAgIC8vIENvbnZlcnQgaW5wdXQgdG8gc3RyaW5nIGZvciBjb21wYXJpc29uIGlmIG5lZWRlZA0KICAgIGxldCBpbnB1dFN0ciA9IFN0cmluZyhpbnB1dFZhbHVlKTsNCiAgICBsZXQgY29tcGFyZVN0ciA9IFN0cmluZyhjb21wYXJlVmFsdWUpOw0KDQogICAgLy8gRGVidWcgbG9nZ2luZyBmb3Igc3RyaW5nIGNvbXBhcmlzb25zDQoNCiAgICAvLyBIYW5kbGUgY2FzZSBzZW5zaXRpdml0eQ0KICAgIGlmICghY2FzZVNlbnNpdGl2ZSkgew0KICAgICAgICBpbnB1dFN0ciA9IGlucHV0U3RyLnRvTG93ZXJDYXNlKCk7DQogICAgICAgIGNvbXBhcmVTdHIgPSBjb21wYXJlU3RyLnRvTG93ZXJDYXNlKCk7DQogICAgfQ0KDQogICAgLy8gUGVyZm9ybSBjb21wYXJpc29uIGJhc2VkIG9uIG9wZXJhdG9yDQogICAgc3dpdGNoIChvcGVyYXRvcikgew0KICAgICAgICBjYXNlICdlcXVhbHMnOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIgPT09IGNvbXBhcmVTdHI7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnbm90X2VxdWFscyc6DQogICAgICAgICAgICByZXN1bHQgPSBpbnB1dFN0ciAhPT0gY29tcGFyZVN0cjsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdncmVhdGVyX3RoYW4nOg0KICAgICAgICAgICAgcmVzdWx0ID0gTnVtYmVyKGlucHV0VmFsdWUpID4gTnVtYmVyKGNvbXBhcmVWYWx1ZSk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnbGVzc190aGFuJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IE51bWJlcihpbnB1dFZhbHVlKSA8IE51bWJlcihjb21wYXJlVmFsdWUpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2dyZWF0ZXJfdGhhbl9vcl9lcXVhbCc6DQogICAgICAgICAgICByZXN1bHQgPSBOdW1iZXIoaW5wdXRWYWx1ZSkgPj0gTnVtYmVyKGNvbXBhcmVWYWx1ZSk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnbGVzc190aGFuX29yX2VxdWFsJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IE51bWJlcihpbnB1dFZhbHVlKSA8PSBOdW1iZXIoY29tcGFyZVZhbHVlKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdjb250YWlucyc6DQogICAgICAgICAgICByZXN1bHQgPSBpbnB1dFN0ci5pbmNsdWRlcyhjb21wYXJlU3RyKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdub3RfY29udGFpbnMnOg0KICAgICAgICAgICAgcmVzdWx0ID0gIWlucHV0U3RyLmluY2x1ZGVzKGNvbXBhcmVTdHIpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ3N0YXJ0c193aXRoJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IGlucHV0U3RyLnN0YXJ0c1dpdGgoY29tcGFyZVN0cik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnZW5kc193aXRoJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IGlucHV0U3RyLmVuZHNXaXRoKGNvbXBhcmVTdHIpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2lzX2VtcHR5JzoNCiAgICAgICAgICAgIHJlc3VsdCA9IGlucHV0U3RyLnRyaW0oKSA9PT0gJyc7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnaXNfbm90X2VtcHR5JzoNCiAgICAgICAgICAgIHJlc3VsdCA9IGlucHV0U3RyLnRyaW0oKSAhPT0gJyc7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlOw0KICAgIH0NCg0KICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgIG5vZGUubGFzdElucHV0VmFsdWUgPSBpbnB1dFZhbHVlOw0KICAgIG5vZGUubGFzdENvbXBhcmVWYWx1ZSA9IGNvbXBhcmVWYWx1ZTsNCiAgICBub2RlLmxhc3RSZXN1bHQgPSByZXN1bHQ7DQogICAgbm9kZS5sYXN0T3BlcmF0b3IgPSBvcGVyYXRvcjsNCg0KICAgIHJldHVybiB7IHJlc3VsdDogcmVzdWx0IH07DQp9DQoNCi8vIExvZ2ljYWwgR2F0ZSBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlTG9naWNhbEdhdGVOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGludmVydCA9IG5vZGUuY29uZmlnLmludmVydC52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gbm9kZS5jb25maWcuZGVzY3JpcHRpb24udmFsdWU7DQoNCiAgICBsZXQgY29uZGl0aW9uID0gaW5wdXREYXRhLmNvbmRpdGlvbjsNCg0KICAgIC8vIENvbnZlcnQgdG8gYm9vbGVhbiBpZiBuZWVkZWQNCiAgICBpZiAodHlwZW9mIGNvbmRpdGlvbiA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgY29uZGl0aW9uID0gY29uZGl0aW9uLnRvTG93ZXJDYXNlKCkgPT09ICd0cnVlJzsNCiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb25kaXRpb24gPT09ICdudW1iZXInKSB7DQogICAgICAgIGNvbmRpdGlvbiA9IGNvbmRpdGlvbiAhPT0gMDsNCiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb25kaXRpb24gPT09ICdvYmplY3QnKSB7DQogICAgICAgIC8vIElmIGl0J3MgYW4gb2JqZWN0IHdpdGggYSByZXN1bHQgZmllbGQgKGZyb20gY29uZGl0aW9uIG5vZGUpDQogICAgICAgIGNvbmRpdGlvbiA9IGNvbmRpdGlvbi5yZXN1bHQgPT09IHRydWU7DQogICAgfQ0KDQogICAgLy8gQXBwbHkgaW52ZXJzaW9uIGlmIGNvbmZpZ3VyZWQNCiAgICBpZiAoaW52ZXJ0KSB7DQogICAgICAgIGNvbmRpdGlvbiA9ICFjb25kaXRpb247DQogICAgfQ0KDQogICAgLy8gU3RvcmUgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgbm9kZS5sYXN0Q29uZGl0aW9uID0gY29uZGl0aW9uOw0KICAgIG5vZGUubGFzdEludmVydGVkID0gaW52ZXJ0Ow0KICAgIG5vZGUubGFzdERlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247DQoNCiAgICAvLyBPbmx5IHJldHVybiB0cmlnZ2VyIGlmIGNvbmRpdGlvbiBpcyB0cnVlDQogICAgaWYgKGNvbmRpdGlvbikgew0KICAgICAgICByZXR1cm4geyB0cmlnZ2VyOiBEYXRlLm5vdygpIH07DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gUmV0dXJuIHNwZWNpYWwgb2JqZWN0IHRvIGluZGljYXRlIGV4ZWN1dGlvbiBzaG91bGQgc3RvcA0KICAgICAgICByZXR1cm4geyBfX3N0b3BfZXhlY3V0aW9uOiB0cnVlIH07DQogICAgfQ0KfQ0KDQovLyBFeHBvcnQgdG8gZ2xvYmFsIHNjb3BlDQp3aW5kb3cuZmxvd0V4ZWN1dG9ycyA9IHsNCiAgICBleGVjdXRlVGltZXJOb2RlLA0KICAgIGV4ZWN1dGVEaXNwbGF5Tm9kZSwNCiAgICBleGVjdXRlUmVwZWF0ZXJOb2RlLA0KICAgIGV4ZWN1dGVDb25kaXRpb25Ob2RlLA0KICAgIGV4ZWN1dGVMb2dpY2FsR2F0ZU5vZGUNCn07DQoNCg0KLy8gTExNIENoYXQgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUxsbUNoYXROb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGVuZHBvaW50ID0gbm9kZS5jb25maWcuZW5kcG9pbnQudmFsdWU7DQogICAgY29uc3QgbW9kZWwgPSBub2RlLmNvbmZpZy5tb2RlbC52YWx1ZTsNCiAgICBjb25zdCB0ZW1wZXJhdHVyZSA9IHBhcnNlRmxvYXQobm9kZS5jb25maWcudGVtcGVyYXR1cmUudmFsdWUpOw0KICAgIGNvbnN0IG1heFRva2VucyA9IHBhcnNlSW50KG5vZGUuY29uZmlnLm1heF90b2tlbnMudmFsdWUpOw0KICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IG5vZGUuY29uZmlnLnN5c3RlbV9wcm9tcHQudmFsdWU7DQogICAgY29uc3QgaW5jbHVkZUNvbnRleHQgPSBub2RlLmNvbmZpZy5pbmNsdWRlX2NvbnRleHQudmFsdWUgPT09ICd0cnVlJzsNCg0KICAgIC8vIEFjY2VwdCBwcm9tcHQgZnJvbSBlaXRoZXIgJ3Byb21wdCcgb3IgJ3RleHQnIGlucHV0DQogICAgbGV0IHByb21wdCA9IGlucHV0RGF0YS5wcm9tcHQ7DQogICAgaWYgKCFwcm9tcHQgJiYgaW5wdXREYXRhLnRleHQpIHsNCiAgICAgICAgcHJvbXB0ID0gaW5wdXREYXRhLnRleHQ7DQogICAgfQ0KICAgIGlmICghcHJvbXB0ICYmIGlucHV0RGF0YS5jb250ZXh0KSB7DQogICAgICAgIC8vIElmIGNvbnRleHQgaXMgYSBzdHJpbmcsIHVzZSBpdCBhcyBwcm9tcHQNCiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dERhdGEuY29udGV4dCA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIHByb21wdCA9IGlucHV0RGF0YS5jb250ZXh0Ow0KICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS5jb250ZXh0ICYmIHR5cGVvZiBpbnB1dERhdGEuY29udGV4dCA9PT0gJ29iamVjdCcgJiYgaW5wdXREYXRhLmNvbnRleHQudGV4dCkgew0KICAgICAgICAgICAgLy8gSWYgY29udGV4dCBpcyBhbiBvYmplY3Qgd2l0aCB0ZXh0IGZpZWxkLCB1c2UgdGhhdA0KICAgICAgICAgICAgcHJvbXB0ID0gaW5wdXREYXRhLmNvbnRleHQudGV4dDsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBpZiAoIXByb21wdCkgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xMTSBDaGF0IHJlcXVpcmVzIGEgcHJvbXB0IGlucHV0LiBDb25uZWN0IGEgVGV4dCBub2RlIHRvIHByb3ZpZGUgdGhlIHByb21wdC4nKTsNCiAgICB9DQoNCiAgICB0cnkgew0KICAgICAgICBjb25zdCBtZXNzYWdlcyA9IFtdOw0KDQogICAgICAgIGlmIChzeXN0ZW1Qcm9tcHQpIHsNCiAgICAgICAgICAgIG1lc3NhZ2VzLnB1c2goeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH0pOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGluY2x1ZGVDb250ZXh0ICYmIGlucHV0RGF0YS5jb250ZXh0KSB7DQogICAgICAgICAgICBtZXNzYWdlcy5wdXNoKHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiBgQ29udGV4dDogJHtKU09OLnN0cmluZ2lmeShpbnB1dERhdGEuY29udGV4dCl9XG5cblByb21wdDogJHtwcm9tcHR9YCB9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIG1lc3NhZ2VzLnB1c2goeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9KTsNCiAgICAgICAgfQ0KDQogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7ZW5kcG9pbnR9L2NoYXQvY29tcGxldGlvbnNgLCB7DQogICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywNCiAgICAgICAgICAgIGhlYWRlcnM6IHsNCiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoew0KICAgICAgICAgICAgICAgIG1vZGVsOiBtb2RlbCwNCiAgICAgICAgICAgICAgICBtZXNzYWdlczogbWVzc2FnZXMsDQogICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHRlbXBlcmF0dXJlLA0KICAgICAgICAgICAgICAgIG1heF90b2tlbnM6IG1heFRva2Vucw0KICAgICAgICAgICAgfSkNCiAgICAgICAgfSk7DQoNCiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsNCg0KICAgICAgICBpZiAoZGF0YS5lcnJvcikgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGRhdGEuZXJyb3IubWVzc2FnZSB8fCAnTExNIEFQSSBlcnJvcicpOw0KICAgICAgICB9DQoNCiAgICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gZGF0YS5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8ICcnOw0KDQogICAgICAgIC8vIFN0b3JlIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgICAgICBub2RlLmxhc3RSZXNwb25zZSA9IHJlc3BvbnNlVGV4dDsNCiAgICAgICAgbm9kZS5sYXN0VXNhZ2UgPSBkYXRhLnVzYWdlOw0KICAgICAgICBub2RlLmxhc3RNb2RlbCA9IG1vZGVsOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICByZXNwb25zZTogcmVzcG9uc2VUZXh0LA0KICAgICAgICAgICAgdG9rZW5zX3VzZWQ6IGRhdGEudXNhZ2U/LnRvdGFsX3Rva2VucyB8fCAwLA0KICAgICAgICAgICAgbW9kZWxfdXNlZDogbW9kZWwsDQogICAgICAgICAgICBmdWxsX3Jlc3BvbnNlOiBkYXRhDQogICAgICAgIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTExNIENoYXQgZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4geyByZXNwb25zZTogbnVsbCwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTsNCiAgICB9DQp9DQoNCg0KLy8gVGVybWluYWwgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVRlcm1pbmFsTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBjb21tYW5kID0gbm9kZS5jb25maWcuY29tbWFuZC52YWx1ZTsNCiAgICBjb25zdCB1c2VJbnB1dENvbW1hbmQgPSBub2RlLmNvbmZpZy51c2VfaW5wdXRfY29tbWFuZC52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IHdvcmtpbmdEaXJlY3RvcnkgPSBub2RlLmNvbmZpZy53b3JraW5nX2RpcmVjdG9yeS52YWx1ZTsNCiAgICBjb25zdCB0aW1lb3V0ID0gcGFyc2VJbnQobm9kZS5jb25maWcudGltZW91dC52YWx1ZSk7DQoNCiAgICBsZXQgZmluYWxDb21tYW5kID0gY29tbWFuZDsNCiAgICBpZiAodXNlSW5wdXRDb21tYW5kICYmIGlucHV0RGF0YS5jb21tYW5kKSB7DQogICAgICAgIGZpbmFsQ29tbWFuZCA9IGlucHV0RGF0YS5jb21tYW5kOw0KICAgIH0NCg0KICAgIHRyeSB7DQogICAgICAgIC8vIFRoaXMgd291bGQgbmVlZCB0byBiZSBpbXBsZW1lbnRlZCB3aXRoIGFjdHVhbCB0ZXJtaW5hbCBleGVjdXRpb24NCiAgICAgICAgLy8gRm9yIG5vdywgd2UnbGwgcmV0dXJuIGEgcGxhY2Vob2xkZXINCg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgb3V0cHV0OiBgQ29tbWFuZCBleGVjdXRlZDogJHtmaW5hbENvbW1hbmR9YCwNCiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsDQogICAgICAgICAgICBlcnJvcjogbnVsbCwNCiAgICAgICAgICAgIGV4aXRfY29kZTogMA0KICAgICAgICB9Ow0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Rlcm1pbmFsIGV4ZWN1dGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBvdXRwdXQ6IG51bGwsDQogICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwNCiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLA0KICAgICAgICAgICAgZXhpdF9jb2RlOiAxDQogICAgICAgIH07DQogICAgfQ0KfQ0KDQovLyBFeHBvcnQgdG8gZ2xvYmFsIHNjb3BlDQp3aW5kb3cuYWlFeGVjdXRvcnMgPSB7DQogICAgZXhlY3V0ZUxsbUNoYXROb2RlLA0KICAgIGV4ZWN1dGVUZXJtaW5hbE5vZGUNCn07DQoNCi8vIGV4ZWN1dGlvbi1lbmdpbmUuanMgLSBEeW5hbWljIGV4ZWN1dGlvbiBlbmdpbmUgZm9yIEZsb3cgRWRpdG9yDQoNCmNsYXNzIEV4ZWN1dGlvbkVuZ2luZSB7DQogICAgY29uc3RydWN0b3IocmVnaXN0cnkpIHsNCiAgICAgICAgdGhpcy5yZWdpc3RyeSA9IHJlZ2lzdHJ5Ow0KICAgICAgICB0aGlzLnNldHVwRXhlY3V0b3JzKCk7DQogICAgfQ0KDQogICAgc2V0dXBFeGVjdXRvcnMoKSB7DQogICAgICAgIC8vIFJlZ2lzdGVyIGV4ZWN1dG9ycyBmcm9tIGV4dGVybmFsIGZpbGVzIHdpdGggZW5naW5lIGluc3RhbmNlIHBhc3NlZCBhcyBmaXJzdCBwYXJhbWV0ZXINCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdodHRwX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93Lmh0dHBFeGVjdXRvcnMuZXhlY3V0ZUh0dHBOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd2ZnNfc2F2ZV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5odHRwRXhlY3V0b3JzLmV4ZWN1dGVWZnNTYXZlTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigndmZzX2xvYWRfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuaHR0cEV4ZWN1dG9ycy5leGVjdXRlVmZzTG9hZE5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICAgICAgDQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigndGltZXJfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZmxvd0V4ZWN1dG9ycy5leGVjdXRlVGltZXJOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdkaXNwbGF5X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmZsb3dFeGVjdXRvcnMuZXhlY3V0ZURpc3BsYXlOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdyZXBlYXRlcl9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5mbG93RXhlY3V0b3JzLmV4ZWN1dGVSZXBlYXRlck5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2NvbmRpdGlvbl9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5mbG93RXhlY3V0b3JzLmV4ZWN1dGVDb25kaXRpb25Ob2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdsb2dpY2FsX2dhdGVfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZmxvd0V4ZWN1dG9ycy5leGVjdXRlTG9naWNhbEdhdGVOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgICAgIA0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2F1ZGlvX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93Lm1lZGlhRXhlY3V0b3JzLmV4ZWN1dGVBdWRpb05vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2ltYWdlX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93Lm1lZGlhRXhlY3V0b3JzLmV4ZWN1dGVJbWFnZU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICAgICAgDQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignanNvbl9leHRyYWN0X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmRhdGFFeGVjdXRvcnMuZXhlY3V0ZUpzb25FeHRyYWN0Tm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigncmFuZG9tX2xpbmVfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZGF0YUV4ZWN1dG9ycy5leGVjdXRlUmFuZG9tUXVvdGVOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd0ZXh0X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmRhdGFFeGVjdXRvcnMuZXhlY3V0ZVRleHROb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdtYXRoX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmRhdGFFeGVjdXRvcnMuZXhlY3V0ZU1hdGhOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdhcnJheV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVBcnJheU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3N0cmluZ19leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVTdHJpbmdOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgICAgIA0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2xsbV9jaGF0X2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmFpRXhlY3V0b3JzLmV4ZWN1dGVMbG1DaGF0Tm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcigndGVybWluYWxfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuYWlFeGVjdXRvcnMuZXhlY3V0ZVRlcm1pbmFsTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgfQ0KDQogICAgYXN5bmMgZXhlY3V0ZU5vZGUobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgICAgICBjb25zdCBub2RlRGVmID0gdGhpcy5yZWdpc3RyeS5nZXROb2RlVHlwZShub2RlLnR5cGUpOw0KICAgICAgICBpZiAoIW5vZGVEZWYpIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gbm9kZSBkZWZpbml0aW9uIGZvdW5kIGZvciB0eXBlOiAke25vZGUudHlwZX1gKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGNvbnN0IGV4ZWN1dG9yTmFtZSA9IG5vZGVEZWYuZXhlY3V0b3I7DQogICAgICAgIGNvbnN0IGV4ZWN1dG9yID0gdGhpcy5yZWdpc3RyeS5nZXRFeGVjdXRvcihleGVjdXRvck5hbWUpOw0KDQogICAgICAgIGlmICghZXhlY3V0b3IpIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gZXhlY3V0b3IgZm91bmQgZm9yOiAke2V4ZWN1dG9yTmFtZX1gKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBhd2FpdCBleGVjdXRvcihub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKTsNCiAgICB9DQoNCg0KDQogICAgLy8gU3RvcCByZXBlYXRlciBtZXRob2QNCiAgICBzdG9wUmVwZWF0ZXIobm9kZSkgew0KICAgICAgICBpZiAobm9kZS5yZXBlYXRlclN0YXRlICYmIG5vZGUucmVwZWF0ZXJTdGF0ZS5pbnRlcnZhbCkgew0KICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChub2RlLnJlcGVhdGVyU3RhdGUuaW50ZXJ2YWwpOw0KICAgICAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmludGVydmFsID0gbnVsbDsNCiAgICAgICAgICAgIG5vZGUucmVwZWF0ZXJTdGF0ZS5pc1J1bm5pbmcgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KDQoNCg0KfQ0KDQovLyBHbG9iYWwgZXhlY3V0aW9uIGVuZ2luZSBpbnN0YW5jZQ0KY29uc3QgZXhlY3V0aW9uRW5naW5lID0gbmV3IEV4ZWN1dGlvbkVuZ2luZShub2RlUmVnaXN0cnkpOw0KDQoNCi8vIHdvcmtmbG93LmpzIC0gV29ya2Zsb3cgZXhlY3V0aW9uIGxvZ2ljIGZvciBGbG93IEVkaXRvcg0KDQovLyBSdW4gdGhlIHdvcmtmbG93DQphc3luYyBmdW5jdGlvbiBydW5Xb3JrZmxvdygpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5pc1J1bm5pbmcpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBmbG93RWRpdG9yLmlzUnVubmluZyA9IHRydWU7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3J1bi13b3JrZmxvdycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0b3Atd29ya2Zsb3cnKS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1mbGV4JzsNCiAgICANCiAgICAvLyBDbGVhciBhbGwgdmlzdWFsIHN0YXRlcyBmcm9tIHByZXZpb3VzIHJ1bnMNCiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmxvdy1ub2RlJykuZm9yRWFjaChub2RlID0+IHsNCiAgICAgICAgbm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJywgJ3dhaXRpbmctaW5wdXRzJywgJ2NvbXBsZXRlZCcsICdlcnJvcicpOw0KICAgIH0pOw0KICAgIA0KICAgIC8vIENsZWFyIG91dHB1dA0KICAgIGNvbnN0IG91dHB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleGVjdXRpb24tb3V0cHV0Jyk7DQogICAgb3V0cHV0LmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPSJsb2ctZW50cnkgaW5mbyI+U3RhcnRpbmcgd29ya2Zsb3cgZXhlY3V0aW9uLi4uPC9kaXY+JzsNCiAgICANCiAgICB0cnkgew0KICAgICAgICAvLyBGaW5kIHN0YXJ0IG5vZGVzIChub2RlcyB3aXRoIG5vIGlucHV0cyB0aGF0IGFyZSBwYXJ0IG9mIGEgY29ubmVjdGVkIHdvcmtmbG93KQ0KICAgICAgICBjb25zdCBzdGFydE5vZGVzID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLm5vZGVzLnZhbHVlcygpKS5maWx0ZXIobm9kZSA9PiB7DQogICAgICAgICAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgICAgICAgICBpZiAoIW5vZGVEZWYpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYE5vIG5vZGUgZGVmaW5pdGlvbiBmb3VuZCBmb3IgdHlwZTogJHtub2RlLnR5cGV9YCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFRpbWVyIGFuZCBSZXBlYXRlciBub2RlcyBhcmUgc3RhcnQgbm9kZXMgKGNhbiB0cmlnZ2VyIHRoZW1zZWx2ZXMpDQogICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAndGltZXInIHx8IG5vZGUudHlwZSA9PT0gJ3JlcGVhdGVyJykgew0KICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNSdW5uaW5nID0gbm9kZS5yZXBlYXRlclN0YXRlICYmIG5vZGUucmVwZWF0ZXJTdGF0ZS5pc1J1bm5pbmc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vIFRpbWVyL1JlcGVhdGVyIGlzIGEgc3RhcnQgbm9kZSBpZiBpdCBoYXMgY29ubmVjdGVkIG91dHB1dHMNCiAgICAgICAgICAgICAgICBjb25zdCBoYXNDb25uZWN0ZWRPdXRwdXRzID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5zb21lKGNvbm4gPT4gDQogICAgICAgICAgICAgICAgICAgIGNvbm4uZnJvbS5ub2RlSWQgPT09IG5vZGUuaWQNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIHJldHVybiBoYXNDb25uZWN0ZWRPdXRwdXRzOyAvLyBUaW1lci9SZXBlYXRlciBpcyBhIHN0YXJ0IG5vZGUgaWYgY29ubmVjdGVkDQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIElmIG5vZGUgaGFzIG5vIGlucHV0cywgY2hlY2sgaWYgaXQncyBwYXJ0IG9mIGEgY29ubmVjdGVkIHdvcmtmbG93DQogICAgICAgICAgICBpZiAobm9kZURlZi5pbnB1dHMubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBub2RlIGhhcyBhbnkgb3V0cHV0cyB0aGF0IGFyZSBjb25uZWN0ZWQgdG8gb3RoZXIgbm9kZXMNCiAgICAgICAgICAgICAgICBjb25zdCBoYXNDb25uZWN0ZWRPdXRwdXRzID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5zb21lKGNvbm4gPT4gDQogICAgICAgICAgICAgICAgICAgIGNvbm4uZnJvbS5ub2RlSWQgPT09IG5vZGUuaWQNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIE9ubHkgaW5jbHVkZSBpZiBpdCdzIGNvbm5lY3RlZCB0byB0aGUgd29ya2Zsb3cNCiAgICAgICAgICAgICAgICByZXR1cm4gaGFzQ29ubmVjdGVkT3V0cHV0czsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3Igbm9kZXMgd2l0aCBvcHRpb25hbCBpbnB1dHMNCiAgICAgICAgICAgIGNvbnN0IG9wdGlvbmFsSW5wdXRzID0gbm9kZURlZi5pbnB1dHMuZmlsdGVyKGlucHV0ID0+IGlucHV0Lm9wdGlvbmFsKTsNCiAgICAgICAgICAgIGlmIChvcHRpb25hbElucHV0cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBub2RlIGhhcyBjb25uZWN0ZWQgb3V0cHV0cw0KICAgICAgICAgICAgICAgIGNvbnN0IGhhc0Nvbm5lY3RlZE91dHB1dHMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLnNvbWUoY29ubiA9PiANCiAgICAgICAgICAgICAgICAgICAgY29ubi5mcm9tLm5vZGVJZCA9PT0gbm9kZS5pZA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGhhc0Nvbm5lY3RlZE91dHB1dHM7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIE5vZGVzIHdpdGggcmVxdWlyZWQgaW5wdXRzIGFyZSBub3Qgc3RhcnQgbm9kZXMgLSB0aGV5IHNob3VsZCBiZSB0cmlnZ2VyZWQgYnkgb3RoZXIgbm9kZXMNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICBpZiAoc3RhcnROb2Rlcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gc3RhcnQgbm9kZXMgZm91bmQuIEFkZCBub2RlcyB3aXRoIG5vIGlucHV0cyAoVGltZXIpIG9yIG5vZGVzIHdpdGggb3B0aW9uYWwgaW5wdXRzIHRoYXQgYXJlblwndCBjb25uZWN0ZWQgKEhUVFAgUmVxdWVzdCknKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gRXhlY3V0ZSB3b3JrZmxvdw0KICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZXhlY3V0ZVdvcmtmbG93KHN0YXJ0Tm9kZXMpOw0KICAgICAgICANCiAgICAgICAgLy8gRGlzcGxheSByZXN1bHRzDQogICAgICAgIG91dHB1dC5pbm5lckhUTUwgKz0gJzxkaXYgY2xhc3M9ImxvZy1lbnRyeSBzdWNjZXNzIj5Xb3JrZmxvdyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5ITwvZGl2Pic7DQogICAgICAgIGZvciAoY29uc3QgcmVzdWx0IG9mIHJlc3VsdHMpIHsNCiAgICAgICAgICAgIG91dHB1dC5pbm5lckhUTUwgKz0gYDxkaXYgY2xhc3M9ImxvZy1lbnRyeSBpbmZvIj4ke3Jlc3VsdC5ub2RlSWR9OiAke3Jlc3VsdC5vdXRwdXR9PC9kaXY+YDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gU2VuZCBjb21wbGV0aW9uIHZpYSBXZWJTb2NrZXQNCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2VuZE1lc3NhZ2UpIHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zZW5kTWVzc2FnZSgnd29ya2Zsb3dfY29tcGxldGVkJywgew0KICAgICAgICAgICAgICAgIHJlc3VsdHM6IHJlc3VsdHMsDQogICAgICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpDQogICAgICAgICAgICB9LCAnZmxvdy1lZGl0b3InKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdXb3JrZmxvdyBleGVjdXRpb24gZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICBvdXRwdXQuaW5uZXJIVE1MICs9IGA8ZGl2IGNsYXNzPSJsb2ctZW50cnkgZXJyb3IiPkVycm9yOiAke2Vycm9yLm1lc3NhZ2V9PC9kaXY+YDsNCiAgICB9IGZpbmFsbHkgew0KICAgICAgICBmbG93RWRpdG9yLmlzUnVubmluZyA9IGZhbHNlOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncnVuLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtZmxleCc7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9wLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICB9DQp9DQoNCi8vIEV4ZWN1dGUgd29ya2Zsb3cNCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVXb3JrZmxvdyhzdGFydE5vZGVzKSB7DQogICAgY29uc3QgcmVzdWx0cyA9IFtdOw0KICAgIGNvbnN0IGV4ZWN1dGVkID0gbmV3IFNldCgpOw0KICAgIGNvbnN0IG5vZGVJbnB1dEJ1ZmZlciA9IG5ldyBNYXAoKTsgLy8gVHJhY2sgaW5wdXRzIGZvciBtdWx0aS1pbnB1dCBub2Rlcw0KICAgIA0KICAgIGZvciAoY29uc3Qgc3RhcnROb2RlIG9mIHN0YXJ0Tm9kZXMpIHsNCiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0ZU5vZGUoc3RhcnROb2RlLCB7fSwgZXhlY3V0ZWQsIG5vZGVJbnB1dEJ1ZmZlcik7DQogICAgICAgIGlmIChyZXN1bHQpIHJlc3VsdHMucHVzaChyZXN1bHQpOw0KICAgIH0NCiAgICANCiAgICByZXR1cm4gcmVzdWx0czsNCn0NCg0KLy8gRXhlY3V0ZSBhIHNpbmdsZSBub2RlIChkeW5hbWljIHZlcnNpb24pDQphc3luYyBmdW5jdGlvbiBleGVjdXRlTm9kZShub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkLCBub2RlSW5wdXRCdWZmZXIpIHsNCiAgICBpZiAoZXhlY3V0ZWQuaGFzKG5vZGUuaWQpKSB7DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCiAgICBleGVjdXRlZC5hZGQobm9kZS5pZCk7DQogICAgDQogICAgLy8gTWFyayBub2RlIGFzIHJ1bm5pbmcNCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGUuaWQpOw0KICAgIGlmIChub2RlRWxlbWVudCkgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncnVubmluZycpOw0KICAgIA0KICAgIHRyeSB7DQogICAgICAgIC8vIFVzZSB0aGUgZHluYW1pYyBleGVjdXRpb24gZW5naW5lDQogICAgICAgIGNvbnN0IG91dHB1dCA9IGF3YWl0IGV4ZWN1dGlvbkVuZ2luZS5leGVjdXRlTm9kZShub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKTsNCiAgICAgICAgDQogICAgICAgIC8vIFN0b3JlIG91dHB1dCBkYXRhIGZvciBjb25maWcgcGFuZWwgZGlzcGxheQ0KICAgICAgICBub2RlLmxhc3RPdXRwdXREYXRhID0gb3V0cHV0Ow0KICAgICAgICBub2RlLmxhc3RFeGVjdXRpb25UaW1lID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2hlY2sgaWYgb3V0cHV0IGluZGljYXRlcyBleGVjdXRpb24gc2hvdWxkIHN0b3AgKGxvZ2ljYWwgZ2F0ZSBzcGVjaWZpYykNCiAgICAgICAgaWYgKG91dHB1dCAmJiB0eXBlb2Ygb3V0cHV0ID09PSAnb2JqZWN0JyAmJiBvdXRwdXQuX19zdG9wX2V4ZWN1dGlvbiA9PT0gdHJ1ZSkgew0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBNYXJrIG5vZGUgYXMgY29tcGxldGVkDQogICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJyk7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIHJldHVybiB7IG5vZGVJZDogbm9kZS5pZCwgb3V0cHV0OiBudWxsIH07DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEZpbmQgY29ubmVjdGVkIG5vZGVzIGFuZCBleGVjdXRlIHRoZW0NCiAgICAgICAgY29uc3QgY29ubmVjdGVkTm9kZXMgPSBmaW5kQ29ubmVjdGVkTm9kZXMobm9kZS5pZCk7DQogICAgICAgIA0KICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3RlZE5vZGUgb2YgY29ubmVjdGVkTm9kZXMpIHsNCiAgICAgICAgICAgIC8vIENoZWNrIGZvciBjeWNsZXMgYmVmb3JlIGV4ZWN1dGluZw0KICAgICAgICAgICAgaWYgKGV4ZWN1dGVkLmhhcyhjb25uZWN0ZWROb2RlLm5vZGUuaWQpKSB7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gSGFuZGxlIG91dHB1dCBtYXBwaW5nIHRvIGlucHV0IHBvcnRzIC0gRElSRUNUIE1BUFBJTkcNCiAgICAgICAgICAgIGxldCBpbnB1dFZhbHVlID0gb3V0cHV0Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAob3V0cHV0IGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICAgICAgICAgIC8vIEJsb2Igb3V0cHV0IC0gcGFzcyBkaXJlY3RseSB0byB0aGUgaW5wdXQgcG9ydA0KICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBvdXRwdXQ7DQogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvdXRwdXQgPT09ICdvYmplY3QnICYmIG91dHB1dCAhPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIC8vIE9iamVjdCBvdXRwdXQgLSBleHRyYWN0IHRoZSBFWEFDVCBvdXRwdXQgcG9ydCBmaWVsZA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChjb25uZWN0ZWROb2RlLm91dHB1dFBvcnQgaW4gb3V0cHV0KSB7DQogICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBvdXRwdXRbY29ubmVjdGVkTm9kZS5vdXRwdXRQb3J0XTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBOb2RlICR7bm9kZS5pZH0gLT4gJHtjb25uZWN0ZWROb2RlLm5vZGUuaWR9OiBFUlJPUiAtIE91dHB1dCBwb3J0ICcke2Nvbm5lY3RlZE5vZGUub3V0cHV0UG9ydH0nIG5vdCBmb3VuZCBpbiBvdXRwdXQhYCk7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEF2YWlsYWJsZSBmaWVsZHM6YCwgT2JqZWN0LmtleXMob3V0cHV0KSk7DQogICAgICAgICAgICAgICAgICAgIC8vIFNraXAgdGhpcyBjb25uZWN0aW9uIGluc3RlYWQgb2YgcGFzc2luZyBudWxsDQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy8gU2ltcGxlIHZhbHVlIG91dHB1dCAtIHBhc3MgZGlyZWN0bHkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIC8vIFVzZSBzbWFydCBleGVjdXRpb24gdGhhdCBoYW5kbGVzIG11bHRpLWlucHV0IHN5bmNocm9uaXphdGlvbg0KICAgICAgICAgICAgICAgIGF3YWl0IGV4ZWN1dGVOb2RlU21hcnQoY29ubmVjdGVkTm9kZS5ub2RlLCBjb25uZWN0ZWROb2RlLmlucHV0UG9ydCwgaW5wdXRWYWx1ZSwgZXhlY3V0ZWQsIG5vZGVJbnB1dEJ1ZmZlcik7DQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGV4ZWN1dGluZyBjb25uZWN0ZWQgbm9kZSAke2Nvbm5lY3RlZE5vZGUubm9kZS5pZH06YCwgZXJyb3IpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dFBhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4ZWN1dGlvbi1vdXRwdXQnKTsNCiAgICAgICAgICAgICAgICBvdXRwdXRQYW5lbC5pbm5lckhUTUwgKz0gYDxkaXYgY2xhc3M9ImxvZy1lbnRyeSBlcnJvciI+RXJyb3IgaW4gY29ubmVjdGVkIG5vZGUgJHtjb25uZWN0ZWROb2RlLm5vZGUuaWR9OiAke2Vycm9yLm1lc3NhZ2V9PC9kaXY+YDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gTWFyayBub2RlIGFzIGNvbXBsZXRlZA0KICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnKTsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NvbXBsZXRlZCcpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICByZXR1cm4geyBub2RlSWQ6IG5vZGUuaWQsIG91dHB1dDogb3V0cHV0IH07DQogICAgICAgIA0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGV4ZWN1dGluZyBub2RlICR7bm9kZS5pZH06YCwgZXJyb3IpOw0KICAgICAgICANCiAgICAgICAgLy8gTWFyayBub2RlIGFzIGVycm9yDQogICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZXJyb3InKTsNCiAgICB9DQogICAgDQogICAgICAgIHRocm93IGVycm9yOw0KICAgIH0gZmluYWxseSB7DQogICAgICAgIC8vIFJlbW92ZSBydW5uaW5nIHN0YXRlDQogICAgICAgIGlmIChub2RlRWxlbWVudCkgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgIH0NCn0NCg0KLy8gU21hcnQgZXhlY3V0aW9uIGZ1bmN0aW9uIHRoYXQgaGFuZGxlcyBtdWx0aS1pbnB1dCBzeW5jaHJvbml6YXRpb24NCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVOb2RlU21hcnQobm9kZSwgaW5wdXRQb3J0LCBpbnB1dFZhbHVlLCBleGVjdXRlZCwgbm9kZUlucHV0QnVmZmVyKSB7DQogICAgY29uc3Qgbm9kZUlkID0gbm9kZS5pZDsNCiAgICANCiAgICAvLyBHZXQgYWxsIGNvbm5lY3RlZCBpbnB1dCBwb3J0cyBmb3IgdGhpcyBub2RlDQogICAgY29uc3QgY29ubmVjdGVkSW5wdXRQb3J0cyA9IGdldENvbm5lY3RlZElucHV0UG9ydHMobm9kZUlkKTsNCiAgICANCiAgICBjb25zb2xlLmxvZyhgZXhlY3V0ZU5vZGVTbWFydDogTm9kZSAke25vZGVJZH0sIGlucHV0UG9ydDogJHtpbnB1dFBvcnR9LCBjb25uZWN0ZWRQb3J0czogWyR7Y29ubmVjdGVkSW5wdXRQb3J0cy5qb2luKCcsICcpfV1gKTsNCiAgICANCiAgICAvLyBJZiBub2RlIGhhcyAwIG9yIDEgaW5wdXQgY29ubmVjdGlvbnMsIGV4ZWN1dGUgaW1tZWRpYXRlbHkNCiAgICBpZiAoY29ubmVjdGVkSW5wdXRQb3J0cy5sZW5ndGggPD0gMSkgew0KICAgICAgICBjb25zb2xlLmxvZyhgZXhlY3V0ZU5vZGVTbWFydDogU2luZ2xlIGlucHV0IG5vZGUsIGV4ZWN1dGluZyBpbW1lZGlhdGVseWApOw0KICAgICAgICByZXR1cm4gYXdhaXQgZXhlY3V0ZU5vZGUobm9kZSwgeyBbaW5wdXRQb3J0XTogaW5wdXRWYWx1ZSB9LCBleGVjdXRlZCwgbm9kZUlucHV0QnVmZmVyKTsNCiAgICB9DQogICAgDQogICAgLy8gTXVsdGktaW5wdXQgbm9kZSAtIG5lZWQgdG8gY29sbGVjdCBhbGwgaW5wdXRzIGJlZm9yZSBleGVjdXRpbmcNCiAgICBpZiAoIW5vZGVJbnB1dEJ1ZmZlci5oYXMobm9kZUlkKSkgew0KICAgICAgICBub2RlSW5wdXRCdWZmZXIuc2V0KG5vZGVJZCwgew0KICAgICAgICAgICAgcmVjZWl2ZWRJbnB1dHM6IHt9LA0KICAgICAgICAgICAgY29ubmVjdGVkUG9ydHM6IGNvbm5lY3RlZElucHV0UG9ydHMNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyBNYXJrIG5vZGUgYXMgd2FpdGluZyBmb3IgaW5wdXRzICh2aXN1YWwgZmVlZGJhY2spDQogICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCd3YWl0aW5nLWlucHV0cycpOw0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnY29tcGxldGVkJywgJ2Vycm9yJyk7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgY29uc3QgYnVmZmVyID0gbm9kZUlucHV0QnVmZmVyLmdldChub2RlSWQpOw0KICAgIA0KICAgIC8vIFN0b3JlIHRoaXMgaW5wdXQNCiAgICBidWZmZXIucmVjZWl2ZWRJbnB1dHNbaW5wdXRQb3J0XSA9IGlucHV0VmFsdWU7DQogICAgDQogICAgY29uc29sZS5sb2coYE5vZGUgJHtub2RlSWR9OiBSZWNlaXZlZCBpbnB1dCAnJHtpbnB1dFBvcnR9JyA9ICcke0pTT04uc3RyaW5naWZ5KGlucHV0VmFsdWUpfScuIEhhdmU6IFske09iamVjdC5rZXlzKGJ1ZmZlci5yZWNlaXZlZElucHV0cykuam9pbignLCAnKX1dLCBOZWVkOiBbJHtidWZmZXIuY29ubmVjdGVkUG9ydHMuam9pbignLCAnKX1dYCk7DQogICAgDQogICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBhbGwgcmVxdWlyZWQgaW5wdXRzDQogICAgY29uc3QgaGFzQWxsSW5wdXRzID0gYnVmZmVyLmNvbm5lY3RlZFBvcnRzLmV2ZXJ5KHBvcnQgPT4gcG9ydCBpbiBidWZmZXIucmVjZWl2ZWRJbnB1dHMpOw0KICAgIA0KICAgIGlmICghaGFzQWxsSW5wdXRzKSB7DQogICAgICAgIC8vIFN0aWxsIHdhaXRpbmcgZm9yIG1vcmUgaW5wdXRzDQogICAgICAgIGNvbnNvbGUubG9nKGBOb2RlICR7bm9kZUlkfTogV2FpdGluZyBmb3IgbW9yZSBpbnB1dHMuLi5gKTsNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIA0KICAgIC8vIEFsbCBpbnB1dHMgcmVhZHkgLSByZW1vdmUgd2FpdGluZyBzdGF0ZSBhbmQgZXhlY3V0ZSENCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3dhaXRpbmctaW5wdXRzJyk7DQogICAgfQ0KICAgIA0KICAgIGNvbnNvbGUubG9nKGBOb2RlICR7bm9kZUlkfTogQWxsIGlucHV0cyByZWFkeSwgZXhlY3V0aW5nIHdpdGggc3luY2hyb25pemVkIGRhdGE6YCwgYnVmZmVyLnJlY2VpdmVkSW5wdXRzKTsNCiAgICANCiAgICAvLyBDbGVhciBidWZmZXIgZm9yIG5leHQgZXhlY3V0aW9uDQogICAgbm9kZUlucHV0QnVmZmVyLmRlbGV0ZShub2RlSWQpOw0KICAgIA0KICAgIC8vIEV4ZWN1dGUgd2l0aCBhbGwgYWdncmVnYXRlZCBpbnB1dHMNCiAgICByZXR1cm4gYXdhaXQgZXhlY3V0ZU5vZGUobm9kZSwgYnVmZmVyLnJlY2VpdmVkSW5wdXRzLCBleGVjdXRlZCwgbm9kZUlucHV0QnVmZmVyKTsNCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGdldCBjb25uZWN0ZWQgaW5wdXQgcG9ydHMgZm9yIGEgbm9kZQ0KZnVuY3Rpb24gZ2V0Q29ubmVjdGVkSW5wdXRQb3J0cyhub2RlSWQpIHsNCiAgICBsZXQgY29ubmVjdGlvbnMgPSBudWxsOw0KICAgIA0KICAgIC8vIERlYnVnOiBMb2cgd2hhdCdzIGF2YWlsYWJsZSBvbiBmbG93RWRpdG9yICh0cnkgYm90aCB3aW5kb3cuZmxvd0VkaXRvciBhbmQgZmxvd0VkaXRvcikNCiAgICBjb25zb2xlLmxvZyhgZ2V0Q29ubmVjdGVkSW5wdXRQb3J0czogd2luZG93LmZsb3dFZGl0b3IgZXhpc3RzOmAsICEhd2luZG93LmZsb3dFZGl0b3IpOw0KICAgIGNvbnNvbGUubG9nKGBnZXRDb25uZWN0ZWRJbnB1dFBvcnRzOiBmbG93RWRpdG9yIGV4aXN0czpgLCB0eXBlb2YgZmxvd0VkaXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgISFmbG93RWRpdG9yKTsNCiAgICANCiAgICAvLyBUcnkgdG8gYWNjZXNzIGZsb3dFZGl0b3IgZGlyZWN0bHkgKG5vdCB2aWEgd2luZG93KQ0KICAgIGxldCBlZGl0b3IgPSBudWxsOw0KICAgIGlmICh0eXBlb2YgZmxvd0VkaXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgZmxvd0VkaXRvcikgew0KICAgICAgICBlZGl0b3IgPSBmbG93RWRpdG9yOw0KICAgICAgICBjb25zb2xlLmxvZyhgZ2V0Q29ubmVjdGVkSW5wdXRQb3J0czogVXNpbmcgZGlyZWN0IGZsb3dFZGl0b3IgcmVmZXJlbmNlYCk7DQogICAgfSBlbHNlIGlmICh3aW5kb3cuZmxvd0VkaXRvcikgew0KICAgICAgICBlZGl0b3IgPSB3aW5kb3cuZmxvd0VkaXRvcjsNCiAgICAgICAgY29uc29sZS5sb2coYGdldENvbm5lY3RlZElucHV0UG9ydHM6IFVzaW5nIHdpbmRvdy5mbG93RWRpdG9yIHJlZmVyZW5jZWApOw0KICAgIH0gZWxzZSB7DQogICAgICAgIGNvbnNvbGUubG9nKGBnZXRDb25uZWN0ZWRJbnB1dFBvcnRzOiBObyBmbG93RWRpdG9yIGF2YWlsYWJsZSBmb3Igbm9kZSAke25vZGVJZH1gKTsNCiAgICAgICAgcmV0dXJuIFtdOw0KICAgIH0NCiAgICANCiAgICBjb25zb2xlLmxvZyhgZ2V0Q29ubmVjdGVkSW5wdXRQb3J0czogZWRpdG9yIGtleXM6YCwgT2JqZWN0LmtleXMoZWRpdG9yKSk7DQogICAgY29uc29sZS5sb2coYGdldENvbm5lY3RlZElucHV0UG9ydHM6IGVkaXRvci5jb25uZWN0aW9ucyBleGlzdHM6YCwgISFlZGl0b3IuY29ubmVjdGlvbnMpOw0KICAgIA0KICAgIC8vIFRyeSBtdWx0aXBsZSB3YXlzIHRvIGFjY2VzcyBjb25uZWN0aW9ucyBkYXRhDQogICAgaWYgKGVkaXRvci5jb25uZWN0aW9ucykgew0KICAgICAgICBjb25uZWN0aW9ucyA9IGVkaXRvci5jb25uZWN0aW9uczsNCiAgICAgICAgY29uc29sZS5sb2coYGdldENvbm5lY3RlZElucHV0UG9ydHM6IFVzaW5nIGVkaXRvci5jb25uZWN0aW9uc2ApOw0KICAgIH0gZWxzZSBpZiAoZWRpdG9yLndvcmtmbG93ICYmIGVkaXRvci53b3JrZmxvdy5jb25uZWN0aW9ucykgew0KICAgICAgICBjb25uZWN0aW9ucyA9IG5ldyBNYXAoZWRpdG9yLndvcmtmbG93LmNvbm5lY3Rpb25zLm1hcChjb25uID0+IFtjb25uLmlkLCBjb25uXSkpOw0KICAgICAgICBjb25zb2xlLmxvZyhgZ2V0Q29ubmVjdGVkSW5wdXRQb3J0czogVXNpbmcgZWRpdG9yLndvcmtmbG93LmNvbm5lY3Rpb25zYCk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgY29uc29sZS5sb2coYGdldENvbm5lY3RlZElucHV0UG9ydHM6IE5vIGNvbm5lY3Rpb25zIGRhdGEgYXZhaWxhYmxlIGZvciBub2RlICR7bm9kZUlkfWApOw0KICAgICAgICByZXR1cm4gW107DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGFsbENvbm5lY3Rpb25zID0gQXJyYXkuZnJvbShjb25uZWN0aW9ucy52YWx1ZXMoKSk7DQogICAgY29uc29sZS5sb2coYGdldENvbm5lY3RlZElucHV0UG9ydHM6IE5vZGUgJHtub2RlSWR9LCB0b3RhbCBjb25uZWN0aW9uczogJHthbGxDb25uZWN0aW9ucy5sZW5ndGh9YCk7DQogICAgDQogICAgLy8gTG9nIGFsbCBjb25uZWN0aW9ucyBmb3IgZGVidWdnaW5nDQogICAgYWxsQ29ubmVjdGlvbnMuZm9yRWFjaCgoY29ubiwgaW5kZXgpID0+IHsNCiAgICAgICAgY29uc29sZS5sb2coYCAgQ29ubmVjdGlvbiAke2luZGV4fTogJHtjb25uLmZyb20ubm9kZUlkfVske2Nvbm4uZnJvbS5wb3J0TmFtZX1dIC0+ICR7Y29ubi50by5ub2RlSWR9WyR7Y29ubi50by5wb3J0TmFtZX1dYCk7DQogICAgfSk7DQogICAgDQogICAgY29uc3QgY29ubmVjdGVkUG9ydHMgPSBhbGxDb25uZWN0aW9ucw0KICAgICAgICAuZmlsdGVyKGNvbm4gPT4gew0KICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGNvbm4udG8ubm9kZUlkID09PSBub2RlSWQ7DQogICAgICAgICAgICBpZiAobWF0Y2hlcykgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAgIE1BVENIOiBDb25uZWN0aW9uIHRvICR7bm9kZUlkfTogJHtjb25uLmZyb20ubm9kZUlkfVske2Nvbm4uZnJvbS5wb3J0TmFtZX1dIC0+ICR7Y29ubi50by5ub2RlSWR9WyR7Y29ubi50by5wb3J0TmFtZX1dYCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gbWF0Y2hlczsNCiAgICAgICAgfSkNCiAgICAgICAgLm1hcChjb25uID0+IGNvbm4udG8ucG9ydE5hbWUpOw0KICAgICAgICANCiAgICBjb25zb2xlLmxvZyhgZ2V0Q29ubmVjdGVkSW5wdXRQb3J0czogTm9kZSAke25vZGVJZH0gaGFzIGNvbm5lY3RlZCBwb3J0czogWyR7Y29ubmVjdGVkUG9ydHMuam9pbignLCAnKX1dYCk7DQogICAgcmV0dXJuIGNvbm5lY3RlZFBvcnRzOw0KfQ0KICAgIA0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHVwZGF0ZSBkaXNwbGF5IG5vZGUgY29udGVudCAodXNlZCBieSBleGVjdXRpb24gZW5naW5lKQ0KZnVuY3Rpb24gdXBkYXRlRGlzcGxheU5vZGVDb250ZW50KG5vZGVJZCwgY29udGVudCwgZm9ybWF0KSB7DQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgIGlmICghbm9kZUVsZW1lbnQpIHJldHVybjsNCiAgICANCiAgICBjb25zdCBkaXNwbGF5VGV4dCA9IG5vZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kaXNwbGF5LXRleHQnKTsNCiAgICBjb25zdCBmb3JtYXRFbGVtZW50ID0gbm9kZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLmRpc3BsYXktZm9ybWF0IHNwYW4nKTsNCiAgICANCiAgICBpZiAoZGlzcGxheVRleHQpIHsNCiAgICAgICAgbGV0IGZvcm1hdHRlZENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICANCiAgICBzd2l0Y2ggKGZvcm1hdCkgew0KICAgICAgICBjYXNlICdqc29uJzoNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UoY29udGVudCkgOiBjb250ZW50Ow0KICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRDb250ZW50ID0gSlNPTi5zdHJpbmdpZnkocGFyc2VkLCBudWxsLCAyKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgZm9ybWF0dGVkQ29udGVudCA9IGNvbnRlbnQ7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnaHRtbCc6DQogICAgICAgICAgICAgICAgZm9ybWF0dGVkQ29udGVudCA9IGNvbnRlbnQ7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAndGV4dCc6DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgZm9ybWF0dGVkQ29udGVudCA9IGNvbnRlbnQ7DQogICAgICAgICAgICBicmVhazsNCiAgICB9DQogICAgDQogICAgICAgIGRpc3BsYXlUZXh0LmlubmVySFRNTCA9IGA8cHJlIGNsYXNzPSJjb250ZW50LXRleHQiPiR7ZXNjYXBlSHRtbChmb3JtYXR0ZWRDb250ZW50KX08L3ByZT5gOw0KICAgIH0NCiAgICANCiAgICBpZiAoZm9ybWF0RWxlbWVudCkgew0KICAgICAgICBmb3JtYXRFbGVtZW50LnRleHRDb250ZW50ID0gZm9ybWF0Ow0KICAgIH0NCiAgICANCiAgICAvLyBTdG9yZSBmb3IgY29uZmlnIHBhbmVsIGRpc3BsYXkNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAobm9kZSkgew0KICAgICAgICBub2RlLmxhc3RDb250ZW50ID0gY29udGVudDsNCiAgICAgICAgbm9kZS5sYXN0Rm9ybWF0ID0gZm9ybWF0Ow0KICAgIH0NCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGVzY2FwZSBIVE1MDQpmdW5jdGlvbiBlc2NhcGVIdG1sKHRleHQpIHsNCiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBkaXYudGV4dENvbnRlbnQgPSB0ZXh0Ow0KICAgIHJldHVybiBkaXYuaW5uZXJIVE1MOw0KfQ0KDQovLyBIZWxwZXIgZnVuY3Rpb24gdG8gcmVwbGFjZSB0ZW1wbGF0ZSBwbGFjZWhvbGRlcnMNCmZ1bmN0aW9uIHJlcGxhY2VUZW1wbGF0ZVBsYWNlaG9sZGVycyh0ZW1wbGF0ZSwgZGF0YSkgew0KICAgIGlmICh0eXBlb2YgdGVtcGxhdGUgIT09ICdvYmplY3QnIHx8IHRlbXBsYXRlID09PSBudWxsKSB7DQogICAgICAgIHJldHVybiB0ZW1wbGF0ZTsNCiAgICB9DQogICAgDQogICAgaWYgKEFycmF5LmlzQXJyYXkodGVtcGxhdGUpKSB7DQogICAgICAgIHJldHVybiB0ZW1wbGF0ZS5tYXAoaXRlbSA9PiByZXBsYWNlVGVtcGxhdGVQbGFjZWhvbGRlcnMoaXRlbSwgZGF0YSkpOw0KICAgIH0NCiAgICANCiAgICBjb25zdCByZXN1bHQgPSB7fTsNCiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh0ZW1wbGF0ZSkpIHsNCiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgIGxldCByZXBsYWNlZFZhbHVlID0gdmFsdWU7DQogICAgDQogICAgICAgICAgICAvLyBSZXBsYWNlIHt7VkFMVUV9fSB3aXRoIHRoZSBmdWxsIGRhdGEgb2JqZWN0DQogICAgICAgICAgICBpZiAodmFsdWUuaW5jbHVkZXMoJ3t7VkFMVUV9fScpKSB7DQogICAgICAgICAgICAgICAgcmVwbGFjZWRWYWx1ZSA9IHZhbHVlLnJlcGxhY2UoJ3t7VkFMVUV9fScsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTsNCn0NCg0KICAgICAgICAgICAgLy8gUmVwbGFjZSB7e0pTT046ZmllbGR9fSB3aXRoIHNwZWNpZmljIGZpZWxkDQogICAgICAgICAgICBjb25zdCBqc29uTWF0Y2hlcyA9IHZhbHVlLm1hdGNoKC9ce1x7SlNPTjooW159XSspXH1cfS9nKTsNCiAgICAgICAgICAgIGlmIChqc29uTWF0Y2hlcykgew0KICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbWF0Y2ggb2YganNvbk1hdGNoZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGQgPSBtYXRjaC5tYXRjaCgvXHtce0pTT046KFtefV0rKVx9XH0vKVsxXTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IGdldE5lc3RlZFZhbHVlKGRhdGEsIGZpZWxkKTsNCiAgICAgICAgICAgICAgICAgICAgcmVwbGFjZWRWYWx1ZSA9IHJlcGxhY2VkVmFsdWUucmVwbGFjZShtYXRjaCwgSlNPTi5zdHJpbmdpZnkoZmllbGRWYWx1ZSkpOw0KICAgICAgICAgICAgICAgIH0NCiAgICB9DQogICAgDQogICAgICAgICAgICAvLyBSZXBsYWNlIHt7ZmllbGR9fSB3aXRoIHNwZWNpZmljIGZpZWxkIHZhbHVlDQogICAgICAgICAgICBjb25zdCBmaWVsZE1hdGNoZXMgPSB2YWx1ZS5tYXRjaCgvXHtceyhbXn1dKylcfVx9L2cpOw0KICAgICAgICAgICAgaWYgKGZpZWxkTWF0Y2hlcykgew0KICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbWF0Y2ggb2YgZmllbGRNYXRjaGVzKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gbWF0Y2gubWF0Y2goL1x7XHsoW159XSspXH1cfS8pWzFdOw0KICAgICAgICAgICAgICAgICAgICBpZiAoZmllbGQgIT09ICdWQUxVRScgJiYgIWZpZWxkLnN0YXJ0c1dpdGgoJ0pTT046JykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBnZXROZXN0ZWRWYWx1ZShkYXRhLCBmaWVsZCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlZFZhbHVlID0gcmVwbGFjZWRWYWx1ZS5yZXBsYWNlKG1hdGNoLCBmaWVsZFZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgcmVzdWx0W2tleV0gPSByZXBsYWNlZFZhbHVlOw0KICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwpIHsNCiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gcmVwbGFjZVRlbXBsYXRlUGxhY2Vob2xkZXJzKHZhbHVlLCBkYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gdmFsdWU7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIHJlc3VsdDsNCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGdldCBuZXN0ZWQgb2JqZWN0IHZhbHVlcw0KZnVuY3Rpb24gZ2V0TmVzdGVkVmFsdWUob2JqLCBwYXRoKSB7DQogICAgY29uc3Qga2V5cyA9IHBhdGguc3BsaXQoJy4nKTsNCiAgICBsZXQgY3VycmVudCA9IG9iajsNCiAgICANCiAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7DQogICAgICAgIGlmIChjdXJyZW50ID09PSBudWxsIHx8IGN1cnJlbnQgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEhhbmRsZSBhcnJheSBhY2Nlc3MgbGlrZSAiaXRlbXNbMF0ubmFtZSINCiAgICAgICAgY29uc3QgYXJyYXlNYXRjaCA9IGtleS5tYXRjaCgvXiguKylcWyhcZCspXF0kLyk7DQogICAgICAgIGlmIChhcnJheU1hdGNoKSB7DQogICAgICAgICAgICBjb25zdCBhcnJheUtleSA9IGFycmF5TWF0Y2hbMV07DQogICAgICAgICAgICBjb25zdCBhcnJheUluZGV4ID0gcGFyc2VJbnQoYXJyYXlNYXRjaFsyXSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChjdXJyZW50W2FycmF5S2V5XSAmJiBBcnJheS5pc0FycmF5KGN1cnJlbnRbYXJyYXlLZXldKSkgew0KICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50W2FycmF5S2V5XVthcnJheUluZGV4XTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50W2tleV07DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIGN1cnJlbnQ7DQp9DQoNCi8vIFN0b3Agd29ya2Zsb3cgZXhlY3V0aW9uDQpmdW5jdGlvbiBzdG9wV29ya2Zsb3coKSB7DQogICAgICAgIGZsb3dFZGl0b3IuaXNSdW5uaW5nID0gZmFsc2U7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdydW4td29ya2Zsb3cnKS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1mbGV4JzsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0b3Atd29ya2Zsb3cnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICANCiAgICAvLyBDbGVhciBydW5uaW5nIHN0YXRlcyBmcm9tIGFsbCBub2Rlcw0KICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmxvdy1ub2RlLnJ1bm5pbmcsIC5mbG93LW5vZGUud2FpdGluZy1pbnB1dHMnKS5mb3JFYWNoKG5vZGUgPT4gew0KICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJywgJ3dhaXRpbmctaW5wdXRzJyk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICBjb25zdCBvdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhlY3V0aW9uLW91dHB1dCcpOw0KICAgIG91dHB1dC5pbm5lckhUTUwgKz0gJzxkaXYgY2xhc3M9ImxvZy1lbnRyeSB3YXJuaW5nIj5Xb3JrZmxvdyBleGVjdXRpb24gc3RvcHBlZCBieSB1c2VyPC9kaXY+JzsNCiAgICANCn0NCg0KLy8gRmluZCBub2RlcyBjb25uZWN0ZWQgdG8gYSBzcGVjaWZpYyBub2RlDQpmdW5jdGlvbiBmaW5kQ29ubmVjdGVkTm9kZXMobm9kZUlkKSB7DQogICAgY29uc3QgY29ubmVjdGVkTm9kZXMgPSBbXTsNCiAgICANCiAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkKSB7DQogICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgICAgICAgICAgaWYgKHRhcmdldE5vZGUpIHsNCiAgICAgICAgICAgICAgICBjb25uZWN0ZWROb2Rlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgbm9kZTogdGFyZ2V0Tm9kZSwNCiAgICAgICAgICAgICAgICAgICAgaW5wdXRQb3J0OiBjb25uZWN0aW9uLnRvLnBvcnROYW1lLA0KICAgICAgICAgICAgICAgICAgICBvdXRwdXRQb3J0OiBjb25uZWN0aW9uLmZyb20ucG9ydE5hbWUNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICByZXR1cm4gY29ubmVjdGVkTm9kZXM7DQp9DQoNCi8vIEZvcm1hdCBkYXRhIGZvciBwcmV2aWV3IGluIGNvbmZpZyBwYW5lbA0KZnVuY3Rpb24gZm9ybWF0RGF0YVByZXZpZXcoZGF0YSwgbWF4TGVuZ3RoID0gMjAwKSB7DQogICAgaWYgKGRhdGEgPT09IG51bGwgfHwgZGF0YSA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgIHJldHVybiB7IHR5cGU6ICdudWxsJywgcHJldmlldzogJ251bGwnIH07DQogICAgfQ0KICAgIA0KICAgIGlmIChkYXRhIGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICBjb25zdCBzaXplS0IgPSAoZGF0YS5zaXplIC8gMTAyNCkudG9GaXhlZCgyKTsNCiAgICAgICAgY29uc3Qgc2l6ZU1CID0gZGF0YS5zaXplID4gMTAyNCAqIDEwMjQgPyBgICgkeyhkYXRhLnNpemUgLyAoMTAyNCAqIDEwMjQpKS50b0ZpeGVkKDIpfSBNQilgIDogJyc7DQogICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgdHlwZTogJ0Jsb2InLCANCiAgICAgICAgICAgIHByZXZpZXc6IGAke2RhdGEudHlwZSB8fCAndW5rbm93bid9IC0gJHtzaXplS0J9IEtCJHtzaXplTUJ9YCwNCiAgICAgICAgICAgIHNpemU6IGRhdGEuc2l6ZQ0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7DQogICAgICAgIGNvbnN0IHNpemVLQiA9IChkYXRhLmJ5dGVMZW5ndGggLyAxMDI0KS50b0ZpeGVkKDIpOw0KICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgIHR5cGU6ICdBcnJheUJ1ZmZlcicsIA0KICAgICAgICAgICAgcHJldmlldzogYEJpbmFyeSBkYXRhIC0gJHtzaXplS0J9IEtCYCwNCiAgICAgICAgICAgIHNpemU6IGRhdGEuYnl0ZUxlbmd0aA0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkgfHwgZGF0YSBpbnN0YW5jZW9mIEludDhBcnJheSB8fCANCiAgICAgICAgZGF0YSBpbnN0YW5jZW9mIFVpbnQxNkFycmF5IHx8IGRhdGEgaW5zdGFuY2VvZiBJbnQxNkFycmF5IHx8DQogICAgICAgIGRhdGEgaW5zdGFuY2VvZiBVaW50MzJBcnJheSB8fCBkYXRhIGluc3RhbmNlb2YgSW50MzJBcnJheSB8fA0KICAgICAgICBkYXRhIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5IHx8IGRhdGEgaW5zdGFuY2VvZiBGbG9hdDY0QXJyYXkpIHsNCiAgICAgICAgY29uc3Qgc2l6ZUtCID0gKGRhdGEuYnl0ZUxlbmd0aCAvIDEwMjQpLnRvRml4ZWQoMik7DQogICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgdHlwZTogZGF0YS5jb25zdHJ1Y3Rvci5uYW1lLCANCiAgICAgICAgICAgIHByZXZpZXc6IGBCaW5hcnkgYXJyYXkgLSAke3NpemVLQn0gS0JgLA0KICAgICAgICAgICAgc2l6ZTogZGF0YS5ieXRlTGVuZ3RoDQogICAgICAgIH07DQogICAgfQ0KICAgIA0KICAgIGlmIChBcnJheS5pc0FycmF5KGRhdGEpKSB7DQogICAgICAgIC8vIENoZWNrIGlmIGl0J3MgbGlrZWx5IGJpbmFyeSBkYXRhIChhcnJheSBvZiBudW1iZXJzIDAtMjU1KQ0KICAgICAgICBpZiAoZGF0YS5sZW5ndGggPiAwICYmIGRhdGEuZXZlcnkoaXRlbSA9PiB0eXBlb2YgaXRlbSA9PT0gJ251bWJlcicgJiYgaXRlbSA+PSAwICYmIGl0ZW0gPD0gMjU1KSkgew0KICAgICAgICAgICAgY29uc3Qgc2l6ZUtCID0gKGRhdGEubGVuZ3RoIC8gMTAyNCkudG9GaXhlZCgyKTsNCiAgICAgICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgICAgIHR5cGU6ICdCaW5hcnkgQXJyYXknLCANCiAgICAgICAgICAgICAgICBwcmV2aWV3OiBgQmluYXJ5IGRhdGEgYXJyYXkgLSAke3NpemVLQn0gS0JgLA0KICAgICAgICAgICAgICAgIGxlbmd0aDogZGF0YS5sZW5ndGgNCiAgICAgICAgICAgIH07DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHByZXZpZXcgPSBkYXRhLmxlbmd0aCA+IDMgDQogICAgICAgICAgICA/IGBbJHtkYXRhLnNsaWNlKDAsIDMpLm1hcChpdGVtID0+IEpTT04uc3RyaW5naWZ5KGl0ZW0pKS5qb2luKCcsICcpfSwgLi4uXWANCiAgICAgICAgICAgIDogSlNPTi5zdHJpbmdpZnkoZGF0YSk7DQogICAgICAgIGNvbnN0IHRydW5jYXRlZCA9IHByZXZpZXcubGVuZ3RoID4gbWF4TGVuZ3RoID8gcHJldmlldy5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKSArICcuLi4nIDogcHJldmlldzsNCiAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICB0eXBlOiAnQXJyYXknLCANCiAgICAgICAgICAgIHByZXZpZXc6IHRydW5jYXRlZCwNCiAgICAgICAgICAgIGxlbmd0aDogZGF0YS5sZW5ndGgNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgaWYgKHR5cGVvZiBkYXRhID09PSAnb2JqZWN0Jykgew0KICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoZGF0YSk7DQogICAgICAgIA0KICAgICAgICAvLyBDaGVjayBpZiBpdCBsb29rcyBsaWtlIGEgbGFyZ2UgZGF0YSBvYmplY3QgKGhhcyBjb21tb24gbGFyZ2UgZGF0YSBpbmRpY2F0b3JzKQ0KICAgICAgICBjb25zdCBoYXNMYXJnZURhdGFJbmRpY2F0b3JzID0ga2V5cy5zb21lKGtleSA9PiANCiAgICAgICAgICAgIGtleS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdkYXRhJykgfHwgDQogICAgICAgICAgICBrZXkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYnVmZmVyJykgfHwNCiAgICAgICAgICAgIGtleS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdiYXNlNjQnKSB8fA0KICAgICAgICAgICAga2V5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2JpbmFyeScpDQogICAgICAgICk7DQogICAgICAgIA0KICAgICAgICBpZiAoaGFzTGFyZ2VEYXRhSW5kaWNhdG9ycykgew0KICAgICAgICAgICAgLy8gQ2hlY2sgc2l6ZXMgb2YgdmFsdWVzIHRoYXQgbWlnaHQgYmUgbGFyZ2UNCiAgICAgICAgICAgIGxldCB0b3RhbFNpemUgPSAwOw0KICAgICAgICAgICAgbGV0IGhhc0xhcmdlVmFsdWVzID0gZmFsc2U7DQogICAgICAgICAgICBjb25zdCBzdW1tYXJ5ID0ge307DQogICAgICAgICAgICANCiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHsNCiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGRhdGFba2V5XTsNCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiB2YWx1ZS5sZW5ndGggPiAxMDAwKSB7DQogICAgICAgICAgICAgICAgICAgIHN1bW1hcnlba2V5XSA9IGBTdHJpbmcgKCR7KHZhbHVlLmxlbmd0aCAvIDEwMjQpLnRvRml4ZWQoMil9IEtCKWA7DQogICAgICAgICAgICAgICAgICAgIHRvdGFsU2l6ZSArPSB2YWx1ZS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgIGhhc0xhcmdlVmFsdWVzID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeVtrZXldID0gYEFycmF5QnVmZmVyICgkeyh2YWx1ZS5ieXRlTGVuZ3RoIC8gMTAyNCkudG9GaXhlZCgyKX0gS0IpYDsNCiAgICAgICAgICAgICAgICAgICAgdG90YWxTaXplICs9IHZhbHVlLmJ5dGVMZW5ndGg7DQogICAgICAgICAgICAgICAgICAgIGhhc0xhcmdlVmFsdWVzID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA+IDEwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeVtrZXldID0gYEFycmF5WyR7dmFsdWUubGVuZ3RofV0gKCR7KHZhbHVlLmxlbmd0aCAvIDEwMjQpLnRvRml4ZWQoMil9IEtCIGVzdC4pYDsNCiAgICAgICAgICAgICAgICAgICAgdG90YWxTaXplICs9IHZhbHVlLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgaGFzTGFyZ2VWYWx1ZXMgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHN1bW1hcnlba2V5XSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyBgIiR7dmFsdWUuc3Vic3RyaW5nKDAsIDMwKX0uLi4iYCA6IHR5cGVvZiB2YWx1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChoYXNMYXJnZVZhbHVlcykgew0KICAgICAgICAgICAgICAgIHJldHVybiB7IA0KICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTGFyZ2UgT2JqZWN0JywgDQogICAgICAgICAgICAgICAgICAgIHByZXZpZXc6IEpTT04uc3RyaW5naWZ5KHN1bW1hcnksIG51bGwsIDIpLA0KICAgICAgICAgICAgICAgICAgICBrZXlzOiBrZXlzLmxlbmd0aCwNCiAgICAgICAgICAgICAgICAgICAgZXN0aW1hdGVkU2l6ZTogdG90YWxTaXplDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gUmVndWxhciBvYmplY3QgaGFuZGxpbmcNCiAgICAgICAgY29uc3QgcHJldmlldyA9IGtleXMubGVuZ3RoID4gMw0KICAgICAgICAgICAgPyBgeyR7a2V5cy5zbGljZSgwLCAzKS5qb2luKCcsICcpfSwgLi4ufWANCiAgICAgICAgICAgIDogSlNPTi5zdHJpbmdpZnkoZGF0YSk7DQogICAgICAgIGNvbnN0IHRydW5jYXRlZCA9IHByZXZpZXcubGVuZ3RoID4gbWF4TGVuZ3RoID8gcHJldmlldy5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKSArICcuLi4nIDogcHJldmlldzsNCiAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICB0eXBlOiAnT2JqZWN0JywgDQogICAgICAgICAgICBwcmV2aWV3OiB0cnVuY2F0ZWQsDQogICAgICAgICAgICBrZXlzOiBrZXlzLmxlbmd0aA0KICAgICAgICB9Ow0KICAgIH0NCiAgICANCiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgIC8vIENoZWNrIGlmIGl0J3MgYmFzZTY0IGRhdGENCiAgICAgICAgY29uc3QgaXNCYXNlNjQgPSAvXltBLVphLXowLTkrL10qPXswLDJ9JC8udGVzdChkYXRhKSAmJiBkYXRhLmxlbmd0aCA+IDEwMCAmJiBkYXRhLmxlbmd0aCAlIDQgPT09IDA7DQogICAgICAgIGlmIChpc0Jhc2U2NCkgew0KICAgICAgICAgICAgY29uc3Qgc2l6ZUtCID0gKGRhdGEubGVuZ3RoICogMC43NSAvIDEwMjQpLnRvRml4ZWQoMik7IC8vIEJhc2U2NCBpcyB+MzMlIGxhcmdlciB0aGFuIGJpbmFyeQ0KICAgICAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICAgICAgdHlwZTogJ0Jhc2U2NCBEYXRhJywgDQogICAgICAgICAgICAgICAgcHJldmlldzogYEJhc2U2NCBlbmNvZGVkIGRhdGEgLSAke3NpemVLQn0gS0JgLA0KICAgICAgICAgICAgICAgIGxlbmd0aDogZGF0YS5sZW5ndGgNCiAgICAgICAgICAgIH07DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIENoZWNrIGlmIGl0J3MgYSBkYXRhIFVSTA0KICAgICAgICBpZiAoZGF0YS5zdGFydHNXaXRoKCdkYXRhOicpKSB7DQogICAgICAgICAgICBjb25zdCBjb21tYUluZGV4ID0gZGF0YS5pbmRleE9mKCcsJyk7DQogICAgICAgICAgICBjb25zdCBoZWFkZXIgPSBjb21tYUluZGV4ID4gMCA/IGRhdGEuc3Vic3RyaW5nKDAsIGNvbW1hSW5kZXgpIDogZGF0YS5zdWJzdHJpbmcoMCwgNTApOw0KICAgICAgICAgICAgY29uc3QgZGF0YVNpemUgPSBjb21tYUluZGV4ID4gMCA/IGRhdGEubGVuZ3RoIC0gY29tbWFJbmRleCAtIDEgOiBkYXRhLmxlbmd0aDsNCiAgICAgICAgICAgIGNvbnN0IHNpemVLQiA9IChkYXRhU2l6ZSAqIDAuNzUgLyAxMDI0KS50b0ZpeGVkKDIpOw0KICAgICAgICAgICAgcmV0dXJuIHsgDQogICAgICAgICAgICAgICAgdHlwZTogJ0RhdGEgVVJMJywgDQogICAgICAgICAgICAgICAgcHJldmlldzogYCR7aGVhZGVyfS4uLiAtICR7c2l6ZUtCfSBLQmAsDQogICAgICAgICAgICAgICAgbGVuZ3RoOiBkYXRhLmxlbmd0aA0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gUmVndWxhciBzdHJpbmcgaGFuZGxpbmcNCiAgICAgICAgY29uc3QgdHJ1bmNhdGVkID0gZGF0YS5sZW5ndGggPiBtYXhMZW5ndGggPyBkYXRhLnN1YnN0cmluZygwLCBtYXhMZW5ndGgpICsgJy4uLicgOiBkYXRhOw0KICAgICAgICByZXR1cm4geyANCiAgICAgICAgICAgIHR5cGU6ICdTdHJpbmcnLCANCiAgICAgICAgICAgIHByZXZpZXc6IHRydW5jYXRlZCwNCiAgICAgICAgICAgIGxlbmd0aDogZGF0YS5sZW5ndGgNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgcmV0dXJuIHsgDQogICAgICAgIHR5cGU6IHR5cGVvZiBkYXRhLCANCiAgICAgICAgcHJldmlldzogU3RyaW5nKGRhdGEpIA0KICAgIH07DQp9DQoNCi8vIEdldCBvdXRwdXQgcG9ydCBkYXRhIGZvciBhIHNwZWNpZmljIG5vZGUgYW5kIHBvcnQNCmZ1bmN0aW9uIGdldE91dHB1dFBvcnREYXRhKG5vZGVJZCwgcG9ydElkKSB7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKCFub2RlIHx8ICFub2RlLmxhc3RPdXRwdXREYXRhKSB7DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCiAgICANCiAgICAvLyBJZiB0aGUgb3V0cHV0IGRhdGEgaXMgYW4gb2JqZWN0IHdpdGggbmFtZWQgcG9ydHMsIGV4dHJhY3QgdGhlIHNwZWNpZmljIHBvcnQNCiAgICBpZiAodHlwZW9mIG5vZGUubGFzdE91dHB1dERhdGEgPT09ICdvYmplY3QnICYmIG5vZGUubGFzdE91dHB1dERhdGEgIT09IG51bGwgJiYgIUFycmF5LmlzQXJyYXkobm9kZS5sYXN0T3V0cHV0RGF0YSkgJiYgIShub2RlLmxhc3RPdXRwdXREYXRhIGluc3RhbmNlb2YgQmxvYikgJiYgIShub2RlLmxhc3RPdXRwdXREYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpKSB7DQogICAgICAgIGlmIChwb3J0SWQgaW4gbm9kZS5sYXN0T3V0cHV0RGF0YSkgew0KICAgICAgICAgICAgcmV0dXJuIG5vZGUubGFzdE91dHB1dERhdGFbcG9ydElkXTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBQb3J0IG5vdCBmb3VuZCBpbiBvdXRwdXQgb2JqZWN0DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCiAgICANCiAgICAvLyBGb3Igc2luZ2xlIG91dHB1dCBub2RlcyBvciBub24tb2JqZWN0IG91dHB1dHMgKEJsb2IsIEFycmF5QnVmZmVyLCBwcmltaXRpdmVzKSwgDQogICAgLy8gb25seSByZXR1cm4gZGF0YSBmb3IgdGhlIGZpcnN0L3ByaW1hcnkgb3V0cHV0IHBvcnQNCiAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgaWYgKG5vZGVEZWYgJiYgbm9kZURlZi5vdXRwdXRzICYmIG5vZGVEZWYub3V0cHV0cy5sZW5ndGggPiAwKSB7DQogICAgICAgIC8vIE9ubHkgcmV0dXJuIGRhdGEgZm9yIHRoZSBmaXJzdCBvdXRwdXQgcG9ydCwgb3RoZXJzIGdldCBudWxsDQogICAgICAgIGlmIChwb3J0SWQgPT09IG5vZGVEZWYub3V0cHV0c1swXS5pZCkgew0KICAgICAgICAgICAgcmV0dXJuIG5vZGUubGFzdE91dHB1dERhdGE7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIA0KICAgIC8vIEZhbGxiYWNrOiByZXR1cm4gdGhlIGRhdGEgKHNob3VsZG4ndCBub3JtYWxseSByZWFjaCBoZXJlKQ0KICAgIHJldHVybiBub2RlLmxhc3RPdXRwdXREYXRhOw0KfSANCg0KLy8gVXBkYXRlIGNhbnZhcyB0cmFuc2Zvcm0gZm9yIHBhbm5pbmcgYW5kIHpvb21pbmcNCmZ1bmN0aW9uIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5jYW52YXMpIHsNCiAgICAgICAgY29uc3QgdHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke2Zsb3dFZGl0b3IucGFuT2Zmc2V0Lnh9cHgsICR7Zmxvd0VkaXRvci5wYW5PZmZzZXQueX1weCkgc2NhbGUoJHtmbG93RWRpdG9yLnpvb21MZXZlbH0pYDsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNmb3JtID0gdHJhbnNmb3JtOw0KICAgICAgICANCiAgICAgICAgLy8gVXBkYXRlIHpvb20gbGV2ZWwgZGlzcGxheQ0KICAgICAgICBjb25zdCB6b29tRGlzcGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b29tLWxldmVsJyk7DQogICAgICAgIGlmICh6b29tRGlzcGxheSkgew0KICAgICAgICAgICAgem9vbURpc3BsYXkudGV4dENvbnRlbnQgPSBNYXRoLnJvdW5kKGZsb3dFZGl0b3Iuem9vbUxldmVsICogMTAwKSArICclJzsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gU3RhcnQgY2FudmFzIHBhbm5pbmcNCmZ1bmN0aW9uIHN0YXJ0Q2FudmFzUGFuKGUpIHsNCiAgICAvLyBPbmx5IHN0YXJ0IHBhbm5pbmcgaWYgY2xpY2tpbmcgZGlyZWN0bHkgb24gY2FudmFzIChub3Qgb24gbm9kZXMgb3Igb3RoZXIgZWxlbWVudHMpDQogICAgLy8gYW5kIG5vdCBhbHJlYWR5IGRyYWdnaW5nIGEgbm9kZQ0KICAgIGlmIChlLnRhcmdldCA9PT0gZmxvd0VkaXRvci5jYW52YXMgJiYgIWZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKSB7DQogICAgICAgIGZsb3dFZGl0b3IuaXNQYW5uaW5nID0gdHJ1ZTsNCiAgICAgICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/DQogICAgICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOg0KICAgICAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgICAgICBmbG93RWRpdG9yLnBhblN0YXJ0ID0geyB4OiBtb3VzZUNvb3Jkcy54LCB5OiBtb3VzZUNvb3Jkcy55IH07DQogICAgICAgIGZsb3dFZGl0b3IubGFzdFBhbk9mZnNldCA9IHsgLi4uZmxvd0VkaXRvci5wYW5PZmZzZXQgfTsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUuY3Vyc29yID0gJ2dyYWJiaW5nJzsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuY2xhc3NMaXN0LmFkZCgncGFubmluZycpOw0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgfQ0KfQ0KDQovLyBVcGRhdGUgY2FudmFzIHBhbm5pbmcNCmZ1bmN0aW9uIHVwZGF0ZUNhbnZhc1BhbihlKSB7DQogICAgaWYgKGZsb3dFZGl0b3IuaXNQYW5uaW5nKSB7DQogICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPw0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDoNCiAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgY29uc3QgZGVsdGFYID0gbW91c2VDb29yZHMueCAtIGZsb3dFZGl0b3IucGFuU3RhcnQueDsNCiAgICAgICAgY29uc3QgZGVsdGFZID0gbW91c2VDb29yZHMueSAtIGZsb3dFZGl0b3IucGFuU3RhcnQueTsNCg0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gZmxvd0VkaXRvci5sYXN0UGFuT2Zmc2V0LnggKyBkZWx0YVg7DQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSBmbG93RWRpdG9yLmxhc3RQYW5PZmZzZXQueSArIGRlbHRhWTsNCg0KICAgICAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIH0NCn0NCg0KLy8gU3RvcCBjYW52YXMgcGFubmluZw0KZnVuY3Rpb24gc3RvcENhbnZhc1BhbigpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5pc1Bhbm5pbmcpIHsNCiAgICAgICAgZmxvd0VkaXRvci5pc1Bhbm5pbmcgPSBmYWxzZTsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUuY3Vyc29yID0gJ2dyYWInOw0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5jbGFzc0xpc3QucmVtb3ZlKCdwYW5uaW5nJyk7DQogICAgfQ0KfQ0KDQovLyBSZXNldCBjYW52YXMgcGFuIHRvIGNlbnRlcg0KZnVuY3Rpb24gcmVzZXRDYW52YXNQYW4oKSB7DQogICAgLy8gQWRkIHNtb290aCB0cmFuc2l0aW9uIGZvciByZXNldA0KICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zaXRpb24gPSAndHJhbnNmb3JtIDAuM3MgZWFzZS1vdXQnOw0KDQogICAgLy8gQ2FsY3VsYXRlIGNlbnRlciBvZiBhbGwgbm9kZXMgaWYgYW55IGV4aXN0DQogICAgaWYgKGZsb3dFZGl0b3Iubm9kZXMuc2l6ZSA+IDApIHsNCiAgICAgICAgY29uc3Qgbm9kZXMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3Iubm9kZXMudmFsdWVzKCkpOw0KICAgICAgICBjb25zdCBtaW5YID0gTWF0aC5taW4oLi4ubm9kZXMubWFwKG4gPT4gbi54KSk7DQogICAgICAgIGNvbnN0IG1heFggPSBNYXRoLm1heCguLi5ub2Rlcy5tYXAobiA9PiBuLngpKTsNCiAgICAgICAgY29uc3QgbWluWSA9IE1hdGgubWluKC4uLm5vZGVzLm1hcChuID0+IG4ueSkpOw0KICAgICAgICBjb25zdCBtYXhZID0gTWF0aC5tYXgoLi4ubm9kZXMubWFwKG4gPT4gbi55KSk7DQoNCiAgICAgICAgY29uc3QgY2VudGVyWCA9IChtaW5YICsgbWF4WCkgLyAyOw0KICAgICAgICBjb25zdCBjZW50ZXJZID0gKG1pblkgKyBtYXhZKSAvIDI7DQoNCiAgICAgICAgLy8gR2V0IGNhbnZhcyBjb250YWluZXIgZGltZW5zaW9ucyAoc2NhbGVkKQ0KICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8NCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6DQogICAgICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQoNCiAgICAgICAgLy8gQ2FsY3VsYXRlIHBhbiBvZmZzZXQgdG8gY2VudGVyIHRoZSBub2RlcyBpbiB0aGUgdmlld3BvcnQNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IC1jZW50ZXJYICsgY29udGFpbmVyUmVjdC53aWR0aCAvIDI7DQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSAtY2VudGVyWSArIGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBJZiBubyBub2RlcywgcmVzZXQgdG8gY2VudGVyIG9mIHRoZSBsYXJnZSBjYW52YXMNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQgPSB7IHg6IC01MDAwLCB5OiAtNTAwMCB9Ow0KICAgIH0NCg0KICAgIC8vIFJlc2V0IHpvb20gdG8gMTAwJQ0KICAgIGZsb3dFZGl0b3Iuem9vbUxldmVsID0gMS4wOw0KDQogICAgdXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQoNCiAgICAvLyBSZW1vdmUgdHJhbnNpdGlvbiBhZnRlciBhbmltYXRpb24gY29tcGxldGVzDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zaXRpb24gPSAnJzsNCiAgICB9LCAzMDApOw0KfQ0KDQovLyBab29tIGZ1bmN0aW9ucw0KZnVuY3Rpb24gem9vbUluKCkgew0KICAgIGNvbnN0IG5ld1pvb20gPSBNYXRoLm1pbihmbG93RWRpdG9yLnpvb21MZXZlbCArIGZsb3dFZGl0b3Iuem9vbVN0ZXAsIGZsb3dFZGl0b3IubWF4Wm9vbSk7DQogICAgc2V0Wm9vbUxldmVsKG5ld1pvb20pOw0KfQ0KDQpmdW5jdGlvbiB6b29tT3V0KCkgew0KICAgIGNvbnN0IG5ld1pvb20gPSBNYXRoLm1heChmbG93RWRpdG9yLnpvb21MZXZlbCAtIGZsb3dFZGl0b3Iuem9vbVN0ZXAsIGZsb3dFZGl0b3IubWluWm9vbSk7DQogICAgc2V0Wm9vbUxldmVsKG5ld1pvb20pOw0KfQ0KDQpmdW5jdGlvbiBzZXRab29tTGV2ZWwoem9vbUxldmVsKSB7DQogICAgLy8gR2V0IHRoZSBjZW50ZXIgb2YgdGhlIGNhbnZhcyBjb250YWluZXIgZm9yIHpvb20gb3JpZ2luDQogICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8NCiAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDoNCiAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIA0KICAgIGNvbnN0IGNlbnRlclggPSBjb250YWluZXJSZWN0LndpZHRoIC8gMjsNCiAgICBjb25zdCBjZW50ZXJZID0gY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSB0aGUgcG9pbnQgaW4gY2FudmFzIGNvb3JkaW5hdGVzIHRoYXQgc2hvdWxkIHJlbWFpbiBmaXhlZA0KICAgIGNvbnN0IGNhbnZhc1ggPSAoY2VudGVyWCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgY29uc3QgY2FudmFzWSA9IChjZW50ZXJZIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICANCiAgICAvLyBVcGRhdGUgem9vbSBsZXZlbA0KICAgIGZsb3dFZGl0b3Iuem9vbUxldmVsID0gTWF0aC5tYXgoZmxvd0VkaXRvci5taW5ab29tLCBNYXRoLm1pbihmbG93RWRpdG9yLm1heFpvb20sIHpvb21MZXZlbCkpOw0KICAgIA0KICAgIC8vIEFkanVzdCBwYW4gb2Zmc2V0IHRvIGtlZXAgdGhlIGNlbnRlciBwb2ludCBmaXhlZA0KICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnggPSBjZW50ZXJYIC0gY2FudmFzWCAqIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSBjZW50ZXJZIC0gY2FudmFzWSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIA0KICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgIA0KICAgIC8vIFJlZHJhdyBjb25uZWN0aW9ucyBhZnRlciB6b29tDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgfSwgMTYpOw0KfQ0KDQpmdW5jdGlvbiB6b29tVG9GaXQoKSB7DQogICAgaWYgKGZsb3dFZGl0b3Iubm9kZXMuc2l6ZSA9PT0gMCkgew0KICAgICAgICAvLyBJZiBubyBub2RlcywgcmVzZXQgdG8gMTAwJSB6b29tIGFuZCBjZW50ZXINCiAgICAgICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSAxLjA7DQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0ID0geyB4OiAtNTAwMCwgeTogLTUwMDAgfTsNCiAgICAgICAgdXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gRmluZCBib3VuZHMgb2YgYWxsIG5vZGVzDQogICAgY29uc3Qgbm9kZXMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3Iubm9kZXMudmFsdWVzKCkpOw0KICAgIGNvbnN0IHBhZGRpbmcgPSAxMDA7IC8vIEV4dHJhIHBhZGRpbmcgYXJvdW5kIG5vZGVzDQogICAgDQogICAgbGV0IG1pblggPSBJbmZpbml0eSwgbWF4WCA9IC1JbmZpbml0eTsNCiAgICBsZXQgbWluWSA9IEluZmluaXR5LCBtYXhZID0gLUluZmluaXR5Ow0KICAgIA0KICAgIG5vZGVzLmZvckVhY2gobm9kZSA9PiB7DQogICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZS5pZCk7DQogICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgY29uc3QgcmVjdCA9IG5vZGVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICAgICAgbWluWCA9IE1hdGgubWluKG1pblgsIG5vZGUueCk7DQogICAgICAgICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgbm9kZS54ICsgcmVjdC53aWR0aCk7DQogICAgICAgICAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgbm9kZS55KTsNCiAgICAgICAgICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCBub2RlLnkgKyByZWN0LmhlaWdodCk7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICAvLyBBZGQgcGFkZGluZw0KICAgIG1pblggLT0gcGFkZGluZzsNCiAgICBtYXhYICs9IHBhZGRpbmc7DQogICAgbWluWSAtPSBwYWRkaW5nOw0KICAgIG1heFkgKz0gcGFkZGluZzsNCiAgICANCiAgICBjb25zdCBjb250ZW50V2lkdGggPSBtYXhYIC0gbWluWDsNCiAgICBjb25zdCBjb250ZW50SGVpZ2h0ID0gbWF4WSAtIG1pblk7DQogICAgDQogICAgLy8gR2V0IGNvbnRhaW5lciBkaW1lbnNpb25zDQogICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8NCiAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDoNCiAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSB6b29tIHRvIGZpdA0KICAgIGNvbnN0IHpvb21YID0gY29udGFpbmVyUmVjdC53aWR0aCAvIGNvbnRlbnRXaWR0aDsNCiAgICBjb25zdCB6b29tWSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gY29udGVudEhlaWdodDsNCiAgICBjb25zdCBuZXdab29tID0gTWF0aC5taW4oem9vbVgsIHpvb21ZLCBmbG93RWRpdG9yLm1heFpvb20pOw0KICAgIA0KICAgIC8vIFNldCB6b29tIGxldmVsDQogICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSBNYXRoLm1heChmbG93RWRpdG9yLm1pblpvb20sIG5ld1pvb20pOw0KICAgIA0KICAgIC8vIENlbnRlciB0aGUgY29udGVudA0KICAgIGNvbnN0IGNlbnRlclggPSAobWluWCArIG1heFgpIC8gMjsNCiAgICBjb25zdCBjZW50ZXJZID0gKG1pblkgKyBtYXhZKSAvIDI7DQogICAgDQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyIC0gY2VudGVyWCAqIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSBjb250YWluZXJSZWN0LmhlaWdodCAvIDIgLSBjZW50ZXJZICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgDQogICAgLy8gQWRkIHNtb290aCB0cmFuc2l0aW9uDQogICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICd0cmFuc2Zvcm0gMC4zcyBlYXNlLW91dCc7DQogICAgdXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgDQogICAgLy8gUmVtb3ZlIHRyYW5zaXRpb24gYWZ0ZXIgYW5pbWF0aW9uDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zaXRpb24gPSAnJzsNCiAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICB9LCAzMDApOw0KfQ0KDQovLyBIYW5kbGUgbW91c2Ugd2hlZWwgem9vbQ0KZnVuY3Rpb24gaGFuZGxlTW91c2VXaGVlbChlKSB7DQogICAgaWYgKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICANCiAgICAgICAgLy8gR2V0IG1vdXNlIHBvc2l0aW9uIHJlbGF0aXZlIHRvIGNvbnRhaW5lcg0KICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8NCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6DQogICAgICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICAgIA0KICAgICAgICBjb25zdCBtb3VzZUNvb3JkcyA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMpID8NCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6DQogICAgICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgICAgIA0KICAgICAgICBjb25zdCBtb3VzZVggPSBtb3VzZUNvb3Jkcy54IC0gY29udGFpbmVyUmVjdC5sZWZ0Ow0KICAgICAgICBjb25zdCBtb3VzZVkgPSBtb3VzZUNvb3Jkcy55IC0gY29udGFpbmVyUmVjdC50b3A7DQogICAgICAgIA0KICAgICAgICAvLyBDYWxjdWxhdGUgem9vbSBkZWx0YQ0KICAgICAgICBjb25zdCB6b29tRGVsdGEgPSBlLmRlbHRhWSA+IDAgPyAtZmxvd0VkaXRvci56b29tU3RlcCA6IGZsb3dFZGl0b3Iuem9vbVN0ZXA7DQogICAgICAgIGNvbnN0IG5ld1pvb20gPSBNYXRoLm1heChmbG93RWRpdG9yLm1pblpvb20sIE1hdGgubWluKGZsb3dFZGl0b3IubWF4Wm9vbSwgZmxvd0VkaXRvci56b29tTGV2ZWwgKyB6b29tRGVsdGEpKTsNCiAgICAgICAgDQogICAgICAgIGlmIChuZXdab29tICE9PSBmbG93RWRpdG9yLnpvb21MZXZlbCkgew0KICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSBwb2ludCBpbiBjYW52YXMgY29vcmRpbmF0ZXMgdGhhdCBzaG91bGQgcmVtYWluIGZpeGVkICh1bmRlciBtb3VzZSkNCiAgICAgICAgICAgIGNvbnN0IGNhbnZhc1ggPSAobW91c2VYIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueCkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIGNvbnN0IGNhbnZhc1kgPSAobW91c2VZIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gVXBkYXRlIHpvb20gbGV2ZWwNCiAgICAgICAgICAgIGZsb3dFZGl0b3Iuem9vbUxldmVsID0gbmV3Wm9vbTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQWRqdXN0IHBhbiBvZmZzZXQgdG8ga2VlcCB0aGUgbW91c2UgcG9pbnQgZml4ZWQNCiAgICAgICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnggPSBtb3VzZVggLSBjYW52YXNYICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC55ID0gbW91c2VZIC0gY2FudmFzWSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUmVkcmF3IGNvbm5lY3Rpb25zIGFmdGVyIHpvb20NCiAgICAgICAgICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnpvb21SZWRyYXdUaW1lb3V0KTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3Iuem9vbVJlZHJhd1RpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgICAgICAgICAgfSwgNTApOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBIYW5kbGUgY2FudmFzIGNsaWNrIGV2ZW50cw0KZnVuY3Rpb24gaGFuZGxlQ2FudmFzQ2xpY2soZSkgew0KICAgIGlmIChlLnRhcmdldCA9PT0gZmxvd0VkaXRvci5jYW52YXMpIHsNCiAgICAgICAgLy8gRGVzZWxlY3Qgbm9kZQ0KICAgICAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpIHsNCiAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUpOw0KICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPSBudWxsOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUtY29uZmlnJykuaW5uZXJIVE1MID0gJzxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5TZWxlY3QgYSBub2RlIHRvIGNvbmZpZ3VyZSBpdDwvcD4nOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBIYW5kbGUgZG9jdW1lbnQgbW91c2UgZXZlbnRzIGZvciBzbW9vdGggZHJhZ2dpbmcNCmZ1bmN0aW9uIGhhbmRsZURvY3VtZW50TW91c2VEb3duKGUpIHsNCiAgICAvLyBEb24ndCBzdGFydCBkcmFnZ2luZyBpZiBjbGlja2luZyBvbiBVSSBlbGVtZW50cw0KICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KCcuZmxvdy10b29sYmFyJykgfHwgDQogICAgICAgIGUudGFyZ2V0LmNsb3Nlc3QoJy5mbG93LWNvbmZpZy1wYW5lbCcpIHx8IA0KICAgICAgICBlLnRhcmdldC5jbG9zZXN0KCcuZmxvdy1vdXRwdXQtcGFuZWwnKSB8fA0KICAgICAgICBlLnRhcmdldC5jbG9zZXN0KCcubm9kZS1kZWxldGUtYnRuJykpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBEb24ndCBzdGFydCBkcmFnZ2luZyBpZiB3ZSdyZSBwYW5uaW5nDQogICAgaWYgKGZsb3dFZGl0b3IuaXNQYW5uaW5nKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gT25seSBhbGxvdyBkcmFnZ2luZyBmcm9tIHRoZSBub2RlIGhlYWRlcg0KICAgIGNvbnN0IGhlYWRlckVsZW1lbnQgPSBlLnRhcmdldC5jbG9zZXN0KCcuZmxvdy1ub2RlLWhlYWRlcicpOw0KICAgIGlmICghaGVhZGVyRWxlbWVudCkgcmV0dXJuOw0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gaGVhZGVyRWxlbWVudC5jbG9zZXN0KCcuZmxvdy1ub2RlJyk7DQogICAgaWYgKCFub2RlRWxlbWVudCkgcmV0dXJuOw0KICAgIA0KICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgIGNvbnN0IG5vZGVJZCA9IG5vZGVFbGVtZW50LmlkOw0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIA0KICAgIGlmIChub2RlKSB7DQogICAgICAgIGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlID0gbm9kZUlkOw0KICAgICAgICANCiAgICAgICAgLy8gQ2FsY3VsYXRlIG9mZnNldCBmcm9tIG1vdXNlIHRvIG5vZGUgY29ybmVyLCBhY2NvdW50aW5nIGZvciB6b29tDQogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdCkgPyANCiAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6IA0KICAgICAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICANCiAgICAgICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/IA0KICAgICAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDogDQogICAgICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgICAgIA0KICAgICAgICAvLyBDb252ZXJ0IG1vdXNlIHBvc2l0aW9uIHRvIGNhbnZhcyBjb29yZGluYXRlcw0KICAgICAgICBjb25zdCBjYW52YXNNb3VzZVggPSAobW91c2VDb29yZHMueCAtIGNvbnRhaW5lclJlY3QubGVmdCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgIGNvbnN0IGNhbnZhc01vdXNlWSA9IChtb3VzZUNvb3Jkcy55IC0gY29udGFpbmVyUmVjdC50b3AgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICANCiAgICAgICAgLy8gQ2FsY3VsYXRlIG9mZnNldCBpbiBjYW52YXMgY29vcmRpbmF0ZXMNCiAgICAgICAgZmxvd0VkaXRvci5kcmFnT2Zmc2V0ID0gew0KICAgICAgICAgICAgeDogKGNhbnZhc01vdXNlWCAtIG5vZGUueCkgKiBmbG93RWRpdG9yLnpvb21MZXZlbCwNCiAgICAgICAgICAgIHk6IChjYW52YXNNb3VzZVkgLSBub2RlLnkpICogZmxvd0VkaXRvci56b29tTGV2ZWwNCiAgICAgICAgfTsNCiAgICAgICAgDQogICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLmN1cnNvciA9ICdncmFiYmluZyc7DQogICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLnpJbmRleCA9ICcxMDAwJzsgLy8gQnJpbmcgdG8gZnJvbnQgd2hpbGUgZHJhZ2dpbmcNCiAgICAgICAgDQogICAgICAgIC8vIENhY2hlIGNvbnRhaW5lciByZWN0IGZvciBwZXJmb3JtYW5jZQ0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhc1JlY3QgPSBjb250YWluZXJSZWN0Ow0KICAgIH0NCn0NCg0KZnVuY3Rpb24gaGFuZGxlRG9jdW1lbnRNb3VzZU1vdmUoZSkgew0KICAgIC8vIEhhbmRsZSBjYW52YXMgcGFubmluZw0KICAgIGlmIChmbG93RWRpdG9yLmlzUGFubmluZykgew0KICAgICAgICB1cGRhdGVDYW52YXNQYW4oZSk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gR2V0IHNjYWxlZCBjb29yZGluYXRlcw0KICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcykgPyANCiAgICAgICAgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDogDQogICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICANCiAgICAvLyBIYW5kbGUgdGFnIGRyYWdnaW5nDQogICAgaWYgKGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcgJiYgZmxvd0VkaXRvci50YWdEcmFnT2Zmc2V0KSB7DQogICAgICAgIGNvbnN0IHRhZyA9IGZsb3dFZGl0b3IudGFncy5nZXQoZmxvd0VkaXRvci5kcmFnZ2luZ1RhZyk7DQogICAgICAgIGlmICh0YWcpIHsNCiAgICAgICAgICAgIC8vIEdldCBjb250YWluZXIgZGltZW5zaW9ucyBmb3IgY29vcmRpbmF0ZSBjb252ZXJzaW9uDQogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/IA0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6IA0KICAgICAgICAgICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ29udmVydCBtb3VzZSBjb29yZGluYXRlcyB0byBjYW52YXMgY29vcmRpbmF0ZXMsIGFjY291bnRpbmcgZm9yIHBhbiBhbmQgem9vbQ0KICAgICAgICAgICAgY29uc3QgY2FudmFzTW91c2VYID0gKG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQgLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgY29uc3QgY2FudmFzTW91c2VZID0gKG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBuZXcgcG9zaXRpb24gd2l0aCBvZmZzZXQgKGRyYWcgb2Zmc2V0IGlzIGFsc28gaW4gc2NyZWVuIGNvb3JkaW5hdGVzLCBzbyBjb252ZXJ0IGl0KQ0KICAgICAgICAgICAgY29uc3QgZHJhZ09mZnNldFggPSBmbG93RWRpdG9yLnRhZ0RyYWdPZmZzZXQueCAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgY29uc3QgZHJhZ09mZnNldFkgPSBmbG93RWRpdG9yLnRhZ0RyYWdPZmZzZXQueSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICB0YWcueCA9IGNhbnZhc01vdXNlWCAtIGRyYWdPZmZzZXRYOw0KICAgICAgICAgICAgdGFnLnkgPSBjYW52YXNNb3VzZVkgLSBkcmFnT2Zmc2V0WTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcpOw0KICAgICAgICAgICAgaWYgKHRhZ0VsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICAvLyBVc2UgbGVmdC90b3AgZm9yIHBvc2l0aW9uaW5nDQogICAgICAgICAgICAgICAgdGFnRWxlbWVudC5zdHlsZS5sZWZ0ID0gdGFnLnggKyAncHgnOw0KICAgICAgICAgICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUudG9wID0gdGFnLnkgKyAncHgnOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBUaHJvdHRsZSB1cGRhdGVzIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2UNCiAgICAgICAgICAgIGlmICghZmxvd0VkaXRvci50YWdVcGRhdGVUaW1lb3V0KSB7DQogICAgICAgICAgICAgICAgZmxvd0VkaXRvci50YWdVcGRhdGVUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IudGFnVXBkYXRlVGltZW91dCA9IG51bGw7DQogICAgICAgICAgICAgICAgfSwgMTYpOyAvLyB+NjBmcHMNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGlmIChmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSAmJiBmbG93RWRpdG9yLmRyYWdPZmZzZXQpIHsNCiAgICAgICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKTsNCiAgICAgICAgaWYgKG5vZGUpIHsNCiAgICAgICAgICAgIC8vIEdldCBjb250YWluZXIgZGltZW5zaW9ucyBmb3IgY29vcmRpbmF0ZSBjb252ZXJzaW9uDQogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KSA/IA0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6IA0KICAgICAgICAgICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ29udmVydCBtb3VzZSBjb29yZGluYXRlcyB0byBjYW52YXMgY29vcmRpbmF0ZXMsIGFjY291bnRpbmcgZm9yIHBhbiBhbmQgem9vbQ0KICAgICAgICAgICAgY29uc3QgY2FudmFzTW91c2VYID0gKG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQgLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgY29uc3QgY2FudmFzTW91c2VZID0gKG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBuZXcgcG9zaXRpb24gd2l0aCBvZmZzZXQgKGRyYWcgb2Zmc2V0IGlzIGFsc28gaW4gc2NyZWVuIGNvb3JkaW5hdGVzLCBzbyBjb252ZXJ0IGl0KQ0KICAgICAgICAgICAgY29uc3QgZHJhZ09mZnNldFggPSBmbG93RWRpdG9yLmRyYWdPZmZzZXQueCAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgY29uc3QgZHJhZ09mZnNldFkgPSBmbG93RWRpdG9yLmRyYWdPZmZzZXQueSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBub2RlLnggPSBjYW52YXNNb3VzZVggLSBkcmFnT2Zmc2V0WDsNCiAgICAgICAgICAgIG5vZGUueSA9IGNhbnZhc01vdXNlWSAtIGRyYWdPZmZzZXRZOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKTsNCiAgICAgICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLmxlZnQgPSBub2RlLnggKyAncHgnOw0KICAgICAgICAgICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLnRvcCA9IG5vZGUueSArICdweCc7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gVXBkYXRlIGFsbCBjb25uZWN0aW9ucyBmb3IgdGhpcyBub2RlICh0aHJvdHRsZWQgZm9yIHBlcmZvcm1hbmNlKQ0KICAgICAgICAgICAgICAgIGlmICghZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0KSB7DQogICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IudXBkYXRlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ29ubmVjdGlvbnNGb3JOb2RlKG5vZGUuaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0ID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgfSwgMTYpOyAvLyB+NjBmcHMNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQoNCmZ1bmN0aW9uIGhhbmRsZURvY3VtZW50TW91c2VVcChlKSB7DQogICAgLy8gSGFuZGxlIGNhbnZhcyBwYW5uaW5nIHN0b3ANCiAgICBpZiAoZmxvd0VkaXRvci5pc1Bhbm5pbmcpIHsNCiAgICAgICAgc3RvcENhbnZhc1BhbigpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIEhhbmRsZSB0YWcgZHJhZ2dpbmcgc3RvcA0KICAgIGlmIChmbG93RWRpdG9yLmRyYWdnaW5nVGFnKSB7DQogICAgICAgIGNvbnN0IHRhZ0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmbG93RWRpdG9yLmRyYWdnaW5nVGFnKTsNCiAgICAgICAgaWYgKHRhZ0VsZW1lbnQpIHsNCiAgICAgICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInOw0KICAgICAgICAgICAgdGFnRWxlbWVudC5zdHlsZS56SW5kZXggPSAnMTAwJzsNCiAgICAgICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUudHJhbnNpdGlvbiA9ICdib3gtc2hhZG93IDAuMnMgZWFzZSwgdHJhbnNmb3JtIDAuMnMgZWFzZSc7IC8vIFJlc3RvcmUgdHJhbnNpdGlvbnMNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgZmxvd0VkaXRvci5kcmFnZ2luZ1RhZyA9IG51bGw7DQogICAgICAgIGZsb3dFZGl0b3IudGFnRHJhZ09mZnNldCA9IG51bGw7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgaWYgKGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKSB7DQogICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUpOw0KICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLmN1cnNvciA9ICdncmFiJzsNCiAgICAgICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLnpJbmRleCA9ICcnOyAvLyBSZXNldCB6LWluZGV4DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIENsZWFyIGFueSBwZW5kaW5nIGNvbm5lY3Rpb24gdXBkYXRlcw0KICAgICAgICBpZiAoZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0KSB7DQogICAgICAgICAgICBjbGVhclRpbWVvdXQoZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0KTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IudXBkYXRlVGltZW91dCA9IG51bGw7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEZpbmFsIGNvbm5lY3Rpb24gdXBkYXRlDQogICAgICAgIHVwZGF0ZUNvbm5lY3Rpb25zRm9yTm9kZShmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSk7DQogICAgICAgIA0KICAgICAgICBmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSA9IG51bGw7DQogICAgICAgIGZsb3dFZGl0b3IuZHJhZ09mZnNldCA9IG51bGw7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzUmVjdCA9IG51bGw7DQogICAgfQ0KfQ0KDQoNCi8vIEV4YW1wbGU6IGNhbnZhcy1tYW5hZ2VyLmpzDQp3aW5kb3cuY2FudmFzTWFuYWdlciA9IHsNCiAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0sDQogICAgc3RhcnRDYW52YXNQYW4sDQogICAgdXBkYXRlQ2FudmFzUGFuLA0KICAgIHN0b3BDYW52YXNQYW4sDQogICAgcmVzZXRDYW52YXNQYW4sDQogICAgaGFuZGxlQ2FudmFzQ2xpY2ssDQogICAgaGFuZGxlRG9jdW1lbnRNb3VzZURvd24sDQogICAgaGFuZGxlRG9jdW1lbnRNb3VzZU1vdmUsDQogICAgaGFuZGxlRG9jdW1lbnRNb3VzZVVwLA0KICAgIHpvb21JbiwNCiAgICB6b29tT3V0LA0KICAgIHNldFpvb21MZXZlbCwNCiAgICB6b29tVG9GaXQsDQogICAgaGFuZGxlTW91c2VXaGVlbA0KfTsNCg0KDQovLyBBZGQgYSBuZXcgdGFnIGF0IGN1cnJlbnQgdmlld3BvcnQgY2VudGVyDQphc3luYyBmdW5jdGlvbiBhZGRUYWcoKSB7DQogICAgY29uc3QgdGFnTmFtZSA9IGF3YWl0IHN5cG5leEFQSS5zaG93SW5wdXRNb2RhbCgNCiAgICAgICAgJ0NyZWF0ZSBOZXcgVGFnJywNCiAgICAgICAgJ1RhZyBOYW1lOicsDQogICAgICAgIHsNCiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnRW50ZXIgdGFnIG5hbWUnLA0KICAgICAgICAgICAgY29uZmlybVRleHQ6ICdDcmVhdGUgVGFnJywNCiAgICAgICAgICAgIGNhbmNlbFRleHQ6ICdDYW5jZWwnLA0KICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS10YWcnDQogICAgICAgIH0NCiAgICApOw0KICAgIA0KICAgIGlmICghdGFnTmFtZSB8fCB0YWdOYW1lLnRyaW0oKSA9PT0gJycpIHJldHVybjsNCg0KICAgIGNvbnN0IHRhZ0lkID0gYHRhZ18keysrZmxvd0VkaXRvci50YWdDb3VudGVyfWA7DQoNCiAgICAvLyBDYWxjdWxhdGUgcG9zaXRpb24gYXQgY3VycmVudCB2aWV3cG9ydCBjZW50ZXINCiAgICAvLyBHZXQgY2VudGVyIHBvc2l0aW9uIGluIGNhbnZhcyBjb29yZGluYXRlcw0KICAgIGNvbnN0IGNlbnRlciA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMgPyANCiAgICAgICAgd2luZG93LmZsb3dFZGl0b3JVdGlscy5nZXRWaWV3cG9ydENlbnRlckluQ2FudmFzKCkgOg0KICAgICAgICB7IHg6IDUwMDAsIHk6IDUwMDAgfTsgLy8gRmFsbGJhY2sgdG8gY2FudmFzIGNlbnRlcg0KDQogICAgY29uc3QgdGFnID0gew0KICAgICAgICBpZDogdGFnSWQsDQogICAgICAgIG5hbWU6IHRhZ05hbWUudHJpbSgpLA0KICAgICAgICBkZXNjcmlwdGlvbjogJycsDQogICAgICAgIHg6IGNlbnRlci54LA0KICAgICAgICB5OiBjZW50ZXIueSwNCiAgICAgICAgY29sb3I6ICcjNENBRjUwJyAvLyBHcmVlbiBjb2xvcg0KICAgIH07DQoNCiAgICBmbG93RWRpdG9yLnRhZ3Muc2V0KHRhZ0lkLCB0YWcpOw0KICAgIGNyZWF0ZVRhZ0VsZW1lbnQodGFnKTsNCiAgICB1cGRhdGVUYWdQYW5lbCgpOw0KDQp9DQoNCi8vIENyZWF0ZSB0YWcgZWxlbWVudCBvbiBjYW52YXMNCmZ1bmN0aW9uIGNyZWF0ZVRhZ0VsZW1lbnQodGFnKSB7DQogICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIHRhZ0VsZW1lbnQuaWQgPSB0YWcuaWQ7DQogICAgdGFnRWxlbWVudC5jbGFzc05hbWUgPSAnY2FudmFzLXRhZyc7DQogICAgdGFnRWxlbWVudC5zdHlsZS5jc3NUZXh0ID0gYA0KICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgICAgIGxlZnQ6ICR7dGFnLnh9cHg7DQogICAgICAgIHRvcDogJHt0YWcueX1weDsNCiAgICAgICAgYmFja2dyb3VuZDogJHt0YWcuY29sb3J9Ow0KICAgICAgICBjb2xvcjogd2hpdGU7DQogICAgICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICAgICAgY3Vyc29yOiBwb2ludGVyOw0KICAgICAgICB1c2VyLXNlbGVjdDogbm9uZTsNCiAgICAgICAgei1pbmRleDogMTAwOw0KICAgICAgICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLDAsMCwwLjIpOw0KICAgICAgICB0cmFuc2l0aW9uOiBib3gtc2hhZG93IDAuMnMgZWFzZSwgdHJhbnNmb3JtIDAuMnMgZWFzZTsNCiAgICBgOw0KICAgIHRhZ0VsZW1lbnQudGV4dENvbnRlbnQgPSB0YWcubmFtZTsNCg0KICAgIC8vIE1ha2UgdGFnIGRyYWdnYWJsZQ0KICAgIHRhZ0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGUpID0+IHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICBzdGFydERyYWdnaW5nVGFnKHRhZy5pZCwgZSk7DQogICAgfSk7DQoNCiAgICAvLyBDbGljayB0byBqdW1wIHRvIHRhZw0KICAgIHRhZ0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICBpZiAoIWZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcpIHsNCiAgICAgICAgICAgIGp1bXBUb1RhZyh0YWcuaWQpOw0KICAgICAgICB9DQogICAgfSk7DQoNCiAgICAvLyBIb3ZlciBlZmZlY3RzDQogICAgdGFnRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4gew0KICAgICAgICB0YWdFbGVtZW50LnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxLjA1KSc7DQogICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUuYm94U2hhZG93ID0gJzAgNHB4IDhweCByZ2JhKDAsMCwwLDAuMyknOw0KICAgIH0pOw0KDQogICAgdGFnRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4gew0KICAgICAgICB0YWdFbGVtZW50LnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxKSc7DQogICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUuYm94U2hhZG93ID0gJzAgMnB4IDRweCByZ2JhKDAsMCwwLDAuMiknOw0KICAgIH0pOw0KDQogICAgZmxvd0VkaXRvci5jYW52YXMuYXBwZW5kQ2hpbGQodGFnRWxlbWVudCk7DQp9DQoNCi8vIFN0YXJ0IGRyYWdnaW5nIGEgdGFnDQpmdW5jdGlvbiBzdGFydERyYWdnaW5nVGFnKHRhZ0lkLCBlKSB7DQogICAgY29uc3QgdGFnID0gZmxvd0VkaXRvci50YWdzLmdldCh0YWdJZCk7DQogICAgaWYgKCF0YWcpIHJldHVybjsNCg0KICAgIGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcgPSB0YWdJZDsNCg0KICAgIC8vIENhbGN1bGF0ZSBvZmZzZXQgZnJvbSBtb3VzZSB0byB0YWcgY29ybmVyLCBhY2NvdW50aW5nIGZvciB6b29tDQogICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QpID8gDQogICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6IA0KICAgICAgICBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgDQogICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/IA0KICAgICAgICBzeXBuZXhBUEkuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOiANCiAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgIA0KICAgIC8vIENvbnZlcnQgbW91c2UgcG9zaXRpb24gdG8gY2FudmFzIGNvb3JkaW5hdGVzDQogICAgY29uc3QgY2FudmFzTW91c2VYID0gKG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQgLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIGNvbnN0IGNhbnZhc01vdXNlWSA9IChtb3VzZUNvb3Jkcy55IC0gY29udGFpbmVyUmVjdC50b3AgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBvZmZzZXQgaW4gY2FudmFzIGNvb3JkaW5hdGVzDQogICAgZmxvd0VkaXRvci50YWdEcmFnT2Zmc2V0ID0gew0KICAgICAgICB4OiAoY2FudmFzTW91c2VYIC0gdGFnLngpICogZmxvd0VkaXRvci56b29tTGV2ZWwsDQogICAgICAgIHk6IChjYW52YXNNb3VzZVkgLSB0YWcueSkgKiBmbG93RWRpdG9yLnpvb21MZXZlbA0KICAgIH07DQoNCiAgICBjb25zdCB0YWdFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFnSWQpOw0KICAgIHRhZ0VsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ2dyYWJiaW5nJzsNCiAgICB0YWdFbGVtZW50LnN0eWxlLnpJbmRleCA9ICcxMDAxJzsNCiAgICB0YWdFbGVtZW50LnN0eWxlLnRyYW5zaXRpb24gPSAnbm9uZSc7IC8vIERpc2FibGUgdHJhbnNpdGlvbnMgZHVyaW5nIGRyYWcNCn0NCg0KLy8gSnVtcCB0byB0YWcgbG9jYXRpb24NCmZ1bmN0aW9uIGp1bXBUb1RhZyh0YWdJZCkgew0KICAgIGNvbnN0IHRhZyA9IGZsb3dFZGl0b3IudGFncy5nZXQodGFnSWQpOw0KICAgIGlmICghdGFnKSByZXR1cm47DQoNCiAgICAvLyBBZGQgc21vb3RoIHRyYW5zaXRpb24NCiAgICBmbG93RWRpdG9yLmNhbnZhcy5zdHlsZS50cmFuc2l0aW9uID0gJ3RyYW5zZm9ybSAwLjVzIGVhc2Utb3V0JzsNCg0KICAgIC8vIFVzZSB1dGlsaXR5IGZ1bmN0aW9uIHRvIGNlbnRlciB2aWV3cG9ydCBvbiB0YWcgY29vcmRpbmF0ZXMNCiAgICBpZiAod2luZG93LmZsb3dFZGl0b3JVdGlscyAmJiB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmNlbnRlclZpZXdwb3J0T25DYW52YXMpIHsNCiAgICAgICAgd2luZG93LmZsb3dFZGl0b3JVdGlscy5jZW50ZXJWaWV3cG9ydE9uQ2FudmFzKHRhZy54LCB0YWcueSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gRmFsbGJhY2sgbWV0aG9kDQogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICAgIA0KICAgICAgICBjb25zdCB2aWV3cG9ydENlbnRlclggPSBjb250YWluZXJSZWN0LndpZHRoIC8gMjsNCiAgICAgICAgY29uc3Qgdmlld3BvcnRDZW50ZXJZID0gY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyOw0KICAgICAgICANCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IHZpZXdwb3J0Q2VudGVyWCAtICh0YWcueCAqIGZsb3dFZGl0b3Iuem9vbUxldmVsKTsNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IHZpZXdwb3J0Q2VudGVyWSAtICh0YWcueSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsKTsNCiAgICAgICAgDQogICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgIH0NCg0KICAgIC8vIFJlbW92ZSB0cmFuc2l0aW9uIGFmdGVyIGFuaW1hdGlvbiBjb21wbGV0ZXMNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICcnOw0KICAgIH0sIDUwMCk7DQp9DQoNCi8vIFVwZGF0ZSB0YWcgcGFuZWwNCmZ1bmN0aW9uIHVwZGF0ZVRhZ1BhbmVsKCkgew0KICAgIGNvbnN0IHRhZ1BhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RhZy1wYW5lbCcpOw0KICAgIGlmICghdGFnUGFuZWwpIHJldHVybjsNCg0KICAgIGlmIChmbG93RWRpdG9yLnRhZ3Muc2l6ZSA9PT0gMCkgew0KICAgICAgICB0YWdQYW5lbC5pbm5lckhUTUwgPSAnPHAgY2xhc3M9InRleHQtbXV0ZWQiPk5vIHRhZ3MgeWV0PC9wPic7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBsZXQgdGFnSHRtbCA9ICcnOw0KICAgIGZsb3dFZGl0b3IudGFncy5mb3JFYWNoKHRhZyA9PiB7DQogICAgICAgIHRhZ0h0bWwgKz0gYA0KICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFnLWl0ZW0iIGRhdGEtdGFnLWlkPSIke3RhZy5pZH0iPg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRhZy1jb2xvciIgc3R5bGU9ImJhY2tncm91bmQ6ICR7dGFnLmNvbG9yfSI+PC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFnLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWctbmFtZSI+JHt0YWcubmFtZX08L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgJHt0YWcuZGVzY3JpcHRpb24gPyBgPGRpdiBjbGFzcz0idGFnLWRlc2NyaXB0aW9uIj4ke3RhZy5kZXNjcmlwdGlvbn08L2Rpdj5gIDogJyd9DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0idGFnLWRlbGV0ZSIgZGF0YS10YWctaWQ9IiR7dGFnLmlkfSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtdGltZXMiPjwvaT4NCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICBgOw0KICAgIH0pOw0KDQogICAgdGFnUGFuZWwuaW5uZXJIVE1MID0gdGFnSHRtbDsNCg0KICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lcnMNCiAgICB0YWdQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcudGFnLWl0ZW0nKS5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgIGlmICghZS50YXJnZXQuY2xvc2VzdCgnLnRhZy1kZWxldGUnKSkgew0KICAgICAgICAgICAgICAgIGNvbnN0IHRhZ0lkID0gaXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFnLWlkJyk7DQogICAgICAgICAgICAgICAganVtcFRvVGFnKHRhZ0lkKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfSk7DQoNCiAgICB0YWdQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcudGFnLWRlbGV0ZScpLmZvckVhY2goYnRuID0+IHsNCiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICBjb25zdCB0YWdJZCA9IGJ0bi5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFnLWlkJyk7DQogICAgICAgICAgICBkZWxldGVUYWcodGFnSWQpOw0KICAgICAgICB9KTsNCiAgICB9KTsNCn0NCg0KLy8gRGVsZXRlIGEgdGFnDQphc3luYyBmdW5jdGlvbiBkZWxldGVUYWcodGFnSWQpIHsNCiAgICBjb25zdCBjb25maXJtZWQgPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0NvbmZpcm1hdGlvbigNCiAgICAgICAgJ0RlbGV0ZSBUYWcnLA0KICAgICAgICAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIHRhZz8nLA0KICAgICAgICB7DQogICAgICAgICAgICB0eXBlOiAnZGFuZ2VyJywNCiAgICAgICAgICAgIGNvbmZpcm1UZXh0OiAnRGVsZXRlJywNCiAgICAgICAgICAgIGNhbmNlbFRleHQ6ICdDYW5jZWwnLA0KICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS10YWcnDQogICAgICAgIH0NCiAgICApOw0KICAgIA0KICAgIGlmIChjb25maXJtZWQpIHsNCiAgICAgICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhZ0lkKTsNCiAgICAgICAgaWYgKHRhZ0VsZW1lbnQpIHsNCiAgICAgICAgICAgIHRhZ0VsZW1lbnQucmVtb3ZlKCk7DQogICAgICAgIH0NCiAgICAgICAgZmxvd0VkaXRvci50YWdzLmRlbGV0ZSh0YWdJZCk7DQogICAgICAgIHVwZGF0ZVRhZ1BhbmVsKCk7DQogICAgfQ0KfQ0KDQovLyBFeGFtcGxlOiB0YWctbWFuYWdlci5qcw0Kd2luZG93LnRhZ01hbmFnZXIgPSB7DQogICAgYWRkVGFnLA0KICAgIGNyZWF0ZVRhZ0VsZW1lbnQsDQogICAgc3RhcnREcmFnZ2luZ1RhZywNCiAgICBqdW1wVG9UYWcsDQogICAgdXBkYXRlVGFnUGFuZWwsDQogICAgZGVsZXRlVGFnDQp9Ow0KDQovLyBTYXZlIGZsb3cgdG8gdmlydHVhbCBmaWxlIHN5c3RlbQ0KYXN5bmMgZnVuY3Rpb24gc2F2ZUZsb3coKSB7DQogICAgY29uc3QgZmxvd0RhdGEgPSB7DQogICAgICAgIG5vZGVzOiBBcnJheS5mcm9tKGZsb3dFZGl0b3Iubm9kZXMudmFsdWVzKCkpLm1hcChub2RlID0+ICh7DQogICAgICAgICAgICBpZDogbm9kZS5pZCwNCiAgICAgICAgICAgIHR5cGU6IG5vZGUudHlwZSwNCiAgICAgICAgICAgIHg6IG5vZGUueCwNCiAgICAgICAgICAgIHk6IG5vZGUueSwNCiAgICAgICAgICAgIGNvbmZpZzogbm9kZS5jb25maWcNCiAgICAgICAgfSkpLA0KICAgICAgICBjb25uZWN0aW9uczogQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5tYXAoY29ubiA9PiAoew0KICAgICAgICAgICAgaWQ6IGNvbm4uaWQsDQogICAgICAgICAgICBmcm9tOiBjb25uLmZyb20sDQogICAgICAgICAgICB0bzogY29ubi50bw0KICAgICAgICB9KSksDQogICAgICAgIHRhZ3M6IEFycmF5LmZyb20oZmxvd0VkaXRvci50YWdzLnZhbHVlcygpKSwNCiAgICAgICAgbWV0YWRhdGE6IHsNCiAgICAgICAgICAgIHNhdmVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwNCiAgICAgICAgICAgIG5vZGVDb3VudDogZmxvd0VkaXRvci5ub2Rlcy5zaXplLA0KICAgICAgICAgICAgY29ubmVjdGlvbkNvdW50OiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnNpemUsDQogICAgICAgICAgICB0YWdDb3VudDogZmxvd0VkaXRvci50YWdzLnNpemUNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICB0cnkgew0KICAgICAgICBsZXQgZmlsZVBhdGggPSBmbG93RWRpdG9yLmN1cnJlbnRGaWxlUGF0aDsNCiAgICAgICAgDQogICAgICAgIC8vIElmIG5vIGN1cnJlbnQgZmlsZSBwYXRoLCBzaG93IGZpbGUgZXhwbG9yZXINCiAgICAgICAgaWYgKCFmaWxlUGF0aCkgew0KICAgICAgICAgICAgZmlsZVBhdGggPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0ZpbGVFeHBsb3Jlcih7DQogICAgICAgICAgICAgICAgbW9kZTogJ3NhdmUnLA0KICAgICAgICAgICAgICAgIHRpdGxlOiAnU2F2ZSBGbG93IEZpbGUnLA0KICAgICAgICAgICAgICAgIGluaXRpYWxQYXRoOiAnLycsDQogICAgICAgICAgICAgICAgZmlsZU5hbWU6ICdmbG93X3dvcmtmbG93Lmpzb24nLA0KICAgICAgICAgICAgICAgIGZpbGVFeHRlbnNpb246ICcuanNvbicsDQogICAgICAgICAgICAgICAgb25TZWxlY3Q6IChzZWxlY3RlZFBhdGgpID0+IHsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgICAgICByZXR1cm47IC8vIFVzZXIgY2FuY2VsbGVkDQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyBTYXZlIHRvIHZpcnR1YWwgZmlsZSBzeXN0ZW0NCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZUpTT04pIHsNCiAgICAgICAgICAgIGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlSlNPTihmaWxlUGF0aCwgZmxvd0RhdGEpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGggPSBmaWxlUGF0aDsNCiAgICAgICAgICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZsb3cgc2F2ZWQgdG86ICR7ZmlsZVBhdGh9YCwgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIEZhbGxiYWNrIHRvIGxvY2FsU3RvcmFnZQ0KICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2Zsb3dfZWRpdG9yX3NhdmVkX2Zsb3cnLCBKU09OLnN0cmluZ2lmeShmbG93RGF0YSkpOw0KICAgICAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbikgew0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdGbG93IHNhdmVkIHRvIGxvY2FsIHN0b3JhZ2UhJywgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIGZsb3c6JywgZXJyb3IpOw0KICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKSB7DQogICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignRmFpbGVkIHRvIHNhdmUgZmxvdzogJyArIGVycm9yLm1lc3NhZ2UsICdlcnJvcicpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBTYXZlIGZsb3cgYXMgKGFsd2F5cyBzaG93IGZpbGUgZXhwbG9yZXIpDQphc3luYyBmdW5jdGlvbiBzYXZlRmxvd0FzKCkgew0KICAgIGNvbnN0IGZsb3dEYXRhID0gew0KICAgICAgICBub2RlczogQXJyYXkuZnJvbShmbG93RWRpdG9yLm5vZGVzLnZhbHVlcygpKS5tYXAobm9kZSA9PiAoew0KICAgICAgICAgICAgaWQ6IG5vZGUuaWQsDQogICAgICAgICAgICB0eXBlOiBub2RlLnR5cGUsDQogICAgICAgICAgICB4OiBub2RlLngsDQogICAgICAgICAgICB5OiBub2RlLnksDQogICAgICAgICAgICBjb25maWc6IG5vZGUuY29uZmlnDQogICAgICAgIH0pKSwNCiAgICAgICAgY29ubmVjdGlvbnM6IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkubWFwKGNvbm4gPT4gKHsNCiAgICAgICAgICAgIGlkOiBjb25uLmlkLA0KICAgICAgICAgICAgZnJvbTogY29ubi5mcm9tLA0KICAgICAgICAgICAgdG86IGNvbm4udG8NCiAgICAgICAgfSkpLA0KICAgICAgICB0YWdzOiBBcnJheS5mcm9tKGZsb3dFZGl0b3IudGFncy52YWx1ZXMoKSksDQogICAgICAgIG1ldGFkYXRhOiB7DQogICAgICAgICAgICBzYXZlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksDQogICAgICAgICAgICBub2RlQ291bnQ6IGZsb3dFZGl0b3Iubm9kZXMuc2l6ZSwNCiAgICAgICAgICAgIGNvbm5lY3Rpb25Db3VudDogZmxvd0VkaXRvci5jb25uZWN0aW9ucy5zaXplLA0KICAgICAgICAgICAgdGFnQ291bnQ6IGZsb3dFZGl0b3IudGFncy5zaXplDQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgdHJ5IHsNCiAgICAgICAgLy8gU2hvdyBmaWxlIGV4cGxvcmVyIGZvciBzYXZpbmcNCiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0ZpbGVFeHBsb3Jlcih7DQogICAgICAgICAgICBtb2RlOiAnc2F2ZScsDQogICAgICAgICAgICB0aXRsZTogJ1NhdmUgRmxvdyBGaWxlIEFzJywNCiAgICAgICAgICAgIGluaXRpYWxQYXRoOiAnLycsDQogICAgICAgICAgICBmaWxlTmFtZTogJ2Zsb3dfd29ya2Zsb3cuanNvbicsDQogICAgICAgICAgICBmaWxlRXh0ZW5zaW9uOiAnLmpzb24nLA0KICAgICAgICAgICAgb25TZWxlY3Q6IChzZWxlY3RlZFBhdGgpID0+IHsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4gew0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCg0KICAgICAgICBpZiAoIWZpbGVQYXRoKSB7DQogICAgICAgICAgICByZXR1cm47IC8vIFVzZXIgY2FuY2VsbGVkDQogICAgICAgIH0NCg0KICAgICAgICAvLyBTYXZlIHRvIHZpcnR1YWwgZmlsZSBzeXN0ZW0NCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZUpTT04pIHsNCiAgICAgICAgICAgIGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlSlNPTihmaWxlUGF0aCwgZmxvd0RhdGEpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGggPSBmaWxlUGF0aDsNCiAgICAgICAgICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZsb3cgc2F2ZWQgYXM6ICR7ZmlsZVBhdGh9YCwgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIEZhbGxiYWNrIHRvIGxvY2FsU3RvcmFnZQ0KICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2Zsb3dfZWRpdG9yX3NhdmVkX2Zsb3cnLCBKU09OLnN0cmluZ2lmeShmbG93RGF0YSkpOw0KICAgICAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbikgew0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdGbG93IHNhdmVkIHRvIGxvY2FsIHN0b3JhZ2UhJywgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIGZsb3cgYXM6JywgZXJyb3IpOw0KICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKSB7DQogICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignRmFpbGVkIHRvIHNhdmUgZmxvdyBhczogJyArIGVycm9yLm1lc3NhZ2UsICdlcnJvcicpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBMb2FkIGZsb3cgZnJvbSB2aXJ0dWFsIGZpbGUgc3lzdGVtDQphc3luYyBmdW5jdGlvbiBsb2FkRmxvdygpIHsNCiAgICB0cnkgew0KICAgICAgICAvLyBTaG93IGZpbGUgZXhwbG9yZXIgZm9yIGxvYWRpbmcNCiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBhd2FpdCBzeXBuZXhBUEkuc2hvd0ZpbGVFeHBsb3Jlcih7DQogICAgICAgICAgICBtb2RlOiAnb3BlbicsDQogICAgICAgICAgICB0aXRsZTogJ0xvYWQgRmxvdyBGaWxlJywNCiAgICAgICAgICAgIGluaXRpYWxQYXRoOiAnLycsDQogICAgICAgICAgICBvblNlbGVjdDogKHNlbGVjdGVkUGF0aCkgPT4gew0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBjYW5jZWxsZWQNCiAgICAgICAgfQ0KDQogICAgICAgIGxldCBmbG93RGF0YSA9IG51bGw7DQogICAgICAgIA0KICAgICAgICAvLyBUcnkgdmlydHVhbCBmaWxlIHN5c3RlbSBmaXJzdA0KICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVKU09OKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIGZsb3dEYXRhID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZUpTT04oZmlsZVBhdGgpOw0KICAgICAgICAgICAgfSBjYXRjaCAodmZzRXJyb3IpIHsNCiAgICAgICAgICAgICAgICB0aHJvdyB2ZnNFcnJvcjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gRmFsbGJhY2sgdG8gbG9jYWxTdG9yYWdlIChmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSkNCiAgICAgICAgaWYgKCFmbG93RGF0YSkgew0KICAgICAgICAgICAgY29uc3QgbG9jYWxEYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Zsb3dfZWRpdG9yX3NhdmVkX2Zsb3cnKTsNCiAgICAgICAgICAgIGlmIChsb2NhbERhdGEpIHsNCiAgICAgICAgICAgICAgICBmbG93RGF0YSA9IEpTT04ucGFyc2UobG9jYWxEYXRhKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgaWYgKGZsb3dEYXRhKSB7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENsZWFyIGN1cnJlbnQgY2FudmFzICh3aXRob3V0IGNvbmZpcm1hdGlvbiBzaW5jZSB3ZSdyZSBsb2FkaW5nIGEgZmlsZSkNCiAgICAgICAgICAgIGNsZWFyQ2FudmFzU2lsZW50KCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFJlc2V0IHBhbiBvZmZzZXQgdG8gY2VudGVyIG9mIGxhcmdlIGNhbnZhcyBmb3IgbmV3IHdvcmtmbG93DQogICAgICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldCA9IHsgeDogLTUwMDAsIHk6IC01MDAwIH07DQogICAgICAgICAgICB3aW5kb3cuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUmVzZXQgbm9kZSBjb3VudGVyIHRvIGF2b2lkIElEIGNvbmZsaWN0cw0KICAgICAgICAgICAgZmxvd0VkaXRvci5ub2RlQ291bnRlciA9IDA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIExvYWQgbm9kZXMNCiAgICAgICAgICAgIGlmIChmbG93RGF0YS5ub2Rlcykgew0KICAgICAgICAgICAgICAgIGZsb3dEYXRhLm5vZGVzLmZvckVhY2gobm9kZURhdGEgPT4gew0KICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbm9kZSB3aXRoIHByb3BlciBJRA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBub2RlRGF0YS5pZDsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBub2RlSWQsDQogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBub2RlRGF0YS50eXBlLA0KICAgICAgICAgICAgICAgICAgICAgICAgeDogbm9kZURhdGEueCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHk6IG5vZGVEYXRhLnksDQogICAgICAgICAgICAgICAgICAgICAgICBjb25maWc6IG5vZGVEYXRhLmNvbmZpZywNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHt9DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgbm9kZSBjb3VudGVyDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVOdW0gPSBwYXJzZUludChub2RlSWQucmVwbGFjZSgnbm9kZV8nLCAnJykpOw0KICAgICAgICAgICAgICAgICAgICBpZiAobm9kZU51bSA+IGZsb3dFZGl0b3Iubm9kZUNvdW50ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3Iubm9kZUNvdW50ZXIgPSBub2RlTnVtOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLm5vZGVzLnNldChub2RlSWQsIG5vZGUpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5vZGUgZWxlbWVudCB1c2luZyB0aGUgcmVuZGVyZXIgYW5kIGFkZCB0byBjYW52YXMNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBub2RlUmVuZGVyZXIuY3JlYXRlTm9kZUVsZW1lbnQobm9kZSk7DQogICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLmFwcGVuZENoaWxkKG5vZGVFbGVtZW50KTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTG9hZCBjb25uZWN0aW9ucyBhZnRlciBub2RlcyBhcmUgZnVsbHkgY3JlYXRlZCBhbmQgcG9zaXRpb25lZA0KICAgICAgICAgICAgaWYgKGZsb3dEYXRhLmNvbm5lY3Rpb25zKSB7DQogICAgICAgICAgICAgICAgZmxvd0RhdGEuY29ubmVjdGlvbnMuZm9yRWFjaChjb25uRGF0YSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGNyZWF0ZUNvbm5lY3Rpb24oY29ubkRhdGEuZnJvbS5ub2RlSWQsIGNvbm5EYXRhLmZyb20ucG9ydE5hbWUsIGNvbm5EYXRhLnRvLm5vZGVJZCwgY29ubkRhdGEudG8ucG9ydE5hbWUpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIEltbWVkaWF0ZWx5IHJlZHJhdyBjb25uZWN0aW9ucyBub3cgdGhhdCBhbGwgU1ZHIGVsZW1lbnRzIGV4aXN0DQogICAgICAgICAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTG9hZCB0YWdzDQogICAgICAgICAgICBpZiAoZmxvd0RhdGEudGFncykgew0KICAgICAgICAgICAgICAgIGZsb3dEYXRhLnRhZ3MuZm9yRWFjaCh0YWdEYXRhID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFnID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHRhZ0RhdGEuaWQsDQogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0YWdEYXRhLm5hbWUsDQogICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdGFnRGF0YS5kZXNjcmlwdGlvbiB8fCAnJywNCiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRhZ0RhdGEueCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRhZ0RhdGEueSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiB0YWdEYXRhLmNvbG9yIHx8ICcjNENBRjUwJw0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRhZyBjb3VudGVyDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhZ051bSA9IHBhcnNlSW50KHRhZ0RhdGEuaWQucmVwbGFjZSgndGFnXycsICcnKSk7DQogICAgICAgICAgICAgICAgICAgIGlmICh0YWdOdW0gPiBmbG93RWRpdG9yLnRhZ0NvdW50ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IudGFnQ291bnRlciA9IHRhZ051bTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci50YWdzLnNldCh0YWdEYXRhLmlkLCB0YWcpOw0KICAgICAgICAgICAgICAgICAgICB3aW5kb3cudGFnTWFuYWdlci5jcmVhdGVUYWdFbGVtZW50KHRhZyk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBjZW50ZXIgb2YgbG9hZGVkIG5vZGVzIGFuZCBhZGp1c3QgcGFuIHRvIGNlbnRlciB0aGVtDQogICAgICAgICAgICBpZiAoZmxvd0RhdGEubm9kZXMgJiYgZmxvd0RhdGEubm9kZXMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgIGNvbnN0IG1pblggPSBNYXRoLm1pbiguLi5mbG93RGF0YS5ub2Rlcy5tYXAobiA9PiBuLngpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBtYXhYID0gTWF0aC5tYXgoLi4uZmxvd0RhdGEubm9kZXMubWFwKG4gPT4gbi54KSk7DQogICAgICAgICAgICAgICAgY29uc3QgbWluWSA9IE1hdGgubWluKC4uLmZsb3dEYXRhLm5vZGVzLm1hcChuID0+IG4ueSkpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG1heFkgPSBNYXRoLm1heCguLi5mbG93RGF0YS5ub2Rlcy5tYXAobiA9PiBuLnkpKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBjb25zdCBjZW50ZXJYID0gKG1pblggKyBtYXhYKSAvIDI7DQogICAgICAgICAgICAgICAgY29uc3QgY2VudGVyWSA9IChtaW5ZICsgbWF4WSkgLyAyOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIEdldCBjYW52YXMgY29udGFpbmVyIGRpbWVuc2lvbnMNCiAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHBhbiBvZmZzZXQgdG8gY2VudGVyIHRoZSBub2RlcyBpbiB0aGUgdmlld3BvcnQNCiAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gLWNlbnRlclggKyBjb250YWluZXJSZWN0LndpZHRoIC8gMjsNCiAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC55ID0gLWNlbnRlclkgKyBjb250YWluZXJSZWN0LmhlaWdodCAvIDI7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgd2luZG93LmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEZpbmFsIGNvbm5lY3Rpb24gcmVkcmF3IGFmdGVyIGFsbCBwb3NpdGlvbmluZyBpcyBjb21wbGV0ZQ0KICAgICAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gVXBkYXRlIHRhZyBwYW5lbA0KICAgICAgICAgICAgd2luZG93LnRhZ01hbmFnZXIudXBkYXRlVGFnUGFuZWwoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gVXBkYXRlIGN1cnJlbnQgZmlsZSBwYXRoDQogICAgICAgICAgICBmbG93RWRpdG9yLmN1cnJlbnRGaWxlUGF0aCA9IGZpbGVQYXRoOw0KICAgICAgICAgICAgdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24pIHsNCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbihgRmxvdyBsb2FkZWQgZnJvbTogJHtmaWxlUGF0aH1gLCAnc3VjY2VzcycpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbikgew0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKCdObyB2YWxpZCBmbG93IGRhdGEgZm91bmQgaW4gdGhlIHNlbGVjdGVkIGZpbGUuJywgJ3dhcm5pbmcnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIGZsb3c6JywgZXJyb3IpOw0KICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKSB7DQogICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignRmFpbGVkIHRvIGxvYWQgZmxvdzogJyArIGVycm9yLm1lc3NhZ2UsICdlcnJvcicpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBVcGRhdGUgZmlsZW5hbWUgZGlzcGxheQ0KZnVuY3Rpb24gdXBkYXRlRmlsZW5hbWVEaXNwbGF5KCkgew0KICAgIGNvbnN0IGZpbGVuYW1lRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXJyZW50LWZpbGVuYW1lJyk7DQogICAgaWYgKGZpbGVuYW1lRWxlbWVudCkgew0KICAgICAgICBjb25zdCBmaWxlbmFtZSA9IGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoID8gZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGguc3BsaXQoJy8nKS5wb3AoKSA6ICd1bnRpdGxlZC5mbG93JzsNCiAgICAgICAgZmlsZW5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZmlsZW5hbWU7DQogICAgfQ0KfQ0KDQoNCi8vIEV4cG9ydCB0byBnbG9iYWwgc2NvcGUNCndpbmRvdy5maWxlTWFuYWdlciA9IHsNCiAgICBzYXZlRmxvdywNCiAgICBzYXZlRmxvd0FzLA0KICAgIGxvYWRGbG93LA0KICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheQ0KfTsNCg0KDQovLyBQb3B1bGF0ZSB0b29sYm94IHdpdGggbG9hZGVkIG5vZGVzDQpmdW5jdGlvbiBwb3B1bGF0ZVRvb2xib3goKSB7DQogICAgY29uc3QgdG9vbGJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mbG93LXRvb2xib3gnKTsNCiAgICBpZiAoIXRvb2xib3gpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVG9vbGJveCBub3QgZm91bmQnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBDbGVhciBleGlzdGluZyB0b29sYm94IGNvbnRlbnQNCiAgICBjb25zdCB0b29sYm94Q29udGVudCA9IHRvb2xib3gucXVlcnlTZWxlY3RvcignLnRvb2xib3gtY29udGVudCcpOw0KICAgIGlmICh0b29sYm94Q29udGVudCkgew0KICAgICAgICB0b29sYm94Q29udGVudC5pbm5lckhUTUwgPSAnJzsNCiAgICB9DQogICAgDQogICAgLy8gR3JvdXAgbm9kZXMgYnkgY2F0ZWdvcnkNCiAgICBjb25zdCBjYXRlZ29yaWVzID0ge307DQogICAgY29uc3QgYWxsTm9kZXMgPSBub2RlUmVnaXN0cnkuZ2V0QWxsTm9kZVR5cGVzKCk7DQogICAgDQogICAgDQogICAgYWxsTm9kZXMuZm9yRWFjaChub2RlRGVmID0+IHsNCiAgICAgICAgY29uc3QgY2F0ZWdvcnkgPSBub2RlRGVmLmNhdGVnb3J5IHx8ICdvdGhlcic7DQogICAgICAgIGlmICghY2F0ZWdvcmllc1tjYXRlZ29yeV0pIHsNCiAgICAgICAgICAgIGNhdGVnb3JpZXNbY2F0ZWdvcnldID0gW107DQogICAgICAgIH0NCiAgICAgICAgY2F0ZWdvcmllc1tjYXRlZ29yeV0ucHVzaChub2RlRGVmKTsNCiAgICB9KTsNCiAgICANCiAgICANCiAgICAvLyBDcmVhdGUgdG9vbGJveCBzZWN0aW9ucyBmb3IgZWFjaCBjYXRlZ29yeQ0KICAgIE9iamVjdC5lbnRyaWVzKGNhdGVnb3JpZXMpLmZvckVhY2goKFtjYXRlZ29yeSwgbm9kZXNdKSA9PiB7DQogICAgICAgIGNvbnN0IGNhdGVnb3J5U2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgICAgICBjYXRlZ29yeVNlY3Rpb24uY2xhc3NOYW1lID0gJ25vZGUtY2F0ZWdvcnknOw0KICAgICAgICBjYXRlZ29yeVNlY3Rpb24uaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgPGg1PiR7Y2F0ZWdvcnkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBjYXRlZ29yeS5zbGljZSgxKX08L2g1Pg0KICAgICAgICAgICAgJHtub2Rlcy5tYXAobm9kZURlZiA9PiBgDQogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0idG9vbGJveC1ub2RlLWJ0biIgZGF0YS1ub2RlLXR5cGU9IiR7bm9kZURlZi5pZH0iIHRpdGxlPSIke25vZGVEZWYuZGVzY3JpcHRpb259Ij4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9IiR7bm9kZURlZi5pY29ufSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICA8c3Bhbj4ke25vZGVEZWYubmFtZX08L3NwYW4+DQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICBgKS5qb2luKCcnKX0NCiAgICAgICAgYDsNCiAgICAgICAgDQogICAgICAgIGlmICh0b29sYm94Q29udGVudCkgew0KICAgICAgICAgICAgdG9vbGJveENvbnRlbnQuYXBwZW5kQ2hpbGQoY2F0ZWdvcnlTZWN0aW9uKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIFJlLWF0dGFjaCBldmVudCBsaXN0ZW5lcnMNCiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudG9vbGJveC1ub2RlLWJ0bicpLmZvckVhY2goYnRuID0+IHsNCiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIGNvbnN0IG5vZGVUeXBlID0gYnRuLmdldEF0dHJpYnV0ZSgnZGF0YS1ub2RlLXR5cGUnKTsNCiAgICAgICAgICAgIGlmIChub2RlVHlwZSkgew0KICAgICAgICAgICAgICAgIGFkZE5vZGUobm9kZVR5cGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9KTsNCiAgICANCn0NCg0KLy8gU2V0IHVwIGV2ZW50IGhhbmRsZXJzDQpmdW5jdGlvbiBzZXR1cEV2ZW50SGFuZGxlcnMoKSB7DQogICAgLy8gTm90ZTogVG9vbGJveCBub2RlIGJ1dHRvbiBldmVudCBsaXN0ZW5lcnMgYXJlIHNldCB1cCBpbiBwb3B1bGF0ZVRvb2xib3goKQ0KICAgIC8vIHRvIGF2b2lkIGR1cGxpY2F0ZXMgd2hlbiB0aGUgdG9vbGJveCBpcyByZXBvcHVsYXRlZA0KICAgIA0KICAgIC8vIFdvcmtmbG93IGFjdGlvbnMNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncnVuLXdvcmtmbG93Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcnVuV29ya2Zsb3cpOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9wLXdvcmtmbG93Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3RvcFdvcmtmbG93KTsNCiAgICAvLyBOb3RlOiBkZWxldGUtc2VsZWN0ZWQsIGNsZWFyLWNhbnZhcywgcmVzZXQtdmlldywgYW5kIGFkZC10YWcgYXJlIG5vdyBoYW5kbGVkIGJ5IGhhbWJ1cmdlciBtZW51DQogICAgDQogICAgLy8gWm9vbSBjb250cm9scw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b29tLWluJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgd2luZG93LmNhbnZhc01hbmFnZXIuem9vbUluKTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9vbS1vdXQnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB3aW5kb3cuY2FudmFzTWFuYWdlci56b29tT3V0KTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9vbS1maXQnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB3aW5kb3cuY2FudmFzTWFuYWdlci56b29tVG9GaXQpOw0KICAgIA0KICAgIC8vIE5vdGU6IEZpbGUgb3BlcmF0aW9ucyAoc2F2ZSwgc2F2ZS1hcywgbG9hZCkgYXJlIG5vdyBoYW5kbGVkIGJ5IGhhbWJ1cmdlciBtZW51DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NsZWFyLW91dHB1dCcpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsZWFyT3V0cHV0KTsNCiAgICANCiAgICAvLyBIYW1idXJnZXIgbWVudQ0KICAgIHNldHVwSGFtYnVyZ2VyTWVudSgpOw0KICAgIA0KICAgIC8vIENvbmZpZyBwYW5lbCB0b2dnbGUNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlLWNvbmZpZycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZUNvbmZpZ1BhbmVsKTsNCiAgICANCiAgICAvLyBJbml0aWFsaXplIGNvbmZpZyBwYW5lbCBzdGF0ZSAod2l0aG91dCBvdmVycmlkaW5nIGljb25zKQ0KICAgIGNvbnN0IGNvbmZpZ1BhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zsb3ctY29uZmlnLXBhbmVsJyk7DQogICAgaWYgKGNvbmZpZ1BhbmVsKSB7DQogICAgICAgIC8vIERlZmF1bHQgZXhwYW5kZWQgKG5vdCBjb2xsYXBzZWQpDQogICAgICAgIGNvbmZpZ1BhbmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2NvbGxhcHNlZCcpOw0KICAgIH0NCiAgICANCiAgICAvLyBUb29sYm94IHRvZ2dsZQ0KICAgIGNvbnN0IHRvb2xib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy10b29sYm94Jyk7DQogICAgY29uc3QgdG9vbGJveENvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9vbGJveC1jb250ZW50Jyk7DQogICAgY29uc3QgdG9nZ2xlVG9vbGJveEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtdG9vbGJveCcpOw0KICAgIGlmICh0b29sYm94ICYmIHRvb2xib3hDb250ZW50ICYmIHRvZ2dsZVRvb2xib3hCdG4pIHsNCiAgICAgICAgLy8gRGVmYXVsdCBleHBhbmRlZCAobm90IGNvbGxhcHNlZCkNCiAgICAgICAgdG9vbGJveC5jbGFzc0xpc3QucmVtb3ZlKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgdG9vbGJveENvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICcnOw0KDQogICAgICAgIHRvZ2dsZVRvb2xib3hCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgIHRvZ2dsZVRvb2xib3goKTsNCiAgICAgICAgfSk7DQogICAgfQ0KICAgIA0KICAgIC8vIE91dHB1dCBwYW5lbCB0b2dnbGUNCiAgICBjb25zdCBvdXRwdXRQYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmbG93LW91dHB1dC1wYW5lbCcpOw0KICAgIGNvbnN0IG91dHB1dENvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3V0cHV0LWNvbnRlbnQnKTsNCiAgICBjb25zdCB0b2dnbGVPdXRwdXRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlLW91dHB1dCcpOw0KICAgIGlmIChvdXRwdXRQYW5lbCAmJiBvdXRwdXRDb250ZW50ICYmIHRvZ2dsZU91dHB1dEJ0bikgew0KICAgICAgICAvLyBEZWZhdWx0IGNvbGxhcHNlZA0KICAgICAgICBvdXRwdXRQYW5lbC5jbGFzc0xpc3QuYWRkKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgb3V0cHV0Q29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICB0b2dnbGVPdXRwdXRCdG4ucXVlcnlTZWxlY3RvcignaScpLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1kb3duJzsNCg0KICAgICAgICB0b2dnbGVPdXRwdXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgIGNvbnN0IGlzQ29sbGFwc2VkID0gb3V0cHV0UGFuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgICAgIGlmIChpc0NvbGxhcHNlZCkgew0KICAgICAgICAgICAgICAgIG91dHB1dFBhbmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2NvbGxhcHNlZCcpOw0KICAgICAgICAgICAgICAgIG91dHB1dENvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICcnOw0KICAgICAgICAgICAgICAgIHRvZ2dsZU91dHB1dEJ0bi5xdWVyeVNlbGVjdG9yKCdpJykuY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLXVwJzsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgb3V0cHV0UGFuZWwuY2xhc3NMaXN0LmFkZCgnY29sbGFwc2VkJyk7DQogICAgICAgICAgICAgICAgb3V0cHV0Q29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICAgIHRvZ2dsZU91dHB1dEJ0bi5xdWVyeVNlbGVjdG9yKCdpJykuY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLWRvd24nOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgDQogICAgLy8gQ2FudmFzIGV2ZW50cw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgd2luZG93LmNhbnZhc01hbmFnZXIuaGFuZGxlQ2FudmFzQ2xpY2spOw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnN0YXJ0Q2FudmFzUGFuKTsNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIHdpbmRvdy5jYW52YXNNYW5hZ2VyLmhhbmRsZU1vdXNlV2hlZWwsIHsgcGFzc2l2ZTogZmFsc2UgfSk7DQogICAgDQogICAgLy8gRG9jdW1lbnQtbGV2ZWwgbW91c2UgZXZlbnRzIGZvciBzbW9vdGggZHJhZ2dpbmcgYW5kIHBhbm5pbmcNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB3aW5kb3cuY2FudmFzTWFuYWdlci5oYW5kbGVEb2N1bWVudE1vdXNlRG93bik7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgd2luZG93LmNhbnZhc01hbmFnZXIuaGFuZGxlRG9jdW1lbnRNb3VzZU1vdmUpOw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB3aW5kb3cuY2FudmFzTWFuYWdlci5oYW5kbGVEb2N1bWVudE1vdXNlVXApOw0KICAgIA0KICAgIC8vIEtleWJvYXJkIHNob3J0Y3V0cw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVLZXlEb3duKTsNCn0NCg0KLy8gVG9nZ2xlIGNvbmZpZyBwYW5lbA0KZnVuY3Rpb24gdG9nZ2xlQ29uZmlnUGFuZWwoKSB7DQogICAgY29uc3QgY29uZmlnUGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy1jb25maWctcGFuZWwnKTsNCiAgICBjb25zdCB0b2dnbGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlLWNvbmZpZycpOw0KICAgIGNvbnN0IGljb24gPSB0b2dnbGVCdG4ucXVlcnlTZWxlY3RvcignaScpOw0KICAgIA0KICAgIGlmIChjb25maWdQYW5lbC5jbGFzc0xpc3QuY29udGFpbnMoJ2NvbGxhcHNlZCcpKSB7DQogICAgICAgIC8vIEV4cGFuZA0KICAgICAgICBjb25maWdQYW5lbC5jbGFzc0xpc3QucmVtb3ZlKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgaWNvbi5jbGFzc05hbWUgPSAnZmFzIGZhLWNoZXZyb24tcmlnaHQnOw0KICAgICAgICB0b2dnbGVCdG4udGl0bGUgPSAnQ29sbGFwc2UgQ29uZmlndXJhdGlvbiBQYW5lbCc7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gQ29sbGFwc2UNCiAgICAgICAgY29uZmlnUGFuZWwuY2xhc3NMaXN0LmFkZCgnY29sbGFwc2VkJyk7DQogICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLWxlZnQnOw0KICAgICAgICB0b2dnbGVCdG4udGl0bGUgPSAnRXhwYW5kIENvbmZpZ3VyYXRpb24gUGFuZWwnOw0KICAgIH0NCn0NCg0KLy8gVG9nZ2xlIHRvb2xib3gNCmZ1bmN0aW9uIHRvZ2dsZVRvb2xib3goKSB7DQogICAgY29uc3QgdG9vbGJveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmbG93LXRvb2xib3gnKTsNCiAgICBjb25zdCB0b29sYm94Q29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b29sYm94LWNvbnRlbnQnKTsNCiAgICBjb25zdCB0b2dnbGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlLXRvb2xib3gnKTsNCiAgICBjb25zdCBpY29uID0gdG9nZ2xlQnRuLnF1ZXJ5U2VsZWN0b3IoJ2knKTsNCiAgICANCiAgICBpZiAodG9vbGJveC5jbGFzc0xpc3QuY29udGFpbnMoJ2NvbGxhcHNlZCcpKSB7DQogICAgICAgIC8vIEV4cGFuZA0KICAgICAgICB0b29sYm94LmNsYXNzTGlzdC5yZW1vdmUoJ2NvbGxhcHNlZCcpOw0KICAgICAgICB0b29sYm94Q29udGVudC5zdHlsZS5kaXNwbGF5ID0gJyc7DQogICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLWxlZnQnOw0KICAgICAgICB0b2dnbGVCdG4udGl0bGUgPSAnQ29sbGFwc2UgVG9vbGJveCc7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gQ29sbGFwc2UNCiAgICAgICAgdG9vbGJveC5jbGFzc0xpc3QuYWRkKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgdG9vbGJveENvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgaWNvbi5jbGFzc05hbWUgPSAnZmFzIGZhLWNoZXZyb24tcmlnaHQnOw0KICAgICAgICB0b2dnbGVCdG4udGl0bGUgPSAnRXhwYW5kIFRvb2xib3gnOw0KICAgIH0NCn0NCg0KLy8gU2V0dXAgaGFtYnVyZ2VyIG1lbnUgZnVuY3Rpb25hbGl0eQ0KZnVuY3Rpb24gc2V0dXBIYW1idXJnZXJNZW51KCkgew0KICAgIGNvbnN0IGhhbWJ1cmdlckJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoYW1idXJnZXItbWVudScpOw0KICAgIGNvbnN0IGRyb3Bkb3duTWVudSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wZG93bi1tZW51Jyk7DQogICAgDQogICAgaWYgKCFoYW1idXJnZXJCdG4gfHwgIWRyb3Bkb3duTWVudSkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdIYW1idXJnZXIgbWVudSBlbGVtZW50cyBub3QgZm91bmQnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBUb2dnbGUgbWVudSBvbiBoYW1idXJnZXIgY2xpY2sNCiAgICBoYW1idXJnZXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICANCiAgICAgICAgLy8gUG9zaXRpb24gdGhlIGRyb3Bkb3duIHJlbGF0aXZlIHRvIHRoZSBoYW1idXJnZXIgYnV0dG9uDQogICAgICAgIGlmICghZHJvcGRvd25NZW51LmNsYXNzTGlzdC5jb250YWlucygnc2hvdycpKSB7DQogICAgICAgICAgICAvLyBVc2Ugc2NhbGVkIG1vdXNlIGNvb3JkaW5hdGVzIGZvciBtb3JlIGludHVpdGl2ZSBwb3NpdGlvbmluZw0KICAgICAgICAgICAgY29uc3QgbW91c2VDb29yZHMgPSAodHlwZW9mIHN5cG5leEFQSSAhPT0gJ3VuZGVmaW5lZCcgJiYgc3lwbmV4QVBJLmdldFNjYWxlZE1vdXNlQ29vcmRzKSA/IA0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6DQogICAgICAgICAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBoYW1idXJnZXJCdG4uY2xvc2VzdCgnLmZsb3ctZWRpdG9yLCAuYXBwLWNvbnRhaW5lcicpOw0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9ICh0eXBlb2Ygc3lwbmV4QVBJICE9PSAndW5kZWZpbmVkJyAmJiBzeXBuZXhBUEkuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0ICYmIGNvbnRhaW5lcikgPw0KICAgICAgICAgICAgICAgIHN5cG5leEFQSS5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6DQogICAgICAgICAgICAgICAgKGNvbnRhaW5lciA/IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSA6IHsgdG9wOiAwLCBsZWZ0OiAwIH0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBQb3NpdGlvbiByZWxhdGl2ZSB0byBtb3VzZSBjbGljaywgb2Zmc2V0IHNsaWdodGx5IHRvIGF2b2lkIGNvdmVyaW5nIHRoZSBidXR0b24NCiAgICAgICAgICAgIGNvbnN0IHJlbGF0aXZlVG9wID0gbW91c2VDb29yZHMueSAtIGNvbnRhaW5lclJlY3QudG9wICsgNTsNCiAgICAgICAgICAgIGNvbnN0IHJlbGF0aXZlTGVmdCA9IG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQgLSAxODAgLSAxMCArIDIwOyAvLyBNZW51IHdpZHRoICsgc21hbGwgZ2FwLCB0aGVuIDIwcHggbW9yZSB0byB0aGUgcmlnaHQNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZHJvcGRvd25NZW51LnN0eWxlLnRvcCA9IHJlbGF0aXZlVG9wICsgJ3B4JzsNCiAgICAgICAgICAgIGRyb3Bkb3duTWVudS5zdHlsZS5sZWZ0ID0gcmVsYXRpdmVMZWZ0ICsgJ3B4JzsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgZHJvcGRvd25NZW51LmNsYXNzTGlzdC50b2dnbGUoJ3Nob3cnKTsNCiAgICB9KTsNCiAgICANCiAgICAvLyBDbG9zZSBtZW51IHdoZW4gY2xpY2tpbmcgb3V0c2lkZQ0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgaWYgKCFkcm9wZG93bk1lbnUuY29udGFpbnMoZS50YXJnZXQpICYmICFoYW1idXJnZXJCdG4uY29udGFpbnMoZS50YXJnZXQpKSB7DQogICAgICAgICAgICBkcm9wZG93bk1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gSGFuZGxlIG1lbnUgaXRlbSBjbGlja3MgLSBPTkxZIHRoZSBzcGVjaWZpYyBhY3Rpb25zIHJlcXVlc3RlZA0KICAgIGRyb3Bkb3duTWVudS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgIGNvbnN0IG1lbnVJdGVtID0gZS50YXJnZXQuY2xvc2VzdCgnLm1lbnUtaXRlbScpOw0KICAgICAgICBpZiAoIW1lbnVJdGVtKSByZXR1cm47DQogICAgICAgIA0KICAgICAgICBjb25zdCBhY3Rpb24gPSBtZW51SXRlbS5kYXRhc2V0LmFjdGlvbjsNCiAgICAgICAgaWYgKCFhY3Rpb24pIHJldHVybjsNCiAgICAgICAgDQogICAgICAgIC8vIENsb3NlIHRoZSBtZW51DQogICAgICAgIGRyb3Bkb3duTWVudS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7DQogICAgICAgIA0KICAgICAgICAvLyBFeGVjdXRlIE9OTFkgdGhlIHJlcXVlc3RlZCBhY3Rpb25zOiBzYXZlLCBzYXZlLWFzLCBsb2FkLCBkZWxldGUsIGNsZWFyLWFsbCwgcmVzZXQtdmlldywgYWRkLXRhZw0KICAgICAgICBzd2l0Y2ggKGFjdGlvbikgew0KICAgICAgICAgICAgY2FzZSAnc2F2ZS1mbG93JzoNCiAgICAgICAgICAgICAgICBpZiAod2luZG93LmZpbGVNYW5hZ2VyICYmIHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvdykgew0KICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmlsZU1hbmFnZXIuc2F2ZUZsb3coKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzYXZlLWZsb3ctYXMnOg0KICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuZmlsZU1hbmFnZXIgJiYgd2luZG93LmZpbGVNYW5hZ2VyLnNhdmVGbG93QXMpIHsNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LmZpbGVNYW5hZ2VyLnNhdmVGbG93QXMoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdsb2FkLWZsb3cnOg0KICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuZmlsZU1hbmFnZXIgJiYgd2luZG93LmZpbGVNYW5hZ2VyLmxvYWRGbG93KSB7DQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5maWxlTWFuYWdlci5sb2FkRmxvdygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2FkZC10YWcnOg0KICAgICAgICAgICAgICAgIGlmICh3aW5kb3cudGFnTWFuYWdlciAmJiB3aW5kb3cudGFnTWFuYWdlci5hZGRUYWcpIHsNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LnRhZ01hbmFnZXIuYWRkVGFnKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAncmVzZXQtdmlldyc6DQogICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5jYW52YXNNYW5hZ2VyICYmIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnJlc2V0Q2FudmFzUGFuKSB7DQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnJlc2V0Q2FudmFzUGFuKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZGVsZXRlLXNlbGVjdGVkJzoNCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRlbGV0ZVNlbGVjdGVkTm9kZSA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgICAgICAgICBkZWxldGVTZWxlY3RlZE5vZGUoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdjbGVhci1jYW52YXMnOg0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY2xlYXJDYW52YXMgPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgICAgICAgICAgY2xlYXJDYW52YXMoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICB9KTsNCn0NCg0KLy8gRXhhbXBsZTogdWktbWFuYWdlci5qcw0Kd2luZG93LnVpTWFuYWdlciA9IHsNCiAgICBwb3B1bGF0ZVRvb2xib3gsDQogICAgc2V0dXBFdmVudEhhbmRsZXJzLA0KICAgIHRvZ2dsZUNvbmZpZ1BhbmVsLA0KICAgIHRvZ2dsZVRvb2xib3gNCn07DQoNCi8vIG1haW4uanMgLSBFbnRyeSBwb2ludCBmb3IgRmxvdyBFZGl0b3INCg0KLy8gR2xvYmFsIHZhcmlhYmxlcyAoc2NvcGVkIHRvIGF2b2lkIGdsb2JhbCBwb2xsdXRpb24pDQpsZXQgZmxvd0VkaXRvciA9IHsNCiAgICBub2RlczogbmV3IE1hcCgpLA0KICAgIGNvbm5lY3Rpb25zOiBuZXcgTWFwKCksDQogICAgc2VsZWN0ZWROb2RlOiBudWxsLA0KICAgIGRyYWdnaW5nTm9kZTogbnVsbCwNCiAgICBjb25uZWN0aW5nRnJvbTogbnVsbCwNCiAgICBjYW52YXM6IG51bGwsDQogICAgbm9kZUNvdW50ZXI6IDAsDQogICAgaXNSdW5uaW5nOiBmYWxzZSwNCiAgICBjdXJyZW50RmlsZVBhdGg6IG51bGwsDQogICAgaXNBY3RpdmU6IHRydWUsDQogICAgLy8gQ2FudmFzIHBhbm5pbmcgc3RhdGUNCiAgICBpc1Bhbm5pbmc6IGZhbHNlLA0KICAgIHBhblN0YXJ0OiB7IHg6IDAsIHk6IDAgfSwNCiAgICBwYW5PZmZzZXQ6IHsgeDogLTUwMDAsIHk6IC01MDAwIH0sIC8vIENlbnRlciB0aGUgbGFyZ2UgY2FudmFzIGluaXRpYWxseQ0KICAgIGxhc3RQYW5PZmZzZXQ6IHsgeDogLTUwMDAsIHk6IC01MDAwIH0sDQogICAgLy8gWm9vbSBzdGF0ZQ0KICAgIHpvb21MZXZlbDogMS4wLA0KICAgIG1pblpvb206IDAuMSwNCiAgICBtYXhab29tOiAzLjAsDQogICAgem9vbVN0ZXA6IDAuMSwNCiAgICAvLyBUYWcgc3lzdGVtDQogICAgdGFnczogbmV3IE1hcCgpLA0KICAgIHRhZ0NvdW50ZXI6IDAsDQogICAgZHJhZ2dpbmdUYWc6IG51bGwsDQogICAgdGFnRHJhZ09mZnNldDogbnVsbCwNCiAgICB0YWdVcGRhdGVUaW1lb3V0OiBudWxsDQp9Ow0KDQovLyBJbml0aWFsaXplIHdoZW4gRE9NIGlzIHJlYWR5DQphc3luYyBmdW5jdGlvbiBpbml0Rmxvd0VkaXRvcigpIHsNCiAgICANCiAgICAvLyBDaGVjayBpZiBTeXBuZXhBUEkgaXMgYXZhaWxhYmxlIChsb2NhbCB2YXJpYWJsZSBpbiBzYW5kYm94ZWQgZW52aXJvbm1lbnQpDQogICAgaWYgKHR5cGVvZiBzeXBuZXhBUEkgPT09ICd1bmRlZmluZWQnIHx8ICFzeXBuZXhBUEkpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCdTeXBuZXhBUEkgbm90IGF2YWlsYWJsZSAtIHJ1bm5pbmcgaW4gc3RhbmRhbG9uZSBtb2RlJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICANCiAgICAvLyBJbml0aWFsaXplIHNjYWxlIGRldGVjdGlvbiBmb3IgYXBwIHNjYWxpbmcgY29tcGVuc2F0aW9uDQogICAgaWYgKHR5cGVvZiBzeXBuZXhBUEkgIT09ICd1bmRlZmluZWQnICYmIHN5cG5leEFQSS5pbml0U2NhbGVEZXRlY3Rpb24pIHsNCiAgICAgICAgc3lwbmV4QVBJLmluaXRTY2FsZURldGVjdGlvbigobmV3U2NhbGUsIG9sZFNjYWxlKSA9PiB7DQogICAgICAgICAgICAvLyBSZWRyYXcgY29ubmVjdGlvbnMgd2hlbiBzY2FsZSBjaGFuZ2VzDQogICAgICAgICAgICBpZiAodHlwZW9mIHJlZHJhd0FsbENvbm5lY3Rpb25zID09PSAnZnVuY3Rpb24nKSB7DQogICAgICAgICAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfQ0KICAgIA0KICAgIC8vIFRlc3QgVkZTIEFQSQ0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHRlc3RSZXN1bHQgPSBhd2FpdCBzeXBuZXhBUEkubGlzdFZpcnR1YWxGaWxlcygnLycpOw0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1ZGUyBBUEkgdGVzdCBmYWlsZWQ6JywgZXJyb3IpOw0KICAgIH0NCiAgICANCiAgICAvLyBJbml0aWFsaXplIGNhbnZhcw0KICAgIGZsb3dFZGl0b3IuY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zsb3ctY2FudmFzJyk7DQogICAgaWYgKCFmbG93RWRpdG9yLmNhbnZhcykgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGbG93IGNhbnZhcyBub3QgZm91bmQnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBDcmVhdGUgU1ZHIG1hcmtlciBkZWZpbml0aW9ucyBmb3IgY29ubmVjdGlvbiBhcnJvd3MNCiAgICBjb25zdCBkZWZzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdkZWZzJyk7DQogICAgY29uc3QgbWFya2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdtYXJrZXInKTsNCiAgICBtYXJrZXIuc2V0QXR0cmlidXRlKCdpZCcsICdhcnJvd2hlYWQnKTsNCiAgICBtYXJrZXIuc2V0QXR0cmlidXRlKCdtYXJrZXJXaWR0aCcsICcxMCcpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ21hcmtlckhlaWdodCcsICc3Jyk7DQogICAgbWFya2VyLnNldEF0dHJpYnV0ZSgncmVmWCcsICc5Jyk7DQogICAgbWFya2VyLnNldEF0dHJpYnV0ZSgncmVmWScsICczLjUnKTsNCiAgICBtYXJrZXIuc2V0QXR0cmlidXRlKCdvcmllbnQnLCAnYXV0bycpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ21hcmtlclVuaXRzJywgJ3N0cm9rZVdpZHRoJyk7DQogICAgDQogICAgY29uc3QgcG9seWdvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWdvbicpOw0KICAgIHBvbHlnb24uc2V0QXR0cmlidXRlKCdwb2ludHMnLCAnMCAwLCAxMCAzLjUsIDAgNycpOw0KICAgIHBvbHlnb24uc2V0QXR0cmlidXRlKCdmaWxsJywgJyM0Q0FGNTAnKTsNCiAgICANCiAgICBtYXJrZXIuYXBwZW5kQ2hpbGQocG9seWdvbik7DQogICAgZGVmcy5hcHBlbmRDaGlsZChtYXJrZXIpOw0KICAgIA0KICAgIC8vIENyZWF0ZSBhIHRlbXBvcmFyeSBTVkcgY29udGFpbmVyIGZvciB0aGUgbWFya2VyIGRlZmluaXRpb24NCiAgICBjb25zdCBtYXJrZXJTdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpOw0KICAgIG1hcmtlclN2Zy5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7DQogICAgbWFya2VyU3ZnLnN0eWxlLndpZHRoID0gJzAnOw0KICAgIG1hcmtlclN2Zy5zdHlsZS5oZWlnaHQgPSAnMCc7DQogICAgbWFya2VyU3ZnLmFwcGVuZENoaWxkKGRlZnMpOw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFwcGVuZENoaWxkKG1hcmtlclN2Zyk7DQogICAgDQogICAgLy8gSW5pdGlhbGl6ZSBjYW52YXMgdHJhbnNmb3JtIGZvciBwYW5uaW5nDQogICAgd2luZG93LmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgDQogICAgLy8gTG9hZCBub2RlcyBmcm9tIFZGUw0KICAgIGF3YWl0IG5vZGVSZWdpc3RyeS5sb2FkTm9kZXNGcm9tVkZTKCk7DQogICAgDQogICAgLy8gUG9wdWxhdGUgdG9vbGJveCB3aXRoIGxvYWRlZCBub2Rlcw0KICAgIHdpbmRvdy51aU1hbmFnZXIucG9wdWxhdGVUb29sYm94KCk7DQogICAgDQogICAgLy8gU2V0IHVwIGV2ZW50IGhhbmRsZXJzDQogICAgd2luZG93LnVpTWFuYWdlci5zZXR1cEV2ZW50SGFuZGxlcnMoKTsNCiAgICANCiAgICAvLyBDb25uZWN0IHRvIFdlYlNvY2tldCBmb3IgcmVhbC10aW1lIHVwZGF0ZXMNCiAgICBjb25uZWN0V2ViU29ja2V0KCk7DQogICAgDQogICAgLy8gSGFuZGxlIHdpbmRvdyByZXNpemUgdG8gdXBkYXRlIGNvbm5lY3Rpb25zDQogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHsNCiAgICAgICAgc2V0VGltZW91dChyZWRyYXdBbGxDb25uZWN0aW9ucywgMTAwKTsNCiAgICB9KTsNCiAgICANCiAgICAvLyBIYW5kbGUgYXBwIGNsZWFudXAgd2hlbiB3aW5kb3cgaXMgdW5sb2FkZWQNCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgY2xlYW51cEZsb3dFZGl0b3IpOw0KICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwYWdlaGlkZScsIGNsZWFudXBGbG93RWRpdG9yKTsNCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndW5sb2FkJywgY2xlYW51cEZsb3dFZGl0b3IpOw0KICAgIA0KICAgIC8vIEZsb3cgRWRpdG9yIGxvYWRlZCBzdWNjZXNzZnVsbHkgKG5vIG5vdGlmaWNhdGlvbiBuZWVkZWQpDQogICAgDQogICAgLy8gVXBkYXRlIGZpbGVuYW1lIGRpc3BsYXkNCiAgICB3aW5kb3cuZmlsZU1hbmFnZXIudXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgDQp9DQoNCi8vIENsZWFudXAgZnVuY3Rpb24gdG8gcmVtb3ZlIHRvb2x0aXBzIGFuZCBldmVudCBsaXN0ZW5lcnMNCmZ1bmN0aW9uIGNsZWFudXBGbG93RWRpdG9yKCkgew0KICAgIC8vIE1hcmsgYXBwIGFzIGluYWN0aXZlIHRvIHByZXZlbnQgbmV3IHRvb2x0aXBzDQogICAgZmxvd0VkaXRvci5pc0FjdGl2ZSA9IGZhbHNlOw0KICAgIA0KICAgIC8vIFJlbW92ZSBhbnkgbGluZ2VyaW5nIHRvb2x0aXBzIChjaGVjayBtdWx0aXBsZSBwb3NzaWJsZSBsb2NhdGlvbnMpDQogICAgY29uc3QgdG9vbHRpcHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29ubmVjdGlvbi10b29sdGlwLCAjY29ubmVjdGlvbi10b29sdGlwJyk7DQogICAgdG9vbHRpcHMuZm9yRWFjaCh0b29sdGlwID0+IHsNCiAgICAgICAgaWYgKHRvb2x0aXAucGFyZW50Tm9kZSkgew0KICAgICAgICAgICAgdG9vbHRpcC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRvb2x0aXApOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gUmVtb3ZlIGdsb2JhbCBldmVudCBsaXN0ZW5lcnMNCiAgICBpZiAod2luZG93LmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlcikgew0KICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyKTsNCiAgICAgICAgd2luZG93LmZsb3dFZGl0b3JUb29sdGlwSGFuZGxlciA9IG51bGw7DQogICAgfQ0KICAgIA0KICAgIC8vIENsZWFyIGFueSBvdGhlciBnbG9iYWwgcmVmZXJlbmNlcw0KICAgIGlmICh3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyKSB7DQogICAgICAgIGRlbGV0ZSB3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyOw0KICAgIH0NCiAgICANCiAgICAvLyBBbHNvIHJlbW92ZSBhbnkgdG9vbHRpcHMgdGhhdCBtaWdodCBiZSBpbiB0aGUgYm9keQ0KICAgIGNvbnN0IGJvZHlUb29sdGlwcyA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvckFsbCgnLmNvbm5lY3Rpb24tdG9vbHRpcCcpOw0KICAgIGJvZHlUb29sdGlwcy5mb3JFYWNoKHRvb2x0aXAgPT4gew0KICAgICAgICBpZiAodG9vbHRpcC5wYXJlbnROb2RlKSB7DQogICAgICAgICAgICB0b29sdGlwLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodG9vbHRpcCk7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCn0NCg0KLy8gQ29ubmVjdCB0byBXZWJTb2NrZXQgc2VydmVyDQphc3luYyBmdW5jdGlvbiBjb25uZWN0V2ViU29ja2V0KCkgew0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IGNvbm5lY3RlZCA9IGF3YWl0IHN5cG5leEFQSS5jb25uZWN0U29ja2V0KCk7DQogICAgICAgIGlmIChjb25uZWN0ZWQpIHsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gSm9pbiBmbG93IGVkaXRvciByb29tDQogICAgICAgICAgICBzeXBuZXhBUEkuam9pblJvb20oJ2Zsb3ctZWRpdG9yJyk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIExpc3RlbiBmb3IgbWVzc2FnZXMNCiAgICAgICAgICAgIHN5cG5leEFQSS5vbignZmxvd191cGRhdGUnLCAoZGF0YSkgPT4gew0KICAgICAgICAgICAgICAgIGhhbmRsZUZsb3dVcGRhdGUoZGF0YSk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gU2VuZCBpbml0aWFsIGNvbm5lY3Rpb24gbWVzc2FnZQ0KICAgICAgICAgICAgc3lwbmV4QVBJLnNlbmRNZXNzYWdlKCdmbG93X2Nvbm5lY3RlZCcsIHsNCiAgICAgICAgICAgICAgICBhcHBJZDogc3lwbmV4QVBJLmdldEFwcElkKCksDQogICAgICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpDQogICAgICAgICAgICB9LCAnZmxvdy1lZGl0b3InKTsNCiAgICAgICAgICAgIA0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGNvbm5lY3QgdG8gV2ViU29ja2V0IHNlcnZlcicpOw0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignV2ViU29ja2V0IGNvbm5lY3Rpb24gZXJyb3I6JywgZXJyb3IpOw0KICAgIH0NCn0NCg0KLy8gQWRkIGEgbmV3IG5vZGUgdG8gdGhlIGNhbnZhcyAoZHluYW1pYyB2ZXJzaW9uKQ0KZnVuY3Rpb24gYWRkTm9kZSh0eXBlKSB7DQogICAgY29uc3Qgbm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZSh0eXBlKTsNCiAgICBpZiAoIW5vZGVEZWYpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVW5rbm93biBub2RlIHR5cGU6JywgdHlwZSk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgY29uc3Qgbm9kZUlkID0gYG5vZGVfJHsrK2Zsb3dFZGl0b3Iubm9kZUNvdW50ZXJ9YDsNCiAgICANCiAgICAvLyBDYWxjdWxhdGUgcG9zaXRpb24gcmVsYXRpdmUgdG8gY3VycmVudCB2aWV3cG9ydCBjZW50ZXINCiAgICBjb25zdCBjZW50ZXIgPSB3aW5kb3cuZmxvd0VkaXRvclV0aWxzID8gDQogICAgICAgIHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZ2V0Vmlld3BvcnRDZW50ZXJJbkNhbnZhcygpIDoNCiAgICAgICAgeyB4OiA1MDAwLCB5OiA1MDAwIH07IC8vIEZhbGxiYWNrIHRvIGNhbnZhcyBjZW50ZXINCiAgICANCiAgICAvLyBBZGQgc29tZSByYW5kb20gb2Zmc2V0IGFyb3VuZCB0aGUgY2VudGVyDQogICAgY29uc3Qgb2Zmc2V0WCA9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDIwMDsgLy8gLTEwMCB0byArMTAwDQogICAgY29uc3Qgb2Zmc2V0WSA9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDIwMDsgLy8gLTEwMCB0byArMTAwDQogICAgDQogICAgY29uc3Qgbm9kZSA9IHsNCiAgICAgICAgaWQ6IG5vZGVJZCwNCiAgICAgICAgdHlwZTogdHlwZSwNCiAgICAgICAgeDogY2VudGVyLnggKyBvZmZzZXRYLA0KICAgICAgICB5OiBjZW50ZXIueSArIG9mZnNldFksDQogICAgICAgIGNvbmZpZzogSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShub2RlRGVmLmNvbmZpZykpLCAvLyBEZWVwIGNvcHkNCiAgICAgICAgZGF0YToge30NCiAgICB9Ow0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgc3BlY2lhbCBub2RlIHN0YXRlcw0KICAgIGlmICh0eXBlID09PSAncmVwZWF0ZXInKSB7DQogICAgICAgIG5vZGUucmVwZWF0ZXJTdGF0ZSA9IHsNCiAgICAgICAgICAgIGNvdW50OiAwLA0KICAgICAgICAgICAgaW50ZXJ2YWw6IG51bGwsDQogICAgICAgICAgICBpc1J1bm5pbmc6IGZhbHNlDQogICAgICAgIH07DQogICAgfQ0KICAgIA0KICAgIGZsb3dFZGl0b3Iubm9kZXMuc2V0KG5vZGVJZCwgbm9kZSk7DQogICAgDQogICAgLy8gQ3JlYXRlIG5vZGUgZWxlbWVudCB1c2luZyB0aGUgcmVuZGVyZXINCiAgICBjb25zdCBub2RlRWxlbWVudCA9IG5vZGVSZW5kZXJlci5jcmVhdGVOb2RlRWxlbWVudChub2RlKTsNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5hcHBlbmRDaGlsZChub2RlRWxlbWVudCk7DQogICAgDQogICAgLy8gU2VuZCB1cGRhdGUgdmlhIFdlYlNvY2tldA0KICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNlbmRNZXNzYWdlKSB7DQogICAgICAgIHN5cG5leEFQSS5zZW5kTWVzc2FnZSgnbm9kZV9hZGRlZCcsIHsNCiAgICAgICAgICAgIG5vZGVJZDogbm9kZUlkLA0KICAgICAgICAgICAgdHlwZTogdHlwZSwNCiAgICAgICAgICAgIHBvc2l0aW9uOiB7IHg6IG5vZGUueCwgeTogbm9kZS55IH0NCiAgICAgICAgfSwgJ2Zsb3ctZWRpdG9yJyk7DQogICAgfQ0KICAgIA0KfQ0KDQovLyBIYW5kbGUgZmxvdyB1cGRhdGVzIGZyb20gV2ViU29ja2V0DQpmdW5jdGlvbiBoYW5kbGVGbG93VXBkYXRlKGRhdGEpIHsNCiAgICAvLyBIYW5kbGUgcmVhbC10aW1lIHVwZGF0ZXMgZnJvbSBvdGhlciBpbnN0YW5jZXMNCn0NCg0KLy8gSW5pdGlhbGl6ZSB3aGVuIERPTSBpcyByZWFkeQ0KaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdsb2FkaW5nJykgew0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBpbml0Rmxvd0VkaXRvcik7DQp9IGVsc2Ugew0KICAgIC8vIERPTSBpcyBhbHJlYWR5IGxvYWRlZA0KICAgIGluaXRGbG93RWRpdG9yKCk7DQp9DQoNCg0KPC9zY3JpcHQ+"
  },
  "package_info": {
    "format_version": "1.0",
    "created_at": "2025-07-25T09:04:09.153901",
    "packaged_by": "Sypnex OS App Packager",
    "source_directory": ".\\flow_editor"
  },
  "additional_files": [
    {
      "vfs_path": "/nodes/nodes-pack.json",
      "filename": "nodes-pack.json",
      "data": "ew0KICAidmVyc2lvbiI6ICIxLjAuMCIsDQogICJwYWNrZWRfYXQiOiAiMjAyNS0wNy0yNVQwNjo1NjoyMC4zMjQ3OTkiLA0KICAidG90YWxfbm9kZXMiOiAxNiwNCiAgIm5vZGVzIjogew0KICAgICJhcnJheSI6IHsNCiAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAibmFtZSI6ICJBcnJheSBPcGVyYXRpb25zIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJQcm9jZXNzIGFycmF5cyBhbmQgbGlzdHMgd2l0aCBtYXAsIGZpbHRlciwgYW5kIG90aGVyIG9wZXJhdGlvbnMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWxpc3QiLA0KICAgICAgImNvbG9yIjogInByaW1hcnkiLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhcnJheSIsDQogICAgICAgICAgIm5hbWUiOiAiQXJyYXkiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInJlc3VsdCIsDQogICAgICAgICAgIm5hbWUiOiAiUmVzdWx0IiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJsZW5ndGgiLA0KICAgICAgICAgICJuYW1lIjogIkxlbmd0aCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZpcnN0IiwNCiAgICAgICAgICAibmFtZSI6ICJGaXJzdCBJdGVtIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImxhc3QiLA0KICAgICAgICAgICJuYW1lIjogIkxhc3QgSXRlbSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJvcGVyYXRpb24iOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3BlcmF0aW9uIiwNCiAgICAgICAgICAidmFsdWUiOiAibWFwIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJtYXAiLA0KICAgICAgICAgICAgImZpbHRlciIsDQogICAgICAgICAgICAibGVuZ3RoIiwNCiAgICAgICAgICAgICJqb2luIiwNCiAgICAgICAgICAgICJmaXJzdCIsDQogICAgICAgICAgICAibGFzdCIsDQogICAgICAgICAgICAic2xpY2UiLA0KICAgICAgICAgICAgInJldmVyc2UiLA0KICAgICAgICAgICAgInNvcnQiLA0KICAgICAgICAgICAgInVuaXF1ZSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJmaWVsZF9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWVsZCBQYXRoIChmb3IgbWFwL2ZpbHRlcikiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJlLmcuLCBuYW1lLCB1c2VyLmVtYWlsLCBpZCINCiAgICAgICAgfSwNCiAgICAgICAgImZpbHRlcl92YWx1ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRmlsdGVyIFZhbHVlIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiVmFsdWUgdG8gZmlsdGVyIGJ5Ig0KICAgICAgICB9LA0KICAgICAgICAiZmlsdGVyX29wZXJhdG9yIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkZpbHRlciBPcGVyYXRvciIsDQogICAgICAgICAgInZhbHVlIjogImVxdWFscyIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAiZXF1YWxzIiwNCiAgICAgICAgICAgICJub3RfZXF1YWxzIiwNCiAgICAgICAgICAgICJjb250YWlucyIsDQogICAgICAgICAgICAiZ3JlYXRlcl90aGFuIiwNCiAgICAgICAgICAgICJsZXNzX3RoYW4iLA0KICAgICAgICAgICAgInN0YXJ0c193aXRoIiwNCiAgICAgICAgICAgICJlbmRzX3dpdGgiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiam9pbl9zZXBhcmF0b3IiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkpvaW4gU2VwYXJhdG9yIiwNCiAgICAgICAgICAidmFsdWUiOiAiLCAiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJTZXBhcmF0b3IgZm9yIGpvaW4gb3BlcmF0aW9uIg0KICAgICAgICB9LA0KICAgICAgICAic2xpY2Vfc3RhcnQiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiU2xpY2UgU3RhcnQiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDANCiAgICAgICAgfSwNCiAgICAgICAgInNsaWNlX2VuZCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJTbGljZSBFbmQgKDAgPSBlbmQpIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiYXJyYXlfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImF1ZGlvIjogew0KICAgICAgImlkIjogImF1ZGlvIiwNCiAgICAgICJuYW1lIjogIkF1ZGlvIFBsYXllciIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiUGxheSBhdWRpbyBmaWxlcyBhbmQgY29udHJvbCBwbGF5YmFjayIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtdm9sdW1lLXVwIiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJtZWRpYSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiZnJvbnRlbmRfb25seSIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhdWRpb19kYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJBdWRpbyBEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidXJsIiwNCiAgICAgICAgICAibmFtZSI6ICJVUkwiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJpbmFyeSIsDQogICAgICAgICAgIm5hbWUiOiAiQmluYXJ5IiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYXVkaW9fZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiQXVkaW8gRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImF1ZGlvX3VybCIsDQogICAgICAgICAgIm5hbWUiOiAiQXVkaW8gVVJMIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImR1cmF0aW9uIiwNCiAgICAgICAgICAibmFtZSI6ICJEdXJhdGlvbiIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm9yaWdpbmFsIiwNCiAgICAgICAgICAibmFtZSI6ICJPcmlnaW5hbCIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImF1dG9QbGF5Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkF1dG8gUGxheSIsDQogICAgICAgICAgInZhbHVlIjogImZhbHNlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJ2b2x1bWUiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiVm9sdW1lICgwLTEpIiwNCiAgICAgICAgICAidmFsdWUiOiAxLA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJtYXgiOiAxLA0KICAgICAgICAgICJzdGVwIjogMC4xDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiYXVkaW9fZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImNvbmRpdGlvbiI6IHsNCiAgICAgICJpZCI6ICJjb25kaXRpb24iLA0KICAgICAgIm5hbWUiOiAiQ29uZGl0aW9uIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJDb21wYXJlIGlucHV0IHZhbHVlIHRvIGEgY29uZGl0aW9uIGFuZCBvdXRwdXQgdHJ1ZS9mYWxzZSIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtcXVlc3Rpb24tY2lyY2xlIiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJsb2dpYyIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInZhbHVlIiwNCiAgICAgICAgICAibmFtZSI6ICJWYWx1ZSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInJlc3VsdCIsDQogICAgICAgICAgIm5hbWUiOiAiUmVzdWx0IiwNCiAgICAgICAgICAidHlwZSI6ICJib29sZWFuIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgIm9wZXJhdG9yIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk9wZXJhdG9yIiwNCiAgICAgICAgICAidmFsdWUiOiAiZXF1YWxzIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJlcXVhbHMiLA0KICAgICAgICAgICAgIm5vdF9lcXVhbHMiLA0KICAgICAgICAgICAgImdyZWF0ZXJfdGhhbiIsDQogICAgICAgICAgICAibGVzc190aGFuIiwNCiAgICAgICAgICAgICJncmVhdGVyX3RoYW5fb3JfZXF1YWwiLA0KICAgICAgICAgICAgImxlc3NfdGhhbl9vcl9lcXVhbCIsDQogICAgICAgICAgICAiY29udGFpbnMiLA0KICAgICAgICAgICAgIm5vdF9jb250YWlucyIsDQogICAgICAgICAgICAic3RhcnRzX3dpdGgiLA0KICAgICAgICAgICAgImVuZHNfd2l0aCIsDQogICAgICAgICAgICAiaXNfZW1wdHkiLA0KICAgICAgICAgICAgImlzX25vdF9lbXB0eSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJjb21wYXJlX3ZhbHVlIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJDb21wYXJlIFRvIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiVmFsdWUgdG8gY29tcGFyZSBhZ2FpbnN0Ig0KICAgICAgICB9LA0KICAgICAgICAiY2FzZV9zZW5zaXRpdmUiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQ2FzZSBTZW5zaXRpdmUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0cnVlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiY29uZGl0aW9uX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJkaXNwbGF5Ijogew0KICAgICAgImlkIjogImRpc3BsYXkiLA0KICAgICAgIm5hbWUiOiAiRGlzcGxheSBUZXh0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEaXNwbGF5IHRleHQgZGF0YSBpbiB2YXJpb3VzIGZvcm1hdHMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWV5ZSIsDQogICAgICAiY29sb3IiOiAic3VjY2VzcyIsDQogICAgICAiY2F0ZWdvcnkiOiAib3V0cHV0IiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJmcm9udGVuZF9vbmx5IiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImpzb24iLA0KICAgICAgICAgICJuYW1lIjogIkpTT04iLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkaXNwbGF5ZWQiLA0KICAgICAgICAgICJuYW1lIjogIkRpc3BsYXllZCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJpbnB1dF9wb3J0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIklucHV0IFBvcnQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJhdXRvIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJhdXRvIiwNCiAgICAgICAgICAgICJ0ZXh0IiwNCiAgICAgICAgICAgICJqc29uIiwNCiAgICAgICAgICAgICJkYXRhIiwNCiAgICAgICAgICAgICJiaW5hcnkiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiZm9ybWF0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkZvcm1hdCIsDQogICAgICAgICAgInZhbHVlIjogInRleHQiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRleHQiLA0KICAgICAgICAgICAgImpzb24iLA0KICAgICAgICAgICAgImh0bWwiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAibWF4TGVuZ3RoIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIk1heCBMZW5ndGgiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEwMDAsDQogICAgICAgICAgIm1pbiI6IDEsDQogICAgICAgICAgIm1heCI6IDEwMDAwLA0KICAgICAgICAgICJzdGVwIjogMTAwDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiZGlzcGxheV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAiaHR0cCI6IHsNCiAgICAgICJpZCI6ICJodHRwIiwNCiAgICAgICJuYW1lIjogIkhUVFAgUmVxdWVzdCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiTWFrZSBIVFRQIHJlcXVlc3RzIHRvIGV4dGVybmFsIEFQSXMgYW5kIHNlcnZpY2VzIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1nbG9iZSIsDQogICAgICAiY29sb3IiOiAicHJpbWFyeSIsDQogICAgICAiY2F0ZWdvcnkiOiAibmV0d29yayIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJqc29uIiwNCiAgICAgICAgICAibmFtZSI6ICJKU09OIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJpbmFyeSIsDQogICAgICAgICAgIm5hbWUiOiAiQmluYXJ5IiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAic3RhdHVzX2NvZGUiLA0KICAgICAgICAgICJuYW1lIjogIlN0YXR1cyBDb2RlIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiaGVhZGVycyIsDQogICAgICAgICAgIm5hbWUiOiAiSGVhZGVycyIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ1cmwiLA0KICAgICAgICAgICJuYW1lIjogIlVSTCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJ1cmwiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIlVSTCIsDQogICAgICAgICAgInZhbHVlIjogImh0dHBzOi8vanNvbnBsYWNlaG9sZGVyLnR5cGljb2RlLmNvbS9wb3N0cy8xIg0KICAgICAgICB9LA0KICAgICAgICAibWV0aG9kIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIk1ldGhvZCIsDQogICAgICAgICAgInZhbHVlIjogIkdFVCIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAiR0VUIiwNCiAgICAgICAgICAgICJQT1NUIiwNCiAgICAgICAgICAgICJQVVQiLA0KICAgICAgICAgICAgIkRFTEVURSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJoZWFkZXJzIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHRhcmVhIiwNCiAgICAgICAgICAibGFiZWwiOiAiSGVhZGVycyAoSlNPTikiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ7XCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJ9Ig0KICAgICAgICB9LA0KICAgICAgICAiYm9keSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0YXJlYSIsDQogICAgICAgICAgImxhYmVsIjogIkJvZHkgKEpTT04pIiwNCiAgICAgICAgICAidmFsdWUiOiAie1wibWVzc2FnZVwiOiBcInt7VkFMVUV9fVwiLCBcInRpbWVzdGFtcFwiOiBcInt7SlNPTjp0aW1lc3RhbXB9fVwifSINCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJodHRwX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJpbWFnZSI6IHsNCiAgICAgICJpZCI6ICJpbWFnZSIsDQogICAgICAibmFtZSI6ICJJbWFnZSBEaXNwbGF5IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEaXNwbGF5IGltYWdlcyBhbmQgY29udHJvbCB2aXN1YWxpemF0aW9uIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1pbWFnZSIsDQogICAgICAiY29sb3IiOiAiaW5mbyIsDQogICAgICAiY2F0ZWdvcnkiOiAibWVkaWEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImZyb250ZW5kX29ubHkiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJpbmFyeSIsDQogICAgICAgICAgIm5hbWUiOiAiQmluYXJ5IiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiaW1hZ2VfZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiSW1hZ2UgRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInVybCIsDQogICAgICAgICAgIm5hbWUiOiAiVVJMIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJiaW5hcnkiLA0KICAgICAgICAgICJuYW1lIjogIkJpbmFyeSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImltYWdlX2RhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkltYWdlIERhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJpbWFnZV91cmwiLA0KICAgICAgICAgICJuYW1lIjogIkltYWdlIFVSTCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkaW1lbnNpb25zIiwNCiAgICAgICAgICAibmFtZSI6ICJEaW1lbnNpb25zIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm9yaWdpbmFsIiwNCiAgICAgICAgICAibmFtZSI6ICJPcmlnaW5hbCIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgIm1heF9wcmV2aWV3X3NpemUiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiTWF4IFByZXZpZXcgU2l6ZSIsDQogICAgICAgICAgInZhbHVlIjogMzAwLA0KICAgICAgICAgICJtaW4iOiA1MCwNCiAgICAgICAgICAibWF4IjogODAwLA0KICAgICAgICAgICJzdGVwIjogNTANCiAgICAgICAgfSwNCiAgICAgICAgInNob3dfaW5mbyI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJTaG93IEluZm8iLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0cnVlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiaW1hZ2VfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImpzb25fZXh0cmFjdCI6IHsNCiAgICAgICJpZCI6ICJqc29uX2V4dHJhY3QiLA0KICAgICAgIm5hbWUiOiAiSlNPTiBFeHRyYWN0IiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJFeHRyYWN0IHZhbHVlcyBmcm9tIEpTT04gZGF0YSB1c2luZyBkb3Qgbm90YXRpb24iLA0KICAgICAgImljb24iOiAiZmFzIGZhLWNvZGUtYnJhbmNoIiwNCiAgICAgICJjb2xvciI6ICJpbmZvIiwNCiAgICAgICJjYXRlZ29yeSI6ICJkYXRhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJqc29uIiwNCiAgICAgICAgICAibmFtZSI6ICJKU09OIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAianNvbiIsDQogICAgICAgICAgIm5hbWUiOiAiSlNPTiIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJleHRyYWN0ZWRfdmFsdWUiLA0KICAgICAgICAgICJuYW1lIjogIkV4dHJhY3RlZCBWYWx1ZSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJmaWVsZF9wYXRoIiwNCiAgICAgICAgICAibmFtZSI6ICJGaWVsZCBQYXRoIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm9yaWdpbmFsIiwNCiAgICAgICAgICAibmFtZSI6ICJPcmlnaW5hbCIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJmaWVsZF9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWVsZCBQYXRoIiwNCiAgICAgICAgICAidmFsdWUiOiAiZGF0YS5pdGVtcyIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlVzZSBkb3Qgbm90YXRpb24gKGUuZy4sIGRhdGEuaXRlbXMuMC5uYW1lKSINCiAgICAgICAgfSwNCiAgICAgICAgImRpc3BsYXlfZm9ybWF0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkRpc3BsYXkgRm9ybWF0IiwNCiAgICAgICAgICAidmFsdWUiOiAidGV4dCIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidGV4dCIsDQogICAgICAgICAgICAianNvbiINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAianNvbl9leHRyYWN0X2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJsbG1fY2hhdCI6IHsNCiAgICAgICJpZCI6ICJsbG1fY2hhdCIsDQogICAgICAibmFtZSI6ICJMTE0gQ2hhdCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiQ2hhdCB3aXRoIExhcmdlIExhbmd1YWdlIE1vZGVscyB1c2luZyBPbGxhbWEiLA0KICAgICAgImljb24iOiAiZmFzIGZhLXJvYm90IiwNCiAgICAgICJjb2xvciI6ICJpbmZvIiwNCiAgICAgICJjYXRlZ29yeSI6ICJhaSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInByb21wdCIsDQogICAgICAgICAgIm5hbWUiOiAiUHJvbXB0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInN5c3RlbV9tZXNzYWdlIiwNCiAgICAgICAgICAibmFtZSI6ICJTeXN0ZW0gTWVzc2FnZSIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjb250ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJDb250ZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAicmVzcG9uc2UiLA0KICAgICAgICAgICJuYW1lIjogIlJlc3BvbnNlIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRva2Vuc191c2VkIiwNCiAgICAgICAgICAibmFtZSI6ICJUb2tlbnMgVXNlZCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIm1vZGVsX3VzZWQiLA0KICAgICAgICAgICJuYW1lIjogIk1vZGVsIFVzZWQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZnVsbF9yZXNwb25zZSIsDQogICAgICAgICAgIm5hbWUiOiAiRnVsbCBSZXNwb25zZSIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJlbmRwb2ludCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT2xsYW1hIEVuZHBvaW50IiwNCiAgICAgICAgICAidmFsdWUiOiAiaHR0cDovLzEyNy4wLjAuMToxMTQzNC92MSIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogImh0dHA6Ly8xMjcuMC4wLjE6MTE0MzQvdjEiDQogICAgICAgIH0sDQogICAgICAgICJtb2RlbCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiTW9kZWwgTmFtZSIsDQogICAgICAgICAgInZhbHVlIjogIkhhbW1lckFJL21uLW1hZy1tZWxsLXIxOmxhdGVzdCIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogImxsYW1hMiwgY29kZWxsYW1hLCBldGMuIg0KICAgICAgICB9LA0KICAgICAgICAidGVtcGVyYXR1cmUiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiVGVtcGVyYXR1cmUiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAuNywNCiAgICAgICAgICAibWluIjogMCwNCiAgICAgICAgICAibWF4IjogMiwNCiAgICAgICAgICAic3RlcCI6IDAuMQ0KICAgICAgICB9LA0KICAgICAgICAibWF4X3Rva2VucyI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJNYXggVG9rZW5zIiwNCiAgICAgICAgICAidmFsdWUiOiAyMDQ4LA0KICAgICAgICAgICJtaW4iOiAxLA0KICAgICAgICAgICJtYXgiOiA4MTkyLA0KICAgICAgICAgICJzdGVwIjogMQ0KICAgICAgICB9LA0KICAgICAgICAic3lzdGVtX3Byb21wdCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0YXJlYSIsDQogICAgICAgICAgImxhYmVsIjogIlN5c3RlbSBQcm9tcHQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJZb3UgYXJlIGEgaGVscGZ1bCBBSSBhc3Npc3RhbnQuIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiRGVmaW5lIHRoZSBBSSdzIHJvbGUgYW5kIGJlaGF2aW9yIg0KICAgICAgICB9LA0KICAgICAgICAiaW5jbHVkZV9jb250ZXh0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkluY2x1ZGUgQ29udGV4dCIsDQogICAgICAgICAgInZhbHVlIjogInRydWUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJsbG1fY2hhdF9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAibG9naWNhbF9nYXRlIjogew0KICAgICAgImlkIjogImxvZ2ljYWxfZ2F0ZSIsDQogICAgICAibmFtZSI6ICJMb2dpY2FsIEdhdGUiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIk9ubHkgY29udGludWUgZXhlY3V0aW9uIGlmIGlucHV0IGlzIHRydWUiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWZpbHRlciIsDQogICAgICAiY29sb3IiOiAiaW5mbyIsDQogICAgICAiY2F0ZWdvcnkiOiAibG9naWMiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjb25kaXRpb24iLA0KICAgICAgICAgICJuYW1lIjogIkNvbmRpdGlvbiIsDQogICAgICAgICAgInR5cGUiOiAiYm9vbGVhbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiaW52ZXJ0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkludmVydCBMb2dpYyIsDQogICAgICAgICAgInZhbHVlIjogImZhbHNlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJkZXNjcmlwdGlvbiI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRGVzY3JpcHRpb24iLA0KICAgICAgICAgICJ2YWx1ZSI6ICIiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJPcHRpb25hbCBkZXNjcmlwdGlvbiBvZiB3aGF0IHRoaXMgZ2F0ZSBkb2VzIg0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImxvZ2ljYWxfZ2F0ZV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAibWF0aCI6IHsNCiAgICAgICJpZCI6ICJtYXRoIiwNCiAgICAgICJuYW1lIjogIk1hdGggT3BlcmF0aW9ucyIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiUGVyZm9ybSBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvbiBudW1lcmljIHZhbHVlcyIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtY2FsY3VsYXRvciIsDQogICAgICAiY29sb3IiOiAiaW5mbyIsDQogICAgICAiY2F0ZWdvcnkiOiAiZGF0YSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInZhbHVlX2EiLA0KICAgICAgICAgICJuYW1lIjogIlZhbHVlIEEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidmFsdWVfYiIsDQogICAgICAgICAgIm5hbWUiOiAiVmFsdWUgQiIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJudW1iZXJfYSIsDQogICAgICAgICAgIm5hbWUiOiAiTnVtYmVyIEEiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJudW1iZXJfYiIsDQogICAgICAgICAgIm5hbWUiOiAiTnVtYmVyIEIiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInJlc3VsdCIsDQogICAgICAgICAgIm5hbWUiOiAiUmVzdWx0IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZvcm1hdHRlZCIsDQogICAgICAgICAgIm5hbWUiOiAiRm9ybWF0dGVkIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgIm9wZXJhdGlvbiI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJPcGVyYXRpb24iLA0KICAgICAgICAgICJ2YWx1ZSI6ICJhZGQiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImFkZCIsDQogICAgICAgICAgICAic3VidHJhY3QiLA0KICAgICAgICAgICAgIm11bHRpcGx5IiwNCiAgICAgICAgICAgICJkaXZpZGUiLA0KICAgICAgICAgICAgIm1vZHVsbyIsDQogICAgICAgICAgICAicG93ZXIiLA0KICAgICAgICAgICAgIm1pbiIsDQogICAgICAgICAgICAibWF4IiwNCiAgICAgICAgICAgICJhYnMiLA0KICAgICAgICAgICAgInJvdW5kIiwNCiAgICAgICAgICAgICJmbG9vciIsDQogICAgICAgICAgICAiY2VpbCINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJ2YWx1ZV9hIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIlZhbHVlIEEgKGlmIG5vdCBjb25uZWN0ZWQpIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJzdGVwIjogMC4wMQ0KICAgICAgICB9LA0KICAgICAgICAidmFsdWVfYiI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJWYWx1ZSBCIChpZiBub3QgY29ubmVjdGVkKSIsDQogICAgICAgICAgInZhbHVlIjogMCwNCiAgICAgICAgICAic3RlcCI6IDAuMDENCiAgICAgICAgfSwNCiAgICAgICAgImRlY2ltYWxfcGxhY2VzIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkRlY2ltYWwgUGxhY2VzIiwNCiAgICAgICAgICAidmFsdWUiOiAwLA0KICAgICAgICAgICJtaW4iOiAwLA0KICAgICAgICAgICJtYXgiOiAxMCwNCiAgICAgICAgICAic3RlcCI6IDENCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJtYXRoX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJyZXBlYXRlciI6IHsNCiAgICAgICJpZCI6ICJyZXBlYXRlciIsDQogICAgICAibmFtZSI6ICJSZXBlYXRlciIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiUmVwZWF0IGNvbm5lY3RlZCB3b3JrZmxvdyBhdCBpbnRlcnZhbHMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLXJlZG8iLA0KICAgICAgImNvbG9yIjogIndhcm5pbmciLA0KICAgICAgImNhdGVnb3J5IjogInRyaWdnZXIiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJjb3VudCIsDQogICAgICAgICAgIm5hbWUiOiAiQ291bnQiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJpbnRlcnZhbCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJJbnRlcnZhbCAobXMpIiwNCiAgICAgICAgICAidmFsdWUiOiAxMDAwLA0KICAgICAgICAgICJtaW4iOiAxMDAsDQogICAgICAgICAgIm1heCI6IDMwMDAwMCwNCiAgICAgICAgICAic3RlcCI6IDEwMA0KICAgICAgICB9LA0KICAgICAgICAiY291bnQiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiQ291bnQgKDAgPSBpbmZpbml0ZSkiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgInN0ZXAiOiAxDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAicmVwZWF0ZXJfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInN0cmluZyI6IHsNCiAgICAgICJpZCI6ICJzdHJpbmciLA0KICAgICAgIm5hbWUiOiAiU3RyaW5nIE9wZXJhdGlvbnMiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIk1hbmlwdWxhdGUgYW5kIHByb2Nlc3MgdGV4dCBzdHJpbmdzIHdpdGggdmFyaW91cyBvcGVyYXRpb25zIiwNCiAgICAgICJpY29uIjogImZhcyBmYS10ZXh0LXdpZHRoIiwNCiAgICAgICJjb2xvciI6ICJzZWNvbmRhcnkiLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHRfYiIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCBCIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJyZXN1bHQiLA0KICAgICAgICAgICJuYW1lIjogIlJlc3VsdCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImFycmF5IiwNCiAgICAgICAgICAibmFtZSI6ICJBcnJheSIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJsZW5ndGgiLA0KICAgICAgICAgICJuYW1lIjogIkxlbmd0aCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogIndvcmRfY291bnQiLA0KICAgICAgICAgICJuYW1lIjogIldvcmQgQ291bnQiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJvcGVyYXRpb24iOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3BlcmF0aW9uIiwNCiAgICAgICAgICAidmFsdWUiOiAiY29uY2F0ZW5hdGUiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImNvbmNhdGVuYXRlIiwNCiAgICAgICAgICAgICJzcGxpdCIsDQogICAgICAgICAgICAicmVwbGFjZSIsDQogICAgICAgICAgICAidHJpbSIsDQogICAgICAgICAgICAidXBwZXJjYXNlIiwNCiAgICAgICAgICAgICJsb3dlcmNhc2UiLA0KICAgICAgICAgICAgInN1YnN0cmluZyIsDQogICAgICAgICAgICAicmVnZXhfbWF0Y2giLA0KICAgICAgICAgICAgInJlZ2V4X3JlcGxhY2UiLA0KICAgICAgICAgICAgInN0YXJ0c193aXRoIiwNCiAgICAgICAgICAgICJlbmRzX3dpdGgiLA0KICAgICAgICAgICAgImNvbnRhaW5zIiwNCiAgICAgICAgICAgICJyZXBlYXQiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAidGV4dF9iIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJUZXh0IEIgKGlmIG5vdCBjb25uZWN0ZWQpIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiU2Vjb25kIHRleHQgaW5wdXQiDQogICAgICAgIH0sDQogICAgICAgICJzZXBhcmF0b3IiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIlNlcGFyYXRvci9EZWxpbWl0ZXIiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIsIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiRm9yIHNwbGl0L2pvaW4gb3BlcmF0aW9ucyINCiAgICAgICAgfSwNCiAgICAgICAgInNlYXJjaF90ZXh0Ijogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJTZWFyY2ggVGV4dCIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlRleHQgdG8gc2VhcmNoL3JlcGxhY2UiDQogICAgICAgIH0sDQogICAgICAgICJyZXBsYWNlX3RleHQiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIlJlcGxhY2UgV2l0aCIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlJlcGxhY2VtZW50IHRleHQiDQogICAgICAgIH0sDQogICAgICAgICJzdGFydF9pbmRleCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJTdGFydCBJbmRleCIsDQogICAgICAgICAgInZhbHVlIjogMCwNCiAgICAgICAgICAibWluIjogMA0KICAgICAgICB9LA0KICAgICAgICAiZW5kX2luZGV4Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkVuZCBJbmRleCAoMCA9IGVuZCkiLA0KICAgICAgICAgICJ2YWx1ZSI6IDAsDQogICAgICAgICAgIm1pbiI6IDANCiAgICAgICAgfSwNCiAgICAgICAgInJlcGVhdF9jb3VudCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJSZXBlYXQgQ291bnQiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEsDQogICAgICAgICAgIm1pbiI6IDEsDQogICAgICAgICAgIm1heCI6IDEwMA0KICAgICAgICB9LA0KICAgICAgICAiY2FzZV9zZW5zaXRpdmUiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQ2FzZSBTZW5zaXRpdmUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0cnVlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAic3RyaW5nX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJ0ZXh0Ijogew0KICAgICAgImlkIjogInRleHQiLA0KICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiT3V0cHV0IHN0YXRpYyB0ZXh0IGNvbnRlbnQiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWZvbnQiLA0KICAgICAgImNvbG9yIjogInNlY29uZGFyeSIsDQogICAgICAiY2F0ZWdvcnkiOiAiZGF0YSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ1cHBlcmNhc2UiLA0KICAgICAgICAgICJuYW1lIjogIlVwcGVyY2FzZSIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJsb3dlcmNhc2UiLA0KICAgICAgICAgICJuYW1lIjogIkxvd2VyY2FzZSIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ3b3JkX2NvdW50IiwNCiAgICAgICAgICAibmFtZSI6ICJXb3JkIENvdW50IiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAibGVuZ3RoIiwNCiAgICAgICAgICAibmFtZSI6ICJMZW5ndGgiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJ0ZXh0X2NvbnRlbnQiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dGFyZWEiLA0KICAgICAgICAgICJsYWJlbCI6ICJUZXh0IENvbnRlbnQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJIZWxsbywgV29ybGQhIg0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInRleHRfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInRpbWVyIjogew0KICAgICAgImlkIjogInRpbWVyIiwNCiAgICAgICJuYW1lIjogIlRpbWVyIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJEZWxheSBleGVjdXRpb24gZm9yIHNwZWNpZmllZCBtaWxsaXNlY29uZHMiLA0KICAgICAgImljb24iOiAiZmFzIGZhLWNsb2NrIiwNCiAgICAgICJjb2xvciI6ICJ3YXJuaW5nIiwNCiAgICAgICJjYXRlZ29yeSI6ICJ0cmlnZ2VyIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRpbWVzdGFtcCIsDQogICAgICAgICAgIm5hbWUiOiAiVGltZXN0YW1wIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZWxhcHNlZCIsDQogICAgICAgICAgIm5hbWUiOiAiRWxhcHNlZCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImludGVydmFsIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkludGVydmFsIChtcykiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEwMDAsDQogICAgICAgICAgIm1pbiI6IDEwMCwNCiAgICAgICAgICAibWF4IjogNjAwMDAsDQogICAgICAgICAgInN0ZXAiOiAxMDANCiAgICAgICAgfSwNCiAgICAgICAgImNvdW50Ijogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkNvdW50IiwNCiAgICAgICAgICAidmFsdWUiOiAxLA0KICAgICAgICAgICJtaW4iOiAxLA0KICAgICAgICAgICJtYXgiOiAxMDAsDQogICAgICAgICAgInN0ZXAiOiAxDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAidGltZXJfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInZmc19sb2FkIjogew0KICAgICAgImlkIjogInZmc19sb2FkIiwNCiAgICAgICJuYW1lIjogIlZGUyBMb2FkIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJMb2FkIGRhdGEgZnJvbSB0aGUgVmlydHVhbCBGaWxlIFN5c3RlbSIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtZm9sZGVyLW9wZW4iLA0KICAgICAgImNvbG9yIjogInByaW1hcnkiLA0KICAgICAgImNhdGVnb3J5IjogInN0b3JhZ2UiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJmaWxlX3BhdGgiLA0KICAgICAgICAgICJuYW1lIjogIkZpbGUgUGF0aCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJmaWxlX3BhdGgiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkZpbGUgUGF0aCIsDQogICAgICAgICAgInZhbHVlIjogIi9teV9kYXRhLmpzb24iLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICIvYWJzb2x1dGUvcGF0aC9pbi92ZnMiDQogICAgICAgIH0sDQogICAgICAgICJmb3JtYXQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRm9ybWF0IiwNCiAgICAgICAgICAidmFsdWUiOiAianNvbiIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAianNvbiIsDQogICAgICAgICAgICAidGV4dCIsDQogICAgICAgICAgICAiYmluYXJ5Ig0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgImF1dG9fcmVsb2FkIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkF1dG8gUmVsb2FkIG9uIENoYW5nZSIsDQogICAgICAgICAgInZhbHVlIjogImZhbHNlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAidmZzX2xvYWRfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInZmc19zYXZlIjogew0KICAgICAgImlkIjogInZmc19zYXZlIiwNCiAgICAgICJuYW1lIjogIlZGUyBTYXZlIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJTYXZlIGRhdGEgdG8gdGhlIFZpcnR1YWwgRmlsZSBTeXN0ZW0iLA0KICAgICAgImljb24iOiAiZmFzIGZhLXNhdmUiLA0KICAgICAgImNvbG9yIjogInByaW1hcnkiLA0KICAgICAgImNhdGVnb3J5IjogInN0b3JhZ2UiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAic3VjY2VzcyIsDQogICAgICAgICAgIm5hbWUiOiAiU3VjY2VzcyIsDQogICAgICAgICAgInR5cGUiOiAiYm9vbGVhbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJmaWxlX3BhdGgiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkZpbGUgUGF0aCIsDQogICAgICAgICAgInZhbHVlIjogIi9teV9kYXRhLmpzb24iLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICIvYWJzb2x1dGUvcGF0aC9pbi92ZnMiDQogICAgICAgIH0sDQogICAgICAgICJmb3JtYXQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRm9ybWF0IiwNCiAgICAgICAgICAidmFsdWUiOiAianNvbiIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAianNvbiIsDQogICAgICAgICAgICAidGV4dCIsDQogICAgICAgICAgICAiYmluYXJ5Ig0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgIm92ZXJ3cml0ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJPdmVyd3JpdGUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0cnVlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJhcHBlbmQiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQXBwZW5kIE1vZGUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJmYWxzZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInZmc19zYXZlX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9DQogIH0NCn0=",
      "size": 29699
    }
  ]
}