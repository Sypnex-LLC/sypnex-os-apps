{
  "app_metadata": {
    "id": "flow_editor",
    "name": "Flow Editor",
    "description": "Visual node-based workflow editor for creating and executing data processing pipelines",
    "icon": "fas fa-project-diagram",
    "keywords": [
      "flow",
      "workflow",
      "nodes",
      "pipeline",
      "visual",
      "editor"
    ],
    "author": "Sypnex OS",
    "version": "1.0.9",
    "type": "user_app",
    "scripts": [
      "js/utils.js",
      "js/node-registry.js",
      "js/canvas.js",
      "js/node-config.js",
      "js/node-renderer.js",
      "js/data-executors.js",
      "js/http-executors.js",
      "js/media-executors.js",
      "js/flow-executors.js",
      "js/ai-executors.js",
      "js/execution-engine.js",
      "js/workflow.js",
      "js/canvas-manager.js",
      "js/tag-manager.js",
      "js/file-manager.js",
      "js/ui-manager.js",
      "js/main.js"
    ],
    "styles": [
      "css/layout.css",
      "css/nodes.css",
      "css/components.css",
      "css/node-types.css",
      "css/responsive.css",
      "css/os-theme.css"
    ],
    "additional_files": [
      {
        "vfs_path": "/nodes/nodes-pack.json",
        "source_file": "node-definitions/nodes-pack.json"
      }
    ],
    "settings": [
      {
        "key": "DEFAULT_HTTP_TIMEOUT",
        "name": "HTTP Timeout (ms)",
        "type": "number",
        "value": 30000,
        "description": "Default timeout for HTTP requests in milliseconds"
      },
      {
        "key": "AUTO_SAVE_INTERVAL",
        "name": "Auto Save Interval (s)",
        "type": "number",
        "value": 30,
        "description": "Auto save workflows every N seconds (0 = disabled)"
      },
      {
        "key": "MAX_NODES",
        "name": "Maximum Nodes",
        "type": "number",
        "value": 50,
        "description": "Maximum number of nodes allowed in a workflow"
      }
    ]
  },
  "files": {
    "flow_editor.app": "ew0KICAiaWQiOiAiZmxvd19lZGl0b3IiLA0KICAibmFtZSI6ICJGbG93IEVkaXRvciIsDQogICJkZXNjcmlwdGlvbiI6ICJWaXN1YWwgbm9kZS1iYXNlZCB3b3JrZmxvdyBlZGl0b3IgZm9yIGNyZWF0aW5nIGFuZCBleGVjdXRpbmcgZGF0YSBwcm9jZXNzaW5nIHBpcGVsaW5lcyIsDQogICJpY29uIjogImZhcyBmYS1wcm9qZWN0LWRpYWdyYW0iLA0KICAia2V5d29yZHMiOiBbImZsb3ciLCAid29ya2Zsb3ciLCAibm9kZXMiLCAicGlwZWxpbmUiLCAidmlzdWFsIiwgImVkaXRvciJdLA0KICAiYXV0aG9yIjogIlN5cG5leCBPUyIsDQogICJ2ZXJzaW9uIjogIjEuMC45IiwNCiAgInR5cGUiOiAidXNlcl9hcHAiLA0KICAic2NyaXB0cyI6IFsNCiAgICAianMvdXRpbHMuanMiLA0KICAgICJqcy9ub2RlLXJlZ2lzdHJ5LmpzIiwNCiAgICAianMvY2FudmFzLmpzIiwNCiAgICAianMvbm9kZS1jb25maWcuanMiLA0KICAgICJqcy9ub2RlLXJlbmRlcmVyLmpzIiwNCiAgICAianMvZGF0YS1leGVjdXRvcnMuanMiLA0KICAgICJqcy9odHRwLWV4ZWN1dG9ycy5qcyIsDQogICAgImpzL21lZGlhLWV4ZWN1dG9ycy5qcyIsDQogICAgImpzL2Zsb3ctZXhlY3V0b3JzLmpzIiwNCiAgICAianMvYWktZXhlY3V0b3JzLmpzIiwNCiAgICAianMvZXhlY3V0aW9uLWVuZ2luZS5qcyIsDQogICAgImpzL3dvcmtmbG93LmpzIiwNCiAgICAianMvY2FudmFzLW1hbmFnZXIuanMiLA0KICAgICJqcy90YWctbWFuYWdlci5qcyIsDQogICAgImpzL2ZpbGUtbWFuYWdlci5qcyIsDQogICAgImpzL3VpLW1hbmFnZXIuanMiLA0KICAgICJqcy9tYWluLmpzIg0KICBdLA0KICAic3R5bGVzIjogWw0KICAgICJjc3MvbGF5b3V0LmNzcyIsDQogICAgImNzcy9ub2Rlcy5jc3MiLA0KICAgICJjc3MvY29tcG9uZW50cy5jc3MiLA0KICAgICJjc3Mvbm9kZS10eXBlcy5jc3MiLA0KICAgICJjc3MvcmVzcG9uc2l2ZS5jc3MiLA0KICAgICJjc3Mvb3MtdGhlbWUuY3NzIg0KICBdLA0KICAiYWRkaXRpb25hbF9maWxlcyI6IFsNCiAgICB7DQogICAgICAidmZzX3BhdGgiOiAiL25vZGVzL25vZGVzLXBhY2suanNvbiIsDQogICAgICAic291cmNlX2ZpbGUiOiAibm9kZS1kZWZpbml0aW9ucy9ub2Rlcy1wYWNrLmpzb24iDQogICAgfQ0KICBdLA0KICAic2V0dGluZ3MiOiBbDQogICAgew0KICAgICAgImtleSI6ICJERUZBVUxUX0hUVFBfVElNRU9VVCIsDQogICAgICAibmFtZSI6ICJIVFRQIFRpbWVvdXQgKG1zKSIsDQogICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgInZhbHVlIjogMzAwMDAsDQogICAgICAiZGVzY3JpcHRpb24iOiAiRGVmYXVsdCB0aW1lb3V0IGZvciBIVFRQIHJlcXVlc3RzIGluIG1pbGxpc2Vjb25kcyINCiAgICB9LA0KICAgIHsNCiAgICAgICJrZXkiOiAiQVVUT19TQVZFX0lOVEVSVkFMIiwNCiAgICAgICJuYW1lIjogIkF1dG8gU2F2ZSBJbnRlcnZhbCAocykiLA0KICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICJ2YWx1ZSI6IDMwLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkF1dG8gc2F2ZSB3b3JrZmxvd3MgZXZlcnkgTiBzZWNvbmRzICgwID0gZGlzYWJsZWQpIg0KICAgIH0sDQogICAgew0KICAgICAgImtleSI6ICJNQVhfTk9ERVMiLA0KICAgICAgIm5hbWUiOiAiTWF4aW11bSBOb2RlcyIsDQogICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgInZhbHVlIjogNTAsDQogICAgICAiZGVzY3JpcHRpb24iOiAiTWF4aW11bSBudW1iZXIgb2Ygbm9kZXMgYWxsb3dlZCBpbiBhIHdvcmtmbG93Ig0KICAgIH0NCiAgXQ0KfQ==",
    "flow_editor.html": "PGRpdiBjbGFzcz0iYXBwLWNvbnRhaW5lciI+DQogICAgPGRpdiBjbGFzcz0iYXBwLWNvbnRlbnQiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LWVkaXRvciI+DQogICAgICAgICAgICA8IS0tIExlZnQgVG9vbGJveCAtLT4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsb3ctdG9vbGJveCIgaWQ9ImZsb3ctdG9vbGJveCI+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idG9vbGJveC1oZWFkZXIiPg0KICAgICAgICAgICAgICAgICAgICA8aDQ+PGkgY2xhc3M9ImZhcyBmYS10b29scyI+PC9pPiBOb2RlczwvaDQ+DQogICAgICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InRvZ2dsZS10b29sYm94IiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tb3V0bGluZS1zZWNvbmRhcnkiIHRpdGxlPSJDb2xsYXBzZSBUb29sYm94Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtY2hldnJvbi1sZWZ0Ij48L2k+DQogICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRvb2xib3gtY29udGVudCIgaWQ9InRvb2xib3gtY29udGVudCI+DQogICAgICAgICAgICAgICAgICAgIDwhLS0gTm9kZXMgd2lsbCBiZSBsb2FkZWQgZHluYW1pY2FsbHkgZnJvbSBWRlMgLS0+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxvYWRpbmctbm9kZXMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9InRleHQtbXV0ZWQiPkxvYWRpbmcgbm9kZXMuLi48L3A+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgICAgIDwhLS0gTWFpbiB3b3Jrc3BhY2UgLS0+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LXdvcmtzcGFjZSI+DQogICAgICAgICAgICAgICAgPCEtLSBUb29sYmFyIC0tPg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsb3ctdG9vbGJhciI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRvb2xiYXItbGVmdCI+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJydW4td29ya2Zsb3ciIGNsYXNzPSJidG4gYnRuLXN1Y2Nlc3MiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtcGxheSI+PC9pPiA8c3BhbiBjbGFzcz0iYnRuLXRleHQiPlJ1biBXb3JrZmxvdzwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ic3RvcC13b3JrZmxvdyIgY2xhc3M9ImJ0biBidG4tZGFuZ2VyIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc3RvcCI+PC9pPiA8c3BhbiBjbGFzcz0iYnRuLXRleHQiPlN0b3A8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImN1cnJlbnQtZmlsZS1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBpZD0iY3VycmVudC1maWxlbmFtZSIgY2xhc3M9ImN1cnJlbnQtZmlsZW5hbWUiPnVudGl0bGVkLmZsb3c8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0b29sYmFyLXJpZ2h0Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gWm9vbSBjb250cm9scyBzdGF5IHZpc2libGUgLS0+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ6b29tLWNvbnRyb2xzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ6b29tLW91dCIgY2xhc3M9ImJ0biBidG4tb3V0bGluZS1zZWNvbmRhcnkiIHRpdGxlPSJab29tIE91dCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2VhcmNoLW1pbnVzIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gaWQ9Inpvb20tbGV2ZWwiIGNsYXNzPSJ6b29tLWxldmVsIj4xMDAlPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9Inpvb20taW4iIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiB0aXRsZT0iWm9vbSBJbiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2VhcmNoLXBsdXMiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ6b29tLWZpdCIgY2xhc3M9ImJ0biBidG4tb3V0bGluZS1zZWNvbmRhcnkiIHRpdGxlPSJab29tIHRvIEZpdCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZXhwYW5kLWFycm93cy1hbHQiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICA8IS0tIEhhbWJ1cmdlciBNZW51IEJ1dHRvbiAtLT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9ImhhbWJ1cmdlci1tZW51IiBjbGFzcz0iYnRuIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSBoYW1idXJnZXItYnRuIiB0aXRsZT0iTWVudSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1iYXJzIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgPCEtLSBEcm9wZG93biBNZW51IC0gT25seSBmaWxlIG9wZXJhdGlvbnMgYW5kIGRlbGV0ZS9jbGVhciBhY3Rpb25zIC0tPg0KICAgICAgICAgICAgICAgIDxkaXYgaWQ9ImRyb3Bkb3duLW1lbnUiIGNsYXNzPSJkcm9wZG93bi1tZW51Ij4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWVudS1zZWN0aW9uIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1lbnUtc2VjdGlvbi10aXRsZSI+RmlsZSBBY3Rpb25zPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0iIGRhdGEtYWN0aW9uPSJzYXZlLWZsb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2F2ZSI+PC9pPiBTYXZlDQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Im1lbnUtaXRlbSIgZGF0YS1hY3Rpb249InNhdmUtZmxvdy1hcyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1zYXZlIj48L2k+IFNhdmUgQXMNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIiBkYXRhLWFjdGlvbj0ibG9hZC1mbG93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWZvbGRlci1vcGVuIj48L2k+IExvYWQNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1lbnUtc2VjdGlvbiI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtZW51LXNlY3Rpb24tdGl0bGUiPlZpZXcgQWN0aW9uczwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibWVudS1pdGVtIiBkYXRhLWFjdGlvbj0iYWRkLXRhZyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS10YWciPjwvaT4gQWRkIFRhZw0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0iIGRhdGEtYWN0aW9uPSJyZXNldC12aWV3Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWNyb3NzaGFpcnMiPjwvaT4gUmVzZXQgVmlldw0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWVudS1zZWN0aW9uIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1lbnUtc2VjdGlvbi10aXRsZSI+RWRpdCBBY3Rpb25zPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0gZGFuZ2VyIiBkYXRhLWFjdGlvbj0iZGVsZXRlLXNlbGVjdGVkIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRyYXNoIj48L2k+IERlbGV0ZSBTZWxlY3RlZA0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJtZW51LWl0ZW0gZGFuZ2VyIiBkYXRhLWFjdGlvbj0iY2xlYXItY2FudmFzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRyYXNoLWFsdCI+PC9pPiBDbGVhciBBbGwNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCg0KICAgICAgICAgICAgICAgIDwhLS0gTWFpbiBjYW52YXMgYXJlYSAtLT4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LWNhbnZhcy1jb250YWluZXIiPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSJmbG93LWNhbnZhcyIgY2xhc3M9ImZsb3ctY2FudmFzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gTm9kZXMgd2lsbCBiZSBhZGRlZCBoZXJlIGR5bmFtaWNhbGx5IC0tPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDwvZGl2Pg0KDQogICAgICAgICAgICA8IS0tIENvbmZpZ3VyYXRpb24gcGFuZWwgLS0+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LWNvbmZpZy1wYW5lbCIgaWQ9ImZsb3ctY29uZmlnLXBhbmVsIj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctaGVhZGVyIj4NCiAgICAgICAgICAgICAgICAgICAgPGg0PjxpIGNsYXNzPSJmYXMgZmEtY29nIj48L2k+IENvbmZpZ3VyYXRpb248L2g0Pg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ0b2dnbGUtY29uZmlnIiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tb3V0bGluZS1zZWNvbmRhcnkiIHRpdGxlPSJDb2xsYXBzZSBDb25maWd1cmF0aW9uIFBhbmVsIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtY2hldnJvbi1yaWdodCI+PC9pPg0KICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctY29udGVudCIgaWQ9ImNvbmZpZy1jb250ZW50Ij4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0ibm9kZS1jb25maWciPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9InRleHQtbXV0ZWQiPlNlbGVjdCBhIG5vZGUgdG8gY29uZmlndXJlIGl0PC9wPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0idGFnLXBhbmVsIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxoNT48aSBjbGFzcz0iZmFzIGZhLXRhZ3MiPjwvaT4gQXJlYSBUYWdzPC9oNT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5ObyB0YWdzIHlldDwvcD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgPCEtLSBPdXRwdXQgcGFuZWwgLS0+DQogICAgICAgIDxkaXYgY2xhc3M9ImZsb3ctb3V0cHV0LXBhbmVsIGNvbGxhcHNlZCIgaWQ9ImZsb3ctb3V0cHV0LXBhbmVsIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im91dHB1dC1oZWFkZXIiPg0KICAgICAgICAgICAgICAgIDxoND48aSBjbGFzcz0iZmFzIGZhLXRlcm1pbmFsIj48L2k+IEV4ZWN1dGlvbiBPdXRwdXQ8L2g0Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im91dHB1dC1jb250cm9scyI+DQogICAgICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InRvZ2dsZS1vdXRwdXQiIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSIgdGl0bGU9IlNob3cvSGlkZSBPdXRwdXQiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1jaGV2cm9uLWRvd24iPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9ImNsZWFyLW91dHB1dCIgY2xhc3M9ImJ0biBidG4tc20gYnRuLW91dGxpbmUtc2Vjb25kYXJ5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtdHJhc2giPjwvaT4gQ2xlYXINCiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im91dHB1dC1jb250ZW50IiBpZD0ib3V0cHV0LWNvbnRlbnQiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQogICAgICAgICAgICAgICAgPGRpdiBpZD0iZXhlY3V0aW9uLW91dHB1dCIgY2xhc3M9ImV4ZWN1dGlvbi1vdXRwdXQiPg0KICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz0idGV4dC1tdXRlZCI+V29ya2Zsb3cgb3V0cHV0IHdpbGwgYXBwZWFyIGhlcmU8L3A+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQo8L2Rpdj4NCjxzdHlsZT4vKiA9PT09PSBTdHlsZTogY3NzL2xheW91dC5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIExheW91dCAmIFN0cnVjdHVyZSAqLw0KDQovKiBFbnN1cmUgYXBwLWNvbnRhaW5lciB1c2VzIGZ1bGwgaGVpZ2h0ICovDQouYXBwLWNvbnRhaW5lciB7DQogICAgaGVpZ2h0OiAxMDB2aDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCn0NCg0KLmFwcC1jb250ZW50IHsNCiAgICBmbGV4OiAxOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIGdhcDogMTBweDsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIG1pbi1oZWlnaHQ6IDA7DQp9DQoNCi8qIEZsb3cgRWRpdG9yIExheW91dCAqLw0KLmZsb3ctZWRpdG9yIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXg6IDE7DQogICAgZ2FwOiAwOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgbWluLWhlaWdodDogMDsNCn0NCg0KLyogTGVmdCBUb29sYm94ICovDQouZmxvdy10b29sYm94IHsNCiAgICB3aWR0aDogMjUwcHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgZmxleC1zaHJpbms6IDA7DQp9DQoNCi50b29sYm94LWhlYWRlciB7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KfQ0KDQoudG9vbGJveC1oZWFkZXIgaDQgew0KICAgIG1hcmdpbjogMDsNCiAgICBmb250LXNpemU6IDE2cHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KfQ0KDQojdG9nZ2xlLXRvb2xib3ggew0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOw0KfQ0KDQojdG9nZ2xlLXRvb2xib3g6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcik7DQp9DQoNCi8qIENvbGxhcHNlZCBzdGF0ZSAqLw0KLmZsb3ctdG9vbGJveC5jb2xsYXBzZWQgew0KICAgIHdpZHRoOiA1MHB4Ow0KfQ0KDQouZmxvdy10b29sYm94LmNvbGxhcHNlZCAudG9vbGJveC1jb250ZW50IHsNCiAgICBkaXNwbGF5OiBub25lOw0KfQ0KDQouZmxvdy10b29sYm94LmNvbGxhcHNlZCAudG9vbGJveC1oZWFkZXIgaDQgew0KICAgIGRpc3BsYXk6IG5vbmU7DQp9DQoNCi50b29sYm94LWNvbnRlbnQgew0KICAgIGZsZXg6IDE7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KfQ0KDQovKiBNYWluIFdvcmtzcGFjZSAqLw0KLmZsb3ctd29ya3NwYWNlIHsNCiAgICBmbGV4OiAxOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBtaW4td2lkdGg6IDA7DQp9DQoNCi8qIFRvb2xiYXIgKi8NCi5mbG93LXRvb2xiYXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgcGFkZGluZzogMTJweCAyMHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGZsZXgtc2hyaW5rOiAwOw0KfQ0KDQoudG9vbGJhci1sZWZ0IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGdhcDogMTBweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KfQ0KDQouY3VycmVudC1maWxlLWluZm8gew0KICAgIG1hcmdpbi1sZWZ0OiAxNXB4Ow0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCn0NCg0KLmN1cnJlbnQtZmlsZW5hbWUgew0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KfQ0KDQoudG9vbGJhci1yaWdodCB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDhweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCn0NCg0KLyogWm9vbSBDb250cm9scyAqLw0KLnpvb20tY29udHJvbHMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDRweDsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KfQ0KDQouem9vbS1sZXZlbCB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIG1pbi13aWR0aDogNDBweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgdXNlci1zZWxlY3Q6IG5vbmU7DQp9DQoNCi56b29tLWNvbnRyb2xzIGJ1dHRvbiB7DQogICAgcGFkZGluZzogNHB4IDZweDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOw0KfQ0KDQouem9vbS1jb250cm9scyBidXR0b246aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcik7DQp9DQoNCi56b29tLWNvbnRyb2xzIGJ1dHRvbjphY3RpdmUgew0KICAgIHRyYW5zZm9ybTogc2NhbGUoMC45NSk7DQp9DQoNCi8qIENhbnZhcyBDb250YWluZXIgKi8NCi5mbG93LWNhbnZhcy1jb250YWluZXIgew0KICAgIGZsZXg6IDE7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIG92ZXJmbG93OiBoaWRkZW47DQp9DQoNCi5mbG93LWNhbnZhcyB7DQogICAgd2lkdGg6IDEwMDAwcHg7DQogICAgaGVpZ2h0OiAxMDAwMHB4Ow0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICBiYWNrZ3JvdW5kOiANCiAgICAgICAgcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCAyMHB4IDIwcHgsIHZhcigtLWJvcmRlci1jb2xvcikgMXB4LCB0cmFuc3BhcmVudCAxcHgpLA0KICAgICAgICByYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDQwcHggNDBweCwgdmFyKC0tYm9yZGVyLWNvbG9yKSAxcHgsIHRyYW5zcGFyZW50IDFweCk7DQogICAgYmFja2dyb3VuZC1zaXplOiA0MHB4IDQwcHg7DQogICAgY3Vyc29yOiBncmFiOw0KICAgIHRyYW5zZm9ybS1vcmlnaW46IDAgMDsNCiAgICB3aWxsLWNoYW5nZTogdHJhbnNmb3JtOw0KfQ0KDQouZmxvdy1jYW52YXM6YWN0aXZlIHsNCiAgICBjdXJzb3I6IGdyYWJiaW5nOw0KfQ0KDQouZmxvdy1jYW52YXMucGFubmluZyB7DQogICAgY3Vyc29yOiBncmFiYmluZzsNCn0NCg0KLyogQ29uZmlndXJhdGlvbiBQYW5lbCAqLw0KLmZsb3ctY29uZmlnLXBhbmVsIHsNCiAgICB3aWR0aDogMzAwcHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBmbGV4LXNocmluazogMDsNCn0NCg0KLmNvbmZpZy1oZWFkZXIgew0KICAgIHBhZGRpbmc6IDE1cHg7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCn0NCg0KLmNvbmZpZy1oZWFkZXIgaDQgew0KICAgIG1hcmdpbjogMDsNCiAgICBmb250LXNpemU6IDE2cHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KfQ0KDQojdG9nZ2xlLWNvbmZpZyB7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQp9DQoNCiN0b2dnbGUtY29uZmlnOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ib3JkZXItY29sb3IpOw0KfQ0KDQovKiBDb2xsYXBzZWQgc3RhdGUgKi8NCi5mbG93LWNvbmZpZy1wYW5lbC5jb2xsYXBzZWQgew0KICAgIHdpZHRoOiA1MHB4Ow0KfQ0KDQouZmxvdy1jb25maWctcGFuZWwuY29sbGFwc2VkIC5jb25maWctY29udGVudCB7DQogICAgZGlzcGxheTogbm9uZTsNCn0NCg0KLmZsb3ctY29uZmlnLXBhbmVsLmNvbGxhcHNlZCAuY29uZmlnLWhlYWRlciBoNCB7DQogICAgZGlzcGxheTogbm9uZTsNCn0NCg0KLmNvbmZpZy1jb250ZW50IHsNCiAgICBmbGV4OiAxOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgcGFkZGluZzogMTVweDsNCn0NCg0KLyogT3V0cHV0IFBhbmVsICovDQouZmxvdy1vdXRwdXQtcGFuZWwgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgZmxleC1zaHJpbms6IDA7DQogICAgbWF4LWhlaWdodDogMzAwcHg7DQp9DQoNCi5vdXRwdXQtaGVhZGVyIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIHBhZGRpbmc6IDEycHggMTVweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCn0NCg0KLm91dHB1dC1oZWFkZXIgaDQgew0KICAgIG1hcmdpbjogMDsNCiAgICBmb250LXNpemU6IDE2cHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KfQ0KDQoub3V0cHV0LWNvbnRlbnQgew0KICAgIHBhZGRpbmc6IDE1cHg7DQogICAgbWF4LWhlaWdodDogMjUwcHg7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBvdmVyZmxvdy14OiBoaWRkZW47DQp9DQoNCi5mbG93LW91dHB1dC1wYW5lbC5jb2xsYXBzZWQgLm91dHB1dC1jb250ZW50IHsNCiAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7DQp9DQoNCi5mbG93LW91dHB1dC1wYW5lbCAub3V0cHV0LWhlYWRlciB7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KfQ0KDQouZmxvdy1vdXRwdXQtcGFuZWwgLm91dHB1dC1jb250cm9scyB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDhweDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KfQ0KDQoNCi8qID09PT09IFN0eWxlOiBjc3Mvbm9kZXMuY3NzID09PT09ICovDQovKiBGbG93IEVkaXRvciBOb2RlcyAmIENvbm5lY3Rpb25zICovDQoNCi8qIE5vZGUgU3R5bGVzICovDQouZmxvdy1ub2RlIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgbWluLXdpZHRoOiAxNTBweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIGN1cnNvcjogZ3JhYjsNCiAgICB1c2VyLXNlbGVjdDogbm9uZTsNCiAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLDAsMCwwLjEpOw0KICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4ycyBlYXNlLCB0cmFuc2Zvcm0gMC4xcyBlYXNlOw0KICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm07DQp9DQoNCi5mbG93LW5vZGU6YWN0aXZlIHsNCiAgICBjdXJzb3I6IGdyYWJiaW5nOw0KICAgIHRyYW5zaXRpb246IG5vbmU7DQp9DQoNCi5mbG93LW5vZGU6aG92ZXIgew0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLDAsMCwwLjE1KTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7DQp9DQoNCi5mbG93LW5vZGUuc2VsZWN0ZWQgew0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgYm94LXNoYWRvdzogMCAwIDAgMnB4IHJnYmEodmFyKC0tcHJpbWFyeS1jb2xvci1yZ2IpLCAwLjIpOw0KfQ0KDQouZmxvdy1ub2RlLWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIG1hcmdpbi1ib3R0b206IDhweDsNCiAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KfQ0KDQoubm9kZS1kZWxldGUtYnRuIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgcmlnaHQ6IC01cHg7DQogICAgdG9wOiAtNXB4Ow0KICAgIHdpZHRoOiAyMHB4Ow0KICAgIGhlaWdodDogMjBweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgb3BhY2l0eTogMDsNCiAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuMnMgZWFzZTsNCiAgICB6LWluZGV4OiAxMDsNCn0NCg0KLmZsb3ctbm9kZTpob3ZlciAubm9kZS1kZWxldGUtYnRuIHsNCiAgICBvcGFjaXR5OiAxOw0KfQ0KDQoubm9kZS1kZWxldGUtYnRuOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiAjZDMyZjJmOw0KICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsNCn0NCg0KLmZsb3ctbm9kZS10eXBlIHsNCiAgICBwYWRkaW5nOiAycHggNnB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IG5vcm1hbDsNCiAgICBiYWNrZ3JvdW5kOiAjNmM3NTdkOw0KICAgIGNvbG9yOiB3aGl0ZTsNCn0NCg0KLmZsb3ctbm9kZS1jb250ZW50IHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KfQ0KDQouZmxvdy1ub2RlLXBvcnRzIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgd2lkdGg6IDEwMCU7DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIHBvaW50ZXItZXZlbnRzOiBub25lOw0KfQ0KDQouZmxvdy1ub2RlLXBvcnQgew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICB3aWR0aDogMTJweDsNCiAgICBoZWlnaHQ6IDEycHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHBvaW50ZXItZXZlbnRzOiBhbGw7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCn0NCg0KLmZsb3ctbm9kZS1wb3J0OmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIHRyYW5zZm9ybTogc2NhbGUoMS4yKTsNCn0NCg0KLmZsb3ctbm9kZS1wb3J0LmlucHV0IHsNCiAgICBsZWZ0OiAtNnB4Ow0KICAgIHRvcDogNTAlOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsNCn0NCg0KLmZsb3ctbm9kZS1wb3J0Lm91dHB1dCB7DQogICAgcmlnaHQ6IC02cHg7DQogICAgdG9wOiA1MCU7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOw0KfQ0KDQovKiBDb25uZWN0aW9uIExpbmVzICovDQouZmxvdy1jb25uZWN0aW9uIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgcG9pbnRlci1ldmVudHM6IG5vbmU7DQogICAgei1pbmRleDogMTsNCn0NCg0KLmZsb3ctY29ubmVjdGlvbi1saW5lIHsNCiAgICBzdHJva2U6IHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgc3Ryb2tlLXdpZHRoOiA4Ow0KICAgIGZpbGw6IG5vbmU7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICBvcGFjaXR5OiAwLjY7IC8qIFNsaWdodGx5IHRyYW5zcGFyZW50IGJ5IGRlZmF1bHQgKi8NCn0NCg0KLmZsb3ctY29ubmVjdGlvbi1saW5lOmhvdmVyIHsNCiAgICBzdHJva2U6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIG9wYWNpdHk6IDE7DQogICAgc3Ryb2tlLXdpZHRoOiAxMDsNCn0NCg0KLmZsb3ctY29ubmVjdGlvbi1saW5lLmNvbm5lY3RlZCB7DQogICAgc3Ryb2tlOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBvcGFjaXR5OiAwLjg7DQp9DQoNCi8qIFJ1bm5pbmcgU3RhdGUgKi8NCi5mbG93LW5vZGUucnVubmluZyB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsNCiAgICBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlOw0KfQ0KDQpAa2V5ZnJhbWVzIHB1bHNlIHsNCiAgICAwJSB7IGJveC1zaGFkb3c6IDAgMCAwIDAgcmdiYSh2YXIoLS1zdWNjZXNzLWNvbG9yLXJnYiksIDAuNCk7IH0NCiAgICA3MCUgeyBib3gtc2hhZG93OiAwIDAgMCAxMHB4IHJnYmEodmFyKC0tc3VjY2Vzcy1jb2xvci1yZ2IpLCAwKTsgfQ0KICAgIDEwMCUgeyBib3gtc2hhZG93OiAwIDAgMCAwIHJnYmEodmFyKC0tc3VjY2Vzcy1jb2xvci1yZ2IpLCAwKTsgfQ0KfQ0KDQoNCi8qID09PT09IFN0eWxlOiBjc3MvY29tcG9uZW50cy5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIFVJIENvbXBvbmVudHMgKi8NCg0KLyogTm9kZSBDYXRlZ29yeSBUb29sYm94ICovDQoubm9kZS1jYXRlZ29yeSB7DQogICAgbWFyZ2luLWJvdHRvbTogMjBweDsNCn0NCg0KLm5vZGUtY2F0ZWdvcnkgaDUgew0KICAgIG1hcmdpbjogMCAwIDEwcHggMDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsNCiAgICBsZXR0ZXItc3BhY2luZzogMC41cHg7DQogICAgcGFkZGluZzogMCA1cHg7DQp9DQoNCi50b29sYm94LW5vZGUtYnRuIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxMHB4Ow0KICAgIHBhZGRpbmc6IDEycHggMTVweDsNCiAgICBtYXJnaW4tYm90dG9tOiA1cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgY3Vyc29yOiBncmFiOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQogICAgdGV4dC1hbGlnbjogbGVmdDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KfQ0KDQoudG9vbGJveC1ub2RlLWJ0bjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsMCwwLDAuMSk7DQp9DQoNCi50b29sYm94LW5vZGUtYnRuOmFjdGl2ZSB7DQogICAgY3Vyc29yOiBncmFiYmluZzsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7DQp9DQoNCi50b29sYm94LW5vZGUtYnRuIGkgew0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICB3aWR0aDogMjBweDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQoNCi50b29sYm94LW5vZGUtYnRuIHNwYW4gew0KICAgIGZsZXg6IDE7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCn0NCg0KLyogQnV0dG9ucyAqLw0KLmZsb3ctdG9vbGJhciAuYnRuIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiA2cHg7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7DQp9DQoNCi5mbG93LXRvb2xiYXIgLmJ0bjpob3ZlciB7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsMCwwLDAuMSk7DQp9DQoNCi5mbG93LXRvb2xiYXIgLmJ0bi1vdXRsaW5lLWRhbmdlciB7DQogICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQp9DQoNCi5mbG93LXRvb2xiYXIgLmJ0bi1vdXRsaW5lLWRhbmdlcjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCn0NCg0KLmZsb3ctdG9vbGJhciAuYnRuLW91dGxpbmUtc2Vjb25kYXJ5IHsNCiAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCn0NCg0KLmZsb3ctdG9vbGJhciAuYnRuLW91dGxpbmUtc2Vjb25kYXJ5OmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCn0NCg0KLyogQ29uZmlndXJhdGlvbiBTdHlsZXMgKi8NCi5jb25maWctZ3JvdXAgew0KICAgIG1hcmdpbi1ib3R0b206IDE1cHg7DQp9DQoNCi5jb25maWctZ3JvdXAgbGFiZWwgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgIG1hcmdpbi1ib3R0b206IDVweDsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQp9DQoNCi5jb25maWctZ3JvdXAgaW5wdXQgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgdHJhbnNpdGlvbjogYm9yZGVyLWNvbG9yIDAuMnMgZWFzZTsNCn0NCg0KLmNvbmZpZy1ncm91cCBzZWxlY3Qgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KfQ0KDQouY29uZmlnLWdyb3VwIGlucHV0OmZvY3VzIHsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgYm94LXNoYWRvdzogMCAwIDAgMnB4IHJnYmEodmFyKC0tcHJpbWFyeS1jb2xvci1yZ2IpLCAwLjEpOw0KfQ0KDQouY29uZmlnLWdyb3VwIHNlbGVjdDpmb2N1cyB7DQogICAgb3V0bGluZTogbm9uZTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAyMTIsIDI1NSwgMC4wNSk7DQp9DQoNCi5jb25maWctZ3JvdXAgc2VsZWN0IG9wdGlvbiB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KfQ0KDQouY29uZmlnLWdyb3VwIHNlbGVjdCBvcHRpb246aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCn0NCg0KLmNvbmZpZy1ncm91cCB0ZXh0YXJlYSB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICByZXNpemU6IHZlcnRpY2FsOw0KICAgIG1pbi1oZWlnaHQ6IDgwcHg7DQogICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsNCn0NCg0KLyogVGFnIFBhbmVsICovDQojdGFnLXBhbmVsIHsNCiAgICBtYXJnaW4tdG9wOiAyMHB4Ow0KICAgIHBhZGRpbmctdG9wOiAyMHB4Ow0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KfQ0KDQojdGFnLXBhbmVsIGg1IHsNCiAgICBtYXJnaW46IDAgMCAxNXB4IDA7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweDsNCn0NCg0KLnRhZy1pdGVtIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxMHB4Ow0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIG1hcmdpbi1ib3R0b206IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCn0NCg0KLnRhZy1pdGVtOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCn0NCg0KLnRhZy1jb2xvciB7DQogICAgd2lkdGg6IDEycHg7DQogICAgaGVpZ2h0OiAxMnB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICBmbGV4LXNocmluazogMDsNCn0NCg0KLnRhZy1pbmZvIHsNCiAgICBmbGV4OiAxOw0KICAgIG1pbi13aWR0aDogMDsNCn0NCg0KLnRhZy1uYW1lIHsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIGZvbnQtc2l6ZTogMTNweDsNCiAgICBtYXJnaW4tYm90dG9tOiAycHg7DQp9DQoNCi50YWctZGVzY3JpcHRpb24gew0KICAgIGZvbnQtc2l6ZTogMTFweDsNCiAgICBvcGFjaXR5OiAwLjc7DQp9DQoNCi50YWctZGVsZXRlIHsNCiAgICBiYWNrZ3JvdW5kOiBub25lOw0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBjb2xvcjogaW5oZXJpdDsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgcGFkZGluZzogNHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBvcGFjaXR5OiAwLjY7DQogICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjJzIGVhc2U7DQp9DQoNCi50YWctZGVsZXRlOmhvdmVyIHsNCiAgICBvcGFjaXR5OiAxOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsMC4xKTsNCn0NCg0KLyogT3V0cHV0IFN0eWxlcyAqLw0KLmV4ZWN1dGlvbi1vdXRwdXQgew0KICAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7DQogICAgZm9udC1zaXplOiAxM3B4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjQ7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KfQ0KDQouZXhlY3V0aW9uLW91dHB1dCAubG9nLWVudHJ5IHsNCiAgICBtYXJnaW4tYm90dG9tOiA1cHg7DQogICAgcGFkZGluZzogNHB4IDA7DQp9DQoNCi5leGVjdXRpb24tb3V0cHV0IC5sb2ctZW50cnkuaW5mbyB7DQogICAgY29sb3I6IHZhcigtLWluZm8tY29sb3IpOw0KfQ0KDQouZXhlY3V0aW9uLW91dHB1dCAubG9nLWVudHJ5LnN1Y2Nlc3Mgew0KICAgIGNvbG9yOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsNCn0NCg0KLmV4ZWN1dGlvbi1vdXRwdXQgLmxvZy1lbnRyeS5lcnJvciB7DQogICAgY29sb3I6IHZhcigtLWVycm9yLWNvbG9yKTsNCn0NCg0KLmV4ZWN1dGlvbi1vdXRwdXQgLmxvZy1lbnRyeS53YXJuaW5nIHsNCiAgICBjb2xvcjogdmFyKC0td2FybmluZy1jb2xvcik7DQp9DQoNCi8qIElucHV0L091dHB1dCBNYXBwaW5ncyBDb25maWd1cmF0aW9uIFN0eWxlcyAqLw0KLmlucHV0LW1hcHBpbmdzLWNvbmZpZywNCi5vdXRwdXQtbWFwcGluZ3MtY29uZmlnIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgbWFyZ2luLXRvcDogNHB4Ow0KfQ0KDQouaW5wdXQtbWFwcGluZy1jb25maWcsDQoub3V0cHV0LW1hcHBpbmctY29uZmlnIHsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC4wMik7DQogICAgYm9yZGVyLXJhZGl1czogM3B4Ow0KICAgIGJvcmRlci1sZWZ0OiAzcHggc29saWQgdmFyKC0tcHJpbWFyeS1jb2xvcik7DQp9DQoNCi5pbnB1dC1tYXBwaW5nLWNvbmZpZzpsYXN0LWNoaWxkLA0KLm91dHB1dC1tYXBwaW5nLWNvbmZpZzpsYXN0LWNoaWxkIHsNCiAgICBtYXJnaW4tYm90dG9tOiAwOw0KfQ0KDQouaW5wdXQtbWFwcGluZy1jb25maWcgbGFiZWwsDQoub3V0cHV0LW1hcHBpbmctY29uZmlnIGxhYmVsIHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgbWFyZ2luLWJvdHRvbTogNHB4Ow0KfQ0KDQouaW5wdXQtbWFwcGluZy1zZWxlY3QsDQoub3V0cHV0LW1hcHBpbmctc2VsZWN0IHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYm9yZGVyLXJhZGl1czogM3B4Ow0KICAgIGZvbnQtc2l6ZTogMTFweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQp9DQoNCi5pbnB1dC1tYXBwaW5nLXNlbGVjdDpmb2N1cywNCi5vdXRwdXQtbWFwcGluZy1zZWxlY3Q6Zm9jdXMgew0KICAgIG91dGxpbmU6IG5vbmU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTsNCiAgICBib3gtc2hhZG93OiAwIDAgMCAycHggcmdiYSgwLCAxMjMsIDI1NSwgMC4xKTsNCn0NCg0KLyogTGVnYWN5IHN0eWxlcyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSAqLw0KLmlucHV0LW1hcHBpbmdzIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgbWFyZ2luLXRvcDogNHB4Ow0KfQ0KDQouaW5wdXQtbWFwcGluZyB7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBtYXJnaW4tYm90dG9tOiA0cHg7DQogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgbGluZS1oZWlnaHQ6IDEuMjsNCn0NCg0KLmlucHV0LW1hcHBpbmc6bGFzdC1jaGlsZCB7DQogICAgbWFyZ2luLWJvdHRvbTogMDsNCn0NCg0KLmlucHV0LW1hcHBpbmcgLnNvdXJjZS1ub2RlIHsNCiAgICBmb250LXdlaWdodDogNjAwOw0KfQ0KDQouaW5wdXQtbWFwcGluZyAuc291cmNlLXBvcnQgew0KICAgIG9wYWNpdHk6IDAuODsNCiAgICBmb250LXN0eWxlOiBpdGFsaWM7DQp9DQoNCg0KLyogPT09PT0gU3R5bGU6IGNzcy9ub2RlLXR5cGVzLmNzcyA9PT09PSAqLw0KLyogRmxvdyBFZGl0b3IgTm9kZSBUeXBlIFNwZWNpZmljIFN0eWxlcyAqLw0KDQovKiBEaXNwbGF5IE5vZGUgQ29udGVudCAqLw0KLmRpc3BsYXktY29udGVudCB7DQogICAgcGFkZGluZzogOHB4Ow0KfQ0KDQouZGlzcGxheS10ZXh0IHsNCiAgICBtaW4taGVpZ2h0OiA0MHB4Ow0KICAgIG1heC1oZWlnaHQ6IDIwMHB4Ow0KICAgIHdpZHRoOiAyMjBweDsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgcmVzaXplOiBub25lOw0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQp9DQoNCi5kaXNwbGF5LXRleHQgcHJlIHsNCiAgICBtYXJnaW46IDA7DQogICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsNCiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7DQogICAgd29yZC1icmVhazogYnJlYWstd29yZDsNCiAgICB1c2VyLXNlbGVjdDogdGV4dDsNCn0NCg0KLmRpc3BsYXktZm9ybWF0IHsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCn0NCg0KLyogQXVkaW8gUGxheWVyIFN0eWxlcyAqLw0KLmF1ZGlvLWNvbnRyb2xzIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgZ2FwOiAxMHB4Ow0KICAgIG1hcmdpbi10b3A6IDEwcHg7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KfQ0KDQouYXVkaW8tcGxheS1idG4sDQouYXVkaW8tc3RvcC1idG4gew0KICAgIHdpZHRoOiAzMnB4Ow0KICAgIGhlaWdodDogMzJweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQp9DQoNCi5hdWRpby1wbGF5LWJ0biB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VjY2Vzcy1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KfQ0KDQouYXVkaW8tc3RvcC1idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQp9DQoNCi5hdWRpby1wbGF5LWJ0bjpob3ZlciwNCi5hdWRpby1zdG9wLWJ0bjpob3ZlciB7DQogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsMCwwLDAuMik7DQp9DQoNCi5hdWRpby1zdGF0dXMgew0KICAgIGZsZXg6IDE7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQoNCi8qIEpTT04gRXh0cmFjdCBEaXNwbGF5ICovDQouanNvbi1leHRyYWN0LWRpc3BsYXkgew0KICAgIG1hcmdpbi10b3A6IDEwcHg7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC4wNSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KfQ0KDQouZXh0cmFjdC1sYWJlbCB7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICBtYXJnaW4tYm90dG9tOiA0cHg7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCn0NCg0KLmV4dHJhY3QtdmFsdWUgew0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiAzcHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCn0NCg0KLmV4dHJhY3QtdmFsdWUuc3VjY2VzcyB7DQogICAgY29sb3I6IHZhcigtLXN1Y2Nlc3MtY29sb3IpOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tc3VjY2Vzcy1jb2xvcik7DQp9DQoNCi5leHRyYWN0LXZhbHVlLmVycm9yIHsNCiAgICBjb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpOw0KfQ0KDQovKiBSZXBlYXRlciBOb2RlIFN0eWxlcyAqLw0KLnJlcGVhdGVyLWNvbnRlbnQgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCn0NCg0KLnJlcGVhdGVyLXN0YXR1cyB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgcGFkZGluZzogNHB4IDhweDsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIG1pbi13aWR0aDogODBweDsNCn0NCg0KLnJlcGVhdGVyLXN0YXR1cy5zdG9wcGVkIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuMSk7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KfQ0KDQoucmVwZWF0ZXItc3RhdHVzLnJ1bm5pbmcgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1Y2Nlc3MtY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlOw0KfQ0KDQoucmVwZWF0ZXItY29udHJvbHMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZ2FwOiA4cHg7DQp9DQoNCi5yZXBlYXRlci1zdGFydC1idG4sDQoucmVwZWF0ZXItc3RvcC1idG4gew0KICAgIHdpZHRoOiAyOHB4Ow0KICAgIGhlaWdodDogMjhweDsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7DQp9DQoNCi5yZXBlYXRlci1zdGFydC1idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1Y2Nlc3MtY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCn0NCg0KLnJlcGVhdGVyLXN0b3AtYnRuIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgY29sb3I6IHdoaXRlOw0KfQ0KDQoucmVwZWF0ZXItc3RhcnQtYnRuOmhvdmVyLA0KLnJlcGVhdGVyLXN0b3AtYnRuOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7DQogICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwwLDAsMC4yKTsNCn0NCg0KLyogSW1hZ2UgTm9kZSBTdHlsZXMgKi8NCi5pbWFnZS1jb250YWluZXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBtaW4taGVpZ2h0OiAxMjBweDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCn0NCg0KLmltYWdlLXRodW1ibmFpbCB7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgb2JqZWN0LWZpdDogY29udGFpbjsNCiAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlOw0KfQ0KDQouaW1hZ2UtdGh1bWJuYWlsOmhvdmVyIHsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMDUpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsMCwwLDAuMik7DQp9DQoNCi5pbWFnZS1pbmZvIHsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuMDUpOw0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYm9yZGVyLXJhZGl1czogM3B4Ow0KICAgIHdpZHRoOiAxMDAlOw0KfQ0KDQouaW1hZ2UtZXJyb3Igew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogNHB4Ow0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KfQ0KDQouaW1hZ2UtZXJyb3IgaSB7DQogICAgZm9udC1zaXplOiAxNnB4Ow0KfQ0KDQovKiBJbWFnZSBNb2RhbCBTdHlsZXMgKi8NCi5pbWFnZS1tb2RhbCB7DQogICAgcG9zaXRpb246IGZpeGVkOw0KICAgIHRvcDogMDsNCiAgICBsZWZ0OiAwOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGhlaWdodDogMTAwJTsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuOCk7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgIHotaW5kZXg6IDEwMDA7DQogICAgcGFkZGluZzogMjBweDsNCn0NCg0KLmltYWdlLW1vZGFsLWNvbnRlbnQgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UtY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBtYXgtd2lkdGg6IDkwJTsNCiAgICBtYXgtaGVpZ2h0OiA5MCU7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBib3gtc2hhZG93OiAwIDRweCAyMHB4IHJnYmEoMCwwLDAsMC4zKTsNCn0NCg0KLmltYWdlLW1vZGFsLWhlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAxNXB4IDIwcHg7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQp9DQoNCi5pbWFnZS1tb2RhbC1oZWFkZXIgc3BhbiB7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQp9DQoNCi5pbWFnZS1tb2RhbC1jbG9zZSB7DQogICAgYmFja2dyb3VuZDogbm9uZTsNCiAgICBib3JkZXI6IG5vbmU7DQogICAgZm9udC1zaXplOiAyNHB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgcGFkZGluZzogMDsNCiAgICB3aWR0aDogMzBweDsNCiAgICBoZWlnaHQ6IDMwcHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOw0KfQ0KDQouaW1hZ2UtbW9kYWwtY2xvc2U6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC4xKTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQp9DQoNCi5pbWFnZS1tb2RhbC1ib2R5IHsNCiAgICBwYWRkaW5nOiAyMHB4Ow0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogMTVweDsNCiAgICBtYXgtaGVpZ2h0OiBjYWxjKDkwdmggLSAxMDBweCk7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCn0NCg0KLmltYWdlLW1vZGFsLWltYWdlIHsNCiAgICBtYXgtd2lkdGg6IDEwMCU7DQogICAgbWF4LWhlaWdodDogNzB2aDsNCiAgICBvYmplY3QtZml0OiBjb250YWluOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLDAsMCwwLjEpOw0KfQ0KDQouaW1hZ2UtbW9kYWwtaW5mbyB7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIHBhZGRpbmc6IDEwcHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjA1KTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgd2lkdGg6IDEwMCU7DQp9DQoNCi8qIFJhbmRvbSBRdW90ZSBOb2RlIFN0eWxlcyAqLw0KLnF1b3RlLWNvbnRlbnQgew0KICAgIHBhZGRpbmc6IDEwcHg7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KfQ0KDQoucXVvdGUtdGV4dCB7DQogICAgbWFyZ2luLWJvdHRvbTogOHB4Ow0KICAgIG1pbi1oZWlnaHQ6IDQwcHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KfQ0KDQoucXVvdGUtZGlzcGxheSB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1jb2xvcik7DQogICAgZm9udC1zaXplOiAxM3B4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjQ7DQogICAgbWF4LXdpZHRoOiAxMDAlOw0KICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsNCn0NCg0KLnF1b3RlLWluZm8gew0KICAgIGZvbnQtc2l6ZTogMTFweDsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7DQogICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgcGFkZGluZy10b3A6IDhweDsNCn0NCg0KLyogTExNIENoYXQgTm9kZSBTdHlsZXMgKi8NCi5sbG0tcmVzcG9uc2Ugew0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDIzLCAxNjIsIDE4NCwgMC4xKTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgbWFyZ2luOiA0cHggMDsNCn0NCg0KLnJlc3BvbnNlLXByZXZpZXcgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBsaW5lLWhlaWdodDogMS4zOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgbWFyZ2luLWJvdHRvbTogNHB4Ow0KfQ0KDQoudXNhZ2UtaW5mbyB7DQogICAgZm9udC1zaXplOiAxMHB4Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgcmdiYSgwLDAsMCwwLjEpOw0KICAgIHBhZGRpbmctdG9wOiA0cHg7DQp9DQoNCi5sbG0tZXJyb3Igew0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDIyMCwgNTMsIDY5LCAwLjEpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBtYXJnaW46IDRweCAwOw0KICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDZweDsNCn0NCg0KLmxsbS1lcnJvciBpIHsNCiAgICBmb250LXNpemU6IDE0cHg7DQp9DQoNCi8qIFRleHQgTm9kZSBTdHlsZXMgKi8NCi50ZXh0LWNvbnRlbnQgew0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDEwOCwgMTE3LCAxMjUsIDAuMSk7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgIG1hcmdpbjogNHB4IDA7DQp9DQoNCi50ZXh0LXByZXZpZXcgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBsaW5lLWhlaWdodDogMS4zOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgbWFyZ2luLWJvdHRvbTogNHB4Ow0KfQ0KDQoudGV4dC1pbmZvIHsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCByZ2JhKDAsMCwwLDAuMSk7DQogICAgcGFkZGluZy10b3A6IDRweDsNCn0NCg0KLyogTm9kZSBTdGF0dXMgRGlzcGxheSAqLw0KLm5vZGUtc3RhdHVzIHsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjA1KTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgbWFyZ2luOiA0cHggMDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQoNCi5zdGF0dXMtdGV4dCB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIG1hcmdpbi1ib3R0b206IDRweDsNCn0NCg0KLnN0YXR1cy1pbmZvIHsNCiAgICBmb250LXNpemU6IDEwcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KfQ0KDQovKiBDb250ZW50IERpc3BsYXkgaW4gQ29uZmlnIFBhbmVsICovDQouY29udGVudC1kaXNwbGF5IHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuMDUpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBwYWRkaW5nOiAxMnB4Ow0KICAgIG1hcmdpbi10b3A6IDhweDsNCn0NCg0KLmNvbnRlbnQtdGV4dCB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjQ7DQogICAgd2hpdGUtc3BhY2U6IHByZS13cmFwOw0KICAgIHdvcmQtYnJlYWs6IGJyZWFrLXdvcmQ7DQogICAgbWF4LWhlaWdodDogMzAwcHg7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1zdXJmYWNlLWNvbG9yKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgdXNlci1zZWxlY3Q6IHRleHQ7DQp9DQoNCi5jb250ZW50LWluZm8gew0KICAgIG1hcmdpbi10b3A6IDhweDsNCiAgICBmb250LXNpemU6IDExcHg7DQogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOw0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCg0KLyogVGVybWluYWwgTm9kZSBTdHlsZXMgKi8NCi50ZXJtaW5hbC1lcnJvciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjIwLCA1MywgNjksIDAuMSk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBjb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpOw0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBtYXJnaW4tdG9wOiA4cHg7DQp9DQoNCi50ZXJtaW5hbC1lcnJvciBpIHsNCiAgICBtYXJnaW4tcmlnaHQ6IDhweDsNCiAgICBjb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpOw0KfQ0KDQoNCi8qID09PT09IFN0eWxlOiBjc3MvcmVzcG9uc2l2ZS5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIFJlc3BvbnNpdmUgRGVzaWduICYgRWZmZWN0cyAqLw0KDQovKiBIYW1idXJnZXIgTWVudSBTdHlsZXMgLSBBbHdheXMgdmlzaWJsZSAqLw0KLmhhbWJ1cmdlci1idG4gew0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KfQ0KDQouZHJvcGRvd24tbWVudSB7DQogICAgZGlzcGxheTogbm9uZTsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgYmFja2dyb3VuZDogdmFyKC0tc3VyZmFjZS1jb2xvcik7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMik7DQogICAgei1pbmRleDogOTk5OTsNCiAgICBtaW4td2lkdGg6IDE4MHB4Ow0KICAgIHdpZHRoOiAxODBweDsNCiAgICBtYXgtaGVpZ2h0OiA3MHZoOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgcGFkZGluZzogMDsNCiAgICBtYXJnaW46IDA7DQp9DQoNCi5kcm9wZG93bi1tZW51LnNob3cgew0KICAgIGRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7DQp9DQoNCi5tZW51LXNlY3Rpb24gew0KICAgIHBhZGRpbmc6IDhweCAwOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KfQ0KDQoubWVudS1zZWN0aW9uOmxhc3QtY2hpbGQgew0KICAgIGJvcmRlci1ib3R0b206IG5vbmU7DQp9DQoNCi5tZW51LXNlY3Rpb24tdGl0bGUgew0KICAgIHBhZGRpbmc6IDhweCAxNnB4Ow0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsNCiAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOw0KICAgIGxldHRlci1zcGFjaW5nOiAwLjVweDsNCn0NCg0KLm1lbnUtaXRlbSB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogMTBweDsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nOiAxMHB4IDE2cHg7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50Ow0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQgMC4ycyBlYXNlOw0KICAgIHRleHQtYWxpZ246IGxlZnQ7DQp9DQoNCi5tZW51LWl0ZW06aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWJvcmRlci1jb2xvcik7DQp9DQoNCi5tZW51LWl0ZW0uZGFuZ2VyIHsNCiAgICBjb2xvcjogI2ZmNmI2YjsNCn0NCg0KLm1lbnUtaXRlbS5kYW5nZXI6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAxMDcsIDEwNywgMC4xKTsNCn0NCg0KLm1lbnUtem9vbS1jb250cm9scyB7DQogICAgcGFkZGluZzogMCAxNnB4Ow0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBnYXA6IDRweDsNCn0NCg0KLm1lbnUtem9vbS1sZXZlbCB7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOw0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBwYWRkaW5nOiA0cHggMDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBtYXJnaW46IDRweCAwOw0KfQ0KDQouem9vbS1idG4gew0KICAgIHBhZGRpbmc6IDZweCAxMnB4ICFpbXBvcnRhbnQ7DQogICAgZm9udC1zaXplOiAxMnB4ICFpbXBvcnRhbnQ7DQp9DQoNCi8qIFJlc3BvbnNpdmUgRGVzaWduICovDQpAbWVkaWEgKG1heC13aWR0aDogMTIwMHB4KSB7DQogICAgLmZsb3ctZWRpdG9yIHsNCiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgbWluLWhlaWdodDogMDsNCiAgICB9DQogICAgDQogICAgLmZsb3ctdG9vbGJveCB7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICBoZWlnaHQ6IGF1dG87DQogICAgICAgIGJvcmRlci1yaWdodDogbm9uZTsNCiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgICAgIGZsZXgtc2hyaW5rOiAwOw0KICAgICAgICBtYXgtaGVpZ2h0OiAyMDBweDsNCiAgICB9DQogICAgDQogICAgLnRvb2xib3gtY29udGVudCB7DQogICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgIGZsZXgtd3JhcDogd3JhcDsNCiAgICAgICAgZ2FwOiAxMHB4Ow0KICAgICAgICBwYWRkaW5nOiAxNXB4Ow0KICAgICAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIH0NCiAgICANCiAgICAubm9kZS1jYXRlZ29yeSB7DQogICAgICAgIG1hcmdpbi1ib3R0b206IDA7DQogICAgICAgIGZsZXg6IDE7DQogICAgICAgIG1pbi13aWR0aDogMjAwcHg7DQogICAgfQ0KICAgIA0KICAgIC5mbG93LXdvcmtzcGFjZSB7DQogICAgICAgIGZsZXg6IDE7DQogICAgICAgIG1pbi1oZWlnaHQ6IDA7DQogICAgfQ0KICAgIA0KICAgIC5mbG93LWNvbmZpZy1wYW5lbCB7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICBib3JkZXItbGVmdDogbm9uZTsNCiAgICAgICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7DQogICAgICAgIGZsZXgtc2hyaW5rOiAwOw0KICAgICAgICBtYXgtaGVpZ2h0OiAzMDBweDsNCiAgICB9DQogICAgDQogICAgLmZsb3ctb3V0cHV0LXBhbmVsIHsNCiAgICAgICAgbWF4LWhlaWdodDogMjAwcHg7DQogICAgfQ0KICAgIA0KICAgIC5vdXRwdXQtY29udGVudCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4Ow0KICAgIH0NCn0NCg0KQG1lZGlhIChtYXgtd2lkdGg6IDc2OHB4KSB7DQogICAgLmFwcC1jb250ZW50IHsNCiAgICAgICAgcGFkZGluZzogNXB4Ow0KICAgICAgICBnYXA6IDVweDsNCiAgICB9DQogICAgDQogICAgLmZsb3ctdG9vbGJhciB7DQogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICAgIGdhcDogMTBweDsNCiAgICAgICAgcGFkZGluZzogOHB4IDE1cHg7DQogICAgfQ0KICAgIA0KICAgIC50b29sYmFyLWxlZnQsDQogICAgLnRvb2xiYXItcmlnaHQgew0KICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgIGZsZXgtd3JhcDogd3JhcDsNCiAgICB9DQogICAgDQogICAgLmZsb3ctdG9vbGJhciAuYnRuIHsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgICAgICBwYWRkaW5nOiA2cHggMTBweDsNCiAgICB9DQogICAgDQogICAgLmZsb3ctdG9vbGJveCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4Ow0KICAgIH0NCiAgICANCiAgICAuZmxvdy1jb25maWctcGFuZWwgew0KICAgICAgICBtYXgtaGVpZ2h0OiAyNTBweDsNCiAgICB9DQogICAgDQogICAgLmZsb3ctb3V0cHV0LXBhbmVsIHsNCiAgICAgICAgbWF4LWhlaWdodDogMTUwcHg7DQogICAgfQ0KICAgIA0KICAgIC5vdXRwdXQtY29udGVudCB7DQogICAgICAgIG1heC1oZWlnaHQ6IDEwMHB4Ow0KICAgICAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIH0NCn0NCg0KQG1lZGlhIChtYXgtd2lkdGg6IDQ4MHB4KSB7DQogICAgLnRvb2xiYXItbGVmdCwNCiAgICAudG9vbGJhci1yaWdodCB7DQogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICAgIGdhcDogNXB4Ow0KICAgICAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsNCiAgICB9DQogICAgDQogICAgLmZsb3ctdG9vbGJhciAuYnRuIHsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICB9DQogICAgDQogICAgLnpvb20tY29udHJvbHMgew0KICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICB9DQp9DQoNCg0KLyogPT09PT0gU3R5bGU6IGNzcy9vcy10aGVtZS5jc3MgPT09PT0gKi8NCi8qIEZsb3cgRWRpdG9yIC0gU3lwbmV4T1MgVGhlbWUgSW50ZWdyYXRpb24gKi8NCi8qIFRoaXMgZmlsZSBlbnN1cmVzIHRoZSBmbG93IGVkaXRvciBtYXRjaGVzIHRoZSBPUyBhZXN0aGV0aWMgcGVyZmVjdGx5ICovDQoNCjpyb290IHsNCiAgICAvKiBPdmVycmlkZSBmbG93IGVkaXRvciB2YXJpYWJsZXMgd2l0aCBPUyB2YXJpYWJsZXMgKi8NCiAgICAtLXN1cmZhY2UtY29sb3I6IHZhcigtLWdsYXNzLWJnKTsNCiAgICAtLWJvcmRlci1jb2xvcjogdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICAtLXRleHQtY29sb3I6IHZhcigtLXRleHQtcHJpbWFyeSk7DQogICAgLS10ZXh0LW11dGVkOiB2YXIoLS10ZXh0LXNlY29uZGFyeSk7DQogICAgLS1wcmltYXJ5LWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIC0tcHJpbWFyeS1jb2xvci1yZ2I6IDAsIDIxMiwgMjU1Ow0KICAgIC0tZXJyb3ItY29sb3I6ICNmZjQ3NTc7DQogICAgLS1zdWNjZXNzLWNvbG9yOiAjMmVkNTczOw0KICAgIC0td2FybmluZy1jb2xvcjogI2ZmYTUwMjsNCn0NCg0KLyogRW5oYW5jZWQgZ2xhc3MgbW9ycGhpc20gZm9yIGZsb3cgZWRpdG9yICovDQouZmxvdy1lZGl0b3Igew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDEycHg7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgOHB4IDMycHggcmdiYSgwLCAwLCAwLCAwLjMpOw0KfQ0KDQovKiBUb29sYm94IHdpdGggYmV0dGVyIGdsYXNzIGVmZmVjdCAqLw0KLmZsb3ctdG9vbGJveCB7DQogICAgYmFja2dyb3VuZDogcmdiYSgyNiwgMjYsIDI2LCAwLjkpOw0KICAgIGJvcmRlci1yaWdodDogMXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDE1cHgpOw0KfQ0KDQoudG9vbGJveC1oZWFkZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMTAsIDEwLCAxMCwgMC44KTsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCn0NCg0KLnRvb2xib3gtaGVhZGVyIGg0IHsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICB0ZXh0LXNoYWRvdzogMCAwIDEwcHggcmdiYSgwLCAyMTIsIDI1NSwgMC4zKTsNCn0NCg0KLyogRW5oYW5jZWQgbm9kZSBzdHlsaW5nIHdpdGggZ2xhc3MgbW9ycGhpc20gKi8NCi5mbG93LW5vZGUgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJvcmRlci1yYWRpdXM6IDEycHg7DQogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDIwcHggcmdiYSgwLCAwLCAwLCAwLjIpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7DQp9DQoNCi5mbG93LW5vZGU6aG92ZXIgew0KICAgIGJveC1zaGFkb3c6IDAgOHB4IDMycHggcmdiYSgwLCAyMTIsIDI1NSwgMC4yKTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTJweCk7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KfQ0KDQouZmxvdy1ub2RlLnNlbGVjdGVkIHsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgYm94LXNoYWRvdzogMCAwIDAgM3B4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMyk7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAyMTIsIDI1NSwgMC4wNSk7DQp9DQoNCi8qIE5vZGUgcG9ydHMgd2l0aCBuZW9uIGdsb3cgKi8NCi5mbG93LW5vZGUtcG9ydCB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MtYmcpOw0KICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgYm94LXNoYWRvdzogMCAwIDEwcHggcmdiYSgwLCAwLCAwLCAwLjUpOw0KICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7DQp9DQoNCi5mbG93LW5vZGUtcG9ydDpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgYm94LXNoYWRvdzogMCAwIDE1cHggcmdiYSgwLCAyMTIsIDI1NSwgMC44KTsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMyk7DQp9DQoNCi8qIENvbm5lY3Rpb24gbGluZXMgd2l0aCBuZW9uIGVmZmVjdCAqLw0KLmZsb3ctY29ubmVjdGlvbi1saW5lIHsNCiAgICBzdHJva2U6IHZhcigtLWdsYXNzLWJvcmRlcik7DQogICAgc3Ryb2tlLXdpZHRoOiAzOw0KICAgIGZpbHRlcjogZHJvcC1zaGFkb3coMCAwIDNweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjMpKTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOw0KfQ0KDQouZmxvdy1jb25uZWN0aW9uLWxpbmU6aG92ZXIsDQouZmxvdy1jb25uZWN0aW9uLWxpbmUuY29ubmVjdGVkIHsNCiAgICBzdHJva2U6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgc3Ryb2tlLXdpZHRoOiA0Ow0KICAgIGZpbHRlcjogZHJvcC1zaGFkb3coMCAwIDhweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjgpKTsNCn0NCg0KLyogVG9vbGJhciB3aXRoIGdsYXNzIGVmZmVjdCAqLw0KLmZsb3ctdG9vbGJhciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgxMCwgMTAsIDEwLCAwLjkpOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxNXB4KTsNCn0NCg0KLyogRW5oYW5jZWQgYnV0dG9uIHN0eWxpbmcgKi8NCi50b29sYm94LW5vZGUtYnRuIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTsNCn0NCg0KLnRvb2xib3gtbm9kZS1idG46aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMjEyLCAyNTUsIDAuMSk7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsNCiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMik7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQp9DQoNCi8qIEZsb3cgdG9vbGJhciBidXR0b25zICovDQouZmxvdy10b29sYmFyIC5idG4gew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWdsYXNzLWJnKTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpOw0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTBweCk7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCn0NCg0KLmZsb3ctdG9vbGJhciAuYnRuOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDIxMiwgMjU1LCAwLjEpOw0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7DQogICAgYm94LXNoYWRvdzogMCA0cHggMTVweCByZ2JhKDAsIDIxMiwgMjU1LCAwLjIpOw0KfQ0KDQouZmxvdy10b29sYmFyIC5idG4tc3VjY2VzcyB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWNvbG9yKTsNCiAgICBjb2xvcjogdmFyKC0tcHJpbWFyeS1iZyk7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KfQ0KDQouZmxvdy10b29sYmFyIC5idG4tc3VjY2Vzczpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tYWNjZW50LWhvdmVyKTsNCiAgICBib3gtc2hhZG93OiAwIDRweCAyMHB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuNCk7DQp9DQoNCi5mbG93LXRvb2xiYXIgLmJ0bi1kYW5nZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWVycm9yLWNvbG9yKTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQp9DQoNCi5mbG93LXRvb2xiYXIgLmJ0bi1kYW5nZXI6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6ICNmZjM3NDI7DQogICAgYm94LXNoYWRvdzogMCA0cHggMjBweCByZ2JhKDI1NSwgNzEsIDg3LCAwLjQpOw0KfQ0KDQovKiBOb2RlIHR5cGUgc3R5bGluZyAqLw0KLmZsb3ctbm9kZS10eXBlIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWJnKTsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIHRleHQtc2hhZG93OiBub25lOw0KICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCn0NCg0KLyogTm9kZSBkZWxldGUgYnV0dG9uICovDQoubm9kZS1kZWxldGUtYnRuIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgYm9yZGVyOiAycHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOw0KICAgIGJveC1zaGFkb3c6IDAgMnB4IDEwcHggcmdiYSgyNTUsIDcxLCA4NywgMC4zKTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOw0KfQ0KDQoubm9kZS1kZWxldGUtYnRuOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiAjZmYzNzQyOw0KICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsNCiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMjU1LCA3MSwgODcsIDAuNSk7DQp9DQoNCi8qIEN1cnJlbnQgZmlsZW5hbWUgc3R5bGluZyAqLw0KLmN1cnJlbnQtZmlsZW5hbWUgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgdGV4dC1zaGFkb3c6IDAgMCA1cHggcmdiYSgwLCAyMTIsIDI1NSwgMC4zKTsNCn0NCg0KLyogWm9vbSBjb250cm9scyAqLw0KLnpvb20tY29udHJvbHMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBnYXA6IDhweDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgcGFkZGluZzogNHB4Ow0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KTsNCn0NCg0KLnpvb20tbGV2ZWwgew0KICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgbWluLXdpZHRoOiA0NXB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDEycHg7DQp9DQoNCi8qIExvYWRpbmcgc3RhdGUgKi8NCi5sb2FkaW5nLW5vZGVzIHsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1zZWNvbmRhcnkpOw0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBwYWRkaW5nOiAyMHB4Ow0KICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsNCn0NCg0KLyogTm9kZSBjYXRlZ29yaWVzICovDQoubm9kZS1jYXRlZ29yeSBoNSB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7DQogICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsNCiAgICBsZXR0ZXItc3BhY2luZzogMXB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA3MDA7DQogICAgZm9udC1zaXplOiAxMXB4Ow0KfQ0KDQovKiBDYW52YXMgdGFncyBhbmQgY29uZmlndXJhdGlvbiBsaXN0IHRhZ3MgKi8NCi5mbG93LXRhZywNCi5hcmVhLXRhZywNCi50YWctaXRlbSwNCi5jYW52YXMtdGFnIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQ7DQogICAgY29sb3I6IHZhcigtLXByaW1hcnktYmcpICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBib3gtc2hhZG93OiAwIDJweCAxMHB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMyk7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCn0NCg0KLmZsb3ctdGFnOmhvdmVyLA0KLmFyZWEtdGFnOmhvdmVyLA0KLnRhZy1pdGVtOmhvdmVyLA0KLmNhbnZhcy10YWc6aG92ZXIgew0KICAgIGJhY2tncm91bmQ6IHZhcigtLWFjY2VudC1ob3ZlcikgIWltcG9ydGFudDsNCiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuNSk7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOw0KfQ0KDQovKiBUYWcgdGV4dCBhbmQgaWNvbnMgKi8NCi5mbG93LXRhZyAudGFnLXRleHQsDQouYXJlYS10YWcgLnRhZy10ZXh0LA0KLnRhZy1pdGVtIC50YWctdGV4dCwNCi5jYW52YXMtdGFnIC50YWctdGV4dCwNCi5mbG93LXRhZyBpLA0KLmFyZWEtdGFnIGksDQoudGFnLWl0ZW0gaSwNCi5jYW52YXMtdGFnIGkgew0KICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWJnKSAhaW1wb3J0YW50Ow0KfQ0KDQovKiBUYWcgaW5kaWNhdG9yIGNpcmNsZXMvZG90cyBpbiBjb25maWd1cmF0aW9uIGFyZWEgKi8NCi50YWctaW5kaWNhdG9yLA0KLnRhZy1jb2xvci1pbmRpY2F0b3IsDQoudGFnLWNpcmNsZSwNCi50YWctZG90LA0KLmFyZWEtdGFnLWluZGljYXRvciwNCi50YWctY29sb3Igew0KICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudDsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpICFpbXBvcnRhbnQ7DQp9DQoNCi8qIFRhZyBpdGVtcyBpbiBjb25maWd1cmF0aW9uIGxpc3QgLSBtYXRjaCBub2RlIGxpc3Qgc3R5bGluZyAqLw0KLnRhZy1pdGVtIHsNCiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1nbGFzcy1iZykgIWltcG9ydGFudDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KTsNCiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOw0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpICFpbXBvcnRhbnQ7DQp9DQoNCi50YWctaXRlbTpob3ZlciB7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAyMTIsIDI1NSwgMC4xKSAhaW1wb3J0YW50Ow0KICAgIGJvcmRlci1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50Ow0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsNCiAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMCwgMjEyLCAyNTUsIDAuMik7DQp9DQoNCi50YWctaXRlbSAudGFnLW5hbWUgew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpICFpbXBvcnRhbnQ7DQp9DQoNCi50YWctaXRlbSAudGFnLWluZm8gew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpICFpbXBvcnRhbnQ7DQp9DQoNCi8qIFRhZyBkZWxldGUgYnV0dG9uIHN0eWxpbmcgKi8NCi50YWctZGVsZXRlLA0KLnRhZy1pdGVtIC50YWctZGVsZXRlIHsNCiAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KSAhaW1wb3J0YW50Ow0KICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyOiBub25lICFpbXBvcnRhbnQ7DQp9DQoNCi50YWctZGVsZXRlOmhvdmVyLA0KLnRhZy1pdGVtIC50YWctZGVsZXRlOmhvdmVyIHsNCiAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKSAhaW1wb3J0YW50Ow0KfQ0KDQoudGFnLWRlbGV0ZSBpLA0KLnRhZy1pdGVtIC50YWctZGVsZXRlIGkgew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXByaW1hcnkpICFpbXBvcnRhbnQ7DQp9DQoNCi50YWctZGVsZXRlOmhvdmVyIGksDQoudGFnLWl0ZW0gLnRhZy1kZWxldGU6aG92ZXIgaSB7DQogICAgY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcikgIWltcG9ydGFudDsNCn0NCg0KLyogQ29uZmlndXJhdGlvbiBhcmVhIGhlYWRlciB0ZXh0ICovDQouY29uZmlnLWhlYWRlciwNCi5jb25maWd1cmF0aW9uLWhlYWRlciwNCi5mbG93LWNvbmZpZy1oZWFkZXIsDQouY29uZmlnLXBsYWNlaG9sZGVyLA0KLmNvbmZpZ3VyYXRpb24tcGxhY2Vob2xkZXIsDQouZmxvdy1jb25maWctYXJlYSBwLA0KLmZsb3ctY29uZmlnLWFyZWEgLnBsYWNlaG9sZGVyLA0KLmZsb3ctY29uZmlnLWFyZWEgLmNvbmZpZy1tZXNzYWdlLA0KLmNvbmZpZy1hcmVhIHAsDQouY29uZmlnLWFyZWEgLnBsYWNlaG9sZGVyLA0KLmNvbmZpZy1hcmVhIC5jb25maWctbWVzc2FnZSwNCi5mbG93LWNvbmZpZ3VyYXRpb24gcCwNCi5mbG93LWNvbmZpZ3VyYXRpb24gLnBsYWNlaG9sZGVyLA0KLnRleHQtbXV0ZWQgew0KICAgIGNvbG9yOiB2YXIoLS10ZXh0LXNlY29uZGFyeSkgIWltcG9ydGFudDsNCn0NCg0KLyogUnVubmluZyBzdGF0ZSB3aXRoIHB1bHNpbmcgZWZmZWN0ICovDQouZmxvdy1ub2RlLnJ1bm5pbmcgew0KICAgIGFuaW1hdGlvbjogcHVsc2UtbmVvbiAycyBpbmZpbml0ZTsNCiAgICBib3JkZXItY29sb3I6IHZhcigtLXN1Y2Nlc3MtY29sb3IpOw0KfQ0KDQpAa2V5ZnJhbWVzIHB1bHNlLW5lb24gew0KICAgIDAlLCAxMDAlIHsgDQogICAgICAgIGJveC1zaGFkb3c6IDAgMCA1cHggcmdiYSg0NiwgMjEzLCAxMTUsIDAuNSk7DQogICAgfQ0KICAgIDUwJSB7IA0KICAgICAgICBib3gtc2hhZG93OiAwIDAgMjBweCByZ2JhKDQ2LCAyMTMsIDExNSwgMC44KSwgMCAwIDMwcHggcmdiYSg0NiwgMjEzLCAxMTUsIDAuNCk7DQogICAgfQ0KfQ0KDQovKiBFcnJvciBzdGF0ZSAqLw0KLmZsb3ctbm9kZS5lcnJvciB7DQogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7DQogICAgYW5pbWF0aW9uOiBwdWxzZS1lcnJvci1uZW9uIDFzIGluZmluaXRlOw0KfQ0KDQpAa2V5ZnJhbWVzIHB1bHNlLWVycm9yLW5lb24gew0KICAgIDAlLCAxMDAlIHsgDQogICAgICAgIGJveC1zaGFkb3c6IDAgMCA1cHggcmdiYSgyNTUsIDcxLCA4NywgMC41KTsNCiAgICB9DQogICAgNTAlIHsgDQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAyMHB4IHJnYmEoMjU1LCA3MSwgODcsIDAuOCksIDAgMCAzMHB4IHJnYmEoMjU1LCA3MSwgODcsIDAuNCk7DQogICAgfQ0KfQ0KDQovKiBSZXNwb25zaXZlIGFkanVzdG1lbnRzICovDQpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsNCiAgICAuZmxvdy10b29sYm94IHsNCiAgICAgICAgd2lkdGg6IDIwMHB4Ow0KICAgIH0NCiAgICANCiAgICAuZmxvdy1ub2RlIHsNCiAgICAgICAgbWluLXdpZHRoOiAxMjBweDsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIH0NCiAgICANCiAgICAudG9vbGJveC1ub2RlLWJ0biB7DQogICAgICAgIHBhZGRpbmc6IDhweCAxMHB4Ow0KICAgICAgICBmb250LXNpemU6IDEycHg7DQogICAgfQ0KfQ0KPC9zdHlsZT4NCjxzY3JpcHQ+Ly8gPT09PT0gU2NyaXB0OiBqcy91dGlscy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvbm9kZS1yZWdpc3RyeS5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvY2FudmFzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9ub2RlLWNvbmZpZy5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvbm9kZS1yZW5kZXJlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvZGF0YS1leGVjdXRvcnMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2h0dHAtZXhlY3V0b3JzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9tZWRpYS1leGVjdXRvcnMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2Zsb3ctZXhlY3V0b3JzLmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9haS1leGVjdXRvcnMuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2V4ZWN1dGlvbi1lbmdpbmUuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL3dvcmtmbG93LmpzID09PT09DQoNCg0KLy8gPT09PT0gU2NyaXB0OiBqcy9jYW52YXMtbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvdGFnLW1hbmFnZXIuanMgPT09PT0NCg0KDQovLyA9PT09PSBTY3JpcHQ6IGpzL2ZpbGUtbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvdWktbWFuYWdlci5qcyA9PT09PQ0KDQoNCi8vID09PT09IFNjcmlwdDoganMvbWFpbi5qcyA9PT09PQ0KDQoNCi8vIHV0aWxzLmpzIC0gVXRpbGl0eSBmdW5jdGlvbnMgZm9yIEZsb3cgRWRpdG9yDQoNCi8vIFNjYWxlIGNvbXBlbnNhdGlvbiB1dGlsaXRpZXMNCmxldCBhcHBTY2FsZSA9IDEuMDsNCg0KLy8gRGV0ZWN0IHRoZSBjdXJyZW50IGFwcCBzY2FsZSBmcm9tIENTUyB0cmFuc2Zvcm0NCmZ1bmN0aW9uIGRldGVjdEFwcFNjYWxlKCkgew0KICAgIHRyeSB7DQogICAgICAgIC8vIEZpbmQgdGhlIGFwcCB3aW5kb3cgY29udGFpbmVyDQogICAgICAgIGNvbnN0IGFwcFdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcHAtd2luZG93Jyk7DQogICAgICAgIGlmICghYXBwV2luZG93KSB7DQogICAgICAgICAgICByZXR1cm4gMS4wOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQ2hlY2sgZm9yIHNjYWxlIGNsYXNzZXMNCiAgICAgICAgY29uc3Qgc2NhbGVDbGFzc2VzID0gWydzY2FsZS03NScsICdzY2FsZS04MCcsICdzY2FsZS04NScsICdzY2FsZS05MCcsICdzY2FsZS05NScsDQogICAgICAgICAgICAnc2NhbGUtMTAwJywgJ3NjYWxlLTEwNScsICdzY2FsZS0xMTAnLCAnc2NhbGUtMTE1JywgJ3NjYWxlLTEyMCcsDQogICAgICAgICAgICAnc2NhbGUtMTI1JywgJ3NjYWxlLTEzMCcsICdzY2FsZS0xMzUnLCAnc2NhbGUtMTQwJywgJ3NjYWxlLTE0NScsICdzY2FsZS0xNTAnXTsNCg0KICAgICAgICBmb3IgKGNvbnN0IHNjYWxlQ2xhc3Mgb2Ygc2NhbGVDbGFzc2VzKSB7DQogICAgICAgICAgICBpZiAoYXBwV2luZG93LmNsYXNzTGlzdC5jb250YWlucyhzY2FsZUNsYXNzKSkgew0KICAgICAgICAgICAgICAgIGNvbnN0IHNjYWxlVmFsdWUgPSBwYXJzZUludChzY2FsZUNsYXNzLnJlcGxhY2UoJ3NjYWxlLScsICcnKSk7DQogICAgICAgICAgICAgICAgYXBwU2NhbGUgPSBzY2FsZVZhbHVlIC8gMTAwOw0KICAgICAgICAgICAgICAgIHJldHVybiBhcHBTY2FsZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEZhbGxiYWNrOiBjaGVjayBjb21wdXRlZCB0cmFuc2Zvcm0NCiAgICAgICAgY29uc3QgY29tcHV0ZWRTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGFwcFdpbmRvdyk7DQogICAgICAgIGNvbnN0IHRyYW5zZm9ybSA9IGNvbXB1dGVkU3R5bGUudHJhbnNmb3JtOw0KICAgICAgICBpZiAodHJhbnNmb3JtICYmIHRyYW5zZm9ybSAhPT0gJ25vbmUnKSB7DQogICAgICAgICAgICAvLyBQYXJzZSB0cmFuc2Zvcm0gbWF0cml4IHRvIGV4dHJhY3Qgc2NhbGUNCiAgICAgICAgICAgIGNvbnN0IG1hdHJpeCA9IHRyYW5zZm9ybS5tYXRjaCgvbWF0cml4XCgoW14pXSspXCkvKTsNCiAgICAgICAgICAgIGlmIChtYXRyaXgpIHsNCiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBtYXRyaXhbMV0uc3BsaXQoJywnKS5tYXAodiA9PiBwYXJzZUZsb2F0KHYudHJpbSgpKSk7DQogICAgICAgICAgICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPj0gNCkgew0KICAgICAgICAgICAgICAgICAgICAvLyBNYXRyaXggZm9ybWF0OiBtYXRyaXgoYSwgYiwgYywgZCwgdHgsIHR5KSB3aGVyZSBhIGFuZCBkIGFyZSBzY2FsZSBmYWN0b3JzDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjYWxlWCA9IHZhbHVlc1swXTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2NhbGVZID0gdmFsdWVzWzNdOw0KICAgICAgICAgICAgICAgICAgICBhcHBTY2FsZSA9IChzY2FsZVggKyBzY2FsZVkpIC8gMjsgLy8gQXZlcmFnZSBvZiBYIGFuZCBZIHNjYWxlDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBhcHBTY2FsZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gMS4wOw0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRldGVjdGluZyBhcHAgc2NhbGU6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4gMS4wOw0KICAgIH0NCn0NCg0KLy8gR2V0IHRoZSB0b3RhbCBlZmZlY3RpdmUgc2NhbGUgKGFwcCBzY2FsZSDDlyB6b29tIHNjYWxlKQ0KZnVuY3Rpb24gZ2V0RWZmZWN0aXZlU2NhbGUoKSB7DQogICAgY29uc3QgYXBwU2NhbGUgPSBkZXRlY3RBcHBTY2FsZSgpOw0KICAgIGNvbnN0IHpvb21TY2FsZSA9ICh0eXBlb2YgZmxvd0VkaXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgZmxvd0VkaXRvci56b29tTGV2ZWwpID8gZmxvd0VkaXRvci56b29tTGV2ZWwgOiAxLjA7DQogICAgcmV0dXJuIGFwcFNjYWxlICogem9vbVNjYWxlOw0KfQ0KDQovLyBDb252ZXJ0IHNjcmVlbiBjb29yZGluYXRlcyB0byBhcHAgY29vcmRpbmF0ZXMgKGFjY291bnRpbmcgZm9yIGJvdGggYXBwIHNjYWxlIGFuZCB6b29tKQ0KZnVuY3Rpb24gc2NyZWVuVG9BcHBDb29yZHMoc2NyZWVuWCwgc2NyZWVuWSkgew0KICAgIGNvbnN0IHNjYWxlID0gZ2V0RWZmZWN0aXZlU2NhbGUoKTsNCiAgICByZXR1cm4gew0KICAgICAgICB4OiBzY3JlZW5YIC8gc2NhbGUsDQogICAgICAgIHk6IHNjcmVlblkgLyBzY2FsZQ0KICAgIH07DQp9DQoNCi8vIENvbnZlcnQgYXBwIGNvb3JkaW5hdGVzIHRvIHNjcmVlbiBjb29yZGluYXRlcyAoYWNjb3VudGluZyBmb3IgYm90aCBhcHAgc2NhbGUgYW5kIHpvb20pDQpmdW5jdGlvbiBhcHBUb1NjcmVlbkNvb3JkcyhhcHBYLCBhcHBZKSB7DQogICAgY29uc3Qgc2NhbGUgPSBnZXRFZmZlY3RpdmVTY2FsZSgpOw0KICAgIHJldHVybiB7DQogICAgICAgIHg6IGFwcFggKiBzY2FsZSwNCiAgICAgICAgeTogYXBwWSAqIHNjYWxlDQogICAgfTsNCn0NCg0KLy8gR2V0IHNjYWxlZCBlbGVtZW50IHJlY3QgKGNvbXBlbnNhdGVzIGZvciBhcHAgc2NhbGluZyBhbmQgem9vbSkNCmZ1bmN0aW9uIGdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50KSB7DQogICAgY29uc3QgcmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgY29uc3QgYXBwU2NhbGUgPSBkZXRlY3RBcHBTY2FsZSgpOw0KICAgIC8vIE5vdGU6IERvbid0IGluY2x1ZGUgem9vbSBzY2FsZSBoZXJlIGFzIGdldEJvdW5kaW5nQ2xpZW50UmVjdCBhbHJlYWR5IGFjY291bnRzIGZvciBDU1MgdHJhbnNmb3Jtcw0KDQogICAgcmV0dXJuIHsNCiAgICAgICAgbGVmdDogcmVjdC5sZWZ0IC8gYXBwU2NhbGUsDQogICAgICAgIHRvcDogcmVjdC50b3AgLyBhcHBTY2FsZSwNCiAgICAgICAgcmlnaHQ6IHJlY3QucmlnaHQgLyBhcHBTY2FsZSwNCiAgICAgICAgYm90dG9tOiByZWN0LmJvdHRvbSAvIGFwcFNjYWxlLA0KICAgICAgICB3aWR0aDogcmVjdC53aWR0aCAvIGFwcFNjYWxlLA0KICAgICAgICBoZWlnaHQ6IHJlY3QuaGVpZ2h0IC8gYXBwU2NhbGUsDQogICAgICAgIHg6IHJlY3QueCAvIGFwcFNjYWxlLA0KICAgICAgICB5OiByZWN0LnkgLyBhcHBTY2FsZQ0KICAgIH07DQp9DQoNCi8vIEdldCBzY2FsZWQgbW91c2UgY29vcmRpbmF0ZXMgZnJvbSBldmVudCAoY29tcGVuc2F0ZXMgZm9yIGFwcCBzY2FsaW5nIG9ubHkpDQpmdW5jdGlvbiBnZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSB7DQogICAgY29uc3QgYXBwU2NhbGUgPSBkZXRlY3RBcHBTY2FsZSgpOw0KICAgIHJldHVybiB7DQogICAgICAgIHg6IGUuY2xpZW50WCAvIGFwcFNjYWxlLA0KICAgICAgICB5OiBlLmNsaWVudFkgLyBhcHBTY2FsZQ0KICAgIH07DQp9DQoNCi8vIEluaXRpYWxpemUgc2NhbGUgZGV0ZWN0aW9uDQpmdW5jdGlvbiBpbml0U2NhbGVEZXRlY3Rpb24oKSB7DQogICAgLy8gRGV0ZWN0IHNjYWxlIG9uIGluaXRpYWxpemF0aW9uDQogICAgZGV0ZWN0QXBwU2NhbGUoKTsNCg0KICAgIC8vIExpc3RlbiBmb3Igc2NhbGUgY2hhbmdlcyAoaWYgdGhlIGFwcCBzY2FsZSBjaGFuZ2VzIGR5bmFtaWNhbGx5KQ0KICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9ucykgPT4gew0KICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaCgobXV0YXRpb24pID0+IHsNCiAgICAgICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAnYXR0cmlidXRlcycgJiYgbXV0YXRpb24uYXR0cmlidXRlTmFtZSA9PT0gJ2NsYXNzJykgew0KICAgICAgICAgICAgICAgIGNvbnN0IG9sZFNjYWxlID0gYXBwU2NhbGU7DQogICAgICAgICAgICAgICAgY29uc3QgbmV3U2NhbGUgPSBkZXRlY3RBcHBTY2FsZSgpOw0KICAgICAgICAgICAgICAgIGlmIChvbGRTY2FsZSAhPT0gbmV3U2NhbGUpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gVHJpZ2dlciBhbnkgbmVjZXNzYXJ5IHVwZGF0ZXMNCiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZWRyYXdBbGxDb25uZWN0aW9ucyA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfSk7DQoNCiAgICAvLyBPYnNlcnZlIHRoZSBhcHAgd2luZG93IGZvciBjbGFzcyBjaGFuZ2VzDQogICAgY29uc3QgYXBwV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFwcC13aW5kb3cnKTsNCiAgICBpZiAoYXBwV2luZG93KSB7DQogICAgICAgIG9ic2VydmVyLm9ic2VydmUoYXBwV2luZG93LCB7DQogICAgICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlLA0KICAgICAgICAgICAgYXR0cmlidXRlRmlsdGVyOiBbJ2NsYXNzJ10NCiAgICAgICAgfSk7DQogICAgfQ0KDQogICAgcmV0dXJuIG9ic2VydmVyOw0KfQ0KDQovLyBVdGlsaXR5IGZ1bmN0aW9uIHRvIGVzY2FwZSBIVE1MDQpmdW5jdGlvbiBlc2NhcGVIdG1sKHRleHQpIHsNCiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBkaXYudGV4dENvbnRlbnQgPSB0ZXh0Ow0KICAgIHJldHVybiBkaXYuaW5uZXJIVE1MOw0KfQ0KDQovLyBVdGlsaXR5IGZ1bmN0aW9uIHRvIGZvcm1hdCBmaWxlIHNpemUNCmZ1bmN0aW9uIGZvcm1hdEZpbGVTaXplKGJ5dGVzKSB7DQogICAgaWYgKGJ5dGVzID09PSAwKSByZXR1cm4gJzAgQnl0ZXMnOw0KICAgIGNvbnN0IGsgPSAxMDI0Ow0KICAgIGNvbnN0IHNpemVzID0gWydCeXRlcycsICdLQicsICdNQicsICdHQiddOw0KICAgIGNvbnN0IGkgPSBNYXRoLmZsb29yKE1hdGgubG9nKGJ5dGVzKSAvIE1hdGgubG9nKGspKTsNCiAgICByZXR1cm4gcGFyc2VGbG9hdCgoYnl0ZXMgLyBNYXRoLnBvdyhrLCBpKSkudG9GaXhlZCgyKSkgKyAnICcgKyBzaXplc1tpXTsNCn0NCg0KLy8gVXRpbGl0eSBmdW5jdGlvbiB0byBkZWJvdW5jZSBmdW5jdGlvbiBjYWxscw0KZnVuY3Rpb24gZGVib3VuY2UoZnVuYywgd2FpdCkgew0KICAgIGxldCB0aW1lb3V0Ow0KICAgIHJldHVybiBmdW5jdGlvbiBleGVjdXRlZEZ1bmN0aW9uKC4uLmFyZ3MpIHsNCiAgICAgICAgY29uc3QgbGF0ZXIgPSAoKSA9PiB7DQogICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7DQogICAgICAgICAgICBmdW5jKC4uLmFyZ3MpOw0KICAgICAgICB9Ow0KICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7DQogICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTsNCiAgICB9Ow0KfQ0KDQoNCi8vIEhlbHBlciBtZXRob2QgZm9yIHRlbXBsYXRlIHByb2Nlc3NpbmcNCmZ1bmN0aW9uIHByb2Nlc3NUZW1wbGF0ZXModGVtcGxhdGUsIGRhdGEpIHsNCiAgICAvLyBTaW1wbGUgdGVtcGxhdGUgcHJvY2Vzc2luZyAtIGNhbiBiZSBlbmhhbmNlZA0KICAgIGxldCByZXN1bHQgPSB0ZW1wbGF0ZTsNCiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdvYmplY3QnKSB7DQogICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGEpKSB7DQogICAgICAgICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShuZXcgUmVnRXhwKGB7eyR7a2V5fX19YCwgJ2cnKSwgdmFsdWUpOw0KICAgICAgICB9DQogICAgfQ0KICAgIHJldHVybiByZXN1bHQ7DQp9DQoNCi8vIEhlbHBlciBtZXRob2QgZm9yIGV4dHJhY3RpbmcgbmVzdGVkIEpTT04gdmFsdWVzDQpmdW5jdGlvbiBleHRyYWN0TmVzdGVkVmFsdWUob2JqLCBwYXRoKSB7DQogICAgY29uc3Qga2V5cyA9IHBhdGguc3BsaXQoJy4nKTsNCiAgICBsZXQgY3VycmVudCA9IG9iajsNCg0KICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHsNCiAgICAgICAgaWYgKGN1cnJlbnQgPT09IG51bGwgfHwgY3VycmVudCA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEhhbmRsZSBhcnJheSBhY2Nlc3MgbGlrZSAiaXRlbXNbMF0ubmFtZSINCiAgICAgICAgY29uc3QgYXJyYXlNYXRjaCA9IGtleS5tYXRjaCgvXiguKylcWyhcZCspXF0kLyk7DQogICAgICAgIGlmIChhcnJheU1hdGNoKSB7DQogICAgICAgICAgICBjb25zdCBhcnJheUtleSA9IGFycmF5TWF0Y2hbMV07DQogICAgICAgICAgICBjb25zdCBhcnJheUluZGV4ID0gcGFyc2VJbnQoYXJyYXlNYXRjaFsyXSk7DQoNCiAgICAgICAgICAgIGlmIChjdXJyZW50W2FycmF5S2V5XSAmJiBBcnJheS5pc0FycmF5KGN1cnJlbnRbYXJyYXlLZXldKSkgew0KICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50W2FycmF5S2V5XVthcnJheUluZGV4XTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFtrZXldOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcmV0dXJuIGN1cnJlbnQ7DQp9DQoNCi8vIEhlbHBlciBtZXRob2QgdG8gZGV0ZWN0IGltYWdlIHR5cGUgZnJvbSBiYXNlNjQgZGF0YQ0KZnVuY3Rpb24gZGV0ZWN0SW1hZ2VUeXBlRnJvbUJhc2U2NChiYXNlNjREYXRhKSB7DQogICAgLy8gQ2hlY2sgdGhlIGZpcnN0IGZldyBieXRlcyB0byBkZXRlcm1pbmUgaW1hZ2UgdHlwZQ0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IGJpbmFyeVN0cmluZyA9IGF0b2IoYmFzZTY0RGF0YSk7DQogICAgICAgIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYmluYXJ5U3RyaW5nLmxlbmd0aCk7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmluYXJ5U3RyaW5nLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBieXRlc1tpXSA9IGJpbmFyeVN0cmluZy5jaGFyQ29kZUF0KGkpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQ2hlY2sgZmlsZSBzaWduYXR1cmVzDQogICAgICAgIGlmIChieXRlc1swXSA9PT0gMHhGRiAmJiBieXRlc1sxXSA9PT0gMHhEOCAmJiBieXRlc1syXSA9PT0gMHhGRikgew0KICAgICAgICAgICAgcmV0dXJuICdpbWFnZS9qcGVnJzsNCiAgICAgICAgfSBlbHNlIGlmIChieXRlc1swXSA9PT0gMHg4OSAmJiBieXRlc1sxXSA9PT0gMHg1MCAmJiBieXRlc1syXSA9PT0gMHg0RSAmJiBieXRlc1szXSA9PT0gMHg0Nykgew0KICAgICAgICAgICAgcmV0dXJuICdpbWFnZS9wbmcnOw0KICAgICAgICB9IGVsc2UgaWYgKGJ5dGVzWzBdID09PSAweDQ3ICYmIGJ5dGVzWzFdID09PSAweDQ5ICYmIGJ5dGVzWzJdID09PSAweDQ2KSB7DQogICAgICAgICAgICByZXR1cm4gJ2ltYWdlL2dpZic7DQogICAgICAgIH0gZWxzZSBpZiAoYnl0ZXNbMF0gPT09IDB4NTIgJiYgYnl0ZXNbMV0gPT09IDB4NDkgJiYgYnl0ZXNbMl0gPT09IDB4NDYgJiYgYnl0ZXNbM10gPT09IDB4NDYpIHsNCiAgICAgICAgICAgIHJldHVybiAnaW1hZ2Uvd2VicCc7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBEZWZhdWx0IHRvIFBORyBpZiB3ZSBjYW4ndCBkZXRlcm1pbmUNCiAgICAgICAgICAgIHJldHVybiAnaW1hZ2UvcG5nJzsNCiAgICAgICAgfQ0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgLy8gRGVmYXVsdCB0byBQTkcgaWYgdGhlcmUncyBhbiBlcnJvcg0KICAgICAgICByZXR1cm4gJ2ltYWdlL3BuZyc7DQogICAgfQ0KfQ0KDQovLyBDb252ZXJ0IHZpZXdwb3J0IGNvb3JkaW5hdGVzIHRvIGNhbnZhcyBjb29yZGluYXRlcyAoYWNjb3VudGluZyBmb3IgcGFuIGFuZCB6b29tKQ0KZnVuY3Rpb24gdmlld3BvcnRUb0NhbnZhc0Nvb3Jkcyh2aWV3cG9ydFgsIHZpZXdwb3J0WSkgew0KICAgIGlmICh0eXBlb2YgZmxvd0VkaXRvciA9PT0gJ3VuZGVmaW5lZCcpIHsNCiAgICAgICAgcmV0dXJuIHsgeDogdmlld3BvcnRYLCB5OiB2aWV3cG9ydFkgfTsNCiAgICB9DQogICAgDQogICAgcmV0dXJuIHsNCiAgICAgICAgeDogKHZpZXdwb3J0WCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWwsDQogICAgICAgIHk6ICh2aWV3cG9ydFkgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsDQogICAgfTsNCn0NCg0KLy8gQ29udmVydCBjYW52YXMgY29vcmRpbmF0ZXMgdG8gdmlld3BvcnQgY29vcmRpbmF0ZXMgKGFjY291bnRpbmcgZm9yIHBhbiBhbmQgem9vbSkNCmZ1bmN0aW9uIGNhbnZhc1RvVmlld3BvcnRDb29yZHMoY2FudmFzWCwgY2FudmFzWSkgew0KICAgIGlmICh0eXBlb2YgZmxvd0VkaXRvciA9PT0gJ3VuZGVmaW5lZCcpIHsNCiAgICAgICAgcmV0dXJuIHsgeDogY2FudmFzWCwgeTogY2FudmFzWSB9Ow0KICAgIH0NCiAgICANCiAgICByZXR1cm4gew0KICAgICAgICB4OiAoY2FudmFzWCAqIGZsb3dFZGl0b3Iuem9vbUxldmVsKSArIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngsDQogICAgICAgIHk6IChjYW52YXNZICogZmxvd0VkaXRvci56b29tTGV2ZWwpICsgZmxvd0VkaXRvci5wYW5PZmZzZXQueQ0KICAgIH07DQp9DQoNCi8vIEdldCB0aGUgY2VudGVyIG9mIHRoZSBjdXJyZW50IHZpZXdwb3J0IGluIGNhbnZhcyBjb29yZGluYXRlcw0KZnVuY3Rpb24gZ2V0Vmlld3BvcnRDZW50ZXJJbkNhbnZhcygpIHsNCiAgICBpZiAodHlwZW9mIGZsb3dFZGl0b3IgPT09ICd1bmRlZmluZWQnIHx8ICFmbG93RWRpdG9yLmNhbnZhcykgew0KICAgICAgICByZXR1cm4geyB4OiAwLCB5OiAwIH07DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgaWYgKCFjb250YWluZXIpIHsNCiAgICAgICAgcmV0dXJuIHsgeDogMCwgeTogMCB9Ow0KICAgIH0NCiAgICANCiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOw0KICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICANCiAgICByZXR1cm4gdmlld3BvcnRUb0NhbnZhc0Nvb3Jkcyh2aWV3cG9ydENlbnRlclgsIHZpZXdwb3J0Q2VudGVyWSk7DQp9DQoNCi8vIENlbnRlciB0aGUgdmlld3BvcnQgb24gc3BlY2lmaWMgY2FudmFzIGNvb3JkaW5hdGVzDQpmdW5jdGlvbiBjZW50ZXJWaWV3cG9ydE9uQ2FudmFzKGNhbnZhc1gsIGNhbnZhc1kpIHsNCiAgICBpZiAodHlwZW9mIGZsb3dFZGl0b3IgPT09ICd1bmRlZmluZWQnIHx8ICFmbG93RWRpdG9yLmNhbnZhcykgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgaWYgKCFjb250YWluZXIpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOw0KICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICANCiAgICAvLyBDYWxjdWxhdGUgcGFuIG9mZnNldCB0byBjZW50ZXIgdGhlIHNwZWNpZmllZCBjYW52YXMgY29vcmRpbmF0ZXMgaW4gdGhlIHZpZXdwb3J0DQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IHZpZXdwb3J0Q2VudGVyWCAtIChjYW52YXNYICogZmxvd0VkaXRvci56b29tTGV2ZWwpOw0KICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSB2aWV3cG9ydENlbnRlclkgLSAoY2FudmFzWSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsKTsNCiAgICANCiAgICAvLyBVcGRhdGUgdGhlIHRyYW5zZm9ybQ0KICAgIGlmICh3aW5kb3cuY2FudmFzTWFuYWdlciAmJiB3aW5kb3cuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0pIHsNCiAgICAgICAgd2luZG93LmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgfQ0KfQ0KDQovLyBFeHBvcnQgdXRpbGl0aWVzIGZvciB1c2UgaW4gb3RoZXIgbW9kdWxlcw0Kd2luZG93LmZsb3dFZGl0b3JVdGlscyA9IHsNCiAgICBkZXRlY3RBcHBTY2FsZSwNCiAgICBnZXRFZmZlY3RpdmVTY2FsZSwNCiAgICBzY3JlZW5Ub0FwcENvb3JkcywNCiAgICBhcHBUb1NjcmVlbkNvb3JkcywNCiAgICBnZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QsDQogICAgZ2V0U2NhbGVkTW91c2VDb29yZHMsDQogICAgaW5pdFNjYWxlRGV0ZWN0aW9uLA0KICAgIGVzY2FwZUh0bWwsDQogICAgZm9ybWF0RmlsZVNpemUsDQogICAgZGVib3VuY2UsDQogICAgcHJvY2Vzc1RlbXBsYXRlcywNCiAgICBleHRyYWN0TmVzdGVkVmFsdWUsDQogICAgZGV0ZWN0SW1hZ2VUeXBlRnJvbUJhc2U2NCwNCiAgICB2aWV3cG9ydFRvQ2FudmFzQ29vcmRzLA0KICAgIGNhbnZhc1RvVmlld3BvcnRDb29yZHMsDQogICAgZ2V0Vmlld3BvcnRDZW50ZXJJbkNhbnZhcywNCiAgICBjZW50ZXJWaWV3cG9ydE9uQ2FudmFzDQp9Ow0KDQovLyBSZXBsYWNlIHRlbXBsYXRlIHBsYWNlaG9sZGVycyBpbiBKU09OIGJvZHkNCmZ1bmN0aW9uIHJlcGxhY2VUZW1wbGF0ZVBsYWNlaG9sZGVycyhib2R5LCB0ZW1wbGF0ZURhdGEpIHsNCg0KICAgIGlmICghYm9keSkgew0KICAgICAgICByZXR1cm4gYm9keTsNCiAgICB9DQoNCiAgICAvLyBIYW5kbGUgYm90aCBzdHJpbmcgYW5kIG9iamVjdCBpbnB1dHMNCiAgICBsZXQgYm9keVN0cmluZzsNCiAgICBsZXQgaXNKc29uU3RyaW5nID0gZmFsc2U7DQoNCiAgICBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7DQogICAgICAgIGJvZHlTdHJpbmcgPSBib2R5Ow0KICAgICAgICAvLyBDaGVjayBpZiBpdCdzIGFscmVhZHkgYSBKU09OIHN0cmluZw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgSlNPTi5wYXJzZShib2R5KTsNCiAgICAgICAgICAgIGlzSnNvblN0cmluZyA9IHRydWU7DQogICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgIC8vIE5vdCBhIEpTT04gc3RyaW5nLCB0cmVhdCBhcyByZWd1bGFyIHN0cmluZw0KICAgICAgICB9DQogICAgfSBlbHNlIGlmICh0eXBlb2YgYm9keSA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgYm9keVN0cmluZyA9IEpTT04uc3RyaW5naWZ5KGJvZHkpOw0KICAgICAgICBpc0pzb25TdHJpbmcgPSB0cnVlOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBib2R5Ow0KICAgIH0NCg0KDQogICAgLy8gUmVwbGFjZSBwbGFjZWhvbGRlcnMgd2l0aCB0ZW1wbGF0ZSBkYXRhDQogICAgaWYgKHRlbXBsYXRlRGF0YSAhPT0gdW5kZWZpbmVkICYmIHRlbXBsYXRlRGF0YSAhPT0gbnVsbCkgew0KICAgICAgICBjb25zdCBiZWZvcmVSZXBsYWNlID0gYm9keVN0cmluZzsNCg0KDQogICAgICAgIC8vIFNpbXBsZSBKU09OIGZpZWxkIHJlcGxhY2VtZW50IC0ganVzdCB7e2ZpZWxkfX0gb3Ige3tuZXN0ZWQuZmllbGR9fQ0KICAgICAgICBpZiAodHlwZW9mIHRlbXBsYXRlRGF0YSA9PT0gJ29iamVjdCcpIHsNCg0KICAgICAgICAgICAgLy8gVXNlIGEgc2ltcGxlciwgbW9yZSBleHBsaWNpdCByZWdleA0KICAgICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXJSZWdleCA9IC9ce1x7KFtefV0rKVx9XH0vZzsNCg0KICAgICAgICAgICAgLy8gVGVzdCBpZiB0aGUgcmVnZXggZmluZHMgYW55dGhpbmcNCiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBib2R5U3RyaW5nLm1hdGNoKHBsYWNlaG9sZGVyUmVnZXgpOw0KDQogICAgICAgICAgICBib2R5U3RyaW5nID0gYm9keVN0cmluZy5yZXBsYWNlKHBsYWNlaG9sZGVyUmVnZXgsIChtYXRjaCwgZmllbGRQYXRoKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBnZXROZXN0ZWRWYWx1ZSh0ZW1wbGF0ZURhdGEsIGZpZWxkUGF0aCk7DQogICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgbGV0IHJlcGxhY2VtZW50Ow0KICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWx3YXlzIGVzY2FwZSB0aGUgc3RyaW5nIHByb3Blcmx5IGZvciBKU09OIGNvbnRleHQNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50ID0gdmFsdWUucmVwbGFjZSgvXFwvZywgJ1xcXFwnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC8iL2csICdcXCInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cbi9nLCAnXFxuJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXHIvZywgJ1xccicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1x0L2csICdcXHQnKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBub24tc3RyaW5ncywgY29udmVydCB0byBKU09OIHN0cmluZw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnQgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcGxhY2VtZW50Ow0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXRjaDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdGVtcGxhdGVEYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgLy8gRm9yIHN0cmluZ3MsIGp1c3QgcmVwbGFjZSB7e1ZBTFVFfX0gYXMgYSBmYWxsYmFjaw0KICAgICAgICAgICAgYm9keVN0cmluZyA9IGJvZHlTdHJpbmcucmVwbGFjZSgve3tWQUxVRX19L2csIEpTT04uc3RyaW5naWZ5KHRlbXBsYXRlRGF0YSkpOw0KICAgICAgICB9DQoNCiAgICB9IGVsc2Ugew0KICAgIH0NCg0KICAgIGlmICh0eXBlb2YgYm9keSA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKGJvZHlTdHJpbmcpOw0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIHRlbXBsYXRlLXJlcGxhY2VkIGJvZHk6JywgZXJyb3IpOw0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignQm9keSBzdHJpbmcgd2FzOicsIGJvZHlTdHJpbmcpOw0KICAgICAgICAgICAgcmV0dXJuIGJvZHk7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gYm9keVN0cmluZzsNCiAgICB9DQp9DQoNCi8vIEdldCBuZXN0ZWQgdmFsdWUgZnJvbSBvYmplY3QgdXNpbmcgZG90IG5vdGF0aW9uDQpmdW5jdGlvbiBnZXROZXN0ZWRWYWx1ZShvYmosIHBhdGgpIHsNCiAgICBjb25zdCByZXN1bHQgPSBwYXRoLnNwbGl0KCcuJykucmVkdWNlKChjdXJyZW50LCBrZXkpID0+IHsNCiAgICAgICAgY29uc3QgdmFsdWUgPSBjdXJyZW50ICYmIGN1cnJlbnRba2V5XSAhPT0gdW5kZWZpbmVkID8gY3VycmVudFtrZXldIDogdW5kZWZpbmVkOw0KICAgICAgICByZXR1cm4gdmFsdWU7DQogICAgfSwgb2JqKTsNCiAgICByZXR1cm4gcmVzdWx0Ow0KfQ0KDQoNCi8vIFVwZGF0ZSBKU09OIGV4dHJhY3Qgbm9kZSBkaXNwbGF5DQpmdW5jdGlvbiB1cGRhdGVKc29uRXh0cmFjdERpc3BsYXkobm9kZUlkLCBsYWJlbCwgdmFsdWUsIHN0YXR1cyA9ICdub3JtYWwnKSB7DQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICBjb25zdCBjb250ZW50RWxlbWVudCA9IG5vZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mbG93LW5vZGUtY29udGVudCcpOw0KICAgICAgICBpZiAoY29udGVudEVsZW1lbnQpIHsNCiAgICAgICAgICAgIGNvbnN0IHN0YXR1c0NsYXNzID0gc3RhdHVzID09PSAnZXJyb3InID8gJ3RleHQtZGFuZ2VyJyA6IHN0YXR1cyA9PT0gJ3N1Y2Nlc3MnID8gJ3RleHQtc3VjY2VzcycgOiAndGV4dC1tdXRlZCc7DQoNCiAgICAgICAgICAgIC8vIFNob3cganVzdCBhIHN0YXR1cyBvbiB0aGUgbm9kZSwgZnVsbCBjb250ZW50IHdpbGwgYmUgaW4gY29uZmlnIHBhbmVsDQogICAgICAgICAgICBjb25zdCB0cnVuY2F0ZWRWYWx1ZSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUubGVuZ3RoID4gNTAgPw0KICAgICAgICAgICAgICAgIHZhbHVlLnN1YnN0cmluZygwLCA1MCkgKyAnLi4uJyA6IHZhbHVlOw0KDQogICAgICAgICAgICBjb250ZW50RWxlbWVudC5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibm9kZS1zdGF0dXMiPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0dXMtdGV4dCI+VmFsdWUgZXh0cmFjdGVkPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXR1cy1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD4ke2xhYmVsfTogJHtlc2NhcGVIdG1sKFN0cmluZyh0cnVuY2F0ZWRWYWx1ZSkpfTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gQWRkIGV4ZWN1dGlvbiBsb2cgZW50cnkNCmZ1bmN0aW9uIGFkZEV4ZWN1dGlvbkxvZyhtZXNzYWdlLCB0eXBlID0gJ2luZm8nKSB7DQogICAgY29uc3Qgb3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4ZWN1dGlvbi1vdXRwdXQnKTsNCiAgICBpZiAob3V0cHV0KSB7DQogICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCk7DQogICAgICAgIG91dHB1dC5pbm5lckhUTUwgKz0gYDxkaXYgY2xhc3M9ImxvZy1lbnRyeSAke3R5cGV9Ij5bJHt0aW1lc3RhbXB9XSAke21lc3NhZ2V9PC9kaXY+YDsNCiAgICAgICAgb3V0cHV0LnNjcm9sbFRvcCA9IG91dHB1dC5zY3JvbGxIZWlnaHQ7DQogICAgfQ0KfQ0KDQovLyBDbGVhciBleGVjdXRpb24gb3V0cHV0DQpmdW5jdGlvbiBjbGVhck91dHB1dCgpIHsNCiAgICBjb25zdCBvdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhlY3V0aW9uLW91dHB1dCcpOw0KICAgIGlmIChvdXRwdXQpIHsNCiAgICAgICAgb3V0cHV0LmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPSJsb2ctZW50cnkgaW5mbyI+T3V0cHV0IGNsZWFyZWQ8L2Rpdj4nOw0KICAgIH0NCn0NCg0KDQovLyBJbnRlcmFjdGl2ZSBoZWxwZXIgZnVuY3Rpb25zIGZvciBzcGVjaWFsIG5vZGUgdHlwZXMNCg0KLy8gQXVkaW8gY29udHJvbCBmdW5jdGlvbnMNCmZ1bmN0aW9uIHBsYXlBdWRpbyhub2RlSWQpIHsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUgfHwgIW5vZGUubGFzdEF1ZGlvVXJsKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIGF1ZGlvIGRhdGEgYXZhaWxhYmxlIGZvciBub2RlOicsIG5vZGVJZCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBDcmVhdGUgb3IgcmV1c2UgYXVkaW8gZWxlbWVudA0KICAgIGlmICghbm9kZS5hdWRpb0VsZW1lbnQpIHsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQgPSBuZXcgQXVkaW8obm9kZS5sYXN0QXVkaW9VcmwpOw0KICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC52b2x1bWUgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLnZvbHVtZS52YWx1ZSk7DQogICAgfQ0KDQogICAgbm9kZS5hdWRpb0VsZW1lbnQucGxheSgpLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBsYXkgYXVkaW86JywgZXJyb3IpOw0KICAgIH0pOw0KDQp9DQoNCmZ1bmN0aW9uIHN0b3BBdWRpbyhub2RlSWQpIHsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUgfHwgIW5vZGUuYXVkaW9FbGVtZW50KSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIGF1ZGlvIGVsZW1lbnQgZm91bmQgZm9yIG5vZGU6Jywgbm9kZUlkKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIG5vZGUuYXVkaW9FbGVtZW50LnBhdXNlKCk7DQogICAgbm9kZS5hdWRpb0VsZW1lbnQuY3VycmVudFRpbWUgPSAwOw0KDQp9DQoNCi8vIEltYWdlIGRpc3BsYXkgZnVuY3Rpb25zDQpmdW5jdGlvbiBzaG93RnVsbEltYWdlKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCAhbm9kZS5sYXN0SW1hZ2VVcmwpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTm8gaW1hZ2UgZGF0YSBhdmFpbGFibGUgZm9yIG5vZGU6Jywgbm9kZUlkKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIENyZWF0ZSBhIG1vZGFsIHRvIHNob3cgdGhlIGZ1bGwgaW1hZ2UNCiAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIG1vZGFsLmNsYXNzTmFtZSA9ICdpbWFnZS1tb2RhbCc7DQogICAgbW9kYWwuc3R5bGUuY3NzVGV4dCA9IGANCiAgICAgICAgcG9zaXRpb246IGZpeGVkOw0KICAgICAgICB0b3A6IDA7DQogICAgICAgIGxlZnQ6IDA7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICBoZWlnaHQ6IDEwMCU7DQogICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC44KTsNCiAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICAgIHotaW5kZXg6IDEwMDAwOw0KICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgYDsNCg0KICAgIGNvbnN0IGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpOw0KICAgIGltZy5zcmMgPSBub2RlLmxhc3RJbWFnZVVybDsNCiAgICBpbWcuc3R5bGUuY3NzVGV4dCA9IGANCiAgICAgICAgbWF4LXdpZHRoOiA5MCU7DQogICAgICAgIG1heC1oZWlnaHQ6IDkwJTsNCiAgICAgICAgb2JqZWN0LWZpdDogY29udGFpbjsNCiAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgICAgICBib3gtc2hhZG93OiAwIDRweCAyMHB4IHJnYmEoMCwgMCwgMCwgMC41KTsNCiAgICBgOw0KDQogICAgbW9kYWwuYXBwZW5kQ2hpbGQoaW1nKTsNCiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vZGFsKTsNCg0KICAgIC8vIENsb3NlIG1vZGFsIG9uIGNsaWNrDQogICAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobW9kYWwpOw0KICAgIH0pOw0KDQp9DQoNCi8vIFJlcGVhdGVyIGNvbnRyb2wgZnVuY3Rpb25zDQpmdW5jdGlvbiBzdGFydFJlcGVhdGVyKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCBub2RlLnR5cGUgIT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignSW52YWxpZCByZXBlYXRlciBub2RlOicsIG5vZGVJZCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBFeGVjdXRlIHRoZSByZXBlYXRlciBub2RlIHRvIHN0YXJ0IGl0DQogICAgZXhlY3V0aW9uRW5naW5lLmV4ZWN1dGVOb2RlKG5vZGUsIHt9LCBuZXcgU2V0KCkpLnRoZW4oKCkgPT4gew0KICAgICAgICAvLyBSZWZyZXNoIHRoZSBjb25maWcgcGFuZWwgdG8gdXBkYXRlIHRoZSBVSQ0KICAgICAgICBzaG93Tm9kZUNvbmZpZyhub2RlSWQpOw0KICAgIH0pLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHN0YXJ0IHJlcGVhdGVyOicsIGVycm9yKTsNCiAgICB9KTsNCn0NCg0KZnVuY3Rpb24gc3RvcFJlcGVhdGVyKG5vZGVJZCkgew0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSB8fCBub2RlLnR5cGUgIT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignSW52YWxpZCByZXBlYXRlciBub2RlOicsIG5vZGVJZCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBTdG9wIHRoZSByZXBlYXRlciB1c2luZyB0aGUgZXhlY3V0aW9uIGVuZ2luZSBtZXRob2QNCiAgICBleGVjdXRpb25FbmdpbmUuc3RvcFJlcGVhdGVyKG5vZGUpOw0KDQogICAgLy8gUmVmcmVzaCB0aGUgY29uZmlnIHBhbmVsIHRvIHVwZGF0ZSB0aGUgVUkNCiAgICBzaG93Tm9kZUNvbmZpZyhub2RlSWQpOw0KfQ0KDQoNCg0KLy8gVXBkYXRlIGlucHV0IG1hcHBpbmcgd2hlbiB1c2VyIHNlbGVjdHMgYSBkaWZmZXJlbnQgb3V0cHV0IHBvcnQNCmZ1bmN0aW9uIHVwZGF0ZUlucHV0TWFwcGluZyhub2RlSWQsIGlucHV0UG9ydCwgc2VsZWN0ZWRPdXRwdXRQb3J0KSB7DQogICAgLy8gRmluZCB0aGUgY29ubmVjdGlvbiB0aGF0IGdvZXMgdG8gdGhpcyBpbnB1dCBwb3J0IChpZ25vcmUgZnJvbS5wb3J0TmFtZSkNCiAgICBjb25zdCBjb25uZWN0aW9uID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5maW5kKGNvbm4gPT4NCiAgICAgICAgY29ubi50by5ub2RlSWQgPT09IG5vZGVJZCAmJiBjb25uLnRvLnBvcnROYW1lID09PSBpbnB1dFBvcnQNCiAgICApOw0KICAgIGlmIChjb25uZWN0aW9uKSB7DQogICAgICAgIC8vIFJlbW92ZSB0aGUgb2xkIGNvbm5lY3Rpb24NCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5kZWxldGUoY29ubmVjdGlvbi5pZCk7DQogICAgICAgIGlmIChjb25uZWN0aW9uLnN2ZykgY29ubmVjdGlvbi5zdmcucmVtb3ZlKCk7DQogICAgICAgIC8vIENyZWF0ZSBhIG5ldyBjb25uZWN0aW9uIHdpdGggdGhlIHVwZGF0ZWQgcG9ydCBuYW1lIGFuZCBuZXcgSUQNCiAgICAgICAgY29uc3QgbmV3Q29ubmVjdGlvbklkID0gYGNvbm5fJHtjb25uZWN0aW9uLmZyb20ubm9kZUlkfV8ke3NlbGVjdGVkT3V0cHV0UG9ydH1fJHtjb25uZWN0aW9uLnRvLm5vZGVJZH1fJHtjb25uZWN0aW9uLnRvLnBvcnROYW1lfWA7DQogICAgICAgIGNvbnN0IG5ld0Nvbm5lY3Rpb24gPSB7DQogICAgICAgICAgICBpZDogbmV3Q29ubmVjdGlvbklkLA0KICAgICAgICAgICAgZnJvbTogeyBub2RlSWQ6IGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQsIHBvcnROYW1lOiBzZWxlY3RlZE91dHB1dFBvcnQgfSwNCiAgICAgICAgICAgIHRvOiB7IG5vZGVJZDogY29ubmVjdGlvbi50by5ub2RlSWQsIHBvcnROYW1lOiBjb25uZWN0aW9uLnRvLnBvcnROYW1lIH0NCiAgICAgICAgfTsNCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5zZXQobmV3Q29ubmVjdGlvbklkLCBuZXdDb25uZWN0aW9uKTsNCiAgICAgICAgZHJhd0Nvbm5lY3Rpb24obmV3Q29ubmVjdGlvbik7DQogICAgICAgIC8vIFJlZnJlc2ggdGhlIG5vZGUgY29uZmlnIHBhbmVsIHRvIHNob3cgdXBkYXRlZCBzdGF0ZQ0KICAgICAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPT09IG5vZGVJZCkgew0KICAgICAgICAgICAgc2hvd05vZGVDb25maWcobm9kZUlkKTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBBdXRvLXNhdmUgdGhlIHdvcmtmbG93IHRvIHBlcnNpc3QgdGhlIG1hcHBpbmcgY2hhbmdlDQogICAgICAgIGlmICh3aW5kb3cuZmlsZU1hbmFnZXIuc2F2ZUZsb3cpIHsNCiAgICAgICAgICAgIHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvdygpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBVcGRhdGUgb3V0cHV0IG1hcHBpbmcgd2hlbiB1c2VyIHNlbGVjdHMgYSBkaWZmZXJlbnQgb3V0cHV0IHBvcnQNCmZ1bmN0aW9uIHVwZGF0ZU91dHB1dE1hcHBpbmcobm9kZUlkLCBvdXRwdXRQb3J0LCB0YXJnZXROb2RlSWQsIHNlbGVjdGVkT3V0cHV0UG9ydCkgew0KICAgIC8vIFJlbW92ZSBhbGwgY29ubmVjdGlvbnMgZnJvbSB0aGlzIG5vZGUgdG8gdGhlIHRhcmdldCBub2RlIChyZWdhcmRsZXNzIG9mIHBvcnQpDQogICAgY29uc3QgY29ubmVjdGlvbnNUb1JlbW92ZSA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkuZmlsdGVyKGNvbm4gPT4NCiAgICAgICAgY29ubi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkICYmIGNvbm4udG8ubm9kZUlkID09PSB0YXJnZXROb2RlSWQNCiAgICApOw0KICAgIGNvbm5lY3Rpb25zVG9SZW1vdmUuZm9yRWFjaChjb25uID0+IHsNCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5kZWxldGUoY29ubi5pZCk7DQogICAgICAgIGlmIChjb25uLnN2ZykgY29ubi5zdmcucmVtb3ZlKCk7DQogICAgfSk7DQogICAgLy8gQWRkIHRoZSBuZXcgY29ubmVjdGlvbg0KICAgIGNvbnN0IG5ld0Nvbm5lY3Rpb25JZCA9IGBjb25uXyR7bm9kZUlkfV8ke3NlbGVjdGVkT3V0cHV0UG9ydH1fJHt0YXJnZXROb2RlSWR9YDsNCiAgICBjb25zdCBuZXdDb25uZWN0aW9uID0gew0KICAgICAgICBpZDogbmV3Q29ubmVjdGlvbklkLA0KICAgICAgICBmcm9tOiB7IG5vZGVJZDogbm9kZUlkLCBwb3J0TmFtZTogc2VsZWN0ZWRPdXRwdXRQb3J0IH0sDQogICAgICAgIHRvOiB7IG5vZGVJZDogdGFyZ2V0Tm9kZUlkLCBwb3J0TmFtZTogY29ubmVjdGlvbnNUb1JlbW92ZVswXT8udG8ucG9ydE5hbWUgfHwgJ2RhdGEnIH0NCiAgICB9Ow0KICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuc2V0KG5ld0Nvbm5lY3Rpb25JZCwgbmV3Q29ubmVjdGlvbik7DQogICAgZHJhd0Nvbm5lY3Rpb24obmV3Q29ubmVjdGlvbik7DQogICAgLy8gUmVmcmVzaCB0aGUgdGFyZ2V0IG5vZGUgaWYgc2VsZWN0ZWQNCiAgICBpZiAoZmxvd0VkaXRvci5zZWxlY3RlZE5vZGUgPT09IHRhcmdldE5vZGVJZCkgew0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIHNob3dOb2RlQ29uZmlnKHRhcmdldE5vZGVJZCk7DQogICAgICAgIH0sIDEwKTsNCiAgICB9DQogICAgLy8gQXV0by1zYXZlDQogICAgaWYgKHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvdykgd2luZG93LmZpbGVNYW5hZ2VyLnNhdmVGbG93KCk7DQp9DQoNCg0KLy8gbm9kZS1yZWdpc3RyeS5qcyAtIER5bmFtaWMgbm9kZSByZWdpc3RyeSBmb3IgRmxvdyBFZGl0b3INCg0KY2xhc3MgTm9kZVJlZ2lzdHJ5IHsNCiAgICBjb25zdHJ1Y3RvcigpIHsNCiAgICAgICAgdGhpcy5ub2RlVHlwZXMgPSBuZXcgTWFwKCk7DQogICAgICAgIHRoaXMuZXhlY3V0b3JzID0gbmV3IE1hcCgpOw0KICAgICAgICB0aGlzLmxvYWRlZCA9IGZhbHNlOw0KICAgIH0NCiAgICANCiAgICBhc3luYyBsb2FkTm9kZXNGcm9tVkZTKCkgew0KICAgICAgICBpZiAodGhpcy5sb2FkZWQpIHJldHVybjsNCiAgICAgICAgDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIExvYWQgdGhlIHBhY2tlZCBub2RlcyBmaWxlIGRpcmVjdGx5DQogICAgICAgICAgICBjb25zdCBwYWNrRmlsZVBhdGggPSAnL25vZGVzL25vZGVzLXBhY2suanNvbic7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlVGV4dChwYWNrRmlsZVBhdGgpOw0KICAgICAgICAgICAgY29uc3QgcGFja0RhdGEgPSBKU09OLnBhcnNlKGNvbnRlbnQpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFJlZ2lzdGVyIGFsbCBub2RlcyBmcm9tIHRoZSBwYWNrDQogICAgICAgICAgICBmb3IgKGNvbnN0IFtub2RlSWQsIG5vZGVEZWZdIG9mIE9iamVjdC5lbnRyaWVzKHBhY2tEYXRhLm5vZGVzKSkgew0KICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJOb2RlKG5vZGVEZWYpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICB0aGlzLmxvYWRlZCA9IHRydWU7DQogICAgICAgICAgICANCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIG5vZGVzIGZyb20gVkZTIHBhY2tlZCBmaWxlOicsIGVycm9yKTsNCiAgICAgICAgICAgIHRocm93IGVycm9yOyAvLyBSZS10aHJvdyB0byBpbmRpY2F0ZSBmYWlsdXJlDQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgYXN5bmMgbG9hZE5vZGVGaWxlKGZpbGVQYXRoKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZVRleHQoZmlsZVBhdGgpOw0KICAgICAgICAgICAgY29uc3Qgbm9kZURlZiA9IEpTT04ucGFyc2UoY29udGVudCk7DQogICAgICAgICAgICB0aGlzLnJlZ2lzdGVyTm9kZShub2RlRGVmKTsNCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBsb2FkIG5vZGUgZnJvbSAke2ZpbGVQYXRofTpgLCBlcnJvcik7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmVnaXN0ZXJOb2RlKG5vZGVEZWYpIHsNCiAgICAgICAgdGhpcy5ub2RlVHlwZXMuc2V0KG5vZGVEZWYuaWQsIG5vZGVEZWYpOw0KICAgIH0NCiAgICANCiAgICByZWdpc3RlckV4ZWN1dG9yKG5hbWUsIGV4ZWN1dG9yKSB7DQogICAgICAgIHRoaXMuZXhlY3V0b3JzLnNldChuYW1lLCBleGVjdXRvcik7DQogICAgfQ0KICAgIA0KICAgIGdldE5vZGVUeXBlKGlkKSB7DQogICAgICAgIHJldHVybiB0aGlzLm5vZGVUeXBlcy5nZXQoaWQpOw0KICAgIH0NCiAgICANCiAgICBnZXRFeGVjdXRvcihuYW1lKSB7DQogICAgICAgIHJldHVybiB0aGlzLmV4ZWN1dG9ycy5nZXQobmFtZSk7DQogICAgfQ0KICAgIA0KICAgIGdldEFsbE5vZGVUeXBlcygpIHsNCiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5ub2RlVHlwZXMudmFsdWVzKCkpOw0KICAgIH0NCiAgICANCiAgICBnZXROb2RlVHlwZXNCeUNhdGVnb3J5KGNhdGVnb3J5KSB7DQogICAgICAgIHJldHVybiB0aGlzLmdldEFsbE5vZGVUeXBlcygpLmZpbHRlcihub2RlID0+IG5vZGUuY2F0ZWdvcnkgPT09IGNhdGVnb3J5KTsNCiAgICB9DQp9DQoNCi8vIEdsb2JhbCBub2RlIHJlZ2lzdHJ5IGluc3RhbmNlDQpjb25zdCBub2RlUmVnaXN0cnkgPSBuZXcgTm9kZVJlZ2lzdHJ5KCk7DQoNCg0KLy8gY2FudmFzLmpzIC0gQ2FudmFzIGV2ZW50IGhhbmRsZXJzIGFuZCBkcmF3aW5nIGxvZ2ljIGZvciBGbG93IEVkaXRvcg0KDQovLyBTdGFydCBkcmFnZ2luZyBhIG5vZGUNCmZ1bmN0aW9uIHN0YXJ0RHJhZ2dpbmdOb2RlKG5vZGVJZCwgZSkgew0KICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgIA0KICAgIGNvbnN0IG5vZGUgPSBmbG93RWRpdG9yLm5vZGVzLmdldChub2RlSWQpOw0KICAgIGlmICghbm9kZSkgcmV0dXJuOw0KICAgIA0KICAgIGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlID0gbm9kZUlkOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBvZmZzZXQgZnJvbSBtb3VzZSB0byBub2RlIGNvcm5lciB1c2luZyBzY2FsZWQgY29vcmRpbmF0ZXMNCiAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgY29uc3QgcmVjdCA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMgPyANCiAgICAgICAgd2luZG93LmZsb3dFZGl0b3JVdGlscy5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3Qobm9kZUVsZW1lbnQpIDogDQogICAgICAgIG5vZGVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gd2luZG93LmZsb3dFZGl0b3JVdGlscyA/IA0KICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDogDQogICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICANCiAgICBmbG93RWRpdG9yLmRyYWdPZmZzZXQgPSB7DQogICAgICAgIHg6IG1vdXNlQ29vcmRzLnggLSByZWN0LmxlZnQsDQogICAgICAgIHk6IG1vdXNlQ29vcmRzLnkgLSByZWN0LnRvcA0KICAgIH07DQogICAgDQogICAgbm9kZUVsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ2dyYWJiaW5nJzsNCiAgICBub2RlRWxlbWVudC5zdHlsZS56SW5kZXggPSAnMTAwMCc7IC8vIEJyaW5nIHRvIGZyb250IHdoaWxlIGRyYWdnaW5nDQogICAgDQogICAgLy8gQ2FjaGUgY2FudmFzIHJlY3QgZm9yIHBlcmZvcm1hbmNlIChzY2FsZWQpDQogICAgZmxvd0VkaXRvci5jYW52YXNSZWN0ID0gd2luZG93LmZsb3dFZGl0b3JVdGlscyA/IA0KICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChmbG93RWRpdG9yLmNhbnZhcykgOiANCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQp9DQoNCi8vIFNlbGVjdCBhIG5vZGUNCmZ1bmN0aW9uIHNlbGVjdE5vZGUobm9kZUlkKSB7DQogICAgLy8gUmVtb3ZlIHByZXZpb3VzIHNlbGVjdGlvbg0KICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mbG93LW5vZGUuc2VsZWN0ZWQnKS5mb3JFYWNoKG5vZGUgPT4gew0KICAgICAgICBub2RlLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7DQogICAgfSk7DQogICAgDQogICAgLy8gU2VsZWN0IG5ldyBub2RlDQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlSWQpOw0KICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOw0KICAgICAgICBmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9IG5vZGVJZDsNCiAgICAgICAgc2hvd05vZGVDb25maWcobm9kZUlkKTsNCiAgICB9DQp9DQoNCg0KLy8gU3RhcnQgYSBjb25uZWN0aW9uIGZyb20gYSBwb3J0DQpmdW5jdGlvbiBzdGFydENvbm5lY3Rpb24obm9kZUlkLCBwb3J0TmFtZSwgaXNPdXRwdXQpIHsNCiAgICBpZiAoaXNPdXRwdXQpIHsNCiAgICAgICAgLy8gU3RhcnRpbmcgZnJvbSBvdXRwdXQgcG9ydA0KICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tID0gew0KICAgICAgICAgICAgbm9kZUlkOiBub2RlSWQsDQogICAgICAgICAgICBwb3J0TmFtZTogcG9ydE5hbWUsDQogICAgICAgICAgICBpc091dHB1dDogdHJ1ZQ0KICAgICAgICB9Ow0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIFN0YXJ0aW5nIGZyb20gaW5wdXQgcG9ydCAtIGNoZWNrIGlmIHdlIGhhdmUgYSBwZW5kaW5nIGNvbm5lY3Rpb24NCiAgICAgICAgaWYgKGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20gJiYgZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbS5pc091dHB1dCkgew0KICAgICAgICAgICAgLy8gQ29tcGxldGUgdGhlIGNvbm5lY3Rpb24NCiAgICAgICAgICAgIGNvbnN0IGZyb21Ob2RlSWQgPSBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tLm5vZGVJZDsNCiAgICAgICAgICAgIGNvbnN0IGZyb21Qb3J0ID0gZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbS5wb3J0TmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY3JlYXRlQ29ubmVjdGlvbihmcm9tTm9kZUlkLCBmcm9tUG9ydCwgbm9kZUlkLCBwb3J0TmFtZSk7DQogICAgICAgICAgICBmbG93RWRpdG9yLmNvbm5lY3RpbmdGcm9tID0gbnVsbDsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gVXBkYXRlIGNvbm5lY3Rpb25zIGZvciBhIHNwZWNpZmljIG5vZGUNCmZ1bmN0aW9uIHVwZGF0ZUNvbm5lY3Rpb25zRm9yTm9kZShub2RlSWQpIHsNCiAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkIHx8IGNvbm5lY3Rpb24udG8ubm9kZUlkID09PSBub2RlSWQpIHsNCiAgICAgICAgICAgIHVwZGF0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbik7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIFVwZGF0ZSBhIHNpbmdsZSBjb25uZWN0aW9uDQpmdW5jdGlvbiB1cGRhdGVDb25uZWN0aW9uKGNvbm5lY3Rpb24pIHsNCiAgICBjb25zdCBmcm9tTm9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQpOw0KICAgIGNvbnN0IHRvTm9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICANCiAgICBpZiAoIWZyb21Ob2RlIHx8ICF0b05vZGUgfHwgIWNvbm5lY3Rpb24uc3ZnKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gR2V0IG5vZGUgZGF0YSBwb3NpdGlvbnMNCiAgICBjb25zdCBmcm9tTm9kZURhdGEgPSBmbG93RWRpdG9yLm5vZGVzLmdldChjb25uZWN0aW9uLmZyb20ubm9kZUlkKTsNCiAgICBjb25zdCB0b05vZGVEYXRhID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubmVjdGlvbi50by5ub2RlSWQpOw0KICAgIA0KICAgIGlmICghZnJvbU5vZGVEYXRhIHx8ICF0b05vZGVEYXRhKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gR2V0IGFjdHVhbCBub2RlIGRpbWVuc2lvbnMgZnJvbSBjb21wdXRlZCBzdHlsZXMNCiAgICBjb25zdCBmcm9tU3R5bGVzID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZnJvbU5vZGUpOw0KICAgIGNvbnN0IHRvU3R5bGVzID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodG9Ob2RlKTsNCiAgICANCiAgICBjb25zdCBmcm9tV2lkdGggPSBwYXJzZUZsb2F0KGZyb21TdHlsZXMud2lkdGgpIHx8IDIwMDsNCiAgICBjb25zdCBmcm9tSGVpZ2h0ID0gcGFyc2VGbG9hdChmcm9tU3R5bGVzLmhlaWdodCkgfHwgODA7DQogICAgY29uc3QgdG9XaWR0aCA9IHBhcnNlRmxvYXQodG9TdHlsZXMud2lkdGgpIHx8IDIwMDsNCiAgICBjb25zdCB0b0hlaWdodCA9IHBhcnNlRmxvYXQodG9TdHlsZXMuaGVpZ2h0KSB8fCA4MDsNCiAgICANCiAgICAvLyBDYWxjdWxhdGUgY29ubmVjdGlvbiBwb3NpdGlvbnMgZGlyZWN0bHkgZnJvbSBub2RlIGRhdGEgKG5vIGV4dHJhIHRyYW5zZm9ybXMpDQogICAgLy8gRnJvbSBvdXRwdXQgcG9ydCAocmlnaHQgc2lkZSBvZiBmcm9tIG5vZGUsIG1pZGRsZSB2ZXJ0aWNhbGx5KQ0KICAgIGNvbnN0IGZyb21YID0gZnJvbU5vZGVEYXRhLnggKyBmcm9tV2lkdGg7DQogICAgY29uc3QgZnJvbVkgPSBmcm9tTm9kZURhdGEueSArIGZyb21IZWlnaHQgLyAyOw0KICAgIA0KICAgIC8vIFRvIGlucHV0IHBvcnQgKGxlZnQgc2lkZSBvZiB0byBub2RlLCBtaWRkbGUgdmVydGljYWxseSkgIA0KICAgIGNvbnN0IHRvWCA9IHRvTm9kZURhdGEueDsNCiAgICBjb25zdCB0b1kgPSB0b05vZGVEYXRhLnkgKyB0b0hlaWdodCAvIDI7DQogICAgDQogICAgDQogICAgLy8gVXBkYXRlIHRoZSBwYXRoDQogICAgY29uc3QgcGF0aCA9IGNvbm5lY3Rpb24uc3ZnLnF1ZXJ5U2VsZWN0b3IoJ3BhdGgnKTsNCiAgICBpZiAocGF0aCkgew0KICAgICAgICBjb25zdCBjb250cm9sUG9pbnQxWCA9IGZyb21YICsgKHRvWCAtIGZyb21YKSAqIDAuNTsNCiAgICAgICAgY29uc3QgY29udHJvbFBvaW50MlggPSBmcm9tWCArICh0b1ggLSBmcm9tWCkgKiAwLjU7DQogICAgICAgIGNvbnN0IHBhdGhEID0gYE0gJHtmcm9tWH0gJHtmcm9tWX0gQyAke2NvbnRyb2xQb2ludDFYfSAke2Zyb21ZfSAke2NvbnRyb2xQb2ludDJYfSAke3RvWX0gJHt0b1h9ICR7dG9ZfWA7DQogICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCdkJywgcGF0aEQpOw0KICAgIH0gZWxzZSB7DQogICAgfQ0KfQ0KDQovLyBSZWRyYXcgYWxsIGNvbm5lY3Rpb25zIChmb3Igd2luZG93IHJlc2l6ZSwgZXRjLikNCmZ1bmN0aW9uIHJlZHJhd0FsbENvbm5lY3Rpb25zKCkgew0KICAgIGZvciAoY29uc3QgY29ubmVjdGlvbiBvZiBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKSB7DQogICAgICAgIHVwZGF0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbik7DQogICAgfQ0KfQ0KDQovLyBEZWxldGUgYSBub2RlIGFuZCBhbGwgaXRzIGNvbm5lY3Rpb25zDQphc3luYyBmdW5jdGlvbiBkZWxldGVOb2RlKG5vZGVJZCkgew0KICAgIGNvbnN0IGNvbmZpcm1lZCA9IGF3YWl0IHN5cG5leEFQSS5zaG93Q29uZmlybWF0aW9uKA0KICAgICAgICAnRGVsZXRlIE5vZGUnLA0KICAgICAgICAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIG5vZGU/JywNCiAgICAgICAgew0KICAgICAgICAgICAgdHlwZTogJ2RhbmdlcicsDQogICAgICAgICAgICBjb25maXJtVGV4dDogJ0RlbGV0ZScsDQogICAgICAgICAgICBjYW5jZWxUZXh0OiAnQ2FuY2VsJywNCiAgICAgICAgICAgIGljb246ICdmYXMgZmEtY3ViZScNCiAgICAgICAgfQ0KICAgICk7DQogICAgDQogICAgaWYgKGNvbmZpcm1lZCkgew0KICAgICAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICAgICAgDQogICAgICAgIC8vIENsZWFuIHVwIGF1ZGlvIGVsZW1lbnRzIGlmIHRoaXMgaXMgYW4gYXVkaW8gbm9kZQ0KICAgICAgICBpZiAobm9kZSAmJiBub2RlLnR5cGUgPT09ICdhdWRpbycgJiYgbm9kZS5hdWRpb0VsZW1lbnQpIHsNCiAgICAgICAgICAgIC8vIFBhdXNlIGFuZCBzdG9wIHRoZSBhdWRpbw0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQucGF1c2UoKTsNCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LmN1cnJlbnRUaW1lID0gMDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUmVtb3ZlIGV2ZW50IGxpc3RlbmVycyBwcm9wZXJseQ0KICAgICAgICAgICAgaWYgKG5vZGUuYXVkaW9FdmVudExpc3RlbmVycykgew0KICAgICAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2VuZGVkJywgbm9kZS5hdWRpb0V2ZW50TGlzdGVuZXJzLmVuZGVkKTsNCiAgICAgICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIG5vZGUuYXVkaW9FdmVudExpc3RlbmVycy5lcnJvcik7DQogICAgICAgICAgICAgICAgbm9kZS5hdWRpb0V2ZW50TGlzdGVuZXJzID0gbnVsbDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gU3RvcmUgdGhlIHNyYyBiZWZvcmUgY2xlYXJpbmcgaXQgZm9yIGNsZWFudXANCiAgICAgICAgICAgIGNvbnN0IGF1ZGlvU3JjID0gbm9kZS5hdWRpb0VsZW1lbnQuc3JjOw0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gJyc7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFJldm9rZSBibG9iIFVSTCBpZiBpdCBleGlzdHMNCiAgICAgICAgICAgIGlmIChhdWRpb1NyYyAmJiBhdWRpb1NyYy5zdGFydHNXaXRoKCdibG9iOicpKSB7DQogICAgICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChhdWRpb1NyYyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENsZWFyIHRoZSBhdWRpbyBlbGVtZW50IHJlZmVyZW5jZQ0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQgPSBudWxsOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBSZW1vdmUgYWxsIGNvbm5lY3Rpb25zIGludm9sdmluZyB0aGlzIG5vZGUNCiAgICAgICAgY29uc3QgY29ubmVjdGlvbnNUb0RlbGV0ZSA9IFtdOw0KICAgICAgICBmb3IgKGNvbnN0IFtjb25uZWN0aW9uSWQsIGNvbm5lY3Rpb25dIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuZW50cmllcygpKSB7DQogICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5mcm9tLm5vZGVJZCA9PT0gbm9kZUlkIHx8IGNvbm5lY3Rpb24udG8ubm9kZUlkID09PSBub2RlSWQpIHsNCiAgICAgICAgICAgICAgICBjb25uZWN0aW9uc1RvRGVsZXRlLnB1c2goY29ubmVjdGlvbklkKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gRGVsZXRlIGNvbm5lY3Rpb25zDQogICAgICAgIGZvciAoY29uc3QgY29ubmVjdGlvbklkIG9mIGNvbm5lY3Rpb25zVG9EZWxldGUpIHsNCiAgICAgICAgICAgIGRlbGV0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbklkKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gUmVtb3ZlIG5vZGUgZnJvbSBkYXRhIHN0cnVjdHVyZQ0KICAgICAgICBmbG93RWRpdG9yLm5vZGVzLmRlbGV0ZShub2RlSWQpOw0KICAgICAgICANCiAgICAgICAgLy8gUmVtb3ZlIG5vZGUgZWxlbWVudCBmcm9tIERPTQ0KICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgbm9kZUVsZW1lbnQucmVtb3ZlKCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIERlc2VsZWN0IGlmIHRoaXMgd2FzIHRoZSBzZWxlY3RlZCBub2RlDQogICAgICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9PT0gbm9kZUlkKSB7DQogICAgICAgICAgICBmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9IG51bGw7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZS1jb25maWcnKS5pbm5lckhUTUwgPSAnPHAgY2xhc3M9InRleHQtbXV0ZWQiPlNlbGVjdCBhIG5vZGUgdG8gY29uZmlndXJlIGl0PC9wPic7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgfQ0KfQ0KDQovLyBEZWxldGUgYSBjb25uZWN0aW9uDQpmdW5jdGlvbiBkZWxldGVDb25uZWN0aW9uKGNvbm5lY3Rpb25JZCkgew0KICAgIGNvbnN0IGNvbm5lY3Rpb24gPSBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmdldChjb25uZWN0aW9uSWQpOw0KICAgIGlmIChjb25uZWN0aW9uICYmIGNvbm5lY3Rpb24uc3ZnKSB7DQogICAgICAgIGNvbm5lY3Rpb24uc3ZnLnJlbW92ZSgpOw0KICAgIH0NCiAgICBmbG93RWRpdG9yLmNvbm5lY3Rpb25zLmRlbGV0ZShjb25uZWN0aW9uSWQpOw0KfQ0KDQovLyBEZWxldGUgc2VsZWN0ZWQgbm9kZQ0KYXN5bmMgZnVuY3Rpb24gZGVsZXRlU2VsZWN0ZWROb2RlKCkgew0KICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSkgew0KICAgICAgICBhd2FpdCBkZWxldGVOb2RlKGZsb3dFZGl0b3Iuc2VsZWN0ZWROb2RlKTsNCiAgICB9DQp9DQoNCi8vIEhhbmRsZSBrZXlib2FyZCBzaG9ydGN1dHMNCmZ1bmN0aW9uIGhhbmRsZUtleURvd24oZSkgew0KICAgIGlmIChlLmtleSA9PT0gJ0RlbGV0ZScgfHwgKGUua2V5ID09PSAnQmFja3NwYWNlJyAmJiBlLmN0cmxLZXkpKSB7DQogICAgICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSkgew0KICAgICAgICAgICAgZGVsZXRlU2VsZWN0ZWROb2RlKCk7DQogICAgICAgIH0NCiAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnRXNjYXBlJykgew0KICAgICAgICAvLyBEZXNlbGVjdCBub2RlDQogICAgICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSkgew0KICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSk7DQogICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7DQogICAgICAgICAgICBmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9IG51bGw7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZS1jb25maWcnKS5pbm5lckhUTUwgPSAnPHAgY2xhc3M9InRleHQtbXV0ZWQiPlNlbGVjdCBhIG5vZGUgdG8gY29uZmlndXJlIGl0PC9wPic7DQogICAgICAgIH0NCiAgICB9IGVsc2UgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJ3MnICYmICFlLnNoaWZ0S2V5KSB7DQogICAgICAgIC8vIEN0cmwvQ21kICsgUzogU2F2ZQ0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvdygpOw0KICAgIH0gZWxzZSBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS5rZXkgPT09ICdTJykgew0KICAgICAgICAvLyBDdHJsL0NtZCArIFNoaWZ0ICsgUzogU2F2ZSBBcw0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvd0FzKCk7DQogICAgfSBlbHNlIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkgPT09ICdvJykgew0KICAgICAgICAvLyBDdHJsL0NtZCArIE86IExvYWQNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICB3aW5kb3cuZmlsZU1hbmFnZXIubG9hZEZsb3coKTsNCiAgICB9IGVsc2UgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJz0nKSB7DQogICAgICAgIC8vIEN0cmwvQ21kICsgPTogWm9vbSBJbg0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnpvb21JbigpOw0KICAgIH0gZWxzZSBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5ID09PSAnLScpIHsNCiAgICAgICAgLy8gQ3RybC9DbWQgKyAtOiBab29tIE91dA0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnpvb21PdXQoKTsNCiAgICB9IGVsc2UgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJzAnKSB7DQogICAgICAgIC8vIEN0cmwvQ21kICsgMDogUmVzZXQgem9vbSBhbmQgcGFuDQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgd2luZG93LmNhbnZhc01hbmFnZXIucmVzZXRDYW52YXNQYW4oKTsNCiAgICB9IGVsc2UgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiAoZS5zaGlmdEtleSkgJiYgZS5rZXkgPT09ICdGJykgew0KICAgICAgICAvLyBDdHJsL0NtZCArIFNoaWZ0ICsgRjogWm9vbSB0byBmaXQNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICB3aW5kb3cuY2FudmFzTWFuYWdlci56b29tVG9GaXQoKTsNCiAgICB9DQp9DQoNCi8vIEhhbmRsZSBwb3J0IG1vdXNlIGV2ZW50cyBmb3IgY29ubmVjdGlvbnMNCmZ1bmN0aW9uIGhhbmRsZVBvcnRNb3VzZURvd24oZSwgbm9kZUlkLCBwb3J0TmFtZSwgaXNPdXRwdXQpIHsNCiAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICANCiAgICBpZiAoaXNPdXRwdXQpIHsNCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbSA9IHsgbm9kZUlkLCBwb3J0TmFtZSB9Ow0KICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuYWRkKCdjb25uZWN0aW5nJyk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgaWYgKGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20pIHsNCiAgICAgICAgICAgIGNyZWF0ZUNvbm5lY3Rpb24oZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbS5ub2RlSWQsIGZsb3dFZGl0b3IuY29ubmVjdGluZ0Zyb20ucG9ydE5hbWUsIG5vZGVJZCwgcG9ydE5hbWUpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW5nRnJvbSA9IG51bGw7DQogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmxvdy1ub2RlLXBvcnQnKS5mb3JFYWNoKHBvcnQgPT4gcG9ydC5jbGFzc0xpc3QucmVtb3ZlKCdjb25uZWN0aW5nJykpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBDcmVhdGUgYSBjb25uZWN0aW9uIGJldHdlZW4gbm9kZXMNCmZ1bmN0aW9uIGNyZWF0ZUNvbm5lY3Rpb24oZnJvbU5vZGVJZCwgZnJvbVBvcnQsIHRvTm9kZUlkLCB0b1BvcnQpIHsNCiAgICAvLyBDaGVjayBpZiBjb25uZWN0aW9uIGFscmVhZHkgZXhpc3RzDQogICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IGZyb21Ob2RlSWQgJiYgDQogICAgICAgICAgICBjb25uZWN0aW9uLmZyb20ucG9ydE5hbWUgPT09IGZyb21Qb3J0ICYmDQogICAgICAgICAgICBjb25uZWN0aW9uLnRvLm5vZGVJZCA9PT0gdG9Ob2RlSWQgJiYgDQogICAgICAgICAgICBjb25uZWN0aW9uLnRvLnBvcnROYW1lID09PSB0b1BvcnQpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICBjb25zdCBjb25uZWN0aW9uSWQgPSBgY29ubl8ke2Zyb21Ob2RlSWR9XyR7ZnJvbVBvcnR9XyR7dG9Ob2RlSWR9XyR7dG9Qb3J0fWA7DQogICAgY29uc3QgY29ubmVjdGlvbiA9IHsNCiAgICAgICAgaWQ6IGNvbm5lY3Rpb25JZCwNCiAgICAgICAgZnJvbTogeyBub2RlSWQ6IGZyb21Ob2RlSWQsIHBvcnROYW1lOiBmcm9tUG9ydCB9LA0KICAgICAgICB0bzogeyBub2RlSWQ6IHRvTm9kZUlkLCBwb3J0TmFtZTogdG9Qb3J0IH0NCiAgICB9Ow0KICAgIA0KICAgIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuc2V0KGNvbm5lY3Rpb25JZCwgY29ubmVjdGlvbik7DQogICAgZHJhd0Nvbm5lY3Rpb24oY29ubmVjdGlvbik7DQogICAgDQp9DQoNCi8vIERyYXcgYSBjb25uZWN0aW9uIG9uIHRoZSBjYW52YXMNCmZ1bmN0aW9uIGRyYXdDb25uZWN0aW9uKGNvbm5lY3Rpb24pIHsNCiAgICBjb25zdCBmcm9tTm9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQpOw0KICAgIGNvbnN0IHRvTm9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICANCiAgICBpZiAoIWZyb21Ob2RlIHx8ICF0b05vZGUpIHJldHVybjsNCiAgICANCiAgICAvLyBDcmVhdGUgU1ZHIGVsZW1lbnQgZm9yIHRoZSBjb25uZWN0aW9uDQogICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTsNCiAgICBzdmcuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOw0KICAgIHN2Zy5zdHlsZS50b3AgPSAnMCc7DQogICAgc3ZnLnN0eWxlLmxlZnQgPSAnMCc7DQogICAgc3ZnLnN0eWxlLndpZHRoID0gJzEwMCUnOw0KICAgIHN2Zy5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7DQogICAgc3ZnLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSc7IC8vIERvbid0IGNhcHR1cmUgZXZlbnRzIGJ5IGRlZmF1bHQNCiAgICBzdmcuc3R5bGUuekluZGV4ID0gJzEnOw0KICAgIHN2Zy5kYXRhc2V0LmNvbm5lY3Rpb25JZCA9IGNvbm5lY3Rpb24uaWQ7DQogICAgDQogICAgY29uc3QgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncGF0aCcpOw0KICAgIHBhdGguc2V0QXR0cmlidXRlKCdzdHJva2UnLCAnIzRDQUY1MCcpOw0KICAgIHBhdGguc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMicpOw0KICAgIHBhdGguc2V0QXR0cmlidXRlKCdmaWxsJywgJ25vbmUnKTsNCiAgICBwYXRoLnNldEF0dHJpYnV0ZSgnbWFya2VyLWVuZCcsICd1cmwoI2Fycm93aGVhZCknKTsNCiAgICBwYXRoLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJzsNCiAgICBwYXRoLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnYXV0byc7IC8vIE9ubHkgdGhlIHBhdGggY2FwdHVyZXMgZXZlbnRzDQogICAgDQogICAgLy8gQWRkIGhvdmVyIGVmZmVjdHMNCiAgICBwYXRoLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7DQogICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnNCcpOw0KICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJyNmZjZiNmInKTsNCiAgICAgICAgLy8gU2hvdyBkZWxldGUgdG9vbHRpcA0KICAgICAgICBzaG93Q29ubmVjdGlvblRvb2x0aXAoY29ubmVjdGlvbi5pZCwgJ0NsaWNrIHRvIGRlbGV0ZSBjb25uZWN0aW9uJyk7DQogICAgfSk7DQogICAgDQogICAgcGF0aC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4gew0KICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzInKTsNCiAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICcjNENBRjUwJyk7DQogICAgICAgIGhpZGVDb25uZWN0aW9uVG9vbHRpcCgpOw0KICAgIH0pOw0KICAgIA0KICAgIC8vIEFkZCBjbGljayB0byBkZWxldGUNCiAgICBwYXRoLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHsNCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgY29uc3QgY29uZmlybWVkID0gYXdhaXQgc3lwbmV4QVBJLnNob3dDb25maXJtYXRpb24oDQogICAgICAgICAgICAnRGVsZXRlIENvbm5lY3Rpb24nLA0KICAgICAgICAgICAgJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyBjb25uZWN0aW9uPycsDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdHlwZTogJ2RhbmdlcicsDQogICAgICAgICAgICAgICAgY29uZmlybVRleHQ6ICdEZWxldGUnLA0KICAgICAgICAgICAgICAgIGNhbmNlbFRleHQ6ICdDYW5jZWwnLA0KICAgICAgICAgICAgICAgIGljb246ICdmYXMgZmEtbGluaycNCiAgICAgICAgICAgIH0NCiAgICAgICAgKTsNCiAgICAgICAgDQogICAgICAgIGlmIChjb25maXJtZWQpIHsNCiAgICAgICAgICAgIGRlbGV0ZUNvbm5lY3Rpb24oY29ubmVjdGlvbi5pZCk7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICBzdmcuYXBwZW5kQ2hpbGQocGF0aCk7DQogICAgZmxvd0VkaXRvci5jYW52YXMuYXBwZW5kQ2hpbGQoc3ZnKTsNCiAgICANCiAgICAvLyBTdG9yZSBTVkcgcmVmZXJlbmNlDQogICAgY29ubmVjdGlvbi5zdmcgPSBzdmc7DQogICAgDQogICAgLy8gVXBkYXRlIGNvbm5lY3Rpb24gcG9zaXRpb24NCiAgICB1cGRhdGVDb25uZWN0aW9uKGNvbm5lY3Rpb24pOw0KfQ0KDQovLyBTaG93IGNvbm5lY3Rpb24gdG9vbHRpcA0KZnVuY3Rpb24gc2hvd0Nvbm5lY3Rpb25Ub29sdGlwKGNvbm5lY3Rpb25JZCwgbWVzc2FnZSkgew0KICAgIC8vIENoZWNrIGlmIGFwcCBpcyBzdGlsbCBhY3RpdmUNCiAgICBpZiAoIWZsb3dFZGl0b3IuaXNBY3RpdmUpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBSZW1vdmUgZXhpc3RpbmcgdG9vbHRpcA0KICAgIGhpZGVDb25uZWN0aW9uVG9vbHRpcCgpOw0KICAgIA0KICAgIGNvbnN0IHRvb2x0aXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICB0b29sdGlwLmNsYXNzTmFtZSA9ICdjb25uZWN0aW9uLXRvb2x0aXAnOw0KICAgIHRvb2x0aXAudGV4dENvbnRlbnQgPSBtZXNzYWdlOw0KICAgIHRvb2x0aXAuc3R5bGUuY3NzVGV4dCA9IGANCiAgICAgICAgcG9zaXRpb246IGZpeGVkOw0KICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuOCk7DQogICAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgICAgcGFkZGluZzogNHB4IDhweDsNCiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgICAgICBmb250LXNpemU6IDEycHg7DQogICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lOw0KICAgICAgICB6LWluZGV4OiAxMDAwMDsNCiAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsNCiAgICAgICAgZGlzcGxheTogbm9uZTsNCiAgICBgOw0KICAgIA0KICAgIHRvb2x0aXAuaWQgPSAnY29ubmVjdGlvbi10b29sdGlwJzsNCiAgICANCiAgICAvLyBUcnkgdG8gYXBwZW5kIHRvIGFwcCBjb250YWluZXIgZmlyc3QsIGZhbGxiYWNrIHRvIGJvZHkNCiAgICBjb25zdCBhcHBDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXBwLWNvbnRhaW5lcicpOw0KICAgIGNvbnN0IGNvbnRhaW5lciA9IGFwcENvbnRhaW5lciB8fCBkb2N1bWVudC5ib2R5Ow0KICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0b29sdGlwKTsNCiAgICANCiAgICAvLyBQb3NpdGlvbiB0b29sdGlwIG5lYXIgbW91c2UgKHdpbGwgYmUgdXBkYXRlZCBvbiBtb3VzZW1vdmUpDQogICAgY29uc3QgdG9vbHRpcE1vdXNlTW92ZUhhbmRsZXIgPSAoZSkgPT4gdXBkYXRlVG9vbHRpcFBvc2l0aW9uKGUpOw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRvb2x0aXBNb3VzZU1vdmVIYW5kbGVyKTsNCiAgICANCiAgICAvLyBTdG9yZSB0aGUgaGFuZGxlciByZWZlcmVuY2UgZm9yIGNsZWFudXANCiAgICB3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyID0gdG9vbHRpcE1vdXNlTW92ZUhhbmRsZXI7DQogICAgDQogICAgLy8gU2hvdyB0aGUgdG9vbHRpcCBhZnRlciBhIHNtYWxsIGRlbGF5IHRvIHByZXZlbnQgZmxpY2tlcmluZw0KICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICBpZiAodG9vbHRpcC5wYXJlbnROb2RlICYmIGZsb3dFZGl0b3IuaXNBY3RpdmUpIHsNCiAgICAgICAgICAgIHRvb2x0aXAuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIH0NCiAgICB9LCAxMCk7DQp9DQoNCi8vIFVwZGF0ZSB0b29sdGlwIHBvc2l0aW9uDQpmdW5jdGlvbiB1cGRhdGVUb29sdGlwUG9zaXRpb24oZSkgew0KICAgIGNvbnN0IHRvb2x0aXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29ubmVjdGlvbi10b29sdGlwJyk7DQogICAgaWYgKHRvb2x0aXApIHsNCiAgICAgICAgLy8gVXNlIHNjYWxlZCBjb29yZGluYXRlcyBmb3IgdG9vbHRpcCBwb3NpdGlvbmluZw0KICAgICAgICBjb25zdCBtb3VzZUNvb3JkcyA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMgPyANCiAgICAgICAgICAgIHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOiANCiAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgdG9vbHRpcC5zdHlsZS5sZWZ0ID0gKG1vdXNlQ29vcmRzLnggKyAxMCkgKyAncHgnOw0KICAgICAgICB0b29sdGlwLnN0eWxlLnRvcCA9IChtb3VzZUNvb3Jkcy55IC0gMTApICsgJ3B4JzsNCiAgICB9DQp9DQoNCi8vIEhpZGUgY29ubmVjdGlvbiB0b29sdGlwDQpmdW5jdGlvbiBoaWRlQ29ubmVjdGlvblRvb2x0aXAoKSB7DQogICAgY29uc3QgdG9vbHRpcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25uZWN0aW9uLXRvb2x0aXAnKTsNCiAgICBpZiAodG9vbHRpcCkgew0KICAgICAgICAvLyBSZW1vdmUgdGhlIHNwZWNpZmljIGV2ZW50IGxpc3RlbmVyIHdlIGFkZGVkDQogICAgICAgIGlmICh3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyKSB7DQogICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyKTsNCiAgICAgICAgICAgIHdpbmRvdy5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIgPSBudWxsOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBIaWRlIGFuZCByZW1vdmUgdGhlIHRvb2x0aXANCiAgICAgICAgdG9vbHRpcC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICBpZiAodG9vbHRpcC5wYXJlbnROb2RlKSB7DQogICAgICAgICAgICB0b29sdGlwLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodG9vbHRpcCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIENsZWFyIHRoZSBjYW52YXMNCmFzeW5jIGZ1bmN0aW9uIGNsZWFyQ2FudmFzKCkgew0KICAgIGNvbnN0IGNvbmZpcm1lZCA9IGF3YWl0IHN5cG5leEFQSS5zaG93Q29uZmlybWF0aW9uKA0KICAgICAgICAnQ2xlYXIgQ2FudmFzJywNCiAgICAgICAgJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBjbGVhciB0aGUgY2FudmFzPyBUaGlzIHdpbGwgZGVsZXRlIGFsbCBub2RlcyBhbmQgY29ubmVjdGlvbnMuJywNCiAgICAgICAgew0KICAgICAgICAgICAgdHlwZTogJ2RhbmdlcicsDQogICAgICAgICAgICBjb25maXJtVGV4dDogJ0NsZWFyIEFsbCcsDQogICAgICAgICAgICBjYW5jZWxUZXh0OiAnQ2FuY2VsJywNCiAgICAgICAgICAgIGljb246ICdmYXMgZmEtdHJhc2gtYWx0Jw0KICAgICAgICB9DQogICAgKTsNCiAgICANCiAgICBpZiAoY29uZmlybWVkKSB7DQogICAgICAgIGNsZWFyQ2FudmFzU2lsZW50KCk7DQogICAgfQ0KfQ0KDQovLyBDbGVhciB0aGUgY2FudmFzIHdpdGhvdXQgY29uZmlybWF0aW9uICh1c2VkIGludGVybmFsbHkpDQpmdW5jdGlvbiBjbGVhckNhbnZhc1NpbGVudCgpIHsNCiAgICAvLyBIaWRlIGFueSBhY3RpdmUgdG9vbHRpcHMNCiAgICBoaWRlQ29ubmVjdGlvblRvb2x0aXAoKTsNCiAgICAgICAgDQogICAgICAgIC8vIENsZWFyIGFsbCBjb25uZWN0aW9ucw0KICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3Rpb24gb2YgZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkgew0KICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24uc3ZnKSB7DQogICAgICAgICAgICAgICAgY29ubmVjdGlvbi5zdmcucmVtb3ZlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5jbGVhcigpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgYWxsIG5vZGVzDQogICAgICAgIGZvciAoY29uc3Qgbm9kZUlkIG9mIGZsb3dFZGl0b3Iubm9kZXMua2V5cygpKSB7DQogICAgICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGVJZCk7DQogICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5yZW1vdmUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBmbG93RWRpdG9yLm5vZGVzLmNsZWFyKCk7DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciBhbGwgdGFncw0KICAgICAgICBmb3IgKGNvbnN0IHRhZ0lkIG9mIGZsb3dFZGl0b3IudGFncy5rZXlzKCkpIHsNCiAgICAgICAgICAgIGNvbnN0IHRhZ0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWdJZCk7DQogICAgICAgICAgICBpZiAodGFnRWxlbWVudCkgew0KICAgICAgICAgICAgICAgIHRhZ0VsZW1lbnQucmVtb3ZlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZmxvd0VkaXRvci50YWdzLmNsZWFyKCk7DQogICAgICAgIA0KICAgICAgICAvLyBVcGRhdGUgdGFnIHBhbmVsIHRvIHJlZmxlY3QgY2xlYXJlZCB0YWdzDQogICAgICAgIGlmICh0eXBlb2Ygd2luZG93LnRhZ01hbmFnZXIudXBkYXRlVGFnUGFuZWwgPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgIHdpbmRvdy50YWdNYW5hZ2VyLnVwZGF0ZVRhZ1BhbmVsKCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFJlc2V0IGNvdW50ZXJzDQogICAgICAgIGZsb3dFZGl0b3Iubm9kZUNvdW50ZXIgPSAwOw0KICAgICAgICBmbG93RWRpdG9yLnRhZ0NvdW50ZXIgPSAwOw0KICAgICAgICBmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9IG51bGw7DQogICAgICAgIA0KICAgICAgICAvLyBDbGVhciBjdXJyZW50IGZpbGUgcGF0aA0KICAgICAgICBmbG93RWRpdG9yLmN1cnJlbnRGaWxlUGF0aCA9IG51bGw7DQogICAgICAgIA0KICAgICAgICAvLyBSZXNldCBwYW4gb2Zmc2V0IHRvIGNlbnRlciBvZiBsYXJnZSBjYW52YXMNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQgPSB7IHg6IC01MDAwLCB5OiAtNTAwMCB9Ow0KICAgICAgICANCiAgICAgICAgLy8gUmVzZXQgem9vbSBsZXZlbA0KICAgICAgICBmbG93RWRpdG9yLnpvb21MZXZlbCA9IDEuMDsNCiAgICAgICAgDQogICAgICAgIGlmICh0eXBlb2Ygd2luZG93LmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtID09PSAnZnVuY3Rpb24nKSB7DQogICAgICAgICAgICB3aW5kb3cuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gVXBkYXRlIGZpbGVuYW1lIGRpc3BsYXkNCiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuZmlsZU1hbmFnZXIudXBkYXRlRmlsZW5hbWVEaXNwbGF5ID09PSAnZnVuY3Rpb24nKSB7DQogICAgICAgICAgICB3aW5kb3cuZmlsZU1hbmFnZXIudXBkYXRlRmlsZW5hbWVEaXNwbGF5KCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIENsZWFyIGNvbmZpZyBwYW5lbA0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZS1jb25maWcnKS5pbm5lckhUTUwgPSAnPHAgY2xhc3M9InRleHQtbXV0ZWQiPlNlbGVjdCBhIG5vZGUgdG8gY29uZmlndXJlIGl0PC9wPic7DQp9IA0KDQoNCi8vIFNob3cgbm9kZSBjb25maWd1cmF0aW9uDQpmdW5jdGlvbiBzaG93Tm9kZUNvbmZpZyhub2RlSWQpIHsNCiAgICBjb25zdCBub2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGUpIHJldHVybjsNCiAgICANCiAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgaWYgKCFub2RlRGVmKSByZXR1cm47DQogICAgDQogICAgLy8gU2hvdyBjb25maWcgcGFuZWwgd2l0aCBub2RlIGNvbmZpZ3VyYXRpb24NCiAgICBjb25zdCBjb25maWdQYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlLWNvbmZpZycpOw0KICAgIGlmIChjb25maWdQYW5lbCkgew0KICAgICAgICBsZXQgY29uZmlnSHRtbCA9IGA8aDQ+JHtub2RlRGVmLm5hbWV9IENvbmZpZ3VyYXRpb248L2g0PmA7DQogICAgICAgIA0KICAgICAgICAvLyBBZGQgc3BlY2lhbCBjb250ZW50IGRpc3BsYXkgZm9yIGRpZmZlcmVudCBub2RlIHR5cGVzDQogICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdkaXNwbGF5JyAmJiBub2RlLmxhc3RDb250ZW50KSB7DQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+TGFzdCBDb250ZW50PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udGVudC1kaXNwbGF5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxwcmUgY2xhc3M9ImNvbnRlbnQtdGV4dCI+JHtlc2NhcGVIdG1sKG5vZGUubGFzdENvbnRlbnQpfTwvcHJlPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udGVudC1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+Rm9ybWF0OiAke25vZGUubGFzdEZvcm1hdH0g4oCiIExlbmd0aDogJHtub2RlLmxhc3RDb250ZW50Lmxlbmd0aH0gY2hhcnM8L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09ICdpbWFnZScgJiYgbm9kZS5sYXN0SW1hZ2VEYXRhKSB7DQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+SW1hZ2UgUHJldmlldzwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImltYWdlLWRpc3BsYXkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9IiR7bm9kZS5sYXN0SW1hZ2VVcmx9IiBhbHQ9IkltYWdlIHByZXZpZXciIHN0eWxlPSJtYXgtd2lkdGg6IDIwMHB4OyBtYXgtaGVpZ2h0OiAxNTBweDsgYm9yZGVyOiAxcHggc29saWQgI2NjYzsgYm9yZGVyLXJhZGl1czogNHB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbWFnZS1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+U2l6ZTogJHtub2RlLmxhc3RJbWFnZUluZm8/LndpZHRoIHx8ICc/J314JHtub2RlLmxhc3RJbWFnZUluZm8/LmhlaWdodCB8fCAnPyd9IOKAoiBGb3JtYXQ6ICR7bm9kZS5sYXN0SW1hZ2VJbmZvPy5mb3JtYXQgfHwgJz8nfTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLXByaW1hcnkgbXQtMiB2aWV3LWZ1bGwtaW1hZ2UtYnRuIiBkYXRhLW5vZGUtaWQ9IiR7bm9kZUlkfSI+VmlldyBGdWxsIEltYWdlPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09ICdhdWRpbycgJiYgbm9kZS5sYXN0QXVkaW9EYXRhKSB7DQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+QXVkaW8gQ29udHJvbHM8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhdWRpby1kaXNwbGF5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImF1ZGlvLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5BdWRpbyBsb2FkZWQgc3VjY2Vzc2Z1bGx5PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYXVkaW8tY29udHJvbHMgbXQtMiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tc3VjY2VzcyBwbGF5LWF1ZGlvLWJ0biIgZGF0YS1ub2RlLWlkPSIke25vZGVJZH0iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXBsYXkiPjwvaT4gUGxheQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLWRhbmdlciBzdG9wLWF1ZGlvLWJ0biIgZGF0YS1ub2RlLWlkPSIke25vZGVJZH0iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXN0b3AiPjwvaT4gU3RvcA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09ICd2ZnNfbG9hZCcpIHsNCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5WRlMgTG9hZCBTdGF0dXM8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ2ZnMtbG9hZC1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5MYXN0IGxvYWRlZDogJHtub2RlLmxhc3RMb2FkZWRGaWxlIHx8ICdOb25lJ308L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIGA7DQogICAgICAgIH0gZWxzZSBpZiAobm9kZS50eXBlID09PSAnbGxtX2NoYXQnICYmIG5vZGUubGFzdFJlc3BvbnNlKSB7DQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+TGFzdCBSZXNwb25zZTwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQtZGlzcGxheSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8cHJlIGNsYXNzPSJjb250ZW50LXRleHQiPiR7ZXNjYXBlSHRtbChub2RlLmxhc3RSZXNwb25zZSl9PC9wcmU+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50LWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5Ub2tlbnM6ICR7bm9kZS5sYXN0VXNhZ2U/LnRvdGFsX3Rva2VucyB8fCAwfSDigKIgTW9kZWw6ICR7bm9kZS5sYXN0TW9kZWwgfHwgJ1Vua25vd24nfTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9IGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ3JlcGVhdGVyJykgew0KICAgICAgICAgICAgY29uc3QgaXNSdW5uaW5nID0gbm9kZS5yZXBlYXRlclN0YXRlICYmIG5vZGUucmVwZWF0ZXJTdGF0ZS5pc1J1bm5pbmc7DQogICAgICAgICAgICBjb25zdCBjb3VudCA9IG5vZGUucmVwZWF0ZXJTdGF0ZSA/IG5vZGUucmVwZWF0ZXJTdGF0ZS5jb3VudCA6IDA7DQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+UmVwZWF0ZXIgQ29udHJvbHM8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyZXBlYXRlci1kaXNwbGF5Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJlcGVhdGVyLWluZm8iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5TdGF0dXM6ICR7aXNSdW5uaW5nID8gJ1J1bm5pbmcnIDogJ1N0b3BwZWQnfSDigKIgQ291bnQ6ICR7Y291bnR9PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmVwZWF0ZXItY29udHJvbHMgbXQtMiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tc3VjY2VzcyBzdGFydC1yZXBlYXRlci1idG4iIGRhdGEtbm9kZS1pZD0iJHtub2RlSWR9IiAke2lzUnVubmluZyA/ICdkaXNhYmxlZCcgOiAnJ30+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtcGxheSI+PC9pPiBTdGFydA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLWRhbmdlciBzdG9wLXJlcGVhdGVyLWJ0biIgZGF0YS1ub2RlLWlkPSIke25vZGVJZH0iICR7IWlzUnVubmluZyA/ICdkaXNhYmxlZCcgOiAnJ30+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc3RvcCI+PC9pPiBTdG9wDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBTaG93IGlucHV0IG1hcHBpbmdzIGNvbmZpZ3VyYXRpb24gKHdoYXQgdGhpcyBub2RlIHJlY2VpdmVzIGZyb20gb3RoZXIgbm9kZXMpDQogICAgICAgIGNvbnN0IGlucHV0Q29ubmVjdGlvbnMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpDQogICAgICAgICAgICAuZmlsdGVyKGNvbm4gPT4gY29ubi50by5ub2RlSWQgPT09IG5vZGVJZCk7DQogICAgICAgIA0KICAgICAgICBpZiAoaW5wdXRDb25uZWN0aW9ucy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+UmVjZWl2aW5nIEZyb208L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnB1dC1tYXBwaW5ncy1jb25maWciPg0KICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZm9yIChjb25zdCBjb25uIG9mIGlucHV0Q29ubmVjdGlvbnMpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2VOb2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubi5mcm9tLm5vZGVJZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgc291cmNlTm9kZURlZiA9IG5vZGVSZWdpc3RyeS5nZXROb2RlVHlwZShzb3VyY2VOb2RlPy50eXBlIHx8ICd1bmtub3duJyk7DQogICAgICAgICAgICAgICAgY29uc3Qgc291cmNlTm9kZU5hbWUgPSBzb3VyY2VOb2RlRGVmPy5uYW1lIHx8IHNvdXJjZU5vZGU/LnR5cGUgfHwgJ3Vua25vd24nOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkT3V0cHV0ID0gc291cmNlTm9kZURlZj8ub3V0cHV0cz8uZmluZChvdXRwdXQgPT4gb3V0cHV0LmlkID09PSBjb25uLmZyb20ucG9ydE5hbWUpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dE5hbWUgPSBzZWxlY3RlZE91dHB1dCA/IHNlbGVjdGVkT3V0cHV0Lm5hbWUgOiBjb25uLmZyb20ucG9ydE5hbWU7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gU2ltcGxlOiBTaG93IHdoYXQgSSdtIHJlY2VpdmluZyBhbmQgbGV0IG1lIGNob29zZSBteSBpbnB1dCBwb3J0DQogICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImlucHV0LW1hcHBpbmctY29uZmlnIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbm5lY3Rpb24taGVhZGVyIj5Gcm9tICR7c291cmNlTm9kZU5hbWV9ICgke291dHB1dE5hbWV9KTwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29ubmVjdGlvbi1jb250cm9scyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udHJvbC1yb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+VG8gbXkgaW5wdXQ6PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0iaW5wdXRfdGFyZ2V0XyR7bm9kZUlkfXwke2Nvbm4udG8ucG9ydE5hbWV9IiBjbGFzcz0iaW5wdXQtdGFyZ2V0LXNlbGVjdCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPlNlbGVjdC4uLjwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtub2RlRGVmLmlucHV0cy5tYXAoaW5wdXQgPT4gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYDxvcHRpb24gdmFsdWU9IiR7aW5wdXQuaWR9IiAke2Nvbm4udG8ucG9ydE5hbWUgPT09IGlucHV0LmlkID8gJ3NlbGVjdGVkJyA6ICcnfT4ke2lucHV0Lm5hbWV9PC9vcHRpb24+YA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5qb2luKCcnKX0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgDQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gU2hvdyBvdXRwdXQgbWFwcGluZ3MgY29uZmlndXJhdGlvbiAod2hhdCBvdGhlciBub2RlcyByZWNlaXZlIGZyb20gdGhpcyBub2RlKQ0KICAgICAgICBjb25zdCBvdXRwdXRDb25uZWN0aW9ucyA9IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkNCiAgICAgICAgICAgIC5maWx0ZXIoY29ubiA9PiBjb25uLmZyb20ubm9kZUlkID09PSBub2RlSWQpOw0KICAgICAgICANCiAgICAgICAgaWYgKG91dHB1dENvbm5lY3Rpb25zLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYA0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmZpZy1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5TZW5kaW5nIFRvPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ib3V0cHV0LW1hcHBpbmdzLWNvbmZpZyI+DQogICAgICAgICAgICBgOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBmb3IgKGNvbnN0IGNvbm4gb2Ygb3V0cHV0Q29ubmVjdGlvbnMpIHsNCiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXROb2RlID0gZmxvd0VkaXRvci5ub2Rlcy5nZXQoY29ubi50by5ub2RlSWQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUodGFyZ2V0Tm9kZT8udHlwZSB8fCAndW5rbm93bicpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE5vZGVOYW1lID0gdGFyZ2V0Tm9kZURlZj8ubmFtZSB8fCB0YXJnZXROb2RlPy50eXBlIHx8ICd1bmtub3duJzsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBHZXQgYXZhaWxhYmxlIG91dHB1dHMgZnJvbSBUSElTIG5vZGUgKHNvdXJjZSBub2RlKQ0KICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZU5vZGVEZWYgPSBub2RlUmVnaXN0cnkuZ2V0Tm9kZVR5cGUobm9kZS50eXBlKTsNCiAgICAgICAgICAgICAgICBjb25zdCBhdmFpbGFibGVPdXRwdXRzID0gc291cmNlTm9kZURlZj8ub3V0cHV0cyB8fCBbXTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ib3V0cHV0LW1hcHBpbmctY29uZmlnIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbm5lY3Rpb24taGVhZGVyIj5UbyAke3RhcmdldE5vZGVOYW1lfTwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29ubmVjdGlvbi1jb250cm9scyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udHJvbC1yb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+U2VuZCBvdXRwdXQ6PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0ib3V0cHV0X21hcHBpbmdfJHtub2RlSWR9fCR7Y29ubi5mcm9tLnBvcnROYW1lfXwke2Nvbm4udG8ubm9kZUlkfSIgY2xhc3M9Im91dHB1dC1tYXBwaW5nLXNlbGVjdCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPlNlbGVjdC4uLjwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHthdmFpbGFibGVPdXRwdXRzLm1hcChvdXRwdXQgPT4gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYDxvcHRpb24gdmFsdWU9IiR7b3V0cHV0LmlkfSIgJHtjb25uLmZyb20ucG9ydE5hbWUgPT09IG91dHB1dC5pZCA/ICdzZWxlY3RlZCcgOiAnJ30+JHtvdXRwdXQubmFtZX08L29wdGlvbj5gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmpvaW4oJycpfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICBgOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICBgOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBHZW5lcmF0ZSBjb25maWd1cmF0aW9uIGZpZWxkcw0KICAgICAgICBmb3IgKGNvbnN0IFtrZXksIGNvbmZpZ10gb2YgT2JqZWN0LmVudHJpZXMobm9kZURlZi5jb25maWcpKSB7DQogICAgICAgICAgICBjb25maWdIdG1sICs9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25maWctZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJjb25maWdfJHtub2RlSWR9XyR7a2V5fSI+JHtjb25maWcubGFiZWx9PC9sYWJlbD4NCiAgICAgICAgICAgIGA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChjb25maWcudHlwZSA9PT0gJ3NlbGVjdCcpIHsNCiAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8c2VsZWN0IGlkPSJjb25maWdfJHtub2RlSWR9XyR7a2V5fSI+YDsNCiAgICAgICAgICAgICAgICBjb25maWcub3B0aW9ucy5mb3JFYWNoKG9wdGlvbiA9PiB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkID0gbm9kZS5jb25maWdba2V5XS52YWx1ZSA9PT0gb3B0aW9uID8gJ3NlbGVjdGVkJyA6ICcnOw0KICAgICAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8b3B0aW9uIHZhbHVlPSIke29wdGlvbn0iICR7c2VsZWN0ZWR9PiR7b3B0aW9ufTwvb3B0aW9uPmA7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPC9zZWxlY3Q+YDsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnR5cGUgPT09ICd0ZXh0YXJlYScpIHsNCiAgICAgICAgICAgICAgICBjb25maWdIdG1sICs9IGA8dGV4dGFyZWEgaWQ9ImNvbmZpZ18ke25vZGVJZH1fJHtrZXl9Ij4ke25vZGUuY29uZmlnW2tleV0udmFsdWV9PC90ZXh0YXJlYT5gOw0KICAgICAgICAgICAgfSBlbHNlIGlmIChjb25maWcudHlwZSA9PT0gJ251bWJlcicpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBtaW4gPSBjb25maWcubWluID8gYCBtaW49IiR7Y29uZmlnLm1pbn0iYCA6ICcnOw0KICAgICAgICAgICAgICAgIGNvbnN0IG1heCA9IGNvbmZpZy5tYXggPyBgIG1heD0iJHtjb25maWcubWF4fSJgIDogJyc7DQogICAgICAgICAgICAgICAgY29uc3Qgc3RlcCA9IGNvbmZpZy5zdGVwID8gYCBzdGVwPSIke2NvbmZpZy5zdGVwfSJgIDogJyc7DQogICAgICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPGlucHV0IHR5cGU9Im51bWJlciIgaWQ9ImNvbmZpZ18ke25vZGVJZH1fJHtrZXl9IiB2YWx1ZT0iJHtub2RlLmNvbmZpZ1trZXldLnZhbHVlfSIke21pbn0ke21heH0ke3N0ZXB9PmA7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGNvbmZpZ0h0bWwgKz0gYDxpbnB1dCB0eXBlPSIke2NvbmZpZy50eXBlfSIgaWQ9ImNvbmZpZ18ke25vZGVJZH1fJHtrZXl9IiB2YWx1ZT0iJHtub2RlLmNvbmZpZ1trZXldLnZhbHVlfSI+YDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uZmlnSHRtbCArPSBgPC9kaXY+YDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgY29uZmlnUGFuZWwuaW5uZXJIVE1MID0gY29uZmlnSHRtbDsNCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lcnMgZm9yIG1hcHBpbmcgc2VsZWN0cw0KICAgICAgICAvLyBObyBpbnB1dCBtYXBwaW5nIHNlbGVjdHMgYW55bW9yZSAtIG5vZGVzIGNhbid0IGNvbnRyb2wgd2hhdCB0aGV5IHJlY2VpdmUNCiAgICAgICAgDQogICAgICAgIGNvbnN0IGlucHV0VGFyZ2V0U2VsZWN0cyA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5pbnB1dC10YXJnZXQtc2VsZWN0Jyk7DQogICAgICAgIGlucHV0VGFyZ2V0U2VsZWN0cy5mb3JFYWNoKHNlbGVjdCA9PiB7DQogICAgICAgICAgICBzZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBbbm9kZUlkLCBjdXJyZW50SW5wdXRQb3J0XSA9IGUudGFyZ2V0LmlkLnJlcGxhY2UoJ2lucHV0X3RhcmdldF8nLCAnJykuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZElucHV0UG9ydCA9IGUudGFyZ2V0LnZhbHVlOw0KICAgICAgICAgICAgICAgIC8vIEZpbmQgdGhlIGNvbm5lY3Rpb24NCiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5maW5kKGNvbm4gPT4NCiAgICAgICAgICAgICAgICAgICAgY29ubi50by5ub2RlSWQgPT09IG5vZGVJZCAmJiBjb25uLnRvLnBvcnROYW1lID09PSBjdXJyZW50SW5wdXRQb3J0DQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbiAmJiBzZWxlY3RlZElucHV0UG9ydCkgew0KICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgYWxsIGNvbm5lY3Rpb25zIGZyb20gdGhlIHNhbWUgZnJvbU5vZGUgdG8gdGhpcyBub2RlIChyZWdhcmRsZXNzIG9mIHBvcnQpDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb25zVG9SZW1vdmUgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLmZpbHRlcihjb25uID0+DQogICAgICAgICAgICAgICAgICAgICAgICBjb25uLmZyb20ubm9kZUlkID09PSBjb25uZWN0aW9uLmZyb20ubm9kZUlkICYmIGNvbm4udG8ubm9kZUlkID09PSBub2RlSWQNCiAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgY29ubmVjdGlvbnNUb1JlbW92ZS5mb3JFYWNoKGNvbm4gPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5kZWxldGUoY29ubi5pZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29ubi5zdmcpIGNvbm4uc3ZnLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBuZXcgY29ubmVjdGlvbg0KICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDb25uZWN0aW9uSWQgPSBgY29ubl8ke2Nvbm5lY3Rpb24uZnJvbS5ub2RlSWR9XyR7Y29ubmVjdGlvbi5mcm9tLnBvcnROYW1lfV8ke25vZGVJZH1fJHtzZWxlY3RlZElucHV0UG9ydH1gOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDb25uZWN0aW9uID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IG5ld0Nvbm5lY3Rpb25JZCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IHsgbm9kZUlkOiBjb25uZWN0aW9uLmZyb20ubm9kZUlkLCBwb3J0TmFtZTogY29ubmVjdGlvbi5mcm9tLnBvcnROYW1lIH0sDQogICAgICAgICAgICAgICAgICAgICAgICB0bzogeyBub2RlSWQ6IG5vZGVJZCwgcG9ydE5hbWU6IHNlbGVjdGVkSW5wdXRQb3J0IH0NCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci5jb25uZWN0aW9ucy5zZXQobmV3Q29ubmVjdGlvbklkLCBuZXdDb25uZWN0aW9uKTsNCiAgICAgICAgICAgICAgICAgICAgZHJhd0Nvbm5lY3Rpb24obmV3Q29ubmVjdGlvbik7DQogICAgICAgICAgICAgICAgICAgIC8vIEF1dG8tc2F2ZQ0KICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LnNhdmVGbG93KSB3aW5kb3cuc2F2ZUZsb3coKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICBjb25zdCBvdXRwdXRNYXBwaW5nU2VsZWN0cyA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5vdXRwdXQtbWFwcGluZy1zZWxlY3QnKTsNCiAgICAgICAgb3V0cHV0TWFwcGluZ1NlbGVjdHMuZm9yRWFjaChzZWxlY3QgPT4gew0KICAgICAgICAgICAgc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3QgcGFydHMgPSBlLnRhcmdldC5pZC5yZXBsYWNlKCdvdXRwdXRfbWFwcGluZ18nLCAnJykuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWQgPSBwYXJ0c1swXTsNCiAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXRQb3J0ID0gcGFydHNbMV07DQogICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Tm9kZUlkID0gcGFydHNbMl07DQogICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRPdXRwdXRQb3J0ID0gZS50YXJnZXQudmFsdWU7DQogICAgICAgICAgICAgICAgdXBkYXRlT3V0cHV0TWFwcGluZyhub2RlSWQsIG91dHB1dFBvcnQsIHRhcmdldE5vZGVJZCwgc2VsZWN0ZWRPdXRwdXRQb3J0KTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lcnMgZm9yIHNwZWNpYWwgYnV0dG9ucw0KICAgICAgICBjb25zdCB2aWV3RnVsbEltYWdlQnRuID0gY29uZmlnUGFuZWwucXVlcnlTZWxlY3RvcignLnZpZXctZnVsbC1pbWFnZS1idG4nKTsNCiAgICAgICAgaWYgKHZpZXdGdWxsSW1hZ2VCdG4pIHsNCiAgICAgICAgICAgIHZpZXdGdWxsSW1hZ2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1ub2RlLWlkJyk7DQogICAgICAgICAgICAgICAgc2hvd0Z1bGxJbWFnZShub2RlSWQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHBsYXlBdWRpb0J0biA9IGNvbmZpZ1BhbmVsLnF1ZXJ5U2VsZWN0b3IoJy5wbGF5LWF1ZGlvLWJ0bicpOw0KICAgICAgICBpZiAocGxheUF1ZGlvQnRuKSB7DQogICAgICAgICAgICBwbGF5QXVkaW9CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1ub2RlLWlkJyk7DQogICAgICAgICAgICAgICAgcGxheUF1ZGlvKG5vZGVJZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgY29uc3Qgc3RvcEF1ZGlvQnRuID0gY29uZmlnUGFuZWwucXVlcnlTZWxlY3RvcignLnN0b3AtYXVkaW8tYnRuJyk7DQogICAgICAgIGlmIChzdG9wQXVkaW9CdG4pIHsNCiAgICAgICAgICAgIHN0b3BBdWRpb0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW5vZGUtaWQnKTsNCiAgICAgICAgICAgICAgICBzdG9wQXVkaW8obm9kZUlkKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25zdCBzdGFydFJlcGVhdGVyQnRuID0gY29uZmlnUGFuZWwucXVlcnlTZWxlY3RvcignLnN0YXJ0LXJlcGVhdGVyLWJ0bicpOw0KICAgICAgICBpZiAoc3RhcnRSZXBlYXRlckJ0bikgew0KICAgICAgICAgICAgc3RhcnRSZXBlYXRlckJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW5vZGUtaWQnKTsNCiAgICAgICAgICAgICAgICBzdGFydFJlcGVhdGVyKG5vZGVJZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgY29uc3Qgc3RvcFJlcGVhdGVyQnRuID0gY29uZmlnUGFuZWwucXVlcnlTZWxlY3RvcignLnN0b3AtcmVwZWF0ZXItYnRuJyk7DQogICAgICAgIGlmIChzdG9wUmVwZWF0ZXJCdG4pIHsNCiAgICAgICAgICAgIHN0b3BSZXBlYXRlckJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW5vZGUtaWQnKTsNCiAgICAgICAgICAgICAgICBzdG9wUmVwZWF0ZXIobm9kZUlkKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBBZGQgY2hhbmdlIGxpc3RlbmVycw0KICAgICAgICBmb3IgKGNvbnN0IFtrZXksIGNvbmZpZ10gb2YgT2JqZWN0LmVudHJpZXMobm9kZURlZi5jb25maWcpKSB7DQogICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGNvbmZpZ18ke25vZGVJZH1fJHtrZXl9YCk7DQogICAgICAgICAgICBpZiAoZWxlbWVudCkgew0KICAgICAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgbm9kZS5jb25maWdba2V5XS52YWx1ZSA9IGUudGFyZ2V0LnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3IgZGlzcGxheSBub2RlIGZvcm1hdCBjaGFuZ2VzDQogICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdkaXNwbGF5JyAmJiBrZXkgPT09ICdmb3JtYXQnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGRpc3BsYXktZm9ybWF0LSR7bm9kZUlkfWApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvcm1hdEVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXRFbGVtZW50LnRleHRDb250ZW50ID0gZS50YXJnZXQudmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gbm9kZS1yZW5kZXJlci5qcyAtIER5bmFtaWMgbm9kZSByZW5kZXJpbmcgZm9yIEZsb3cgRWRpdG9yDQoNCmNsYXNzIE5vZGVSZW5kZXJlciB7DQogICAgY29uc3RydWN0b3IoKSB7DQogICAgICAgIHRoaXMudGVtcGxhdGVzID0gbmV3IE1hcCgpOw0KICAgICAgICB0aGlzLnNldHVwU3RhbmRhcmRUZW1wbGF0ZSgpOw0KICAgIH0NCiAgICANCiAgICBzZXR1cFN0YW5kYXJkVGVtcGxhdGUoKSB7DQogICAgICAgIHRoaXMudGVtcGxhdGVzLnNldCgnc3RhbmRhcmQnLCB7DQogICAgICAgICAgICByZW5kZXI6IChub2RlLCBub2RlRGVmKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3QgaW5wdXRzID0gbm9kZURlZi5pbnB1dHMgfHwgW107DQogICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0cyA9IG5vZGVEZWYub3V0cHV0cyB8fCBbXTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICByZXR1cm4gYA0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbG93LW5vZGUtaGVhZGVyIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSIke25vZGVEZWYuaWNvbn0iPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPiR7bm9kZURlZi5uYW1lfTwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJmbG93LW5vZGUtdHlwZSAke25vZGUudHlwZX0iPiR7bm9kZS50eXBlLnRvVXBwZXJDYXNlKCl9PC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibm9kZS1kZWxldGUtYnRuIiB0aXRsZT0iRGVsZXRlIG5vZGUiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtdGltZXMiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmxvdy1ub2RlLWNvbnRlbnQiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibm9kZS1kZWZhdWx0LWNvbnRlbnQiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbCBjbGFzcz0idGV4dC1tdXRlZCI+JHtub2RlRGVmLmRlc2NyaXB0aW9ufTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsb3ctbm9kZS1wb3J0cyI+DQogICAgICAgICAgICAgICAgICAgICAgICAke2lucHV0cy5tYXAoaW5wdXQgPT4gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYDxkaXYgY2xhc3M9ImZsb3ctbm9kZS1wb3J0IGlucHV0IiBkYXRhLXBvcnQ9IiR7aW5wdXQuaWR9Ij48L2Rpdj5gDQogICAgICAgICAgICAgICAgICAgICAgICApLmpvaW4oJycpfQ0KICAgICAgICAgICAgICAgICAgICAgICAgJHtvdXRwdXRzLm1hcChvdXRwdXQgPT4gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYDxkaXYgY2xhc3M9ImZsb3ctbm9kZS1wb3J0IG91dHB1dCIgZGF0YS1wb3J0PSIke291dHB1dC5pZH0iPjwvZGl2PmANCiAgICAgICAgICAgICAgICAgICAgICAgICkuam9pbignJyl9DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0NCiAgICANCiAgICByZWdpc3RlclRlbXBsYXRlKG5hbWUsIHRlbXBsYXRlKSB7DQogICAgICAgIHRoaXMudGVtcGxhdGVzLnNldChuYW1lLCB0ZW1wbGF0ZSk7DQogICAgfQ0KICAgIA0KICAgIHJlbmRlck5vZGUobm9kZSkgew0KICAgICAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgICAgIGlmICghbm9kZURlZikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcihgTm8gbm9kZSBkZWZpbml0aW9uIGZvdW5kIGZvciB0eXBlOiAke25vZGUudHlwZX1gKTsNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgY29uc3QgdGVtcGxhdGVOYW1lID0gbm9kZURlZi50ZW1wbGF0ZSB8fCAnc3RhbmRhcmQnOw0KICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9IHRoaXMudGVtcGxhdGVzLmdldCh0ZW1wbGF0ZU5hbWUpOw0KICAgICAgICANCiAgICAgICAgaWYgKCF0ZW1wbGF0ZSkgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcihgTm8gdGVtcGxhdGUgZm91bmQ6ICR7dGVtcGxhdGVOYW1lfWApOw0KICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICByZXR1cm4gdGVtcGxhdGUucmVuZGVyKG5vZGUsIG5vZGVEZWYpOw0KICAgIH0NCiAgICANCiAgICBjcmVhdGVOb2RlRWxlbWVudChub2RlKSB7DQogICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTmFtZSA9IGBmbG93LW5vZGUgJHtub2RlLnR5cGV9LW5vZGVgOw0KICAgICAgICBub2RlRWxlbWVudC5pZCA9IG5vZGUuaWQ7DQogICAgICAgIG5vZGVFbGVtZW50LnN0eWxlLmxlZnQgPSBub2RlLnggKyAncHgnOw0KICAgICAgICBub2RlRWxlbWVudC5zdHlsZS50b3AgPSBub2RlLnkgKyAncHgnOw0KICAgICAgICANCiAgICAgICAgLy8gUmVuZGVyIHRoZSBub2RlIGNvbnRlbnQNCiAgICAgICAgbm9kZUVsZW1lbnQuaW5uZXJIVE1MID0gdGhpcy5yZW5kZXJOb2RlKG5vZGUpOw0KICAgICAgICANCiAgICAgICAgLy8gQWRkIGV2ZW50IGxpc3RlbmVycyBhbmQgZ2V0IHRoZSB1cGRhdGVkIGVsZW1lbnQNCiAgICAgICAgY29uc3QgZmluYWxFbGVtZW50ID0gdGhpcy5hZGROb2RlRXZlbnRMaXN0ZW5lcnMobm9kZUVsZW1lbnQsIG5vZGUpOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIGZpbmFsRWxlbWVudDsNCiAgICB9DQogICAgDQogICAgYWRkTm9kZUV2ZW50TGlzdGVuZXJzKG5vZGVFbGVtZW50LCBub2RlKSB7DQogICAgICAgIC8vIERlbGV0ZSBidXR0b24NCiAgICAgICAgY29uc3QgZGVsZXRlQnRuID0gbm9kZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm5vZGUtZGVsZXRlLWJ0bicpOw0KICAgICAgICBpZiAoZGVsZXRlQnRuKSB7DQogICAgICAgICAgICBkZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICAgICAgZGVsZXRlTm9kZShub2RlLmlkKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBOb2RlIHNlbGVjdGlvbg0KICAgICAgICBub2RlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICBpZiAoZS50YXJnZXQuY2xvc2VzdCgnLm5vZGUtZGVsZXRlLWJ0bicpKSByZXR1cm47DQogICAgICAgICAgICBzZWxlY3ROb2RlKG5vZGUuaWQpOw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIC8vIE5vZGUgZHJhZ2dpbmcNCiAgICAgICAgbm9kZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGUpID0+IHsNCiAgICAgICAgICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KCcubm9kZS1kZWxldGUtYnRuJykpIHJldHVybjsNCiAgICAgICAgICAgIHN0YXJ0RHJhZ2dpbmdOb2RlKG5vZGUuaWQsIGUpOw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIC8vIFBvcnQgY29ubmVjdGlvbnMNCiAgICAgICAgY29uc3QgcG9ydHMgPSBub2RlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmxvdy1ub2RlLXBvcnQnKTsNCiAgICAgICAgcG9ydHMuZm9yRWFjaChwb3J0ID0+IHsNCiAgICAgICAgICAgIHBvcnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGUpID0+IHsNCiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgICAgIHN0YXJ0Q29ubmVjdGlvbihub2RlLmlkLCBwb3J0LmRhdGFzZXQucG9ydCwgcG9ydC5jbGFzc0xpc3QuY29udGFpbnMoJ291dHB1dCcpKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiBub2RlRWxlbWVudDsNCiAgICB9DQp9DQoNCi8vIEdsb2JhbCBub2RlIHJlbmRlcmVyIGluc3RhbmNlDQpjb25zdCBub2RlUmVuZGVyZXIgPSBuZXcgTm9kZVJlbmRlcmVyKCk7DQoNCg0KLy8gVGV4dCBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlVGV4dE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgdGV4dENvbnRlbnQgPSBub2RlLmNvbmZpZy50ZXh0X2NvbnRlbnQudmFsdWU7DQoNCiAgICByZXR1cm4geyB0ZXh0OiB0ZXh0Q29udGVudCB9Ow0KfQ0KDQoNCi8vIEpTT04gRXh0cmFjdCBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlSnNvbkV4dHJhY3ROb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGZpZWxkUGF0aCA9IG5vZGUuY29uZmlnLmZpZWxkX3BhdGgudmFsdWU7DQogICAgY29uc3QgZGVmYXVsdFZhbHVlID0gbm9kZS5jb25maWcuZGVmYXVsdF92YWx1ZT8udmFsdWUgfHwgJyc7DQoNCiAgICAvLyBBY2NlcHQgYW55IGlucHV0IGRhdGEsIG5vdCBqdXN0IGpzb25fZGF0YQ0KICAgIGxldCBqc29uRGF0YSA9IG51bGw7DQoNCiAgICAvLyBUcnkgdG8gZmluZCBKU09OIGRhdGEgZnJvbSBhbnkgaW5wdXQNCiAgICBpZiAoaW5wdXREYXRhLmpzb25fZGF0YSkgew0KICAgICAgICBqc29uRGF0YSA9IGlucHV0RGF0YS5qc29uX2RhdGE7DQogICAgfSBlbHNlIGlmIChpbnB1dERhdGEuZGF0YSkgew0KICAgICAgICBqc29uRGF0YSA9IGlucHV0RGF0YS5kYXRhOw0KICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLnRleHQpIHsNCiAgICAgICAganNvbkRhdGEgPSBpbnB1dERhdGEudGV4dDsNCiAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS5yZXNwb25zZSkgew0KICAgICAgICBqc29uRGF0YSA9IGlucHV0RGF0YS5yZXNwb25zZTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBVc2UgdGhlIGZpcnN0IGF2YWlsYWJsZSBpbnB1dA0KICAgICAgICBjb25zdCBmaXJzdElucHV0ID0gT2JqZWN0LnZhbHVlcyhpbnB1dERhdGEpWzBdOw0KICAgICAgICBqc29uRGF0YSA9IGZpcnN0SW5wdXQ7DQogICAgfQ0KDQoNCiAgICBsZXQgZXh0cmFjdGVkVmFsdWUgPSBudWxsOw0KDQogICAgdHJ5IHsNCiAgICAgICAgLy8gUGFyc2UgSlNPTiBpZiBpdCdzIGEgc3RyaW5nDQogICAgICAgIGlmICh0eXBlb2YganNvbkRhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICBqc29uRGF0YSA9IEpTT04ucGFyc2UoanNvbkRhdGEpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gRXh0cmFjdCB2YWx1ZSB1c2luZyBkb3Qgbm90YXRpb24NCiAgICAgICAgZXh0cmFjdGVkVmFsdWUgPSB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmV4dHJhY3ROZXN0ZWRWYWx1ZShqc29uRGF0YSwgZmllbGRQYXRoKTsNCg0KICAgICAgICAvLyBVc2UgZGVmYXVsdCB2YWx1ZSBpZiBleHRyYWN0aW9uIGZhaWxlZA0KICAgICAgICBpZiAoZXh0cmFjdGVkVmFsdWUgPT09IG51bGwgfHwgZXh0cmFjdGVkVmFsdWUgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgZXh0cmFjdGVkVmFsdWUgPSBkZWZhdWx0VmFsdWU7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBGb3JtYXQgdGhlIG91dHB1dCBhcyBzdHJpbmcgZm9yIGNvbnNpc3RlbmN5DQogICAgICAgIGxldCBmb3JtYXR0ZWRWYWx1ZSA9IFN0cmluZyhleHRyYWN0ZWRWYWx1ZSk7DQoNCiAgICAgICAgLy8gU3RvcmUgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgICAgIG5vZGUubGFzdEV4dHJhY3RlZFZhbHVlID0gZm9ybWF0dGVkVmFsdWU7DQogICAgICAgIG5vZGUubGFzdEZpZWxkUGF0aCA9IGZpZWxkUGF0aDsNCg0KICAgICAgICAvLyBEZWJ1ZyBsb2dnaW5nDQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGRhdGE6IGZvcm1hdHRlZFZhbHVlLA0KICAgICAgICAgICAgdGV4dDogZm9ybWF0dGVkVmFsdWUsDQogICAgICAgICAgICBqc29uOiBleHRyYWN0ZWRWYWx1ZSwNCiAgICAgICAgICAgIGV4dHJhY3RlZF92YWx1ZTogZm9ybWF0dGVkVmFsdWUsDQogICAgICAgICAgICBmaWVsZF9wYXRoOiBmaWVsZFBhdGgsDQogICAgICAgICAgICBvcmlnaW5hbDoganNvbkRhdGENCiAgICAgICAgfTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdKU09OIEV4dHJhY3QgZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgZGF0YTogZGVmYXVsdFZhbHVlLA0KICAgICAgICAgICAgdGV4dDogZGVmYXVsdFZhbHVlLA0KICAgICAgICAgICAganNvbjogbnVsbCwNCiAgICAgICAgICAgIGV4dHJhY3RlZF92YWx1ZTogZGVmYXVsdFZhbHVlLA0KICAgICAgICAgICAgZmllbGRfcGF0aDogZmllbGRQYXRoLA0KICAgICAgICAgICAgb3JpZ2luYWw6IGpzb25EYXRhLA0KICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UNCiAgICAgICAgfTsNCiAgICB9DQp9DQoNCg0KLy8gUmFuZG9tIExpbmUgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVJhbmRvbVF1b3RlTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBza2lwRW1wdHkgPSBub2RlLmNvbmZpZy5za2lwX2VtcHR5LnZhbHVlID09PSAndHJ1ZSc7DQogICAgY29uc3QgdHJpbVdoaXRlc3BhY2UgPSBub2RlLmNvbmZpZy50cmltX3doaXRlc3BhY2UudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCBtYXhMZW5ndGggPSBwYXJzZUludChub2RlLmNvbmZpZy5tYXhfbGVuZ3RoLnZhbHVlKTsNCg0KDQogICAgbGV0IHRleHQgPSBpbnB1dERhdGEudGV4dDsNCiAgICBpZiAodHlwZW9mIHRleHQgIT09ICdzdHJpbmcnKSB7DQogICAgICAgIHRleHQgPSBKU09OLnN0cmluZ2lmeSh0ZXh0KTsNCiAgICB9DQoNCg0KICAgIGNvbnN0IGxpbmVzID0gdGV4dC5zcGxpdCgnXG4nKTsNCg0KICAgIGxldCB2YWxpZExpbmVzID0gbGluZXM7DQoNCiAgICBpZiAoc2tpcEVtcHR5KSB7DQogICAgICAgIHZhbGlkTGluZXMgPSBsaW5lcy5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKS5sZW5ndGggPiAwKTsNCiAgICB9DQoNCiAgICBpZiAodHJpbVdoaXRlc3BhY2UpIHsNCiAgICAgICAgdmFsaWRMaW5lcyA9IHZhbGlkTGluZXMubWFwKGxpbmUgPT4gbGluZS50cmltKCkpOw0KICAgIH0NCg0KICAgIGlmICh2YWxpZExpbmVzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICByZXR1cm4geyByYW5kb21fbGluZTogbnVsbCwgbGluZV9udW1iZXI6IDAsIHRvdGFsX2xpbmVzOiAwIH07DQogICAgfQ0KDQogICAgY29uc3QgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB2YWxpZExpbmVzLmxlbmd0aCk7DQogICAgbGV0IHJhbmRvbUxpbmUgPSB2YWxpZExpbmVzW3JhbmRvbUluZGV4XTsNCg0KDQogICAgaWYgKG1heExlbmd0aCA+IDAgJiYgcmFuZG9tTGluZS5sZW5ndGggPiBtYXhMZW5ndGgpIHsNCiAgICAgICAgcmFuZG9tTGluZSA9IHJhbmRvbUxpbmUuc3Vic3RyaW5nKDAsIG1heExlbmd0aCkgKyAnLi4uJzsNCiAgICB9DQoNCiAgICBjb25zdCByZXN1bHQgPSB7DQogICAgICAgIHJhbmRvbV9saW5lOiByYW5kb21MaW5lLA0KICAgICAgICBsaW5lX251bWJlcjogcmFuZG9tSW5kZXggKyAxLA0KICAgICAgICB0b3RhbF9saW5lczogdmFsaWRMaW5lcy5sZW5ndGgNCiAgICB9Ow0KDQogICAgcmV0dXJuIHJlc3VsdDsNCn0NCg0KDQovLyBFeHBvcnQgdG8gZ2xvYmFsIHNjb3BlDQp3aW5kb3cuZGF0YUV4ZWN1dG9ycyA9IHsNCiAgICBleGVjdXRlVGV4dE5vZGUsDQogICAgZXhlY3V0ZUpzb25FeHRyYWN0Tm9kZSwNCiAgICBleGVjdXRlUmFuZG9tUXVvdGVOb2RlDQp9Ow0KDQoNCi8vIEhUVFAgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUh0dHBOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IHVybCA9IG5vZGUuY29uZmlnLnVybC52YWx1ZTsNCiAgICBjb25zdCBtZXRob2QgPSBub2RlLmNvbmZpZy5tZXRob2QudmFsdWU7DQogICAgY29uc3QgaGVhZGVycyA9IEpTT04ucGFyc2Uobm9kZS5jb25maWcuaGVhZGVycy52YWx1ZSB8fCAne30nKTsNCiAgICBjb25zdCBib2R5ID0gbm9kZS5jb25maWcuYm9keS52YWx1ZTsNCiAgICBjb25zdCB1c2VUZW1wbGF0ZSA9IChub2RlLmNvbmZpZy51c2VfdGVtcGxhdGU/LnZhbHVlIHx8ICdmYWxzZScpID09PSAndHJ1ZSc7DQoNCiAgICBsZXQgcHJvY2Vzc2VkQm9keSA9IGJvZHk7DQoNCiAgICAvLyBQYXJzZSBib2R5IGFzIEpTT04gaWYgaXQncyBhIHN0cmluZyBhbmQgbG9va3MgbGlrZSBKU09ODQogICAgaWYgKHR5cGVvZiBwcm9jZXNzZWRCb2R5ID09PSAnc3RyaW5nJyAmJiBwcm9jZXNzZWRCb2R5LnRyaW0oKS5zdGFydHNXaXRoKCd7JykpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHByb2Nlc3NlZEJvZHkgPSBKU09OLnBhcnNlKHByb2Nlc3NlZEJvZHkpOw0KICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBwYXJzZSBib2R5IGFzIEpTT04sIHVzaW5nIGFzIHN0cmluZzonLCBlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICh1c2VUZW1wbGF0ZSAmJiBpbnB1dERhdGEudGVtcGxhdGVfZGF0YSkgew0KICAgICAgICBwcm9jZXNzZWRCb2R5ID0gd2luZG93LmZsb3dFZGl0b3JVdGlscy5wcm9jZXNzVGVtcGxhdGVzKHByb2Nlc3NlZEJvZHksIGlucHV0RGF0YS50ZW1wbGF0ZV9kYXRhKTsNCiAgICB9DQoNCiAgICAvLyBVc2UgT1MgcHJveHkgdG8gYnlwYXNzIENPUlMNCiAgICBjb25zdCBwcm94eVJlcXVlc3QgPSB7DQogICAgICAgIHVybDogdXJsLA0KICAgICAgICBtZXRob2Q6IG1ldGhvZCwNCiAgICAgICAgaGVhZGVyczogaGVhZGVycywNCiAgICAgICAgYm9keTogcHJvY2Vzc2VkQm9keSwNCiAgICAgICAgdGltZW91dDogMzANCiAgICB9Ow0KDQoNCiAgICBjb25zdCBwcm94eVJlc3BvbnNlID0gYXdhaXQgc3lwbmV4QVBJLnByb3h5SFRUUChwcm94eVJlcXVlc3QpOw0KDQogICAgaWYgKCFwcm94eVJlc3BvbnNlIHx8IHByb3h5UmVzcG9uc2Uuc3RhdHVzIDwgMjAwIHx8IHByb3h5UmVzcG9uc2Uuc3RhdHVzID49IDMwMCkgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFByb3h5IHJlcXVlc3QgZmFpbGVkOiAke3Byb3h5UmVzcG9uc2U/LnN0YXR1cyB8fCAnVW5rbm93biBlcnJvcid9YCk7DQogICAgfQ0KDQogICAgY29uc3QgcHJveHlEYXRhID0gcHJveHlSZXNwb25zZTsNCg0KICAgIGlmIChwcm94eURhdGEuZXJyb3IpIHsNCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIHJlcXVlc3QgZmFpbGVkOiAke3Byb3h5RGF0YS5lcnJvcn1gKTsNCiAgICB9DQoNCiAgICAvLyBDaGVjayBpZiByZXNwb25zZSBpcyBiaW5hcnkgKGF1ZGlvLCBpbWFnZSwgZXRjLikNCiAgICBpZiAocHJveHlEYXRhLmlzX2JpbmFyeSkgew0KDQogICAgICAgIC8vIENvbnZlcnQgYmFzZTY0IGNvbnRlbnQgdG8gYmxvYiBmb3IgYmluYXJ5IGRhdGENCiAgICAgICAgY29uc3QgYmluYXJ5RGF0YSA9IGF0b2IocHJveHlEYXRhLmNvbnRlbnQpOw0KICAgICAgICBjb25zdCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGJpbmFyeURhdGEubGVuZ3RoKTsNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaW5hcnlEYXRhLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBieXRlc1tpXSA9IGJpbmFyeURhdGEuY2hhckNvZGVBdChpKTsNCiAgICAgICAgfQ0KICAgICAgICBjb25zdCBjb250ZW50VHlwZSA9IHByb3h5RGF0YS5oZWFkZXJzWydjb250ZW50LXR5cGUnXSB8fCBwcm94eURhdGEuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gfHwgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSc7DQogICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbYnl0ZXNdLCB7IHR5cGU6IGNvbnRlbnRUeXBlIH0pOw0KDQogICAgICAgIC8vIFJldHVybiBibG9iIGRpcmVjdGx5IGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IHdpdGggaW1hZ2UvYXVkaW8gbm9kZXMNCiAgICAgICAgLy8gVGhlIHdvcmtmbG93IGV4ZWN1dGlvbiB3aWxsIGhhbmRsZSBtYXBwaW5nIHRvIHRoZSBjb3JyZWN0IHBvcnRzDQogICAgICAgIHJldHVybiBibG9iOw0KICAgIH0NCg0KICAgIC8vIEZvciB0ZXh0IHJlc3BvbnNlcywgdHJ5IHRvIHBhcnNlIGFzIEpTT04gYW5kIHJldHVybiBzdHJ1Y3R1cmVkIG91dHB1dA0KDQogICAgbGV0IHBhcnNlZEpzb24gPSBudWxsOw0KICAgIHRyeSB7DQogICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBKU09ODQogICAgICAgIHBhcnNlZEpzb24gPSBKU09OLnBhcnNlKHByb3h5RGF0YS5jb250ZW50KTsNCiAgICB9IGNhdGNoIChlKSB7DQogICAgfQ0KDQogICAgLy8gUmV0dXJuIHN0cnVjdHVyZWQgb3V0cHV0IGZvciB0ZXh0IHJlc3BvbnNlcyBtYXRjaGluZyBuZXcgbm9kZSBhcmNoaXRlY3R1cmUNCiAgICByZXR1cm4gew0KICAgICAgICBvcmlnaW5hbF9kYXRhOiBwcm94eURhdGEuY29udGVudCwNCiAgICAgICAgcHJvY2Vzc2VkX2RhdGE6IHBhcnNlZEpzb24gfHwgcHJveHlEYXRhLmNvbnRlbnQsDQogICAgICAgIHJlc3BvbnNlOiBwcm94eURhdGEuY29udGVudCwNCiAgICAgICAgc3RhdHVzX2NvZGU6IHByb3h5RGF0YS5zdGF0dXMgfHwgMjAwLA0KICAgICAgICBoZWFkZXJzOiBwcm94eURhdGEuaGVhZGVycyB8fCB7fSwNCiAgICAgICAgcGFyc2VkX2pzb246IHBhcnNlZEpzb24sDQogICAgICAgIC8vIEFsc28gcHJvdmlkZSB0aGUgcmF3IHJlc3BvbnNlIGFzICdkYXRhJyBmb3IgY29tcGF0aWJpbGl0eQ0KICAgICAgICBkYXRhOiBwcm94eURhdGEuY29udGVudCwNCiAgICAgICAgLy8gQWRkIHRoZSBtaXNzaW5nIG91dHB1dCBwb3J0cyBmcm9tIG5vZGUgZGVmaW5pdGlvbg0KICAgICAgICB0ZXh0OiBwcm94eURhdGEuY29udGVudCwNCiAgICAgICAganNvbjogcGFyc2VkSnNvbiwNCiAgICAgICAgdXJsOiB1cmwNCiAgICB9Ow0KfQ0KDQovLyBWRlMgTG9hZCBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlVmZzTG9hZE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgZmlsZVBhdGggPSBub2RlLmNvbmZpZy5maWxlX3BhdGgudmFsdWU7DQogICAgY29uc3QgZm9ybWF0ID0gbm9kZS5jb25maWcuZm9ybWF0LnZhbHVlOw0KDQoNCiAgICB0cnkgew0KICAgICAgICBsZXQgZGF0YSA9IG51bGw7DQoNCiAgICAgICAgaWYgKGZvcm1hdCA9PT0gJ2pzb24nKSB7DQogICAgICAgICAgICBkYXRhID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZUpTT04oZmlsZVBhdGgpOw0KICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ3RleHQnKSB7DQogICAgICAgICAgICBkYXRhID0gYXdhaXQgc3lwbmV4QVBJLnJlYWRWaXJ0dWFsRmlsZVRleHQoZmlsZVBhdGgpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gRm9yIGJpbmFyeSBmaWxlcywgdXNlIHRoZSBkaXJlY3QgVVJMIG1ldGhvZA0KICAgICAgICAgICAgY29uc3QgZmlsZVVybCA9IHN5cG5leEFQSS5nZXRWaXJ0dWFsRmlsZVVybChmaWxlUGF0aCk7DQoNCiAgICAgICAgICAgIC8vIENoZWNrIGZpbGUgZXh0ZW5zaW9uIHRvIGRldGVybWluZSBpZiBpdCdzIGF1ZGlvDQogICAgICAgICAgICBjb25zdCBleHRlbnNpb24gPSBmaWxlUGF0aC5zcGxpdCgnLicpLnBvcCgpPy50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgY29uc3QgaXNBdWRpb0ZpbGUgPSBbJ21wMycsICd3YXYnLCAnb2dnJywgJ200YScsICdhYWMnLCAnZmxhYyddLmluY2x1ZGVzKGV4dGVuc2lvbik7DQogICAgICAgICAgICBjb25zdCBpc0ltYWdlRmlsZSA9IFsncG5nJywgJ2pwZycsICdqcGVnJywgJ2dpZicsICd3ZWJwJywgJ3N2ZyddLmluY2x1ZGVzKGV4dGVuc2lvbik7DQoNCiAgICAgICAgICAgIGlmIChpc0F1ZGlvRmlsZSkgew0KICAgICAgICAgICAgfSBlbHNlIGlmIChpc0ltYWdlRmlsZSkgew0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gRmV0Y2ggdGhlIGJpbmFyeSBkYXRhIGFzIGEgQmxvYg0KICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChmaWxlVXJsKTsNCiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHsNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBmZXRjaCBiaW5hcnkgZmlsZTogJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmJsb2IoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN0b3JlIHRoZSBsb2FkZWQgZGF0YSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICAgICAgbm9kZS5sYXN0TG9hZGVkRmlsZSA9IGZpbGVQYXRoOw0KICAgICAgICBub2RlLmxhc3RMb2FkZWREYXRhID0gZGF0YTsNCg0KICAgICAgICAvLyBSZXR1cm4gc3RydWN0dXJlZCBvdXRwdXQgd2l0aCBhcHByb3ByaWF0ZSBwb3J0IG5hbWVzDQogICAgICAgIGNvbnN0IHJlc3VsdCA9IHsNCiAgICAgICAgICAgIGRhdGE6IGRhdGEsDQogICAgICAgICAgICBmaWxlX3BhdGg6IGZpbGVQYXRoLCAgLy8gUmV0dXJuIHRoZSBhY3R1YWwgZmlsZSBwYXRoIHN0cmluZw0KICAgICAgICAgICAganNvbl9kYXRhOiBmb3JtYXQgPT09ICdqc29uJyA/IGRhdGEgOiBudWxsDQogICAgICAgIH07DQogICAgICAgIHJldHVybiByZXN1bHQ7DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVkZTIExvYWQgZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4geyBkYXRhOiBudWxsLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9Ow0KICAgIH0NCn0NCg0KDQovLyBWRlMgU2F2ZSBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlVmZzU2F2ZU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgZmlsZVBhdGggPSBub2RlLmNvbmZpZy5maWxlX3BhdGgudmFsdWU7DQogICAgY29uc3QgZm9ybWF0ID0gbm9kZS5jb25maWcuZm9ybWF0LnZhbHVlOw0KICAgIGNvbnN0IG92ZXJ3cml0ZSA9IG5vZGUuY29uZmlnLm92ZXJ3cml0ZS52YWx1ZSA9PT0gJ3RydWUnOw0KICAgIGNvbnN0IGFwcGVuZCA9IG5vZGUuY29uZmlnLmFwcGVuZC52YWx1ZSA9PT0gJ3RydWUnOw0KDQogICAgdHJ5IHsNCiAgICAgICAgbGV0IGRhdGEgPSBpbnB1dERhdGEuZGF0YTsNCiAgICAgICAgbGV0IHN1Y2Nlc3MgPSBmYWxzZTsNCg0KDQogICAgICAgIGlmIChmb3JtYXQgPT09ICdqc29uJykgew0KICAgICAgICAgICAgc3VjY2VzcyA9IGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlSlNPTihmaWxlUGF0aCwgZGF0YSk7DQogICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAndGV4dCcpIHsNCiAgICAgICAgICAgIGNvbnN0IHRleHREYXRhID0gdHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnID8gZGF0YSA6IEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpOw0KICAgICAgICAgICAgc3VjY2VzcyA9IGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlKGZpbGVQYXRoLCB0ZXh0RGF0YSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBGb3IgYmluYXJ5IGRhdGEgKGxpa2UgQmxvYnMpLCBjb252ZXJ0IHRvIGRhdGEgVVJMDQogICAgICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEJsb2IpIHsNCiAgICAgICAgICAgICAgICAvLyBDb252ZXJ0IEJsb2IgdG8gZGF0YSBVUkwNCiAgICAgICAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFVcmwgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7DQogICAgICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoKSA9PiByZXNvbHZlKHJlYWRlci5yZXN1bHQpOw0KICAgICAgICAgICAgICAgICAgICByZWFkZXIub25lcnJvciA9IHJlamVjdDsNCiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZGF0YSk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgc3VjY2VzcyA9IGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlKGZpbGVQYXRoLCBkYXRhVXJsKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgLy8gSWYgaXQncyBhbHJlYWR5IGEgZGF0YSBVUkwsIHNhdmUgaXQgZGlyZWN0bHkNCiAgICAgICAgICAgICAgICBzdWNjZXNzID0gYXdhaXQgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGUoZmlsZVBhdGgsIGRhdGEpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvLyBGYWxsYmFjayB0byBKU09OIHN0cmluZw0KICAgICAgICAgICAgICAgIGNvbnN0IHRleHREYXRhID0gSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMik7DQogICAgICAgICAgICAgICAgc3VjY2VzcyA9IGF3YWl0IHN5cG5leEFQSS53cml0ZVZpcnR1YWxGaWxlKGZpbGVQYXRoLCB0ZXh0RGF0YSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBzdWNjZXNzIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVkZTIFNhdmUgZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTsNCiAgICB9DQp9DQoNCi8vIEV4cG9ydCB0byBnbG9iYWwgc2NvcGUNCndpbmRvdy5odHRwRXhlY3V0b3JzID0gew0KICAgIGV4ZWN1dGVIdHRwTm9kZSwNCiAgICBleGVjdXRlVmZzTG9hZE5vZGUsDQogICAgZXhlY3V0ZVZmc1NhdmVOb2RlDQp9Ow0KDQovLyBJbWFnZSBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlSW1hZ2VOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IG1heFByZXZpZXdTaXplID0gbm9kZS5jb25maWcubWF4X3ByZXZpZXdfc2l6ZS52YWx1ZTsNCiAgICBjb25zdCBzaG93SW5mbyA9IG5vZGUuY29uZmlnLnNob3dfaW5mby52YWx1ZSA9PT0gJ3RydWUnOw0KDQogICAgbGV0IGltYWdlRGF0YSA9IGlucHV0RGF0YS5pbWFnZV9kYXRhOw0KICAgIGxldCBpbWFnZVVybCA9IG51bGw7DQogICAgbGV0IGltYWdlSW5mbyA9IG51bGw7DQoNCiAgICAvLyBIYW5kbGUgZGlmZmVyZW50IHR5cGVzIG9mIGltYWdlIGRhdGENCiAgICBpZiAoaW1hZ2VEYXRhIGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICAvLyBDcmVhdGUgb2JqZWN0IFVSTCBmb3IgQmxvYiBkYXRhDQogICAgICAgIGltYWdlVXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChpbWFnZURhdGEpOw0KICAgICAgICBpbWFnZUluZm8gPSB7DQogICAgICAgICAgICB0eXBlOiBpbWFnZURhdGEudHlwZSB8fCAnaW1hZ2UnLA0KICAgICAgICAgICAgc2l6ZTogaW1hZ2VEYXRhLnNpemUNCiAgICAgICAgfTsNCiAgICB9IGVsc2UgaWYgKHR5cGVvZiBpbWFnZURhdGEgPT09ICdzdHJpbmcnKSB7DQogICAgICAgIC8vIENoZWNrIGlmIGl0J3MgYmFzZTY0IGRhdGENCiAgICAgICAgaWYgKGltYWdlRGF0YS5zdGFydHNXaXRoKCdkYXRhOmltYWdlLycpIHx8IGltYWdlRGF0YS5zdGFydHNXaXRoKCdkYXRhOmFwcGxpY2F0aW9uLycpKSB7DQogICAgICAgICAgICAvLyBBbHJlYWR5IGEgZGF0YSBVUkwNCiAgICAgICAgICAgIGltYWdlVXJsID0gaW1hZ2VEYXRhOw0KICAgICAgICB9IGVsc2UgaWYgKGltYWdlRGF0YS5tYXRjaCgvXltBLVphLXowLTkrL10qPXswLDJ9JC8pKSB7DQogICAgICAgICAgICAvLyBMb29rcyBsaWtlIGJhc2U2NCBkYXRhLCBjb252ZXJ0IHRvIGRhdGEgVVJMDQogICAgICAgICAgICAvLyBUcnkgdG8gZGV0ZWN0IGltYWdlIHR5cGUgZnJvbSB0aGUgZGF0YQ0KICAgICAgICAgICAgY29uc3QgaW1hZ2VUeXBlID0gd2luZG93LmZsb3dFZGl0b3JVdGlscy5kZXRlY3RJbWFnZVR5cGVGcm9tQmFzZTY0KGltYWdlRGF0YSk7DQogICAgICAgICAgICBpbWFnZVVybCA9IGBkYXRhOiR7aW1hZ2VUeXBlfTtiYXNlNjQsJHtpbWFnZURhdGF9YDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIEFzc3VtZSBpdCdzIGEgcmVndWxhciBVUkwNCiAgICAgICAgICAgIGltYWdlVXJsID0gaW1hZ2VEYXRhOw0KICAgICAgICB9DQogICAgfSBlbHNlIGlmIChpbWFnZURhdGEgJiYgdHlwZW9mIGltYWdlRGF0YSA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgLy8gSGFuZGxlIG9iamVjdCB3aXRoIGltYWdlIGRhdGENCiAgICAgICAgaWYgKGltYWdlRGF0YS51cmwpIHsNCiAgICAgICAgICAgIGltYWdlVXJsID0gaW1hZ2VEYXRhLnVybDsNCiAgICAgICAgfSBlbHNlIGlmIChpbWFnZURhdGEuZGF0YSkgew0KICAgICAgICAgICAgaW1hZ2VVcmwgPSBpbWFnZURhdGEuZGF0YTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpbWFnZURhdGEuaW5mbykgew0KICAgICAgICAgICAgaW1hZ2VJbmZvID0gaW1hZ2VEYXRhLmluZm87DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBOb3RlOiBSZW1vdmVkIGltYWdlIGRpbWVuc2lvbiBkZXRlY3Rpb24gYXMgaXQncyBub3QgbmVlZGVkDQoNCiAgICAvLyBTdG9yZSBpbWFnZSBkYXRhIGZvciBkaXNwbGF5IGluIGNvbmZpZyBwYW5lbA0KICAgIG5vZGUubGFzdEltYWdlRGF0YSA9IGltYWdlRGF0YTsNCiAgICBub2RlLmxhc3RJbWFnZVVybCA9IGltYWdlVXJsOw0KICAgIG5vZGUubGFzdEltYWdlSW5mbyA9IGltYWdlSW5mbzsNCg0KICAgIHJldHVybiB7DQogICAgICAgIGltYWdlX2RhdGE6IGltYWdlRGF0YSwNCiAgICAgICAgaW1hZ2VfdXJsOiBpbWFnZVVybCwNCiAgICAgICAgaW1hZ2VfaW5mbzogaW1hZ2VJbmZvLA0KICAgICAgICBkYXRhOiBpbWFnZURhdGENCiAgICB9Ow0KfQ0KDQovLyBBdWRpbyBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlQXVkaW9Ob2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGF1dG9QbGF5ID0gbm9kZS5jb25maWcuYXV0b1BsYXkudmFsdWUgPT09ICd0cnVlJzsNCiAgICBjb25zdCB2b2x1bWUgPSBwYXJzZUZsb2F0KG5vZGUuY29uZmlnLnZvbHVtZS52YWx1ZSk7DQoNCiAgICBsZXQgYXVkaW9EYXRhID0gaW5wdXREYXRhLmF1ZGlvX2RhdGE7DQoNCg0KICAgIGlmICghYXVkaW9EYXRhKSB7DQogICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYXVkaW8gZGF0YSBwcm92aWRlZCcpOw0KICAgIH0NCg0KICAgIC8vIFN0b3JlIGF1ZGlvIGRhdGEgZm9yIG1hbnVhbCBwbGF5IGJ1dHRvbiBzeXN0ZW0gKGxpa2Ugb2xkIHN5c3RlbSkNCiAgICBub2RlLmF1ZGlvRGF0YSA9IGF1ZGlvRGF0YTsNCiAgICBub2RlLnZvbHVtZSA9IHZvbHVtZTsNCg0KICAgIC8vIENyZWF0ZSBhdWRpbyBlbGVtZW50IGlmIGl0IGRvZXNuJ3QgZXhpc3QgKGxpa2Ugb2xkIHN5c3RlbSkNCiAgICBpZiAoIW5vZGUuYXVkaW9FbGVtZW50KSB7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50ID0gbmV3IEF1ZGlvKCk7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LmNvbnRyb2xzID0gdHJ1ZTsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3R5bGUud2lkdGggPSAnMTAwJSc7DQogICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JzsNCiAgICB9DQoNCiAgICAvLyBTZXQgYXVkaW8gc291cmNlIChsaWtlIG9sZCBzeXN0ZW0pDQogICAgaWYgKGF1ZGlvRGF0YSBpbnN0YW5jZW9mIEJsb2IpIHsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChhdWRpb0RhdGEpOw0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGF1ZGlvRGF0YSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgaWYgKGF1ZGlvRGF0YS5zdGFydHNXaXRoKCdkYXRhOmF1ZGlvLycpIHx8IGF1ZGlvRGF0YS5zdGFydHNXaXRoKCdkYXRhOmFwcGxpY2F0aW9uLycpKSB7DQogICAgICAgICAgICAvLyBBbHJlYWR5IGEgZGF0YSBVUkwNCiAgICAgICAgICAgIG5vZGUuYXVkaW9FbGVtZW50LnNyYyA9IGF1ZGlvRGF0YTsNCiAgICAgICAgfSBlbHNlIGlmIChhdWRpb0RhdGEubWF0Y2goL15bQS1aYS16MC05Ky9dKj17MCwyfSQvKSkgew0KICAgICAgICAgICAgLy8gTG9va3MgbGlrZSBiYXNlNjQgZGF0YSwgY29udmVydCB0byBkYXRhIFVSTA0KICAgICAgICAgICAgY29uc3QgYXVkaW9UeXBlID0gJ2F1ZGlvL21wZWcnOyAvLyBEZWZhdWx0IHRvIE1QMywgY291bGQgYmUgZW5oYW5jZWQgdG8gZGV0ZWN0IHR5cGUNCiAgICAgICAgICAgIGNvbnN0IGRhdGFVcmwgPSBgZGF0YToke2F1ZGlvVHlwZX07YmFzZTY0LCR7YXVkaW9EYXRhfWA7DQogICAgICAgICAgICBub2RlLmF1ZGlvRWxlbWVudC5zcmMgPSBkYXRhVXJsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSByZWd1bGFyIFVSTA0KICAgICAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gYXVkaW9EYXRhOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgbm9kZS5hdWRpb0VsZW1lbnQuc3JjID0gYXVkaW9EYXRhOw0KICAgIH0NCg0KICAgIC8vIFNldCB2b2x1bWUNCiAgICBub2RlLmF1ZGlvRWxlbWVudC52b2x1bWUgPSB2b2x1bWU7DQoNCiAgICAvLyBTdG9yZSBmb3IgY29uZmlnIHBhbmVsIGNvbXBhdGliaWxpdHkNCiAgICBub2RlLmxhc3RBdWRpb0RhdGEgPSBhdWRpb0RhdGE7DQogICAgbm9kZS5sYXN0QXVkaW9VcmwgPSBub2RlLmF1ZGlvRWxlbWVudC5zcmM7DQoNCiAgICAvLyBBdXRvLXBsYXkgaWYgY29uZmlndXJlZA0KICAgIGlmIChhdXRvUGxheSkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgYXdhaXQgbm9kZS5hdWRpb0VsZW1lbnQucGxheSgpOw0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignQXV0by1wbGF5IGZhaWxlZDonLCBlcnJvcik7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBDb252ZXJ0IGF1ZGlvIGRhdGEgdG8gcHJvcGVyIGRhdGEgVVJMIGZvciBWRlMgU2F2ZQ0KICAgIGxldCBkYXRhVXJsRm9yU2F2ZSA9IG51bGw7DQoNCiAgICBpZiAoYXVkaW9EYXRhIGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICAvLyBDb252ZXJ0IEJsb2IgdG8gZGF0YSBVUkwNCiAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgICAgZGF0YVVybEZvclNhdmUgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7DQogICAgICAgICAgICByZWFkZXIub25sb2FkID0gKCkgPT4gcmVzb2x2ZShyZWFkZXIucmVzdWx0KTsNCiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gcmVqZWN0Ow0KICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoYXVkaW9EYXRhKTsNCiAgICAgICAgfSk7DQogICAgfSBlbHNlIGlmICh0eXBlb2YgYXVkaW9EYXRhID09PSAnc3RyaW5nJykgew0KICAgICAgICBpZiAoYXVkaW9EYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6YXVkaW8vJykgfHwgYXVkaW9EYXRhLnN0YXJ0c1dpdGgoJ2RhdGE6YXBwbGljYXRpb24vJykpIHsNCiAgICAgICAgICAgIC8vIEFscmVhZHkgYSBkYXRhIFVSTA0KICAgICAgICAgICAgZGF0YVVybEZvclNhdmUgPSBhdWRpb0RhdGE7DQogICAgICAgIH0gZWxzZSBpZiAoYXVkaW9EYXRhLm1hdGNoKC9eW0EtWmEtejAtOSsvXSo9ezAsMn0kLykpIHsNCiAgICAgICAgICAgIC8vIEJhc2U2NCBkYXRhLCBjb252ZXJ0IHRvIGRhdGEgVVJMDQogICAgICAgICAgICBjb25zdCBhdWRpb1R5cGUgPSAnYXVkaW8vbXBlZyc7IC8vIERlZmF1bHQgdG8gTVAzLCBjb3VsZCBiZSBlbmhhbmNlZCB0byBkZXRlY3QgdHlwZQ0KICAgICAgICAgICAgZGF0YVVybEZvclNhdmUgPSBgZGF0YToke2F1ZGlvVHlwZX07YmFzZTY0LCR7YXVkaW9EYXRhfWA7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBSZWd1bGFyIFVSTCwga2VlcCBhcyBpcw0KICAgICAgICAgICAgZGF0YVVybEZvclNhdmUgPSBhdWRpb0RhdGE7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBGYWxsYmFjaw0KICAgICAgICBkYXRhVXJsRm9yU2F2ZSA9IGF1ZGlvRGF0YTsNCiAgICB9DQoNCiAgICByZXR1cm4gew0KICAgICAgICBhdWRpb19kYXRhOiBhdWRpb0RhdGEsDQogICAgICAgIGF1ZGlvX3VybDogbm9kZS5hdWRpb0VsZW1lbnQuc3JjLA0KICAgICAgICBkYXRhOiBkYXRhVXJsRm9yU2F2ZSAgLy8gUmV0dXJuIHRoZSBhY3R1YWwgYXVkaW8gZGF0YSBhcyBkYXRhIFVSTA0KICAgIH07DQp9DQoNCi8vIEV4cG9ydCB0byBnbG9iYWwgc2NvcGUNCndpbmRvdy5tZWRpYUV4ZWN1dG9ycyA9IHsNCiAgICBleGVjdXRlSW1hZ2VOb2RlLA0KICAgIGV4ZWN1dGVBdWRpb05vZGUNCn07DQoNCg0KLy8gVGltZXIgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVRpbWVyTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBpbnRlcnZhbCA9IG5vZGUuY29uZmlnLmludGVydmFsLnZhbHVlOw0KICAgIGNvbnN0IGNvdW50ID0gbm9kZS5jb25maWcuY291bnQudmFsdWU7DQoNCiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsNCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpOw0KICAgICAgICAgICAgcmVzb2x2ZSh7DQogICAgICAgICAgICAgICAgdHJpZ2dlcjogdGltZXN0YW1wLA0KICAgICAgICAgICAgICAgIG9yaWdpbmFsX2RhdGE6IHRpbWVzdGFtcCwNCiAgICAgICAgICAgICAgICBwcm9jZXNzZWRfZGF0YTogdGltZXN0YW1wLA0KICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogdGltZXN0YW1wLA0KICAgICAgICAgICAgICAgIGVsYXBzZWQ6IGludGVydmFsDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSwgaW50ZXJ2YWwpOw0KICAgIH0pOw0KfQ0KDQovLyBEaXNwbGF5IE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVEaXNwbGF5Tm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBmb3JtYXQgPSBub2RlLmNvbmZpZy5mb3JtYXQudmFsdWU7DQogICAgY29uc3QgbWF4TGVuZ3RoID0gbm9kZS5jb25maWcubWF4TGVuZ3RoLnZhbHVlOw0KICAgIGNvbnN0IGlucHV0UG9ydCA9IG5vZGUuY29uZmlnLmlucHV0X3BvcnQ/LnZhbHVlIHx8ICdhdXRvJzsNCg0KICAgIC8vIFRyeSB0byBmaW5kIGNvbnRlbnQgYmFzZWQgb24gY29uZmlndXJlZCBpbnB1dCBwb3J0IG9yIGF1dG8tZGV0ZWN0DQogICAgbGV0IGNvbnRlbnQgPSBudWxsOw0KDQogICAgaWYgKGlucHV0UG9ydCAhPT0gJ2F1dG8nKSB7DQogICAgICAgIC8vIFVzZSB0aGUgc3BlY2lmaWVkIGlucHV0IHBvcnQNCiAgICAgICAgY29udGVudCA9IGlucHV0RGF0YVtpbnB1dFBvcnRdOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIEF1dG8tZGV0ZWN0OiBQcmlvcml0eSBvcmRlcjogdGV4dCwganNvbiwgZGF0YSwgYmluYXJ5DQogICAgICAgIGlmIChpbnB1dERhdGEudGV4dCAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBjb250ZW50ID0gaW5wdXREYXRhLnRleHQ7DQogICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLmpzb24gIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgY29udGVudCA9IGlucHV0RGF0YS5qc29uOw0KICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YS5kYXRhICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBpbnB1dERhdGEuZGF0YTsNCiAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGEuYmluYXJ5ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBpbnB1dERhdGEuYmluYXJ5Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gVXNlIHRoZSBmaXJzdCBhdmFpbGFibGUgaW5wdXQNCiAgICAgICAgICAgIGNvbnN0IGZpcnN0SW5wdXQgPSBPYmplY3QudmFsdWVzKGlucHV0RGF0YSlbMF07DQogICAgICAgICAgICBjb250ZW50ID0gZmlyc3RJbnB1dDsNCiAgICAgICAgfQ0KICAgIH0NCg0KDQogICAgLy8gT25seSBjb252ZXJ0IHRvIEpTT04gc3RyaW5nIGlmIGZvcm1hdCBpcyAnanNvbicgb3IgaWYgaXQncyBhbiBvYmplY3QgYW5kIGZvcm1hdCBpcyBub3Qgc3BlY2lmaWVkDQogICAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnb2JqZWN0JyAmJiBmb3JtYXQgPT09ICdqc29uJykgew0KICAgICAgICBjb250ZW50ID0gSlNPTi5zdHJpbmdpZnkoY29udGVudCwgbnVsbCwgMik7DQogICAgfSBlbHNlIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ29iamVjdCcgJiYgZm9ybWF0ID09PSAndGV4dCcpIHsNCiAgICAgICAgLy8gRm9yIHRleHQgZm9ybWF0LCBleHRyYWN0IHRoZSBhY3R1YWwgdmFsdWUgZnJvbSBjb21tb24gZmllbGRzDQogICAgICAgIGlmIChjb250ZW50ID09PSBudWxsKSB7DQogICAgICAgICAgICBjb250ZW50ID0gJ251bGwnOw0KICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoY29udGVudCkpIHsNCiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LmpvaW4oJywgJyk7DQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdvYmplY3QnKSB7DQogICAgICAgICAgICAvLyBMb29rIGZvciB0aGUgYWN0dWFsIHZhbHVlIGluIGNvbW1vbiBmaWVsZHMNCiAgICAgICAgICAgIGlmIChjb250ZW50LmV4dHJhY3RlZF92YWx1ZSAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgY29udGVudCA9IFN0cmluZyhjb250ZW50LmV4dHJhY3RlZF92YWx1ZSk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRlbnQudmFsdWUgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBTdHJpbmcoY29udGVudC52YWx1ZSk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRlbnQudGV4dCAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgY29udGVudCA9IFN0cmluZyhjb250ZW50LnRleHQpOw0KICAgICAgICAgICAgfSBlbHNlIGlmIChjb250ZW50LmRhdGEgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBTdHJpbmcoY29udGVudC5kYXRhKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy8gSWYgbm8gY29tbW9uIGZpZWxkcyBmb3VuZCwganVzdCBzaG93IHRoZSBmaXJzdCB2YWx1ZQ0KICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0VmFsdWUgPSBPYmplY3QudmFsdWVzKGNvbnRlbnQpWzBdOw0KICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBTdHJpbmcoZmlyc3RWYWx1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoY29udGVudCAmJiBjb250ZW50Lmxlbmd0aCA+IG1heExlbmd0aCkgew0KICAgICAgICBjb250ZW50ID0gY29udGVudC5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKSArICcuLi4nOw0KICAgIH0NCg0KICAgIC8vIFVwZGF0ZSBkaXNwbGF5IG5vZGUgY29udGVudA0KICAgIHVwZGF0ZURpc3BsYXlOb2RlQ29udGVudChub2RlLmlkLCBjb250ZW50LCBmb3JtYXQpOw0KDQogICAgcmV0dXJuIHsNCiAgICAgICAgb3JpZ2luYWxfZGF0YTogY29udGVudCwNCiAgICAgICAgZGlzcGxheWVkOiBjb250ZW50LA0KICAgICAgICBwcm9jZXNzZWRfZGF0YTogY29udGVudA0KICAgIH07DQp9DQoNCg0KLy8gUmVwZWF0ZXIgTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVJlcGVhdGVyTm9kZShlbmdpbmUsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpIHsNCiAgICBjb25zdCBpbnRlcnZhbCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLmludGVydmFsLnZhbHVlKTsNCiAgICBjb25zdCBjb3VudCA9IHBhcnNlSW50KG5vZGUuY29uZmlnLmNvdW50LnZhbHVlKTsNCg0KICAgIC8vIEluaXRpYWxpemUgcmVwZWF0ZXIgc3RhdGUgaWYgbm90IGV4aXN0cw0KICAgIGlmICghbm9kZS5yZXBlYXRlclN0YXRlKSB7DQogICAgICAgIG5vZGUucmVwZWF0ZXJTdGF0ZSA9IHsNCiAgICAgICAgICAgIGNvdW50OiAwLA0KICAgICAgICAgICAgaW50ZXJ2YWw6IG51bGwsDQogICAgICAgICAgICBpc1J1bm5pbmc6IGZhbHNlDQogICAgICAgIH07DQogICAgfQ0KDQogICAgLy8gSWYgdGhpcyBpcyBhIG1hbnVhbCB0cmlnZ2VyIChub3QgZnJvbSBpbnRlcnZhbCksIHN0YXJ0IHRoZSByZXBlYXRlcg0KICAgIGlmICghbm9kZS5yZXBlYXRlclN0YXRlLmlzUnVubmluZykgew0KICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUuaXNSdW5uaW5nID0gdHJ1ZTsNCiAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmNvdW50ID0gMDsNCg0KICAgICAgICAvLyBTdGFydCB0aGUgaW50ZXJ2YWwNCiAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmludGVydmFsID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4gew0KICAgICAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmNvdW50Kys7DQoNCiAgICAgICAgICAgIC8vIEV4ZWN1dGUgdGhlIGNvbm5lY3RlZCB3b3JrZmxvdw0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0ZWROb2RlcyA9IGZpbmRDb25uZWN0ZWROb2Rlcyhub2RlLmlkKTsNCiAgICAgICAgICAgICAgICBjb25zdCBleGVjdXRlZCA9IG5ldyBTZXQoKTsNCg0KICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29ubmVjdGVkTm9kZSBvZiBjb25uZWN0ZWROb2Rlcykgew0KICAgICAgICAgICAgICAgICAgICBhd2FpdCBleGVjdXRlTm9kZShjb25uZWN0ZWROb2RlLm5vZGUsIHsgdHJpZ2dlcjogRGF0ZS5ub3coKSB9LCBleGVjdXRlZCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBleGVjdXRpbmcgcmVwZWF0ZXIgd29ya2Zsb3c6JywgZXJyb3IpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBTdG9wIGlmIGNvdW50IGxpbWl0IHJlYWNoZWQNCiAgICAgICAgICAgIGlmIChjb3VudCA+IDAgJiYgbm9kZS5yZXBlYXRlclN0YXRlLmNvdW50ID49IGNvdW50KSB7DQogICAgICAgICAgICAgICAgZW5naW5lLnN0b3BSZXBlYXRlcihub2RlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwgaW50ZXJ2YWwpOw0KICAgIH0NCg0KICAgIHJldHVybiB7IHRyaWdnZXI6IERhdGUubm93KCksIGNvdW50OiBub2RlLnJlcGVhdGVyU3RhdGUuY291bnQsIGlzUnVubmluZzogbm9kZS5yZXBlYXRlclN0YXRlLmlzUnVubmluZyB9Ow0KfQ0KDQovLyBDb25kaXRpb24gTm9kZSBFeGVjdXRvcg0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUNvbmRpdGlvbk5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3Qgb3BlcmF0b3IgPSBub2RlLmNvbmZpZy5vcGVyYXRvci52YWx1ZTsNCiAgICBjb25zdCBjb21wYXJlVmFsdWUgPSBub2RlLmNvbmZpZy5jb21wYXJlX3ZhbHVlLnZhbHVlOw0KICAgIGNvbnN0IGNhc2VTZW5zaXRpdmUgPSBub2RlLmNvbmZpZy5jYXNlX3NlbnNpdGl2ZS52YWx1ZSA9PT0gJ3RydWUnOw0KDQogICAgbGV0IGlucHV0VmFsdWUgPSBpbnB1dERhdGEudmFsdWU7DQogICAgbGV0IHJlc3VsdCA9IGZhbHNlOw0KDQogICAgLy8gQ29udmVydCBpbnB1dCB0byBzdHJpbmcgZm9yIGNvbXBhcmlzb24gaWYgbmVlZGVkDQogICAgbGV0IGlucHV0U3RyID0gU3RyaW5nKGlucHV0VmFsdWUpOw0KICAgIGxldCBjb21wYXJlU3RyID0gU3RyaW5nKGNvbXBhcmVWYWx1ZSk7DQoNCiAgICAvLyBEZWJ1ZyBsb2dnaW5nIGZvciBzdHJpbmcgY29tcGFyaXNvbnMNCg0KICAgIC8vIEhhbmRsZSBjYXNlIHNlbnNpdGl2aXR5DQogICAgaWYgKCFjYXNlU2Vuc2l0aXZlKSB7DQogICAgICAgIGlucHV0U3RyID0gaW5wdXRTdHIudG9Mb3dlckNhc2UoKTsNCiAgICAgICAgY29tcGFyZVN0ciA9IGNvbXBhcmVTdHIudG9Mb3dlckNhc2UoKTsNCiAgICB9DQoNCiAgICAvLyBQZXJmb3JtIGNvbXBhcmlzb24gYmFzZWQgb24gb3BlcmF0b3INCiAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7DQogICAgICAgIGNhc2UgJ2VxdWFscyc6DQogICAgICAgICAgICByZXN1bHQgPSBpbnB1dFN0ciA9PT0gY29tcGFyZVN0cjsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdub3RfZXF1YWxzJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IGlucHV0U3RyICE9PSBjb21wYXJlU3RyOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2dyZWF0ZXJfdGhhbic6DQogICAgICAgICAgICByZXN1bHQgPSBOdW1iZXIoaW5wdXRWYWx1ZSkgPiBOdW1iZXIoY29tcGFyZVZhbHVlKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdsZXNzX3RoYW4nOg0KICAgICAgICAgICAgcmVzdWx0ID0gTnVtYmVyKGlucHV0VmFsdWUpIDwgTnVtYmVyKGNvbXBhcmVWYWx1ZSk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnZ3JlYXRlcl90aGFuX29yX2VxdWFsJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IE51bWJlcihpbnB1dFZhbHVlKSA+PSBOdW1iZXIoY29tcGFyZVZhbHVlKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdsZXNzX3RoYW5fb3JfZXF1YWwnOg0KICAgICAgICAgICAgcmVzdWx0ID0gTnVtYmVyKGlucHV0VmFsdWUpIDw9IE51bWJlcihjb21wYXJlVmFsdWUpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2NvbnRhaW5zJzoNCiAgICAgICAgICAgIHJlc3VsdCA9IGlucHV0U3RyLmluY2x1ZGVzKGNvbXBhcmVTdHIpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ25vdF9jb250YWlucyc6DQogICAgICAgICAgICByZXN1bHQgPSAhaW5wdXRTdHIuaW5jbHVkZXMoY29tcGFyZVN0cik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnc3RhcnRzX3dpdGgnOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIuc3RhcnRzV2l0aChjb21wYXJlU3RyKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdlbmRzX3dpdGgnOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIuZW5kc1dpdGgoY29tcGFyZVN0cik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnaXNfZW1wdHknOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIudHJpbSgpID09PSAnJzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdpc19ub3RfZW1wdHknOg0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRTdHIudHJpbSgpICE9PSAnJzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7DQogICAgfQ0KDQogICAgLy8gU3RvcmUgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgbm9kZS5sYXN0SW5wdXRWYWx1ZSA9IGlucHV0VmFsdWU7DQogICAgbm9kZS5sYXN0Q29tcGFyZVZhbHVlID0gY29tcGFyZVZhbHVlOw0KICAgIG5vZGUubGFzdFJlc3VsdCA9IHJlc3VsdDsNCiAgICBub2RlLmxhc3RPcGVyYXRvciA9IG9wZXJhdG9yOw0KDQogICAgcmV0dXJuIHsgcmVzdWx0OiByZXN1bHQgfTsNCn0NCg0KLy8gTG9naWNhbCBHYXRlIE5vZGUgRXhlY3V0b3INCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVMb2dpY2FsR2F0ZU5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgaW52ZXJ0ID0gbm9kZS5jb25maWcuaW52ZXJ0LnZhbHVlID09PSAndHJ1ZSc7DQogICAgY29uc3QgZGVzY3JpcHRpb24gPSBub2RlLmNvbmZpZy5kZXNjcmlwdGlvbi52YWx1ZTsNCg0KICAgIGxldCBjb25kaXRpb24gPSBpbnB1dERhdGEuY29uZGl0aW9uOw0KDQogICAgLy8gQ29udmVydCB0byBib29sZWFuIGlmIG5lZWRlZA0KICAgIGlmICh0eXBlb2YgY29uZGl0aW9uID09PSAnc3RyaW5nJykgew0KICAgICAgICBjb25kaXRpb24gPSBjb25kaXRpb24udG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnOw0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbmRpdGlvbiA9PT0gJ251bWJlcicpIHsNCiAgICAgICAgY29uZGl0aW9uID0gY29uZGl0aW9uICE9PSAwOw0KICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbmRpdGlvbiA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgLy8gSWYgaXQncyBhbiBvYmplY3Qgd2l0aCBhIHJlc3VsdCBmaWVsZCAoZnJvbSBjb25kaXRpb24gbm9kZSkNCiAgICAgICAgY29uZGl0aW9uID0gY29uZGl0aW9uLnJlc3VsdCA9PT0gdHJ1ZTsNCiAgICB9DQoNCiAgICAvLyBBcHBseSBpbnZlcnNpb24gaWYgY29uZmlndXJlZA0KICAgIGlmIChpbnZlcnQpIHsNCiAgICAgICAgY29uZGl0aW9uID0gIWNvbmRpdGlvbjsNCiAgICB9DQoNCiAgICAvLyBTdG9yZSBmb3IgZGlzcGxheSBpbiBjb25maWcgcGFuZWwNCiAgICBub2RlLmxhc3RDb25kaXRpb24gPSBjb25kaXRpb247DQogICAgbm9kZS5sYXN0SW52ZXJ0ZWQgPSBpbnZlcnQ7DQogICAgbm9kZS5sYXN0RGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjsNCg0KICAgIC8vIE9ubHkgcmV0dXJuIHRyaWdnZXIgaWYgY29uZGl0aW9uIGlzIHRydWUNCiAgICBpZiAoY29uZGl0aW9uKSB7DQogICAgICAgIHJldHVybiB7IHRyaWdnZXI6IERhdGUubm93KCkgfTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBSZXR1cm4gc3BlY2lhbCBvYmplY3QgdG8gaW5kaWNhdGUgZXhlY3V0aW9uIHNob3VsZCBzdG9wDQogICAgICAgIHJldHVybiB7IF9fc3RvcF9leGVjdXRpb246IHRydWUgfTsNCiAgICB9DQp9DQoNCi8vIEV4cG9ydCB0byBnbG9iYWwgc2NvcGUNCndpbmRvdy5mbG93RXhlY3V0b3JzID0gew0KICAgIGV4ZWN1dGVUaW1lck5vZGUsDQogICAgZXhlY3V0ZURpc3BsYXlOb2RlLA0KICAgIGV4ZWN1dGVSZXBlYXRlck5vZGUsDQogICAgZXhlY3V0ZUNvbmRpdGlvbk5vZGUsDQogICAgZXhlY3V0ZUxvZ2ljYWxHYXRlTm9kZQ0KfTsNCg0KDQovLyBMTE0gQ2hhdCBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlTGxtQ2hhdE5vZGUoZW5naW5lLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgY29uc3QgZW5kcG9pbnQgPSBub2RlLmNvbmZpZy5lbmRwb2ludC52YWx1ZTsNCiAgICBjb25zdCBtb2RlbCA9IG5vZGUuY29uZmlnLm1vZGVsLnZhbHVlOw0KICAgIGNvbnN0IHRlbXBlcmF0dXJlID0gcGFyc2VGbG9hdChub2RlLmNvbmZpZy50ZW1wZXJhdHVyZS52YWx1ZSk7DQogICAgY29uc3QgbWF4VG9rZW5zID0gcGFyc2VJbnQobm9kZS5jb25maWcubWF4X3Rva2Vucy52YWx1ZSk7DQogICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gbm9kZS5jb25maWcuc3lzdGVtX3Byb21wdC52YWx1ZTsNCiAgICBjb25zdCBpbmNsdWRlQ29udGV4dCA9IG5vZGUuY29uZmlnLmluY2x1ZGVfY29udGV4dC52YWx1ZSA9PT0gJ3RydWUnOw0KDQogICAgLy8gQWNjZXB0IHByb21wdCBmcm9tIGVpdGhlciAncHJvbXB0JyBvciAndGV4dCcgaW5wdXQNCiAgICBsZXQgcHJvbXB0ID0gaW5wdXREYXRhLnByb21wdDsNCiAgICBpZiAoIXByb21wdCAmJiBpbnB1dERhdGEudGV4dCkgew0KICAgICAgICBwcm9tcHQgPSBpbnB1dERhdGEudGV4dDsNCiAgICB9DQogICAgaWYgKCFwcm9tcHQgJiYgaW5wdXREYXRhLmNvbnRleHQpIHsNCiAgICAgICAgLy8gSWYgY29udGV4dCBpcyBhIHN0cmluZywgdXNlIGl0IGFzIHByb21wdA0KICAgICAgICBpZiAodHlwZW9mIGlucHV0RGF0YS5jb250ZXh0ID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgcHJvbXB0ID0gaW5wdXREYXRhLmNvbnRleHQ7DQogICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhLmNvbnRleHQgJiYgdHlwZW9mIGlucHV0RGF0YS5jb250ZXh0ID09PSAnb2JqZWN0JyAmJiBpbnB1dERhdGEuY29udGV4dC50ZXh0KSB7DQogICAgICAgICAgICAvLyBJZiBjb250ZXh0IGlzIGFuIG9iamVjdCB3aXRoIHRleHQgZmllbGQsIHVzZSB0aGF0DQogICAgICAgICAgICBwcm9tcHQgPSBpbnB1dERhdGEuY29udGV4dC50ZXh0Ow0KICAgICAgICB9DQogICAgfQ0KICAgIGlmICghcHJvbXB0KSB7DQogICAgICAgIHRocm93IG5ldyBFcnJvcignTExNIENoYXQgcmVxdWlyZXMgYSBwcm9tcHQgaW5wdXQuIENvbm5lY3QgYSBUZXh0IG5vZGUgdG8gcHJvdmlkZSB0aGUgcHJvbXB0LicpOw0KICAgIH0NCg0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IG1lc3NhZ2VzID0gW107DQoNCiAgICAgICAgaWYgKHN5c3RlbVByb21wdCkgew0KICAgICAgICAgICAgbWVzc2FnZXMucHVzaCh7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBzeXN0ZW1Qcm9tcHQgfSk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaW5jbHVkZUNvbnRleHQgJiYgaW5wdXREYXRhLmNvbnRleHQpIHsNCiAgICAgICAgICAgIG1lc3NhZ2VzLnB1c2goeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IGBDb250ZXh0OiAke0pTT04uc3RyaW5naWZ5KGlucHV0RGF0YS5jb250ZXh0KX1cblxuUHJvbXB0OiAke3Byb21wdH1gIH0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgbWVzc2FnZXMucHVzaCh7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH0pOw0KICAgICAgICB9DQoNCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtlbmRwb2ludH0vY2hhdC9jb21wbGV0aW9uc2AsIHsNCiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLA0KICAgICAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7DQogICAgICAgICAgICAgICAgbW9kZWw6IG1vZGVsLA0KICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBtZXNzYWdlcywNCiAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogdGVtcGVyYXR1cmUsDQogICAgICAgICAgICAgICAgbWF4X3Rva2VuczogbWF4VG9rZW5zDQogICAgICAgICAgICB9KQ0KICAgICAgICB9KTsNCg0KICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpOw0KDQogICAgICAgIGlmIChkYXRhLmVycm9yKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZGF0YS5lcnJvci5tZXNzYWdlIHx8ICdMTE0gQVBJIGVycm9yJyk7DQogICAgICAgIH0NCg0KICAgICAgICBjb25zdCByZXNwb25zZVRleHQgPSBkYXRhLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgJyc7DQoNCiAgICAgICAgLy8gU3RvcmUgZm9yIGRpc3BsYXkgaW4gY29uZmlnIHBhbmVsDQogICAgICAgIG5vZGUubGFzdFJlc3BvbnNlID0gcmVzcG9uc2VUZXh0Ow0KICAgICAgICBub2RlLmxhc3RVc2FnZSA9IGRhdGEudXNhZ2U7DQogICAgICAgIG5vZGUubGFzdE1vZGVsID0gbW9kZWw7DQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHJlc3BvbnNlOiByZXNwb25zZVRleHQsDQogICAgICAgICAgICB0b2tlbnNfdXNlZDogZGF0YS51c2FnZT8udG90YWxfdG9rZW5zIHx8IDAsDQogICAgICAgICAgICBtb2RlbF91c2VkOiBtb2RlbCwNCiAgICAgICAgICAgIGZ1bGxfcmVzcG9uc2U6IGRhdGENCiAgICAgICAgfTsNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdMTE0gQ2hhdCBlcnJvcjonLCBlcnJvcik7DQogICAgICAgIHJldHVybiB7IHJlc3BvbnNlOiBudWxsLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9Ow0KICAgIH0NCn0NCg0KDQovLyBUZXJtaW5hbCBOb2RlIEV4ZWN1dG9yDQphc3luYyBmdW5jdGlvbiBleGVjdXRlVGVybWluYWxOb2RlKGVuZ2luZSwgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGNvbnN0IGNvbW1hbmQgPSBub2RlLmNvbmZpZy5jb21tYW5kLnZhbHVlOw0KICAgIGNvbnN0IHVzZUlucHV0Q29tbWFuZCA9IG5vZGUuY29uZmlnLnVzZV9pbnB1dF9jb21tYW5kLnZhbHVlID09PSAndHJ1ZSc7DQogICAgY29uc3Qgd29ya2luZ0RpcmVjdG9yeSA9IG5vZGUuY29uZmlnLndvcmtpbmdfZGlyZWN0b3J5LnZhbHVlOw0KICAgIGNvbnN0IHRpbWVvdXQgPSBwYXJzZUludChub2RlLmNvbmZpZy50aW1lb3V0LnZhbHVlKTsNCg0KICAgIGxldCBmaW5hbENvbW1hbmQgPSBjb21tYW5kOw0KICAgIGlmICh1c2VJbnB1dENvbW1hbmQgJiYgaW5wdXREYXRhLmNvbW1hbmQpIHsNCiAgICAgICAgZmluYWxDb21tYW5kID0gaW5wdXREYXRhLmNvbW1hbmQ7DQogICAgfQ0KDQogICAgdHJ5IHsNCiAgICAgICAgLy8gVGhpcyB3b3VsZCBuZWVkIHRvIGJlIGltcGxlbWVudGVkIHdpdGggYWN0dWFsIHRlcm1pbmFsIGV4ZWN1dGlvbg0KICAgICAgICAvLyBGb3Igbm93LCB3ZSdsbCByZXR1cm4gYSBwbGFjZWhvbGRlcg0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBvdXRwdXQ6IGBDb21tYW5kIGV4ZWN1dGVkOiAke2ZpbmFsQ29tbWFuZH1gLA0KICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSwNCiAgICAgICAgICAgIGVycm9yOiBudWxsLA0KICAgICAgICAgICAgZXhpdF9jb2RlOiAwDQogICAgICAgIH07DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVGVybWluYWwgZXhlY3V0aW9uIGVycm9yOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIG91dHB1dDogbnVsbCwNCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLA0KICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsDQogICAgICAgICAgICBleGl0X2NvZGU6IDENCiAgICAgICAgfTsNCiAgICB9DQp9DQoNCi8vIEV4cG9ydCB0byBnbG9iYWwgc2NvcGUNCndpbmRvdy5haUV4ZWN1dG9ycyA9IHsNCiAgICBleGVjdXRlTGxtQ2hhdE5vZGUsDQogICAgZXhlY3V0ZVRlcm1pbmFsTm9kZQ0KfTsNCg0KLy8gZXhlY3V0aW9uLWVuZ2luZS5qcyAtIER5bmFtaWMgZXhlY3V0aW9uIGVuZ2luZSBmb3IgRmxvdyBFZGl0b3INCg0KY2xhc3MgRXhlY3V0aW9uRW5naW5lIHsNCiAgICBjb25zdHJ1Y3RvcihyZWdpc3RyeSkgew0KICAgICAgICB0aGlzLnJlZ2lzdHJ5ID0gcmVnaXN0cnk7DQogICAgICAgIHRoaXMuc2V0dXBFeGVjdXRvcnMoKTsNCiAgICB9DQoNCiAgICBzZXR1cEV4ZWN1dG9ycygpIHsNCiAgICAgICAgLy8gUmVnaXN0ZXIgZXhlY3V0b3JzIGZyb20gZXh0ZXJuYWwgZmlsZXMgd2l0aCBlbmdpbmUgaW5zdGFuY2UgcGFzc2VkIGFzIGZpcnN0IHBhcmFtZXRlcg0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2h0dHBfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuaHR0cEV4ZWN1dG9ycy5leGVjdXRlSHR0cE5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3Zmc19zYXZlX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93Lmh0dHBFeGVjdXRvcnMuZXhlY3V0ZVZmc1NhdmVOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd2ZnNfbG9hZF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5odHRwRXhlY3V0b3JzLmV4ZWN1dGVWZnNMb2FkTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgICAgICANCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd0aW1lcl9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5mbG93RXhlY3V0b3JzLmV4ZWN1dGVUaW1lck5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2Rpc3BsYXlfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZmxvd0V4ZWN1dG9ycy5leGVjdXRlRGlzcGxheU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3JlcGVhdGVyX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmZsb3dFeGVjdXRvcnMuZXhlY3V0ZVJlcGVhdGVyTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignY29uZGl0aW9uX2V4ZWN1dG9yJywgKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpID0+IA0KICAgICAgICAgICAgd2luZG93LmZsb3dFeGVjdXRvcnMuZXhlY3V0ZUNvbmRpdGlvbk5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ2xvZ2ljYWxfZ2F0ZV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5mbG93RXhlY3V0b3JzLmV4ZWN1dGVMb2dpY2FsR2F0ZU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICAgICAgDQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignYXVkaW9fZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cubWVkaWFFeGVjdXRvcnMuZXhlY3V0ZUF1ZGlvTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignaW1hZ2VfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cubWVkaWFFeGVjdXRvcnMuZXhlY3V0ZUltYWdlTm9kZSh0aGlzLCBub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSk7DQogICAgICAgICAgICANCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdqc29uX2V4dHJhY3RfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZGF0YUV4ZWN1dG9ycy5leGVjdXRlSnNvbkV4dHJhY3ROb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCdyYW5kb21fbGluZV9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5kYXRhRXhlY3V0b3JzLmV4ZWN1dGVSYW5kb21RdW90ZU5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyRXhlY3V0b3IoJ3RleHRfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuZGF0YUV4ZWN1dG9ycy5leGVjdXRlVGV4dE5vZGUodGhpcywgbm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkpOw0KICAgICAgICAgICAgDQogICAgICAgIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJFeGVjdXRvcignbGxtX2NoYXRfZXhlY3V0b3InLCAobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgPT4gDQogICAgICAgICAgICB3aW5kb3cuYWlFeGVjdXRvcnMuZXhlY3V0ZUxsbUNoYXROb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICAgICAgdGhpcy5yZWdpc3RyeS5yZWdpc3RlckV4ZWN1dG9yKCd0ZXJtaW5hbF9leGVjdXRvcicsIChub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSA9PiANCiAgICAgICAgICAgIHdpbmRvdy5haUV4ZWN1dG9ycy5leGVjdXRlVGVybWluYWxOb2RlKHRoaXMsIG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpKTsNCiAgICB9DQoNCiAgICBhc3luYyBleGVjdXRlTm9kZShub2RlLCBpbnB1dERhdGEsIGV4ZWN1dGVkKSB7DQogICAgICAgIGNvbnN0IG5vZGVEZWYgPSB0aGlzLnJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgICAgIGlmICghbm9kZURlZikgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBub2RlIGRlZmluaXRpb24gZm91bmQgZm9yIHR5cGU6ICR7bm9kZS50eXBlfWApOw0KICAgICAgICB9DQoNCiAgICAgICAgY29uc3QgZXhlY3V0b3JOYW1lID0gbm9kZURlZi5leGVjdXRvcjsNCiAgICAgICAgY29uc3QgZXhlY3V0b3IgPSB0aGlzLnJlZ2lzdHJ5LmdldEV4ZWN1dG9yKGV4ZWN1dG9yTmFtZSk7DQoNCiAgICAgICAgaWYgKCFleGVjdXRvcikgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBleGVjdXRvciBmb3VuZCBmb3I6ICR7ZXhlY3V0b3JOYW1lfWApOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGF3YWl0IGV4ZWN1dG9yKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpOw0KICAgIH0NCg0KDQoNCiAgICAvLyBTdG9wIHJlcGVhdGVyIG1ldGhvZA0KICAgIHN0b3BSZXBlYXRlcihub2RlKSB7DQogICAgICAgIGlmIChub2RlLnJlcGVhdGVyU3RhdGUgJiYgbm9kZS5yZXBlYXRlclN0YXRlLmludGVydmFsKSB7DQogICAgICAgICAgICBjbGVhckludGVydmFsKG5vZGUucmVwZWF0ZXJTdGF0ZS5pbnRlcnZhbCk7DQogICAgICAgICAgICBub2RlLnJlcGVhdGVyU3RhdGUuaW50ZXJ2YWwgPSBudWxsOw0KICAgICAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlLmlzUnVubmluZyA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQoNCg0KDQp9DQoNCi8vIEdsb2JhbCBleGVjdXRpb24gZW5naW5lIGluc3RhbmNlDQpjb25zdCBleGVjdXRpb25FbmdpbmUgPSBuZXcgRXhlY3V0aW9uRW5naW5lKG5vZGVSZWdpc3RyeSk7DQoNCg0KLy8gd29ya2Zsb3cuanMgLSBXb3JrZmxvdyBleGVjdXRpb24gbG9naWMgZm9yIEZsb3cgRWRpdG9yDQoNCi8vIFJ1biB0aGUgd29ya2Zsb3cNCmFzeW5jIGZ1bmN0aW9uIHJ1bldvcmtmbG93KCkgew0KICAgIGlmIChmbG93RWRpdG9yLmlzUnVubmluZykgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGZsb3dFZGl0b3IuaXNSdW5uaW5nID0gdHJ1ZTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncnVuLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcC13b3JrZmxvdycpLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWZsZXgnOw0KICAgIA0KICAgIC8vIENsZWFyIG91dHB1dA0KICAgIGNvbnN0IG91dHB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleGVjdXRpb24tb3V0cHV0Jyk7DQogICAgb3V0cHV0LmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPSJsb2ctZW50cnkgaW5mbyI+U3RhcnRpbmcgd29ya2Zsb3cgZXhlY3V0aW9uLi4uPC9kaXY+JzsNCiAgICANCiAgICB0cnkgew0KICAgICAgICAvLyBGaW5kIHN0YXJ0IG5vZGVzIChub2RlcyB3aXRoIG5vIGlucHV0cyB0aGF0IGFyZSBwYXJ0IG9mIGEgY29ubmVjdGVkIHdvcmtmbG93KQ0KICAgICAgICBjb25zdCBzdGFydE5vZGVzID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLm5vZGVzLnZhbHVlcygpKS5maWx0ZXIobm9kZSA9PiB7DQogICAgICAgICAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKG5vZGUudHlwZSk7DQogICAgICAgICAgICBpZiAoIW5vZGVEZWYpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYE5vIG5vZGUgZGVmaW5pdGlvbiBmb3VuZCBmb3IgdHlwZTogJHtub2RlLnR5cGV9YCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFRpbWVyIGFuZCBSZXBlYXRlciBub2RlcyBhcmUgc3RhcnQgbm9kZXMgKGNhbiB0cmlnZ2VyIHRoZW1zZWx2ZXMpDQogICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAndGltZXInIHx8IG5vZGUudHlwZSA9PT0gJ3JlcGVhdGVyJykgew0KICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNSdW5uaW5nID0gbm9kZS5yZXBlYXRlclN0YXRlICYmIG5vZGUucmVwZWF0ZXJTdGF0ZS5pc1J1bm5pbmc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vIFRpbWVyL1JlcGVhdGVyIGlzIGEgc3RhcnQgbm9kZSBpZiBpdCBoYXMgY29ubmVjdGVkIG91dHB1dHMNCiAgICAgICAgICAgICAgICBjb25zdCBoYXNDb25uZWN0ZWRPdXRwdXRzID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5zb21lKGNvbm4gPT4gDQogICAgICAgICAgICAgICAgICAgIGNvbm4uZnJvbS5ub2RlSWQgPT09IG5vZGUuaWQNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIHJldHVybiBoYXNDb25uZWN0ZWRPdXRwdXRzOyAvLyBUaW1lci9SZXBlYXRlciBpcyBhIHN0YXJ0IG5vZGUgaWYgY29ubmVjdGVkDQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIElmIG5vZGUgaGFzIG5vIGlucHV0cywgY2hlY2sgaWYgaXQncyBwYXJ0IG9mIGEgY29ubmVjdGVkIHdvcmtmbG93DQogICAgICAgICAgICBpZiAobm9kZURlZi5pbnB1dHMubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBub2RlIGhhcyBhbnkgb3V0cHV0cyB0aGF0IGFyZSBjb25uZWN0ZWQgdG8gb3RoZXIgbm9kZXMNCiAgICAgICAgICAgICAgICBjb25zdCBoYXNDb25uZWN0ZWRPdXRwdXRzID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLmNvbm5lY3Rpb25zLnZhbHVlcygpKS5zb21lKGNvbm4gPT4gDQogICAgICAgICAgICAgICAgICAgIGNvbm4uZnJvbS5ub2RlSWQgPT09IG5vZGUuaWQNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIE9ubHkgaW5jbHVkZSBpZiBpdCdzIGNvbm5lY3RlZCB0byB0aGUgd29ya2Zsb3cNCiAgICAgICAgICAgICAgICByZXR1cm4gaGFzQ29ubmVjdGVkT3V0cHV0czsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3Igbm9kZXMgd2l0aCBvcHRpb25hbCBpbnB1dHMNCiAgICAgICAgICAgIGNvbnN0IG9wdGlvbmFsSW5wdXRzID0gbm9kZURlZi5pbnB1dHMuZmlsdGVyKGlucHV0ID0+IGlucHV0Lm9wdGlvbmFsKTsNCiAgICAgICAgICAgIGlmIChvcHRpb25hbElucHV0cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBub2RlIGhhcyBjb25uZWN0ZWQgb3V0cHV0cw0KICAgICAgICAgICAgICAgIGNvbnN0IGhhc0Nvbm5lY3RlZE91dHB1dHMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLnNvbWUoY29ubiA9PiANCiAgICAgICAgICAgICAgICAgICAgY29ubi5mcm9tLm5vZGVJZCA9PT0gbm9kZS5pZA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGhhc0Nvbm5lY3RlZE91dHB1dHM7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIE5vZGVzIHdpdGggcmVxdWlyZWQgaW5wdXRzIGFyZSBub3Qgc3RhcnQgbm9kZXMgLSB0aGV5IHNob3VsZCBiZSB0cmlnZ2VyZWQgYnkgb3RoZXIgbm9kZXMNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICBpZiAoc3RhcnROb2Rlcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gc3RhcnQgbm9kZXMgZm91bmQuIEFkZCBub2RlcyB3aXRoIG5vIGlucHV0cyAoVGltZXIpIG9yIG5vZGVzIHdpdGggb3B0aW9uYWwgaW5wdXRzIHRoYXQgYXJlblwndCBjb25uZWN0ZWQgKEhUVFAgUmVxdWVzdCknKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gRXhlY3V0ZSB3b3JrZmxvdw0KICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZXhlY3V0ZVdvcmtmbG93KHN0YXJ0Tm9kZXMpOw0KICAgICAgICANCiAgICAgICAgLy8gRGlzcGxheSByZXN1bHRzDQogICAgICAgIG91dHB1dC5pbm5lckhUTUwgKz0gJzxkaXYgY2xhc3M9ImxvZy1lbnRyeSBzdWNjZXNzIj5Xb3JrZmxvdyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5ITwvZGl2Pic7DQogICAgICAgIGZvciAoY29uc3QgcmVzdWx0IG9mIHJlc3VsdHMpIHsNCiAgICAgICAgICAgIG91dHB1dC5pbm5lckhUTUwgKz0gYDxkaXYgY2xhc3M9ImxvZy1lbnRyeSBpbmZvIj4ke3Jlc3VsdC5ub2RlSWR9OiAke3Jlc3VsdC5vdXRwdXR9PC9kaXY+YDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gU2VuZCBjb21wbGV0aW9uIHZpYSBXZWJTb2NrZXQNCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2VuZE1lc3NhZ2UpIHsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zZW5kTWVzc2FnZSgnd29ya2Zsb3dfY29tcGxldGVkJywgew0KICAgICAgICAgICAgICAgIHJlc3VsdHM6IHJlc3VsdHMsDQogICAgICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpDQogICAgICAgICAgICB9LCAnZmxvdy1lZGl0b3InKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdXb3JrZmxvdyBleGVjdXRpb24gZXJyb3I6JywgZXJyb3IpOw0KICAgICAgICBvdXRwdXQuaW5uZXJIVE1MICs9IGA8ZGl2IGNsYXNzPSJsb2ctZW50cnkgZXJyb3IiPkVycm9yOiAke2Vycm9yLm1lc3NhZ2V9PC9kaXY+YDsNCiAgICB9IGZpbmFsbHkgew0KICAgICAgICBmbG93RWRpdG9yLmlzUnVubmluZyA9IGZhbHNlOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncnVuLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtZmxleCc7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9wLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICB9DQp9DQoNCi8vIEV4ZWN1dGUgd29ya2Zsb3cNCmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVXb3JrZmxvdyhzdGFydE5vZGVzKSB7DQogICAgY29uc3QgcmVzdWx0cyA9IFtdOw0KICAgIGNvbnN0IGV4ZWN1dGVkID0gbmV3IFNldCgpOw0KICAgIA0KICAgIGZvciAoY29uc3Qgc3RhcnROb2RlIG9mIHN0YXJ0Tm9kZXMpIHsNCiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0ZU5vZGUoc3RhcnROb2RlLCB7fSwgZXhlY3V0ZWQpOw0KICAgICAgICBpZiAocmVzdWx0KSByZXN1bHRzLnB1c2gocmVzdWx0KTsNCiAgICB9DQogICAgDQogICAgcmV0dXJuIHJlc3VsdHM7DQp9DQoNCi8vIEV4ZWN1dGUgYSBzaW5nbGUgbm9kZSAoZHluYW1pYyB2ZXJzaW9uKQ0KYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZU5vZGUobm9kZSwgaW5wdXREYXRhLCBleGVjdXRlZCkgew0KICAgIGlmIChleGVjdXRlZC5oYXMobm9kZS5pZCkpIHsNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIGV4ZWN1dGVkLmFkZChub2RlLmlkKTsNCiAgICANCiAgICAvLyBNYXJrIG5vZGUgYXMgcnVubmluZw0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZS5pZCk7DQogICAgaWYgKG5vZGVFbGVtZW50KSBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdydW5uaW5nJyk7DQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgLy8gVXNlIHRoZSBkeW5hbWljIGV4ZWN1dGlvbiBlbmdpbmUNCiAgICAgICAgY29uc3Qgb3V0cHV0ID0gYXdhaXQgZXhlY3V0aW9uRW5naW5lLmV4ZWN1dGVOb2RlKG5vZGUsIGlucHV0RGF0YSwgZXhlY3V0ZWQpOw0KICAgICAgICANCiAgICAgICAgLy8gQ2hlY2sgaWYgb3V0cHV0IGluZGljYXRlcyBleGVjdXRpb24gc2hvdWxkIHN0b3AgKGxvZ2ljYWwgZ2F0ZSBzcGVjaWZpYykNCiAgICAgICAgaWYgKG91dHB1dCAmJiB0eXBlb2Ygb3V0cHV0ID09PSAnb2JqZWN0JyAmJiBvdXRwdXQuX19zdG9wX2V4ZWN1dGlvbiA9PT0gdHJ1ZSkgew0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBNYXJrIG5vZGUgYXMgY29tcGxldGVkDQogICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJyk7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIHJldHVybiB7IG5vZGVJZDogbm9kZS5pZCwgb3V0cHV0OiBudWxsIH07DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEZpbmQgY29ubmVjdGVkIG5vZGVzIGFuZCBleGVjdXRlIHRoZW0NCiAgICAgICAgY29uc3QgY29ubmVjdGVkTm9kZXMgPSBmaW5kQ29ubmVjdGVkTm9kZXMobm9kZS5pZCk7DQogICAgICAgIA0KICAgICAgICBmb3IgKGNvbnN0IGNvbm5lY3RlZE5vZGUgb2YgY29ubmVjdGVkTm9kZXMpIHsNCiAgICAgICAgICAgIC8vIENoZWNrIGZvciBjeWNsZXMgYmVmb3JlIGV4ZWN1dGluZw0KICAgICAgICAgICAgaWYgKGV4ZWN1dGVkLmhhcyhjb25uZWN0ZWROb2RlLm5vZGUuaWQpKSB7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gSGFuZGxlIG91dHB1dCBtYXBwaW5nIHRvIGlucHV0IHBvcnRzIC0gRElSRUNUIE1BUFBJTkcNCiAgICAgICAgICAgIGxldCBpbnB1dFZhbHVlID0gb3V0cHV0Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAob3V0cHV0IGluc3RhbmNlb2YgQmxvYikgew0KICAgICAgICAgICAgICAgIC8vIEJsb2Igb3V0cHV0IC0gcGFzcyBkaXJlY3RseSB0byB0aGUgaW5wdXQgcG9ydA0KICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBvdXRwdXQ7DQogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvdXRwdXQgPT09ICdvYmplY3QnICYmIG91dHB1dCAhPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIC8vIE9iamVjdCBvdXRwdXQgLSBleHRyYWN0IHRoZSBFWEFDVCBvdXRwdXQgcG9ydCBmaWVsZA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChjb25uZWN0ZWROb2RlLm91dHB1dFBvcnQgaW4gb3V0cHV0KSB7DQogICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBvdXRwdXRbY29ubmVjdGVkTm9kZS5vdXRwdXRQb3J0XTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBOb2RlICR7bm9kZS5pZH0gLT4gJHtjb25uZWN0ZWROb2RlLm5vZGUuaWR9OiBFUlJPUiAtIE91dHB1dCBwb3J0ICcke2Nvbm5lY3RlZE5vZGUub3V0cHV0UG9ydH0nIG5vdCBmb3VuZCBpbiBvdXRwdXQhYCk7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEF2YWlsYWJsZSBmaWVsZHM6YCwgT2JqZWN0LmtleXMob3V0cHV0KSk7DQogICAgICAgICAgICAgICAgICAgIC8vIFNraXAgdGhpcyBjb25uZWN0aW9uIGluc3RlYWQgb2YgcGFzc2luZyBudWxsDQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy8gU2ltcGxlIHZhbHVlIG91dHB1dCAtIHBhc3MgZGlyZWN0bHkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIGF3YWl0IGV4ZWN1dGVOb2RlKGNvbm5lY3RlZE5vZGUubm9kZSwgeyBbY29ubmVjdGVkTm9kZS5pbnB1dFBvcnRdOiBpbnB1dFZhbHVlIH0sIGV4ZWN1dGVkKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZXhlY3V0aW5nIGNvbm5lY3RlZCBub2RlICR7Y29ubmVjdGVkTm9kZS5ub2RlLmlkfTpgLCBlcnJvcik7DQogICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0UGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhlY3V0aW9uLW91dHB1dCcpOw0KICAgICAgICAgICAgICAgIG91dHB1dFBhbmVsLmlubmVySFRNTCArPSBgPGRpdiBjbGFzcz0ibG9nLWVudHJ5IGVycm9yIj5FcnJvciBpbiBjb25uZWN0ZWQgbm9kZSAke2Nvbm5lY3RlZE5vZGUubm9kZS5pZH06ICR7ZXJyb3IubWVzc2FnZX08L2Rpdj5gOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBNYXJrIG5vZGUgYXMgY29tcGxldGVkDQogICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHJldHVybiB7IG5vZGVJZDogbm9kZS5pZCwgb3V0cHV0OiBvdXRwdXQgfTsNCiAgICAgICAgDQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZXhlY3V0aW5nIG5vZGUgJHtub2RlLmlkfTpgLCBlcnJvcik7DQogICAgICAgIA0KICAgICAgICAvLyBNYXJrIG5vZGUgYXMgZXJyb3INCiAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJyk7DQogICAgICAgICAgICBub2RlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlcnJvcicpOw0KICAgIH0NCiAgICANCiAgICAgICAgdGhyb3cgZXJyb3I7DQogICAgfSBmaW5hbGx5IHsNCiAgICAgICAgLy8gUmVtb3ZlIHJ1bm5pbmcgc3RhdGUNCiAgICAgICAgaWYgKG5vZGVFbGVtZW50KSBub2RlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdydW5uaW5nJyk7DQogICAgfQ0KICAgIH0NCiAgICANCi8vIEhlbHBlciBmdW5jdGlvbiB0byB1cGRhdGUgZGlzcGxheSBub2RlIGNvbnRlbnQgKHVzZWQgYnkgZXhlY3V0aW9uIGVuZ2luZSkNCmZ1bmN0aW9uIHVwZGF0ZURpc3BsYXlOb2RlQ29udGVudChub2RlSWQsIGNvbnRlbnQsIGZvcm1hdCkgew0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZUlkKTsNCiAgICBpZiAoIW5vZGVFbGVtZW50KSByZXR1cm47DQogICAgDQogICAgY29uc3QgZGlzcGxheVRleHQgPSBub2RlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZGlzcGxheS10ZXh0Jyk7DQogICAgY29uc3QgZm9ybWF0RWxlbWVudCA9IG5vZGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kaXNwbGF5LWZvcm1hdCBzcGFuJyk7DQogICAgDQogICAgaWYgKGRpc3BsYXlUZXh0KSB7DQogICAgICAgIGxldCBmb3JtYXR0ZWRDb250ZW50ID0gY29udGVudDsNCiAgICAgICAgDQogICAgc3dpdGNoIChmb3JtYXQpIHsNCiAgICAgICAgY2FzZSAnanNvbic6DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWQgPSB0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKGNvbnRlbnQpIDogY29udGVudDsNCiAgICAgICAgICAgICAgICAgICAgZm9ybWF0dGVkQ29udGVudCA9IEpTT04uc3RyaW5naWZ5KHBhcnNlZCwgbnVsbCwgMik7DQogICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2h0bWwnOg0KICAgICAgICAgICAgICAgIGZvcm1hdHRlZENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ3RleHQnOg0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIGZvcm1hdHRlZENvbnRlbnQgPSBjb250ZW50Ow0KICAgICAgICAgICAgYnJlYWs7DQogICAgfQ0KICAgIA0KICAgICAgICBkaXNwbGF5VGV4dC5pbm5lckhUTUwgPSBgPHByZSBjbGFzcz0iY29udGVudC10ZXh0Ij4ke2VzY2FwZUh0bWwoZm9ybWF0dGVkQ29udGVudCl9PC9wcmU+YDsNCiAgICB9DQogICAgDQogICAgaWYgKGZvcm1hdEVsZW1lbnQpIHsNCiAgICAgICAgZm9ybWF0RWxlbWVudC50ZXh0Q29udGVudCA9IGZvcm1hdDsNCiAgICB9DQogICAgDQogICAgLy8gU3RvcmUgZm9yIGNvbmZpZyBwYW5lbCBkaXNwbGF5DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgaWYgKG5vZGUpIHsNCiAgICAgICAgbm9kZS5sYXN0Q29udGVudCA9IGNvbnRlbnQ7DQogICAgICAgIG5vZGUubGFzdEZvcm1hdCA9IGZvcm1hdDsNCiAgICB9DQp9DQoNCi8vIEhlbHBlciBmdW5jdGlvbiB0byBlc2NhcGUgSFRNTA0KZnVuY3Rpb24gZXNjYXBlSHRtbCh0ZXh0KSB7DQogICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgZGl2LnRleHRDb250ZW50ID0gdGV4dDsNCiAgICByZXR1cm4gZGl2LmlubmVySFRNTDsNCn0NCg0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHJlcGxhY2UgdGVtcGxhdGUgcGxhY2Vob2xkZXJzDQpmdW5jdGlvbiByZXBsYWNlVGVtcGxhdGVQbGFjZWhvbGRlcnModGVtcGxhdGUsIGRhdGEpIHsNCiAgICBpZiAodHlwZW9mIHRlbXBsYXRlICE9PSAnb2JqZWN0JyB8fCB0ZW1wbGF0ZSA9PT0gbnVsbCkgew0KICAgICAgICByZXR1cm4gdGVtcGxhdGU7DQogICAgfQ0KICAgIA0KICAgIGlmIChBcnJheS5pc0FycmF5KHRlbXBsYXRlKSkgew0KICAgICAgICByZXR1cm4gdGVtcGxhdGUubWFwKGl0ZW0gPT4gcmVwbGFjZVRlbXBsYXRlUGxhY2Vob2xkZXJzKGl0ZW0sIGRhdGEpKTsNCiAgICB9DQogICAgDQogICAgY29uc3QgcmVzdWx0ID0ge307DQogICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXModGVtcGxhdGUpKSB7DQogICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICBsZXQgcmVwbGFjZWRWYWx1ZSA9IHZhbHVlOw0KICAgIA0KICAgICAgICAgICAgLy8gUmVwbGFjZSB7e1ZBTFVFfX0gd2l0aCB0aGUgZnVsbCBkYXRhIG9iamVjdA0KICAgICAgICAgICAgaWYgKHZhbHVlLmluY2x1ZGVzKCd7e1ZBTFVFfX0nKSkgew0KICAgICAgICAgICAgICAgIHJlcGxhY2VkVmFsdWUgPSB2YWx1ZS5yZXBsYWNlKCd7e1ZBTFVFfX0nLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7DQp9DQoNCiAgICAgICAgICAgIC8vIFJlcGxhY2Uge3tKU09OOmZpZWxkfX0gd2l0aCBzcGVjaWZpYyBmaWVsZA0KICAgICAgICAgICAgY29uc3QganNvbk1hdGNoZXMgPSB2YWx1ZS5tYXRjaCgvXHtce0pTT046KFtefV0rKVx9XH0vZyk7DQogICAgICAgICAgICBpZiAoanNvbk1hdGNoZXMpIHsNCiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIGpzb25NYXRjaGVzKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gbWF0Y2gubWF0Y2goL1x7XHtKU09OOihbXn1dKylcfVx9LylbMV07DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBnZXROZXN0ZWRWYWx1ZShkYXRhLCBmaWVsZCk7DQogICAgICAgICAgICAgICAgICAgIHJlcGxhY2VkVmFsdWUgPSByZXBsYWNlZFZhbHVlLnJlcGxhY2UobWF0Y2gsIEpTT04uc3RyaW5naWZ5KGZpZWxkVmFsdWUpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgICAgICAgICAgLy8gUmVwbGFjZSB7e2ZpZWxkfX0gd2l0aCBzcGVjaWZpYyBmaWVsZCB2YWx1ZQ0KICAgICAgICAgICAgY29uc3QgZmllbGRNYXRjaGVzID0gdmFsdWUubWF0Y2goL1x7XHsoW159XSspXH1cfS9nKTsNCiAgICAgICAgICAgIGlmIChmaWVsZE1hdGNoZXMpIHsNCiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIGZpZWxkTWF0Y2hlcykgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZCA9IG1hdGNoLm1hdGNoKC9ce1x7KFtefV0rKVx9XH0vKVsxXTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGZpZWxkICE9PSAnVkFMVUUnICYmICFmaWVsZC5zdGFydHNXaXRoKCdKU09OOicpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZFZhbHVlID0gZ2V0TmVzdGVkVmFsdWUoZGF0YSwgZmllbGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZWRWYWx1ZSA9IHJlcGxhY2VkVmFsdWUucmVwbGFjZShtYXRjaCwgZmllbGRWYWx1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gcmVwbGFjZWRWYWx1ZTsNCiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICE9PSBudWxsKSB7DQogICAgICAgICAgICByZXN1bHRba2V5XSA9IHJlcGxhY2VUZW1wbGF0ZVBsYWNlaG9sZGVycyh2YWx1ZSwgZGF0YSk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXN1bHRba2V5XSA9IHZhbHVlOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIHJldHVybiByZXN1bHQ7DQp9DQoNCi8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgbmVzdGVkIG9iamVjdCB2YWx1ZXMNCmZ1bmN0aW9uIGdldE5lc3RlZFZhbHVlKG9iaiwgcGF0aCkgew0KICAgIGNvbnN0IGtleXMgPSBwYXRoLnNwbGl0KCcuJyk7DQogICAgbGV0IGN1cnJlbnQgPSBvYmo7DQogICAgDQogICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgew0KICAgICAgICBpZiAoY3VycmVudCA9PT0gbnVsbCB8fCBjdXJyZW50ID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBIYW5kbGUgYXJyYXkgYWNjZXNzIGxpa2UgIml0ZW1zWzBdLm5hbWUiDQogICAgICAgIGNvbnN0IGFycmF5TWF0Y2ggPSBrZXkubWF0Y2goL14oLispXFsoXGQrKVxdJC8pOw0KICAgICAgICBpZiAoYXJyYXlNYXRjaCkgew0KICAgICAgICAgICAgY29uc3QgYXJyYXlLZXkgPSBhcnJheU1hdGNoWzFdOw0KICAgICAgICAgICAgY29uc3QgYXJyYXlJbmRleCA9IHBhcnNlSW50KGFycmF5TWF0Y2hbMl0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoY3VycmVudFthcnJheUtleV0gJiYgQXJyYXkuaXNBcnJheShjdXJyZW50W2FycmF5S2V5XSkpIHsNCiAgICAgICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFthcnJheUtleV1bYXJyYXlJbmRleF07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFtrZXldOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIHJldHVybiBjdXJyZW50Ow0KfQ0KDQovLyBTdG9wIHdvcmtmbG93IGV4ZWN1dGlvbg0KZnVuY3Rpb24gc3RvcFdvcmtmbG93KCkgew0KICAgICAgICBmbG93RWRpdG9yLmlzUnVubmluZyA9IGZhbHNlOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncnVuLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtZmxleCc7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9wLXdvcmtmbG93Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgDQogICAgLy8gQ2xlYXIgcnVubmluZyBzdGF0ZXMgZnJvbSBhbGwgbm9kZXMNCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZsb3ctbm9kZS5ydW5uaW5nJykuZm9yRWFjaChub2RlID0+IHsNCiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LnJlbW92ZSgncnVubmluZycpOw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgY29uc3Qgb3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4ZWN1dGlvbi1vdXRwdXQnKTsNCiAgICBvdXRwdXQuaW5uZXJIVE1MICs9ICc8ZGl2IGNsYXNzPSJsb2ctZW50cnkgd2FybmluZyI+V29ya2Zsb3cgZXhlY3V0aW9uIHN0b3BwZWQgYnkgdXNlcjwvZGl2Pic7DQogICAgDQp9DQoNCi8vIEZpbmQgbm9kZXMgY29ubmVjdGVkIHRvIGEgc3BlY2lmaWMgbm9kZQ0KZnVuY3Rpb24gZmluZENvbm5lY3RlZE5vZGVzKG5vZGVJZCkgew0KICAgIGNvbnN0IGNvbm5lY3RlZE5vZGVzID0gW107DQogICAgDQogICAgZm9yIChjb25zdCBjb25uZWN0aW9uIG9mIGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpIHsNCiAgICAgICAgaWYgKGNvbm5lY3Rpb24uZnJvbS5ub2RlSWQgPT09IG5vZGVJZCkgew0KICAgICAgICAgICAgY29uc3QgdGFyZ2V0Tm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGNvbm5lY3Rpb24udG8ubm9kZUlkKTsNCiAgICAgICAgICAgIGlmICh0YXJnZXROb2RlKSB7DQogICAgICAgICAgICAgICAgY29ubmVjdGVkTm9kZXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgIG5vZGU6IHRhcmdldE5vZGUsDQogICAgICAgICAgICAgICAgICAgIGlucHV0UG9ydDogY29ubmVjdGlvbi50by5wb3J0TmFtZSwNCiAgICAgICAgICAgICAgICAgICAgb3V0cHV0UG9ydDogY29ubmVjdGlvbi5mcm9tLnBvcnROYW1lDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIGNvbm5lY3RlZE5vZGVzOw0KfSANCg0KLy8gVXBkYXRlIGNhbnZhcyB0cmFuc2Zvcm0gZm9yIHBhbm5pbmcgYW5kIHpvb21pbmcNCmZ1bmN0aW9uIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5jYW52YXMpIHsNCiAgICAgICAgY29uc3QgdHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke2Zsb3dFZGl0b3IucGFuT2Zmc2V0Lnh9cHgsICR7Zmxvd0VkaXRvci5wYW5PZmZzZXQueX1weCkgc2NhbGUoJHtmbG93RWRpdG9yLnpvb21MZXZlbH0pYDsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNmb3JtID0gdHJhbnNmb3JtOw0KICAgICAgICANCiAgICAgICAgLy8gVXBkYXRlIHpvb20gbGV2ZWwgZGlzcGxheQ0KICAgICAgICBjb25zdCB6b29tRGlzcGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b29tLWxldmVsJyk7DQogICAgICAgIGlmICh6b29tRGlzcGxheSkgew0KICAgICAgICAgICAgem9vbURpc3BsYXkudGV4dENvbnRlbnQgPSBNYXRoLnJvdW5kKGZsb3dFZGl0b3Iuem9vbUxldmVsICogMTAwKSArICclJzsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gU3RhcnQgY2FudmFzIHBhbm5pbmcNCmZ1bmN0aW9uIHN0YXJ0Q2FudmFzUGFuKGUpIHsNCiAgICAvLyBPbmx5IHN0YXJ0IHBhbm5pbmcgaWYgY2xpY2tpbmcgZGlyZWN0bHkgb24gY2FudmFzIChub3Qgb24gbm9kZXMgb3Igb3RoZXIgZWxlbWVudHMpDQogICAgLy8gYW5kIG5vdCBhbHJlYWR5IGRyYWdnaW5nIGEgbm9kZQ0KICAgIGlmIChlLnRhcmdldCA9PT0gZmxvd0VkaXRvci5jYW52YXMgJiYgIWZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKSB7DQogICAgICAgIGZsb3dFZGl0b3IuaXNQYW5uaW5nID0gdHJ1ZTsNCiAgICAgICAgY29uc3QgbW91c2VDb29yZHMgPSB3aW5kb3cuZmxvd0VkaXRvclV0aWxzID8NCiAgICAgICAgICAgIHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOg0KICAgICAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgICAgICBmbG93RWRpdG9yLnBhblN0YXJ0ID0geyB4OiBtb3VzZUNvb3Jkcy54LCB5OiBtb3VzZUNvb3Jkcy55IH07DQogICAgICAgIGZsb3dFZGl0b3IubGFzdFBhbk9mZnNldCA9IHsgLi4uZmxvd0VkaXRvci5wYW5PZmZzZXQgfTsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUuY3Vyc29yID0gJ2dyYWJiaW5nJzsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuY2xhc3NMaXN0LmFkZCgncGFubmluZycpOw0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgfQ0KfQ0KDQovLyBVcGRhdGUgY2FudmFzIHBhbm5pbmcNCmZ1bmN0aW9uIHVwZGF0ZUNhbnZhc1BhbihlKSB7DQogICAgaWYgKGZsb3dFZGl0b3IuaXNQYW5uaW5nKSB7DQogICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gd2luZG93LmZsb3dFZGl0b3JVdGlscyA/DQogICAgICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDoNCiAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgY29uc3QgZGVsdGFYID0gbW91c2VDb29yZHMueCAtIGZsb3dFZGl0b3IucGFuU3RhcnQueDsNCiAgICAgICAgY29uc3QgZGVsdGFZID0gbW91c2VDb29yZHMueSAtIGZsb3dFZGl0b3IucGFuU3RhcnQueTsNCg0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gZmxvd0VkaXRvci5sYXN0UGFuT2Zmc2V0LnggKyBkZWx0YVg7DQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSBmbG93RWRpdG9yLmxhc3RQYW5PZmZzZXQueSArIGRlbHRhWTsNCg0KICAgICAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIH0NCn0NCg0KLy8gU3RvcCBjYW52YXMgcGFubmluZw0KZnVuY3Rpb24gc3RvcENhbnZhc1BhbigpIHsNCiAgICBpZiAoZmxvd0VkaXRvci5pc1Bhbm5pbmcpIHsNCiAgICAgICAgZmxvd0VkaXRvci5pc1Bhbm5pbmcgPSBmYWxzZTsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUuY3Vyc29yID0gJ2dyYWInOw0KICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5jbGFzc0xpc3QucmVtb3ZlKCdwYW5uaW5nJyk7DQogICAgfQ0KfQ0KDQovLyBSZXNldCBjYW52YXMgcGFuIHRvIGNlbnRlcg0KZnVuY3Rpb24gcmVzZXRDYW52YXNQYW4oKSB7DQogICAgLy8gQWRkIHNtb290aCB0cmFuc2l0aW9uIGZvciByZXNldA0KICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zaXRpb24gPSAndHJhbnNmb3JtIDAuM3MgZWFzZS1vdXQnOw0KDQogICAgLy8gQ2FsY3VsYXRlIGNlbnRlciBvZiBhbGwgbm9kZXMgaWYgYW55IGV4aXN0DQogICAgaWYgKGZsb3dFZGl0b3Iubm9kZXMuc2l6ZSA+IDApIHsNCiAgICAgICAgY29uc3Qgbm9kZXMgPSBBcnJheS5mcm9tKGZsb3dFZGl0b3Iubm9kZXMudmFsdWVzKCkpOw0KICAgICAgICBjb25zdCBtaW5YID0gTWF0aC5taW4oLi4ubm9kZXMubWFwKG4gPT4gbi54KSk7DQogICAgICAgIGNvbnN0IG1heFggPSBNYXRoLm1heCguLi5ub2Rlcy5tYXAobiA9PiBuLngpKTsNCiAgICAgICAgY29uc3QgbWluWSA9IE1hdGgubWluKC4uLm5vZGVzLm1hcChuID0+IG4ueSkpOw0KICAgICAgICBjb25zdCBtYXhZID0gTWF0aC5tYXgoLi4ubm9kZXMubWFwKG4gPT4gbi55KSk7DQoNCiAgICAgICAgY29uc3QgY2VudGVyWCA9IChtaW5YICsgbWF4WCkgLyAyOw0KICAgICAgICBjb25zdCBjZW50ZXJZID0gKG1pblkgKyBtYXhZKSAvIDI7DQoNCiAgICAgICAgLy8gR2V0IGNhbnZhcyBjb250YWluZXIgZGltZW5zaW9ucyAoc2NhbGVkKQ0KICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gd2luZG93LmZsb3dFZGl0b3JVdGlscyA/DQogICAgICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDoNCiAgICAgICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCg0KICAgICAgICAvLyBDYWxjdWxhdGUgcGFuIG9mZnNldCB0byBjZW50ZXIgdGhlIG5vZGVzIGluIHRoZSB2aWV3cG9ydA0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gLWNlbnRlclggKyBjb250YWluZXJSZWN0LndpZHRoIC8gMjsNCiAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IC1jZW50ZXJZICsgY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIElmIG5vIG5vZGVzLCByZXNldCB0byBjZW50ZXIgb2YgdGhlIGxhcmdlIGNhbnZhcw0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldCA9IHsgeDogLTUwMDAsIHk6IC01MDAwIH07DQogICAgfQ0KDQogICAgLy8gUmVzZXQgem9vbSB0byAxMDAlDQogICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSAxLjA7DQoNCiAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCg0KICAgIC8vIFJlbW92ZSB0cmFuc2l0aW9uIGFmdGVyIGFuaW1hdGlvbiBjb21wbGV0ZXMNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICcnOw0KICAgIH0sIDMwMCk7DQp9DQoNCi8vIFpvb20gZnVuY3Rpb25zDQpmdW5jdGlvbiB6b29tSW4oKSB7DQogICAgY29uc3QgbmV3Wm9vbSA9IE1hdGgubWluKGZsb3dFZGl0b3Iuem9vbUxldmVsICsgZmxvd0VkaXRvci56b29tU3RlcCwgZmxvd0VkaXRvci5tYXhab29tKTsNCiAgICBzZXRab29tTGV2ZWwobmV3Wm9vbSk7DQp9DQoNCmZ1bmN0aW9uIHpvb21PdXQoKSB7DQogICAgY29uc3QgbmV3Wm9vbSA9IE1hdGgubWF4KGZsb3dFZGl0b3Iuem9vbUxldmVsIC0gZmxvd0VkaXRvci56b29tU3RlcCwgZmxvd0VkaXRvci5taW5ab29tKTsNCiAgICBzZXRab29tTGV2ZWwobmV3Wm9vbSk7DQp9DQoNCmZ1bmN0aW9uIHNldFpvb21MZXZlbCh6b29tTGV2ZWwpIHsNCiAgICAvLyBHZXQgdGhlIGNlbnRlciBvZiB0aGUgY2FudmFzIGNvbnRhaW5lciBmb3Igem9vbSBvcmlnaW4NCiAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSB3aW5kb3cuZmxvd0VkaXRvclV0aWxzID8NCiAgICAgICAgd2luZG93LmZsb3dFZGl0b3JVdGlscy5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6DQogICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICANCiAgICBjb25zdCBjZW50ZXJYID0gY29udGFpbmVyUmVjdC53aWR0aCAvIDI7DQogICAgY29uc3QgY2VudGVyWSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICANCiAgICAvLyBDYWxjdWxhdGUgdGhlIHBvaW50IGluIGNhbnZhcyBjb29yZGluYXRlcyB0aGF0IHNob3VsZCByZW1haW4gZml4ZWQNCiAgICBjb25zdCBjYW52YXNYID0gKGNlbnRlclggLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIGNvbnN0IGNhbnZhc1kgPSAoY2VudGVyWSAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgDQogICAgLy8gVXBkYXRlIHpvb20gbGV2ZWwNCiAgICBmbG93RWRpdG9yLnpvb21MZXZlbCA9IE1hdGgubWF4KGZsb3dFZGl0b3IubWluWm9vbSwgTWF0aC5taW4oZmxvd0VkaXRvci5tYXhab29tLCB6b29tTGV2ZWwpKTsNCiAgICANCiAgICAvLyBBZGp1c3QgcGFuIG9mZnNldCB0byBrZWVwIHRoZSBjZW50ZXIgcG9pbnQgZml4ZWQNCiAgICBmbG93RWRpdG9yLnBhbk9mZnNldC54ID0gY2VudGVyWCAtIGNhbnZhc1ggKiBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICBmbG93RWRpdG9yLnBhbk9mZnNldC55ID0gY2VudGVyWSAtIGNhbnZhc1kgKiBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICANCiAgICB1cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICANCiAgICAvLyBSZWRyYXcgY29ubmVjdGlvbnMgYWZ0ZXIgem9vbQ0KICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICByZWRyYXdBbGxDb25uZWN0aW9ucygpOw0KICAgIH0sIDE2KTsNCn0NCg0KZnVuY3Rpb24gem9vbVRvRml0KCkgew0KICAgIGlmIChmbG93RWRpdG9yLm5vZGVzLnNpemUgPT09IDApIHsNCiAgICAgICAgLy8gSWYgbm8gbm9kZXMsIHJlc2V0IHRvIDEwMCUgem9vbSBhbmQgY2VudGVyDQogICAgICAgIGZsb3dFZGl0b3Iuem9vbUxldmVsID0gMS4wOw0KICAgICAgICBmbG93RWRpdG9yLnBhbk9mZnNldCA9IHsgeDogLTUwMDAsIHk6IC01MDAwIH07DQogICAgICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIEZpbmQgYm91bmRzIG9mIGFsbCBub2Rlcw0KICAgIGNvbnN0IG5vZGVzID0gQXJyYXkuZnJvbShmbG93RWRpdG9yLm5vZGVzLnZhbHVlcygpKTsNCiAgICBjb25zdCBwYWRkaW5nID0gMTAwOyAvLyBFeHRyYSBwYWRkaW5nIGFyb3VuZCBub2Rlcw0KICAgIA0KICAgIGxldCBtaW5YID0gSW5maW5pdHksIG1heFggPSAtSW5maW5pdHk7DQogICAgbGV0IG1pblkgPSBJbmZpbml0eSwgbWF4WSA9IC1JbmZpbml0eTsNCiAgICANCiAgICBub2Rlcy5mb3JFYWNoKG5vZGUgPT4gew0KICAgICAgICBjb25zdCBub2RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vZGUuaWQpOw0KICAgICAgICBpZiAobm9kZUVsZW1lbnQpIHsNCiAgICAgICAgICAgIGNvbnN0IHJlY3QgPSBub2RlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCBub2RlLngpOw0KICAgICAgICAgICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIG5vZGUueCArIHJlY3Qud2lkdGgpOw0KICAgICAgICAgICAgbWluWSA9IE1hdGgubWluKG1pblksIG5vZGUueSk7DQogICAgICAgICAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgbm9kZS55ICsgcmVjdC5oZWlnaHQpOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gQWRkIHBhZGRpbmcNCiAgICBtaW5YIC09IHBhZGRpbmc7DQogICAgbWF4WCArPSBwYWRkaW5nOw0KICAgIG1pblkgLT0gcGFkZGluZzsNCiAgICBtYXhZICs9IHBhZGRpbmc7DQogICAgDQogICAgY29uc3QgY29udGVudFdpZHRoID0gbWF4WCAtIG1pblg7DQogICAgY29uc3QgY29udGVudEhlaWdodCA9IG1heFkgLSBtaW5ZOw0KICAgIA0KICAgIC8vIEdldCBjb250YWluZXIgZGltZW5zaW9ucw0KICAgIGNvbnN0IGNvbnRhaW5lciA9IGZsb3dFZGl0b3IuY2FudmFzLnBhcmVudEVsZW1lbnQ7DQogICAgY29uc3QgY29udGFpbmVyUmVjdCA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMgPw0KICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDoNCiAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSB6b29tIHRvIGZpdA0KICAgIGNvbnN0IHpvb21YID0gY29udGFpbmVyUmVjdC53aWR0aCAvIGNvbnRlbnRXaWR0aDsNCiAgICBjb25zdCB6b29tWSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gY29udGVudEhlaWdodDsNCiAgICBjb25zdCBuZXdab29tID0gTWF0aC5taW4oem9vbVgsIHpvb21ZLCBmbG93RWRpdG9yLm1heFpvb20pOw0KICAgIA0KICAgIC8vIFNldCB6b29tIGxldmVsDQogICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSBNYXRoLm1heChmbG93RWRpdG9yLm1pblpvb20sIG5ld1pvb20pOw0KICAgIA0KICAgIC8vIENlbnRlciB0aGUgY29udGVudA0KICAgIGNvbnN0IGNlbnRlclggPSAobWluWCArIG1heFgpIC8gMjsNCiAgICBjb25zdCBjZW50ZXJZID0gKG1pblkgKyBtYXhZKSAvIDI7DQogICAgDQogICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyIC0gY2VudGVyWCAqIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSBjb250YWluZXJSZWN0LmhlaWdodCAvIDIgLSBjZW50ZXJZICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgDQogICAgLy8gQWRkIHNtb290aCB0cmFuc2l0aW9uDQogICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICd0cmFuc2Zvcm0gMC4zcyBlYXNlLW91dCc7DQogICAgdXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgDQogICAgLy8gUmVtb3ZlIHRyYW5zaXRpb24gYWZ0ZXIgYW5pbWF0aW9uDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zaXRpb24gPSAnJzsNCiAgICAgICAgcmVkcmF3QWxsQ29ubmVjdGlvbnMoKTsNCiAgICB9LCAzMDApOw0KfQ0KDQovLyBIYW5kbGUgbW91c2Ugd2hlZWwgem9vbQ0KZnVuY3Rpb24gaGFuZGxlTW91c2VXaGVlbChlKSB7DQogICAgaWYgKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICANCiAgICAgICAgLy8gR2V0IG1vdXNlIHBvc2l0aW9uIHJlbGF0aXZlIHRvIGNvbnRhaW5lcg0KICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gd2luZG93LmZsb3dFZGl0b3JVdGlscyA/DQogICAgICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDoNCiAgICAgICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gd2luZG93LmZsb3dFZGl0b3JVdGlscyA/DQogICAgICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDoNCiAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IG1vdXNlWCA9IG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQ7DQogICAgICAgIGNvbnN0IG1vdXNlWSA9IG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcDsNCiAgICAgICAgDQogICAgICAgIC8vIENhbGN1bGF0ZSB6b29tIGRlbHRhDQogICAgICAgIGNvbnN0IHpvb21EZWx0YSA9IGUuZGVsdGFZID4gMCA/IC1mbG93RWRpdG9yLnpvb21TdGVwIDogZmxvd0VkaXRvci56b29tU3RlcDsNCiAgICAgICAgY29uc3QgbmV3Wm9vbSA9IE1hdGgubWF4KGZsb3dFZGl0b3IubWluWm9vbSwgTWF0aC5taW4oZmxvd0VkaXRvci5tYXhab29tLCBmbG93RWRpdG9yLnpvb21MZXZlbCArIHpvb21EZWx0YSkpOw0KICAgICAgICANCiAgICAgICAgaWYgKG5ld1pvb20gIT09IGZsb3dFZGl0b3Iuem9vbUxldmVsKSB7DQogICAgICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIHBvaW50IGluIGNhbnZhcyBjb29yZGluYXRlcyB0aGF0IHNob3VsZCByZW1haW4gZml4ZWQgKHVuZGVyIG1vdXNlKQ0KICAgICAgICAgICAgY29uc3QgY2FudmFzWCA9IChtb3VzZVggLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgY29uc3QgY2FudmFzWSA9IChtb3VzZVkgLSBmbG93RWRpdG9yLnBhbk9mZnNldC55KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBVcGRhdGUgem9vbSBsZXZlbA0KICAgICAgICAgICAgZmxvd0VkaXRvci56b29tTGV2ZWwgPSBuZXdab29tOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBBZGp1c3QgcGFuIG9mZnNldCB0byBrZWVwIHRoZSBtb3VzZSBwb2ludCBmaXhlZA0KICAgICAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IG1vdXNlWCAtIGNhbnZhc1ggKiBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSBtb3VzZVkgLSBjYW52YXNZICogZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBSZWRyYXcgY29ubmVjdGlvbnMgYWZ0ZXIgem9vbQ0KICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGZsb3dFZGl0b3Iuem9vbVJlZHJhd1RpbWVvdXQpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci56b29tUmVkcmF3VGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgICAgICAgICB9LCA1MCk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIEhhbmRsZSBjYW52YXMgY2xpY2sgZXZlbnRzDQpmdW5jdGlvbiBoYW5kbGVDYW52YXNDbGljayhlKSB7DQogICAgaWYgKGUudGFyZ2V0ID09PSBmbG93RWRpdG9yLmNhbnZhcykgew0KICAgICAgICAvLyBEZXNlbGVjdCBub2RlDQogICAgICAgIGlmIChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSkgew0KICAgICAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSk7DQogICAgICAgICAgICBpZiAobm9kZUVsZW1lbnQpIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7DQogICAgICAgICAgICBmbG93RWRpdG9yLnNlbGVjdGVkTm9kZSA9IG51bGw7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZS1jb25maWcnKS5pbm5lckhUTUwgPSAnPHAgY2xhc3M9InRleHQtbXV0ZWQiPlNlbGVjdCBhIG5vZGUgdG8gY29uZmlndXJlIGl0PC9wPic7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIEhhbmRsZSBkb2N1bWVudCBtb3VzZSBldmVudHMgZm9yIHNtb290aCBkcmFnZ2luZw0KZnVuY3Rpb24gaGFuZGxlRG9jdW1lbnRNb3VzZURvd24oZSkgew0KICAgIC8vIERvbid0IHN0YXJ0IGRyYWdnaW5nIGlmIGNsaWNraW5nIG9uIFVJIGVsZW1lbnRzDQogICAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy5mbG93LXRvb2xiYXInKSB8fCANCiAgICAgICAgZS50YXJnZXQuY2xvc2VzdCgnLmZsb3ctY29uZmlnLXBhbmVsJykgfHwgDQogICAgICAgIGUudGFyZ2V0LmNsb3Nlc3QoJy5mbG93LW91dHB1dC1wYW5lbCcpIHx8DQogICAgICAgIGUudGFyZ2V0LmNsb3Nlc3QoJy5ub2RlLWRlbGV0ZS1idG4nKSkgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIERvbid0IHN0YXJ0IGRyYWdnaW5nIGlmIHdlJ3JlIHBhbm5pbmcNCiAgICBpZiAoZmxvd0VkaXRvci5pc1Bhbm5pbmcpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBPbmx5IGFsbG93IGRyYWdnaW5nIGZyb20gdGhlIG5vZGUgaGVhZGVyDQogICAgY29uc3QgaGVhZGVyRWxlbWVudCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5mbG93LW5vZGUtaGVhZGVyJyk7DQogICAgaWYgKCFoZWFkZXJFbGVtZW50KSByZXR1cm47DQogICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBoZWFkZXJFbGVtZW50LmNsb3Nlc3QoJy5mbG93LW5vZGUnKTsNCiAgICBpZiAoIW5vZGVFbGVtZW50KSByZXR1cm47DQogICAgDQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgY29uc3Qgbm9kZUlkID0gbm9kZUVsZW1lbnQuaWQ7DQogICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KG5vZGVJZCk7DQogICAgDQogICAgaWYgKG5vZGUpIHsNCiAgICAgICAgZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUgPSBub2RlSWQ7DQogICAgICAgIA0KICAgICAgICAvLyBDYWxjdWxhdGUgb2Zmc2V0IGZyb20gbW91c2UgdG8gbm9kZSBjb3JuZXIsIGFjY291bnRpbmcgZm9yIHpvb20NCiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMgPyANCiAgICAgICAgICAgIHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOiANCiAgICAgICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgDQogICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gd2luZG93LmZsb3dFZGl0b3JVdGlscyA/IA0KICAgICAgICAgICAgd2luZG93LmZsb3dFZGl0b3JVdGlscy5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6IA0KICAgICAgICAgICAgeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Ow0KICAgICAgICANCiAgICAgICAgLy8gQ29udmVydCBtb3VzZSBwb3NpdGlvbiB0byBjYW52YXMgY29vcmRpbmF0ZXMNCiAgICAgICAgY29uc3QgY2FudmFzTW91c2VYID0gKG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQgLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICBjb25zdCBjYW52YXNNb3VzZVkgPSAobW91c2VDb29yZHMueSAtIGNvbnRhaW5lclJlY3QudG9wIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgDQogICAgICAgIC8vIENhbGN1bGF0ZSBvZmZzZXQgaW4gY2FudmFzIGNvb3JkaW5hdGVzDQogICAgICAgIGZsb3dFZGl0b3IuZHJhZ09mZnNldCA9IHsNCiAgICAgICAgICAgIHg6IChjYW52YXNNb3VzZVggLSBub2RlLngpICogZmxvd0VkaXRvci56b29tTGV2ZWwsDQogICAgICAgICAgICB5OiAoY2FudmFzTW91c2VZIC0gbm9kZS55KSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsDQogICAgICAgIH07DQogICAgICAgIA0KICAgICAgICBub2RlRWxlbWVudC5zdHlsZS5jdXJzb3IgPSAnZ3JhYmJpbmcnOw0KICAgICAgICBub2RlRWxlbWVudC5zdHlsZS56SW5kZXggPSAnMTAwMCc7IC8vIEJyaW5nIHRvIGZyb250IHdoaWxlIGRyYWdnaW5nDQogICAgICAgIA0KICAgICAgICAvLyBDYWNoZSBjb250YWluZXIgcmVjdCBmb3IgcGVyZm9ybWFuY2UNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXNSZWN0ID0gY29udGFpbmVyUmVjdDsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIGhhbmRsZURvY3VtZW50TW91c2VNb3ZlKGUpIHsNCiAgICAvLyBIYW5kbGUgY2FudmFzIHBhbm5pbmcNCiAgICBpZiAoZmxvd0VkaXRvci5pc1Bhbm5pbmcpIHsNCiAgICAgICAgdXBkYXRlQ2FudmFzUGFuKGUpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIEdldCBzY2FsZWQgY29vcmRpbmF0ZXMNCiAgICBjb25zdCBtb3VzZUNvb3JkcyA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMgPyANCiAgICAgICAgd2luZG93LmZsb3dFZGl0b3JVdGlscy5nZXRTY2FsZWRNb3VzZUNvb3JkcyhlKSA6IA0KICAgICAgICB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07DQogICAgDQogICAgLy8gSGFuZGxlIHRhZyBkcmFnZ2luZw0KICAgIGlmIChmbG93RWRpdG9yLmRyYWdnaW5nVGFnICYmIGZsb3dFZGl0b3IudGFnRHJhZ09mZnNldCkgew0KICAgICAgICBjb25zdCB0YWcgPSBmbG93RWRpdG9yLnRhZ3MuZ2V0KGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcpOw0KICAgICAgICBpZiAodGFnKSB7DQogICAgICAgICAgICAvLyBHZXQgY29udGFpbmVyIGRpbWVuc2lvbnMgZm9yIGNvb3JkaW5hdGUgY29udmVyc2lvbg0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSB3aW5kb3cuZmxvd0VkaXRvclV0aWxzID8gDQogICAgICAgICAgICAgICAgd2luZG93LmZsb3dFZGl0b3JVdGlscy5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6IA0KICAgICAgICAgICAgICAgIGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ29udmVydCBtb3VzZSBjb29yZGluYXRlcyB0byBjYW52YXMgY29vcmRpbmF0ZXMsIGFjY291bnRpbmcgZm9yIHBhbiBhbmQgem9vbQ0KICAgICAgICAgICAgY29uc3QgY2FudmFzTW91c2VYID0gKG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQgLSBmbG93RWRpdG9yLnBhbk9mZnNldC54KSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgY29uc3QgY2FudmFzTW91c2VZID0gKG1vdXNlQ29vcmRzLnkgLSBjb250YWluZXJSZWN0LnRvcCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBuZXcgcG9zaXRpb24gd2l0aCBvZmZzZXQgKGRyYWcgb2Zmc2V0IGlzIGFsc28gaW4gc2NyZWVuIGNvb3JkaW5hdGVzLCBzbyBjb252ZXJ0IGl0KQ0KICAgICAgICAgICAgY29uc3QgZHJhZ09mZnNldFggPSBmbG93RWRpdG9yLnRhZ0RyYWdPZmZzZXQueCAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgY29uc3QgZHJhZ09mZnNldFkgPSBmbG93RWRpdG9yLnRhZ0RyYWdPZmZzZXQueSAvIGZsb3dFZGl0b3Iuem9vbUxldmVsOw0KICAgICAgICAgICAgDQogICAgICAgICAgICB0YWcueCA9IGNhbnZhc01vdXNlWCAtIGRyYWdPZmZzZXRYOw0KICAgICAgICAgICAgdGFnLnkgPSBjYW52YXNNb3VzZVkgLSBkcmFnT2Zmc2V0WTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcpOw0KICAgICAgICAgICAgaWYgKHRhZ0VsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICAvLyBVc2UgbGVmdC90b3AgZm9yIHBvc2l0aW9uaW5nDQogICAgICAgICAgICAgICAgdGFnRWxlbWVudC5zdHlsZS5sZWZ0ID0gdGFnLnggKyAncHgnOw0KICAgICAgICAgICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUudG9wID0gdGFnLnkgKyAncHgnOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBUaHJvdHRsZSB1cGRhdGVzIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2UNCiAgICAgICAgICAgIGlmICghZmxvd0VkaXRvci50YWdVcGRhdGVUaW1lb3V0KSB7DQogICAgICAgICAgICAgICAgZmxvd0VkaXRvci50YWdVcGRhdGVUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IudGFnVXBkYXRlVGltZW91dCA9IG51bGw7DQogICAgICAgICAgICAgICAgfSwgMTYpOyAvLyB+NjBmcHMNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGlmIChmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSAmJiBmbG93RWRpdG9yLmRyYWdPZmZzZXQpIHsNCiAgICAgICAgY29uc3Qgbm9kZSA9IGZsb3dFZGl0b3Iubm9kZXMuZ2V0KGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKTsNCiAgICAgICAgaWYgKG5vZGUpIHsNCiAgICAgICAgICAgIC8vIEdldCBjb250YWluZXIgZGltZW5zaW9ucyBmb3IgY29vcmRpbmF0ZSBjb252ZXJzaW9uDQogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMgPyANCiAgICAgICAgICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmdldFNjYWxlZEJvdW5kaW5nQ2xpZW50UmVjdChjb250YWluZXIpIDogDQogICAgICAgICAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDb252ZXJ0IG1vdXNlIGNvb3JkaW5hdGVzIHRvIGNhbnZhcyBjb29yZGluYXRlcywgYWNjb3VudGluZyBmb3IgcGFuIGFuZCB6b29tDQogICAgICAgICAgICBjb25zdCBjYW52YXNNb3VzZVggPSAobW91c2VDb29yZHMueCAtIGNvbnRhaW5lclJlY3QubGVmdCAtIGZsb3dFZGl0b3IucGFuT2Zmc2V0LngpIC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICBjb25zdCBjYW52YXNNb3VzZVkgPSAobW91c2VDb29yZHMueSAtIGNvbnRhaW5lclJlY3QudG9wIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBwb3NpdGlvbiB3aXRoIG9mZnNldCAoZHJhZyBvZmZzZXQgaXMgYWxzbyBpbiBzY3JlZW4gY29vcmRpbmF0ZXMsIHNvIGNvbnZlcnQgaXQpDQogICAgICAgICAgICBjb25zdCBkcmFnT2Zmc2V0WCA9IGZsb3dFZGl0b3IuZHJhZ09mZnNldC54IC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICBjb25zdCBkcmFnT2Zmc2V0WSA9IGZsb3dFZGl0b3IuZHJhZ09mZnNldC55IC8gZmxvd0VkaXRvci56b29tTGV2ZWw7DQogICAgICAgICAgICANCiAgICAgICAgICAgIG5vZGUueCA9IGNhbnZhc01vdXNlWCAtIGRyYWdPZmZzZXRYOw0KICAgICAgICAgICAgbm9kZS55ID0gY2FudmFzTW91c2VZIC0gZHJhZ09mZnNldFk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUpOw0KICAgICAgICAgICAgaWYgKG5vZGVFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUubGVmdCA9IG5vZGUueCArICdweCc7DQogICAgICAgICAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUudG9wID0gbm9kZS55ICsgJ3B4JzsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgYWxsIGNvbm5lY3Rpb25zIGZvciB0aGlzIG5vZGUgKHRocm90dGxlZCBmb3IgcGVyZm9ybWFuY2UpDQogICAgICAgICAgICAgICAgaWYgKCFmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQpIHsNCiAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVDb25uZWN0aW9uc0Zvck5vZGUobm9kZS5pZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9LCAxNik7IC8vIH42MGZwcw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gaGFuZGxlRG9jdW1lbnRNb3VzZVVwKGUpIHsNCiAgICAvLyBIYW5kbGUgY2FudmFzIHBhbm5pbmcgc3RvcA0KICAgIGlmIChmbG93RWRpdG9yLmlzUGFubmluZykgew0KICAgICAgICBzdG9wQ2FudmFzUGFuKCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gSGFuZGxlIHRhZyBkcmFnZ2luZyBzdG9wDQogICAgaWYgKGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcpIHsNCiAgICAgICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZsb3dFZGl0b3IuZHJhZ2dpbmdUYWcpOw0KICAgICAgICBpZiAodGFnRWxlbWVudCkgew0KICAgICAgICAgICAgdGFnRWxlbWVudC5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7DQogICAgICAgICAgICB0YWdFbGVtZW50LnN0eWxlLnpJbmRleCA9ICcxMDAnOw0KICAgICAgICAgICAgdGFnRWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gJ2JveC1zaGFkb3cgMC4ycyBlYXNlLCB0cmFuc2Zvcm0gMC4ycyBlYXNlJzsgLy8gUmVzdG9yZSB0cmFuc2l0aW9ucw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBmbG93RWRpdG9yLmRyYWdnaW5nVGFnID0gbnVsbDsNCiAgICAgICAgZmxvd0VkaXRvci50YWdEcmFnT2Zmc2V0ID0gbnVsbDsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBpZiAoZmxvd0VkaXRvci5kcmFnZ2luZ05vZGUpIHsNCiAgICAgICAgY29uc3Qgbm9kZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmbG93RWRpdG9yLmRyYWdnaW5nTm9kZSk7DQogICAgICAgIGlmIChub2RlRWxlbWVudCkgew0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ2dyYWInOw0KICAgICAgICAgICAgbm9kZUVsZW1lbnQuc3R5bGUuekluZGV4ID0gJyc7IC8vIFJlc2V0IHotaW5kZXgNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gQ2xlYXIgYW55IHBlbmRpbmcgY29ubmVjdGlvbiB1cGRhdGVzDQogICAgICAgIGlmIChmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQpIHsNCiAgICAgICAgICAgIGNsZWFyVGltZW91dChmbG93RWRpdG9yLnVwZGF0ZVRpbWVvdXQpOw0KICAgICAgICAgICAgZmxvd0VkaXRvci51cGRhdGVUaW1lb3V0ID0gbnVsbDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gRmluYWwgY29ubmVjdGlvbiB1cGRhdGUNCiAgICAgICAgdXBkYXRlQ29ubmVjdGlvbnNGb3JOb2RlKGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlKTsNCiAgICAgICAgDQogICAgICAgIGZsb3dFZGl0b3IuZHJhZ2dpbmdOb2RlID0gbnVsbDsNCiAgICAgICAgZmxvd0VkaXRvci5kcmFnT2Zmc2V0ID0gbnVsbDsNCiAgICAgICAgZmxvd0VkaXRvci5jYW52YXNSZWN0ID0gbnVsbDsNCiAgICB9DQp9DQoNCg0KLy8gRXhhbXBsZTogY2FudmFzLW1hbmFnZXIuanMNCndpbmRvdy5jYW52YXNNYW5hZ2VyID0gew0KICAgIHVwZGF0ZUNhbnZhc1RyYW5zZm9ybSwNCiAgICBzdGFydENhbnZhc1BhbiwNCiAgICB1cGRhdGVDYW52YXNQYW4sDQogICAgc3RvcENhbnZhc1BhbiwNCiAgICByZXNldENhbnZhc1BhbiwNCiAgICBoYW5kbGVDYW52YXNDbGljaywNCiAgICBoYW5kbGVEb2N1bWVudE1vdXNlRG93biwNCiAgICBoYW5kbGVEb2N1bWVudE1vdXNlTW92ZSwNCiAgICBoYW5kbGVEb2N1bWVudE1vdXNlVXAsDQogICAgem9vbUluLA0KICAgIHpvb21PdXQsDQogICAgc2V0Wm9vbUxldmVsLA0KICAgIHpvb21Ub0ZpdCwNCiAgICBoYW5kbGVNb3VzZVdoZWVsDQp9Ow0KDQoNCi8vIEFkZCBhIG5ldyB0YWcgYXQgY3VycmVudCB2aWV3cG9ydCBjZW50ZXINCmFzeW5jIGZ1bmN0aW9uIGFkZFRhZygpIHsNCiAgICBjb25zdCB0YWdOYW1lID0gYXdhaXQgc3lwbmV4QVBJLnNob3dJbnB1dE1vZGFsKA0KICAgICAgICAnQ3JlYXRlIE5ldyBUYWcnLA0KICAgICAgICAnVGFnIE5hbWU6JywNCiAgICAgICAgew0KICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICdFbnRlciB0YWcgbmFtZScsDQogICAgICAgICAgICBjb25maXJtVGV4dDogJ0NyZWF0ZSBUYWcnLA0KICAgICAgICAgICAgY2FuY2VsVGV4dDogJ0NhbmNlbCcsDQogICAgICAgICAgICBpY29uOiAnZmFzIGZhLXRhZycNCiAgICAgICAgfQ0KICAgICk7DQogICAgDQogICAgaWYgKCF0YWdOYW1lIHx8IHRhZ05hbWUudHJpbSgpID09PSAnJykgcmV0dXJuOw0KDQogICAgY29uc3QgdGFnSWQgPSBgdGFnXyR7KytmbG93RWRpdG9yLnRhZ0NvdW50ZXJ9YDsNCg0KICAgIC8vIENhbGN1bGF0ZSBwb3NpdGlvbiBhdCBjdXJyZW50IHZpZXdwb3J0IGNlbnRlcg0KICAgIC8vIEdldCBjZW50ZXIgcG9zaXRpb24gaW4gY2FudmFzIGNvb3JkaW5hdGVzDQogICAgY29uc3QgY2VudGVyID0gd2luZG93LmZsb3dFZGl0b3JVdGlscyA/IA0KICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmdldFZpZXdwb3J0Q2VudGVySW5DYW52YXMoKSA6DQogICAgICAgIHsgeDogNTAwMCwgeTogNTAwMCB9OyAvLyBGYWxsYmFjayB0byBjYW52YXMgY2VudGVyDQoNCiAgICBjb25zdCB0YWcgPSB7DQogICAgICAgIGlkOiB0YWdJZCwNCiAgICAgICAgbmFtZTogdGFnTmFtZS50cmltKCksDQogICAgICAgIGRlc2NyaXB0aW9uOiAnJywNCiAgICAgICAgeDogY2VudGVyLngsDQogICAgICAgIHk6IGNlbnRlci55LA0KICAgICAgICBjb2xvcjogJyM0Q0FGNTAnIC8vIEdyZWVuIGNvbG9yDQogICAgfTsNCg0KICAgIGZsb3dFZGl0b3IudGFncy5zZXQodGFnSWQsIHRhZyk7DQogICAgY3JlYXRlVGFnRWxlbWVudCh0YWcpOw0KICAgIHVwZGF0ZVRhZ1BhbmVsKCk7DQoNCn0NCg0KLy8gQ3JlYXRlIHRhZyBlbGVtZW50IG9uIGNhbnZhcw0KZnVuY3Rpb24gY3JlYXRlVGFnRWxlbWVudCh0YWcpIHsNCiAgICBjb25zdCB0YWdFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgdGFnRWxlbWVudC5pZCA9IHRhZy5pZDsNCiAgICB0YWdFbGVtZW50LmNsYXNzTmFtZSA9ICdjYW52YXMtdGFnJzsNCiAgICB0YWdFbGVtZW50LnN0eWxlLmNzc1RleHQgPSBgDQogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgbGVmdDogJHt0YWcueH1weDsNCiAgICAgICAgdG9wOiAke3RhZy55fXB4Ow0KICAgICAgICBiYWNrZ3JvdW5kOiAke3RhZy5jb2xvcn07DQogICAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgICAgcGFkZGluZzogNHB4IDhweDsNCiAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgICAgICBmb250LXdlaWdodDogNTAwOw0KICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAgIHVzZXItc2VsZWN0OiBub25lOw0KICAgICAgICB6LWluZGV4OiAxMDA7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsMCwwLDAuMik7DQogICAgICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4ycyBlYXNlLCB0cmFuc2Zvcm0gMC4ycyBlYXNlOw0KICAgIGA7DQogICAgdGFnRWxlbWVudC50ZXh0Q29udGVudCA9IHRhZy5uYW1lOw0KDQogICAgLy8gTWFrZSB0YWcgZHJhZ2dhYmxlDQogICAgdGFnRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZSkgPT4gew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgIHN0YXJ0RHJhZ2dpbmdUYWcodGFnLmlkLCBlKTsNCiAgICB9KTsNCg0KICAgIC8vIENsaWNrIHRvIGp1bXAgdG8gdGFnDQogICAgdGFnRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgIGlmICghZmxvd0VkaXRvci5kcmFnZ2luZ1RhZykgew0KICAgICAgICAgICAganVtcFRvVGFnKHRhZy5pZCk7DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgIC8vIEhvdmVyIGVmZmVjdHMNCiAgICB0YWdFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7DQogICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDEuMDUpJzsNCiAgICAgICAgdGFnRWxlbWVudC5zdHlsZS5ib3hTaGFkb3cgPSAnMCA0cHggOHB4IHJnYmEoMCwwLDAsMC4zKSc7DQogICAgfSk7DQoNCiAgICB0YWdFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7DQogICAgICAgIHRhZ0VsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDEpJzsNCiAgICAgICAgdGFnRWxlbWVudC5zdHlsZS5ib3hTaGFkb3cgPSAnMCAycHggNHB4IHJnYmEoMCwwLDAsMC4yKSc7DQogICAgfSk7DQoNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5hcHBlbmRDaGlsZCh0YWdFbGVtZW50KTsNCn0NCg0KLy8gU3RhcnQgZHJhZ2dpbmcgYSB0YWcNCmZ1bmN0aW9uIHN0YXJ0RHJhZ2dpbmdUYWcodGFnSWQsIGUpIHsNCiAgICBjb25zdCB0YWcgPSBmbG93RWRpdG9yLnRhZ3MuZ2V0KHRhZ0lkKTsNCiAgICBpZiAoIXRhZykgcmV0dXJuOw0KDQogICAgZmxvd0VkaXRvci5kcmFnZ2luZ1RhZyA9IHRhZ0lkOw0KDQogICAgLy8gQ2FsY3VsYXRlIG9mZnNldCBmcm9tIG1vdXNlIHRvIHRhZyBjb3JuZXIsIGFjY291bnRpbmcgZm9yIHpvb20NCiAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSB3aW5kb3cuZmxvd0VkaXRvclV0aWxzID8gDQogICAgICAgIHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZ2V0U2NhbGVkQm91bmRpbmdDbGllbnRSZWN0KGNvbnRhaW5lcikgOiANCiAgICAgICAgY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIA0KICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gd2luZG93LmZsb3dFZGl0b3JVdGlscyA/IA0KICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclV0aWxzLmdldFNjYWxlZE1vdXNlQ29vcmRzKGUpIDogDQogICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICANCiAgICAvLyBDb252ZXJ0IG1vdXNlIHBvc2l0aW9uIHRvIGNhbnZhcyBjb29yZGluYXRlcw0KICAgIGNvbnN0IGNhbnZhc01vdXNlWCA9IChtb3VzZUNvb3Jkcy54IC0gY29udGFpbmVyUmVjdC5sZWZ0IC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueCkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICBjb25zdCBjYW52YXNNb3VzZVkgPSAobW91c2VDb29yZHMueSAtIGNvbnRhaW5lclJlY3QudG9wIC0gZmxvd0VkaXRvci5wYW5PZmZzZXQueSkgLyBmbG93RWRpdG9yLnpvb21MZXZlbDsNCiAgICANCiAgICAvLyBDYWxjdWxhdGUgb2Zmc2V0IGluIGNhbnZhcyBjb29yZGluYXRlcw0KICAgIGZsb3dFZGl0b3IudGFnRHJhZ09mZnNldCA9IHsNCiAgICAgICAgeDogKGNhbnZhc01vdXNlWCAtIHRhZy54KSAqIGZsb3dFZGl0b3Iuem9vbUxldmVsLA0KICAgICAgICB5OiAoY2FudmFzTW91c2VZIC0gdGFnLnkpICogZmxvd0VkaXRvci56b29tTGV2ZWwNCiAgICB9Ow0KDQogICAgY29uc3QgdGFnRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhZ0lkKTsNCiAgICB0YWdFbGVtZW50LnN0eWxlLmN1cnNvciA9ICdncmFiYmluZyc7DQogICAgdGFnRWxlbWVudC5zdHlsZS56SW5kZXggPSAnMTAwMSc7DQogICAgdGFnRWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gJ25vbmUnOyAvLyBEaXNhYmxlIHRyYW5zaXRpb25zIGR1cmluZyBkcmFnDQp9DQoNCi8vIEp1bXAgdG8gdGFnIGxvY2F0aW9uDQpmdW5jdGlvbiBqdW1wVG9UYWcodGFnSWQpIHsNCiAgICBjb25zdCB0YWcgPSBmbG93RWRpdG9yLnRhZ3MuZ2V0KHRhZ0lkKTsNCiAgICBpZiAoIXRhZykgcmV0dXJuOw0KDQogICAgLy8gQWRkIHNtb290aCB0cmFuc2l0aW9uDQogICAgZmxvd0VkaXRvci5jYW52YXMuc3R5bGUudHJhbnNpdGlvbiA9ICd0cmFuc2Zvcm0gMC41cyBlYXNlLW91dCc7DQoNCiAgICAvLyBVc2UgdXRpbGl0eSBmdW5jdGlvbiB0byBjZW50ZXIgdmlld3BvcnQgb24gdGFnIGNvb3JkaW5hdGVzDQogICAgaWYgKHdpbmRvdy5mbG93RWRpdG9yVXRpbHMgJiYgd2luZG93LmZsb3dFZGl0b3JVdGlscy5jZW50ZXJWaWV3cG9ydE9uQ2FudmFzKSB7DQogICAgICAgIHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuY2VudGVyVmlld3BvcnRPbkNhbnZhcyh0YWcueCwgdGFnLnkpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIEZhbGxiYWNrIG1ldGhvZA0KICAgICAgICBjb25zdCBjb250YWluZXIgPSBmbG93RWRpdG9yLmNhbnZhcy5wYXJlbnRFbGVtZW50Ow0KICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICANCiAgICAgICAgY29uc3Qgdmlld3BvcnRDZW50ZXJYID0gY29udGFpbmVyUmVjdC53aWR0aCAvIDI7DQogICAgICAgIGNvbnN0IHZpZXdwb3J0Q2VudGVyWSA9IGNvbnRhaW5lclJlY3QuaGVpZ2h0IC8gMjsNCiAgICAgICAgDQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnggPSB2aWV3cG9ydENlbnRlclggLSAodGFnLnggKiBmbG93RWRpdG9yLnpvb21MZXZlbCk7DQogICAgICAgIGZsb3dFZGl0b3IucGFuT2Zmc2V0LnkgPSB2aWV3cG9ydENlbnRlclkgLSAodGFnLnkgKiBmbG93RWRpdG9yLnpvb21MZXZlbCk7DQogICAgICAgIA0KICAgICAgICB3aW5kb3cuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICB9DQoNCiAgICAvLyBSZW1vdmUgdHJhbnNpdGlvbiBhZnRlciBhbmltYXRpb24gY29tcGxldGVzDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGZsb3dFZGl0b3IuY2FudmFzLnN0eWxlLnRyYW5zaXRpb24gPSAnJzsNCiAgICB9LCA1MDApOw0KfQ0KDQovLyBVcGRhdGUgdGFnIHBhbmVsDQpmdW5jdGlvbiB1cGRhdGVUYWdQYW5lbCgpIHsNCiAgICBjb25zdCB0YWdQYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YWctcGFuZWwnKTsNCiAgICBpZiAoIXRhZ1BhbmVsKSByZXR1cm47DQoNCiAgICBpZiAoZmxvd0VkaXRvci50YWdzLnNpemUgPT09IDApIHsNCiAgICAgICAgdGFnUGFuZWwuaW5uZXJIVE1MID0gJzxwIGNsYXNzPSJ0ZXh0LW11dGVkIj5ObyB0YWdzIHlldDwvcD4nOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgbGV0IHRhZ0h0bWwgPSAnJzsNCiAgICBmbG93RWRpdG9yLnRhZ3MuZm9yRWFjaCh0YWcgPT4gew0KICAgICAgICB0YWdIdG1sICs9IGANCiAgICAgICAgICAgIDxkaXYgY2xhc3M9InRhZy1pdGVtIiBkYXRhLXRhZy1pZD0iJHt0YWcuaWR9Ij4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWctY29sb3IiIHN0eWxlPSJiYWNrZ3JvdW5kOiAke3RhZy5jb2xvcn0iPjwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRhZy1pbmZvIj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFnLW5hbWUiPiR7dGFnLm5hbWV9PC9kaXY+DQogICAgICAgICAgICAgICAgICAgICR7dGFnLmRlc2NyaXB0aW9uID8gYDxkaXYgY2xhc3M9InRhZy1kZXNjcmlwdGlvbiI+JHt0YWcuZGVzY3JpcHRpb259PC9kaXY+YCA6ICcnfQ0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InRhZy1kZWxldGUiIGRhdGEtdGFnLWlkPSIke3RhZy5pZH0iPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRpbWVzIj48L2k+DQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgYDsNCiAgICB9KTsNCg0KICAgIHRhZ1BhbmVsLmlubmVySFRNTCA9IHRhZ0h0bWw7DQoNCiAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzDQogICAgdGFnUGFuZWwucXVlcnlTZWxlY3RvckFsbCgnLnRhZy1pdGVtJykuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICBpZiAoIWUudGFyZ2V0LmNsb3Nlc3QoJy50YWctZGVsZXRlJykpIHsNCiAgICAgICAgICAgICAgICBjb25zdCB0YWdJZCA9IGl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLXRhZy1pZCcpOw0KICAgICAgICAgICAgICAgIGp1bXBUb1RhZyh0YWdJZCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0pOw0KDQogICAgdGFnUGFuZWwucXVlcnlTZWxlY3RvckFsbCgnLnRhZy1kZWxldGUnKS5mb3JFYWNoKGJ0biA9PiB7DQogICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgY29uc3QgdGFnSWQgPSBidG4uZ2V0QXR0cmlidXRlKCdkYXRhLXRhZy1pZCcpOw0KICAgICAgICAgICAgZGVsZXRlVGFnKHRhZ0lkKTsNCiAgICAgICAgfSk7DQogICAgfSk7DQp9DQoNCi8vIERlbGV0ZSBhIHRhZw0KYXN5bmMgZnVuY3Rpb24gZGVsZXRlVGFnKHRhZ0lkKSB7DQogICAgY29uc3QgY29uZmlybWVkID0gYXdhaXQgc3lwbmV4QVBJLnNob3dDb25maXJtYXRpb24oDQogICAgICAgICdEZWxldGUgVGFnJywNCiAgICAgICAgJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyB0YWc/JywNCiAgICAgICAgew0KICAgICAgICAgICAgdHlwZTogJ2RhbmdlcicsDQogICAgICAgICAgICBjb25maXJtVGV4dDogJ0RlbGV0ZScsDQogICAgICAgICAgICBjYW5jZWxUZXh0OiAnQ2FuY2VsJywNCiAgICAgICAgICAgIGljb246ICdmYXMgZmEtdGFnJw0KICAgICAgICB9DQogICAgKTsNCiAgICANCiAgICBpZiAoY29uZmlybWVkKSB7DQogICAgICAgIGNvbnN0IHRhZ0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWdJZCk7DQogICAgICAgIGlmICh0YWdFbGVtZW50KSB7DQogICAgICAgICAgICB0YWdFbGVtZW50LnJlbW92ZSgpOw0KICAgICAgICB9DQogICAgICAgIGZsb3dFZGl0b3IudGFncy5kZWxldGUodGFnSWQpOw0KICAgICAgICB1cGRhdGVUYWdQYW5lbCgpOw0KICAgIH0NCn0NCg0KLy8gRXhhbXBsZTogdGFnLW1hbmFnZXIuanMNCndpbmRvdy50YWdNYW5hZ2VyID0gew0KICAgIGFkZFRhZywNCiAgICBjcmVhdGVUYWdFbGVtZW50LA0KICAgIHN0YXJ0RHJhZ2dpbmdUYWcsDQogICAganVtcFRvVGFnLA0KICAgIHVwZGF0ZVRhZ1BhbmVsLA0KICAgIGRlbGV0ZVRhZw0KfTsNCg0KLy8gU2F2ZSBmbG93IHRvIHZpcnR1YWwgZmlsZSBzeXN0ZW0NCmFzeW5jIGZ1bmN0aW9uIHNhdmVGbG93KCkgew0KICAgIGNvbnN0IGZsb3dEYXRhID0gew0KICAgICAgICBub2RlczogQXJyYXkuZnJvbShmbG93RWRpdG9yLm5vZGVzLnZhbHVlcygpKS5tYXAobm9kZSA9PiAoew0KICAgICAgICAgICAgaWQ6IG5vZGUuaWQsDQogICAgICAgICAgICB0eXBlOiBub2RlLnR5cGUsDQogICAgICAgICAgICB4OiBub2RlLngsDQogICAgICAgICAgICB5OiBub2RlLnksDQogICAgICAgICAgICBjb25maWc6IG5vZGUuY29uZmlnDQogICAgICAgIH0pKSwNCiAgICAgICAgY29ubmVjdGlvbnM6IEFycmF5LmZyb20oZmxvd0VkaXRvci5jb25uZWN0aW9ucy52YWx1ZXMoKSkubWFwKGNvbm4gPT4gKHsNCiAgICAgICAgICAgIGlkOiBjb25uLmlkLA0KICAgICAgICAgICAgZnJvbTogY29ubi5mcm9tLA0KICAgICAgICAgICAgdG86IGNvbm4udG8NCiAgICAgICAgfSkpLA0KICAgICAgICB0YWdzOiBBcnJheS5mcm9tKGZsb3dFZGl0b3IudGFncy52YWx1ZXMoKSksDQogICAgICAgIG1ldGFkYXRhOiB7DQogICAgICAgICAgICBzYXZlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksDQogICAgICAgICAgICBub2RlQ291bnQ6IGZsb3dFZGl0b3Iubm9kZXMuc2l6ZSwNCiAgICAgICAgICAgIGNvbm5lY3Rpb25Db3VudDogZmxvd0VkaXRvci5jb25uZWN0aW9ucy5zaXplLA0KICAgICAgICAgICAgdGFnQ291bnQ6IGZsb3dFZGl0b3IudGFncy5zaXplDQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgdHJ5IHsNCiAgICAgICAgbGV0IGZpbGVQYXRoID0gZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGg7DQogICAgICAgIA0KICAgICAgICAvLyBJZiBubyBjdXJyZW50IGZpbGUgcGF0aCwgc2hvdyBmaWxlIGV4cGxvcmVyDQogICAgICAgIGlmICghZmlsZVBhdGgpIHsNCiAgICAgICAgICAgIGZpbGVQYXRoID0gYXdhaXQgc3lwbmV4QVBJLnNob3dGaWxlRXhwbG9yZXIoew0KICAgICAgICAgICAgICAgIG1vZGU6ICdzYXZlJywNCiAgICAgICAgICAgICAgICB0aXRsZTogJ1NhdmUgRmxvdyBGaWxlJywNCiAgICAgICAgICAgICAgICBpbml0aWFsUGF0aDogJy8nLA0KICAgICAgICAgICAgICAgIGZpbGVOYW1lOiAnZmxvd193b3JrZmxvdy5qc29uJywNCiAgICAgICAgICAgICAgICBmaWxlRXh0ZW5zaW9uOiAnLmpzb24nLA0KICAgICAgICAgICAgICAgIG9uU2VsZWN0OiAoc2VsZWN0ZWRQYXRoKSA9PiB7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4gew0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBpZiAoIWZpbGVQYXRoKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBVc2VyIGNhbmNlbGxlZA0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU2F2ZSB0byB2aXJ0dWFsIGZpbGUgc3lzdGVtDQogICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGVKU09OKSB7DQogICAgICAgICAgICBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZUpTT04oZmlsZVBhdGgsIGZsb3dEYXRhKTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgICAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGbG93IHNhdmVkIHRvOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBGYWxsYmFjayB0byBsb2NhbFN0b3JhZ2UNCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdmbG93X2VkaXRvcl9zYXZlZF9mbG93JywgSlNPTi5zdHJpbmdpZnkoZmxvd0RhdGEpKTsNCiAgICAgICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24pIHsNCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignRmxvdyBzYXZlZCB0byBsb2NhbCBzdG9yYWdlIScsICdzdWNjZXNzJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBmbG93OicsIGVycm9yKTsNCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbikgew0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ0ZhaWxlZCB0byBzYXZlIGZsb3c6ICcgKyBlcnJvci5tZXNzYWdlLCAnZXJyb3InKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gU2F2ZSBmbG93IGFzIChhbHdheXMgc2hvdyBmaWxlIGV4cGxvcmVyKQ0KYXN5bmMgZnVuY3Rpb24gc2F2ZUZsb3dBcygpIHsNCiAgICBjb25zdCBmbG93RGF0YSA9IHsNCiAgICAgICAgbm9kZXM6IEFycmF5LmZyb20oZmxvd0VkaXRvci5ub2Rlcy52YWx1ZXMoKSkubWFwKG5vZGUgPT4gKHsNCiAgICAgICAgICAgIGlkOiBub2RlLmlkLA0KICAgICAgICAgICAgdHlwZTogbm9kZS50eXBlLA0KICAgICAgICAgICAgeDogbm9kZS54LA0KICAgICAgICAgICAgeTogbm9kZS55LA0KICAgICAgICAgICAgY29uZmlnOiBub2RlLmNvbmZpZw0KICAgICAgICB9KSksDQogICAgICAgIGNvbm5lY3Rpb25zOiBBcnJheS5mcm9tKGZsb3dFZGl0b3IuY29ubmVjdGlvbnMudmFsdWVzKCkpLm1hcChjb25uID0+ICh7DQogICAgICAgICAgICBpZDogY29ubi5pZCwNCiAgICAgICAgICAgIGZyb206IGNvbm4uZnJvbSwNCiAgICAgICAgICAgIHRvOiBjb25uLnRvDQogICAgICAgIH0pKSwNCiAgICAgICAgdGFnczogQXJyYXkuZnJvbShmbG93RWRpdG9yLnRhZ3MudmFsdWVzKCkpLA0KICAgICAgICBtZXRhZGF0YTogew0KICAgICAgICAgICAgc2F2ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLA0KICAgICAgICAgICAgbm9kZUNvdW50OiBmbG93RWRpdG9yLm5vZGVzLnNpemUsDQogICAgICAgICAgICBjb25uZWN0aW9uQ291bnQ6IGZsb3dFZGl0b3IuY29ubmVjdGlvbnMuc2l6ZSwNCiAgICAgICAgICAgIHRhZ0NvdW50OiBmbG93RWRpdG9yLnRhZ3Muc2l6ZQ0KICAgICAgICB9DQogICAgfTsNCg0KICAgIHRyeSB7DQogICAgICAgIC8vIFNob3cgZmlsZSBleHBsb3JlciBmb3Igc2F2aW5nDQogICAgICAgIGNvbnN0IGZpbGVQYXRoID0gYXdhaXQgc3lwbmV4QVBJLnNob3dGaWxlRXhwbG9yZXIoew0KICAgICAgICAgICAgbW9kZTogJ3NhdmUnLA0KICAgICAgICAgICAgdGl0bGU6ICdTYXZlIEZsb3cgRmlsZSBBcycsDQogICAgICAgICAgICBpbml0aWFsUGF0aDogJy8nLA0KICAgICAgICAgICAgZmlsZU5hbWU6ICdmbG93X3dvcmtmbG93Lmpzb24nLA0KICAgICAgICAgICAgZmlsZUV4dGVuc2lvbjogJy5qc29uJywNCiAgICAgICAgICAgIG9uU2VsZWN0OiAoc2VsZWN0ZWRQYXRoKSA9PiB7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgb25DYW5jZWw6ICgpID0+IHsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgaWYgKCFmaWxlUGF0aCkgew0KICAgICAgICAgICAgcmV0dXJuOyAvLyBVc2VyIGNhbmNlbGxlZA0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU2F2ZSB0byB2aXJ0dWFsIGZpbGUgc3lzdGVtDQogICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLndyaXRlVmlydHVhbEZpbGVKU09OKSB7DQogICAgICAgICAgICBhd2FpdCBzeXBuZXhBUEkud3JpdGVWaXJ0dWFsRmlsZUpTT04oZmlsZVBhdGgsIGZsb3dEYXRhKTsNCiAgICAgICAgICAgIGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoID0gZmlsZVBhdGg7DQogICAgICAgICAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICAgICAgICAgIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKGBGbG93IHNhdmVkIGFzOiAke2ZpbGVQYXRofWAsICdzdWNjZXNzJyk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBGYWxsYmFjayB0byBsb2NhbFN0b3JhZ2UNCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdmbG93X2VkaXRvcl9zYXZlZF9mbG93JywgSlNPTi5zdHJpbmdpZnkoZmxvd0RhdGEpKTsNCiAgICAgICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24pIHsNCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignRmxvdyBzYXZlZCB0byBsb2NhbCBzdG9yYWdlIScsICdzdWNjZXNzJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBmbG93IGFzOicsIGVycm9yKTsNCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbikgew0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ0ZhaWxlZCB0byBzYXZlIGZsb3cgYXM6ICcgKyBlcnJvci5tZXNzYWdlLCAnZXJyb3InKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gTG9hZCBmbG93IGZyb20gdmlydHVhbCBmaWxlIHN5c3RlbQ0KYXN5bmMgZnVuY3Rpb24gbG9hZEZsb3coKSB7DQogICAgdHJ5IHsNCiAgICAgICAgLy8gU2hvdyBmaWxlIGV4cGxvcmVyIGZvciBsb2FkaW5nDQogICAgICAgIGNvbnN0IGZpbGVQYXRoID0gYXdhaXQgc3lwbmV4QVBJLnNob3dGaWxlRXhwbG9yZXIoew0KICAgICAgICAgICAgbW9kZTogJ29wZW4nLA0KICAgICAgICAgICAgdGl0bGU6ICdMb2FkIEZsb3cgRmlsZScsDQogICAgICAgICAgICBpbml0aWFsUGF0aDogJy8nLA0KICAgICAgICAgICAgb25TZWxlY3Q6IChzZWxlY3RlZFBhdGgpID0+IHsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4gew0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCg0KICAgICAgICBpZiAoIWZpbGVQYXRoKSB7DQogICAgICAgICAgICByZXR1cm47IC8vIFVzZXIgY2FuY2VsbGVkDQogICAgICAgIH0NCg0KICAgICAgICBsZXQgZmxvd0RhdGEgPSBudWxsOw0KICAgICAgICANCiAgICAgICAgLy8gVHJ5IHZpcnR1YWwgZmlsZSBzeXN0ZW0gZmlyc3QNCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkucmVhZFZpcnR1YWxGaWxlSlNPTikgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBmbG93RGF0YSA9IGF3YWl0IHN5cG5leEFQSS5yZWFkVmlydHVhbEZpbGVKU09OKGZpbGVQYXRoKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKHZmc0Vycm9yKSB7DQogICAgICAgICAgICAgICAgdGhyb3cgdmZzRXJyb3I7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIEZhbGxiYWNrIHRvIGxvY2FsU3RvcmFnZSAoZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpDQogICAgICAgIGlmICghZmxvd0RhdGEpIHsNCiAgICAgICAgICAgIGNvbnN0IGxvY2FsRGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdmbG93X2VkaXRvcl9zYXZlZF9mbG93Jyk7DQogICAgICAgICAgICBpZiAobG9jYWxEYXRhKSB7DQogICAgICAgICAgICAgICAgZmxvd0RhdGEgPSBKU09OLnBhcnNlKGxvY2FsRGF0YSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGlmIChmbG93RGF0YSkgew0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDbGVhciBjdXJyZW50IGNhbnZhcyAod2l0aG91dCBjb25maXJtYXRpb24gc2luY2Ugd2UncmUgbG9hZGluZyBhIGZpbGUpDQogICAgICAgICAgICBjbGVhckNhbnZhc1NpbGVudCgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBSZXNldCBwYW4gb2Zmc2V0IHRvIGNlbnRlciBvZiBsYXJnZSBjYW52YXMgZm9yIG5ldyB3b3JrZmxvdw0KICAgICAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQgPSB7IHg6IC01MDAwLCB5OiAtNTAwMCB9Ow0KICAgICAgICAgICAgd2luZG93LmNhbnZhc01hbmFnZXIudXBkYXRlQ2FudmFzVHJhbnNmb3JtKCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFJlc2V0IG5vZGUgY291bnRlciB0byBhdm9pZCBJRCBjb25mbGljdHMNCiAgICAgICAgICAgIGZsb3dFZGl0b3Iubm9kZUNvdW50ZXIgPSAwOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBMb2FkIG5vZGVzDQogICAgICAgICAgICBpZiAoZmxvd0RhdGEubm9kZXMpIHsNCiAgICAgICAgICAgICAgICBmbG93RGF0YS5ub2Rlcy5mb3JFYWNoKG5vZGVEYXRhID0+IHsNCiAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5vZGUgd2l0aCBwcm9wZXIgSUQNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gbm9kZURhdGEuaWQ7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGUgPSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZDogbm9kZUlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogbm9kZURhdGEudHlwZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHg6IG5vZGVEYXRhLngsDQogICAgICAgICAgICAgICAgICAgICAgICB5OiBub2RlRGF0YS55LA0KICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnOiBub2RlRGF0YS5jb25maWcsDQogICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7fQ0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIG5vZGUgY291bnRlcg0KICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlTnVtID0gcGFyc2VJbnQobm9kZUlkLnJlcGxhY2UoJ25vZGVfJywgJycpKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVOdW0gPiBmbG93RWRpdG9yLm5vZGVDb3VudGVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLm5vZGVDb3VudGVyID0gbm9kZU51bTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZmxvd0VkaXRvci5ub2Rlcy5zZXQobm9kZUlkLCBub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBub2RlIGVsZW1lbnQgdXNpbmcgdGhlIHJlbmRlcmVyIGFuZCBhZGQgdG8gY2FudmFzDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gbm9kZVJlbmRlcmVyLmNyZWF0ZU5vZGVFbGVtZW50KG5vZGUpOw0KICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLmNhbnZhcy5hcHBlbmRDaGlsZChub2RlRWxlbWVudCk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIExvYWQgY29ubmVjdGlvbnMgYWZ0ZXIgbm9kZXMgYXJlIGZ1bGx5IGNyZWF0ZWQgYW5kIHBvc2l0aW9uZWQNCiAgICAgICAgICAgIGlmIChmbG93RGF0YS5jb25uZWN0aW9ucykgew0KICAgICAgICAgICAgICAgIGZsb3dEYXRhLmNvbm5lY3Rpb25zLmZvckVhY2goY29ubkRhdGEgPT4gew0KICAgICAgICAgICAgICAgICAgICBjcmVhdGVDb25uZWN0aW9uKGNvbm5EYXRhLmZyb20ubm9kZUlkLCBjb25uRGF0YS5mcm9tLnBvcnROYW1lLCBjb25uRGF0YS50by5ub2RlSWQsIGNvbm5EYXRhLnRvLnBvcnROYW1lKTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBJbW1lZGlhdGVseSByZWRyYXcgY29ubmVjdGlvbnMgbm93IHRoYXQgYWxsIFNWRyBlbGVtZW50cyBleGlzdA0KICAgICAgICAgICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIExvYWQgdGFncw0KICAgICAgICAgICAgaWYgKGZsb3dEYXRhLnRhZ3MpIHsNCiAgICAgICAgICAgICAgICBmbG93RGF0YS50YWdzLmZvckVhY2godGFnRGF0YSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhZyA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB0YWdEYXRhLmlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGFnRGF0YS5uYW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHRhZ0RhdGEuZGVzY3JpcHRpb24gfHwgJycsDQogICAgICAgICAgICAgICAgICAgICAgICB4OiB0YWdEYXRhLngsDQogICAgICAgICAgICAgICAgICAgICAgICB5OiB0YWdEYXRhLnksDQogICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogdGFnRGF0YS5jb2xvciB8fCAnIzRDQUY1MCcNCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0YWcgY291bnRlcg0KICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdOdW0gPSBwYXJzZUludCh0YWdEYXRhLmlkLnJlcGxhY2UoJ3RhZ18nLCAnJykpOw0KICAgICAgICAgICAgICAgICAgICBpZiAodGFnTnVtID4gZmxvd0VkaXRvci50YWdDb3VudGVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmbG93RWRpdG9yLnRhZ0NvdW50ZXIgPSB0YWdOdW07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGZsb3dFZGl0b3IudGFncy5zZXQodGFnRGF0YS5pZCwgdGFnKTsNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LnRhZ01hbmFnZXIuY3JlYXRlVGFnRWxlbWVudCh0YWcpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2VudGVyIG9mIGxvYWRlZCBub2RlcyBhbmQgYWRqdXN0IHBhbiB0byBjZW50ZXIgdGhlbQ0KICAgICAgICAgICAgaWYgKGZsb3dEYXRhLm5vZGVzICYmIGZsb3dEYXRhLm5vZGVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICBjb25zdCBtaW5YID0gTWF0aC5taW4oLi4uZmxvd0RhdGEubm9kZXMubWFwKG4gPT4gbi54KSk7DQogICAgICAgICAgICAgICAgY29uc3QgbWF4WCA9IE1hdGgubWF4KC4uLmZsb3dEYXRhLm5vZGVzLm1hcChuID0+IG4ueCkpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG1pblkgPSBNYXRoLm1pbiguLi5mbG93RGF0YS5ub2Rlcy5tYXAobiA9PiBuLnkpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBtYXhZID0gTWF0aC5tYXgoLi4uZmxvd0RhdGEubm9kZXMubWFwKG4gPT4gbi55KSk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY29uc3QgY2VudGVyWCA9IChtaW5YICsgbWF4WCkgLyAyOw0KICAgICAgICAgICAgICAgIGNvbnN0IGNlbnRlclkgPSAobWluWSArIG1heFkpIC8gMjsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBHZXQgY2FudmFzIGNvbnRhaW5lciBkaW1lbnNpb25zDQogICAgICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZmxvd0VkaXRvci5jYW52YXMucGFyZW50RWxlbWVudDsNCiAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBwYW4gb2Zmc2V0IHRvIGNlbnRlciB0aGUgbm9kZXMgaW4gdGhlIHZpZXdwb3J0DQogICAgICAgICAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueCA9IC1jZW50ZXJYICsgY29udGFpbmVyUmVjdC53aWR0aCAvIDI7DQogICAgICAgICAgICAgICAgZmxvd0VkaXRvci5wYW5PZmZzZXQueSA9IC1jZW50ZXJZICsgY29udGFpbmVyUmVjdC5oZWlnaHQgLyAyOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnVwZGF0ZUNhbnZhc1RyYW5zZm9ybSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBGaW5hbCBjb25uZWN0aW9uIHJlZHJhdyBhZnRlciBhbGwgcG9zaXRpb25pbmcgaXMgY29tcGxldGUNCiAgICAgICAgICAgIHJlZHJhd0FsbENvbm5lY3Rpb25zKCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFVwZGF0ZSB0YWcgcGFuZWwNCiAgICAgICAgICAgIHdpbmRvdy50YWdNYW5hZ2VyLnVwZGF0ZVRhZ1BhbmVsKCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFVwZGF0ZSBjdXJyZW50IGZpbGUgcGF0aA0KICAgICAgICAgICAgZmxvd0VkaXRvci5jdXJyZW50RmlsZVBhdGggPSBmaWxlUGF0aDsNCiAgICAgICAgICAgIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoc3lwbmV4QVBJICYmIHN5cG5leEFQSS5zaG93Tm90aWZpY2F0aW9uKSB7DQogICAgICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oYEZsb3cgbG9hZGVkIGZyb206ICR7ZmlsZVBhdGh9YCwgJ3N1Y2Nlc3MnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlmIChzeXBuZXhBUEkgJiYgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24pIHsNCiAgICAgICAgICAgICAgICBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbignTm8gdmFsaWQgZmxvdyBkYXRhIGZvdW5kIGluIHRoZSBzZWxlY3RlZCBmaWxlLicsICd3YXJuaW5nJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBmbG93OicsIGVycm9yKTsNCiAgICAgICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2hvd05vdGlmaWNhdGlvbikgew0KICAgICAgICAgICAgc3lwbmV4QVBJLnNob3dOb3RpZmljYXRpb24oJ0ZhaWxlZCB0byBsb2FkIGZsb3c6ICcgKyBlcnJvci5tZXNzYWdlLCAnZXJyb3InKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gVXBkYXRlIGZpbGVuYW1lIGRpc3BsYXkNCmZ1bmN0aW9uIHVwZGF0ZUZpbGVuYW1lRGlzcGxheSgpIHsNCiAgICBjb25zdCBmaWxlbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VycmVudC1maWxlbmFtZScpOw0KICAgIGlmIChmaWxlbmFtZUVsZW1lbnQpIHsNCiAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBmbG93RWRpdG9yLmN1cnJlbnRGaWxlUGF0aCA/IGZsb3dFZGl0b3IuY3VycmVudEZpbGVQYXRoLnNwbGl0KCcvJykucG9wKCkgOiAndW50aXRsZWQuZmxvdyc7DQogICAgICAgIGZpbGVuYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IGZpbGVuYW1lOw0KICAgIH0NCn0NCg0KDQovLyBFeHBvcnQgdG8gZ2xvYmFsIHNjb3BlDQp3aW5kb3cuZmlsZU1hbmFnZXIgPSB7DQogICAgc2F2ZUZsb3csDQogICAgc2F2ZUZsb3dBcywNCiAgICBsb2FkRmxvdywNCiAgICB1cGRhdGVGaWxlbmFtZURpc3BsYXkNCn07DQoNCg0KLy8gUG9wdWxhdGUgdG9vbGJveCB3aXRoIGxvYWRlZCBub2Rlcw0KZnVuY3Rpb24gcG9wdWxhdGVUb29sYm94KCkgew0KICAgIGNvbnN0IHRvb2xib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmxvdy10b29sYm94Jyk7DQogICAgaWYgKCF0b29sYm94KSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Rvb2xib3ggbm90IGZvdW5kJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gQ2xlYXIgZXhpc3RpbmcgdG9vbGJveCBjb250ZW50DQogICAgY29uc3QgdG9vbGJveENvbnRlbnQgPSB0b29sYm94LnF1ZXJ5U2VsZWN0b3IoJy50b29sYm94LWNvbnRlbnQnKTsNCiAgICBpZiAodG9vbGJveENvbnRlbnQpIHsNCiAgICAgICAgdG9vbGJveENvbnRlbnQuaW5uZXJIVE1MID0gJyc7DQogICAgfQ0KICAgIA0KICAgIC8vIEdyb3VwIG5vZGVzIGJ5IGNhdGVnb3J5DQogICAgY29uc3QgY2F0ZWdvcmllcyA9IHt9Ow0KICAgIGNvbnN0IGFsbE5vZGVzID0gbm9kZVJlZ2lzdHJ5LmdldEFsbE5vZGVUeXBlcygpOw0KICAgIA0KICAgIA0KICAgIGFsbE5vZGVzLmZvckVhY2gobm9kZURlZiA9PiB7DQogICAgICAgIGNvbnN0IGNhdGVnb3J5ID0gbm9kZURlZi5jYXRlZ29yeSB8fCAnb3RoZXInOw0KICAgICAgICBpZiAoIWNhdGVnb3JpZXNbY2F0ZWdvcnldKSB7DQogICAgICAgICAgICBjYXRlZ29yaWVzW2NhdGVnb3J5XSA9IFtdOw0KICAgICAgICB9DQogICAgICAgIGNhdGVnb3JpZXNbY2F0ZWdvcnldLnB1c2gobm9kZURlZik7DQogICAgfSk7DQogICAgDQogICAgDQogICAgLy8gQ3JlYXRlIHRvb2xib3ggc2VjdGlvbnMgZm9yIGVhY2ggY2F0ZWdvcnkNCiAgICBPYmplY3QuZW50cmllcyhjYXRlZ29yaWVzKS5mb3JFYWNoKChbY2F0ZWdvcnksIG5vZGVzXSkgPT4gew0KICAgICAgICBjb25zdCBjYXRlZ29yeVNlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICAgICAgY2F0ZWdvcnlTZWN0aW9uLmNsYXNzTmFtZSA9ICdub2RlLWNhdGVnb3J5JzsNCiAgICAgICAgY2F0ZWdvcnlTZWN0aW9uLmlubmVySFRNTCA9IGANCiAgICAgICAgICAgIDxoNT4ke2NhdGVnb3J5LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgY2F0ZWdvcnkuc2xpY2UoMSl9PC9oNT4NCiAgICAgICAgICAgICR7bm9kZXMubWFwKG5vZGVEZWYgPT4gYA0KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InRvb2xib3gtbm9kZS1idG4iIGRhdGEtbm9kZS10eXBlPSIke25vZGVEZWYuaWR9IiB0aXRsZT0iJHtub2RlRGVmLmRlc2NyaXB0aW9ufSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSIke25vZGVEZWYuaWNvbn0iPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgPHNwYW4+JHtub2RlRGVmLm5hbWV9PC9zcGFuPg0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgYCkuam9pbignJyl9DQogICAgICAgIGA7DQogICAgICAgIA0KICAgICAgICBpZiAodG9vbGJveENvbnRlbnQpIHsNCiAgICAgICAgICAgIHRvb2xib3hDb250ZW50LmFwcGVuZENoaWxkKGNhdGVnb3J5U2VjdGlvbik7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICAvLyBSZS1hdHRhY2ggZXZlbnQgbGlzdGVuZXJzDQogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRvb2xib3gtbm9kZS1idG4nKS5mb3JFYWNoKGJ0biA9PiB7DQogICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICBjb25zdCBub2RlVHlwZSA9IGJ0bi5nZXRBdHRyaWJ1dGUoJ2RhdGEtbm9kZS10eXBlJyk7DQogICAgICAgICAgICBpZiAobm9kZVR5cGUpIHsNCiAgICAgICAgICAgICAgICBhZGROb2RlKG5vZGVUeXBlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfSk7DQogICAgDQp9DQoNCi8vIFNldCB1cCBldmVudCBoYW5kbGVycw0KZnVuY3Rpb24gc2V0dXBFdmVudEhhbmRsZXJzKCkgew0KICAgIC8vIE5vdGU6IFRvb2xib3ggbm9kZSBidXR0b24gZXZlbnQgbGlzdGVuZXJzIGFyZSBzZXQgdXAgaW4gcG9wdWxhdGVUb29sYm94KCkNCiAgICAvLyB0byBhdm9pZCBkdXBsaWNhdGVzIHdoZW4gdGhlIHRvb2xib3ggaXMgcmVwb3B1bGF0ZWQNCiAgICANCiAgICAvLyBXb3JrZmxvdyBhY3Rpb25zDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3J1bi13b3JrZmxvdycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHJ1bldvcmtmbG93KTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcC13b3JrZmxvdycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN0b3BXb3JrZmxvdyk7DQogICAgLy8gTm90ZTogZGVsZXRlLXNlbGVjdGVkLCBjbGVhci1jYW52YXMsIHJlc2V0LXZpZXcsIGFuZCBhZGQtdGFnIGFyZSBub3cgaGFuZGxlZCBieSBoYW1idXJnZXIgbWVudQ0KICAgIA0KICAgIC8vIFpvb20gY29udHJvbHMNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9vbS1pbicpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnpvb21Jbik7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvb20tb3V0Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgd2luZG93LmNhbnZhc01hbmFnZXIuem9vbU91dCk7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvb20tZml0Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgd2luZG93LmNhbnZhc01hbmFnZXIuem9vbVRvRml0KTsNCiAgICANCiAgICAvLyBOb3RlOiBGaWxlIG9wZXJhdGlvbnMgKHNhdmUsIHNhdmUtYXMsIGxvYWQpIGFyZSBub3cgaGFuZGxlZCBieSBoYW1idXJnZXIgbWVudQ0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbGVhci1vdXRwdXQnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbGVhck91dHB1dCk7DQogICAgDQogICAgLy8gSGFtYnVyZ2VyIG1lbnUNCiAgICBzZXR1cEhhbWJ1cmdlck1lbnUoKTsNCiAgICANCiAgICAvLyBDb25maWcgcGFuZWwgdG9nZ2xlDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1jb25maWcnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVDb25maWdQYW5lbCk7DQogICAgDQogICAgLy8gSW5pdGlhbGl6ZSBjb25maWcgcGFuZWwgc3RhdGUgKHdpdGhvdXQgb3ZlcnJpZGluZyBpY29ucykNCiAgICBjb25zdCBjb25maWdQYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmbG93LWNvbmZpZy1wYW5lbCcpOw0KICAgIGlmIChjb25maWdQYW5lbCkgew0KICAgICAgICAvLyBEZWZhdWx0IGV4cGFuZGVkIChub3QgY29sbGFwc2VkKQ0KICAgICAgICBjb25maWdQYW5lbC5jbGFzc0xpc3QucmVtb3ZlKCdjb2xsYXBzZWQnKTsNCiAgICB9DQogICAgDQogICAgLy8gVG9vbGJveCB0b2dnbGUNCiAgICBjb25zdCB0b29sYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zsb3ctdG9vbGJveCcpOw0KICAgIGNvbnN0IHRvb2xib3hDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rvb2xib3gtY29udGVudCcpOw0KICAgIGNvbnN0IHRvZ2dsZVRvb2xib3hCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlLXRvb2xib3gnKTsNCiAgICBpZiAodG9vbGJveCAmJiB0b29sYm94Q29udGVudCAmJiB0b2dnbGVUb29sYm94QnRuKSB7DQogICAgICAgIC8vIERlZmF1bHQgZXhwYW5kZWQgKG5vdCBjb2xsYXBzZWQpDQogICAgICAgIHRvb2xib3guY2xhc3NMaXN0LnJlbW92ZSgnY29sbGFwc2VkJyk7DQogICAgICAgIHRvb2xib3hDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnJzsNCg0KICAgICAgICB0b2dnbGVUb29sYm94QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICB0b2dnbGVUb29sYm94KCk7DQogICAgICAgIH0pOw0KICAgIH0NCiAgICANCiAgICAvLyBPdXRwdXQgcGFuZWwgdG9nZ2xlDQogICAgY29uc3Qgb3V0cHV0UGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy1vdXRwdXQtcGFuZWwnKTsNCiAgICBjb25zdCBvdXRwdXRDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ291dHB1dC1jb250ZW50Jyk7DQogICAgY29uc3QgdG9nZ2xlT3V0cHV0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1vdXRwdXQnKTsNCiAgICBpZiAob3V0cHV0UGFuZWwgJiYgb3V0cHV0Q29udGVudCAmJiB0b2dnbGVPdXRwdXRCdG4pIHsNCiAgICAgICAgLy8gRGVmYXVsdCBjb2xsYXBzZWQNCiAgICAgICAgb3V0cHV0UGFuZWwuY2xhc3NMaXN0LmFkZCgnY29sbGFwc2VkJyk7DQogICAgICAgIG91dHB1dENvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgdG9nZ2xlT3V0cHV0QnRuLnF1ZXJ5U2VsZWN0b3IoJ2knKS5jbGFzc05hbWUgPSAnZmFzIGZhLWNoZXZyb24tZG93bic7DQoNCiAgICAgICAgdG9nZ2xlT3V0cHV0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICBjb25zdCBpc0NvbGxhcHNlZCA9IG91dHB1dFBhbmVsLmNsYXNzTGlzdC5jb250YWlucygnY29sbGFwc2VkJyk7DQogICAgICAgICAgICBpZiAoaXNDb2xsYXBzZWQpIHsNCiAgICAgICAgICAgICAgICBvdXRwdXRQYW5lbC5jbGFzc0xpc3QucmVtb3ZlKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgICAgICAgICBvdXRwdXRDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnJzsNCiAgICAgICAgICAgICAgICB0b2dnbGVPdXRwdXRCdG4ucXVlcnlTZWxlY3RvcignaScpLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi11cCc7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIG91dHB1dFBhbmVsLmNsYXNzTGlzdC5hZGQoJ2NvbGxhcHNlZCcpOw0KICAgICAgICAgICAgICAgIG91dHB1dENvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICB0b2dnbGVPdXRwdXRCdG4ucXVlcnlTZWxlY3RvcignaScpLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1kb3duJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfQ0KICAgIA0KICAgIC8vIENhbnZhcyBldmVudHMNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHdpbmRvdy5jYW52YXNNYW5hZ2VyLmhhbmRsZUNhbnZhc0NsaWNrKTsNCiAgICBmbG93RWRpdG9yLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB3aW5kb3cuY2FudmFzTWFuYWdlci5zdGFydENhbnZhc1Bhbik7DQogICAgZmxvd0VkaXRvci5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCB3aW5kb3cuY2FudmFzTWFuYWdlci5oYW5kbGVNb3VzZVdoZWVsLCB7IHBhc3NpdmU6IGZhbHNlIH0pOw0KICAgIA0KICAgIC8vIERvY3VtZW50LWxldmVsIG1vdXNlIGV2ZW50cyBmb3Igc21vb3RoIGRyYWdnaW5nIGFuZCBwYW5uaW5nDQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgd2luZG93LmNhbnZhc01hbmFnZXIuaGFuZGxlRG9jdW1lbnRNb3VzZURvd24pOw0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHdpbmRvdy5jYW52YXNNYW5hZ2VyLmhhbmRsZURvY3VtZW50TW91c2VNb3ZlKTsNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgd2luZG93LmNhbnZhc01hbmFnZXIuaGFuZGxlRG9jdW1lbnRNb3VzZVVwKTsNCiAgICANCiAgICAvLyBLZXlib2FyZCBzaG9ydGN1dHMNCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlS2V5RG93bik7DQp9DQoNCi8vIFRvZ2dsZSBjb25maWcgcGFuZWwNCmZ1bmN0aW9uIHRvZ2dsZUNvbmZpZ1BhbmVsKCkgew0KICAgIGNvbnN0IGNvbmZpZ1BhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zsb3ctY29uZmlnLXBhbmVsJyk7DQogICAgY29uc3QgdG9nZ2xlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1jb25maWcnKTsNCiAgICBjb25zdCBpY29uID0gdG9nZ2xlQnRuLnF1ZXJ5U2VsZWN0b3IoJ2knKTsNCiAgICANCiAgICBpZiAoY29uZmlnUGFuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb2xsYXBzZWQnKSkgew0KICAgICAgICAvLyBFeHBhbmQNCiAgICAgICAgY29uZmlnUGFuZWwuY2xhc3NMaXN0LnJlbW92ZSgnY29sbGFwc2VkJyk7DQogICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ0NvbGxhcHNlIENvbmZpZ3VyYXRpb24gUGFuZWwnOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIENvbGxhcHNlDQogICAgICAgIGNvbmZpZ1BhbmVsLmNsYXNzTGlzdC5hZGQoJ2NvbGxhcHNlZCcpOw0KICAgICAgICBpY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1sZWZ0JzsNCiAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ0V4cGFuZCBDb25maWd1cmF0aW9uIFBhbmVsJzsNCiAgICB9DQp9DQoNCi8vIFRvZ2dsZSB0b29sYm94DQpmdW5jdGlvbiB0b2dnbGVUb29sYm94KCkgew0KICAgIGNvbnN0IHRvb2xib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy10b29sYm94Jyk7DQogICAgY29uc3QgdG9vbGJveENvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9vbGJveC1jb250ZW50Jyk7DQogICAgY29uc3QgdG9nZ2xlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS10b29sYm94Jyk7DQogICAgY29uc3QgaWNvbiA9IHRvZ2dsZUJ0bi5xdWVyeVNlbGVjdG9yKCdpJyk7DQogICAgDQogICAgaWYgKHRvb2xib3guY2xhc3NMaXN0LmNvbnRhaW5zKCdjb2xsYXBzZWQnKSkgew0KICAgICAgICAvLyBFeHBhbmQNCiAgICAgICAgdG9vbGJveC5jbGFzc0xpc3QucmVtb3ZlKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgdG9vbGJveENvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICcnOw0KICAgICAgICBpY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtY2hldnJvbi1sZWZ0JzsNCiAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ0NvbGxhcHNlIFRvb2xib3gnOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIENvbGxhcHNlDQogICAgICAgIHRvb2xib3guY2xhc3NMaXN0LmFkZCgnY29sbGFwc2VkJyk7DQogICAgICAgIHRvb2xib3hDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1jaGV2cm9uLXJpZ2h0JzsNCiAgICAgICAgdG9nZ2xlQnRuLnRpdGxlID0gJ0V4cGFuZCBUb29sYm94JzsNCiAgICB9DQp9DQoNCi8vIFNldHVwIGhhbWJ1cmdlciBtZW51IGZ1bmN0aW9uYWxpdHkNCmZ1bmN0aW9uIHNldHVwSGFtYnVyZ2VyTWVudSgpIHsNCiAgICBjb25zdCBoYW1idXJnZXJCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGFtYnVyZ2VyLW1lbnUnKTsNCiAgICBjb25zdCBkcm9wZG93bk1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGRvd24tbWVudScpOw0KICAgIA0KICAgIGlmICghaGFtYnVyZ2VyQnRuIHx8ICFkcm9wZG93bk1lbnUpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignSGFtYnVyZ2VyIG1lbnUgZWxlbWVudHMgbm90IGZvdW5kJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gVG9nZ2xlIG1lbnUgb24gaGFtYnVyZ2VyIGNsaWNrDQogICAgaGFtYnVyZ2VyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgDQogICAgICAgIC8vIFBvc2l0aW9uIHRoZSBkcm9wZG93biByZWxhdGl2ZSB0byB0aGUgaGFtYnVyZ2VyIGJ1dHRvbg0KICAgICAgICBpZiAoIWRyb3Bkb3duTWVudS5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKSkgew0KICAgICAgICAgICAgLy8gVXNlIHNjYWxlZCBtb3VzZSBjb29yZGluYXRlcyBmb3IgbW9yZSBpbnR1aXRpdmUgcG9zaXRpb25pbmcNCiAgICAgICAgICAgIGNvbnN0IG1vdXNlQ29vcmRzID0gd2luZG93LmZsb3dFZGl0b3JVdGlscyA/IA0KICAgICAgICAgICAgICAgIHdpbmRvdy5mbG93RWRpdG9yVXRpbHMuZ2V0U2NhbGVkTW91c2VDb29yZHMoZSkgOg0KICAgICAgICAgICAgICAgIHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gaGFtYnVyZ2VyQnRuLmNsb3Nlc3QoJy5mbG93LWVkaXRvciwgLmFwcC1jb250YWluZXInKTsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSB3aW5kb3cuZmxvd0VkaXRvclV0aWxzICYmIGNvbnRhaW5lciA/DQogICAgICAgICAgICAgICAgd2luZG93LmZsb3dFZGl0b3JVdGlscy5nZXRTY2FsZWRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyKSA6DQogICAgICAgICAgICAgICAgKGNvbnRhaW5lciA/IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSA6IHsgdG9wOiAwLCBsZWZ0OiAwIH0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBQb3NpdGlvbiByZWxhdGl2ZSB0byBtb3VzZSBjbGljaywgb2Zmc2V0IHNsaWdodGx5IHRvIGF2b2lkIGNvdmVyaW5nIHRoZSBidXR0b24NCiAgICAgICAgICAgIGNvbnN0IHJlbGF0aXZlVG9wID0gbW91c2VDb29yZHMueSAtIGNvbnRhaW5lclJlY3QudG9wICsgNTsNCiAgICAgICAgICAgIGNvbnN0IHJlbGF0aXZlTGVmdCA9IG1vdXNlQ29vcmRzLnggLSBjb250YWluZXJSZWN0LmxlZnQgLSAxODAgLSAxMCArIDIwOyAvLyBNZW51IHdpZHRoICsgc21hbGwgZ2FwLCB0aGVuIDIwcHggbW9yZSB0byB0aGUgcmlnaHQNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZHJvcGRvd25NZW51LnN0eWxlLnRvcCA9IHJlbGF0aXZlVG9wICsgJ3B4JzsNCiAgICAgICAgICAgIGRyb3Bkb3duTWVudS5zdHlsZS5sZWZ0ID0gcmVsYXRpdmVMZWZ0ICsgJ3B4JzsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgZHJvcGRvd25NZW51LmNsYXNzTGlzdC50b2dnbGUoJ3Nob3cnKTsNCiAgICB9KTsNCiAgICANCiAgICAvLyBDbG9zZSBtZW51IHdoZW4gY2xpY2tpbmcgb3V0c2lkZQ0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgaWYgKCFkcm9wZG93bk1lbnUuY29udGFpbnMoZS50YXJnZXQpICYmICFoYW1idXJnZXJCdG4uY29udGFpbnMoZS50YXJnZXQpKSB7DQogICAgICAgICAgICBkcm9wZG93bk1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gSGFuZGxlIG1lbnUgaXRlbSBjbGlja3MgLSBPTkxZIHRoZSBzcGVjaWZpYyBhY3Rpb25zIHJlcXVlc3RlZA0KICAgIGRyb3Bkb3duTWVudS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgICAgIGNvbnN0IG1lbnVJdGVtID0gZS50YXJnZXQuY2xvc2VzdCgnLm1lbnUtaXRlbScpOw0KICAgICAgICBpZiAoIW1lbnVJdGVtKSByZXR1cm47DQogICAgICAgIA0KICAgICAgICBjb25zdCBhY3Rpb24gPSBtZW51SXRlbS5kYXRhc2V0LmFjdGlvbjsNCiAgICAgICAgaWYgKCFhY3Rpb24pIHJldHVybjsNCiAgICAgICAgDQogICAgICAgIC8vIENsb3NlIHRoZSBtZW51DQogICAgICAgIGRyb3Bkb3duTWVudS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7DQogICAgICAgIA0KICAgICAgICAvLyBFeGVjdXRlIE9OTFkgdGhlIHJlcXVlc3RlZCBhY3Rpb25zOiBzYXZlLCBzYXZlLWFzLCBsb2FkLCBkZWxldGUsIGNsZWFyLWFsbCwgcmVzZXQtdmlldywgYWRkLXRhZw0KICAgICAgICBzd2l0Y2ggKGFjdGlvbikgew0KICAgICAgICAgICAgY2FzZSAnc2F2ZS1mbG93JzoNCiAgICAgICAgICAgICAgICBpZiAod2luZG93LmZpbGVNYW5hZ2VyICYmIHdpbmRvdy5maWxlTWFuYWdlci5zYXZlRmxvdykgew0KICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZmlsZU1hbmFnZXIuc2F2ZUZsb3coKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdzYXZlLWZsb3ctYXMnOg0KICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuZmlsZU1hbmFnZXIgJiYgd2luZG93LmZpbGVNYW5hZ2VyLnNhdmVGbG93QXMpIHsNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LmZpbGVNYW5hZ2VyLnNhdmVGbG93QXMoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdsb2FkLWZsb3cnOg0KICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuZmlsZU1hbmFnZXIgJiYgd2luZG93LmZpbGVNYW5hZ2VyLmxvYWRGbG93KSB7DQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5maWxlTWFuYWdlci5sb2FkRmxvdygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ2FkZC10YWcnOg0KICAgICAgICAgICAgICAgIGlmICh3aW5kb3cudGFnTWFuYWdlciAmJiB3aW5kb3cudGFnTWFuYWdlci5hZGRUYWcpIHsNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LnRhZ01hbmFnZXIuYWRkVGFnKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAncmVzZXQtdmlldyc6DQogICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5jYW52YXNNYW5hZ2VyICYmIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnJlc2V0Q2FudmFzUGFuKSB7DQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jYW52YXNNYW5hZ2VyLnJlc2V0Q2FudmFzUGFuKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZGVsZXRlLXNlbGVjdGVkJzoNCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRlbGV0ZVNlbGVjdGVkTm9kZSA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgICAgICAgICBkZWxldGVTZWxlY3RlZE5vZGUoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdjbGVhci1jYW52YXMnOg0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY2xlYXJDYW52YXMgPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgICAgICAgICAgY2xlYXJDYW52YXMoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICB9KTsNCn0NCg0KLy8gRXhhbXBsZTogdWktbWFuYWdlci5qcw0Kd2luZG93LnVpTWFuYWdlciA9IHsNCiAgICBwb3B1bGF0ZVRvb2xib3gsDQogICAgc2V0dXBFdmVudEhhbmRsZXJzLA0KICAgIHRvZ2dsZUNvbmZpZ1BhbmVsLA0KICAgIHRvZ2dsZVRvb2xib3gNCn07DQoNCi8vIG1haW4uanMgLSBFbnRyeSBwb2ludCBmb3IgRmxvdyBFZGl0b3INCg0KLy8gR2xvYmFsIHZhcmlhYmxlcyAoc2NvcGVkIHRvIGF2b2lkIGdsb2JhbCBwb2xsdXRpb24pDQpsZXQgZmxvd0VkaXRvciA9IHsNCiAgICBub2RlczogbmV3IE1hcCgpLA0KICAgIGNvbm5lY3Rpb25zOiBuZXcgTWFwKCksDQogICAgc2VsZWN0ZWROb2RlOiBudWxsLA0KICAgIGRyYWdnaW5nTm9kZTogbnVsbCwNCiAgICBjb25uZWN0aW5nRnJvbTogbnVsbCwNCiAgICBjYW52YXM6IG51bGwsDQogICAgbm9kZUNvdW50ZXI6IDAsDQogICAgaXNSdW5uaW5nOiBmYWxzZSwNCiAgICBjdXJyZW50RmlsZVBhdGg6IG51bGwsDQogICAgaXNBY3RpdmU6IHRydWUsDQogICAgLy8gQ2FudmFzIHBhbm5pbmcgc3RhdGUNCiAgICBpc1Bhbm5pbmc6IGZhbHNlLA0KICAgIHBhblN0YXJ0OiB7IHg6IDAsIHk6IDAgfSwNCiAgICBwYW5PZmZzZXQ6IHsgeDogLTUwMDAsIHk6IC01MDAwIH0sIC8vIENlbnRlciB0aGUgbGFyZ2UgY2FudmFzIGluaXRpYWxseQ0KICAgIGxhc3RQYW5PZmZzZXQ6IHsgeDogLTUwMDAsIHk6IC01MDAwIH0sDQogICAgLy8gWm9vbSBzdGF0ZQ0KICAgIHpvb21MZXZlbDogMS4wLA0KICAgIG1pblpvb206IDAuMSwNCiAgICBtYXhab29tOiAzLjAsDQogICAgem9vbVN0ZXA6IDAuMSwNCiAgICAvLyBUYWcgc3lzdGVtDQogICAgdGFnczogbmV3IE1hcCgpLA0KICAgIHRhZ0NvdW50ZXI6IDAsDQogICAgZHJhZ2dpbmdUYWc6IG51bGwsDQogICAgdGFnRHJhZ09mZnNldDogbnVsbCwNCiAgICB0YWdVcGRhdGVUaW1lb3V0OiBudWxsDQp9Ow0KDQovLyBJbml0aWFsaXplIHdoZW4gRE9NIGlzIHJlYWR5DQphc3luYyBmdW5jdGlvbiBpbml0Rmxvd0VkaXRvcigpIHsNCiAgICANCiAgICAvLyBDaGVjayBpZiBTeXBuZXhBUEkgaXMgYXZhaWxhYmxlIChsb2NhbCB2YXJpYWJsZSBpbiBzYW5kYm94ZWQgZW52aXJvbm1lbnQpDQogICAgaWYgKHR5cGVvZiBzeXBuZXhBUEkgPT09ICd1bmRlZmluZWQnIHx8ICFzeXBuZXhBUEkpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCdTeXBuZXhBUEkgbm90IGF2YWlsYWJsZSAtIHJ1bm5pbmcgaW4gc3RhbmRhbG9uZSBtb2RlJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICANCiAgICAvLyBJbml0aWFsaXplIHNjYWxlIGRldGVjdGlvbiBmb3IgYXBwIHNjYWxpbmcgY29tcGVuc2F0aW9uDQogICAgaWYgKHdpbmRvdy5mbG93RWRpdG9yVXRpbHMpIHsNCiAgICAgICAgd2luZG93LmZsb3dFZGl0b3JVdGlscy5pbml0U2NhbGVEZXRlY3Rpb24oKTsNCiAgICB9DQogICAgDQogICAgLy8gVGVzdCBWRlMgQVBJDQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgdGVzdFJlc3VsdCA9IGF3YWl0IHN5cG5leEFQSS5saXN0VmlydHVhbEZpbGVzKCcvJyk7DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignVkZTIEFQSSB0ZXN0IGZhaWxlZDonLCBlcnJvcik7DQogICAgfQ0KICAgIA0KICAgIC8vIEluaXRpYWxpemUgY2FudmFzDQogICAgZmxvd0VkaXRvci5jYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxvdy1jYW52YXMnKTsNCiAgICBpZiAoIWZsb3dFZGl0b3IuY2FudmFzKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Zsb3cgY2FudmFzIG5vdCBmb3VuZCcpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIENyZWF0ZSBTVkcgbWFya2VyIGRlZmluaXRpb25zIGZvciBjb25uZWN0aW9uIGFycm93cw0KICAgIGNvbnN0IGRlZnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2RlZnMnKTsNCiAgICBjb25zdCBtYXJrZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ21hcmtlcicpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2Fycm93aGVhZCcpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ21hcmtlcldpZHRoJywgJzEwJyk7DQogICAgbWFya2VyLnNldEF0dHJpYnV0ZSgnbWFya2VySGVpZ2h0JywgJzcnKTsNCiAgICBtYXJrZXIuc2V0QXR0cmlidXRlKCdyZWZYJywgJzknKTsNCiAgICBtYXJrZXIuc2V0QXR0cmlidXRlKCdyZWZZJywgJzMuNScpOw0KICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ29yaWVudCcsICdhdXRvJyk7DQogICAgbWFya2VyLnNldEF0dHJpYnV0ZSgnbWFya2VyVW5pdHMnLCAnc3Ryb2tlV2lkdGgnKTsNCiAgICANCiAgICBjb25zdCBwb2x5Z29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwb2x5Z29uJyk7DQogICAgcG9seWdvbi5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICcwIDAsIDEwIDMuNSwgMCA3Jyk7DQogICAgcG9seWdvbi5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnIzRDQUY1MCcpOw0KICAgIA0KICAgIG1hcmtlci5hcHBlbmRDaGlsZChwb2x5Z29uKTsNCiAgICBkZWZzLmFwcGVuZENoaWxkKG1hcmtlcik7DQogICAgDQogICAgLy8gQ3JlYXRlIGEgdGVtcG9yYXJ5IFNWRyBjb250YWluZXIgZm9yIHRoZSBtYXJrZXIgZGVmaW5pdGlvbg0KICAgIGNvbnN0IG1hcmtlclN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7DQogICAgbWFya2VyU3ZnLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsNCiAgICBtYXJrZXJTdmcuc3R5bGUud2lkdGggPSAnMCc7DQogICAgbWFya2VyU3ZnLnN0eWxlLmhlaWdodCA9ICcwJzsNCiAgICBtYXJrZXJTdmcuYXBwZW5kQ2hpbGQoZGVmcyk7DQogICAgZmxvd0VkaXRvci5jYW52YXMuYXBwZW5kQ2hpbGQobWFya2VyU3ZnKTsNCiAgICANCiAgICAvLyBJbml0aWFsaXplIGNhbnZhcyB0cmFuc2Zvcm0gZm9yIHBhbm5pbmcNCiAgICB3aW5kb3cuY2FudmFzTWFuYWdlci51cGRhdGVDYW52YXNUcmFuc2Zvcm0oKTsNCiAgICANCiAgICAvLyBMb2FkIG5vZGVzIGZyb20gVkZTDQogICAgYXdhaXQgbm9kZVJlZ2lzdHJ5LmxvYWROb2Rlc0Zyb21WRlMoKTsNCiAgICANCiAgICAvLyBQb3B1bGF0ZSB0b29sYm94IHdpdGggbG9hZGVkIG5vZGVzDQogICAgd2luZG93LnVpTWFuYWdlci5wb3B1bGF0ZVRvb2xib3goKTsNCiAgICANCiAgICAvLyBTZXQgdXAgZXZlbnQgaGFuZGxlcnMNCiAgICB3aW5kb3cudWlNYW5hZ2VyLnNldHVwRXZlbnRIYW5kbGVycygpOw0KICAgIA0KICAgIC8vIENvbm5lY3QgdG8gV2ViU29ja2V0IGZvciByZWFsLXRpbWUgdXBkYXRlcw0KICAgIGNvbm5lY3RXZWJTb2NrZXQoKTsNCiAgICANCiAgICAvLyBIYW5kbGUgd2luZG93IHJlc2l6ZSB0byB1cGRhdGUgY29ubmVjdGlvbnMNCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4gew0KICAgICAgICBzZXRUaW1lb3V0KHJlZHJhd0FsbENvbm5lY3Rpb25zLCAxMDApOw0KICAgIH0pOw0KICAgIA0KICAgIC8vIEhhbmRsZSBhcHAgY2xlYW51cCB3aGVuIHdpbmRvdyBpcyB1bmxvYWRlZA0KICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCBjbGVhbnVwRmxvd0VkaXRvcik7DQogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BhZ2VoaWRlJywgY2xlYW51cEZsb3dFZGl0b3IpOw0KICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1bmxvYWQnLCBjbGVhbnVwRmxvd0VkaXRvcik7DQogICAgDQogICAgLy8gRmxvdyBFZGl0b3IgbG9hZGVkIHN1Y2Nlc3NmdWxseSAobm8gbm90aWZpY2F0aW9uIG5lZWRlZCkNCiAgICANCiAgICAvLyBVcGRhdGUgZmlsZW5hbWUgZGlzcGxheQ0KICAgIHdpbmRvdy5maWxlTWFuYWdlci51cGRhdGVGaWxlbmFtZURpc3BsYXkoKTsNCiAgICANCn0NCg0KLy8gQ2xlYW51cCBmdW5jdGlvbiB0byByZW1vdmUgdG9vbHRpcHMgYW5kIGV2ZW50IGxpc3RlbmVycw0KZnVuY3Rpb24gY2xlYW51cEZsb3dFZGl0b3IoKSB7DQogICAgLy8gTWFyayBhcHAgYXMgaW5hY3RpdmUgdG8gcHJldmVudCBuZXcgdG9vbHRpcHMNCiAgICBmbG93RWRpdG9yLmlzQWN0aXZlID0gZmFsc2U7DQogICAgDQogICAgLy8gUmVtb3ZlIGFueSBsaW5nZXJpbmcgdG9vbHRpcHMgKGNoZWNrIG11bHRpcGxlIHBvc3NpYmxlIGxvY2F0aW9ucykNCiAgICBjb25zdCB0b29sdGlwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb25uZWN0aW9uLXRvb2x0aXAsICNjb25uZWN0aW9uLXRvb2x0aXAnKTsNCiAgICB0b29sdGlwcy5mb3JFYWNoKHRvb2x0aXAgPT4gew0KICAgICAgICBpZiAodG9vbHRpcC5wYXJlbnROb2RlKSB7DQogICAgICAgICAgICB0b29sdGlwLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodG9vbHRpcCk7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICAvLyBSZW1vdmUgZ2xvYmFsIGV2ZW50IGxpc3RlbmVycw0KICAgIGlmICh3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyKSB7DQogICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHdpbmRvdy5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIpOw0KICAgICAgICB3aW5kb3cuZmxvd0VkaXRvclRvb2x0aXBIYW5kbGVyID0gbnVsbDsNCiAgICB9DQogICAgDQogICAgLy8gQ2xlYXIgYW55IG90aGVyIGdsb2JhbCByZWZlcmVuY2VzDQogICAgaWYgKHdpbmRvdy5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXIpIHsNCiAgICAgICAgZGVsZXRlIHdpbmRvdy5mbG93RWRpdG9yVG9vbHRpcEhhbmRsZXI7DQogICAgfQ0KICAgIA0KICAgIC8vIEFsc28gcmVtb3ZlIGFueSB0b29sdGlwcyB0aGF0IG1pZ2h0IGJlIGluIHRoZSBib2R5DQogICAgY29uc3QgYm9keVRvb2x0aXBzID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yQWxsKCcuY29ubmVjdGlvbi10b29sdGlwJyk7DQogICAgYm9keVRvb2x0aXBzLmZvckVhY2godG9vbHRpcCA9PiB7DQogICAgICAgIGlmICh0b29sdGlwLnBhcmVudE5vZGUpIHsNCiAgICAgICAgICAgIHRvb2x0aXAucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0b29sdGlwKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KfQ0KDQovLyBDb25uZWN0IHRvIFdlYlNvY2tldCBzZXJ2ZXINCmFzeW5jIGZ1bmN0aW9uIGNvbm5lY3RXZWJTb2NrZXQoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgY29ubmVjdGVkID0gYXdhaXQgc3lwbmV4QVBJLmNvbm5lY3RTb2NrZXQoKTsNCiAgICAgICAgaWYgKGNvbm5lY3RlZCkgew0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBKb2luIGZsb3cgZWRpdG9yIHJvb20NCiAgICAgICAgICAgIHN5cG5leEFQSS5qb2luUm9vbSgnZmxvdy1lZGl0b3InKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTGlzdGVuIGZvciBtZXNzYWdlcw0KICAgICAgICAgICAgc3lwbmV4QVBJLm9uKCdmbG93X3VwZGF0ZScsIChkYXRhKSA9PiB7DQogICAgICAgICAgICAgICAgaGFuZGxlRmxvd1VwZGF0ZShkYXRhKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBTZW5kIGluaXRpYWwgY29ubmVjdGlvbiBtZXNzYWdlDQogICAgICAgICAgICBzeXBuZXhBUEkuc2VuZE1lc3NhZ2UoJ2Zsb3dfY29ubmVjdGVkJywgew0KICAgICAgICAgICAgICAgIGFwcElkOiBzeXBuZXhBUEkuZ2V0QXBwSWQoKSwNCiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCkNCiAgICAgICAgICAgIH0sICdmbG93LWVkaXRvcicpOw0KICAgICAgICAgICAgDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY29ubmVjdCB0byBXZWJTb2NrZXQgc2VydmVyJyk7DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdXZWJTb2NrZXQgY29ubmVjdGlvbiBlcnJvcjonLCBlcnJvcik7DQogICAgfQ0KfQ0KDQovLyBBZGQgYSBuZXcgbm9kZSB0byB0aGUgY2FudmFzIChkeW5hbWljIHZlcnNpb24pDQpmdW5jdGlvbiBhZGROb2RlKHR5cGUpIHsNCiAgICBjb25zdCBub2RlRGVmID0gbm9kZVJlZ2lzdHJ5LmdldE5vZGVUeXBlKHR5cGUpOw0KICAgIGlmICghbm9kZURlZikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdVbmtub3duIG5vZGUgdHlwZTonLCB0eXBlKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBub2RlSWQgPSBgbm9kZV8keysrZmxvd0VkaXRvci5ub2RlQ291bnRlcn1gOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBwb3NpdGlvbiByZWxhdGl2ZSB0byBjdXJyZW50IHZpZXdwb3J0IGNlbnRlcg0KICAgIGNvbnN0IGNlbnRlciA9IHdpbmRvdy5mbG93RWRpdG9yVXRpbHMgPyANCiAgICAgICAgd2luZG93LmZsb3dFZGl0b3JVdGlscy5nZXRWaWV3cG9ydENlbnRlckluQ2FudmFzKCkgOg0KICAgICAgICB7IHg6IDUwMDAsIHk6IDUwMDAgfTsgLy8gRmFsbGJhY2sgdG8gY2FudmFzIGNlbnRlcg0KICAgIA0KICAgIC8vIEFkZCBzb21lIHJhbmRvbSBvZmZzZXQgYXJvdW5kIHRoZSBjZW50ZXINCiAgICBjb25zdCBvZmZzZXRYID0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMjAwOyAvLyAtMTAwIHRvICsxMDANCiAgICBjb25zdCBvZmZzZXRZID0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMjAwOyAvLyAtMTAwIHRvICsxMDANCiAgICANCiAgICBjb25zdCBub2RlID0gew0KICAgICAgICBpZDogbm9kZUlkLA0KICAgICAgICB0eXBlOiB0eXBlLA0KICAgICAgICB4OiBjZW50ZXIueCArIG9mZnNldFgsDQogICAgICAgIHk6IGNlbnRlci55ICsgb2Zmc2V0WSwNCiAgICAgICAgY29uZmlnOiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG5vZGVEZWYuY29uZmlnKSksIC8vIERlZXAgY29weQ0KICAgICAgICBkYXRhOiB7fQ0KICAgIH07DQogICAgDQogICAgLy8gSW5pdGlhbGl6ZSBzcGVjaWFsIG5vZGUgc3RhdGVzDQogICAgaWYgKHR5cGUgPT09ICdyZXBlYXRlcicpIHsNCiAgICAgICAgbm9kZS5yZXBlYXRlclN0YXRlID0gew0KICAgICAgICAgICAgY291bnQ6IDAsDQogICAgICAgICAgICBpbnRlcnZhbDogbnVsbCwNCiAgICAgICAgICAgIGlzUnVubmluZzogZmFsc2UNCiAgICAgICAgfTsNCiAgICB9DQogICAgDQogICAgZmxvd0VkaXRvci5ub2Rlcy5zZXQobm9kZUlkLCBub2RlKTsNCiAgICANCiAgICAvLyBDcmVhdGUgbm9kZSBlbGVtZW50IHVzaW5nIHRoZSByZW5kZXJlcg0KICAgIGNvbnN0IG5vZGVFbGVtZW50ID0gbm9kZVJlbmRlcmVyLmNyZWF0ZU5vZGVFbGVtZW50KG5vZGUpOw0KICAgIGZsb3dFZGl0b3IuY2FudmFzLmFwcGVuZENoaWxkKG5vZGVFbGVtZW50KTsNCiAgICANCiAgICAvLyBTZW5kIHVwZGF0ZSB2aWEgV2ViU29ja2V0DQogICAgaWYgKHN5cG5leEFQSSAmJiBzeXBuZXhBUEkuc2VuZE1lc3NhZ2UpIHsNCiAgICAgICAgc3lwbmV4QVBJLnNlbmRNZXNzYWdlKCdub2RlX2FkZGVkJywgew0KICAgICAgICAgICAgbm9kZUlkOiBub2RlSWQsDQogICAgICAgICAgICB0eXBlOiB0eXBlLA0KICAgICAgICAgICAgcG9zaXRpb246IHsgeDogbm9kZS54LCB5OiBub2RlLnkgfQ0KICAgICAgICB9LCAnZmxvdy1lZGl0b3InKTsNCiAgICB9DQogICAgDQp9DQoNCi8vIEhhbmRsZSBmbG93IHVwZGF0ZXMgZnJvbSBXZWJTb2NrZXQNCmZ1bmN0aW9uIGhhbmRsZUZsb3dVcGRhdGUoZGF0YSkgew0KICAgIC8vIEhhbmRsZSByZWFsLXRpbWUgdXBkYXRlcyBmcm9tIG90aGVyIGluc3RhbmNlcw0KfQ0KDQovLyBJbml0aWFsaXplIHdoZW4gRE9NIGlzIHJlYWR5DQppZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7DQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXRGbG93RWRpdG9yKTsNCn0gZWxzZSB7DQogICAgLy8gRE9NIGlzIGFscmVhZHkgbG9hZGVkDQogICAgaW5pdEZsb3dFZGl0b3IoKTsNCn0NCg0KDQo8L3NjcmlwdD4="
  },
  "package_info": {
    "format_version": "1.0",
    "created_at": "2025-07-24T12:12:47.833265",
    "packaged_by": "Sypnex OS App Packager",
    "source_directory": ".\\flow_editor"
  },
  "additional_files": [
    {
      "vfs_path": "/nodes/nodes-pack.json",
      "filename": "nodes-pack.json",
      "data": "ew0KICAidmVyc2lvbiI6ICIxLjAuMCIsDQogICJwYWNrZWRfYXQiOiAiMjAyNS0wNy0yMlQwMToyMzo0NS4yNTM2NzAiLA0KICAidG90YWxfbm9kZXMiOiAxMywNCiAgIm5vZGVzIjogew0KICAgICJhdWRpbyI6IHsNCiAgICAgICJpZCI6ICJhdWRpbyIsDQogICAgICAibmFtZSI6ICJBdWRpbyBQbGF5ZXIiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIlBsYXkgYXVkaW8gZmlsZXMgYW5kIGNvbnRyb2wgcGxheWJhY2siLA0KICAgICAgImljb24iOiAiZmFzIGZhLXZvbHVtZS11cCIsDQogICAgICAiY29sb3IiOiAid2FybmluZyIsDQogICAgICAiY2F0ZWdvcnkiOiAibWVkaWEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImZyb250ZW5kX29ubHkiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJpbmFyeSIsDQogICAgICAgICAgIm5hbWUiOiAiQmluYXJ5IiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYXVkaW9fZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiQXVkaW8gRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInVybCIsDQogICAgICAgICAgIm5hbWUiOiAiVVJMIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJiaW5hcnkiLA0KICAgICAgICAgICJuYW1lIjogIkJpbmFyeSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImF1ZGlvX2RhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkF1ZGlvIERhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJhdWRpb191cmwiLA0KICAgICAgICAgICJuYW1lIjogIkF1ZGlvIFVSTCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkdXJhdGlvbiIsDQogICAgICAgICAgIm5hbWUiOiAiRHVyYXRpb24iLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJvcmlnaW5hbCIsDQogICAgICAgICAgIm5hbWUiOiAiT3JpZ2luYWwiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJhdXRvUGxheSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJBdXRvIFBsYXkiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJmYWxzZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAidm9sdW1lIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIlZvbHVtZSAoMC0xKSIsDQogICAgICAgICAgInZhbHVlIjogMSwNCiAgICAgICAgICAibWluIjogMCwNCiAgICAgICAgICAibWF4IjogMSwNCiAgICAgICAgICAic3RlcCI6IDAuMQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImF1ZGlvX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJjb25kaXRpb24iOiB7DQogICAgICAiaWQiOiAiY29uZGl0aW9uIiwNCiAgICAgICJuYW1lIjogIkNvbmRpdGlvbiIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiQ29tcGFyZSBpbnB1dCB2YWx1ZSB0byBhIGNvbmRpdGlvbiBhbmQgb3V0cHV0IHRydWUvZmFsc2UiLA0KICAgICAgImljb24iOiAiZmFzIGZhLXF1ZXN0aW9uLWNpcmNsZSIsDQogICAgICAiY29sb3IiOiAid2FybmluZyIsDQogICAgICAiY2F0ZWdvcnkiOiAibG9naWMiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ2YWx1ZSIsDQogICAgICAgICAgIm5hbWUiOiAiVmFsdWUiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJyZXN1bHQiLA0KICAgICAgICAgICJuYW1lIjogIlJlc3VsdCIsDQogICAgICAgICAgInR5cGUiOiAiYm9vbGVhbiINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJvcGVyYXRvciI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJPcGVyYXRvciIsDQogICAgICAgICAgInZhbHVlIjogImVxdWFscyIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAiZXF1YWxzIiwNCiAgICAgICAgICAgICJub3RfZXF1YWxzIiwNCiAgICAgICAgICAgICJncmVhdGVyX3RoYW4iLA0KICAgICAgICAgICAgImxlc3NfdGhhbiIsDQogICAgICAgICAgICAiZ3JlYXRlcl90aGFuX29yX2VxdWFsIiwNCiAgICAgICAgICAgICJsZXNzX3RoYW5fb3JfZXF1YWwiLA0KICAgICAgICAgICAgImNvbnRhaW5zIiwNCiAgICAgICAgICAgICJub3RfY29udGFpbnMiLA0KICAgICAgICAgICAgInN0YXJ0c193aXRoIiwNCiAgICAgICAgICAgICJlbmRzX3dpdGgiLA0KICAgICAgICAgICAgImlzX2VtcHR5IiwNCiAgICAgICAgICAgICJpc19ub3RfZW1wdHkiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiY29tcGFyZV92YWx1ZSI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiQ29tcGFyZSBUbyIsDQogICAgICAgICAgInZhbHVlIjogIiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIlZhbHVlIHRvIGNvbXBhcmUgYWdhaW5zdCINCiAgICAgICAgfSwNCiAgICAgICAgImNhc2Vfc2Vuc2l0aXZlIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkNhc2UgU2Vuc2l0aXZlIiwNCiAgICAgICAgICAidmFsdWUiOiAidHJ1ZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImNvbmRpdGlvbl9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAiZGlzcGxheSI6IHsNCiAgICAgICJpZCI6ICJkaXNwbGF5IiwNCiAgICAgICJuYW1lIjogIkRpc3BsYXkgVGV4dCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiRGlzcGxheSB0ZXh0IGRhdGEgaW4gdmFyaW91cyBmb3JtYXRzIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1leWUiLA0KICAgICAgImNvbG9yIjogInN1Y2Nlc3MiLA0KICAgICAgImNhdGVnb3J5IjogIm91dHB1dCIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiZnJvbnRlbmRfb25seSIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiVGV4dCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJqc29uIiwNCiAgICAgICAgICAibmFtZSI6ICJKU09OIiwNCiAgICAgICAgICAidHlwZSI6ICJqc29uIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImJpbmFyeSIsDQogICAgICAgICAgIm5hbWUiOiAiQmluYXJ5IiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGlzcGxheWVkIiwNCiAgICAgICAgICAibmFtZSI6ICJEaXNwbGF5ZWQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiaW5wdXRfcG9ydCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJJbnB1dCBQb3J0IiwNCiAgICAgICAgICAidmFsdWUiOiAiYXV0byIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAiYXV0byIsDQogICAgICAgICAgICAidGV4dCIsDQogICAgICAgICAgICAianNvbiIsDQogICAgICAgICAgICAiZGF0YSIsDQogICAgICAgICAgICAiYmluYXJ5Ig0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgImZvcm1hdCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJGb3JtYXQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0ZXh0IiwNCiAgICAgICAgICAgICJqc29uIiwNCiAgICAgICAgICAgICJodG1sIg0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgIm1heExlbmd0aCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJNYXggTGVuZ3RoIiwNCiAgICAgICAgICAidmFsdWUiOiAxMDAwLA0KICAgICAgICAgICJtaW4iOiAxLA0KICAgICAgICAgICJtYXgiOiAxMDAwMCwNCiAgICAgICAgICAic3RlcCI6IDEwMA0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImRpc3BsYXlfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImh0dHAiOiB7DQogICAgICAiaWQiOiAiaHR0cCIsDQogICAgICAibmFtZSI6ICJIVFRQIFJlcXVlc3QiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIk1ha2UgSFRUUCByZXF1ZXN0cyB0byBleHRlcm5hbCBBUElzIGFuZCBzZXJ2aWNlcyIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtZ2xvYmUiLA0KICAgICAgImNvbG9yIjogInByaW1hcnkiLA0KICAgICAgImNhdGVnb3J5IjogIm5ldHdvcmsiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAianNvbiIsDQogICAgICAgICAgIm5hbWUiOiAiSlNPTiIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJiaW5hcnkiLA0KICAgICAgICAgICJuYW1lIjogIkJpbmFyeSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInN0YXR1c19jb2RlIiwNCiAgICAgICAgICAibmFtZSI6ICJTdGF0dXMgQ29kZSIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImhlYWRlcnMiLA0KICAgICAgICAgICJuYW1lIjogIkhlYWRlcnMiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidXJsIiwNCiAgICAgICAgICAibmFtZSI6ICJVUkwiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAidXJsIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJVUkwiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJodHRwczovL2pzb25wbGFjZWhvbGRlci50eXBpY29kZS5jb20vcG9zdHMvMSINCiAgICAgICAgfSwNCiAgICAgICAgIm1ldGhvZCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJNZXRob2QiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJHRVQiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgIkdFVCIsDQogICAgICAgICAgICAiUE9TVCIsDQogICAgICAgICAgICAiUFVUIiwNCiAgICAgICAgICAgICJERUxFVEUiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiaGVhZGVycyI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0YXJlYSIsDQogICAgICAgICAgImxhYmVsIjogIkhlYWRlcnMgKEpTT04pIiwNCiAgICAgICAgICAidmFsdWUiOiAie1wiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwifSINCiAgICAgICAgfSwNCiAgICAgICAgImJvZHkiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dGFyZWEiLA0KICAgICAgICAgICJsYWJlbCI6ICJCb2R5IChKU09OKSIsDQogICAgICAgICAgInZhbHVlIjogIntcIm1lc3NhZ2VcIjogXCJ7e1ZBTFVFfX1cIiwgXCJ0aW1lc3RhbXBcIjogXCJ7e0pTT046dGltZXN0YW1wfX1cIn0iDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAiaHR0cF9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAiaW1hZ2UiOiB7DQogICAgICAiaWQiOiAiaW1hZ2UiLA0KICAgICAgIm5hbWUiOiAiSW1hZ2UgRGlzcGxheSIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiRGlzcGxheSBpbWFnZXMgYW5kIGNvbnRyb2wgdmlzdWFsaXphdGlvbiIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtaW1hZ2UiLA0KICAgICAgImNvbG9yIjogImluZm8iLA0KICAgICAgImNhdGVnb3J5IjogIm1lZGlhIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJmcm9udGVuZF9vbmx5IiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJiaW5hcnkiLA0KICAgICAgICAgICJuYW1lIjogIkJpbmFyeSIsDQogICAgICAgICAgInR5cGUiOiAiYmluYXJ5Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImltYWdlX2RhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkltYWdlIERhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ1cmwiLA0KICAgICAgICAgICJuYW1lIjogIlVSTCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiYmluYXJ5IiwNCiAgICAgICAgICAibmFtZSI6ICJCaW5hcnkiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJpbWFnZV9kYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJJbWFnZSBEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJiaW5hcnkiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiaW1hZ2VfdXJsIiwNCiAgICAgICAgICAibmFtZSI6ICJJbWFnZSBVUkwiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGltZW5zaW9ucyIsDQogICAgICAgICAgIm5hbWUiOiAiRGltZW5zaW9ucyIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJvcmlnaW5hbCIsDQogICAgICAgICAgIm5hbWUiOiAiT3JpZ2luYWwiLA0KICAgICAgICAgICJ0eXBlIjogImJpbmFyeSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJtYXhfcHJldmlld19zaXplIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIk1heCBQcmV2aWV3IFNpemUiLA0KICAgICAgICAgICJ2YWx1ZSI6IDMwMCwNCiAgICAgICAgICAibWluIjogNTAsDQogICAgICAgICAgIm1heCI6IDgwMCwNCiAgICAgICAgICAic3RlcCI6IDUwDQogICAgICAgIH0sDQogICAgICAgICJzaG93X2luZm8iOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiU2hvdyBJbmZvIiwNCiAgICAgICAgICAidmFsdWUiOiAidHJ1ZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImltYWdlX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJqc29uX2V4dHJhY3QiOiB7DQogICAgICAiaWQiOiAianNvbl9leHRyYWN0IiwNCiAgICAgICJuYW1lIjogIkpTT04gRXh0cmFjdCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiRXh0cmFjdCB2YWx1ZXMgZnJvbSBKU09OIGRhdGEgdXNpbmcgZG90IG5vdGF0aW9uIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1jb2RlLWJyYW5jaCIsDQogICAgICAiY29sb3IiOiAiaW5mbyIsDQogICAgICAiY2F0ZWdvcnkiOiAiZGF0YSIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAianNvbiIsDQogICAgICAgICAgIm5hbWUiOiAiSlNPTiIsDQogICAgICAgICAgInR5cGUiOiAianNvbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgIm91dHB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICAgICAibmFtZSI6ICJUZXh0IiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImpzb24iLA0KICAgICAgICAgICJuYW1lIjogIkpTT04iLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZXh0cmFjdGVkX3ZhbHVlIiwNCiAgICAgICAgICAibmFtZSI6ICJFeHRyYWN0ZWQgVmFsdWUiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZmllbGRfcGF0aCIsDQogICAgICAgICAgIm5hbWUiOiAiRmllbGQgUGF0aCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJvcmlnaW5hbCIsDQogICAgICAgICAgIm5hbWUiOiAiT3JpZ2luYWwiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiZmllbGRfcGF0aCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwNCiAgICAgICAgICAibGFiZWwiOiAiRmllbGQgUGF0aCIsDQogICAgICAgICAgInZhbHVlIjogImRhdGEuaXRlbXMiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJVc2UgZG90IG5vdGF0aW9uIChlLmcuLCBkYXRhLml0ZW1zLjAubmFtZSkiDQogICAgICAgIH0sDQogICAgICAgICJkaXNwbGF5X2Zvcm1hdCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJEaXNwbGF5IEZvcm1hdCIsDQogICAgICAgICAgInZhbHVlIjogInRleHQiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRleHQiLA0KICAgICAgICAgICAgImpzb24iDQogICAgICAgICAgXQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogImpzb25fZXh0cmFjdF9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAibGxtX2NoYXQiOiB7DQogICAgICAiaWQiOiAibGxtX2NoYXQiLA0KICAgICAgIm5hbWUiOiAiTExNIENoYXQiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkNoYXQgd2l0aCBMYXJnZSBMYW5ndWFnZSBNb2RlbHMgdXNpbmcgT2xsYW1hIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1yb2JvdCIsDQogICAgICAiY29sb3IiOiAiaW5mbyIsDQogICAgICAiY2F0ZWdvcnkiOiAiYWkiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJwcm9tcHQiLA0KICAgICAgICAgICJuYW1lIjogIlByb21wdCIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJzeXN0ZW1fbWVzc2FnZSIsDQogICAgICAgICAgIm5hbWUiOiAiU3lzdGVtIE1lc3NhZ2UiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiY29udGV4dCIsDQogICAgICAgICAgIm5hbWUiOiAiQ29udGV4dCIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInJlc3BvbnNlIiwNCiAgICAgICAgICAibmFtZSI6ICJSZXNwb25zZSIsDQogICAgICAgICAgInR5cGUiOiAidGV4dCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0b2tlbnNfdXNlZCIsDQogICAgICAgICAgIm5hbWUiOiAiVG9rZW5zIFVzZWQiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJtb2RlbF91c2VkIiwNCiAgICAgICAgICAibmFtZSI6ICJNb2RlbCBVc2VkIiwNCiAgICAgICAgICAidHlwZSI6ICJ0ZXh0Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImZ1bGxfcmVzcG9uc2UiLA0KICAgICAgICAgICJuYW1lIjogIkZ1bGwgUmVzcG9uc2UiLA0KICAgICAgICAgICJ0eXBlIjogImpzb24iDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiZW5kcG9pbnQiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIk9sbGFtYSBFbmRwb2ludCIsDQogICAgICAgICAgInZhbHVlIjogImh0dHA6Ly8xMjcuMC4wLjE6MTE0MzQvdjEiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJodHRwOi8vMTI3LjAuMC4xOjExNDM0L3YxIg0KICAgICAgICB9LA0KICAgICAgICAibW9kZWwiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIk1vZGVsIE5hbWUiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJIYW1tZXJBSS9tbi1tYWctbWVsbC1yMTpsYXRlc3QiLA0KICAgICAgICAgICJwbGFjZWhvbGRlciI6ICJsbGFtYTIsIGNvZGVsbGFtYSwgZXRjLiINCiAgICAgICAgfSwNCiAgICAgICAgInRlbXBlcmF0dXJlIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIlRlbXBlcmF0dXJlIiwNCiAgICAgICAgICAidmFsdWUiOiAwLjcsDQogICAgICAgICAgIm1pbiI6IDAsDQogICAgICAgICAgIm1heCI6IDIsDQogICAgICAgICAgInN0ZXAiOiAwLjENCiAgICAgICAgfSwNCiAgICAgICAgIm1heF90b2tlbnMiOiB7DQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwNCiAgICAgICAgICAibGFiZWwiOiAiTWF4IFRva2VucyIsDQogICAgICAgICAgInZhbHVlIjogMjA0OCwNCiAgICAgICAgICAibWluIjogMSwNCiAgICAgICAgICAibWF4IjogODE5MiwNCiAgICAgICAgICAic3RlcCI6IDENCiAgICAgICAgfSwNCiAgICAgICAgInN5c3RlbV9wcm9tcHQiOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dGFyZWEiLA0KICAgICAgICAgICJsYWJlbCI6ICJTeXN0ZW0gUHJvbXB0IiwNCiAgICAgICAgICAidmFsdWUiOiAiWW91IGFyZSBhIGhlbHBmdWwgQUkgYXNzaXN0YW50LiIsDQogICAgICAgICAgInBsYWNlaG9sZGVyIjogIkRlZmluZSB0aGUgQUkncyByb2xlIGFuZCBiZWhhdmlvciINCiAgICAgICAgfSwNCiAgICAgICAgImluY2x1ZGVfY29udGV4dCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJJbmNsdWRlIENvbnRleHQiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJ0cnVlIiwNCiAgICAgICAgICAib3B0aW9ucyI6IFsNCiAgICAgICAgICAgICJ0cnVlIiwNCiAgICAgICAgICAgICJmYWxzZSINCiAgICAgICAgICBdDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAiZXhlY3V0b3IiOiAibGxtX2NoYXRfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgImxvZ2ljYWxfZ2F0ZSI6IHsNCiAgICAgICJpZCI6ICJsb2dpY2FsX2dhdGUiLA0KICAgICAgIm5hbWUiOiAiTG9naWNhbCBHYXRlIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJPbmx5IGNvbnRpbnVlIGV4ZWN1dGlvbiBpZiBpbnB1dCBpcyB0cnVlIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1maWx0ZXIiLA0KICAgICAgImNvbG9yIjogImluZm8iLA0KICAgICAgImNhdGVnb3J5IjogImxvZ2ljIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiY29uZGl0aW9uIiwNCiAgICAgICAgICAibmFtZSI6ICJDb25kaXRpb24iLA0KICAgICAgICAgICJ0eXBlIjogImJvb2xlYW4iDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImludmVydCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJJbnZlcnQgTG9naWMiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJmYWxzZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiZGVzY3JpcHRpb24iOiB7DQogICAgICAgICAgInR5cGUiOiAidGV4dCIsDQogICAgICAgICAgImxhYmVsIjogIkRlc2NyaXB0aW9uIiwNCiAgICAgICAgICAidmFsdWUiOiAiIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiT3B0aW9uYWwgZGVzY3JpcHRpb24gb2Ygd2hhdCB0aGlzIGdhdGUgZG9lcyINCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJsb2dpY2FsX2dhdGVfZXhlY3V0b3IiLA0KICAgICAgInRlbXBsYXRlIjogInN0YW5kYXJkIg0KICAgIH0sDQogICAgInJlcGVhdGVyIjogew0KICAgICAgImlkIjogInJlcGVhdGVyIiwNCiAgICAgICJuYW1lIjogIlJlcGVhdGVyIiwNCiAgICAgICJkZXNjcmlwdGlvbiI6ICJSZXBlYXQgY29ubmVjdGVkIHdvcmtmbG93IGF0IGludGVydmFscyIsDQogICAgICAiaWNvbiI6ICJmYXMgZmEtcmVkbyIsDQogICAgICAiY29sb3IiOiAid2FybmluZyIsDQogICAgICAiY2F0ZWdvcnkiOiAidHJpZ2dlciIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0cmlnZ2VyIiwNCiAgICAgICAgICAibmFtZSI6ICJUcmlnZ2VyIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImNvdW50IiwNCiAgICAgICAgICAibmFtZSI6ICJDb3VudCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgImNvbmZpZyI6IHsNCiAgICAgICAgImludGVydmFsIjogew0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsDQogICAgICAgICAgImxhYmVsIjogIkludGVydmFsIChtcykiLA0KICAgICAgICAgICJ2YWx1ZSI6IDEwMDAsDQogICAgICAgICAgIm1pbiI6IDEwMCwNCiAgICAgICAgICAibWF4IjogMzAwMDAwLA0KICAgICAgICAgICJzdGVwIjogMTAwDQogICAgICAgIH0sDQogICAgICAgICJjb3VudCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJDb3VudCAoMCA9IGluZmluaXRlKSIsDQogICAgICAgICAgInZhbHVlIjogMCwNCiAgICAgICAgICAibWluIjogMCwNCiAgICAgICAgICAic3RlcCI6IDENCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJyZXBlYXRlcl9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfSwNCiAgICAidGV4dCI6IHsNCiAgICAgICJpZCI6ICJ0ZXh0IiwNCiAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIk91dHB1dCBzdGF0aWMgdGV4dCBjb250ZW50IiwNCiAgICAgICJpY29uIjogImZhcyBmYS1mb250IiwNCiAgICAgICJjb2xvciI6ICJzZWNvbmRhcnkiLA0KICAgICAgImNhdGVnb3J5IjogImRhdGEiLA0KICAgICAgImV4ZWN1dGlvbl9tb2RlIjogImJvdGgiLA0KICAgICAgImlucHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRyaWdnZXIiLA0KICAgICAgICAgICJuYW1lIjogIlRyaWdnZXIiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAib3V0cHV0cyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJkYXRhIiwNCiAgICAgICAgICAibmFtZSI6ICJEYXRhIiwNCiAgICAgICAgICAidHlwZSI6ICJkYXRhIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInRleHQiLA0KICAgICAgICAgICJuYW1lIjogIlRleHQiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidXBwZXJjYXNlIiwNCiAgICAgICAgICAibmFtZSI6ICJVcHBlcmNhc2UiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAibG93ZXJjYXNlIiwNCiAgICAgICAgICAibmFtZSI6ICJMb3dlcmNhc2UiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAid29yZF9jb3VudCIsDQogICAgICAgICAgIm5hbWUiOiAiV29yZCBDb3VudCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImxlbmd0aCIsDQogICAgICAgICAgIm5hbWUiOiAiTGVuZ3RoIiwNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAidGV4dF9jb250ZW50Ijogew0KICAgICAgICAgICJ0eXBlIjogInRleHRhcmVhIiwNCiAgICAgICAgICAibGFiZWwiOiAiVGV4dCBDb250ZW50IiwNCiAgICAgICAgICAidmFsdWUiOiAiSGVsbG8sIFdvcmxkISINCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJ0ZXh0X2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJ0aW1lciI6IHsNCiAgICAgICJpZCI6ICJ0aW1lciIsDQogICAgICAibmFtZSI6ICJUaW1lciIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiRGVsYXkgZXhlY3V0aW9uIGZvciBzcGVjaWZpZWQgbWlsbGlzZWNvbmRzIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1jbG9jayIsDQogICAgICAiY29sb3IiOiAid2FybmluZyIsDQogICAgICAiY2F0ZWdvcnkiOiAidHJpZ2dlciIsDQogICAgICAiZXhlY3V0aW9uX21vZGUiOiAiYm90aCIsDQogICAgICAiaW5wdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICJpZCI6ICJ0aW1lc3RhbXAiLA0KICAgICAgICAgICJuYW1lIjogIlRpbWVzdGFtcCIsDQogICAgICAgICAgInR5cGUiOiAibnVtYmVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImVsYXBzZWQiLA0KICAgICAgICAgICJuYW1lIjogIkVsYXBzZWQiLA0KICAgICAgICAgICJ0eXBlIjogIm51bWJlciINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJjb25maWciOiB7DQogICAgICAgICJpbnRlcnZhbCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJJbnRlcnZhbCAobXMpIiwNCiAgICAgICAgICAidmFsdWUiOiAxMDAwLA0KICAgICAgICAgICJtaW4iOiAxMDAsDQogICAgICAgICAgIm1heCI6IDYwMDAwLA0KICAgICAgICAgICJzdGVwIjogMTAwDQogICAgICAgIH0sDQogICAgICAgICJjb3VudCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLA0KICAgICAgICAgICJsYWJlbCI6ICJDb3VudCIsDQogICAgICAgICAgInZhbHVlIjogMSwNCiAgICAgICAgICAibWluIjogMSwNCiAgICAgICAgICAibWF4IjogMTAwLA0KICAgICAgICAgICJzdGVwIjogMQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInRpbWVyX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJ2ZnNfbG9hZCI6IHsNCiAgICAgICJpZCI6ICJ2ZnNfbG9hZCIsDQogICAgICAibmFtZSI6ICJWRlMgTG9hZCIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiTG9hZCBkYXRhIGZyb20gdGhlIFZpcnR1YWwgRmlsZSBTeXN0ZW0iLA0KICAgICAgImljb24iOiAiZmFzIGZhLWZvbGRlci1vcGVuIiwNCiAgICAgICJjb2xvciI6ICJwcmltYXJ5IiwNCiAgICAgICJjYXRlZ29yeSI6ICJzdG9yYWdlIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAidHJpZ2dlciIsDQogICAgICAgICAgIm5hbWUiOiAiVHJpZ2dlciIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogImRhdGEiLA0KICAgICAgICAgICJuYW1lIjogIkRhdGEiLA0KICAgICAgICAgICJ0eXBlIjogImRhdGEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZmlsZV9wYXRoIiwNCiAgICAgICAgICAibmFtZSI6ICJGaWxlIFBhdGgiLA0KICAgICAgICAgICJ0eXBlIjogInRleHQiDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiZmlsZV9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWxlIFBhdGgiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIvbXlfZGF0YS5qc29uIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiL2Fic29sdXRlL3BhdGgvaW4vdmZzIg0KICAgICAgICB9LA0KICAgICAgICAiZm9ybWF0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkZvcm1hdCIsDQogICAgICAgICAgInZhbHVlIjogImpzb24iLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImpzb24iLA0KICAgICAgICAgICAgInRleHQiLA0KICAgICAgICAgICAgImJpbmFyeSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJhdXRvX3JlbG9hZCI6IHsNCiAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLA0KICAgICAgICAgICJsYWJlbCI6ICJBdXRvIFJlbG9hZCBvbiBDaGFuZ2UiLA0KICAgICAgICAgICJ2YWx1ZSI6ICJmYWxzZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgImV4ZWN1dG9yIjogInZmc19sb2FkX2V4ZWN1dG9yIiwNCiAgICAgICJ0ZW1wbGF0ZSI6ICJzdGFuZGFyZCINCiAgICB9LA0KICAgICJ2ZnNfc2F2ZSI6IHsNCiAgICAgICJpZCI6ICJ2ZnNfc2F2ZSIsDQogICAgICAibmFtZSI6ICJWRlMgU2F2ZSIsDQogICAgICAiZGVzY3JpcHRpb24iOiAiU2F2ZSBkYXRhIHRvIHRoZSBWaXJ0dWFsIEZpbGUgU3lzdGVtIiwNCiAgICAgICJpY29uIjogImZhcyBmYS1zYXZlIiwNCiAgICAgICJjb2xvciI6ICJwcmltYXJ5IiwNCiAgICAgICJjYXRlZ29yeSI6ICJzdG9yYWdlIiwNCiAgICAgICJleGVjdXRpb25fbW9kZSI6ICJib3RoIiwNCiAgICAgICJpbnB1dHMiOiBbDQogICAgICAgIHsNCiAgICAgICAgICAiaWQiOiAiZGF0YSIsDQogICAgICAgICAgIm5hbWUiOiAiRGF0YSIsDQogICAgICAgICAgInR5cGUiOiAiZGF0YSINCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgICJvdXRwdXRzIjogWw0KICAgICAgICB7DQogICAgICAgICAgImlkIjogInN1Y2Nlc3MiLA0KICAgICAgICAgICJuYW1lIjogIlN1Y2Nlc3MiLA0KICAgICAgICAgICJ0eXBlIjogImJvb2xlYW4iDQogICAgICAgIH0NCiAgICAgIF0sDQogICAgICAiY29uZmlnIjogew0KICAgICAgICAiZmlsZV9wYXRoIjogew0KICAgICAgICAgICJ0eXBlIjogInRleHQiLA0KICAgICAgICAgICJsYWJlbCI6ICJGaWxlIFBhdGgiLA0KICAgICAgICAgICJ2YWx1ZSI6ICIvbXlfZGF0YS5qc29uIiwNCiAgICAgICAgICAicGxhY2Vob2xkZXIiOiAiL2Fic29sdXRlL3BhdGgvaW4vdmZzIg0KICAgICAgICB9LA0KICAgICAgICAiZm9ybWF0Ijogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkZvcm1hdCIsDQogICAgICAgICAgInZhbHVlIjogImpzb24iLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgImpzb24iLA0KICAgICAgICAgICAgInRleHQiLA0KICAgICAgICAgICAgImJpbmFyeSINCiAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgICJvdmVyd3JpdGUiOiB7DQogICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwNCiAgICAgICAgICAibGFiZWwiOiAiT3ZlcndyaXRlIiwNCiAgICAgICAgICAidmFsdWUiOiAidHJ1ZSIsDQogICAgICAgICAgIm9wdGlvbnMiOiBbDQogICAgICAgICAgICAidHJ1ZSIsDQogICAgICAgICAgICAiZmFsc2UiDQogICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICAiYXBwZW5kIjogew0KICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsDQogICAgICAgICAgImxhYmVsIjogIkFwcGVuZCBNb2RlIiwNCiAgICAgICAgICAidmFsdWUiOiAiZmFsc2UiLA0KICAgICAgICAgICJvcHRpb25zIjogWw0KICAgICAgICAgICAgInRydWUiLA0KICAgICAgICAgICAgImZhbHNlIg0KICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgICJleGVjdXRvciI6ICJ2ZnNfc2F2ZV9leGVjdXRvciIsDQogICAgICAidGVtcGxhdGUiOiAic3RhbmRhcmQiDQogICAgfQ0KICB9DQp9",
      "size": 21438
    }
  ]
}